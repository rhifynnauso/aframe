{"version":3,"sources":["node_modules/browserify/node_modules/browser-pack/_prelude.js","package.json","src/style/aframe.css","src/style/rStats.css","src/index.js","node_modules/promise-polyfill/Promise.js","node_modules/tween.js/src/Tween.js","node_modules/present/lib/present-browser.js","src/core/component.js","src/core/geometry.js","src/core/shader.js","src/core/system.js","src/lib/three.js","src/components/index.js","src/geometries/index.js","src/shaders/index.js","src/systems/index.js","src/core/a-node.js","src/core/a-entity.js","src/core/a-animation.js","src/core/a-assets.js","src/core/a-cubemap.js","src/core/a-mixin.js","src/core/a-register-element.js","src/core/schema.js","src/utils/index.js","src/core/scene/a-scene.js","src/extras/primitives/primitives.js","src/extras/primitives/getMeshMixin.js","src/extras/components/index.js","src/extras/primitives/index.js","node_modules/webvr-polyfill/build/webvr-polyfill.js","vendor/VRControls.js","vendor/VREffect.js","src/geometries/box.js","src/geometries/circle.js","src/geometries/cone.js","src/geometries/cylinder.js","src/geometries/dodecahedron.js","src/geometries/icosahedron.js","src/geometries/octahedron.js","src/geometries/plane.js","src/geometries/ring.js","src/geometries/sphere.js","src/geometries/tetrahedron.js","src/geometries/torus.js","src/geometries/torusKnot.js","src/components/blend-character-model.js","src/components/camera.js","src/components/collada-model.js","src/components/cursor.js","src/components/geometry.js","src/components/light.js","src/components/hand-controls.js","src/components/look-controls.js","src/components/material.js","src/components/obj-model.js","src/components/raycaster.js","src/components/position.js","src/components/rotation.js","src/components/sound.js","src/components/scale.js","src/components/tracked-controls.js","src/components/visible.js","src/components/wasd-controls.js","src/components/vive-controls.js","src/shaders/flat.js","src/shaders/standard.js","src/systems/camera.js","src/systems/geometry.js","src/systems/light.js","src/systems/material.js","src/systems/tracked-controls.js","src/constants/animation.js","src/utils/bind.js","src/utils/debug.js","src/core/propertyTypes.js","src/utils/coordinates.js","src/utils/entity.js","src/utils/checkHeadsetConnected.js","src/utils/forceCanvasResizeSafariMobile.js","src/utils/material.js","src/utils/src-loader.js","src/utils/styleParser.js","node_modules/browserify-css/browser.js","src/components/scene/canvas.js","src/components/scene/debug.js","src/components/scene/embedded.js","src/components/scene/inspector.js","src/components/scene/fog.js","src/components/scene/keyboard-shortcuts.js","src/components/scene/pool.js","src/components/scene/stats.js","src/components/scene/vr-mode-ui.js","node_modules/document-register-element/build/document-register-element.js","node_modules/deep-assign/index.js","node_modules/object-assign/index.js","src/core/scene/wakelock.js","src/core/scene/metaTags.js","src/core/scene/postMessage.js","src/extras/components/pivot.js","node_modules/three/three.js","node_modules/browserify/node_modules/process/browser.js","src/extras/primitives/primitives/a-camera.js","src/extras/primitives/primitives/a-collada-model.js","src/extras/primitives/primitives/a-cursor.js","src/extras/primitives/primitives/a-curvedimage.js","src/extras/primitives/primitives/a-image.js","src/extras/primitives/primitives/a-light.js","src/extras/primitives/primitives/a-obj-model.js","src/extras/primitives/primitives/a-sky.js","src/extras/primitives/primitives/a-sound.js","src/extras/primitives/primitives/a-video.js","src/extras/primitives/primitives/a-videosphere.js","src/extras/primitives/primitives/meshPrimitives.js","vendor/rStats.js","vendor/rStats.extras.js","node_modules/deep-assign/node_modules/is-obj/index.js","src/constants/index.js","src/lib/rStatsAframe.js","node_modules/debug/browser.js","node_modules/three/examples/js/BlendCharacter.js","node_modules/style-attr/index.js","vendor/wakelock/wakelock.js","node_modules/three/examples/js/loaders/OBJLoader.js","node_modules/three/examples/js/loaders/MTLLoader.js","node_modules/debug/debug.js","node_modules/three/examples/js/loaders/ColladaLoader.js","src/constants/keyboardevent.js","vendor/wakelock/util.js","node_modules/debug/node_modules/ms/index.js"],"names":["window","Promise","require","hasNativeWebVRImplementation","navigator","getVRDisplays","getVRDevices","WebVRConfig","BUFFER_SCALE","CARDBOARD_UI_DISABLED","ROTATE_INSTRUCTIONS_DISABLED","TOUCH_PANNER_DISABLED","MOUSE_KEYBOARD_CONTROLS_DISABLED","test","userAgent","devicePixelRatio","AScene","components","registerComponent","registerGeometry","registerPrimitive","registerShader","registerSystem","shaders","systems","THREE","TWEEN","pkg","utils","ANode","AEntity","console","log","version","dependencies","module","exports","AFRAME","geometries","registerElement","primitives","getMeshMixin","schema","root","bind","fn","thisArg","apply","arguments","this","TypeError","_state","_value","_deferreds","doResolve","resolve","reject","handle","deferred","me","push","asap","cb","onFulfilled","onRejected","ret","e","newValue","then","finale","call","i","len","length","Handler","done","value","reason","ex","setTimeoutFunc","setTimeout","setImmediate","isArray","Array","Object","prototype","toString","all","args","slice","res","val","remaining","constructor","race","values","_setImmediateFn","performance","Date","now","getTime","offset","timing","navigationStart","_tweens","REVISION","getAll","removeAll","add","tween","remove","indexOf","splice","update","time","undefined","Tween","object","_object","_valuesStart","_valuesEnd","_valuesStartRepeat","_duration","_repeat","_yoyo","_isPlaying","_reversed","_delayTime","_startTime","_easingFunction","Easing","Linear","None","_interpolationFunction","Interpolation","_chainedTweens","_onStartCallback","_onStartCallbackFired","_onUpdateCallback","_onCompleteCallback","_onStopCallback","field","parseFloat","to","properties","duration","start","property","concat","stop","stopChainedTweens","numChainedTweens","delay","amount","repeat","times","yoyo","easing","interpolation","chain","onStart","callback","onUpdate","onComplete","onStop","elapsed","end","isFinite","tmp","k","Quadratic","In","Out","InOut","Cubic","Quartic","Quintic","Sinusoidal","Math","cos","PI","sin","Exponential","pow","Circular","sqrt","Elastic","s","a","p","asin","Back","Bounce","v","m","f","floor","Utils","Bezier","b","n","pw","bn","Bernstein","CatmullRom","p0","p1","t","fc","Factorial","p2","p3","v0","v1","t2","t3","define","amd","global","present","names","name","shift","dateNow","performanceNow","noConflict","conflict","buildData","el","elData","silent","handleMixinUpdate","mixinEl","mixinData","getAttribute","data","extendProperties","isSinglePropSchema","componentDefined","isSingleProp","mixinEls","default","keys","forEach","key","parseProperty","parseProperties","dest","source","extend","wrapPause","pauseMethod","sceneEl","isPlaying","tick","removeBehavior","wrapPlay","playMethod","shouldPlay","initialized","addBehavior","processSchema","process","isSingleProperty","stringifyProperties","stringifyProperty","styleParser","Component","attr","id","attrName","updateCachedAttrValue","init","prevData","updateSchema","play","pause","parse","stringify","getData","attrValue","parseAttrValueForCache","parsedValue","flushToDOM","HTMLElement","setAttribute","updateProperties","oldData","deepEqual","emit","newData","extendSchema","schemaAddon","extendedSchema","component","definition","NewComponent","proto","Error","writable","hasLoaded","create","system","multiple","type","geometryNames","Geometry","geometry","NewGeometry","shaderNames","propertyToThreeMapping","number","vec4","vec3","vec2","color","Shader","vertexShader","fragmentShader","attributes","initVariables","uniforms","material","ShaderMaterial","is","varType","varValue","variables","self","parseValue","schemaKeys","updateVariables","processData","needsUpdate","dataKeys","Vector2","x","y","Vector3","z","Vector4","w","Color","r","g","NewShader","System","rawData","NewSystem","scenes","findAllScenes","document","initSystem","TextureLoader","crossOrigin","ImageLoader","Cache","enabled","ColladaLoader","MTLLoader","OBJLoader","createdCallback","isNode","mixinObservers","debug","attachedCallback","mixins","closestScene","updateMixins","attributeChangedCallback","oldVal","newVal","element","isScene","parentElement","closest","selector","matches","mozMatchesSelector","msMatchesSelector","oMatchesSelector","webkitMatchesSelector","detachedCallback","load","childFilter","children","childrenLoaded","getChildren","filter","map","child","addEventListener","newMixins","oldMixins","newMixinsIds","split","oldMixinsIds","diff","unregisterMixin","registerMixin","mixinId","querySelector","attachMixinListener","removeMixinListener","observer","disconnect","currentObserver","MutationObserver","mutations","attributeName","config","observe","detail","bubbles","eventName","fireEvent","emitter","checkComponentDefined","defaultComponents","isComponentMixedIn","getMixedInComponents","entityEl","addComponent","componentCache","inMixin","hasAttribute","COMPONENTS","warn","MULTIPLE_COMPONENT_DELIMITER","position","rotation","scale","visible","isEntity","object3D","Group","object3DMap","parentEl","states","justInitialized","setEntityAttribute","assetsEl","addToParent","removeComponent","removeFromParent","updateComponent","getDOMAttribute","updateComponents","mapStateMixins","state","op","mixinIds","updateStateMixins","stateMixinsEls","querySelectorAll","getObject3D","setObject3D","obj","oldObj","Object3D","traverse","removeObject3D","getOrCreateObject3D","Constructor","parentNode","attachedToParent","entityLoadCallback","getChildEntities","childEntities","initComponent","isDependency","componentInfo","componentId","componentName","isComponentDefined","initComponentDependencies","isDefault","isMixedIn","elComponents","updateComponentProperty","propertyValue","componentObj","removeAttribute","componentKeys","entity","mixinUpdate","componentPropValue","isDebugMode","recursive","updateDOMAtrribute","getComputedAttribute","addState","removeState","stateIndex","cloneValue","getAnimationValues","attribute","dataFrom","dataTo","currentValue","isColor","attributeSplit","propertyName","getForComponentAttribute","componentPropName","from","getComponentProperty","partialSetAttribute","getForCoordinateComponent","coordinates","getForBoolean","strToBool","boolToNum","getForColorComponent","rgbVectorToHex","getForNumber","isCoordinate","isNaN","str","bool","componentToHex","hex","convertToIntegerColor","min","abs","prop","join","animationConstants","DEFAULTS","defaults","DIRECTIONS","directions","EASING_FUNCTIONS","easingFunctions","FILLS","fills","REPEATS","repeats","AAnimation","bindMethods","isRunning","getTween","animationValues","toTemp","parseInt","direction","getDirection","fill","indefinite","Infinity","initialValue","count","forwards","alternate","alternateReverse","reverse","backwards","both","dur","onCompleted","begin","evt","removeEventListeners","addEventListeners","none","prevDirection","normal","onStateAdded","onStateRemoved","evts","splitString","removeEventListener","getElData","mediaElementLoaded","checkProgress","secondsBuffered","buffered","readyState","error","setCrossOrigin","mediaEl","newMediaEl","src","extractDomain","location","host","cloneNode","appendChild","removeChild","url","domain","xhrLoader","XHRLoader","isAssets","mediaEls","imgEl","imgEls","timeout","loaded","onload","onerror","isAssetItem","textResponse","files","srcs","validate","elements","cacheAttribute","cacheAttributes","updateEntities","entities","addTagName","tagName","knownTags","toLowerCase","wrapANodeMethods","newObj","ANodeMethods","wrapMethods","copyProperties","wrapAEntityMethods","AEntityMethods","targetObj","methodList","derivedObj","baseObj","methodName","wrapMethod","derivedMethod","baseMethod","destination","props","getOwnPropertyNames","desc","getOwnPropertyDescriptor","node","getPrototypeOf","isANode","isAEntity","processPropertyDefinition","propDefinition","propType","defaultVal","typeName","propertyTypes","JSON","propName","propData","getPartialData","propNames","propValue","stringifiedData","keysA","keysB","deepAssign","objectAssign","checkHeadsetConnected","forceCanvasResizeSafariMobile","target","CustomEvent","dispatchEvent","extendDeep","bKey","aVal","bVal","isComparingObjects","isMobile","check","substr","isIOS","isGearVR","vendor","opera","platform","isLandscape","orientation","shouldCaptureKeyEvent","event","shiftKey","metaKey","altKey","ctrlKey","activeElement","body","delimiter","regex","RegExp","replace","copyAttribute","getUrlParameter","results","exec","search","decodeURIComponent","isIframed","top","matchingElements","allElements","getElementsByTagName","srcLoader","getCanvasSize","canvasEl","embedded","height","offsetHeight","width","offsetWidth","innerHeight","innerWidth","requestFullscreen","canvas","webkitRequestFullscreen","mozRequestFullScreen","msRequestFullscreen","initMetaTags","inject","initWakelock","re","initPostMessageAPI","inspector","keyboard-shortcuts","vr-mode-ui","Scene","render","behaviors","originalHTML","innerHTML","setupRenderer","resize","addFullScreenStyles","htmlEl","documentElement","classList","removeFullScreenStyles","initSystems","cancelAnimationFrame","animationFrameID","behavior","enterVR","enterVRSuccess","screen","lock","enterVRFailure","err","message","effect","requestPresent","exitVR","exitVRSuccess","unlock","exitVRFailure","exitPresent","index","size","camera","aspect","updateProjectionMatrix","renderer","setSize","antialias","WebGLRenderer","alpha","setPixelRatio","sortObjects","VREffect","renderStarted","startRender","mark","reload","doPause","timeDelta","requestAnimationFrame","setComponentProperty","defaultAttributes","primitive","defaultComponentsFromPrimitive","deprecated","deprecatedMappings","mappings","transforms","componentData","applyDefaultComponents","syncAttributeToComponent","defaultData","attrValues","getTransformedValue","metalness","opacity","roughness","shader","side","transparent","o","u","code","l","1","_dereq_","toObject","shouldUseNative","assign","test1","String","test2","fromCharCode","order2","test3","letter","hasOwnProperty","propIsEnumerable","propertyIsEnumerable","symbols","getOwnPropertySymbols","VRFrameData","leftProjectionMatrix","Float32Array","leftViewMatrix","rightProjectionMatrix","rightViewMatrix","pose","VRDisplay","isPolyfilled","displayId","nextDisplayId","displayName","depthNear","depthFar","isConnected","isPresenting","capabilities","hasPosition","hasOrientation","hasExternalDisplay","canPresent","maxLayers","stageParameters","waitingForPresent_","layer_","fullscreenElement_","fullscreenWrapper_","fullscreenElementCachedStyle_","fullscreenEventTarget_","fullscreenChangeHandler_","fullscreenErrorHandler_","wakelock_","WakeLock","VRDevice","hardwareUnitId","deviceId","deviceName","HMDVRDevice","PositionSensorVRDevice","Util","hasShowDeprecationWarning","defaultLeftBounds","defaultRightBounds","getFrameData","frameData","frameDataFromPose","getPose","getImmediatePose","wrapForFullscreen","applyFullscreenElementStyle","cssProperties","max","createElement","removeFullscreenWrapper","parent","insertBefore","firstChild","layers","wasPresenting","onFullscreenChange","actualFullscreenElement","getFullscreenElement","fullscreenElement","catch","beginPresent_","release","endPresent_","removeFullscreenListeners_","fireVRDisplayPresentChange_","onFullscreenError","incomingLayer","leftBounds","rightBounds","changed","layer","predistorted","addFullscreenListeners_","request","exitFullscreen","getLayers","vrdisplay","changeHandler","errorHandler","fullscreenEnabled","webkitFullscreenEnabled","mozFullScreenEnabled","msFullscreenEnabled","submitFrame","getEyeParameters","whichEye","CardboardDistorter","gl","ctxAttribs","getContextAttributes","meshWidth","meshHeight","bufferScale","bufferWidth","drawingBufferWidth","bufferHeight","drawingBufferHeight","realBindFramebuffer","bindFramebuffer","realEnable","enable","realDisable","disable","realColorMask","colorMask","realClearColor","clearColor","realViewport","viewport","realCanvasWidth","__proto__","realCanvasHeight","isPatched","lastBoundFramebuffer","cullFace","depthTest","blend","scissorTest","stencilTest","attribs","texCoord","program","linkProgram","distortionVS","distortionFS","getProgramUniforms","viewportOffsetScale","setTextureBounds","vertexBuffer","createBuffer","indexBuffer","indexCount","renderTarget","createTexture","framebuffer","createFramebuffer","depthStencilBuffer","depthBuffer","stencilBuffer","depth","stencil","createRenderbuffer","patch","onResize","cardboardUI","CardboardUI","WGLUPreserveGLState","destroy","unpatch","deleteProgram","deleteBuffer","deleteTexture","deleteFramebuffer","deleteRenderbuffer","glState","RENDERBUFFER_BINDING","TEXTURE_BINDING_2D","TEXTURE0","FRAMEBUFFER","SCISSOR_TEST","clear","COLOR_BUFFER_BIT","bindTexture","TEXTURE_2D","texImage2D","RGBA","RGB","UNSIGNED_BYTE","texParameteri","TEXTURE_MAG_FILTER","LINEAR","TEXTURE_MIN_FILTER","TEXTURE_WRAP_S","CLAMP_TO_EDGE","TEXTURE_WRAP_T","framebufferTexture2D","COLOR_ATTACHMENT0","bindRenderbuffer","RENDERBUFFER","renderbufferStorage","DEPTH_STENCIL","framebufferRenderbuffer","DEPTH_STENCIL_ATTACHMENT","DEPTH_COMPONENT16","DEPTH_ATTACHMENT","STENCIL_INDEX8","STENCIL_ATTACHMENT","checkFramebufferStatus","FRAMEBUFFER_COMPLETE","getScreenWidth","getScreenHeight","defineProperty","configurable","enumerable","get","set","getParameter","FRAMEBUFFER_BINDING","CULL_FACE","DEPTH_TEST","BLEND","STENCIL_TEST","pname","COLOR_WRITEMASK","COLOR_CLEAR_VALUE","VIEWPORT","h","safariCssSizeWorkaround","DIRTY_SUBMIT_FRAME_BINDINGS","CURRENT_PROGRAM","ARRAY_BUFFER_BINDING","ELEMENT_ARRAY_BUFFER_BINDING","useProgram","bindBuffer","ELEMENT_ARRAY_BUFFER","ARRAY_BUFFER","enableVertexAttribArray","vertexAttribPointer","FLOAT","activeTexture","uniform1i","diffuse","uniform4fv","drawElements","TRIANGLES","UNSIGNED_SHORT","renderNoState","preserveDrawingBuffer","updateDeviceInfo","deviceInfo","vertices","computeMeshVertices_","bufferData","STATIC_DRAW","indices","computeMeshIndices_","lensFrustum","getLeftEyeVisibleTanAngles","noLensFrustum","getLeftEyeNoLensTanAngles","getLeftEyeVisibleScreenRect","vidx","j","lerp","d","distortion","distortInverse","q","device","widthMeters","heightMeters","Uint16Array","halfwidth","halfheight","iidx","getOwnPropertyDescriptor_","descriptor","uiVS","uiFS","gearOffset","gearVertexCount","arrowOffset","arrowVertexCount","projMat","listener","DEG2RAD","kAnglePerGearSection","kOuterRimEndAngle","kInnerRimBeginAngle","kOuterRadius","kMiddleRadius","kInnerRadius","kCenterLineThicknessDp","kButtonWidthDp","kTouchSlopFactor","listen","optionsCallback","backCallback","midline","clientWidth","buttonSize","clientX","clientY","clientHeight","addGearSegment","theta","angle","buttonScale","addArrowVertex","buttonBorder","dps","lineWidth","segmentTheta","angledLineWidth","uniform4f","orthoMatrix","uniformMatrix4fv","projectionMat","drawArrays","TRIANGLE_STRIP","CardboardVRDisplay","bufferScale_","poseSensor_","FusionPoseSensor","distorter_","cardboardUI_","dpdb_","Dpdb","onDeviceParamsUpdated_","deviceInfo_","DeviceInfo","getDeviceParams","viewerSelector_","ViewerSelector","on","onViewerChanged_","setViewer","getCurrentViewer","rotateInstructions_","RotateInstructions","onResize_","Eye","LEFT","RIGHT","getPosition","getOrientation","linearVelocity","linearAcceleration","angularVelocity","angularAcceleration","resetPose","fieldOfView","viewer","interLensDistance","getFieldOfViewLeftEye","getFieldOfViewRightEye","renderWidth","renderHeight","newParams","updateDeviceParams","updateBounds_","getContext","show","stopPropagation","preventDefault","isLandscapeMode","showTemporarily","orientationHandler","onOrientationChange_","vrdisplaypresentchangeHandler","fireVRDisplayDeviceParamsChange_","hide","lastWidth","lastHeight","bindings","boundValues","binding","TEXTURE_BINDING_CUBE_MAP","textureUnit","TEXTURE31","ACTIVE_TEXTURE","boundValue","TEXTURE_CUBE_MAP","Device","params","bevelMeters","deviceParams","Viewers","CardboardV2","Distortion","distortionCoefficients","CardboardViewer","label","fov","baselineLensDistance","screenLensDistance","inverseCoefficients","MathUtil","DEFAULT_ANDROID","DEFAULT_IOS","CardboardV1","determineDevice_","getDevice","METERS_PER_INCH","metersPerPixelX","xdpi","metersPerPixelY","ydpi","bevelMm","getDistortedFieldOfViewLeftEye","eyeToScreenDistance","outerDist","innerDist","bottomDist","topDist","outerAngle","radToDeg","atan","distort","innerAngle","bottomAngle","topAngle","leftDegrees","rightDegrees","downDegrees","upDegrees","fovLeft","tan","degToRad","fovTop","fovRight","fovBottom","halfWidth","halfHeight","verticalLensOffset","centerX","centerY","centerZ","screenLeft","screenTop","screenRight","screenBottom","result","undistortedFrustum","dist","eyeX","eyeY","left","right","bottom","opt_isUndistorted","getUndistortedFieldOfViewLeftEye","getUndistortedParams_","getUndistortedViewportLeftEye","screenWidth","screenHeight","xPxPerTanAngle","yPxPerTanAngle","round","eyePosX","eyePosY","halfLensDistance","maxFov","viewerMax","VRDisplayHMDDevice","display","VRDisplayPositionSensorDevice","eyeParameters","currentFieldOfView","maximumFieldOfView","minimumFieldOfView","recommendedFieldOfView","eyeTranslation","renderRect","setFieldOfView","opt_fovLeft","opt_fovRight","opt_zNear","opt_zFar","getState","resetState","positionDevice","coefficients","radius","r0","r1","dr0","dr1","r2","solveLinear_","solveLeastSquares_","matA","vecY","sum","numSamples","numCoefficients","Length","matATA","vecATY","approximateInverse","maxRadius","rp","DPDB_CACHE","format","last_updated","devices","rules","mdmh","ua","dpi","bw","ac","fetchOnline","onDeviceParamsUpdated","dpdb","recalculateDeviceParams_","xhr","XMLHttpRequest","open","ONLINE_DPDB_URL","loading","status","response","send","DeviceParams","newDeviceParams","calcDeviceParams_","db","matched","rule","matchRule_","resX","resY","Emitter","callbacks","WebVRPolyfill","FORCE_ENABLE_VR","K_FILTER","PREDICTION_TIME_S","YAW_ONLY","DEFER_INITIALIZATION","ENABLE_DEPRECATED_API","InitializeWebVRPolyfill","copy","subVectors","normalize","scalar","invScalar","multiplyScalar","applyQuaternion","qx","qy","qz","qw","ix","iy","iz","iw","dot","crossVectors","ax","ay","az","bx","by","bz","Quaternion","quaternion","setFromEulerXYZ","c1","c2","c3","s1","s2","s3","setFromEulerYXZ","setFromAxisAngle","axis","halfAngle","multiply","multiplyQuaternions","qax","qay","qaz","qaw","qbx","qby","qbz","qbw","inverse","slerp","qb","cosHalfTheta","halfTheta","acos","sinHalfTheta","ratioA","ratioB","setFromUnitVectors","EPS","vFrom","vTo","MouseKeyboardVRDisplay","onKeyDown_","onMouseMove_","onMouseDown_","onMouseUp_","phi_","theta_","targetAngle_","angleAnimation_","orientation_","rotateStart_","rotateEnd_","rotateDelta_","isDragging_","orientationOut_","KEY_SPEED","KEY_ANIMATION_DURATION","MOUSE_SPEED_X","MOUSE_SPEED_Y","keyCode","animatePhi_","animateTheta_","targetAngle","animateKeyTransitions_","clamp","angleName","startAngle","startTime","animate","percent","isPointerLocked_","movementX","mozMovementX","movementY","mozMovementY","pointerLockElement","mozPointerLockElement","webkitPointerLockElement","loadIcon_","overlay","style","backgroundColor","fontFamily","zIndex","img","icon","marginLeft","marginTop","text","textAlign","fontSize","lineHeight","margin","snackbar","padding","boxSizing","snackbarText","float","snackbarButton","href","fontWeight","textTransform","borderLeft","paddingLeft","textDecoration","ms","timer","disableShowTemporarily","clearTimeout","base64","ComplementaryFilter","kFilter","currentAccelMeasurement","SensorSample","currentGyroMeasurement","previousGyroMeasurement","filterQ","previousFilterQ","accelQ","isOrientationInitialized","estimatedGravity","measuredGravity","gyroIntegralQ","DEBUG","addAccelMeasurement","vector","timestampS","addGyroMeasurement","deltaT","isTimestampDeltaValid","run_","accelToQuaternion_","sample","gyroDeltaQ","gyroToQuaternionDelta_","invFilterQ","deltaQ","getQuaternionAngle","toFixed","targetQ","accel","normAccel","quat","gyro","dt","accelerometer","gyroscope","onDeviceMotionChange_","onScreenOrientationChange_","posePredictor","PosePredictor","touchPanner","TouchPanner","filterToWorldQ","inverseWorldToScreenQ","worldToScreenQ","originalPoseAdjustQ","setScreenTransform_","resetQ","isFirefoxAndroid","predictedQ","getPrediction","previousTimestampS","out","resetSensor","deviceMotion","accGravity","accelerationIncludingGravity","rotRate","rotationRate","timeStamp","deltaS","MIN_TIMESTEP","MAX_TIMESTEP","beta","gamma","screenOrientation","predictionTimeS","previousQ","outQ","currentQ","angularSpeed","predictAngle","sensorSample","onTouchStart_","onTouchMove_","onTouchEnd_","isTouching","rotateStart","rotateEnd","rotateDelta","ROTATE_SPEED","touches","pageX","pageY","mimeType","isSafari","timestampDeltaS","webkitExitFullscreen","mozCancelFullScreen","msExitFullscreen","webkitFullscreenElement","mozFullScreenElement","msFullscreenElement","vertexSource","fragmentSource","attribLocationMap","createShader","VERTEX_SHADER","shaderSource","compileShader","FRAGMENT_SHADER","createProgram","attachShader","attribName","bindAttribLocation","deleteShader","uniformCount","getProgramParameter","ACTIVE_UNIFORMS","uniformName","uniformInfo","getActiveUniform","getUniformLocation","near","far","lr","bt","nf","mat4_perspectiveFromFieldOfView","upTan","piOver180","rad45","downTan","leftTan","rightTan","xScale","yScale","mat4_fromRotationTranslation","x2","y2","z2","xx","xy","xz","yy","yz","zz","wx","wy","wz","mat4_translate","a00","a01","a02","a03","a10","a11","a12","a13","a20","a21","a22","a23","updateEyeMatrices","projection","view","parameters","vrDisplay","defaultOrientation","defaultPosition","mat4_invert","a30","a31","a32","a33","b00","b01","b02","b03","b04","b05","b06","b07","b08","b09","b10","b11","det","timestamp","selectedKey","localStorage","getItem","VIEWER_KEY","DEFAULT_VIEWER","dialog","createDialog_","CLASS_NAME","selected","checked","contains","getSelectedKey_","input","onSave_","setItem","options","container","background","overflow","boxShadow","createH1_","createChoice_","createButton_","h1","marginBottom","div","onclick","button","letterSpacing","border","AndroidWakeLock","video","paused","iOSWakeLock","setInterval","clearInterval","getWakeLock","match","displays","devicesPopulated","nativeWebVRAvailable","isWebVRAvailable","nativeLegacyWebVRAvailable","isDeprecatedWebVRAvailable","enablePolyfill","enableDeprecatedPolyfill","InstallWebVRSpecShim","populateDevices","isCardboardCompatible","getVRDDevices","mozGetVRDevices","VRControls","onError","gotVRDevices","vrInput","scope","standingMatrix","Matrix4","standing","userHeight","fromArray","updateMatrix","sittingToStandingTransform","applyMatrix","setY","zeroSensor","dispose","gotVRDisplays","vrDisplays","eyeParamsL","eyeWidth","eyeHeight","rendererPixelRatio","getPixelRatio","rendererSize","getSize","rendererUpdateStyle","fovToNDCScaleOffset","pxscale","pxoffset","pyscale","pyoffset","fovPortToProjection","rightHanded","zNear","zFar","handednessScale","mobj","scaleAndOffset","transpose","fovToProjection","fovPort","renderRectL","renderRectR","eyeTranslationL","eyeTranslationR","getVRDisplay","updateStyle","domElement","setFullScreen","boolean","autoSubmitFrame","cameraL","PerspectiveCamera","cameraR","scene","forceClear","autoUpdate","updateMatrixWorld","eyeParamsR","setRenderTarget","setScissorTest","autoClear","matrixWorld","decompose","translateOnAxis","projectionMatrix","scissor","setViewport","setScissor","segmentsHeight","segmentsWidth","segmentsDepth","BoxGeometry","segments","thetaLength","thetaStart","CircleGeometry","openEnded","radiusBottom","radiusTop","segmentsRadial","CylinderGeometry","DodecahedronGeometry","IcosahedronGeometry","OctahedronGeometry","PlaneGeometry","radiusInner","radiusOuter","segmentsPhi","segmentsTheta","RingGeometry","phiLength","phiStart","SphereGeometry","TetrahedronGeometry","arc","radiusTubular","segmentsTubular","TorusGeometry","TorusKnotGeometry","model","BlendCharacter","castShadow","receiveShadow","shading","FlatShading","computeBoundingBox","active","zoom","savedPose","onEnterVR","onExitVR","addHeightOffset","activeCameraEl","setActiveCamera","disableActiveCamera","saveCameraPose","removeHeightOffset","restoreCameraPose","oldOffset","currentPosition","userHeightOffset","headsetConnected","loader","convertUpAxis","colladaModel","EVENTS","CLICK","MOUSEENTER","MOUSEDOWN","MOUSELEAVE","MOUSEUP","STATES","FUSING","HOVERING","HOVERED","fuse","fuseTimeout","cursorEl","mouseDownEl","intersection","intersectedEl","onMouseDown","onMouseUp","onIntersection","onIntersectionCleared","twoWayEmit","els","intersections","clearCurrentIntersection","evtName","dummyGeometry","buffer","mergeTo","oneOf","skipCache","previousData","mesh","Mesh","unuseGeometry","getOrCreateGeometry","toEl","toMesh","merge","mergeTarget","newGeometryType","currentGeometryType","if","groundColor","decay","distance","intensity","penumbra","light","defaultTarget","registerLight","diffData","setLight","onSetTarget","newLight","getLight","translateY","getHex","AmbientLight","DirectionalLight","HemisphereLight","PointLight","SpotLight","targetEl","LEFT_HAND_MODEL_URL","RIGHT_HAND_MODEL_URL","onGripDown","handleButton","onGripUp","onTrackpadDown","onTrackpadUp","onTriggerDown","onTriggerUp","modelUrl","hand","isPressed","trackpadPressed","playAnimation","triggerPressed","gripPressed","animation","animationActive","timeScale","mixer","clipAction","loop","clampWhenFinished","isNullVector","PI_2","hmdEnabled","enableGrabCursor","previousHMDPosition","setupMouseControls","setupHMDControls","pitchObject","yawObject","controls","updateOrientation","updatePosition","onMouseMove","releaseMouse","onTouchStart","onTouchMove","onTouchEnd","mouseDown","dolly","euler","Euler","hmdEuler","currentRotation","deltaRotation","hmdQuaternion","calculateHMDQuaternion","setFromQuaternion","calculateDeltaRotation","previousRotationX","previousRotationY","currentRotationX","currentRotationY","deltaHMDPosition","currentHMDPosition","calculateHMDPosition","sub","setFromMatrixPosition","matrix","previousMouseEvent","screenX","screenY","touchStart","touchStarted","deltaY","parseSide","BackSide","DoubleSide","FrontSide","disposeMaterial","unregisterMaterial","flatShading","updateShader","updateMaterial","newShader","currentShader","updateBehavior","tickProperties","delta","shaderName","shaderInstance","setMaterial","SmoothShading","defaultMaterial","MeshBasicMaterial","registerMaterial","mtl","objLoader","mtlLoader","manager","loadObj","objUrl","mtlUrl","setBaseUrl","lastIndexOf","materials","preload","setMaterials","objModel","scaleDummy","interval","objects","intersectedEls","prevCheckTime","raycaster","Raycaster","updateOriginDirection","refreshObjects","objectEls","prevIntersectedEls","intersectObjects","directionHelper","originVec3","order","autoplay","poolSize","volume","audioLoader","AudioLoader","pool","playSound","srcChanged","setupSound","sound","setLoop","setVolume","updateEventListener","setBuffer","oldEvt","audioListener","AudioListener","cameraEl","PositionalAudio","onended","onEnded","found","zeroScale","controller","buttonStates","previousAxis","hasId","controllers","updatePose","updateButtons","controllerEuler","controllerPosition","controllerQuaternion","setFromRotationMatrix","buttonState","buttons","handleAxes","axes","controllerAxes","handlePress","handleTouch","handleValue","previousButtonState","pressed","touched","KEYCODE_TO_CODE","keyboardevent","CLAMP_VELOCITY","MAX_DELTA","acceleration","adAxis","adEnabled","adInverted","fly","wsAxis","wsEnabled","wsInverted","velocity","onBlur","onFocus","onKeyDown","onKeyUp","onVisibilityChange","attachVisibilityEventListeners","movementVector","updateVelocity","getMovementVector","removeKeyEventListeners","removeVisibilityEventListeners","attachKeyEventListeners","adSign","wsSign","KeyA","ArrowLeft","KeyD","ArrowRight","KeyW","ArrowUp","KeyS","ArrowDown","directionVector","rotationEuler","applyEuler","hidden","VIVE_CONTROLLER_MODEL_OBJ_URL","VIVE_CONTROLLER_MODEL_OBJ_MTL","buttonColor","buttonHighlightColor","mapping","axis0","axis1","button0","button1","button2","button3","button4","onButtonChanged","onButtonDown","onButtonEvent","onButtonUp","onModelLoaded","buttonMeshes","trigger","controllerObject3D","grip","getObjectByName","menu","trackpad","buttonName","updateModel","getMaterialData","fog","wireframe","wireframeLinewidth","textureSrc","updateMap","normalMap","normalScale","ambientOcclusionMap","aoMapIntensity","ambientOcclusionMapIntensity","displacementMap","displacementScale","displacementBias","CubeLoader","CubeTextureLoader","texturePromises","ambientOcclusionTextureOffset","ambientOcclusionTextureRepeat","displacementTextureOffset","displacementTextureRepeat","envMap","normalTextureOffset","normalTextureRepeat","sphericalEnvMap","MeshStandardMaterial","updateDistortionMap","updateEnvMap","isLoadingEnvMap","loadTexture","texture","SphericalReflectionMapping","handleTextureEvents","cube","validateCubemapSrc","urls","removeDefaultCamera","defaultCamera","DEFAULT_CAMERA_ATTR","constants","setupDefaultCamera","defaultCameraEl","DEFAULT_CAMERA_HEIGHT","AFRAME_INJECTED","removeDefaultOffset","addDefaultOffset","cameraEls","newActiveCameraEl","newCameraEl","newCamera","previousCamera","defaultCameraWrapper","createGeometry","geometryType","GeometryClass","geometryInstance","toBufferGeometry","decrementCacheCount","cacheCount","hash","incrementCacheCount","doBuffer","bufferGeometry","BufferGeometry","fromGeometry","metadata","cache","clearCache","cachedGeometry","DEFAULT_LIGHT_ATTR","defaultLights","userDefinedLights","setupDefaultLights","removeDefaultLights","ambientLight","directionalLight","calculateVideoCacheHash","videoEl","videoAttributes","sort","loadImageTexture","doLoadImageTexture","resolveTexture","setTextureProperties","isEl","Texture","statusText","repeatXY","wrapS","RepeatWrapping","wrapT","offsetXY","createVideoEl","fixVideoAttributes","textureCache","clearTextureCache","loadImageCb","loadImage","loadVideoCb","loadVideo","loadCanvasCb","loadCanvas","validateSrc","handleImageTextureLoaded","HAVE_CURRENT_DATA","handleVideoTextureLoaded","videoTextureResult","hashVideo","VideoTexture","minFilter","LinearFilter","uuid","updateMaterials","gamepad","gamepads","getGamepads","linear","ease","ease-in","ease-out","ease-in-out","ease-cubic","ease-in-cubic","ease-out-cubic","ease-in-out-cubic","ease-quad","ease-in-quad","ease-out-quad","ease-in-out-quad","ease-quart","ease-in-quart","ease-out-quart","ease-in-out-quart","ease-quint","ease-in-quint","ease-out-quint","ease-in-out-quint","ease-sine","ease-in-sine","ease-out-sine","ease-in-out-sine","ease-expo","ease-in-expo","ease-out-expo","ease-in-out-expo","ease-circ","ease-in-circ","ease-out-circ","ease-in-out-circ","ease-elastic","ease-in-elastic","ease-out-elastic","ease-in-out-elastic","ease-back","ease-in-back","ease-out-back","ease-in-out-back","ease-bounce","ease-in-bounce","ease-out-bounce","ease-in-out-bounce","ctx","prependedArgs","getDebugNamespaceType","namespace","chunks","getDebugNamespaceColor","settings","colors","storage","debugLib","info","ls","logs","browser","registerPropertyType","defaultValue","defaultParse","defaultStringify","arrayParse","trim","arrayStringify","boolParse","intParse","numberParse","selectorParse","selectorAllParse","selectorStringify","selectorAllStringify","srcParse","parsedUrl","charAt","vecParse","defaultVec","coordinate","vec","vecParseFloat","toVector3","splitName","dummyDolly","_x","_y","_z","image","setMap","longType","shortType","wrap","isImageCb","isVideoCb","isCanvasCb","textureEl","isImage","isVideo","isCanvas","parseUrl","validateImageUrl","validateAndGetQuerySelector","validatedUrls","aCubemap","cubemapSrcRegex","parsedSrc","onResult","onLoad","tester","Image","toCamelCase","camelCase","toUpperCase","transformKeysToCamelCase","camelCaseObj","camelCaseKey","parsedData","createLink","head","link","rel","createStyle","cssText","sheet","styleSheet","createTextNode","register","addFullscreenClass","removeFullscreenClass","onFullScreenChange","fullscreenEl","blur","focus","dataset","aframeCanvas","enterVREl","INSPECTOR_URL","homepage","onKeydown","shortcutPressed","injectInspector","script","INSPECTOR","inspectorInjected","getFog","FogExp2","density","Fog","enterVREnabled","resetSensorEnabled","mixin","dynamic","initPool","availableEls","usedEls","createEntity","requestEntity","returnEntity","createStats","threeStats","ThreeStats","aframeStats","AFrameStats","plugins","RStats","css","fps","caption","below","groups","HIDDEN_CLASS","stats","statsEl","hideBound","showBound","frame","createEnterVRButton","enterVRHandler","vrButton","wrapper","ENTER_VR_CLASS","className","ENTER_VR_BTN_CLASS","createOrientationModal","exitVRHandler","modal","ORIENTATION_MODAL_CLASS","exit","insideLoader","orientationModalEl","updateEnterVRInterface","toggleOrientationModalIfNeeded","uiElement","toggleEnterVRButtonIfNeeded","st","gt","ot","it","at","ut","F","E","R","nodeName","ft","lt","currentTarget","attrChange","Y","prevValue","c","ct","$","ht","G","vt","pt","U","Z","P","nt","X","Q","tt","created","I","S","mt","rt","et","random","T","N","C","isPrototypeOf","L","A","O","M","setPrototypeOf","_","D","yt","H","WebKitMutationObserver","B","Element","Node","nodeType","W","characterData","attributeOldValue","V","J","webkitRequestAnimationFrame","mozRequestAnimationFrame","msRequestAnimationFrame","K","addedNodes","removedNodes","oldValue","childList","subtree","innerHTMLHelper","assignKey","isObj","Wakelock","wakelock","Meta","attrs","exists","Link","createTag","tagObj","meta","MOBILE_HEAD_TAGS","content","MOBILE_IOS_HEAD_TAGS","createAndInjectTag","tag","headScriptEl","headEl","headTags","postMessageAPIHandler","originalPosition","originalRotation","originalParent","originalGroup","outerGroup","Number","EPSILON","sign","Function","nextSource","keysArray","nextIndex","nextKey","MOUSE","MIDDLE","CullFaceNone","CullFaceBack","CullFaceFront","CullFaceFrontBack","FrontFaceDirectionCW","FrontFaceDirectionCCW","BasicShadowMap","PCFShadowMap","PCFSoftShadowMap","NoColors","FaceColors","VertexColors","NoBlending","NormalBlending","AdditiveBlending","SubtractiveBlending","MultiplyBlending","CustomBlending","AddEquation","SubtractEquation","ReverseSubtractEquation","MinEquation","MaxEquation","ZeroFactor","OneFactor","SrcColorFactor","OneMinusSrcColorFactor","SrcAlphaFactor","OneMinusSrcAlphaFactor","DstAlphaFactor","OneMinusDstAlphaFactor","DstColorFactor","OneMinusDstColorFactor","SrcAlphaSaturateFactor","NeverDepth","AlwaysDepth","LessDepth","LessEqualDepth","EqualDepth","GreaterEqualDepth","GreaterDepth","NotEqualDepth","MultiplyOperation","MixOperation","AddOperation","NoToneMapping","LinearToneMapping","ReinhardToneMapping","Uncharted2ToneMapping","CineonToneMapping","UVMapping","CubeReflectionMapping","CubeRefractionMapping","EquirectangularReflectionMapping","EquirectangularRefractionMapping","CubeUVReflectionMapping","CubeUVRefractionMapping","ClampToEdgeWrapping","MirroredRepeatWrapping","NearestFilter","NearestMipMapNearestFilter","NearestMipMapLinearFilter","LinearMipMapNearestFilter","LinearMipMapLinearFilter","UnsignedByteType","ByteType","ShortType","UnsignedShortType","IntType","UnsignedIntType","FloatType","HalfFloatType","UnsignedShort4444Type","UnsignedShort5551Type","UnsignedShort565Type","AlphaFormat","RGBFormat","RGBAFormat","LuminanceFormat","LuminanceAlphaFormat","RGBEFormat","DepthFormat","RGB_S3TC_DXT1_Format","RGBA_S3TC_DXT1_Format","RGBA_S3TC_DXT3_Format","RGBA_S3TC_DXT5_Format","RGB_PVRTC_4BPPV1_Format","RGB_PVRTC_2BPPV1_Format","RGBA_PVRTC_4BPPV1_Format","RGBA_PVRTC_2BPPV1_Format","RGB_ETC1_Format","LoopOnce","LoopRepeat","LoopPingPong","InterpolateDiscrete","InterpolateLinear","InterpolateSmooth","ZeroCurvatureEnding","ZeroSlopeEnding","WrapAroundEnding","TrianglesDrawMode","TriangleStripDrawMode","TriangleFanDrawMode","LinearEncoding","sRGBEncoding","GammaEncoding","RGBEEncoding","LogLuvEncoding","RGBM7Encoding","RGBM16Encoding","RGBDEncoding","BasicDepthPacking","RGBADepthPacking","setHex","setStyle","setScalar","setRGB","setHSL","hue2rgb","euclideanModulo","handleAlpha","string","ColorKeywords","clone","copyGammaToLinear","gammaFactor","copyLinearToGamma","safeInverse","convertGammaToLinear","convertLinearToGamma","getHexString","getHSL","optionalTarget","hue","saturation","hsl","lightness","getStyle","offsetHSL","addColors","color1","color2","addScalar","equals","array","toArray","aliceblue","antiquewhite","aqua","aquamarine","azure","beige","bisque","black","blanchedalmond","blue","blueviolet","brown","burlywood","cadetblue","chartreuse","chocolate","coral","cornflowerblue","cornsilk","crimson","cyan","darkblue","darkcyan","darkgoldenrod","darkgray","darkgreen","darkgrey","darkkhaki","darkmagenta","darkolivegreen","darkorange","darkorchid","darkred","darksalmon","darkseagreen","darkslateblue","darkslategray","darkslategrey","darkturquoise","darkviolet","deeppink","deepskyblue","dimgray","dimgrey","dodgerblue","firebrick","floralwhite","forestgreen","fuchsia","gainsboro","ghostwhite","gold","goldenrod","gray","green","greenyellow","grey","honeydew","hotpink","indianred","indigo","ivory","khaki","lavender","lavenderblush","lawngreen","lemonchiffon","lightblue","lightcoral","lightcyan","lightgoldenrodyellow","lightgray","lightgreen","lightgrey","lightpink","lightsalmon","lightseagreen","lightskyblue","lightslategray","lightslategrey","lightsteelblue","lightyellow","lime","limegreen","linen","magenta","maroon","mediumaquamarine","mediumblue","mediumorchid","mediumpurple","mediumseagreen","mediumslateblue","mediumspringgreen","mediumturquoise","mediumvioletred","midnightblue","mintcream","mistyrose","moccasin","navajowhite","navy","oldlace","olive","olivedrab","orange","orangered","orchid","palegoldenrod","palegreen","paleturquoise","palevioletred","papayawhip","peachpuff","peru","pink","plum","powderblue","purple","red","rosybrown","royalblue","saddlebrown","salmon","sandybrown","seagreen","seashell","sienna","silver","skyblue","slateblue","slategray","slategrey","snow","springgreen","steelblue","teal","thistle","tomato","turquoise","violet","wheat","white","whitesmoke","yellow","yellowgreen","_w","onChangeCallback","setFromEuler","te","m11","m12","m13","m21","m22","m23","m31","m32","m33","trace","conjugate","lengthSq","atan2","onChange","qa","qm","slerpFlat","dst","dstOffset","src0","srcOffset0","src1","srcOffset1","x0","y0","z0","w0","x1","y1","z1","w1","dir","sqrSin","tDir","setX","setComponent","getComponent","addVectors","addScaledVector","subScalar","divide","divideScalar","clampScalar","minVal","maxVal","clampLength","ceil","roundToZero","negate","lengthManhattan","distanceTo","distanceToSquared","dx","dy","setLength","lerpVectors","v2","fromAttribute","itemSize","rotateAround","center","setZ","multiplyVectors","applyAxisAngle","applyMatrix3","applyMatrix4","applyProjection","project","multiplyMatrices","getInverse","unproject","transformDirection","cross","projectOnVector","projectOnPlane","planeNormal","reflect","angleTo","dz","setFromSpherical","sinPhiRadius","phi","setFromMatrixColumn","setFromMatrixScale","sx","sy","sz","setW","setAxisAngleFromQuaternion","setAxisAngleFromRotationMatrix","epsilon","epsilon2","_order","DefaultOrder","RotationOrders","makeRotationFromQuaternion","setFromVector3","reorder","newOrder","optionalResult","Line3","line","distanceSq","closestPointToPointParameter","startP","startEnd","point","clampToLine","startEnd2","startEnd_startP","closestPointToPoint","Box2","setFromPoints","points","makeEmpty","il","expandByPoint","setFromCenterAndSize","halfSize","box","isEmpty","expandByVector","expandByScalar","containsPoint","containsBox","intersectsBox","clampPoint","distanceToPoint","clampedPoint","intersect","union","translate","Box3","setFromArray","minX","minY","minZ","maxX","maxY","maxZ","setFromObject","positions","intersectsSphere","closestPoint","sphere","intersectsPlane","plane","constant","getBoundingSphere","Sphere","Matrix3","n11","n12","n13","n21","n22","n23","n31","n32","n33","identity","setFromMatrix4","applyToVector3Array","applyToBuffer","getX","getY","getZ","setXYZ","determinant","throwOnDegenerate","t11","t12","t13","msg","flattenToArrayOffset","getNormalMatrix","matrix4","transposeIntoArray","n14","n24","n34","n41","n42","n43","n44","copyPosition","extractBasis","xAxis","yAxis","zAxis","makeBasis","extractRotation","scaleX","scaleY","scaleZ","makeRotationFromEuler","ae","af","be","bf","ce","cf","de","df","ad","bc","bd","lookAt","eye","up","premultiply","a14","a24","a34","a41","a42","a43","a44","b12","b13","b14","b21","b22","b23","b24","b31","b32","b33","b34","b41","b42","b43","b44","multiplyToArray","setPosition","t14","getMaxScaleOnAxis","scaleXSq","scaleYSq","scaleZSq","makeTranslation","makeRotationX","makeRotationY","makeRotationZ","makeRotationAxis","tx","ty","makeScale","compose","invSX","invSY","invSZ","makeFrustum","makePerspective","ymax","ymin","xmin","xmax","makeOrthographic","Ray","origin","ray","recast","directionDistance","distanceSqToPoint","distanceSqToSegment","segCenter","segDir","optionalPointOnRay","optionalPointOnSegment","s0","sqrDist","extDet","segExtent","b0","b1","invDet","intersectSphere","tca","d2","radius2","thc","t0","t1","distanceToPlane","denominator","intersectPlane","distToPoint","intersectBox","tmin","tmax","tymin","tymax","tzmin","tzmax","invdirx","invdiry","invdirz","intersectTriangle","edge1","edge2","backfaceCulling","DdN","DdQxE2","DdE1xQ","QdN","optionalCenter","maxRadiusSq","empty","radiusSum","deltaLengthSq","getBoundingBox","Frustum","p4","p5","planes","Plane","frustum","setFromMatrix","me0","me1","me2","me3","me4","me5","me6","me7","me8","me9","me10","me11","me12","me13","me14","me15","setComponents","intersectsObject","boundingSphere","computeBoundingSphere","negRadius","d1","setFromNormalAndCoplanarPoint","setFromCoplanarPoints","inverseNormalLength","distanceToSphere","projectPoint","orthoPoint","perpendicularMagnitude","intersectLine","intersectsLine","startSign","endSign","coplanarPoint","m1","optionalNormalMatrix","referencePoint","normalMatrix","Spherical","other","makeSafe","RAD2DEG","generateUUID","chars","rnd","mapLinear","a1","a2","b2","smoothstep","smootherstep","random16","randInt","low","high","randFloat","randFloatSpread","range","degrees","radians","isPowerOfTwo","nearestPowerOfTwo","LN2","nextPowerOfTwo","Spline","interpolate","intPoint","weight","w2","w3","pa","pb","pc","pd","v3","initFromArray","getPoint","getControlPointsArray","coords","getLength","nSubDivisions","nSamples","oldIntPoint","oldPosition","tmpVec","chunkLengths","totalLength","total","reparametrizeByArcLength","samplingCoef","indexCurrent","indexNext","realDistance","sampling","newpoints","sl","Triangle","resultLengthSq","barycoordFromPoint","dot00","dot01","dot02","dot11","dot12","denom","invDenom","setFromPointsAndIndices","i0","i1","i2","triangle","area","midpoint","edgeList","projectedPoint","minDistance","Interpolant","parameterPositions","sampleValues","sampleSize","resultBuffer","_cachedIndex","valueSize","evaluate","pp","validate_interval","seek","linear_scan","forward_scan","giveUpAt","afterEnd_","t1global","beforeStart_","mid","intervalChanged_","interpolate_","DefaultSettings_","getSettings_","copySampleValue_","stride","CubicInterpolant","_weightPrev","_offsetPrev","_weightNext","_offsetNext","endingStart","endingEnd","iPrev","iNext","tPrev","tNext","halfDt","o1","o0","oP","oN","wP","wN","ppp","sP","sN","DiscreteInterpolant","LinearInterpolant","offset1","offset0","weight1","weight0","QuaternionLinearInterpolant","Clock","autoStart","oldTime","elapsedTime","running","getElapsedTime","getDelta","newTime","EventDispatcher","hasEventListener","_listeners","listeners","listenerArray","Layers","mask","channel","toggle","ascSort","intersectObject","intersects","raycast","Line","LOD","Points","threshold","Sprite","defineProperties","PointCloud","linePrecision","setFromCamera","OrthographicCamera","onRotationChange","onQuaternionChange","Object3DIdCount","DefaultUp","modelViewMatrix","rotationAutoUpdate","matrixAutoUpdate","DefaultMatrixAutoUpdate","matrixWorldNeedsUpdate","frustumCulled","renderOrder","userData","setRotationFromAxisAngle","setRotationFromEuler","setRotationFromMatrix","setRotationFromQuaternion","rotateOnAxis","q1","rotateX","rotateY","rotateZ","translateX","translateZ","localToWorld","worldToLocal","getObjectById","getObjectByProperty","getWorldPosition","getWorldQuaternion","getWorldRotation","getWorldScale","getWorldDirection","traverseVisible","traverseAncestors","force","toJSON","extractFromCache","isRootObject","output","textures","images","generator","Face3","materialIndex","vertexNormals","vertexColors","BufferAttribute","normalized","updateRange","setDynamic","copyAt","index1","index2","copyArray","copyColorsArray","copyIndicesArray","copyVector2sArray","vectors","copyVector3sArray","copyVector4sArray","getW","setXY","setXYZW","Int8Attribute","Int8Array","Uint8Attribute","Uint8Array","Uint8ClampedAttribute","Uint8ClampedArray","Int16Attribute","Int16Array","Uint16Attribute","Int32Attribute","Int32Array","Uint32Attribute","Uint32Array","Float32Attribute","Float64Attribute","Float64Array","DynamicBufferAttribute","InstancedBufferAttribute","meshPerAttribute","InterleavedBuffer","InstancedInterleavedBuffer","InterleavedBufferAttribute","interleavedBuffer","GeometryIdCount","faces","faceVertexUvs","morphTargets","morphNormals","skinWeights","skinIndices","lineDistances","boundingBox","verticesNeedUpdate","elementsNeedUpdate","uvsNeedUpdate","normalsNeedUpdate","colorsNeedUpdate","lineDistancesNeedUpdate","groupsNeedUpdate","vertex","face","jl","fromBufferGeometry","addFace","normals","tempNormals","uvs","tempUVs","uvs2","tempUVs2","uv","uv2","group","computeFaceNormals","ab","fl","vA","vB","vC","computeVertexNormals","areaWeighted","vl","computeMorphNormals","__originalFaceNormal","__originalVertexNormals","tmpGeo","faceNormals","faceNormal","dstNormalsFace","dstNormalsVertex","computeTangents","computeLineDistances","materialIndexOffset","vertexOffset","vertices1","vertices2","faces1","faces2","uvs1","vertexCopy","faceCopy","faceVertexNormals","faceVertexColors","uvCopy","mergeMesh","mergeVertices","verticesMap","unique","changes","precisionPoints","precision","faceIndicesToRemove","dupIndex","idx","sortFacesByMaterialIndex","materialIndexSort","_id","newUvs1","newUvs2","setBit","getNormalIndex","normalsHash","getColorIndex","colorsHash","getUvIndex","uvsHash","hasMaterial","hasFaceUv","hasFaceVertexUv","hasFaceNormal","hasFaceVertexNormal","hasFaceColor","hasFaceVertexColor","faceType","uvsCopy","kl","DirectGeometry","computeGroups","morphTargetsPosition","hasFaceVertexUv2","morphTargetsLength","morphTargetsNormal","morphNormalsLength","hasSkinIndices","hasSkinWeights","vertexUvs","morphTarget","morphNormal","morphAttributes","drawRange","getIndex","setIndex","addAttribute","addGroup","clearGroups","setDrawRange","updateFromObject","direct","__directGeometry","lineDistance","fromDirectGeometry","TypeArray","pA","pB","pC","normalizeNormals","attribute1","attributeArray1","attribute2","attributeArray2","attributeSize","toNonIndexed","geometry2","array2","MaxIndex","InstancedBufferGeometry","maxInstancedCount","instances","Uniform","onUpdateCallback","AnimationClip","tracks","resetDuration","optimize","track","json","jsonTracks","frameTime","KeyframeTrack","clip","clipTracks","CreateFromMorphTargetSequence","morphTargetSequence","noLoop","numMorphTargets","AnimationUtils","getKeyframeOrder","sortedArray","NumberKeyframeTrack","findByName","clipArray","CreateClipsFromMorphTargetSequences","animationToMorphTargets","pattern","parts","animationMorphTargets","clips","parseAnimation","bones","addNonemptyTrack","trackType","trackName","animationKeys","destTracks","flattenJSON","clipName","hierarchyTracks","hierarchy","morphTargetNames","morphTargetName","animationKey","boneName","VectorKeyframeTrack","QuaternionKeyframeTrack","AnimationMixer","_root","_initMemoryManager","_accuIndex","optionalRoot","prototypeAction","rootUuid","clipObject","actionsForClip","_actionsByClip","existingAction","actionByRoot","knownActions","_clip","newAction","_Action","_bindAction","_addInactiveAction","stopAllAction","actions","_actions","nActions","_nActiveActions","_bindings","nBindings","_nActiveBindings","reset","useCount","deltaTime","timeDirection","accuIndex","action","_update","getRoot","uncacheClip","actionsByClip","actionsToRemove","_deactivateAction","cacheIndex","_cacheIndex","lastInactiveAction","_byClipCacheIndex","pop","_removeInactiveBindingsForAction","uncacheRoot","_removeInactiveAction","bindingsByRoot","_bindingsByRootAndName","bindingByName","restoreOriginalState","_removeInactiveBinding","uncacheAction","localRoot","_mixer","_localRoot","nTracks","interpolants","interpolantSettings","interpolant","createInterpolant","_interpolantSettings","_interpolants","_propertyBindings","_timeScaleInterpolant","_weightInterpolant","_loopCount","_effectiveTimeScale","_effectiveWeight","repetitions","zeroSlopeAtStart","zeroSlopeAtEnd","_activateAction","stopFading","stopWarping","_isActiveAction","isScheduled","startAt","mode","setEffectiveWeight","getEffectiveWeight","fadeIn","_scheduleFading","fadeOut","crossFadeFrom","fadeOutAction","warp","fadeInDuration","fadeOutDuration","startEndRatio","endStartRatio","crossFadeTo","fadeInAction","weightInterpolant","_takeBackControlInterpolant","setEffectiveTimeScale","getEffectiveTimeScale","setDuration","syncWith","halt","_currentTimeScale","startTimeScale","endTimeScale","_lendControlInterpolant","timeScaleInterpolant","getMixer","getClip","timeRunning","_updateTimeScale","clipTime","_updateTime","_updateWeight","propertyMixers","accumulate","interpolantValue","loopCount","pingPong","_setEndings","loopDelta","pending","atStart","atEnd","weightNow","weightThen","bindingsByName","referenceCount","_addInactiveBinding","path","parsedPath","PropertyMixer","PropertyBinding","ValueTypeName","getValueSize","_lendBinding","saveOriginalState","_lendAction","_takeBackBinding","_takeBackAction","_controlInterpolants","_nActiveControlInterpolants","inUse","controlInterpolants","knownActionsForClip","lastKnownAction","byClipCacheIndex","prevIndex","lastActiveIndex","firstInactiveAction","firstInactiveIndex","lastActiveAction","propBinding","rootNode","lastInactiveBinding","remove_empty_map","firstInactiveBinding","lastActiveBinding","_controlInterpolantsResultBuffer","__cacheIndex","lastActiveInterpolant","AnimationObjectGroup","var_args","_objects","nCachedObjects_","_indicesByUUID","_paths","_parsedPaths","_bindingsIndicesByPath","bindingsPerObject","nObjects","nCachedObjects","indicesByUUID","paths","parsedPaths","knownObject","firstActiveIndex","lastCachedObject","bindingsForPath","lastCached","lastCachedIndex","firstActiveObject","firstActive","uncache","lastIndex","lastObject","last","subscribe_","indicesByPath","unsubscribe_","lastBindingsIndex","lastBindings","lastBindingsPath","arraySlice","isTypedArray","subarray","convertArray","forceClone","BYTES_PER_ELEMENT","ArrayBuffer","isView","DataView","compareTime","nValues","srcOffset","jsonKeys","valuePropertyName","TimeBufferType","ValueBufferType","setInterpolation","DefaultInterpolation","InterpolantFactoryMethodDiscrete","InterpolantFactoryMethodLinear","InterpolantFactoryMethodSmooth","factoryMethod","getInterpolation","timeOffset","endTime","nKeys","valid","prevTime","currTime","writeIndex","keep","timeNext","offsetP","offsetN","readOffset","writeOffset","_getTrackTypeForValueTypeName","ColorKeyframeTrack","BooleanKeyframeTrack","StringKeyframeTrack","parseTrackName","findNode","getValue","targetArray","setValue","sourceArray","targetObject","objectName","propertyIndex","_getValue_unavailable","_setValue_unavailable","objectIndex","skeleton","nodeProperty","versioning","Versioning","NeedsUpdate","MatrixWorldNeedsUpdate","bindingType","BindingType","Direct","ArrayElement","resolvedProperty","HasFromToArray","EntireArray","GetterByBindingType","SetterByBindingTypeAndVersioning","unbind","_getValue_unbound","_setValue_unbound","Composite","targetGroup","optionalParsedPath","_targetGroup","firstValidIndex","searchSkeleton","bone","searchNodeSubtree","childNode","subTreeNode","mixFunction","bufferType","_slerp","_select","_lerp","_mixBufferRegion","cumulativeWeight","currentWeight","mix","originalValueOffset","Audio","context","createBufferSource","gain","createGain","connect","getInput","playbackRate","hasPlaybackControl","sourceType","getOutput","setNodeSource","audioNode","audioBuffer","currentTime","getFilter","setFilter","setPlaybackRate","getPlaybackRate","getLoop","getVolume","AudioAnalyser","audio","fftSize","analyser","createAnalyser","frequencyBinCount","getByteFrequencyData","AudioContext","webkitAudioContext","panner","createPanner","setRefDistance","refDistance","getRefDistance","setRolloffFactor","rolloffFactor","getRolloffFactor","setDistanceModel","distanceModel","getDistanceModel","setMaxDistance","maxDistance","getMaxDistance","removeFilter","setMasterVolume","getMasterVolume","setOrientation","Camera","matrixWorldInverse","CubeCamera","cubeResolution","cameraPX","cameraNX","cameraPY","cameraNY","cameraPZ","cameraNZ","magFilter","WebGLRenderTargetCube","updateCubeMap","generateMipmaps","activeCubeFace","cx","cy","filmGauge","filmOffset","setLens","focalLength","setFocalLength","vExtentSlope","getFilmHeight","getFocalLength","getEffectiveFOV","getFilmWidth","setViewOffset","fullWidth","fullHeight","offsetX","offsetY","skew","StereoCamera","eyeRight","eyeLeft","eyeSep","eyeSepOnProjection","Light","LightShadow","bias","mapSize","shadow","DirectionalLightShadow","skyColor","power","SpotLightShadow","DefaultLoadingManager","onProgress","setResponseType","decodeAudioData","file","Loader","onLoadStart","onLoadProgress","onLoadComplete","extractUrlBase","initMaterials","texturePath","createMaterial","textureLoader","materialLoader","anisotropy","fullPath","Handlers","MaterialLoader","blending","specular","emissive","shininess","mapDiffuseRepeat","mapDiffuseOffset","mapDiffuseWrap","mapDiffuseAnisotropy","lightMap","mapLightRepeat","mapLightOffset","mapLightWrap","mapLightAnisotropy","aoMap","mapAORepeat","mapAOOffset","mapAOWrap","mapAOAnisotropy","bumpMap","mapBumpRepeat","mapBumpOffset","mapBumpWrap","mapBumpAnisotropy","bumpScale","mapNormalRepeat","mapNormalOffset","mapNormalWrap","mapNormalAnisotropy","specularMap","mapSpecularRepeat","mapSpecularOffset","mapSpecularWrap","mapSpecularAnisotropy","alphaMap","mapAlphaRepeat","mapAlphaOffset","mapAlphaWrap","mapAlphaAnisotropy","setTextures","handlers","cached","overrideMimeType","itemEnd","itemError","responseType","withCredentials","itemStart","setPath","setWithCredentials","FontLoader","Font","substring","JSONLoader","statusDomElement","_statusDomElement","setTexturePath","parseModel","isBitSet","fi","zLength","colorIndex","normalIndex","uvIndex","isQuad","faceA","faceB","uvLayer","nUvLayers","parseSkin","influencesPerVertex","parseMorphing","dstVertices","srcVertices","morphColors","parseAnimations","outputAnimations","animations","morphAnimationClips","LoadingManager","isLoading","itemsLoaded","itemsTotal","BufferGeometryLoader","TYPED_ARRAYS","typedArray","drawcalls","offsets","getTexture","alphaTest","depthWrite","colorWrite","sizeAttenuation","roughnessMap","metalnessMap","emissiveMap","emissiveIntensity","combine","reflectivity","lightMapIntensity","ObjectLoader","parseGeometries","parseImages","parseTextures","parseMaterials","parseObject","geometryLoader","bufferGeometryLoader","widthSegments","heightSegments","depthSegments","radialSegments","innerRadius","outerRadius","thetaSegments","phiSegments","tube","tubularSegments","parseConstant","getGeometry","getMaterial","SkinnedMesh","levels","level","addLevel","CubeTexture","DataTextureLoader","BinaryTextureLoader","_parser","DataTexture","texData","mipmaps","mipmapCount","CompressedTextureLoader","texDatas","CompressedTexture","isCubemap","Material","MaterialIdCount","blendSrc","blendDst","blendEquation","blendSrcAlpha","blendDstAlpha","blendEquationAlpha","depthFunc","clippingPlanes","clipShadows","polygonOffset","polygonOffsetFactor","polygonOffsetUnits","premultipliedAlpha","overdraw","_needsUpdate","setValues","isRoot","srcPlanes","dstPlanes","LineBasicMaterial","linewidth","linecap","linejoin","LineDashedMaterial","dashSize","gapSize","refractionRatio","wireframeLinecap","wireframeLinejoin","skinning","MeshDepthMaterial","depthPacking","MeshLambertMaterial","MeshNormalMaterial","MeshPhongMaterial","defines","STANDARD","envMapIntensity","MeshPhysicalMaterial","PHYSICAL","MultiMaterial","PointsMaterial","lights","clipping","extensions","derivatives","fragDepth","drawBuffers","shaderTextureLOD","defaultAttributeValues","index0AttributeName","UniformsUtils","RawShaderMaterial","SpriteMaterial","encoding","TextureIdCount","sourceFile","DEFAULT_IMAGE","DEFAULT_MAPPING","premultiplyAlpha","flipY","unpackAlignment","getDataURL","toDataURL","drawImage","transformUv","DepthTexture","CanvasTexture","inverseMatrix","testPoint","rayPointDistanceSq","localThresholdSq","intersectPoint","distanceToRay","localThreshold","LineSegments","precisionSq","vStart","vEnd","interSegment","interRay","step","distSq","faceIndex","nbVertices","LineStrip","LinePieces","drawMode","updateMorphTargets","setDrawMode","morphTargetBase","morphTargetInfluences","morphTargetDictionary","ml","getMorphTargetIndexByName","uvIntersection","uv1","uv3","barycoord","checkIntersection","intersectionPointWorld","checkBufferGeometryIntersection","intersectionPoint","uvA","uvB","uvC","tempA","tempB","tempC","fvA","fvB","fvC","isFaceMaterial","faceMaterial","morphInfluences","tl","influence","targets","uvs_f","Bone","skin","Skeleton","boneInverses","useVertexTexture","identityMatrix","boneTextureWidth","boneTextureHeight","boneMatrices","boneTexture","calculateInverses","bl","offsetMatrix","bindMode","bindMatrix","bindMatrixInverse","gbone","pos","rotq","scl","normalizeSkinWeights","sw","skinWeight","getObjectForDistance","matrixPosition","guessSizeSq","Particle","LensFlare","lensFlares","positionScreen","customUpdateCallback","updateLensFlares","flare","vecX","wantedRotation","overrideMaterial","ShaderChunk","merged","uniforms_src","uniforms_dst","parameter_src","UniformsLib","common","offsetRepeat","flipEnvMap","aomap","lightmap","emissivemap","bumpmap","normalmap","displacementmap","roughnessmap","metalnessmap","fogDensity","fogNear","fogFar","fogColor","ambientLightColor","directionalLights","shadowBias","shadowRadius","shadowMapSize","directionalShadowMap","directionalShadowMatrix","spotLights","coneCos","penumbraCos","spotShadowMap","spotShadowMatrix","pointLights","pointShadowMap","pointShadowMatrix","hemisphereLights","ShaderLib","basic","lambert","phong","standard","dashed","totalSize","tCube","tFlip","equirect","tEquirect","distanceRGBA","lightPos","getTargetPixelRatio","_currentRenderTarget","_pixelRatio","glClearColor","_premultipliedAlpha","setDefaultGLState","_currentScissor","_scissor","_currentViewport","_viewport","_clearColor","_clearAlpha","resetGLState","_currentProgram","_currentCamera","_currentGeometryProgram","_currentMaterialId","onContextLost","onTextureDispose","deallocateTexture","_infoMemory","onRenderTargetDispose","deallocateRenderTarget","onMaterialDispose","deallocateMaterial","textureProperties","__image__webglTextureCube","_gl","__webglInit","__webglTexture","delete","renderTargetProperties","depthTexture","__webglFramebuffer","__webglDepthbuffer","releaseMaterialProgramReference","programInfo","programCache","releaseProgram","setupVertexAttributes","startIndex","extension","initAttributes","geometryAttributes","programAttributes","getAttributes","materialDefaultAttributeValues","programAttribute","geometryAttribute","SHORT","UNSIGNED_INT","INT","BYTE","getAttributeBuffer","enableAttributeAndDivisor","enableAttribute","vertexAttrib2fv","vertexAttrib3fv","vertexAttrib4fv","vertexAttrib1fv","disableUnusedAttributes","absNumericalSort","painterSortStable","reversePainterSortStable","pushRenderItem","transparentObjects","transparentObjectsLastIndex","opaqueObjects","opaqueObjectsLastIndex","renderItem","_vector3","isObjectViewable","_sphere","_frustum","_numClippingPlanes","_this","negRad","projectObject","sprites","ImmediateRenderObject","_projScreenMatrix","groupMaterial","renderObjects","renderList","setProgram","renderBufferImmediate","renderBufferDirect","initMaterial","materialProperties","getParameters","_lights","getProgramCode","programChange","shaderID","__webglShader","acquireProgram","numSupportedMorphTargets","maxMorphTargets","numSupportedMorphNormals","maxMorphNormals","numClippingPlanes","_clippingPlanesUniform","lightsHash","ambient","directional","spot","hemi","progUniforms","getUniforms","uniformsList","WebGLUniforms","seqWithValue","seq","dynamicUniforms","splitDynamic","setMaterialFaces","setBlending","setDepthFunc","setDepthTest","setDepthWrite","setColorWrite","setPolygonOffset","setFlipSided","_usedTextureUnits","_clippingEnabled","_localClippingEnabled","useCache","setClippingState","refreshProgram","refreshMaterial","refreshLights","p_uniforms","m_uniforms","logarithmicDepthBuffer","uCamPos","cameraPosition","setOptional","floatVertexTextures","markUniformsLightsNeedsUpdate","refreshUniformsFog","refreshUniformsCommon","refreshUniformsLine","refreshUniformsDash","refreshUniformsPoints","refreshUniformsLambert","refreshUniformsPhong","refreshUniformsPhysical","refreshUniformsStandard","upload","dynUniforms","evalDynamic","uvScaleMap","WebGLRenderTarget","_canvas","setupShadows","lightShadowsLength","shadows","setupLights","ll","viewMatrix","directionalLength","pointLength","spotLength","hemiLength","lightCache","setupGlobalClippingPlanes","localClippingEnabled","_numGlobalClippingPlanes","_globalClippingState","setupClippingPlanes","skipTransform","nPlanes","dstArray","flatSize","viewNormalMatrix","_matrix3","i4","_plane","resetGlobalClippingState","fromCache","_clipRenderingShadows","nGlobal","lGlobal","clippingState","allocTextureUnit","maxTextures","setTextureParameters","textureType","isPowerOfTwoImage","paramThreeToGL","filterFallback","__currentAnisotropy","texParameterf","TEXTURE_MAX_ANISOTROPY_EXT","getMaxAnisotropy","uploadTexture","slot","pixelStorei","UNPACK_FLIP_Y_WEBGL","UNPACK_PREMULTIPLY_ALPHA_WEBGL","UNPACK_ALIGNMENT","clampToMaxSize","maxTextureSize","textureNeedsPowerOfTwo","makePowerOfTwo","glFormat","glType","mipmap","internalFormat","DEPTH_COMPONENT","_isWebGL2","DEPTH_COMPONENT32F","getCompressedTextureFormats","compressedTexImage2D","generateMipmap","__version","setTexture2D","complete","maxSize","HTMLImageElement","HTMLCanvasElement","setCubeTexture","isCompressed","isDataTexture","cubeImage","autoScaleCubemaps","maxCubemapSize","TEXTURE_CUBE_MAP_POSITIVE_X","setCubeTextureDynamic","setupFrameBufferTexture","attachment","textureTarget","setupRenderBufferStorage","renderbuffer","RGBA4","setupDepthTexture","isCube","setTexture","webglDepthTexture","setupDepthRenderbuffer","setupRenderTarget","isTargetPowerOfTwo","updateRenderTargetMipmap","NEAREST","REPEAT","MIRRORED_REPEAT","NEAREST_MIPMAP_NEAREST","NEAREST_MIPMAP_LINEAR","LINEAR_MIPMAP_NEAREST","LINEAR_MIPMAP_LINEAR","UNSIGNED_SHORT_4_4_4_4","UNSIGNED_SHORT_5_5_5_1","UNSIGNED_SHORT_5_6_5","HALF_FLOAT_OES","ALPHA","LUMINANCE","LUMINANCE_ALPHA","FUNC_ADD","FUNC_SUBTRACT","FUNC_REVERSE_SUBTRACT","ZERO","ONE","SRC_COLOR","ONE_MINUS_SRC_COLOR","SRC_ALPHA","ONE_MINUS_SRC_ALPHA","DST_ALPHA","ONE_MINUS_DST_ALPHA","DST_COLOR","ONE_MINUS_DST_COLOR","SRC_ALPHA_SATURATE","COMPRESSED_RGB_S3TC_DXT1_EXT","COMPRESSED_RGBA_S3TC_DXT1_EXT","COMPRESSED_RGBA_S3TC_DXT3_EXT","COMPRESSED_RGBA_S3TC_DXT5_EXT","COMPRESSED_RGB_PVRTC_4BPPV1_IMG","COMPRESSED_RGB_PVRTC_2BPPV1_IMG","COMPRESSED_RGBA_PVRTC_4BPPV1_IMG","COMPRESSED_RGBA_PVRTC_2BPPV1_IMG","COMPRESSED_RGB_ETC1_WEBGL","MIN_EXT","MAX_EXT","_context","_alpha","_depth","_stencil","_antialias","_preserveDrawingBuffer","autoClearColor","autoClearDepth","autoClearStencil","gammaInput","gammaOutput","physicallyCorrectLights","toneMapping","toneMappingExposure","toneMappingWhitePoint","_currentFramebuffer","_currentScissorTest","_width","_height","_scissorTest","_infoRender","calls","memory","programs","getShaderPrecisionFormat","rangeMin","rangeMax","WebGL2RenderingContext","WebGLExtensions","WebGLCapabilities","WebGLState","WebGLProperties","WebGLObjects","WebGLPrograms","WebGLLights","bufferRenderer","WebGLBufferRenderer","indexedBufferRenderer","WebGLIndexedBufferRenderer","shadowMap","WebGLShadowMap","spritePlugin","SpritePlugin","lensFlarePlugin","LensFlarePlugin","forceContextLoss","loseContext","MAX_TEXTURE_MAX_ANISOTROPY_EXT","getPrecision","getClearColor","setClearColor","getClearAlpha","setClearAlpha","bits","DEPTH_BUFFER_BIT","STENCIL_BUFFER_BIT","clearDepth","clearStencil","clearTarget","buffers","hasPositions","hasNormals","hasUvs","hasColors","positionArray","DYNAMIC_DRAW","normalArray","nx","ny","nz","uvArray","colorArray","updateBuffers","geometryProgram","activeInfluences","getWireframeAttribute","dataStart","dataCount","rangeStart","rangeCount","groupStart","groupCount","drawStart","drawEnd","drawCount","setLineWidth","setMode","LINES","TRIANGLE_FAN","LINE_STRIP","POINTS","renderInstances","setFaceCulling","frontFaceDirection","frontFace","CW","CCW","BACK","FRONT","FRONT_AND_BACK","setTextureWarned","setTextureCube","getCurrentRenderTarget","activeMipMapLevel","readRenderTargetPixels","restore","IMPLEMENTATION_COLOR_READ_FORMAT","IMPLEMENTATION_COLOR_READ_TYPE","readPixels","drawArraysInstancedANGLE","drawElementsInstancedANGLE","getExtension","getMaxPrecision","HIGH_FLOAT","MEDIUM_FLOAT","MAX_TEXTURE_IMAGE_UNITS","maxVertexTextures","MAX_VERTEX_TEXTURE_IMAGE_UNITS","MAX_TEXTURE_SIZE","MAX_CUBE_MAP_TEXTURE_SIZE","maxAttributes","MAX_VERTEX_ATTRIBS","maxVertexUniforms","MAX_VERTEX_UNIFORM_VECTORS","maxVaryings","MAX_VARYING_VECTORS","maxFragmentUniforms","MAX_FRAGMENT_UNIFORM_VECTORS","vertexTextures","floatFragmentTextures","_maxPrecision","WebGLGeometries","onGeometryDispose","buffergeometry","_bufferGeometry","deleteAttribute","deleteAttributes","bufferproperty","__webglBuffer","removeAttributeBuffer","updateAttribute","attributeProperties","updateBuffer","usage","bufferSubData","edges","checkEdge","list","WebGLProgram","getEncodingComponents","getTexelDecodingFunction","functionName","getTexelEncodingFunction","getToneMappingFunction","toneMappingName","generateExtensions","rendererExtensions","envMapCubeUV","filterEmptyLine","generateDefines","fetchAttributeLocations","identifiers","ACTIVE_ATTRIBUTES","getActiveAttrib","getAttribLocation","replaceLightNums","numDirLights","numSpotLights","numPointLights","numHemiLights","parseIncludes","include","unrollLoops","snippet","unroll","programIdCount","shadowMapTypeDefine","shadowMapType","envMapTypeDefine","envMapModeDefine","envMapBlendingDefine","prefixVertex","prefixFragment","gammaFactorDefine","customExtensions","customDefines","supportsVertexTextures","maxBones","doubleSided","flipSided","shadowMapEnabled","useFog","fogExp","outputEncoding","mapEncoding","envMapEncoding","emissiveMapEncoding","vertexGlsl","fragmentGlsl","glVertexShader","WebGLShader","glFragmentShader","programLog","getProgramInfoLog","vertexLog","getShaderInfoLog","fragmentLog","runnable","haveDiagnostics","LINK_STATUS","getError","VALIDATE_STATUS","diagnostics","prefix","cachedUniforms","cachedAttributes","usedTimes","allocateBones","nVertexUniforms","nVertexMatrices","getTextureEncodingFromMap","gammaOverrideLinear","shaderIDs","parameterNames","nClipPlanes","envMapMode","pl","addLineNumbers","lines","getShaderParameter","COMPILE_STATUS","_renderer","getDepthMaterial","isPointLight","lightPositionWorld","materialVariants","_depthMaterials","customMaterial","customDepthMaterial","_distanceMaterials","customDistanceMaterial","useMorphing","useSkinning","variantIndex","_MorphingFlag","_SkinningFlag","keyA","keyB","materialsForVariant","_materialCache","cachedMaterial","shadowCamera","_renderList","_lightShadows","_shadowMapSize","_lookTarget","_lightPositionWorld","_NumberOfMaterialVariants","cubeDirections","cubeUps","cube2DViewPorts","depthMaterialTemplate","distanceShader","distanceUniforms","depthMaterial","distanceMaterial","USE_SHADOWMAP","faceCount","vpWidth","vpHeight","pars","shadowMatrix","vpDimensions","clearAlpha","maxVertexAttributes","newAttributes","enabledAttributes","attributeDivisors","compressedTextureFormats","currentBlending","currentBlendEquation","currentBlendSrc","currentBlendDst","currentBlendEquationAlpha","currentBlendSrcAlpha","currentBlendDstAlpha","currentPremultipledAlpha","currentDepthFunc","currentDepthWrite","currentColorWrite","currentStencilWrite","currentStencilFunc","currentStencilRef","currentStencilMask","currentStencilFail","currentStencilZFail","currentStencilZPass","currentFlipSided","currentLineWidth","currentPolygonOffsetFactor","currentPolygonOffsetUnits","currentScissorTest","currentTextureSlot","currentBoundTextures","currentClearColor","currentClearDepth","currentClearStencil","currentScissor","currentViewport","LEQUAL","blendFunc","vertexAttribDivisorANGLE","disableVertexAttribArray","formats","COMPRESSED_TEXTURE_FORMATS","blendEquationSeparate","blendFuncSeparate","NEVER","ALWAYS","LESS","EQUAL","GEQUAL","GREATER","NOTEQUAL","depthMask","setStencilFunc","stencilFunc","stencilRef","stencilMask","setStencilOp","stencilFail","stencilZFail","stencilZPass","stencilOp","setStencilTest","setStencilWrite","stencilWrite","factor","units","POLYGON_OFFSET_FILL","getScissorTest","webglSlot","webglType","webglTexture","boundTexture","UniformContainer","arrayCacheF32","arrayCacheI32","flatten","nBlocks","blockSize","firstElem","allocTexUnits","setValue1f","uniform1f","addr","setValue1i","setValue2fv","uniform2fv","uniform2f","setValue3fv","uniform3f","uniform3fv","setValue4fv","setValue2fm","uniformMatrix2fv","setValue3fm","uniformMatrix3fv","setValue4fm","setValueT1","unit","setValueT6","setValue2iv","uniform2iv","setValue3iv","uniform3iv","setValue4iv","uniform4iv","getSingularSetter","setValue1fv","uniform1fv","setValue1iv","uniform1iv","setValueV2a","setValueV3a","setValueV4a","setValueM2a","setValueM3a","setValueM4a","setValueT1a","tex","setValueT6a","getPureArraySetter","SingleUniform","activeInfo","PureArrayUniform","StructuredUniform","RePathPart","addUniform","uniformObject","parseUniform","pathLength","matchEnd","idIsIndex","subscript","next","flares","elementBuffer","tempTexture","occlusionTexture","renderType","occlusionMap","screenPosition","tempPosition","invAspect","halfViewportWidth","halfViewportHeight","screenPositionPixels","validArea","TEXTURE1","copyTexImage2D","sprite","uvOffset","uvScale","fogType","fillStyle","fillRect","spritePosition","spriteRotation","spriteScale","oldFogType","sceneFogType","isIntersectionBox","isIntersectionSphere","multiplyVector3","multiplyVector3Array","extractPosition","multiplyVector4","rotateAxis","crossVector","rotateByAxis","isIntersectionLine","isIntersectionPlane","setEulerFromRotationMatrix","setEulerFromQuaternion","getPositionFromMatrix","getScaleFromMatrix","getColumnFromMatrix","Face4","Vertex","eulerOrder","getChildByName","renderDepth","useQuaternion","ParticleSystem","onlyShadow","shadowCameraFov","shadowCameraLeft","shadowCameraRight","shadowCameraTop","shadowCameraBottom","shadowCameraNear","shadowCameraFar","shadowCameraVisible","shadowDarkness","shadowMapWidth","shadowMapHeight","addIndex","addDrawCall","indexOffset","clearDrawCalls","computeOffsets","wrapAround","wrapRGB","PointCloudMaterial","ParticleBasicMaterial","ParticleSystemMaterial","metal","supportsFloatTextures","supportsHalfFloatTextures","supportsStandardDerivatives","supportsCompressedTextureS3TC","supportsCompressedTexturePVRTC","supportsBlendMinMax","supportsInstancedArrays","enableScissorTest","addPrePlugin","addPostPlugin","updateShadowMap","shadowMapCullFace","GeometryUtils","geometry1","ImageUtils","loadTextureCube","loadCompressedTexture","loadCompressedTextureCube","Projector","projectVector","unprojectVector","pickingRay","CanvasRenderer","MeshFaceMaterial","CurveUtils","tangentQuadraticBezier","tangentCubicBezier","tangentSpline","h00","h10","h01","h11","SceneUtils","createMultiMaterialObject","detach","attach","ShapeUtils","contour","triangulate","snip","verts","px","py","aX","aY","bX","bY","cX","cY","apx","apy","bpx","bpy","cpx","cpy","cCROSSap","bCROSScp","aCROSSbp","vertIndices","nv","triangulateShape","holes","point_in_segment_2D_colin","inSegPt1","inSegPt2","inOtherPt","intersect_segments_2D","inSeg1Pt1","inSeg1Pt2","inSeg2Pt1","inSeg2Pt2","inExcludeAdjacentSegs","seg1dx","seg1dy","seg2dx","seg2dy","seg1seg2dx","seg1seg2dy","limit","perpSeg1","perpSeg2","factorSeg1","seg1Pt","seg2Pt","seg1min","seg1max","seg1minVal","seg1maxVal","seg2min","seg2max","seg2minVal","seg2maxVal","isPointInsideAngle","inVertex","inLegFromPt","inLegToPt","legFromPtX","legFromPtY","legToPtX","legToPtY","otherPtX","otherPtY","from2toAngle","from2otherAngle","other2toAngle","removeHoles","isCutLineInsideAngles","inShapeIdx","inHoleIdx","lastShapeIdx","shape","prevShapeIdx","nextShapeIdx","insideAngle","hole","lastHoleIdx","prevHoleIdx","nextHoleIdx","intersectsShapeEdge","inShapePt","inHolePt","sIdx","nextIdx","intersectsHoleEdge","ihIdx","chkHole","hIdx","indepHoles","holeIndex","shapeIndex","shapePt","holePt","holeIdx","cutKey","tmpShape1","tmpShape2","tmpHole1","tmpHole2","failedCuts","hl","minShapeIndex","counter","h2","allPointsMap","allpoints","shapeWithoutHoles","triangles","isClockWise","pts","b2p0","b2p1","b2p2","b3","b3p0","b3p1","b3p2","b3p3","Curve","getPointAt","getUtoTmapping","getPoints","divisions","getSpacedPoints","lengths","getLengths","cacheArcLengths","current","updateArcLengths","targetArcLength","arcLengths","comparison","lengthBefore","lengthAfter","segmentLength","segmentFraction","getTangent","pt1","pt2","getTangentAt","getPointFunc","CurvePath","curves","autoClose","curve","closePath","startPoint","endPoint","LineCurve","curveLengths","getCurveLengths","lens","cacheLengths","sums","createPointsGeometry","createSpacedPointsGeometry","generateShapes","createPaths","resolution","createPath","glyph","glyphs","cpx0","cpy0","cpx1","cpy1","cpx2","cpy2","laste","Path","outline","_cachedOutline","moveTo","lineTo","quadraticCurveTo","bezierCurveTo","ha","shapes","toShapes","fromPoints","lastargs","aCPx","aCPy","QuadraticBezierCurve","aCP1x","aCP1y","aCP2x","aCP2y","CubicBezierCurve","splineThru","npts","SplineCurve","aRadius","aStartAngle","aEndAngle","aClockwise","absarc","absellipse","ellipse","xRadius","yRadius","aRotation","EllipseCurve","lastPoint","item","spts","spline","deltaAngle","tdivisions","isCCW","noHoles","extractSubpaths","inActions","subPaths","lastPath","toShapesNoHoles","inSubpaths","tmpPath","tmpShape","Shape","isPointInsidePolygon","inPt","inPolygon","polyLen","inside","edgeLowPt","edgeHighPt","edgeDx","edgeDy","perpEdge","solid","holesFirst","tmpPoints","betterShapeHoles","newShapes","newShapeHoles","mainIdx","ambiguous","toChange","sLen","sho","ho","hole_unassigned","s2Idx","froms","tos","tmpHoles","extrude","ExtrudeGeometry","makeGeometry","ShapeGeometry","getPointsHoles","holesPts","extractAllPoints","extractPoints","tangent","point0","point1","point2","point3","ArcCurve","LineCurve3","QuadraticBezierCurve3","CubicBezierCurve3","SplineCurve3","CatmullRomCurve3","CubicPoly","pz","c0","initNonuniformCatmullRom","x3","dt0","dt1","dt2","initCatmullRom","tension","calc","closed","ClosedSplineCurve3","BoxBufferGeometry","CubeGeometry","calculateVertexCount","buildPlane","udir","vdir","gridX","gridY","segmentWidth","segmentHeight","widthHalf","heightHalf","depthHalf","gridX1","gridY1","vertexCounter","vertexBufferOffset","uvBufferOffset","numberOfVertices","indexBufferOffset","vertexCount","CircleBufferGeometry","ii","segment","CylinderBufferGeometry","calculateIndexCount","generateTorso","tanTheta","indexRow","indexArray","i3","generateCap","centerIndexStart","centerIndexEnd","EdgesGeometry","thresholdAngle","sortFunction","thresholdDot","edge","vert1","vert2","face1","face2","addShapeList","addShape","scalePt2","getBevelVec","inPrev","inNext","v_trans_x","v_trans_y","shrink_by","v_prev_x","v_prev_y","v_next_x","v_next_y","v_prev_lensq","collinear0","v_prev_len","v_next_len","ptPrevShift_x","ptPrevShift_y","ptNextShift_x","ptNextShift_y","sf","v_trans_lensq","direction_eq","buildLidFaces","bevelEnabled","vlen","flen","f3","steps","bevelSegments","buildSideFaces","layeroffset","sidewalls","ahole","slen1","slen2","f4","shapesOffset","uvgen","generateTopUV","wallContour","stepIndex","stepsLength","contourIndex1","contourIndex2","generateSideWallUV","extrudePts","splineTube","binormal","position2","bevelThickness","bevelSize","curveSegments","extrudePath","extrudeByPath","UVGenerator","WorldUVGenerator","frames","TubeGeometry","FrenetFrames","shapePoints","bs","vert","contourMovements","oneHoleMovements","holesMovements","verticesMovements","binormals","indexA","indexB","indexC","indexD","LatheBufferGeometry","base","inverseSegments","n1","n2","LatheGeometry","PlaneBufferGeometry","width_half","height_half","segment_width","segment_height","offset2","RingBufferGeometry","radiusStep","thetaSegmentLevel","SphereBufferGeometry","thetaEnd","verticesRow","v4","TextGeometry","font","TorusBufferGeometry","TorusKnotBufferGeometry","calculatePositionOnCurve","cu","su","quOverP","cs","P1","P2","heightScale","taper","NoTaper","ip","jp","uva","uvb","uvc","uvd","grid","numpoints","pos2","tangents","SinusoidalTaper","initialNormal3","smallest","MAX_VALUE","tz","mat","PolyhedronGeometry","prepare","that","azimuth","inclination","make","centroid","azi","correctUV","subdivide","cols","aj","bj","rows","ParametricGeometry","func","slices","stacks","sliceCount","WireframeGeometry","numEdges","ol","numTris","AxisHelper","ArrowHelper","lineGeometry","coneGeometry","headLength","headWidth","cone","setDirection","setColor","BoxHelper","BoundingBoxHelper","CameraHelper","addLine","addPoint","pointMap","hexFrustum","hexCone","hexUp","hexTarget","hexCross","setPoint","DirectionalLightHelper","lightPlane","targetLine","EdgesHelper","FaceNormalsHelper","nNormals","objGeometry","GridHelper","setColors","colorCenterLine","colorGrid","HemisphereLightHelper","sphereSize","lightSphere","PointLightHelper","SkeletonHelper","getBoneList","boneList","matrixWorldInv","boneMatrix","SpotLightHelper","vector2","coneLength","coneWidth","VertexNormalsHelper","objPos","objNorm","WireframeHelper","renderCallback","MorphBlendMesh","animationsMap","animationsList","numFrames","startFrame","endFrame","createAnimation","setAnimationWeight","lastFrame","currentFrame","directionBackwards","mirroredLoop","autoCreateAnimations","firstAnimation","frameRanges","morph","setAnimationDirectionForward","setAnimationDirectionBackward","setAnimationFPS","setAnimationDuration","setAnimationTime","getAnimationTime","getAnimationDuration","stopAnimation","keyframe","runTimeout","fun","cachedSetTimeout","runClearTimeout","marker","cachedClearTimeout","cleanUpNextTick","draining","currentQueue","queue","queueIndex","drainQueue","run","Item","noop","nextTick","title","env","argv","versions","addListener","once","off","removeListener","removeAllListeners","cwd","chdir","umask","look-controls","wasd-controls","look-controls-enabled","wasd-controls-enabled","user-height","cursor-color","cursor-maxdistance","cursor-offset","cursor-opacity","cursor-scale","cursor-visible","cursor","fuse-timeout","open-ended","theta-length","theta-start","ground-color","meshMixin","segments-width","segments-height","unCamelCase","meshPrimitives","geometryName","geometryHyphened","nowOffset","measure","rStats","iterateKeys","importCSS","Graph","_dom","_defArg","_init","_elWidth","_elHeight","_ctx","_draw","alarm","_current","_max","_alarmCanvas","_dotCanvas","_def","_dotCtx","globalAlpha","_alarmCtx","draw","StackGraph","_num","th","_colours","PerfCounter","_average","average","_accumValue","_accumSamples","_accumStart","avgMs","_averageValue","_start","_time","_settings","userTimingAPI","_started","_end","_tick","_spanValueText","nodeValue","over","_graph","_frame","_total","_set","_spanId","_spanValue","textContent","_div","_perf","idArg","_perfCounters","fractions","_base","legend","graph","colours","_cssFont","_cssRStats","CSSPath","_css","uri","glStats","_h","_rS","_totalDrawArraysCalls","_totalDrawElementsCalls","_totalBindTexures","_totalUseProgramCalls","_totalFaces","_totalVertices","_totalPoints","_attach","WebGLRenderingContext","_values","allcalls","drawelements","drawarrays","_groups","_fractions","renderer.info.memory.geometries","renderer.info.memory.textures","renderer.info.programs","renderer.info.render.calls","renderer.info.render.faces","renderer.info.render.points","renderer.info.render.vertices","BrowserStats","_size","log1024","_usedJSHeapSize","usedJSHeapSize","_totalJSHeapSize","totalJSHeapSize","getEntityCount","getEntriesByName","_scene","useColors","firebug","exception","table","$1","formatArgs","humanize","lastC","save","namespaces","removeItem","localstorage","chrome","local","formatters","weightSchedule","warpSchedule","loadedObject","skinnedMesh","animName","crossfade","fromAnimName","toAnimName","fromAction","toAction","applyWeight","getWeight","pauseAll","unPauseAll","stopAll","showModel","getForward","forward","raw","getKeyValueChunks","Boolean","nextSplit","sep","hasUnclosedUrl","chunk","regexp","vertex_pattern","normal_pattern","uv_pattern","face_vertex","face_vertex_uv","face_vertex_uv_normal","face_vertex_normal","object_pattern","smoothing_pattern","material_library_pattern","material_use_pattern","_createParserState","materialLibraries","startObject","fromDeclaration","smooth","parseVertexIndex","parseNormalIndex","parseUVIndex","addVertex","addVertexLine","addNormal","addUV","addUVLine","ub","uc","ud","na","nb","nc","nd","vLen","ia","ib","ic","uvLen","nLen","addLineGeometry","vi","uvi","lineFirstChar","lineSecondChar","lineLength","trimLeft","lineParts","lineVertices","lineUVs","li","llen","isLine","materialLine","timeEnd","baseUrl","setMaterialOptions","materialOptions","delimiter_pattern","materialsInfo","ss","materialCreator","MaterialCreator","setManager","materialsArray","nameLookup","convert","converted","mn","covmat","lprop","normalizeRGB","ignoreZeroRGBs","materialName","getAsArray","createMaterial_","selectColor","prevColor","disabled","curr","prev","coerce","formatter","logFn","skips","stack","readyCallback","progressCallback","failCallback","implementation","createDocument","onreadystatechange","readyCallbackFunc","getResponseHeader","responseText","alert","callBack","COLLADA","DOMParser","parseFromString","parseAsset","setUpConversion","parseLib","_Image","effects","Effect","cameras","Controller","Animation","visualScenes","VisualScene","kinematicsModels","KinematicsModel","morphs","skins","visualScene","parseScene","nodes","createSceneGraph","colladaUnit","createAnimations","kinematicsModel","parseKinematicsModel","createKinematics","animData","kinematics","dae","setPreferredShading","preferredShading","childNodes","meter","colladaUp","classSpec","lib","elementsLength","daeElement","sceneElement","kinematicsModelElement","recurseHierarchy","getChildById","colladaId","sids","calcAnimationBounds","ID","sampler","createMorph","ctrl","morphCtrl","InstanceController","target_id","daeGeometry","setupSkeleton","world","localworld","channels","setupSkinningMatrices","joints","sid","inv","invBindMatrices","invBindMatrix","skinningMatrix","animatrix","weights","joint","flattenSkeleton","walk","parentid","skinToBindPose","skinController","skinned","applySkin","instanceCtrl","animationBounds","getChildBySid","bonelist","sortedbones","bindShapeMatrix","indicies","animationdata","rot","jointMap","_addToMap","jointIndex","parentVisualElement","parentVisualElementId","colladaNode","zeroPosition","getJointValue","jointData","setJointValue","limits","static","threejsNode","transform","elementsFloat32Arr","elementsRowMajor","visualTarget","visualTargetElement","morphController","inst_geom","InstanceGeometry","instance_material","second","double_sided_materials","first_material","instance_geometry","instance_materials","used_materials","used_materials_array","num_materials","effect_id","instance_effect","material3js","symbol","_copied_material","geom","geometry3js","daeMaterial","isLineStrip","instance_camera","cparams","cam","yfov","aspect_ratio","znear","zfar","instance_light","lparams","technique","falloff_angle","centerGeometry","getLibraryNode","attObj","getNamedItem","getChannelsForNode","bakeAnimations","member","fullSid","getTransformBySid","arrIndices","getConvertedIndex","getConvertedMember","findKey","Key","timeNdx","findTimeNdx","addTarget","hasTarget","interpolateKeys","retVal","ndx","prevKey","getPrevKeyWith","getNextKeyWith","prevTarget","getTarget","nextData","init_from","Morph","method","Skin","Transform","InstanceMaterial","Polygons","inputs","vcount","Polylist","LineStrips","Triangles","Accessor","Vertices","Input","semantic","Source","ColorOrTexture","texcoord","texOpts","Surface","Sampler2D","wrap_s","wrap_t","minfilter","magfilter","mipfilter","surface","InstanceEffect","Channel","dotSyntax","arrSyntax","Sampler","strideOut","InstanceCamera","InstanceLight","links","Joint","middlePosition","attachments","Attachment","_source","sources","_bools","_strings","_floats","_ints","_trimString","_attr_as_int","loadTextureImage","extractDoubleSided","upAxis","upConversion","fixCoords","getConvertedTranslation","getConvertedVec3","arr","getConvertedMat4","members","subdivideFaces","defaultEnvMap","parseInputs","read","parseJoints","parseWeights","numBones","vertex_weights","getChannelForTransform","transformSid","iNode","instance","vertexData","setVertices","handlePrimitive","calcNormals","idx32","numParams","pList","vcIndex","maxOffset","texture_sets","pCount","vs","ns","ts","accessor","NORMAL","TEXCOORD","COLOR","uvArr","clr","param","isTexture","opaque","rgba","offsetU","offsetV","repeatU","repeatV","wrapU","wrapV","parseTexture","bumpType","transparencyLevel","transparency","emission","bump","cot","samplerId","surfaceId","parseTechnique","parseProfileCOMMON","parseNewparam","_image","parseExtra","parseExtraTechnique","anim","opt_sid","nextTarget","parseOptics","perspective","xfov","orthographic","xmag","ymag","parseCommon","profile","axisElement","_axis","jointTypes","jointElement","38","37","40","39","87","65","83","68","isIFrame","appendQueryParameter","getQueryParameter","short","long","plural"],"mappings":"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","file":"bundle.js","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})","module.exports={\"name\":\"aframe\",\"version\":\"0.3.2\",\"description\":\"Building blocks for the VR Web\",\"homepage\":\"https://aframe.io/\",\"main\":\"dist/aframe.js\",\"scripts\":{\"browserify\":\"browserify src/index.js -s 'AFRAME' -p browserify-derequire\",\"build\":\"mkdirp build/ && npm run browserify -- --debug -o build/aframe.js\",\"codecov\":\"codecov\",\"dev\":\"npm run build && node ./scripts/budo\",\"dist\":\"npm run dist:min && npm run dist:max\",\"dist:max\":\"npm run browserify -s -- --debug | exorcist dist/aframe.js.map > dist/aframe.js\",\"dist:min\":\"npm run browserify -s -- --debug -p [minifyify --map aframe.min.js.map --output dist/aframe.min.js.map] -o dist/aframe.min.js\",\"dist:release\":\"npm run dist:release:min && npm run dist:release:max\",\"dist:release:max\":\"npm run browserify -s -- --debug | exorcist dist/aframe-v0.3.0.js.map > dist/aframe-v0.3.0.js\",\"dist:release:min\":\"npm run browserify -s -- --debug -p [minifyify --map aframe-v0.3.0.min.js.map --output dist/aframe-v0.3.0.min.js.map] -o dist/aframe-v0.3.0.min.js\",\"ghpages\":\"ghpages -p gh-pages/\",\"lint\":\"semistandard -v | snazzy\",\"precommit\":\"npm run lint\",\"preghpages\":\"npm run dist && rimraf gh-pages && mkdirp gh-pages && cp -r {.nojekyll,dist,lib,examples,index.html,style} gh-pages/. 2>/dev/null || : && git checkout dist/ && replace 'build/aframe.js' 'dist/aframe.min.js' gh-pages/ -r --silent\",\"release:bump\":\"npm run dist && git commit -am 'bump dist' && npm version patch --preminor\",\"release:push\":\"npm login && npm publish && git push --follow-tags\",\"start\":\"npm run dev\",\"test\":\"karma start ./tests/karma.conf.js\",\"test:firefox\":\"karma start ./tests/karma.conf.js --browsers Firefox\",\"test:chrome\":\"karma start ./tests/karma.conf.js --browsers Chrome\",\"test:ci\":\"TEST_ENV=ci karma start ./tests/karma.conf.js --single-run --browsers Firefox\",\"version\":\"npm run dist\"},\"repository\":\"aframevr/aframe\",\"license\":\"MIT\",\"dependencies\":{\"browserify-css\":\"^0.8.2\",\"debug\":\"^2.2.0\",\"deep-assign\":\"^2.0.0\",\"document-register-element\":\"dmarcos/document-register-element#8ccc532b7\",\"object-assign\":\"^4.0.1\",\"present\":\"0.0.6\",\"promise-polyfill\":\"^3.1.0\",\"style-attr\":\"^1.0.2\",\"three\":\"^0.76.1\",\"tween.js\":\"^15.0.0\",\"webvr-polyfill\":\"0.9.15\"},\"devDependencies\":{\"browserify\":\"^13.1.0\",\"browserify-derequire\":\"^0.9.4\",\"browserify-istanbul\":\"^2.0.0\",\"budo\":\"^9.2.0\",\"chai\":\"^3.5.0\",\"chai-shallow-deep-equal\":\"^1.4.0\",\"codecov\":\"^1.0.1\",\"exorcist\":\"^0.4.0\",\"ghpages\":\"0.0.8\",\"husky\":\"^0.11.7\",\"istanbul\":\"^0.4.5\",\"karma\":\"^1.3.0\",\"karma-browserify\":\"^5.1.0\",\"karma-chai-shallow-deep-equal\":\"0.0.4\",\"karma-chrome-launcher\":\"^2.0.0\",\"karma-coverage\":\"^1.1.1\",\"karma-env-preprocessor\":\"^0.1.1\",\"karma-firefox-launcher\":\"^1.0.0\",\"karma-mocha\":\"^1.1.1\",\"karma-mocha-reporter\":\"^2.1.0\",\"karma-sinon-chai\":\"^1.2.4\",\"lolex\":\"^1.5.1\",\"minifyify\":\"^7.3.3\",\"mkdirp\":\"^0.5.1\",\"mocha\":\"^3.0.2\",\"mozilla-download\":\"^1.1.1\",\"open\":\"0.0.5\",\"replace\":\"^0.3.0\",\"rimraf\":\"^2.5.4\",\"semistandard\":\"^9.0.0\",\"sinon\":\"^1.17.5\",\"sinon-chai\":\"^2.8.0\",\"snazzy\":\"^5.0.0\",\"uglifyjs\":\"^2.4.10\"},\"link\":true,\"browserify\":{\"transform\":[\"browserify-css\"]},\"semistandard\":{\"ignore\":[\"build/**\",\"dist/**\",\"examples/**/shaders/*.js\",\"**/vendor/**\"]},\"keywords\":[\"3d\",\"aframe\",\"cardboard\",\"components\",\"oculus\",\"three\",\"three.js\",\"rift\",\"vive\",\"vr\",\"web-components\",\"webvr\"],\"browserify-css\":{\"minify\":true},\"engines\":{\"node\":\">= 0.12.7\",\"npm\":\"^2.12.1\"}}","var css = \".a-html{bottom:0;left:0;position:fixed;right:0;top:0}.a-body{height:100%;margin:0;overflow:hidden;padding:0;width:100%}:-webkit-full-screen{background-color:transparent}.a-hidden{display:none!important}.a-canvas{height:100%;left:0;position:absolute;top:0;width:100%}.a-canvas.a-grab-cursor:hover{cursor:grab;cursor:-moz-grabbing;cursor:-webkit-grab}.a-canvas.a-grab-cursor:active,.a-grabbing{cursor:grabbing;cursor:-moz-grabbing;cursor:-webkit-grabbing}// Class is removed when doing <a-scene embedded>. .a-canvas.fullscreen{width:100%!important;height:100%!important;top:0!important;left:0!important;right:0!important;bottom:0!important;z-index:999999!important;position:fixed!important}a-scene{display:block;position:relative;height:100%;width:100%}a-assets,a-scene audio,a-scene img,a-scene video{display:none}.a-enter-vr-modal,.a-orientation-modal{font-family:Consolas,Andale Mono,Courier New,monospace}.a-enter-vr-modal a{border-bottom:1px solid #fff;padding:2px 0;text-decoration:none;transition:.1s color ease-in}.a-enter-vr-modal a:hover{background-color:#fff;color:#111;padding:2px 4px;position:relative;left:-4px}.a-enter-vr{font-family:sans-serif,monospace;font-size:13px;width:100%;font-weight:200;line-height:16px;height:10%;position:absolute;right:20px;bottom:20px}.a-enter-vr.embedded{right:5px;bottom:5px}.a-enter-vr-button,.a-enter-vr-modal,.a-enter-vr-modal a{color:#fff}.a-enter-vr-button{background:url(data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20viewBox%3D%220%200%20245.82%20141.73%22%3E%3Cdefs%3E%3Cstyle%3E.a%7Bfill%3A%23fff%3Bfill-rule%3Aevenodd%3B%7D%3C%2Fstyle%3E%3C%2Fdefs%3E%3Ctitle%3Emask%3C%2Ftitle%3E%3Cpath%20class%3D%22a%22%20d%3D%22M175.56%2C111.37c-22.52%2C0-40.77-18.84-40.77-42.07S153%2C27.24%2C175.56%2C27.24s40.77%2C18.84%2C40.77%2C42.07S198.08%2C111.37%2C175.56%2C111.37ZM26.84%2C69.31c0-23.23%2C18.25-42.07%2C40.77-42.07s40.77%2C18.84%2C40.77%2C42.07-18.26%2C42.07-40.77%2C42.07S26.84%2C92.54%2C26.84%2C69.31ZM27.27%2C0C11.54%2C0%2C0%2C12.34%2C0%2C28.58V110.9c0%2C16.24%2C11.54%2C30.83%2C27.27%2C30.83H99.57c2.17%2C0%2C4.19-1.83%2C5.4-3.7L116.47%2C118a8%2C8%2C0%2C0%2C1%2C12.52-.18l11.51%2C20.34c1.2%2C1.86%2C3.22%2C3.61%2C5.39%2C3.61h72.29c15.74%2C0%2C27.63-14.6%2C27.63-30.83V28.58C245.82%2C12.34%2C233.93%2C0%2C218.19%2C0H27.27Z%22%2F%3E%3C%2Fsvg%3E) 50% 50%/70% 70% no-repeat rgba(0,0,0,.35);border:0;bottom:0;cursor:pointer;min-width:50px;min-height:30px;padding-right:5%;padding-top:4%;position:absolute;right:0;transition:background-color .05s ease;-webkit-transition:background-color .05s ease;z-index:9999}.a-enter-vr-button:active,.a-enter-vr-button:hover{background-color:#666}[data-a-enter-vr-no-webvr] .a-enter-vr-button{border-color:#666;opacity:.65}[data-a-enter-vr-no-webvr] .a-enter-vr-button:active,[data-a-enter-vr-no-webvr] .a-enter-vr-button:hover{background-color:rgba(0,0,0,.35);cursor:not-allowed}.a-enter-vr-modal{background-color:#666;border-radius:0;display:none;min-height:32px;margin-right:70px;padding:9px;width:280px;right:2%;position:absolute}.a-enter-vr-modal:after{border-bottom:10px solid transparent;border-left:10px solid #666;border-top:10px solid transparent;display:inline-block;content:'';position:absolute;right:-5px;top:5px;width:0;height:0}.a-enter-vr-modal a,.a-enter-vr-modal p{display:inline}.a-enter-vr-modal p{margin:0}.a-enter-vr-modal p:after{content:' '}[data-a-enter-vr-no-headset].a-enter-vr:hover .a-enter-vr-modal,[data-a-enter-vr-no-webvr].a-enter-vr:hover .a-enter-vr-modal{display:block}.a-orientation-modal{background:url(data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20xmlns%3Axlink%3D%22http%3A//www.w3.org/1999/xlink%22%20version%3D%221.1%22%20x%3D%220px%22%20y%3D%220px%22%20viewBox%3D%220%200%2090%2090%22%20enable-background%3D%22new%200%200%2090%2090%22%20xml%3Aspace%3D%22preserve%22%3E%3Cpolygon%20points%3D%220%2C0%200%2C0%200%2C0%20%22%3E%3C/polygon%3E%3Cg%3E%3Cpath%20d%3D%22M71.545%2C48.145h-31.98V20.743c0-2.627-2.138-4.765-4.765-4.765H18.456c-2.628%2C0-4.767%2C2.138-4.767%2C4.765v42.789%20%20%20c0%2C2.628%2C2.138%2C4.766%2C4.767%2C4.766h5.535v0.959c0%2C2.628%2C2.138%2C4.765%2C4.766%2C4.765h42.788c2.628%2C0%2C4.766-2.137%2C4.766-4.765V52.914%20%20%20C76.311%2C50.284%2C74.173%2C48.145%2C71.545%2C48.145z%20M18.455%2C16.935h16.344c2.1%2C0%2C3.808%2C1.708%2C3.808%2C3.808v27.401H37.25V22.636%20%20%20c0-0.264-0.215-0.478-0.479-0.478H16.482c-0.264%2C0-0.479%2C0.214-0.479%2C0.478v36.585c0%2C0.264%2C0.215%2C0.478%2C0.479%2C0.478h7.507v7.644%20%20%20h-5.534c-2.101%2C0-3.81-1.709-3.81-3.81V20.743C14.645%2C18.643%2C16.354%2C16.935%2C18.455%2C16.935z%20M16.96%2C23.116h19.331v25.031h-7.535%20%20%20c-2.628%2C0-4.766%2C2.139-4.766%2C4.768v5.828h-7.03V23.116z%20M71.545%2C73.064H28.757c-2.101%2C0-3.81-1.708-3.81-3.808V52.914%20%20%20c0-2.102%2C1.709-3.812%2C3.81-3.812h42.788c2.1%2C0%2C3.809%2C1.71%2C3.809%2C3.812v16.343C75.354%2C71.356%2C73.645%2C73.064%2C71.545%2C73.064z%22%3E%3C/path%3E%3Cpath%20d%3D%22M28.919%2C58.424c-1.466%2C0-2.659%2C1.193-2.659%2C2.66c0%2C1.466%2C1.193%2C2.658%2C2.659%2C2.658c1.468%2C0%2C2.662-1.192%2C2.662-2.658%20%20%20C31.581%2C59.617%2C30.387%2C58.424%2C28.919%2C58.424z%20M28.919%2C62.786c-0.939%2C0-1.703-0.764-1.703-1.702c0-0.939%2C0.764-1.704%2C1.703-1.704%20%20%20c0.94%2C0%2C1.705%2C0.765%2C1.705%2C1.704C30.623%2C62.022%2C29.858%2C62.786%2C28.919%2C62.786z%22%3E%3C/path%3E%3Cpath%20d%3D%22M69.654%2C50.461H33.069c-0.264%2C0-0.479%2C0.215-0.479%2C0.479v20.288c0%2C0.264%2C0.215%2C0.478%2C0.479%2C0.478h36.585%20%20%20c0.263%2C0%2C0.477-0.214%2C0.477-0.478V50.939C70.131%2C50.676%2C69.917%2C50.461%2C69.654%2C50.461z%20M69.174%2C51.417V70.75H33.548V51.417H69.174z%22%3E%3C/path%3E%3Cpath%20d%3D%22M45.201%2C30.296c6.651%2C0%2C12.233%2C5.351%2C12.551%2C11.977l-3.033-2.638c-0.193-0.165-0.507-0.142-0.675%2C0.048%20%20%20c-0.174%2C0.198-0.153%2C0.501%2C0.045%2C0.676l3.883%2C3.375c0.09%2C0.075%2C0.198%2C0.115%2C0.312%2C0.115c0.141%2C0%2C0.273-0.061%2C0.362-0.166%20%20%20l3.371-3.877c0.173-0.2%2C0.151-0.502-0.047-0.675c-0.194-0.166-0.508-0.144-0.676%2C0.048l-2.592%2C2.979%20%20%20c-0.18-3.417-1.629-6.605-4.099-9.001c-2.538-2.461-5.877-3.817-9.404-3.817c-0.264%2C0-0.479%2C0.215-0.479%2C0.479%20%20%20C44.72%2C30.083%2C44.936%2C30.296%2C45.201%2C30.296z%22%3E%3C/path%3E%3C/g%3E%3C/svg%3E) center/50% 50% no-repeat rgba(244,244,244,1);bottom:0;font-size:14px;font-weight:600;left:0;line-height:20px;right:0;position:fixed;top:0;z-index:9999999}.a-orientation-modal:after{color:#666;content:\\\"Insert phone into Cardboard holder.\\\";display:block;position:absolute;text-align:center;top:70%;transform:translateY(-70%);width:100%}.a-orientation-modal button{background:url(data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20xmlns%3Axlink%3D%22http%3A//www.w3.org/1999/xlink%22%20version%3D%221.1%22%20x%3D%220px%22%20y%3D%220px%22%20viewBox%3D%220%200%20100%20100%22%20enable-background%3D%22new%200%200%20100%20100%22%20xml%3Aspace%3D%22preserve%22%3E%3Cpath%20fill%3D%22%23000000%22%20d%3D%22M55.209%2C50l17.803-17.803c1.416-1.416%2C1.416-3.713%2C0-5.129c-1.416-1.417-3.713-1.417-5.129%2C0L50.08%2C44.872%20%20L32.278%2C27.069c-1.416-1.417-3.714-1.417-5.129%2C0c-1.417%2C1.416-1.417%2C3.713%2C0%2C5.129L44.951%2C50L27.149%2C67.803%20%20c-1.417%2C1.416-1.417%2C3.713%2C0%2C5.129c0.708%2C0.708%2C1.636%2C1.062%2C2.564%2C1.062c0.928%2C0%2C1.856-0.354%2C2.564-1.062L50.08%2C55.13l17.803%2C17.802%20%20c0.708%2C0.708%2C1.637%2C1.062%2C2.564%2C1.062s1.856-0.354%2C2.564-1.062c1.416-1.416%2C1.416-3.713%2C0-5.129L55.209%2C50z%22%3E%3C/path%3E%3C/svg%3E) no-repeat;border:none;height:50px;text-indent:-9999px;width:50px}\"; (require(\"browserify-css\").createStyle(css, { \"href\": \"src/style/aframe.css\"})); module.exports = css;","var css = \".rs-base{background-color:#333;border-radius:0;font:10px monospace;left:5px;line-height:1em;opacity:.85;overflow:hidden;padding:10px;position:fixed;top:5px;width:300px;z-index:10000}.rs-base div.hidden{display:none}.rs-base h1{color:#fff;cursor:pointer;font-size:1.4em;font-weight:300;margin:0 0 5px;padding:0}.rs-group{display:-webkit-box;display:-webkit-flex;display:flex;-webkit-flex-direction:column-reverse;flex-direction:column-reverse;margin-bottom:5px}.rs-group:last-child{margin-bottom:0}.rs-counter-base{align-items:center;display:-webkit-box;display:-webkit-flex;display:flex;height:10px;-webkit-justify-content:space-between;justify-content:space-between;margin:2px 0}.rs-counter-base.alarm{color:#b70000;text-shadow:0 0 0 #b70000,0 0 1px #fff,0 0 1px #fff,0 0 2px #fff,0 0 2px #fff,0 0 3px #fff,0 0 3px #fff,0 0 4px #fff,0 0 4px #fff}.rs-counter-id{font-weight:300;-webkit-box-ordinal-group:0;-webkit-order:0;order:0;width:54px}.rs-counter-value{font-weight:300;-webkit-box-ordinal-group:1;-webkit-order:1;order:1;text-align:right;width:35px}.rs-canvas{-webkit-box-ordinal-group:2;-webkit-order:2;order:2}@media (min-width:480px){.rs-base{left:20px;top:20px}}\"; (require(\"browserify-css\").createStyle(css, { \"href\": \"src/style/rStats.css\"})); module.exports = css;","// Polyfill `Promise`.\nwindow.Promise = window.Promise || require('promise-polyfill');\n\n// Check before the polyfill runs\nwindow.hasNativeWebVRImplementation = !!navigator.getVRDisplays || !!navigator.getVRDevices;\n\nwindow.WebVRConfig = window.WebVRConfig || {\n  BUFFER_SCALE: 1,\n  CARDBOARD_UI_DISABLED: true,\n  ROTATE_INSTRUCTIONS_DISABLED: true,\n  TOUCH_PANNER_DISABLED: true,\n  MOUSE_KEYBOARD_CONTROLS_DISABLED: true\n};\n\n// Workaround for iOS Safari canvas sizing issues in stereo (webvr-polyfill/issues/102).\n// Should be fixed in iOS 10.\nif (/(iphone|ipod|ipad).*os.*(7|8|9)/i.test(navigator.userAgent)) {\n  window.WebVRConfig.BUFFER_SCALE = 1 / window.devicePixelRatio;\n}\n\n// WebVR polyfill\nrequire('webvr-polyfill');\n\nrequire('present'); // Polyfill `performance.now()`.\n// CSS.\nrequire('./style/aframe.css');\nrequire('./style/rStats.css');\n\n// Required before `AEntity` so that all components are registered.\nvar AScene = require('./core/scene/a-scene');\nvar components = require('./core/component').components;\nvar registerComponent = require('./core/component').registerComponent;\nvar registerGeometry = require('./core/geometry').registerGeometry;\nvar registerPrimitive = require('./extras/primitives/primitives').registerPrimitive;\nvar registerShader = require('./core/shader').registerShader;\nvar registerSystem = require('./core/system').registerSystem;\nvar shaders = require('./core/shader').shaders;\nvar systems = require('./core/system').systems;\n// Exports THREE to window so three.js can be used without alteration.\nvar THREE = window.THREE = require('./lib/three');\nvar TWEEN = window.TWEEN = require('tween.js');\n\nvar pkg = require('../package');\nvar utils = require('./utils/');\n\nrequire('./components/index'); // Register standard components.\nrequire('./geometries/index'); // Register standard geometries.\nrequire('./shaders/index'); // Register standard shaders.\nrequire('./systems/index'); // Register standard systems.\nvar ANode = require('./core/a-node');\nvar AEntity = require('./core/a-entity'); // Depends on ANode and core components.\n\nrequire('./core/a-animation');\nrequire('./core/a-assets');\nrequire('./core/a-cubemap');\nrequire('./core/a-mixin');\n\n// Extras.\nrequire('./extras/components/');\nrequire('./extras/primitives/');\n\nconsole.log('A-Frame Version:', pkg.version);\nconsole.log('three Version:', pkg.dependencies['three']);\nconsole.log('WebVR Polyfill Version:', pkg.dependencies['webvr-polyfill']);\n\nmodule.exports = window.AFRAME = {\n  AEntity: AEntity,\n  ANode: ANode,\n  AScene: AScene,\n  components: components,\n  geometries: require('./core/geometry').geometries,\n  registerComponent: registerComponent,\n  registerElement: require('./core/a-register-element').registerElement,\n  registerGeometry: registerGeometry,\n  registerPrimitive: registerPrimitive,\n  registerShader: registerShader,\n  registerSystem: registerSystem,\n  primitives: {\n    getMeshMixin: require('./extras/primitives/getMeshMixin'),\n    primitives: require('./extras/primitives/primitives').primitives\n  },\n  schema: require('./core/schema'),\n  shaders: shaders,\n  systems: systems,\n  THREE: THREE,\n  TWEEN: TWEEN,\n  utils: utils,\n  version: pkg.version\n};\n","(function(root) {\n\n\t// Store setTimeout reference so promise-polyfill will be unaffected by\n\t// other code modifying setTimeout (like sinon.useFakeTimers())\n\tvar setTimeoutFunc = setTimeout;\n\n\t// Use polyfill for setImmediate for performance gains\n\tvar asap = (typeof setImmediate === 'function' && setImmediate) ||\n\t\tfunction(fn) { setTimeoutFunc(fn, 1); };\n\n\t// Polyfill for Function.prototype.bind\n\tfunction bind(fn, thisArg) {\n\t\treturn function() {\n\t\t\tfn.apply(thisArg, arguments);\n\t\t}\n\t}\n\n\tvar isArray = Array.isArray || function(value) { return Object.prototype.toString.call(value) === \"[object Array]\" };\n\n\tfunction Promise(fn) {\n\t\tif (typeof this !== 'object') throw new TypeError('Promises must be constructed via new');\n\t\tif (typeof fn !== 'function') throw new TypeError('not a function');\n\t\tthis._state = null;\n\t\tthis._value = null;\n\t\tthis._deferreds = []\n\n\t\tdoResolve(fn, bind(resolve, this), bind(reject, this))\n\t}\n\n\tfunction handle(deferred) {\n\t\tvar me = this;\n\t\tif (this._state === null) {\n\t\t\tthis._deferreds.push(deferred);\n\t\t\treturn\n\t\t}\n\t\tasap(function() {\n\t\t\tvar cb = me._state ? deferred.onFulfilled : deferred.onRejected\n\t\t\tif (cb === null) {\n\t\t\t\t(me._state ? deferred.resolve : deferred.reject)(me._value);\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tvar ret;\n\t\t\ttry {\n\t\t\t\tret = cb(me._value);\n\t\t\t}\n\t\t\tcatch (e) {\n\t\t\t\tdeferred.reject(e);\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tdeferred.resolve(ret);\n\t\t})\n\t}\n\n\tfunction resolve(newValue) {\n\t\ttry { //Promise Resolution Procedure: https://github.com/promises-aplus/promises-spec#the-promise-resolution-procedure\n\t\t\tif (newValue === this) throw new TypeError('A promise cannot be resolved with itself.');\n\t\t\tif (newValue && (typeof newValue === 'object' || typeof newValue === 'function')) {\n\t\t\t\tvar then = newValue.then;\n\t\t\t\tif (typeof then === 'function') {\n\t\t\t\t\tdoResolve(bind(then, newValue), bind(resolve, this), bind(reject, this));\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis._state = true;\n\t\t\tthis._value = newValue;\n\t\t\tfinale.call(this);\n\t\t} catch (e) { reject.call(this, e); }\n\t}\n\n\tfunction reject(newValue) {\n\t\tthis._state = false;\n\t\tthis._value = newValue;\n\t\tfinale.call(this);\n\t}\n\n\tfunction finale() {\n\t\tfor (var i = 0, len = this._deferreds.length; i < len; i++) {\n\t\t\thandle.call(this, this._deferreds[i]);\n\t\t}\n\t\tthis._deferreds = null;\n\t}\n\n\tfunction Handler(onFulfilled, onRejected, resolve, reject){\n\t\tthis.onFulfilled = typeof onFulfilled === 'function' ? onFulfilled : null;\n\t\tthis.onRejected = typeof onRejected === 'function' ? onRejected : null;\n\t\tthis.resolve = resolve;\n\t\tthis.reject = reject;\n\t}\n\n\t/**\n\t * Take a potentially misbehaving resolver function and make sure\n\t * onFulfilled and onRejected are only called once.\n\t *\n\t * Makes no guarantees about asynchrony.\n\t */\n\tfunction doResolve(fn, onFulfilled, onRejected) {\n\t\tvar done = false;\n\t\ttry {\n\t\t\tfn(function (value) {\n\t\t\t\tif (done) return;\n\t\t\t\tdone = true;\n\t\t\t\tonFulfilled(value);\n\t\t\t}, function (reason) {\n\t\t\t\tif (done) return;\n\t\t\t\tdone = true;\n\t\t\t\tonRejected(reason);\n\t\t\t})\n\t\t} catch (ex) {\n\t\t\tif (done) return;\n\t\t\tdone = true;\n\t\t\tonRejected(ex);\n\t\t}\n\t}\n\n\tPromise.prototype['catch'] = function (onRejected) {\n\t\treturn this.then(null, onRejected);\n\t};\n\n\tPromise.prototype.then = function(onFulfilled, onRejected) {\n\t\tvar me = this;\n\t\treturn new Promise(function(resolve, reject) {\n\t\t\thandle.call(me, new Handler(onFulfilled, onRejected, resolve, reject));\n\t\t})\n\t};\n\n\tPromise.all = function () {\n\t\tvar args = Array.prototype.slice.call(arguments.length === 1 && isArray(arguments[0]) ? arguments[0] : arguments);\n\n\t\treturn new Promise(function (resolve, reject) {\n\t\t\tif (args.length === 0) return resolve([]);\n\t\t\tvar remaining = args.length;\n\t\t\tfunction res(i, val) {\n\t\t\t\ttry {\n\t\t\t\t\tif (val && (typeof val === 'object' || typeof val === 'function')) {\n\t\t\t\t\t\tvar then = val.then;\n\t\t\t\t\t\tif (typeof then === 'function') {\n\t\t\t\t\t\t\tthen.call(val, function (val) { res(i, val) }, reject);\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\targs[i] = val;\n\t\t\t\t\tif (--remaining === 0) {\n\t\t\t\t\t\tresolve(args);\n\t\t\t\t\t}\n\t\t\t\t} catch (ex) {\n\t\t\t\t\treject(ex);\n\t\t\t\t}\n\t\t\t}\n\t\t\tfor (var i = 0; i < args.length; i++) {\n\t\t\t\tres(i, args[i]);\n\t\t\t}\n\t\t});\n\t};\n\n\tPromise.resolve = function (value) {\n\t\tif (value && typeof value === 'object' && value.constructor === Promise) {\n\t\t\treturn value;\n\t\t}\n\n\t\treturn new Promise(function (resolve) {\n\t\t\tresolve(value);\n\t\t});\n\t};\n\n\tPromise.reject = function (value) {\n\t\treturn new Promise(function (resolve, reject) {\n\t\t\treject(value);\n\t\t});\n\t};\n\n\tPromise.race = function (values) {\n\t\treturn new Promise(function (resolve, reject) {\n\t\t\tfor(var i = 0, len = values.length; i < len; i++) {\n\t\t\t\tvalues[i].then(resolve, reject);\n\t\t\t}\n\t\t});\n\t};\n\n\t/**\n\t * Set the immediate function to execute callbacks\n\t * @param fn {function} Function to execute\n\t * @private\n\t */\n\tPromise._setImmediateFn = function _setImmediateFn(fn) {\n\t\tasap = fn;\n\t};\n\n\tif (typeof module !== 'undefined' && module.exports) {\n\t\tmodule.exports = Promise;\n\t} else if (!root.Promise) {\n\t\troot.Promise = Promise;\n\t}\n\n})(this);\n","/**\n * Tween.js - Licensed under the MIT license\n * https://github.com/sole/tween.js\n * ----------------------------------------------\n *\n * See https://github.com/sole/tween.js/graphs/contributors for the full list of contributors.\n * Thank you all, you're awesome!\n */\n\n// performance.now polyfill\n( function ( root ) {\n\n\tif ( 'performance' in root === false ) {\n\t\troot.performance = {};\n\t}\n\n\t// IE 8\n\tDate.now = ( Date.now || function () {\n\t\treturn new Date().getTime();\n\t} );\n\n\tif ( 'now' in root.performance === false ) {\n\t\tvar offset = root.performance.timing && root.performance.timing.navigationStart ? performance.timing.navigationStart\n\t\t                                                                                : Date.now();\n\n\t\troot.performance.now = function () {\n\t\t\treturn Date.now() - offset;\n\t\t};\n\t}\n\n} )( this );\n\nvar TWEEN = TWEEN || ( function () {\n\n\tvar _tweens = [];\n\n\treturn {\n\n\t\tREVISION: '14',\n\n\t\tgetAll: function () {\n\n\t\t\treturn _tweens;\n\n\t\t},\n\n\t\tremoveAll: function () {\n\n\t\t\t_tweens = [];\n\n\t\t},\n\n\t\tadd: function ( tween ) {\n\n\t\t\t_tweens.push( tween );\n\n\t\t},\n\n\t\tremove: function ( tween ) {\n\n\t\t\tvar i = _tweens.indexOf( tween );\n\n\t\t\tif ( i !== -1 ) {\n\n\t\t\t\t_tweens.splice( i, 1 );\n\n\t\t\t}\n\n\t\t},\n\n\t\tupdate: function ( time ) {\n\n\t\t\tif ( _tweens.length === 0 ) return false;\n\n\t\t\tvar i = 0;\n\n\t\t\ttime = time !== undefined ? time : window.performance.now();\n\n\t\t\twhile ( i < _tweens.length ) {\n\n\t\t\t\tif ( _tweens[ i ].update( time ) ) {\n\n\t\t\t\t\ti++;\n\n\t\t\t\t} else {\n\n\t\t\t\t\t_tweens.splice( i, 1 );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\treturn true;\n\n\t\t}\n\t};\n\n} )();\n\nTWEEN.Tween = function ( object ) {\n\n\tvar _object = object;\n\tvar _valuesStart = {};\n\tvar _valuesEnd = {};\n\tvar _valuesStartRepeat = {};\n\tvar _duration = 1000;\n\tvar _repeat = 0;\n\tvar _yoyo = false;\n\tvar _isPlaying = false;\n\tvar _reversed = false;\n\tvar _delayTime = 0;\n\tvar _startTime = null;\n\tvar _easingFunction = TWEEN.Easing.Linear.None;\n\tvar _interpolationFunction = TWEEN.Interpolation.Linear;\n\tvar _chainedTweens = [];\n\tvar _onStartCallback = null;\n\tvar _onStartCallbackFired = false;\n\tvar _onUpdateCallback = null;\n\tvar _onCompleteCallback = null;\n\tvar _onStopCallback = null;\n\n\t// Set all starting values present on the target object\n\tfor ( var field in object ) {\n\n\t\t_valuesStart[ field ] = parseFloat(object[field], 10);\n\n\t}\n\n\tthis.to = function ( properties, duration ) {\n\n\t\tif ( duration !== undefined ) {\n\n\t\t\t_duration = duration;\n\n\t\t}\n\n\t\t_valuesEnd = properties;\n\n\t\treturn this;\n\n\t};\n\n\tthis.start = function ( time ) {\n\n\t\tTWEEN.add( this );\n\n\t\t_isPlaying = true;\n\n\t\t_onStartCallbackFired = false;\n\n\t\t_startTime = time !== undefined ? time : window.performance.now();\n\t\t_startTime += _delayTime;\n\n\t\tfor ( var property in _valuesEnd ) {\n\n\t\t\t// check if an Array was provided as property value\n\t\t\tif ( _valuesEnd[ property ] instanceof Array ) {\n\n\t\t\t\tif ( _valuesEnd[ property ].length === 0 ) {\n\n\t\t\t\t\tcontinue;\n\n\t\t\t\t}\n\n\t\t\t\t// create a local copy of the Array with the start value at the front\n\t\t\t\t_valuesEnd[ property ] = [ _object[ property ] ].concat( _valuesEnd[ property ] );\n\n\t\t\t}\n\n\t\t\t_valuesStart[ property ] = _object[ property ];\n\n\t\t\tif( ( _valuesStart[ property ] instanceof Array ) === false ) {\n\t\t\t\t_valuesStart[ property ] *= 1.0; // Ensures we're using numbers, not strings\n\t\t\t}\n\n\t\t\t_valuesStartRepeat[ property ] = _valuesStart[ property ] || 0;\n\n\t\t}\n\n\t\treturn this;\n\n\t};\n\n\tthis.stop = function () {\n\n\t\tif ( !_isPlaying ) {\n\t\t\treturn this;\n\t\t}\n\n\t\tTWEEN.remove( this );\n\t\t_isPlaying = false;\n\n\t\tif ( _onStopCallback !== null ) {\n\n\t\t\t_onStopCallback.call( _object );\n\n\t\t}\n\n\t\tthis.stopChainedTweens();\n\t\treturn this;\n\n\t};\n\n\tthis.stopChainedTweens = function () {\n\n\t\tfor ( var i = 0, numChainedTweens = _chainedTweens.length; i < numChainedTweens; i++ ) {\n\n\t\t\t_chainedTweens[ i ].stop();\n\n\t\t}\n\n\t};\n\n\tthis.delay = function ( amount ) {\n\n\t\t_delayTime = amount;\n\t\treturn this;\n\n\t};\n\n\tthis.repeat = function ( times ) {\n\n\t\t_repeat = times;\n\t\treturn this;\n\n\t};\n\n\tthis.yoyo = function( yoyo ) {\n\n\t\t_yoyo = yoyo;\n\t\treturn this;\n\n\t};\n\n\n\tthis.easing = function ( easing ) {\n\n\t\t_easingFunction = easing;\n\t\treturn this;\n\n\t};\n\n\tthis.interpolation = function ( interpolation ) {\n\n\t\t_interpolationFunction = interpolation;\n\t\treturn this;\n\n\t};\n\n\tthis.chain = function () {\n\n\t\t_chainedTweens = arguments;\n\t\treturn this;\n\n\t};\n\n\tthis.onStart = function ( callback ) {\n\n\t\t_onStartCallback = callback;\n\t\treturn this;\n\n\t};\n\n\tthis.onUpdate = function ( callback ) {\n\n\t\t_onUpdateCallback = callback;\n\t\treturn this;\n\n\t};\n\n\tthis.onComplete = function ( callback ) {\n\n\t\t_onCompleteCallback = callback;\n\t\treturn this;\n\n\t};\n\n\tthis.onStop = function ( callback ) {\n\n\t\t_onStopCallback = callback;\n\t\treturn this;\n\n\t};\n\n\tthis.update = function ( time ) {\n\n\t\tvar property;\n\n\t\tif ( time < _startTime ) {\n\n\t\t\treturn true;\n\n\t\t}\n\n\t\tif ( _onStartCallbackFired === false ) {\n\n\t\t\tif ( _onStartCallback !== null ) {\n\n\t\t\t\t_onStartCallback.call( _object );\n\n\t\t\t}\n\n\t\t\t_onStartCallbackFired = true;\n\n\t\t}\n\n\t\tvar elapsed = ( time - _startTime ) / _duration;\n\t\telapsed = elapsed > 1 ? 1 : elapsed;\n\n\t\tvar value = _easingFunction( elapsed );\n\n\t\tfor ( property in _valuesEnd ) {\n\n\t\t\tvar start = _valuesStart[ property ] || 0;\n\t\t\tvar end = _valuesEnd[ property ];\n\n\t\t\tif ( end instanceof Array ) {\n\n\t\t\t\t_object[ property ] = _interpolationFunction( end, value );\n\n\t\t\t} else {\n\n\t\t\t\t// Parses relative end values with start as base (e.g.: +10, -3)\n\t\t\t\tif ( typeof(end) === \"string\" ) {\n\t\t\t\t\tend = start + parseFloat(end, 10);\n\t\t\t\t}\n\n\t\t\t\t// protect against non numeric properties.\n\t\t\t\tif ( typeof(end) === \"number\" ) {\n\t\t\t\t\t_object[ property ] = start + ( end - start ) * value;\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( _onUpdateCallback !== null ) {\n\n\t\t\t_onUpdateCallback.call( _object, value );\n\n\t\t}\n\n\t\tif ( elapsed == 1 ) {\n\n\t\t\tif ( _repeat > 0 ) {\n\n\t\t\t\tif( isFinite( _repeat ) ) {\n\t\t\t\t\t_repeat--;\n\t\t\t\t}\n\n\t\t\t\t// reassign starting values, restart by making startTime = now\n\t\t\t\tfor( property in _valuesStartRepeat ) {\n\n\t\t\t\t\tif ( typeof( _valuesEnd[ property ] ) === \"string\" ) {\n\t\t\t\t\t\t_valuesStartRepeat[ property ] = _valuesStartRepeat[ property ] + parseFloat(_valuesEnd[ property ], 10);\n\t\t\t\t\t}\n\n\t\t\t\t\tif (_yoyo) {\n\t\t\t\t\t\tvar tmp = _valuesStartRepeat[ property ];\n\t\t\t\t\t\t_valuesStartRepeat[ property ] = _valuesEnd[ property ];\n\t\t\t\t\t\t_valuesEnd[ property ] = tmp;\n\t\t\t\t\t}\n\n\t\t\t\t\t_valuesStart[ property ] = _valuesStartRepeat[ property ];\n\n\t\t\t\t}\n\n\t\t\t\tif (_yoyo) {\n\t\t\t\t\t_reversed = !_reversed;\n\t\t\t\t}\n\n\t\t\t\t_startTime = time + _delayTime;\n\n\t\t\t\treturn true;\n\n\t\t\t} else {\n\n\t\t\t\tif ( _onCompleteCallback !== null ) {\n\n\t\t\t\t\t_onCompleteCallback.call( _object );\n\n\t\t\t\t}\n\n\t\t\t\tfor ( var i = 0, numChainedTweens = _chainedTweens.length; i < numChainedTweens; i++ ) {\n\n\t\t\t\t\t_chainedTweens[ i ].start( time );\n\n\t\t\t\t}\n\n\t\t\t\treturn false;\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn true;\n\n\t};\n\n};\n\n\nTWEEN.Easing = {\n\n\tLinear: {\n\n\t\tNone: function ( k ) {\n\n\t\t\treturn k;\n\n\t\t}\n\n\t},\n\n\tQuadratic: {\n\n\t\tIn: function ( k ) {\n\n\t\t\treturn k * k;\n\n\t\t},\n\n\t\tOut: function ( k ) {\n\n\t\t\treturn k * ( 2 - k );\n\n\t\t},\n\n\t\tInOut: function ( k ) {\n\n\t\t\tif ( ( k *= 2 ) < 1 ) return 0.5 * k * k;\n\t\t\treturn - 0.5 * ( --k * ( k - 2 ) - 1 );\n\n\t\t}\n\n\t},\n\n\tCubic: {\n\n\t\tIn: function ( k ) {\n\n\t\t\treturn k * k * k;\n\n\t\t},\n\n\t\tOut: function ( k ) {\n\n\t\t\treturn --k * k * k + 1;\n\n\t\t},\n\n\t\tInOut: function ( k ) {\n\n\t\t\tif ( ( k *= 2 ) < 1 ) return 0.5 * k * k * k;\n\t\t\treturn 0.5 * ( ( k -= 2 ) * k * k + 2 );\n\n\t\t}\n\n\t},\n\n\tQuartic: {\n\n\t\tIn: function ( k ) {\n\n\t\t\treturn k * k * k * k;\n\n\t\t},\n\n\t\tOut: function ( k ) {\n\n\t\t\treturn 1 - ( --k * k * k * k );\n\n\t\t},\n\n\t\tInOut: function ( k ) {\n\n\t\t\tif ( ( k *= 2 ) < 1) return 0.5 * k * k * k * k;\n\t\t\treturn - 0.5 * ( ( k -= 2 ) * k * k * k - 2 );\n\n\t\t}\n\n\t},\n\n\tQuintic: {\n\n\t\tIn: function ( k ) {\n\n\t\t\treturn k * k * k * k * k;\n\n\t\t},\n\n\t\tOut: function ( k ) {\n\n\t\t\treturn --k * k * k * k * k + 1;\n\n\t\t},\n\n\t\tInOut: function ( k ) {\n\n\t\t\tif ( ( k *= 2 ) < 1 ) return 0.5 * k * k * k * k * k;\n\t\t\treturn 0.5 * ( ( k -= 2 ) * k * k * k * k + 2 );\n\n\t\t}\n\n\t},\n\n\tSinusoidal: {\n\n\t\tIn: function ( k ) {\n\n\t\t\treturn 1 - Math.cos( k * Math.PI / 2 );\n\n\t\t},\n\n\t\tOut: function ( k ) {\n\n\t\t\treturn Math.sin( k * Math.PI / 2 );\n\n\t\t},\n\n\t\tInOut: function ( k ) {\n\n\t\t\treturn 0.5 * ( 1 - Math.cos( Math.PI * k ) );\n\n\t\t}\n\n\t},\n\n\tExponential: {\n\n\t\tIn: function ( k ) {\n\n\t\t\treturn k === 0 ? 0 : Math.pow( 1024, k - 1 );\n\n\t\t},\n\n\t\tOut: function ( k ) {\n\n\t\t\treturn k === 1 ? 1 : 1 - Math.pow( 2, - 10 * k );\n\n\t\t},\n\n\t\tInOut: function ( k ) {\n\n\t\t\tif ( k === 0 ) return 0;\n\t\t\tif ( k === 1 ) return 1;\n\t\t\tif ( ( k *= 2 ) < 1 ) return 0.5 * Math.pow( 1024, k - 1 );\n\t\t\treturn 0.5 * ( - Math.pow( 2, - 10 * ( k - 1 ) ) + 2 );\n\n\t\t}\n\n\t},\n\n\tCircular: {\n\n\t\tIn: function ( k ) {\n\n\t\t\treturn 1 - Math.sqrt( 1 - k * k );\n\n\t\t},\n\n\t\tOut: function ( k ) {\n\n\t\t\treturn Math.sqrt( 1 - ( --k * k ) );\n\n\t\t},\n\n\t\tInOut: function ( k ) {\n\n\t\t\tif ( ( k *= 2 ) < 1) return - 0.5 * ( Math.sqrt( 1 - k * k) - 1);\n\t\t\treturn 0.5 * ( Math.sqrt( 1 - ( k -= 2) * k) + 1);\n\n\t\t}\n\n\t},\n\n\tElastic: {\n\n\t\tIn: function ( k ) {\n\n\t\t\tvar s, a = 0.1, p = 0.4;\n\t\t\tif ( k === 0 ) return 0;\n\t\t\tif ( k === 1 ) return 1;\n\t\t\tif ( !a || a < 1 ) { a = 1; s = p / 4; }\n\t\t\telse s = p * Math.asin( 1 / a ) / ( 2 * Math.PI );\n\t\t\treturn - ( a * Math.pow( 2, 10 * ( k -= 1 ) ) * Math.sin( ( k - s ) * ( 2 * Math.PI ) / p ) );\n\n\t\t},\n\n\t\tOut: function ( k ) {\n\n\t\t\tvar s, a = 0.1, p = 0.4;\n\t\t\tif ( k === 0 ) return 0;\n\t\t\tif ( k === 1 ) return 1;\n\t\t\tif ( !a || a < 1 ) { a = 1; s = p / 4; }\n\t\t\telse s = p * Math.asin( 1 / a ) / ( 2 * Math.PI );\n\t\t\treturn ( a * Math.pow( 2, - 10 * k) * Math.sin( ( k - s ) * ( 2 * Math.PI ) / p ) + 1 );\n\n\t\t},\n\n\t\tInOut: function ( k ) {\n\n\t\t\tvar s, a = 0.1, p = 0.4;\n\t\t\tif ( k === 0 ) return 0;\n\t\t\tif ( k === 1 ) return 1;\n\t\t\tif ( !a || a < 1 ) { a = 1; s = p / 4; }\n\t\t\telse s = p * Math.asin( 1 / a ) / ( 2 * Math.PI );\n\t\t\tif ( ( k *= 2 ) < 1 ) return - 0.5 * ( a * Math.pow( 2, 10 * ( k -= 1 ) ) * Math.sin( ( k - s ) * ( 2 * Math.PI ) / p ) );\n\t\t\treturn a * Math.pow( 2, -10 * ( k -= 1 ) ) * Math.sin( ( k - s ) * ( 2 * Math.PI ) / p ) * 0.5 + 1;\n\n\t\t}\n\n\t},\n\n\tBack: {\n\n\t\tIn: function ( k ) {\n\n\t\t\tvar s = 1.70158;\n\t\t\treturn k * k * ( ( s + 1 ) * k - s );\n\n\t\t},\n\n\t\tOut: function ( k ) {\n\n\t\t\tvar s = 1.70158;\n\t\t\treturn --k * k * ( ( s + 1 ) * k + s ) + 1;\n\n\t\t},\n\n\t\tInOut: function ( k ) {\n\n\t\t\tvar s = 1.70158 * 1.525;\n\t\t\tif ( ( k *= 2 ) < 1 ) return 0.5 * ( k * k * ( ( s + 1 ) * k - s ) );\n\t\t\treturn 0.5 * ( ( k -= 2 ) * k * ( ( s + 1 ) * k + s ) + 2 );\n\n\t\t}\n\n\t},\n\n\tBounce: {\n\n\t\tIn: function ( k ) {\n\n\t\t\treturn 1 - TWEEN.Easing.Bounce.Out( 1 - k );\n\n\t\t},\n\n\t\tOut: function ( k ) {\n\n\t\t\tif ( k < ( 1 / 2.75 ) ) {\n\n\t\t\t\treturn 7.5625 * k * k;\n\n\t\t\t} else if ( k < ( 2 / 2.75 ) ) {\n\n\t\t\t\treturn 7.5625 * ( k -= ( 1.5 / 2.75 ) ) * k + 0.75;\n\n\t\t\t} else if ( k < ( 2.5 / 2.75 ) ) {\n\n\t\t\t\treturn 7.5625 * ( k -= ( 2.25 / 2.75 ) ) * k + 0.9375;\n\n\t\t\t} else {\n\n\t\t\t\treturn 7.5625 * ( k -= ( 2.625 / 2.75 ) ) * k + 0.984375;\n\n\t\t\t}\n\n\t\t},\n\n\t\tInOut: function ( k ) {\n\n\t\t\tif ( k < 0.5 ) return TWEEN.Easing.Bounce.In( k * 2 ) * 0.5;\n\t\t\treturn TWEEN.Easing.Bounce.Out( k * 2 - 1 ) * 0.5 + 0.5;\n\n\t\t}\n\n\t}\n\n};\n\nTWEEN.Interpolation = {\n\n\tLinear: function ( v, k ) {\n\n\t\tvar m = v.length - 1, f = m * k, i = Math.floor( f ), fn = TWEEN.Interpolation.Utils.Linear;\n\n\t\tif ( k < 0 ) return fn( v[ 0 ], v[ 1 ], f );\n\t\tif ( k > 1 ) return fn( v[ m ], v[ m - 1 ], m - f );\n\n\t\treturn fn( v[ i ], v[ i + 1 > m ? m : i + 1 ], f - i );\n\n\t},\n\n\tBezier: function ( v, k ) {\n\n\t\tvar b = 0, n = v.length - 1, pw = Math.pow, bn = TWEEN.Interpolation.Utils.Bernstein, i;\n\n\t\tfor ( i = 0; i <= n; i++ ) {\n\t\t\tb += pw( 1 - k, n - i ) * pw( k, i ) * v[ i ] * bn( n, i );\n\t\t}\n\n\t\treturn b;\n\n\t},\n\n\tCatmullRom: function ( v, k ) {\n\n\t\tvar m = v.length - 1, f = m * k, i = Math.floor( f ), fn = TWEEN.Interpolation.Utils.CatmullRom;\n\n\t\tif ( v[ 0 ] === v[ m ] ) {\n\n\t\t\tif ( k < 0 ) i = Math.floor( f = m * ( 1 + k ) );\n\n\t\t\treturn fn( v[ ( i - 1 + m ) % m ], v[ i ], v[ ( i + 1 ) % m ], v[ ( i + 2 ) % m ], f - i );\n\n\t\t} else {\n\n\t\t\tif ( k < 0 ) return v[ 0 ] - ( fn( v[ 0 ], v[ 0 ], v[ 1 ], v[ 1 ], -f ) - v[ 0 ] );\n\t\t\tif ( k > 1 ) return v[ m ] - ( fn( v[ m ], v[ m ], v[ m - 1 ], v[ m - 1 ], f - m ) - v[ m ] );\n\n\t\t\treturn fn( v[ i ? i - 1 : 0 ], v[ i ], v[ m < i + 1 ? m : i + 1 ], v[ m < i + 2 ? m : i + 2 ], f - i );\n\n\t\t}\n\n\t},\n\n\tUtils: {\n\n\t\tLinear: function ( p0, p1, t ) {\n\n\t\t\treturn ( p1 - p0 ) * t + p0;\n\n\t\t},\n\n\t\tBernstein: function ( n , i ) {\n\n\t\t\tvar fc = TWEEN.Interpolation.Utils.Factorial;\n\t\t\treturn fc( n ) / fc( i ) / fc( n - i );\n\n\t\t},\n\n\t\tFactorial: ( function () {\n\n\t\t\tvar a = [ 1 ];\n\n\t\t\treturn function ( n ) {\n\n\t\t\t\tvar s = 1, i;\n\t\t\t\tif ( a[ n ] ) return a[ n ];\n\t\t\t\tfor ( i = n; i > 1; i-- ) s *= i;\n\t\t\t\treturn a[ n ] = s;\n\n\t\t\t};\n\n\t\t} )(),\n\n\t\tCatmullRom: function ( p0, p1, p2, p3, t ) {\n\n\t\t\tvar v0 = ( p2 - p0 ) * 0.5, v1 = ( p3 - p1 ) * 0.5, t2 = t * t, t3 = t * t2;\n\t\t\treturn ( 2 * p1 - 2 * p2 + v0 + v1 ) * t3 + ( - 3 * p1 + 3 * p2 - 2 * v0 - v1 ) * t2 + v0 * t + p1;\n\n\t\t}\n\n\t}\n\n};\n\n// UMD (Universal Module Definition)\n( function ( root ) {\n\n\tif ( typeof define === 'function' && define.amd ) {\n\n\t\t// AMD\n\t\tdefine( [], function () {\n\t\t\treturn TWEEN;\n\t\t} );\n\n\t} else if ( typeof exports === 'object' ) {\n\n\t\t// Node.js\n\t\tmodule.exports = TWEEN;\n\n\t} else {\n\n\t\t// Global variable\n\t\troot.TWEEN = TWEEN;\n\n\t}\n\n} )( this );\n","var performance = global.performance || {};\n\nvar present = (function () {\n  var names = ['now', 'webkitNow', 'msNow', 'mozNow', 'oNow'];\n  while (names.length) {\n    var name = names.shift();\n    if (name in performance) {\n      return performance[name].bind(performance);\n    }\n  }\n\n  var dateNow = Date.now || function () { return new Date().getTime(); };\n  var navigationStart = (performance.timing || {}).navigationStart || dateNow();\n  return function () {\n    return dateNow() - navigationStart;\n  };\n}());\n\npresent.performanceNow = performance.now;\npresent.noConflict = function () {\n  performance.now = present.performanceNow;\n};\npresent.conflict = function () {\n  performance.now = present;\n};\npresent.conflict();\n\nmodule.exports = present;\n","/* global HTMLElement */\nvar schema = require('./schema');\nvar systems = require('./system');\nvar utils = require('../utils/');\n\nvar components = module.exports.components = {}; // Keep track of registered components.\nvar parseProperties = schema.parseProperties;\nvar parseProperty = schema.parseProperty;\nvar processSchema = schema.process;\nvar isSingleProp = schema.isSingleProperty;\nvar stringifyProperties = schema.stringifyProperties;\nvar stringifyProperty = schema.stringifyProperty;\nvar styleParser = utils.styleParser;\n\n/**\n * Component class definition.\n *\n * Components configure appearance, modify behavior, or add functionality to\n * entities. The behavior and appearance of an entity can be changed at runtime\n * by adding, removing, or updating components. Entities do not share instances\n * of components.\n *\n * @member {object} el - Reference to the entity element.\n * @member {string} attr - Component name exposed as an HTML attribute.\n * @member {object} data - Component data populated by parsing the\n *         mapped attribute of the component plus applying defaults and mixins.\n */\nvar Component = module.exports.Component = function (el, attr, id) {\n  this.el = el;\n  this.id = id;\n  this.attrName = this.name + (id ? '__' + id : '');\n  this.updateCachedAttrValue(attr);\n};\n\nComponent.prototype = {\n  /**\n   * Contains the type schema and defaults for the data values.\n   * Data is coerced into the types of the values of the defaults.\n   */\n  schema: {},\n\n  /**\n   * Init handler. Similar to attachedCallback.\n   * Called during component initialization and is only run once.\n   * Components can use this to set initial state.\n   */\n  init: function () { /* no-op */ },\n\n  /**\n   * Update handler. Similar to attributeChangedCallback.\n   * Called whenever component's data changes.\n   * Also called on component initialization when the component receives initial data.\n   *\n   * @param {object} prevData - Previous attributes of the component.\n   */\n  update: function (prevData) { /* no-op */ },\n\n  updateSchema: undefined,\n\n  /**\n   * Tick handler.\n   * Called on each tick of the scene render loop.\n   * Affected by play and pause.\n   *\n   * @param {number} time - Scene tick time.\n   * @param {number} timeDelta - Difference in current render time and previous render time.\n   */\n  tick: undefined,\n\n  /**\n   * Called to start any dynamic behavior (e.g., animation, AI, events, physics).\n   */\n  play: function () { /* no-op */ },\n\n  /**\n   * Called to stop any dynamic behavior (e.g., animation, AI, events, physics).\n   */\n  pause: function () { /* no-op */ },\n\n  /**\n   * Remove handler. Similar to detachedCallback.\n   * Called whenever component is removed from the entity (i.e., removeAttribute).\n   * Components can use this to reset behavior on the entity.\n   */\n  remove: function () { /* no-op */ },\n\n  /**\n   * Parses each property based on property type.\n   * If component is single-property, then parses the single property value.\n   *\n   * @param {string} value - HTML attribute value.\n   * @param {boolean} silent - Suppress warning messages.\n   * @returns {object} Component data.\n   */\n  parse: function (value, silent) {\n    var schema = this.schema;\n    if (isSingleProp(schema)) { return parseProperty(value, schema); }\n    return parseProperties(styleParser.parse(value), schema, true, this.name, silent);\n  },\n\n  /**\n   * Stringify properties if necessary.\n   *\n   * Only called from `Entity.setAttribute` for properties whose parsers accept a non-string\n   * value (e.g., selector, vec3 property types).\n   *\n   * @param {object} data - Complete component data.\n   * @returns {string}\n   */\n  stringify: function (data) {\n    var schema = this.schema;\n    if (typeof data === 'string') { return data; }\n    if (isSingleProp(schema)) { return stringifyProperty(data, schema); }\n    data = stringifyProperties(data, schema);\n    return styleParser.stringify(data);\n  },\n\n  /**\n   * Returns a copy of data such that we don't expose the private this.data.\n   *\n   * @returns {object} data\n   */\n  getData: function () {\n    var data = this.data;\n    if (typeof data !== 'object') { return data; }\n    return utils.extend({}, data);\n  },\n\n  /**\n   * Update the cache of the pre-parsed attribute value.\n   *\n   * @param {string} value - HTML attribute value.\n   */\n  updateCachedAttrValue: function (value) {\n    var isSinglePropSchema = isSingleProp(this.schema);\n    var attrValue = this.parseAttrValueForCache(value);\n    this.attrValue = extendProperties({}, attrValue, isSinglePropSchema);\n  },\n\n  /**\n   * Given an HTML attribute value parses the string\n   * based on the component schema. To avoid double parsings of\n   * strings into strings we store the original instead\n   * of the parsed one\n   *\n   * @param {string} value - HTML attribute value\n   */\n  parseAttrValueForCache: function (value) {\n    var parsedValue;\n    if (typeof value !== 'string') { return value; }\n    if (isSingleProp(this.schema)) {\n      parsedValue = this.schema.parse(value);\n      // To avoid bogus double parsings. The cached values will\n      // be parsed when building the component data.\n      // For instance when parsing a src id to it's url.\n      // We want to cache the original string and not the parsed\n      // one (#monster -> models/monster.dae) so when building\n      // data we parse the expected value.\n      if (typeof parsedValue === 'string') { parsedValue = value; }\n    } else {\n      // We just parse using the style parser to avoid double parsing\n      // of individual properties.\n      parsedValue = styleParser.parse(value);\n    }\n    return parsedValue;\n  },\n\n  /**\n   * Writes cached attribute data to the entity DOM element.\n   */\n  flushToDOM: function () {\n    var attrValue = this.attrValue;\n    if (!attrValue) { return; }\n    HTMLElement.prototype.setAttribute.call(this.el, this.attrName, this.stringify(attrValue));\n  },\n\n  /**\n   * Apply new component data if data has changed.\n   *\n   * @param {string} value - HTML attribute value.\n   *        If undefined, use the cached attribute value and continue updating properties.\n   */\n  updateProperties: function (value) {\n    var el = this.el;\n    var isSinglePropSchema = isSingleProp(this.schema);\n    var oldData = extendProperties({}, this.data, isSinglePropSchema);\n\n    if (value !== undefined) { this.updateCachedAttrValue(value); }\n\n    if (this.updateSchema) {\n      this.updateSchema(buildData(el, this.name, this.schema, this.attrValue, true));\n    }\n    this.data = buildData(el, this.name, this.schema, this.attrValue);\n\n    // Don't update if properties haven't changed\n    if (!isSinglePropSchema && utils.deepEqual(oldData, this.data)) { return; }\n\n    if (!this.initialized) {\n      this.init();\n      this.initialized = true;\n      // Play the component if the entity is playing.\n      this.update(oldData);\n      if (el.isPlaying) { this.play(); }\n      el.emit('componentinitialized', {\n        id: this.id,\n        name: this.name,\n        data: this.getData()\n      }, false);\n    } else {\n      this.update(oldData);\n      el.emit('componentchanged', {\n        id: this.id,\n        name: this.name,\n        newData: this.getData(),\n        oldData: oldData\n      }, false);\n    }\n  },\n\n  /**\n   * Extend schema of component given a partial schema.\n   *\n   * Some components might want to mutate their schema based on certain properties.\n   * e.g., Material component changes its schema based on `shader` to account for different\n   * uniforms\n   *\n   * @param {object} schemaAddon - Schema chunk that extend base schema.\n   */\n  extendSchema: function (schemaAddon) {\n    // Clone base schema.\n    var extendedSchema = utils.extend({}, components[this.name].schema);\n    // Extend base schema with new schema chunk.\n    utils.extend(extendedSchema, schemaAddon);\n    this.schema = processSchema(extendedSchema);\n    this.el.emit('schemachanged', {component: this.name});\n  }\n};\n\n/**\n * Registers a component to A-Frame.\n *\n * @param {string} name - Component name.\n * @param {object} definition - Component schema and lifecycle method handlers.\n * @returns {object} Component.\n */\nmodule.exports.registerComponent = function (name, definition) {\n  var NewComponent;\n  var proto = {};\n\n  if (name.indexOf('__') !== -1) {\n    throw new Error('The component name `' + name + '` is not allowed. ' +\n                    'The sequence __ (double underscore) is reserved to specify an id' +\n                    ' for multiple components of the same type');\n  }\n\n  // Format definition object to prototype object.\n  Object.keys(definition).forEach(function (key) {\n    proto[key] = {\n      value: definition[key],\n      writable: true\n    };\n  });\n\n  if (components[name]) {\n    throw new Error('The component `' + name + '` has been already registered. ' +\n                    'Check that you are not loading two versions of the same component ' +\n                    'or two different components of the same name.');\n  }\n  NewComponent = function (el, attr, id) {\n    Component.call(this, el, attr, id);\n    if (!el.hasLoaded) { return; }\n    this.updateProperties(this.attrValue);\n  };\n\n  NewComponent.prototype = Object.create(Component.prototype, proto);\n  NewComponent.prototype.name = name;\n  NewComponent.prototype.constructor = NewComponent;\n  NewComponent.prototype.system = systems && systems.systems[name];\n  NewComponent.prototype.play = wrapPlay(NewComponent.prototype.play);\n  NewComponent.prototype.pause = wrapPause(NewComponent.prototype.pause);\n\n  components[name] = {\n    Component: NewComponent,\n    dependencies: NewComponent.prototype.dependencies,\n    multiple: NewComponent.prototype.multiple,\n    parse: NewComponent.prototype.parse,\n    parseAttrValueForCache: NewComponent.prototype.parseAttrValueForCache,\n    schema: utils.extend(processSchema(NewComponent.prototype.schema)),\n    stringify: NewComponent.prototype.stringify,\n    type: NewComponent.prototype.type\n  };\n  return NewComponent;\n};\n\n/**\n * Builds component data from the current state of the entity, ultimately\n * updating this.data.\n *\n * If the component was detached completely, set data to null.\n *\n * Precedence:\n * 1. Defaults data\n * 2. Mixin data.\n * 3. Attribute data.\n *\n * Finally coerce the data to the types of the defaults.\n *\n * @param {object} el - Element to build data from.\n * @param {object} name - Component name.\n * @param {object} schema - Component schema.\n * @param {object} elData - Element current data.\n * @param {boolean} silent - Suppress warning messages.\n * @return {object} The component data\n */\nfunction buildData (el, name, schema, elData, silent) {\n  var componentDefined = elData !== undefined && elData !== null;\n  var data;\n  var isSinglePropSchema = isSingleProp(schema);\n  var mixinEls = el.mixinEls;\n\n  // 1. Default values (lowest precendence).\n  if (isSinglePropSchema) {\n    data = schema.default;\n  } else {\n    data = {};\n    Object.keys(schema).forEach(function applyDefault (key) {\n      data[key] = schema[key].default;\n    });\n  }\n\n  // 2. Mixin values.\n  mixinEls.forEach(handleMixinUpdate);\n  function handleMixinUpdate (mixinEl) {\n    var mixinData = mixinEl.getAttribute(name);\n    if (mixinData) {\n      data = extendProperties(data, mixinData, isSinglePropSchema);\n    }\n  }\n\n  // 3. Attribute values (highest precendence).\n  if (componentDefined) {\n    if (isSinglePropSchema) { return parseProperty(elData, schema); }\n    data = extendProperties(data, elData, isSinglePropSchema);\n    return parseProperties(data, schema, undefined, name, silent);\n  } else {\n     // Parse and coerce using the schema.\n    if (isSinglePropSchema) { return parseProperty(data, schema); }\n    return parseProperties(data, schema, undefined, name, silent);\n  }\n}\nmodule.exports.buildData = buildData;\n\n/**\n* Object extending with checking for single-property schema.\n*\n* @param dest - Destination object or value.\n* @param source - Source object or value\n* @param {boolean} isSinglePropSchema - Whether or not schema is only a single property.\n* @returns Overridden object or value.\n*/\nfunction extendProperties (dest, source, isSinglePropSchema) {\n  if (isSinglePropSchema) { return source; }\n  return utils.extend(dest, source);\n}\n\n/**\n * Wrapper for user defined pause method\n * Pause component by removing tick behavior and calling user's pause method.\n *\n * @param pauseMethod {function} - user defined pause method\n */\nfunction wrapPause (pauseMethod) {\n  return function pause () {\n    var sceneEl = this.el.sceneEl;\n    if (!this.isPlaying) { return; }\n    pauseMethod.call(this);\n    this.isPlaying = false;\n    // Remove tick behavior.\n    if (!this.tick) { return; }\n    sceneEl.removeBehavior(this);\n  };\n}\n\n/**\n * Wrapper for user defined play method\n * Play component by adding tick behavior and calling user's play method.\n *\n * @param playMethod {function} - user defined play method\n *\n */\nfunction wrapPlay (playMethod) {\n  return function play () {\n    var sceneEl = this.el.sceneEl;\n    var shouldPlay = this.el.isPlaying && !this.isPlaying;\n    if (!this.initialized || !shouldPlay) { return; }\n    playMethod.call(this);\n    this.isPlaying = true;\n    // Add tick behavior.\n    if (!this.tick) { return; }\n    sceneEl.addBehavior(this);\n  };\n}\n","var schema = require('./schema');\n\nvar processSchema = schema.process;\nvar geometries = module.exports.geometries = {};  // Registered geometries.\nvar geometryNames = module.exports.geometryNames = [];  // Names of registered geometries.\nvar THREE = require('../lib/three');\n\n/**\n * Geometry class definition.\n *\n * Geometries extend the geometry component API to create and register geometry types.\n */\nvar Geometry = module.exports.Geometry = function () {};\n\nGeometry.prototype = {\n  /**\n   * Contains the type schema and defaults for the data values.\n   * Data is coerced into the types of the values of the defaults.\n   */\n  schema: {},\n\n  /**\n   * Init handler. Similar to attachedCallback.\n   * Called during shader initialization and is only run once.\n   */\n  init: function (data) {\n    this.geometry = new THREE.Geometry();\n    return this.geometry;\n  },\n\n  /**\n   * Update handler. Similar to attributeChangedCallback.\n   * Called whenever the associated geometry data changes.\n   *\n   * @param {object} data - New geometry data.\n   */\n  update: function (data) { /* no-op */ }\n};\n\n/**\n * Registers a geometry to A-Frame.\n *\n * @param {string} name - Geometry name.\n * @param {object} definition - Geometry property and methods.\n * @returns {object} Geometry.\n */\nmodule.exports.registerGeometry = function (name, definition) {\n  var NewGeometry;\n  var proto = {};\n\n  // Format definition object to prototype object.\n  Object.keys(definition).forEach(function expandDefinition (key) {\n    proto[key] = {\n      value: definition[key],\n      writable: true\n    };\n  });\n\n  if (geometries[name]) {\n    throw new Error('The geometry `' + name + '` has been already registered');\n  }\n  NewGeometry = function () { Geometry.call(this); };\n  NewGeometry.prototype = Object.create(Geometry.prototype, proto);\n  NewGeometry.prototype.name = name;\n  NewGeometry.prototype.constructor = NewGeometry;\n  geometries[name] = {\n    Geometry: NewGeometry,\n    schema: processSchema(NewGeometry.prototype.schema)\n  };\n  geometryNames.push(name);\n  return NewGeometry;\n};\n","var schema = require('./schema');\n\nvar processSchema = schema.process;\nvar shaders = module.exports.shaders = {};  // Keep track of registered shaders.\nvar shaderNames = module.exports.shaderNames = [];  // Keep track of the names of registered shaders.\nvar THREE = require('../lib/three');\n\nvar propertyToThreeMapping = {\n  number: 'f',\n  time: 'f',\n  vec4: 'v4',\n  vec3: 'v3',\n  vec2: 'v2',\n  color: 'v3'\n};\n\n/**\n * Shader class definition.\n *\n * Shaders extend the material component API so you can create your own library\n * of customized materials\n *\n */\nvar Shader = module.exports.Shader = function () {};\n\nShader.prototype = {\n  /**\n   * Contains the type schema and defaults for the data values.\n   * Data is coerced into the types of the values of the defaults.\n   */\n  schema: {},\n\n  vertexShader:\n    'void main() {' +\n      'gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);' +\n    '}',\n\n  fragmentShader:\n    'void main() {' +\n      'gl_FragColor = vec4(1.0,0.0,1.0,1.0);' +\n    '}',\n\n  /**\n   * Init handler. Similar to attachedCallback.\n   * Called during shader initialization and is only run once.\n   */\n  init: function (data) {\n    this.attributes = this.initVariables(data, 'attribute');\n    this.uniforms = this.initVariables(data, 'uniform');\n    this.material = new THREE.ShaderMaterial({\n      // attributes: this.attributes,\n      uniforms: this.uniforms,\n      vertexShader: this.vertexShader,\n      fragmentShader: this.fragmentShader\n    });\n    return this.material;\n  },\n\n  initVariables: function (data, type) {\n    var self = this;\n    var variables = {};\n    var schema = this.schema;\n    var schemaKeys = Object.keys(schema);\n    schemaKeys.forEach(processSchema);\n    function processSchema (key) {\n      if (schema[key].is !== type) { return; }\n      var varType = propertyToThreeMapping[schema[key].type];\n      var varValue = schema[key].parse(data[key] || schema[key].default);\n      variables[key] = {\n        type: varType,\n        value: self.parseValue(schema[key].type, varValue)\n      };\n    }\n    return variables;\n  },\n\n  /**\n   * Update handler. Similar to attributeChangedCallback.\n   * Called whenever the associated material data changes.\n   *\n   * @param {object} data - New material data.\n   */\n  update: function (data) {\n    this.updateVariables(data, 'attribute');\n    this.updateVariables(data, 'uniform');\n  },\n\n  updateVariables: function (data, type) {\n    var self = this;\n    var variables = type === 'uniform' ? this.uniforms : this.attributes;\n    var dataKeys = Object.keys(data);\n    var schema = this.schema;\n    dataKeys.forEach(processData);\n    function processData (key) {\n      if (!schema[key] || schema[key].is !== type) { return; }\n      if (variables[key].value === data[key]) { return; }\n      variables[key].value = self.parseValue(schema[key].type, data[key]);\n      variables[key].needsUpdate = true;\n    }\n  },\n\n  parseValue: function (type, value) {\n    var color;\n    switch (type) {\n      case 'vec2': {\n        return new THREE.Vector2(value.x, value.y);\n      }\n      case 'vec3': {\n        return new THREE.Vector3(value.x, value.y, value.z);\n      }\n      case 'vec4': {\n        return new THREE.Vector4(value.x, value.y, value.z, value.w);\n      }\n      case 'color': {\n        color = new THREE.Color(value);\n        return new THREE.Vector3(color.r, color.g, color.b);\n      }\n      default: {\n        return value;\n      }\n    }\n  }\n};\n\n/**\n * Registers a shader to A-Frame.\n *\n * @param {string} name - shader name.\n * @param {object} definition - shader property and methods.\n * @returns {object} Shader.\n */\nmodule.exports.registerShader = function (name, definition) {\n  var NewShader;\n  var proto = {};\n\n  // Format definition object to prototype object.\n  Object.keys(definition).forEach(function (key) {\n    proto[key] = {\n      value: definition[key],\n      writable: true\n    };\n  });\n\n  if (shaders[name]) {\n    throw new Error('The shader ' + name + ' has been already registered');\n  }\n  NewShader = function () { Shader.call(this); };\n  NewShader.prototype = Object.create(Shader.prototype, proto);\n  NewShader.prototype.name = name;\n  NewShader.prototype.constructor = NewShader;\n  shaders[name] = {\n    Shader: NewShader,\n    schema: processSchema(NewShader.prototype.schema)\n  };\n  shaderNames.push(name);\n  return NewShader;\n};\n","/* global HTMLElement */\nvar components = require('./component');\nvar schema = require('./schema');\nvar utils = require('../utils/');\n\nvar parseProperties = schema.parseProperties;\nvar parseProperty = schema.parseProperty;\nvar processSchema = schema.process;\nvar isSingleProp = schema.isSingleProperty;\nvar styleParser = utils.styleParser;\n\nvar systems = module.exports.systems = {};  // Keep track of registered systems.\n\n/**\n * System class definition.\n *\n * Systems provide global scope and services to a group of instantiated components of the\n * same class. They can also help abstract logic away from components such that components\n * only have to worry about data.\n * For example, a physics component that creates a physics world that oversees\n * all entities with a physics or rigid body component.\n *\n * @member {string} name - Name that system is registered under.\n * @member {Element} sceneEl - Handle to the scene element where system applies to.\n */\nvar System = module.exports.System = function (sceneEl) {\n  var component = components && components.components[this.name];\n  var schema = this.schema;\n  var rawData;\n\n  // Set reference to scene.\n  this.sceneEl = sceneEl;\n\n  // Set reference to matching component (if exists).\n  if (component) { component.Component.prototype.system = this; }\n\n  // Process system configuration.\n  if (!Object.keys(schema).length) { return; }\n  rawData = HTMLElement.prototype.getAttribute.call(sceneEl, this.name);\n  if (isSingleProp(schema)) {\n    this.data = parseProperty(rawData, schema);\n    return;\n  }\n  this.data = parseProperties(styleParser.parse(rawData) || {}, schema, false, this.name);\n};\n\nSystem.prototype = {\n  /**\n   * Schema to configure system.\n   */\n  schema: {},\n\n  /**\n   * Init handler. Called during scene initialization and is only run once.\n   * Systems can use this to set initial state.\n   */\n  init: function () { /* no-op */ },\n\n  /**\n   * Tick handler.\n   * Called on each tick of the scene render loop.\n   * Affected by play and pause.\n   *\n   * @param {number} time - Scene tick time.\n   * @param {number} timeDelta - Difference in current render time and previous render time.\n   */\n  tick: undefined,\n\n  /**\n   * Called to start any dynamic behavior (e.g., animation, AI, events, physics).\n   */\n  play: function () { /* no-op */ },\n\n  /**\n   * Called to stop any dynamic behavior (e.g., animation, AI, events, physics).\n   */\n  pause: function () { /* no-op */ }\n};\n\n/**\n * Registers a system to A-Frame.\n *\n * @param {string} name - Component name.\n * @param {object} definition - Component property and methods.\n * @returns {object} Component.\n */\nmodule.exports.registerSystem = function (name, definition) {\n  var i;\n  var NewSystem;\n  var proto = {};\n  var scenes = utils.findAllScenes(document);\n\n  // Format definition object to prototype object.\n  Object.keys(definition).forEach(function (key) {\n    proto[key] = {\n      value: definition[key],\n      writable: true\n    };\n  });\n\n  if (systems[name]) {\n    throw new Error('The system `' + name + '` has been already registered. ' +\n                    'Check that you are not loading two versions of the same system ' +\n                    'or two different systems of the same name.');\n  }\n  NewSystem = function (sceneEl) { System.call(this, sceneEl); };\n  NewSystem.prototype = Object.create(System.prototype, proto);\n  NewSystem.prototype.name = name;\n  NewSystem.prototype.constructor = NewSystem;\n  NewSystem.prototype.schema = utils.extend(processSchema(NewSystem.prototype.schema));\n  systems[name] = NewSystem;\n\n  // Initialize systems for existing scenes\n  for (i = 0; i < scenes.length; i++) { scenes[i].initSystem(name); }\n};\n","var THREE = global.THREE = require('three');\n\n// Allow cross-origin images to be loaded.\n\n// This should not be on `THREE.Loader` nor `THREE.ImageUtils`.\n// Must be on `THREE.TextureLoader`.\nif (THREE.TextureLoader) {\n  THREE.TextureLoader.prototype.crossOrigin = 'anonymous';\n}\n\n// This is for images loaded from the model loaders.\nif (THREE.ImageLoader) {\n  THREE.ImageLoader.prototype.crossOrigin = 'anonymous';\n}\n\n// In-memory caching for XHRs (for images, audio files, textures, etc.).\nif (THREE.Cache) {\n  THREE.Cache.enabled = true;\n}\n\n// TODO: Eventually include these only if they are needed by a component.\nrequire('three/examples/js/loaders/OBJLoader');  // THREE.OBJLoader\nrequire('three/examples/js/loaders/MTLLoader');  // THREE.MTLLoader\nrequire('three/examples/js/BlendCharacter');  // THREE.BlendCharacter\nrequire('three/examples/js/loaders/ColladaLoader');  // THREE.ColladaLoader\nrequire('../../vendor/VRControls');  // THREE.VRControls\nrequire('../../vendor/VREffect');  // THREE.VREffect\n\nTHREE.ColladaLoader.prototype.crossOrigin = 'anonymous';\nTHREE.MTLLoader.prototype.crossOrigin = 'anonymous';\nTHREE.OBJLoader.prototype.crossOrigin = 'anonymous';\n\nmodule.exports = THREE;\n","require('./blend-character-model');\nrequire('./camera');\nrequire('./collada-model');\nrequire('./cursor');\nrequire('./geometry');\nrequire('./hand-controls');\nrequire('./light');\nrequire('./look-controls');\nrequire('./material');\nrequire('./obj-model');\nrequire('./position');\nrequire('./raycaster');\nrequire('./rotation');\nrequire('./scale');\nrequire('./sound');\nrequire('./tracked-controls');\nrequire('./visible');\nrequire('./vive-controls');\nrequire('./wasd-controls');\n\nrequire('./scene/canvas');\nrequire('./scene/debug');\nrequire('./scene/embedded');\nrequire('./scene/inspector');\nrequire('./scene/fog');\nrequire('./scene/keyboard-shortcuts');\nrequire('./scene/pool');\nrequire('./scene/stats');\nrequire('./scene/vr-mode-ui');\n","require('./box.js');\nrequire('./circle.js');\nrequire('./cone.js');\nrequire('./cylinder.js');\nrequire('./dodecahedron.js');\nrequire('./icosahedron.js');\nrequire('./octahedron.js');\nrequire('./plane.js');\nrequire('./ring.js');\nrequire('./sphere.js');\nrequire('./tetrahedron.js');\nrequire('./torus.js');\nrequire('./torusKnot.js');\n","require('./flat');\nrequire('./standard');\n","require('./camera');\nrequire('./geometry');\nrequire('./light');\nrequire('./material');\nrequire('./tracked-controls');\n\n","/* global HTMLElement, MutationObserver */\nvar registerElement = require('./a-register-element').registerElement;\nvar utils = require('../utils/');\nvar bind = utils.bind;\n\n/**\n * Base class for A-Frame that manages loading of objects.\n *\n * Nodes can be modified using mixins.\n * Nodes emit a `loaded` event when they and their children have initialized.\n */\nmodule.exports = registerElement('a-node', {\n  prototype: Object.create(HTMLElement.prototype, {\n    createdCallback: {\n      value: function () {\n        this.hasLoaded = false;\n        this.isNode = true;\n        this.mixinEls = [];\n        this.mixinObservers = {};\n      },\n      writable: window.debug\n    },\n\n    attachedCallback: {\n      value: function () {\n        var mixins;\n\n        this.hasLoaded = false;\n        this.sceneEl = this.closestScene();\n        this.emit('nodeready', {}, false);\n\n        mixins = this.getAttribute('mixin');\n        if (mixins) { this.updateMixins(mixins); }\n      },\n      writable: window.debug\n    },\n\n    attributeChangedCallback: {\n      value: function (attr, oldVal, newVal) {\n        if (attr === 'mixin') { this.updateMixins(newVal, oldVal); }\n      }\n    },\n\n   /**\n    * Returns the first scene by traversing up the tree starting from and\n    * including receiver element.\n    */\n    closestScene: {\n      value: function closest () {\n        var element = this;\n        while (element) {\n          if (element.isScene) { break; }\n          element = element.parentElement;\n        }\n        return element;\n      }\n    },\n\n    /**\n     * Returns first element matching a selector by traversing up the tree starting\n     * from and including receiver element.\n     *\n     * @param {string} selector - Selector of element to find.\n     */\n    closest: {\n      value: function closest (selector) {\n        var matches = this.matches || this.mozMatchesSelector ||\n          this.msMatchesSelector || this.oMatchesSelector || this.webkitMatchesSelector;\n        var element = this;\n        while (element) {\n          if (matches.call(element, selector)) { break; }\n          element = element.parentElement;\n        }\n        return element;\n      }\n    },\n\n    detachedCallback: {\n      value: function () {\n        this.hasLoaded = false;\n      }\n    },\n\n    /**\n     * Wait for children to load, if any.\n     * Then emit `loaded` event and set `hasLoaded`.\n     */\n    load: {\n      value: function (cb, childFilter) {\n        var children;\n        var childrenLoaded;\n        var self = this;\n\n        if (this.hasLoaded) { return; }\n\n        // Default to waiting for all nodes.\n        childFilter = childFilter || function (el) { return el.isNode; };\n\n        // Wait for children to load (if any), then load.\n        children = this.getChildren();\n        childrenLoaded = children.filter(childFilter).map(function (child) {\n          return new Promise(function waitForLoaded (resolve) {\n            if (child.hasLoaded) { return resolve(); }\n            child.addEventListener('loaded', resolve);\n          });\n        });\n\n        Promise.all(childrenLoaded).then(function emitLoaded () {\n          self.hasLoaded = true;\n          if (cb) { cb(); }\n          self.emit('loaded', {}, false);\n        });\n      },\n      writable: true\n    },\n\n    getChildren: {\n      value: function () {\n        return Array.prototype.slice.call(this.children, 0);\n      }\n    },\n\n    updateMixins: {\n      value: function (newMixins, oldMixins) {\n        var newMixinsIds = newMixins.split(' ');\n        var oldMixinsIds = oldMixins ? oldMixins.split(' ') : [];\n        // To determine what listeners will be removed\n        var diff = oldMixinsIds.filter(function (i) { return newMixinsIds.indexOf(i) < 0; });\n        this.mixinEls = [];\n        diff.forEach(bind(this.unregisterMixin, this));\n        newMixinsIds.forEach(bind(this.registerMixin, this));\n      }\n    },\n\n    registerMixin: {\n      value: function (mixinId) {\n        if (!this.sceneEl) { return; }\n        var mixinEl = this.sceneEl.querySelector('a-mixin#' + mixinId);\n        if (!mixinEl) { return; }\n        this.attachMixinListener(mixinEl);\n        this.mixinEls.push(mixinEl);\n      }\n    },\n\n    setAttribute: {\n      value: function (attr, newValue) {\n        if (attr === 'mixin') { this.updateMixins(newValue); }\n        HTMLElement.prototype.setAttribute.call(this, attr, newValue);\n      }\n    },\n\n    unregisterMixin: {\n      value: function (mixinId) {\n        var mixinEls = this.mixinEls;\n        var mixinEl;\n        var i;\n        for (i = 0; i < mixinEls.length; ++i) {\n          mixinEl = mixinEls[i];\n          if (mixinId === mixinEl.id) {\n            mixinEls.splice(i, 1);\n            break;\n          }\n        }\n        this.removeMixinListener(mixinId);\n      }\n    },\n\n    removeMixinListener: {\n      value: function (mixinId) {\n        var observer = this.mixinObservers[mixinId];\n        if (!observer) { return; }\n        observer.disconnect();\n        this.mixinObservers[mixinId] = null;\n      }\n    },\n\n    attachMixinListener: {\n      value: function (mixinEl) {\n        var self = this;\n        var mixinId = mixinEl.id;\n        var currentObserver = this.mixinObservers[mixinId];\n        if (!mixinEl) { return; }\n        if (currentObserver) { return; }\n        var observer = new MutationObserver(function (mutations) {\n          var attr = mutations[0].attributeName;\n          self.handleMixinUpdate(attr);\n        });\n        var config = { attributes: true };\n        observer.observe(mixinEl, config);\n        this.mixinObservers[mixinId] = observer;\n      }\n    },\n\n    handleMixinUpdate: {\n      value: function () { /* no-op */ }\n    },\n\n    /**\n     * Emits a DOM event.\n     *\n     * @param {String} name\n     *   Name of event (use a space-delimited string for multiple events).\n     * @param {Object=} [detail={}]\n     *   Custom data to pass as `detail` to the event.\n     * @param {Boolean=} [bubbles=true]\n     *   Whether the event should bubble.\n     */\n    emit: {\n      value: function (name, detail, bubbles) {\n        var self = this;\n        detail = detail || {};\n        if (bubbles === undefined) { bubbles = true; }\n        var data = { bubbles: !!bubbles, detail: detail };\n        return name.split(' ').map(function (eventName) {\n          return utils.fireEvent(self, eventName, data);\n        });\n      }\n    },\n\n    /**\n     * Returns a closure that emits a DOM event.\n     *\n     * @param {String} name\n     *   Name of event (use a space-delimited string for multiple events).\n     * @param {Object} detail\n     *   Custom data (optional) to pass as `detail` if the event is to\n     *   be a `CustomEvent`.\n     * @param {Boolean} bubbles\n     *   Whether the event should be bubble.\n     */\n    emitter: {\n      value: function (name, detail, bubbles) {\n        var self = this;\n        return function () {\n          self.emit(name, detail, bubbles);\n        };\n      }\n    }\n  })\n});\n","/* global HTMLElement */\nvar ANode = require('./a-node');\nvar COMPONENTS = require('./component').components;\nvar registerElement = require('./a-register-element').registerElement;\nvar THREE = require('../lib/three');\nvar utils = require('../utils/');\nvar bind = utils.bind;\n\nvar AEntity;\nvar debug = utils.debug('core:a-entity:debug');\nvar warn = utils.debug('core:a-entity:warn');\n\nvar MULTIPLE_COMPONENT_DELIMITER = '__';\n\n/**\n * Entity is a container object that components are plugged into to comprise everything in\n * the scene. In A-Frame, they inherently have position, rotation, and scale.\n *\n * To be able to take components, the scene element inherits from the entity definition.\n *\n * @member {object} components - entity's currently initialized components.\n * @member {object} object3D - three.js object.\n * @member {array} states\n * @member {boolean} isPlaying - false if dynamic behavior of the entity is paused.\n */\nvar proto = Object.create(ANode.prototype, {\n  defaultComponents: {\n    value: {\n      position: '',\n      rotation: '',\n      scale: '',\n      visible: ''\n    }\n  },\n\n  createdCallback: {\n    value: function () {\n      this.components = {};\n      this.isEntity = true;\n      this.isPlaying = false;\n      this.object3D = new THREE.Group();\n      this.object3D.el = this;\n      this.object3DMap = {};\n      this.parentEl = null;\n      this.states = [];\n    }\n  },\n\n  /**\n   * Handle changes coming from the browser DOM inspector.\n   */\n  attributeChangedCallback: {\n    value: function (attr, oldVal, newVal) {\n      var component = this.components[attr];\n      // If the empty string is passed by the component initialization\n      // logic we ignore the component update.\n      if (component && component.justInitialized && newVal === '') {\n        delete component.justInitialized;\n        return;\n      }\n      // When a component is removed after calling el.removeAttribute('material')\n      if (!component && newVal === null) { return; }\n      this.setEntityAttribute(attr, oldVal, newVal);\n    }\n  },\n\n  /**\n   * Add to parent, load, play.\n   */\n  attachedCallback: {\n    value: function () {\n      var assetsEl;  // Asset management system element.\n      var sceneEl = this.sceneEl;\n      var self = this;  // Component.\n\n      this.addToParent();\n\n      // Don't .load() scene on attachedCallback.\n      if (this.isScene) { return; }\n\n      // Gracefully not error when outside of <a-scene> (e.g., tests).\n      if (!sceneEl) {\n        this.load();\n        return;\n      }\n\n      // Wait for asset management system to finish before loading.\n      assetsEl = sceneEl.querySelector('a-assets');\n      if (assetsEl && !assetsEl.hasLoaded) {\n        assetsEl.addEventListener('loaded', function () { self.load(); });\n        return;\n      }\n      this.load();\n    }\n  },\n\n  /**\n   * Tell parent to remove this element's object3D from its object3D.\n   * Do not call on scene element because that will cause a call to document.body.remove().\n   */\n  detachedCallback: {\n    value: function () {\n      if (!this.parentEl || this.isScene) { return; }\n      // Remove components.\n      Object.keys(this.components).forEach(bind(this.removeComponent, this));\n      this.removeFromParent();\n      ANode.prototype.detachedCallback.call(this);\n    }\n  },\n\n  /**\n   * Apply mixin to component.\n   */\n  handleMixinUpdate: {\n    value: function (attrName) {\n      if (!attrName) {\n        this.updateComponents();\n        return;\n      }\n      this.updateComponent(attrName, this.getDOMAttribute(attrName));\n    }\n  },\n\n  mapStateMixins: {\n    value: function (state, op) {\n      var mixins = this.getAttribute('mixin');\n      var mixinIds;\n      if (!mixins) { return; }\n      mixinIds = mixins.split(' ');\n      mixinIds.forEach(function (id) {\n        var mixinId = id + '-' + state;\n        op(mixinId);\n      });\n      this.updateComponents();\n    }\n  },\n\n  updateStateMixins: {\n    value: function (newMixins, oldMixins) {\n      var self = this;\n      oldMixins = oldMixins || '';\n      var newMixinsIds = newMixins.split(' ');\n      var oldMixinsIds = oldMixins ? oldMixins.split(' ') : [];\n      // The list of mixins that might have been removed on update\n      var diff = oldMixinsIds.filter(function (i) { return newMixinsIds.indexOf(i) < 0; });\n      // Remove the mixins that are gone on update\n      diff.forEach(function (mixinId) {\n        var forEach = Array.prototype.forEach;\n        // State Mixins\n        var stateMixinsEls = document.querySelectorAll('[id^=' + mixinId + '-]');\n        forEach.call(stateMixinsEls, function (el) {\n          self.unregisterMixin(el.id);\n        });\n      });\n      this.states.forEach(function (state) {\n        newMixinsIds.forEach(function (id) {\n          var mixinId = id + '-' + state;\n          self.registerMixin(mixinId);\n        });\n      });\n    }\n  },\n\n  getObject3D: {\n    value: function (type) {\n      return this.object3DMap[type];\n    }\n  },\n\n  setObject3D: {\n    value: function (type, obj) {\n      var self = this;\n      var oldObj = this.object3DMap[type];\n      if (oldObj) { this.object3D.remove(oldObj); }\n      if (obj instanceof THREE.Object3D) {\n        obj.el = self;\n        this.object3D.add(obj);\n        if (obj.children.length) {\n          obj.traverse(function bindEl (child) {\n            child.el = self;\n          });\n        }\n      }\n      this.object3DMap[type] = obj;\n    }\n  },\n\n  removeObject3D: {\n    value: function (type) {\n      this.setObject3D(type, null);\n    }\n  },\n\n  /**\n   * Gets or creates an object3D of a given type.\n\n   * @param {string} type - Type of the object3D.\n   * @param {string} Constructor - Constructor to use if need to create the object3D.\n   * @type {Object}\n   */\n  getOrCreateObject3D: {\n    value: function (type, Constructor) {\n      var object3D = this.getObject3D(type);\n      if (!object3D && Constructor) {\n        object3D = new Constructor();\n        this.setObject3D(type, object3D);\n      }\n      return object3D;\n    }\n  },\n   /**\n   * Add child entity.\n   *\n   * @param {Element} el - Child entity.\n   */\n  add: {\n    value: function (el) {\n      if (!el.object3D) {\n        throw new Error(\"Trying to add an element that doesn't have an `object3D`\");\n      }\n      this.object3D.add(el.object3D);\n      this.emit('child-attached', { el: el });\n    }\n  },\n\n  /**\n   * Tell parentNode to add this entity to itself.\n   */\n  addToParent: {\n    value: function () {\n      var parentNode = this.parentEl = this.parentNode;\n\n      // `!parentNode` check primarily for unit tests.\n      if (!parentNode || !parentNode.add || this.attachedToParent) { return; }\n\n      parentNode.add(this);\n      this.attachedToParent = true;  // To prevent multiple attachments to same parent.\n    }\n  },\n\n  /**\n   * Tell parentNode to remove this entity from itself.\n   */\n  removeFromParent: {\n    value: function () {\n      var parentEl = this.parentEl;\n      this.parentEl.remove(this);\n      this.attachedToParent = false;\n      this.parentEl = this.parentNode = null;\n      parentEl.emit('child-detached', {el: this});\n    }\n  },\n\n  load: {\n    value: function () {\n      var self = this;\n\n      if (this.hasLoaded) { return; }\n\n      ANode.prototype.load.call(this, entityLoadCallback);\n      // Entity load.\n      function entityLoadCallback () {\n        self.updateComponents();\n        if (self.isScene || self.parentEl.isPlaying) { self.play(); }\n      }\n    },\n    writable: window.debug\n  },\n\n  /**\n   * Remove child entity.\n   *\n   * @param {Element} el - Child entity.\n   */\n  remove: {\n    value: function (el) {\n      this.object3D.remove(el.object3D);\n    }\n  },\n\n  /**\n   * @returns {array} Direct children that are entities.\n   */\n  getChildEntities: {\n    value: function () {\n      var children = this.children;\n      var childEntities = [];\n\n      for (var i = 0; i < children.length; i++) {\n        var child = children[i];\n        if (child instanceof AEntity) {\n          childEntities.push(child);\n        }\n      }\n\n      return childEntities;\n    }\n  },\n\n  /**\n   * Initialize component.\n   *\n   * @param {string} attrName - Attribute name asociated to the component.\n   * @param {object} data - Component data\n   * @param {boolean} isDependency - True if the component is a dependency.\n   */\n  initComponent: {\n    value: function (attrName, data, isDependency) {\n      var component;\n      var componentInfo = attrName.split(MULTIPLE_COMPONENT_DELIMITER);\n      var componentId = componentInfo[1];\n      var componentName = componentInfo[0];\n      var isComponentDefined = checkComponentDefined(this, attrName) || data !== undefined;\n      // Check if component is registered and whether component should be initialized.\n      if (!COMPONENTS[componentName] ||\n          (!isComponentDefined && !isDependency) ||\n          // If component already initialized.\n          (attrName in this.components)) {\n        return;\n      }\n\n      // Initialize dependencies first\n      this.initComponentDependencies(componentName);\n\n      // If component name has an id we check component type multiplic\n      if (componentId && !COMPONENTS[componentName].multiple) {\n        throw new Error('Trying to initialize multiple ' +\n                        'components of type `' + componentName +\n                        '`. There can only be one component of this type per entity.');\n      }\n      component = this.components[attrName] = new COMPONENTS[componentName].Component(\n        this, data, componentId);\n      if (this.isPlaying) { component.play(); }\n\n      // Components are reflected in the DOM as attributes but the state is not shown\n      // hence we set the attribute to empty string.\n      // The flag justInitialized is for attributeChangedCallback to not overwrite\n      // the component with the empty string.\n      if (!this.hasAttribute(attrName)) {\n        component.justInitialized = true;\n        HTMLElement.prototype.setAttribute.call(this, attrName, '');\n      }\n\n      debug('Component initialized: %s', attrName);\n    },\n    writable: window.debug\n  },\n\n  initComponentDependencies: {\n    value: function (name) {\n      var self = this;\n      var component = COMPONENTS[name];\n      var dependencies;\n      if (!component) { return; }\n      dependencies = COMPONENTS[name].dependencies;\n      if (!dependencies) { return; }\n      dependencies.forEach(function (component) {\n        self.initComponent(component, undefined, true);\n      });\n    }\n  },\n\n  removeComponent: {\n    value: function (name) {\n      var component;\n      var isDefault;\n      var isMixedIn;\n\n      // Don't remove default or mixed-in components.\n      isDefault = name in this.defaultComponents;\n      isMixedIn = isComponentMixedIn(name, this.mixinEls);\n      if (isDefault || isMixedIn) { return; }\n\n      component = this.components[name];\n      component.pause();\n      component.remove();\n      delete this.components[name];\n      this.emit('componentremoved', {\n        id: component.id,\n        name: name\n      });\n    }\n  },\n\n  /**\n   * Update all components.\n   * Build data using defined attributes, mixins, and defaults.\n   * Update default components before the rest.\n   */\n  updateComponents: {\n    value: function () {\n      var elComponents = {};\n      var self = this;\n      var i;\n      if (!this.hasLoaded) { return; }\n\n      // Gather entity-defined components.\n      var attributes = this.attributes;\n      for (i = 0; i < attributes.length; ++i) {\n        addComponent(attributes[i].name);\n      }\n\n      // Gather mixin-defined components.\n      getMixedInComponents(this).forEach(addComponent);\n\n      // Set default components.\n      Object.keys(this.defaultComponents).forEach(updateComponent);\n\n      // Set rest of components.\n      Object.keys(elComponents).forEach(updateComponent);\n\n      /**\n       * Add component to the list.\n       */\n      function addComponent (key) {\n        var name = key.split(MULTIPLE_COMPONENT_DELIMITER)[0];\n        if (!COMPONENTS[name]) { return; }\n        elComponents[key] = true;\n      }\n\n      /**\n       * Update component with given name.\n       */\n      function updateComponent (name) {\n        var attrValue = self.getDOMAttribute(name);\n        delete elComponents[name];\n        self.updateComponent(name, attrValue);\n      }\n    }\n  },\n\n  /**\n   * Initialize, update, or remove a single component.\n   *\n   * When initializing, we set the component on `this.components`.\n   *\n   * @param {string} attr - Component name.\n   * @param {object} attrValue - The value of the DOM attribute.\n   */\n  updateComponent: {\n    value: function (attr, attrValue) {\n      var component = this.components[attr];\n      var isDefault = attr in this.defaultComponents;\n      if (component) {\n        if (attrValue === null && !isDefault) {\n          this.removeComponent(attr);\n          return;\n        }\n        // Component already initialized. Update component.\n        component.updateProperties(attrValue);\n        return;\n      }\n      // Component not yet initialized. Initialize component.\n      this.initComponent(attr, attrValue, false);\n    }\n  },\n\n  /**\n   * Updates one property of the component\n   *\n   * @param {string} name - Component name\n   * @param {string} property - Component property name\n   * @param {any} propertyValue - New property value\n   */\n  updateComponentProperty: {\n    value: function (name, property, propertyValue) {\n      var component = this.components[name];\n      // Cached attribute value\n      var attrValue = component && component.attrValue;\n      // Copy cached value\n      var componentObj = attrValue ? utils.extend({}, attrValue) : {};\n      componentObj[property] = propertyValue;\n      this.updateComponent(name, componentObj);\n    }\n  },\n\n  /**\n   * If `attr` is a component name, removeAttribute detaches the component from the\n   * entity.\n   *\n   * @param {string} attr - Attribute name, which could also be a component name.\n   */\n  removeAttribute: {\n    value: function (attr) {\n      var component = this.components[attr];\n      if (component) {\n        this.setEntityAttribute(attr, undefined, null);\n        // The component might not be removed if it's a default one\n        if (this.components[attr]) { return; }\n      }\n      HTMLElement.prototype.removeAttribute.call(this, attr);\n    }\n  },\n\n  /**\n   * Start dynamic behavior associated with entity such as dynamic components and animations.\n   * Tell all children entities to also play.\n   */\n  play: {\n    value: function () {\n      var components = this.components;\n      var componentKeys = Object.keys(components);\n\n      // Already playing.\n      if (this.isPlaying || !this.hasLoaded) { return; }\n      this.isPlaying = true;\n\n      // Wake up all components.\n      componentKeys.forEach(function playComponent (key) {\n        components[key].play();\n      });\n\n      // Tell all child entities to play.\n      this.getChildEntities().forEach(function play (entity) {\n        entity.play();\n      });\n\n      this.emit('play');\n    },\n    writable: true\n  },\n\n  /**\n   * Pause dynamic behavior associated with entity such as dynamic components and animations.\n   * Tell all children entities to also pause.\n   */\n  pause: {\n    value: function () {\n      var components = this.components;\n      var componentKeys = Object.keys(components);\n\n      if (!this.isPlaying) { return; }\n      this.isPlaying = false;\n\n      // Sleep all components.\n      componentKeys.forEach(function pauseComponent (key) {\n        components[key].pause();\n      });\n\n      // Tell all child entities to pause.\n      this.getChildEntities().forEach(function pause (obj) {\n        obj.pause();\n      });\n\n      this.emit('pause');\n    },\n    writable: true\n  },\n\n  /**\n   * Deals with updates on entity-specific attributes (i.e., components and mixins).\n   *\n   * @param {string} attr\n   * @param {string} oldVal\n   * @param {string|object} newVal\n   */\n  setEntityAttribute: {\n    value: function (attr, oldVal, newVal) {\n      if (COMPONENTS[attr] || this.components[attr]) {\n        this.updateComponent(attr, newVal);\n        return;\n      }\n      if (attr === 'mixin') {\n        this.mixinUpdate(newVal, oldVal);\n        return;\n      }\n    }\n  },\n\n  mixinUpdate: {\n    value: function (newMixins, oldMixins) {\n      oldMixins = oldMixins || this.getAttribute('mixin');\n      this.updateStateMixins(newMixins, oldMixins);\n      this.updateComponents();\n    }\n  },\n\n  /**\n   * If attribute is a component, setAttribute will apply the value to the\n   * existing component data, not replace it. Examples:\n   *\n   * Examples:\n   *\n   * setAttribute('id', 'my-element');\n   * setAttribute('material', { color: 'crimson' });\n   * setAttribute('material', 'color', 'crimson');\n   *\n   * @param {string} attr - Attribute name. setAttribute will initialize or update\n   *        a component if the name corresponds to a registered component.\n   * @param {string|object} value - If a string, setAttribute will update the attribute or.\n   *        component. If an object, the value will be mixed into the component.\n   * @param {string} componentPropValue - If defined, `value` will act as the property\n   *        name and setAttribute will only set a single component property.\n   */\n  setAttribute: {\n    value: function (attr, value, componentPropValue) {\n      var isDebugMode = this.sceneEl && this.sceneEl.getAttribute('debug');\n      var componentName = attr.split(MULTIPLE_COMPONENT_DELIMITER)[0];\n      if (COMPONENTS[componentName]) {\n        // Just update one of the component properties\n        if (typeof value === 'string' && componentPropValue !== undefined) {\n          this.updateComponentProperty(attr, value, componentPropValue);\n        } else {\n          this.updateComponent(attr, value);\n        }\n        // On debug mode we write the component state to the DOM attributes\n        if (isDebugMode) { this.components[attr].flushToDOM(); }\n        return;\n      }\n\n      ANode.prototype.setAttribute.call(this, attr, value);\n      if (attr === 'mixin') { this.mixinUpdate(value); }\n    },\n    writable: window.debug\n  },\n\n  /**\n   * To make the DOM attributes reflect the state of the components.\n   *\n   * @param {bool} recursive - Call updateDOM on the children\n   **/\n  flushToDOM: {\n    value: function (recursive) {\n      var components = this.components;\n      var children = this.children;\n      var child;\n      var i;\n      Object.keys(components).forEach(updateDOMAtrribute);\n      if (!recursive) { return; }\n      for (i = 0; i < children.length; ++i) {\n        child = children[i];\n        if (!child.flushToDOM) { continue; }\n        child.flushToDOM(recursive);\n      }\n      function updateDOMAtrribute (name) { components[name].flushToDOM(); }\n    }\n  },\n\n  /**\n   * If `attr` is a component, returns ALL component data including applied mixins and\n   * defaults.\n   *\n   * If `attr` is not a component, fall back to HTML getAttribute.\n   *\n   * @param {string} attr\n   * @returns {object|string} Object if component, else string.\n   */\n  getAttribute: {\n    value: function (attr) {\n      // If component, return component data.\n      var component = this.components[attr];\n      if (component) { return component.getData(); }\n      return HTMLElement.prototype.getAttribute.call(this, attr);\n    },\n    writable: window.debug\n  },\n\n  /**\n   * `getAttribute` used to be `getDOMAttribute` and `getComputedAttribute` used to be\n   * what `getAttribute` is now. Now legacy code.\n   *\n   * @param {string} attr\n   * @returns {object|string} Object if component, else string.\n   */\n  getComputedAttribute: {\n    value: function (attr) {\n      warn('`getComputedAttribute` is deprecated. Use `getAttribute` instead.');\n      return this.getAttribute(attr);\n    }\n  },\n\n  /**\n   * If `attr` is a component, returns JUST the component data defined on the entity.\n   * Like a partial version of `getComputedAttribute` as returned component data\n   * does not include applied mixins or defaults.\n   *\n   * If `attr` is not a component, fall back to HTML getAttribute.\n   *\n   * @param {string} attr\n   * @returns {object|string} Object if component, else string.\n   */\n  getDOMAttribute: {\n    value: function (attr) {\n      // If cached value exists, return partial component data.\n      var component = this.components[attr];\n      if (component) { return component.attrValue; }\n      return HTMLElement.prototype.getAttribute.call(this, attr);\n    },\n    writable: window.debug\n  },\n\n  addState: {\n    value: function (state) {\n      if (this.is(state)) { return; }\n      this.states.push(state);\n      this.mapStateMixins(state, bind(this.registerMixin, this));\n      this.emit('stateadded', {state: state});\n    }\n  },\n\n  removeState: {\n    value: function (state) {\n      var stateIndex = this.states.indexOf(state);\n      if (stateIndex === -1) { return; }\n      this.states.splice(stateIndex, 1);\n      this.mapStateMixins(state, bind(this.unregisterMixin, this));\n      this.emit('stateremoved', {state: state});\n    }\n  },\n\n  /**\n   * Checks if the element is in a given state. e.g. el.is('alive');\n   * @type {string} state - Name of the state we want to check\n   */\n  is: {\n    value: function (state) {\n      return this.states.indexOf(state) !== -1;\n    }\n  }\n});\n\n/**\n * Check if a component is *defined* for an entity, including defaults and mixins.\n * Does not check whether the component has been *initialized* for an entity.\n *\n * @param {string} el - Entity.\n * @param {string} name - Component name.\n * @returns {boolean}\n */\nfunction checkComponentDefined (el, name) {\n  // Check if default components contain the component.\n  if (el.defaultComponents[name] !== undefined) { return true; }\n\n  // Check if element contains the component.\n  if (el.components[name] && el.components[name].attrValue) { return true; }\n\n  return isComponentMixedIn(name, el.mixinEls);\n}\n\nfunction getMixedInComponents (entityEl) {\n  var components = [];\n  entityEl.mixinEls.forEach(function getMixedComponents (mixinEl) {\n    Object.keys(mixinEl.componentCache).forEach(addComponent);\n    function addComponent (key) {\n      components.push(key);\n    }\n  });\n  return components;\n}\n\n/**\n * Check if any mixins contains a component.\n *\n * @param {string} name - Component name.\n * @param {array} mixinEls - Array of <a-mixin>s.\n */\nfunction isComponentMixedIn (name, mixinEls) {\n  var i;\n  var inMixin = false;\n  for (i = 0; i < mixinEls.length; ++i) {\n    inMixin = mixinEls[i].hasAttribute(name);\n    if (inMixin) { break; }\n  }\n  return inMixin;\n}\n\nAEntity = registerElement('a-entity', {\n  prototype: proto\n});\nmodule.exports = AEntity;\n","var ANode = require('./a-node');\nvar animationConstants = require('../constants/animation');\nvar coordinates = require('../utils/').coordinates;\nvar parseProperty = require('./schema').parseProperty;\nvar registerElement = require('./a-register-element').registerElement;\nvar TWEEN = require('tween.js');\nvar THREE = require('../lib/three');\nvar utils = require('../utils/');\nvar bind = utils.bind;\n\nvar getComponentProperty = utils.entity.getComponentProperty;\nvar DEFAULTS = animationConstants.defaults;\nvar DIRECTIONS = animationConstants.directions;\nvar EASING_FUNCTIONS = animationConstants.easingFunctions;\nvar FILLS = animationConstants.fills;\nvar REPEATS = animationConstants.repeats;\nvar isCoordinate = coordinates.isCoordinate;\n\n/**\n * Animation element that applies Tween animation to parent element (entity).\n * Takes after the Web Animations spec.\n *\n * @member {number} count - Decrementing counter for how many cycles of animations left to\n *         run.\n * @member {Element} el - Entity which the animation is modifying.\n * @member initialValue - Value before animation started. Used to restore state.\n * @member {bool} isRunning - Whether animation is currently running.\n * @member {function} partialSetAttribute -\n *   setAttribute function that is agnostic to whether we are setting an attribute value\n *   or a component property value. The el and the attribute names are bundled with\n *   the function.\n * @member {object} tween - tween.js object.\n */\nmodule.exports.AAnimation = registerElement('a-animation', {\n  prototype: Object.create(ANode.prototype, {\n    createdCallback: {\n      value: function () {\n        this.bindMethods();\n        this.isRunning = false;\n        this.partialSetAttribute = function () { /* no-op */ };\n        this.tween = null;\n      }\n    },\n\n    attachedCallback: {\n      value: function () {\n        this.el = this.parentNode;\n        this.handleMixinUpdate();\n        this.update();\n        this.load();\n      }\n    },\n\n    attributeChangedCallback: {\n      value: function (attr, oldVal, newVal) {\n        if (!this.hasLoaded || !this.isRunning) { return; }\n        this.stop();\n        this.handleMixinUpdate();\n        this.update();\n      }\n    },\n\n    detachedCallback: {\n      value: function () {\n        if (!this.isRunning) { return; }\n        this.stop();\n      }\n    },\n\n    /**\n     * Builds a Tween object to handle animations.\n     * Uses tween.js's from, to, delay, easing, repeat, onUpdate, and onComplete.\n     * Note: tween.js takes objects for its `from` and `to` values.\n     *\n     * @returns {object}\n     */\n    getTween: {\n      value: function () {\n        var self = this;\n        var data = self.data;\n        var el = self.el;\n        var animationValues;\n        var attribute = data.attribute;\n        var delay = parseInt(data.delay, 10);\n        var currentValue = getComponentProperty(el, attribute);\n        var direction = self.getDirection(data.direction);\n        var easing = EASING_FUNCTIONS[data.easing];\n        var fill = data.fill;\n        var from;\n        var repeat = data.repeat === REPEATS.indefinite ? Infinity : 0;\n        var to;\n        var toTemp;\n        var yoyo = false;\n\n        animationValues = getAnimationValues(el, attribute, data.from || self.initialValue, data.to, currentValue);\n        from = animationValues.from;\n        to = animationValues.to;\n        self.partialSetAttribute = animationValues.partialSetAttribute;\n\n        if (self.count === undefined) {\n          self.count = repeat === Infinity ? 0 : parseInt(data.repeat, 10);\n        }\n\n        if (isNaN(delay)) { delay = 0; }\n\n        // Store initial state.\n        self.initialValue = self.initialValue || cloneValue(currentValue);\n\n        // Handle indefinite + forwards + alternate yoyo edge-case (#405).\n        if (repeat === Infinity && fill === FILLS.forwards &&\n            [DIRECTIONS.alternate,\n             DIRECTIONS.alternateReverse].indexOf(data.direction) !== -1) {\n          yoyo = true;\n        }\n\n        // If reversing, swap from and to.\n        if (direction === DIRECTIONS.reverse) {\n          toTemp = to;\n          to = cloneValue(from);\n          from = cloneValue(toTemp);\n        }\n\n        // If fill is backwards or both, start animation at the specified from.\n        if ([FILLS.backwards, FILLS.both].indexOf(fill) !== -1) {\n          self.partialSetAttribute(from);\n        }\n\n        // Create Tween.\n        return new TWEEN.Tween(cloneValue(from))\n          .to(to, data.dur)\n          .delay(delay)\n          .easing(easing)\n          .repeat(repeat)\n          .yoyo(yoyo)\n          .onUpdate(function () {\n            self.partialSetAttribute(this);\n          })\n          .onComplete(bind(self.onCompleted, self));\n      }\n    },\n\n    /**\n     * Animation parameters changed. Stop current animation, get a new one, and start it.\n     */\n    update: {\n      value: function () {\n        var data = this.data;\n        // Terminology warning if infinite used instead of indefinite\n        if (data.repeat === 'infinite') {\n          console.warn(\"Using 'infinite' as 'repeat' value is invalid.  Use 'indefinite' instead.\");\n        }\n        // Deprecation warning for begin when used as a delay.\n        if (data.begin !== '' && !isNaN(data.begin)) {\n          console.warn(\"Using 'begin' to specify a delay is deprecated. Use 'delay' instead.\");\n          data.delay = data.begin;\n          data.begin = '';\n        }\n        var begin = data.begin;\n        var end = data.end;\n        // Cancel previous event listeners\n        if (this.evt) { this.removeEventListeners(this.evt); }\n        // Store new event name.\n        this.evt = {begin: begin, end: end};\n        // Add new event listeners\n        this.addEventListeners(this.evt);\n        // If `begin` is not defined, start the animation right away.\n        if (begin === '') {\n          this.stop();\n          this.start();\n        }\n      },\n      writable: window.debug\n    },\n\n    /**\n     * Callback for when a cycle of an animation is complete. Handles when to completely\n     * finish the animation.\n     *\n     * If `repeat` is set to a value, this method is called after each repeat. Repeats are\n     * handled by ending the current animation and creating a new one with `count` updated.\n     * Note that this method is *not* called if repeat is set to `indefinite`.\n     */\n    onCompleted: {\n      value: function () {\n        var data = this.data;\n        this.isRunning = false;\n        if ([FILLS.backwards, FILLS.none].indexOf(data.fill) !== -1) {\n          this.partialSetAttribute(this.initialValue);\n        }\n        if (this.count === 0) {\n          this.count = undefined;\n          this.emit('animationend');\n          return;\n        }\n        this.isRunning = false;\n        this.count--;\n        this.start();\n      }\n    },\n\n    start: {\n      value: function () {\n        var self = this;\n        // Postpone animation start until the entity has loaded\n        if (!this.el.hasLoaded) {\n          this.el.addEventListener('loaded', function () { self.start(); });\n          return;\n        }\n        if (this.isRunning || !this.el.isPlaying) { return; }\n        this.tween = this.getTween();\n        this.isRunning = true;\n        this.tween.start();\n        this.emit('animationstart');\n      },\n      writable: true\n    },\n\n    stop: {\n      value: function () {\n        var tween = this.tween;\n        if (!tween) { return; }\n        tween.stop();\n        this.isRunning = false;\n        if ([FILLS.backwards, FILLS.none].indexOf(this.data.fill) !== -1) {\n          this.partialSetAttribute(this.initialValue);\n        }\n        this.emit('animationstop');\n      },\n      writable: true\n    },\n\n    /**\n     * Handle alternating directions. Given the current direction, calculate the next one,\n     * and store the current one.\n     *\n     * @param {string} direction\n     * @returns {string} Direction that the next individual cycle of the animation will go\n     *          towards.\n     */\n    getDirection: {\n      value: function (direction) {\n        if (direction === DIRECTIONS.alternate) {\n          this.prevDirection =\n            this.prevDirection === DIRECTIONS.normal ? DIRECTIONS.reverse : DIRECTIONS.normal;\n          return this.prevDirection;\n        }\n        if (direction === DIRECTIONS.alternateReverse) {\n          this.prevDirection =\n            this.prevDirection === DIRECTIONS.reverse ? DIRECTIONS.normal : DIRECTIONS.reverse;\n          return this.prevDirection;\n        }\n        return direction;\n      }\n    },\n\n    /**\n     * Preemptive binding to attach/detach event listeners (see `update`).\n     */\n    bindMethods: {\n      value: function () {\n        this.start = bind(this.start, this);\n        this.stop = bind(this.stop, this);\n        this.onStateAdded = bind(this.onStateAdded, this);\n        this.onStateRemoved = bind(this.onStateRemoved, this);\n      }\n    },\n\n    addEventListeners: {\n      value: function (evts) {\n        var el = this.el;\n        var self = this;\n        utils.splitString(evts.begin).forEach(function (evt) {\n          el.addEventListener(evt, self.start);\n        });\n        utils.splitString(evts.end).forEach(function (evt) {\n          el.addEventListener(evt, self.stop);\n        });\n        // If \"begin\" is an event name, wait. If it is not defined, start.\n        if (evts.begin === '') { el.addEventListener('play', this.start); }\n        el.addEventListener('pause', this.stop);\n        el.addEventListener('stateadded', this.onStateAdded);\n        el.addEventListener('stateremoved', this.onStateRemoved);\n      }\n    },\n\n    removeEventListeners: {\n      value: function (evts) {\n        var el = this.el;\n        var start = this.start;\n        var stop = this.stop;\n        utils.splitString(evts.begin).forEach(function (evt) {\n          el.removeEventListener(evt, start);\n        });\n        utils.splitString(evts.end).forEach(function (evt) {\n          el.removeEventListener(evt, stop);\n        });\n        el.removeEventListener('stateadded', this.onStateAdded);\n        el.removeEventListener('stateremoved', this.onStateRemoved);\n      }\n    },\n\n    onStateAdded: {\n      value: function (evt) {\n        if (evt.detail.state === this.data.begin) { this.start(); }\n      },\n      writable: true\n    },\n\n    onStateRemoved: {\n      value: function (evt) {\n        if (evt.detail.state === this.data.begin) { this.stop(); }\n      },\n      writable: true\n    },\n\n    /**\n     * Applies animation data from a mixin element.\n     * Works the same as component mixins but reimplemented because animations\n     * aren't components.\n     */\n    handleMixinUpdate: {\n      value: function () {\n        var data = {};\n        var elData;\n        var mixinData;\n        var mixinEl;\n\n        // Get mixin data.\n        mixinEl = document.querySelector('#' + this.getAttribute('mixin'));\n        mixinData = mixinEl ? utils.getElData(mixinEl, DEFAULTS) : {};\n\n        elData = utils.getElData(this, DEFAULTS);\n        utils.extend(data, DEFAULTS, mixinData, elData);\n        this.data = data;\n      }\n    }\n  })\n});\n\nfunction cloneValue (val) {\n  return utils.extend({}, val);\n}\n\n/**\n * Deduces different animation values based on whether we are:\n *   - animating an inner attribute of a component.\n *   - animating a coordinate component.\n *   - animating a boolean.\n *   - animating a number.\n *\n * @param {Element} el\n * @param {string} attribute - Tells what to animate based on whether it is dot-separated.\n * @param {string} dataFrom - Data `from` value.\n * @param {string} dataTo - Data `to` value.\n * @param currentValue\n * @returns {object}\n *   Object with keys [from, to, partialSetAttribute].\n *     `from` and `to`\n *        Objects where key is attribute being animated and value is value.\n *     `partialSetAttribute`\n *        Closured-function that tells tween how to update the component.\n */\nfunction getAnimationValues (el, attribute, dataFrom, dataTo, currentValue) {\n  var attributeSplit = attribute.split('.');\n  var schema;\n  var component;\n  var componentPropName;\n  var componentName;\n  var from = {};\n  var partialSetAttribute;\n  var to = {};\n  if (attributeSplit.length === 2) {\n    if (isColor()) {\n      getForColorComponent();\n    } else {\n      getForComponentAttribute();\n    }\n  } else if (dataTo && isCoordinate(dataTo)) {\n    getForCoordinateComponent();\n  } else if (['true', 'false'].indexOf(dataTo) !== -1) {\n    getForBoolean();\n  } else if (isNaN(dataTo)) {\n    getForColorComponent();\n  } else {\n    getForNumber();\n  }\n  return {\n    from: from,\n    partialSetAttribute: partialSetAttribute,\n    to: to\n  };\n\n  /**\n   * Match the schema type to color\n   * @return {bool} if the schema is of type color\n   */\n  function isColor () {\n    var componentName = attributeSplit[0];\n    var propertyName = attributeSplit[1];\n    var component = el.components[componentName];\n    var schema = component && component.schema;\n    return schema && schema[propertyName] && schema[propertyName].type === 'color';\n  }\n\n  /**\n   * Animating a component that has multiple attributes (e.g., geometry.width).\n   */\n  function getForComponentAttribute () {\n    componentName = attributeSplit[0];\n    componentPropName = attributeSplit[1];\n    component = el.components[componentName];\n    if (!component) {\n      el.setAttribute(componentName, '');\n      component = el.components[componentName];\n    }\n    schema = component.schema;\n    if (dataFrom === undefined) {  // dataFrom can be 0.\n      from[attribute] = getComponentProperty(el, attribute);\n    } else {\n      from[attribute] = dataFrom;\n    }\n    from[attribute] = parseProperty(from[attribute], schema[componentPropName]);\n    to[attribute] = parseProperty(dataTo, schema[componentPropName]);\n    partialSetAttribute = function (value) {\n      if (!(attribute in value)) { return; }\n      el.setAttribute(componentName, componentPropName, value[attribute]);\n    };\n  }\n\n  /**\n   * Animating a component that is an XYZ coordinate (e.g., position).\n   * Will be tweening {x, y, z} all at once.\n   */\n  function getForCoordinateComponent () {\n    from = dataFrom ? coordinates.parse(dataFrom) : currentValue;\n    to = coordinates.parse(dataTo);\n    partialSetAttribute = function (value) {\n      el.setAttribute(attribute, value);\n    };\n  }\n\n  /**\n   * Animation a boolean (e.g., visible).\n   * Have to convert from boolean to an integer (0 is false, > 0 is true) for tween.\n   */\n  function getForBoolean () {\n    if (dataFrom === undefined) {\n      from[attribute] = false;\n    } else {\n      from[attribute] = strToBool(dataFrom);\n    }\n    from[attribute] = boolToNum(from[attribute]);\n    to[attribute] = boolToNum(strToBool(dataTo));\n    partialSetAttribute = function (value) {\n      el.setAttribute(attribute, !!value[attribute]);\n    };\n  }\n\n  /**\n   * Animating a color component\n   *   Will convert a hex value to a THREE.Color\n   *   Then converts to hex for the setAttribute\n   */\n  function getForColorComponent () {\n    from = new THREE.Color(dataFrom);\n    to = new THREE.Color(dataTo);\n    partialSetAttribute = function (value) {\n      if (attributeSplit.length > 1) {\n        el.setAttribute(attributeSplit[0], attributeSplit[1], rgbVectorToHex(value));\n      }\n      el.setAttribute(attribute, rgbVectorToHex(value));\n    };\n  }\n\n  /**\n   * Animating a numbered attribute (e.g., opacity).\n   */\n  function getForNumber () {\n    if (dataFrom === undefined) {  // dataFrom can be 0.\n      from[attribute] = parseFloat(el.getAttribute(attribute));\n    } else {\n      from[attribute] = parseFloat(dataFrom);\n    }\n    to[attribute] = parseFloat(dataTo);\n    partialSetAttribute = function (value) {\n      el.setAttribute(attribute, value[attribute]);\n    };\n  }\n}\nmodule.exports.getAnimationValues = getAnimationValues;\n\n/**\n * Converts string to bool.\n *\n * @param {string} str - `true` or `false`.\n * @returns {bool}\n */\nfunction strToBool (str) {\n  if (str === 'true') { return true; }\n  return false;\n}\n\n/**\n * Converts boolean to number.\n *\n * @param {bool}\n * @returns {number}\n */\nfunction boolToNum (bool) {\n  return bool ? 1 : 0;\n}\n\n/**\n * Converts a number 0-255 to hex\n * @param {number} color number 0 - 255\n * @returns {string} hex value of number bassed\n */\nfunction componentToHex (color) {\n  var hex = color.toString(16);\n  return hex.length === 1 ? '0' + hex : hex;\n}\n\n/**\n * Clamps a number to 0-1\n * Then converts that number to 0-255\n * @param {number} color number 0 - 1\n * @returns {number} color number 0 - 255\n */\nfunction convertToIntegerColor (color) {\n  return Math.floor(Math.min(Math.abs(color), 1) * 255);\n}\n\n/**\n * Converts a rgb object into a hex string\n * @param {object} color { r: 1, g: 1, b: 1 }\n * @returns {string} hex value #ffffff\n */\nfunction rgbVectorToHex (color) {\n  return '#' + ['r', 'g', 'b'].map(function (prop) {\n    return componentToHex(convertToIntegerColor(color[prop]));\n  }).join('');\n}\n","var ANode = require('./a-node');\nvar bind = require('../utils/bind');\nvar debug = require('../utils/debug');\nvar registerElement = require('./a-register-element').registerElement;\nvar THREE = require('../lib/three');\n\nvar xhrLoader = new THREE.XHRLoader();\nvar warn = debug('core:a-assets:warn');\n\n/**\n * Asset management system. Handles blocking on asset loading.\n */\nmodule.exports = registerElement('a-assets', {\n  prototype: Object.create(ANode.prototype, {\n    createdCallback: {\n      value: function () {\n        this.isAssets = true;\n      }\n    },\n\n    attachedCallback: {\n      value: function () {\n        var self = this;\n        var i;\n        var loaded = [];\n        var mediaEl;\n        var mediaEls;\n        var imgEl;\n        var imgEls;\n        var timeout;\n\n        if (!this.parentNode.isScene) {\n          throw new Error('<a-assets> must be a child of a <a-scene>.');\n        }\n\n        // Wait for <img>s.\n        imgEls = this.querySelectorAll('img');\n        for (i = 0; i < imgEls.length; i++) {\n          imgEl = setCrossOrigin(imgEls[i]);\n          loaded.push(new Promise(function (resolve, reject) {\n            imgEl.onload = resolve;\n            imgEl.onerror = reject;\n          }));\n        }\n\n        // Wait for <audio>s and <video>s.\n        mediaEls = this.querySelectorAll('audio, video');\n        for (i = 0; i < mediaEls.length; i++) {\n          mediaEl = setCrossOrigin(mediaEls[i]);\n          loaded.push(mediaElementLoaded(mediaEl));\n        }\n\n        // Trigger loaded for scene to start rendering.\n        Promise.all(loaded).then(bind(this.load, this));\n\n        // Timeout to start loading anyways.\n        timeout = parseInt(this.getAttribute('timeout'), 10) || 3000;\n        setTimeout(function () {\n          if (self.hasLoaded) { return; }\n          warn('Asset loading timed out in ', timeout, 'ms');\n          self.emit('timeout');\n          self.load();\n        }, timeout);\n      }\n    },\n\n    load: {\n      value: function () {\n        ANode.prototype.load.call(this, null, function waitOnFilter (el) {\n          return el.isAssetItem && el.hasAttribute('src');\n        });\n      }\n    }\n  })\n});\n\nregisterElement('a-asset-item', {\n  prototype: Object.create(ANode.prototype, {\n    createdCallback: {\n      value: function () {\n        this.data = null;\n        this.isAssetItem = true;\n      }\n    },\n\n    attachedCallback: {\n      value: function () {\n        var self = this;\n        var src = src = this.getAttribute('src');\n        xhrLoader.load(src, function (textResponse) {\n          THREE.Cache.files[src] = textResponse;\n          self.data = textResponse;\n          // Workaround for a Chrome bug.\n          // if another XMLHttpRequest is sent to the same url\n          // before the previous one closes. The second request never finishes.\n          // setTimeout finishes the first request and lets the logic\n          // triggered by load open subsequent requests.\n          // setTimeout can be removed once the fix for the bug below ships:\n          // https://bugs.chromium.org/p/chromium/issues/detail?id=633696&q=component%3ABlink%3ENetwork%3EXHR%20&colspec=ID%20Pri%20M%20Stars%20ReleaseBlock%20Component%20Status%20Owner%20Summary%20OS%20Modified\n          setTimeout(function load () { ANode.prototype.load.call(self); });\n        });\n      }\n    }\n  })\n});\n\n/**\n * Create a Promise that resolves once the media element has finished buffering.\n *\n * @param {Element} el - HTMLMediaElement.\n * @returns {Promise}\n */\nfunction mediaElementLoaded (el) {\n  if (!el.hasAttribute('autoplay') && el.getAttribute('preload') !== 'auto') {\n    return;\n  }\n\n  // If media specifies autoplay or preload, wait until media is completely buffered.\n  return new Promise(function (resolve, reject) {\n    if (el.readyState === 4) { return resolve(); }  // Already loaded.\n    if (el.error) { return reject(); }  // Error.\n\n    el.addEventListener('loadeddata', checkProgress, false);\n    el.addEventListener('progress', checkProgress, false);\n    el.addEventListener('error', reject, false);\n\n    function checkProgress () {\n      // Add up the seconds buffered.\n      var secondsBuffered = 0;\n      for (var i = 0; i < el.buffered.length; i++) {\n        secondsBuffered += el.buffered.end(i) - el.buffered.start(i);\n      }\n\n      // Compare seconds buffered to media duration.\n      if (secondsBuffered >= el.duration) {\n        resolve();\n      }\n    }\n  });\n}\n\n/**\n * Automatically set `crossorigin` if not defined on the media element.\n * If it is not defined, we must create and re-append a new media element <img> and\n * have the browser re-request it with `crossorigin` set.\n *\n * @param {Element} Media element (e.g., <img>, <audio>, <video>).\n * @returns {Element} Media element to be used to listen to for loaded events.\n */\nfunction setCrossOrigin (mediaEl) {\n  var newMediaEl;\n  var src;\n\n  // Already has crossorigin set.\n  if (mediaEl.hasAttribute('crossorigin')) { return mediaEl; }\n\n  src = mediaEl.getAttribute('src');\n\n  if (src !== null) {\n    // Does not have protocol.\n    if (src.indexOf('://') === -1) { return mediaEl; }\n\n    // Determine if cross origin is actually needed.\n    if (extractDomain(src) === window.location.host) { return mediaEl; }\n  }\n\n  warn('Cross-origin element was requested without `crossorigin` set. ' +\n       'A-Frame will re-request the asset with `crossorigin` attribute set.', src);\n  mediaEl.crossOrigin = 'anonymous';\n  newMediaEl = mediaEl.cloneNode(true);\n  mediaEl.parentNode.appendChild(newMediaEl);\n  mediaEl.parentNode.removeChild(mediaEl);\n  return newMediaEl;\n}\n\n/**\n * Extract domain out of URL.\n *\n * @param {string} url\n * @returns {string}\n */\nfunction extractDomain (url) {\n  // Find and remove protocol (e.g., http, ftp, etc.) to get domain.\n  var domain = url.indexOf('://') > -1 ? url.split('/')[2] : url.split('/')[0];\n\n  // Find and remove port number.\n  return domain.split(':')[0];\n}\n","/* global HTMLElement */\nvar debug = require('../utils/debug');\nvar registerElement = require('./a-register-element').registerElement;\n\nvar warn = debug('core:cubemap:warn');\n\n/**\n * Cubemap element that handles validation and exposes list of URLs.\n * Does not listen to updates.\n */\nmodule.exports = registerElement('a-cubemap', {\n  prototype: Object.create(HTMLElement.prototype, {\n    /**\n     * Calculates this.srcs.\n     */\n    attachedCallback: {\n      value: function () {\n        this.srcs = this.validate();\n      },\n      writable: window.debug\n    },\n\n    /**\n     * Checks for exactly six elements with [src].\n     * Does not check explicitly for <img>s in case user does not want\n     * prefetching.\n     *\n     * @returns {Array|null} - six URLs if valid, else null.\n     */\n    validate: {\n      value: function () {\n        var elements = this.querySelectorAll('[src]');\n        var i;\n        var srcs = [];\n        if (elements.length === 6) {\n          for (i = 0; i < elements.length; i++) {\n            srcs.push(elements[i].getAttribute('src'));\n          }\n          return srcs;\n        }\n        // Else if there are not six elements, throw a warning.\n        warn(\n          '<a-cubemap> did not contain exactly six elements each with a ' +\n          '`src` attribute.');\n      },\n      writable: window.debug\n    }\n  })\n});\n","/* global HTMLElement */\nvar ANode = require('./a-node');\nvar registerElement = require('./a-register-element').registerElement;\nvar components = require('./component').components;\n\n/**\n * @member {object} componentCache - Cache of pre-parsed values. An object where the keys\n *         are component names and the values are already parsed by the component.\n */\nmodule.exports = registerElement('a-mixin', {\n  prototype: Object.create(ANode.prototype, {\n    createdCallback: {\n      value: function () {\n        this.componentCache = {};\n        this.id = this.getAttribute('id');\n      }\n    },\n\n    attributeChangedCallback: {\n      value: function (attr, oldVal, newVal) {\n        this.cacheAttribute(attr, newVal);\n      }\n    },\n\n    attachedCallback: {\n      value: function () {\n        this.sceneEl = this.closestScene();\n        this.cacheAttributes();\n        this.updateEntities();\n        this.load();\n      }\n    },\n\n    /**\n     * setAttribute that parses and caches component values.\n     */\n    setAttribute: {\n      value: function (attr, value) {\n        this.cacheAttribute(attr, value);\n        HTMLElement.prototype.setAttribute.call(this, attr, value);\n      }\n    },\n\n    /**\n     * If `attr` is a component, then parse the value using the schema and store it.\n     */\n    cacheAttribute: {\n      value: function (attr, value) {\n        var component = components[attr];\n        if (!component) { return; }\n        if (value === undefined) {\n          value = HTMLElement.prototype.getAttribute.call(this, attr);\n        }\n        this.componentCache[attr] = component.parseAttrValueForCache(value);\n      }\n    },\n\n    /**\n     * If `attr` is a component, then grab pre-parsed value from the cache.\n     * Else do a normal getAttribute.\n     */\n    getAttribute: {\n      value: function (attr) {\n        return this.componentCache[attr] ||\n               HTMLElement.prototype.getAttribute.call(this, attr);\n      }\n    },\n\n    /**\n     * Parse and cache every component defined on the mixin.\n     */\n    cacheAttributes: {\n      value: function () {\n        var attributes = this.attributes;\n        var attrName;\n        var i;\n        for (i = 0; i < attributes.length; i++) {\n          attrName = attributes[i].name;\n          this.cacheAttribute(attrName);\n        }\n      }\n    },\n\n    /**\n     * For entities that already have been loaded by the time the mixin was attached, tell\n     * those entities to register the mixin and refresh their component data.\n     */\n    updateEntities: {\n      value: function () {\n        if (!this.sceneEl) { return; }\n        var entities = this.sceneEl.querySelectorAll('[mixin~=' + this.id + ']');\n        for (var i = 0; i < entities.length; i++) {\n          var entity = entities[i];\n          if (!entity.hasLoaded) { continue; }\n          entity.registerMixin(this.id);\n          Object.keys(this.componentCache).forEach(function updateComponent (componentName) {\n            entity.updateComponent(componentName);\n          });\n        }\n      }\n    }\n  })\n});\n","/*\n  ------------------------------------------------------------\n  ------------- WARNING WARNING WARNING WARNING --------------\n  ------------------------------------------------------------\n\n  This module wraps registerElement to deal with components that inherit from\n  `ANode` and `AEntity`.  It's a pass through in any other case.\n\n  It wraps some of the prototype methods of the created element to make sure\n  that the corresponding functions in the base prototypes (`AEntity` and `ANode`)\n  are also invoked. The method in the base prototype is always called before the one\n  in the derived prototype.\n*/\n\n// Polyfill `document.registerElement`.\nrequire('document-register-element');\n\nvar ANode;  // Must declare before AEntity. Initialized at the bottom.\nvar AEntity;\nvar knownTags = module.exports.knownTags = {};\n\nfunction addTagName (tagName) {\n  knownTags[tagName.toLowerCase()] = true;\n}\n\n/**\n * Return whether the element type is one of our known registered ones.\n *\n * @param {string} node - The name of the tag to register.\n * @returns {boolean} Whether the tag name matches that of our registered custom elements.\n */\nmodule.exports.isNode = function (node) {\n  return node.tagName.toLowerCase() in knownTags || node.isNode;\n};\n\n/**\n * @param {string} tagName - The name of the tag to register.\n * @param {object} obj - The prototype of the new element.\n * @returns {object} The prototype of the new element.\n */\nmodule.exports.registerElement = function (tagName, obj) {\n  var proto = Object.getPrototypeOf(obj.prototype);\n  var newObj = obj;\n  var isANode = ANode && proto === ANode.prototype;\n  var isAEntity = AEntity && proto === AEntity.prototype;\n\n  if (isANode || isAEntity) { addTagName(tagName); }\n\n  // Wrap if element inherits from `ANode`.\n  if (isANode) {\n    newObj = wrapANodeMethods(obj.prototype);\n    newObj = {prototype: Object.create(proto, newObj)};\n  }\n\n  // Wrap if element inherits from `AEntity`.\n  if (isAEntity) {\n    newObj = wrapAEntityMethods(obj.prototype);\n    newObj = {prototype: Object.create(proto, newObj)};\n  }\n\n  return document.registerElement(tagName, newObj);\n};\n\n/**\n * Wrap some obj methods to call those on `ANode` base prototype.\n *\n * @param {object} obj - Object that contains the methods that will be wrapped.\n * @return {object} An object with the same properties as the input parameter but\n * with some of methods wrapped.\n */\nfunction wrapANodeMethods (obj) {\n  var newObj = {};\n  var ANodeMethods = [\n    'attachedCallback',\n    'attributeChangedCallback',\n    'createdCallback'\n  ];\n  wrapMethods(newObj, ANodeMethods, obj, ANode.prototype);\n  copyProperties(obj, newObj);\n  return newObj;\n}\n\n/**\n * This wraps some of the obj methods to call those on `AEntity` base prototype.\n *\n * @param {object} obj - The objects that contains the methods that will be wrapped.\n * @return {object} - An object with the same properties as the input parameter but\n * with some of methods wrapped.\n */\nfunction wrapAEntityMethods (obj) {\n  var newObj = {};\n  var ANodeMethods = [\n    'attachedCallback',\n    'attributeChangedCallback',\n    'createdCallback'\n  ];\n  var AEntityMethods = [\n    'attachedCallback',\n    'attributeChangedCallback',\n    'createdCallback',\n    'detachedCallback'\n  ];\n\n  wrapMethods(newObj, ANodeMethods, obj, ANode.prototype);\n  wrapMethods(newObj, AEntityMethods, obj, AEntity.prototype);\n  // Copies the remaining properties into the new object.\n  copyProperties(obj, newObj);\n  return newObj;\n}\n\n/**\n * Wrap a list a methods to ensure that those in the base prototype are called\n * before the derived one.\n *\n * @param {object} targetObj - Object that will contain the wrapped methods.\n * @param {array} methodList - List of methods from the derivedObj that will be wrapped.\n * @param {object} derivedObject - Object that inherits from the baseObj.\n * @param {object} baseObj - Object that derivedObj inherits from.\n */\nfunction wrapMethods (targetObj, methodList, derivedObj, baseObj) {\n  methodList.forEach(function (methodName) {\n    wrapMethod(targetObj, methodName, derivedObj, baseObj);\n  });\n}\nmodule.exports.wrapMethods = wrapMethods;\n\n/**\n * Wrap one method to ensure that the one in the base prototype is called before\n * the one in the derived one.\n *\n * @param {object} obj - Object that will contain the wrapped method.\n * @param {string} methodName - The name of the method that will be wrapped.\n * @param {object} derivedObject - Object that inherits from the baseObj.\n * @param {object} baseObj - Object that derivedObj inherits from.\n */\nfunction wrapMethod (obj, methodName, derivedObj, baseObj) {\n  var derivedMethod = derivedObj[methodName];\n  var baseMethod = baseObj[methodName];\n\n  // Derived prototype does not define method, no need to wrap.\n  if (!derivedMethod || !baseMethod) { return; }\n\n  // Derived prototype doesn't override the one in the base one, no need to wrap.\n  if (derivedMethod === baseMethod) { return; }\n\n  // Wrap to ensure the base method is called before the one in the derived prototype.\n  obj[methodName] = {\n    value: function wrappedMethod () {\n      baseMethod.apply(this, arguments);\n      return derivedMethod.apply(this, arguments);\n    },\n    writable: window.debug\n  };\n}\n\n/**\n * It copies the properties from source to destination object if they don't\n * exist already.\n *\n * @param {object} source - The object where properties are copied from.\n * @param {type} destination - The object where properties are copied to.\n */\nfunction copyProperties (source, destination) {\n  var props = Object.getOwnPropertyNames(source);\n  props.forEach(function (prop) {\n    var desc;\n    if (!destination[prop]) {\n      desc = Object.getOwnPropertyDescriptor(source, prop);\n      destination[prop] = {value: source[prop], writable: desc.writable};\n    }\n  });\n}\n\nANode = require('./a-node');\nAEntity = require('./a-entity');\n","var debug = require('../utils/debug');\nvar propertyTypes = require('./propertyTypes').propertyTypes;\nvar warn = debug('core:schema:warn');\n\n/**\n * A schema is classified as a schema for a single property if:\n * - `type` is defined on the schema as a string.\n * - OR `default` is defined on the schema, as a reserved keyword.\n * - OR schema is empty.\n */\nfunction isSingleProperty (schema) {\n  if ('type' in schema) {\n    return typeof schema.type === 'string';\n  }\n  return 'default' in schema;\n}\nmodule.exports.isSingleProperty = isSingleProperty;\n\n/**\n * Build step to schema to use `type` to inject default value, parser, and stringifier.\n *\n * @param {object} schema\n * @returns {object} Schema.\n */\nmodule.exports.process = function (schema) {\n  // For single property schema, run processPropDefinition over the whole schema.\n  if (isSingleProperty(schema)) {\n    return processPropertyDefinition(schema);\n  }\n\n  // For multi-property schema, run processPropDefinition over each property definition.\n  Object.keys(schema).forEach(function (propName) {\n    schema[propName] = processPropertyDefinition(schema[propName]);\n  });\n  return schema;\n};\n\n/**\n * Inject default value, parser, stringifier for single property.\n */\nfunction processPropertyDefinition (propDefinition) {\n  var defaultVal = propDefinition.default;\n  var propType;\n  var typeName = propDefinition.type;\n\n  // Type inference.\n  if (!propDefinition.type) {\n    if (defaultVal !== undefined && ['boolean', 'number'].indexOf(typeof defaultVal) !== -1) {\n      // Type inference.\n      typeName = typeof defaultVal;\n    } else if (Array.isArray(defaultVal)) {\n      typeName = 'array';\n    } else {\n      // Fall back to string.\n      typeName = 'string';\n    }\n  } else if (propDefinition.type === 'bool') {\n    typeName = 'boolean';\n  } else if (propDefinition.type === 'float') {\n    typeName = 'number';\n  }\n\n  propType = propertyTypes[typeName];\n  if (!propType) {\n    warn('Unknown property type: ' + typeName);\n  }\n\n  // Fill in parse and stringify using property types.\n  propDefinition.parse = propDefinition.parse || propType.parse;\n  propDefinition.stringify = propDefinition.stringify || propType.stringify;\n\n  // Fill in type name.\n  propDefinition.type = typeName;\n\n  // Fill in default value.\n  if (!('default' in propDefinition)) {\n    propDefinition.default = propType.default;\n  }\n\n  return propDefinition;\n}\nmodule.exports.processPropertyDefinition = processPropertyDefinition;\n\n/**\n * Parse propData using schema. Use default values if not existing in propData.\n *\n * @param {object} propData - Unparsed properties.\n * @param {object} schema - Property types definition.\n * @param {boolean} getPartialData - Whether to return full component data or just the data\n *        with keys in `propData`.\n * @param {string } componentName - Name of the component, used for the property warning.\n * @param {boolean} silent - Suppress warning messages.\n */\nmodule.exports.parseProperties = function (propData, schema, getPartialData, componentName,\n                                           silent) {\n  var propNames = Object.keys(getPartialData ? propData : schema);\n\n  if (propData === null || typeof propData !== 'object') { return propData; }\n\n  // Validation errors.\n  Object.keys(propData).forEach(function (propName) {\n    if (!schema[propName] && !silent) {\n      warn('Unknown property `' + propName +\n           '` for component/system `' + componentName + '`.');\n    }\n  });\n\n  propNames.forEach(function parse (propName) {\n    var propDefinition = schema[propName];\n    var propValue = propData[propName];\n    if (!(schema[propName])) { return; }\n    propData[propName] = parseProperty(propValue, propDefinition);\n  });\n\n  return propData;\n};\n\n/**\n * Deserialize a single property.\n */\nfunction parseProperty (value, propDefinition) {\n  value = (value === undefined || value === null) ? propDefinition.default : value;\n  return propDefinition.parse(value);\n}\nmodule.exports.parseProperty = parseProperty;\n\n/**\n * Serialize a group of properties.\n */\nmodule.exports.stringifyProperties = function (propData, schema) {\n  var stringifiedData = {};\n  Object.keys(propData).forEach(function (propName) {\n    var propDefinition = schema[propName];\n    var propValue = propData[propName];\n    var value = propValue;\n    if (typeof value === 'object') {\n      value = stringifyProperty(propValue, propDefinition);\n      if (!propDefinition) { warn('Unknown component property: ' + propName); }\n    }\n    stringifiedData[propName] = value;\n  });\n  return stringifiedData;\n};\n\n/**\n * Serialize a single property.\n */\nfunction stringifyProperty (value, propDefinition) {\n  if (typeof value !== 'object') { return value; }\n  // if there's no schema for the property we use standar JSON stringify\n  if (!propDefinition) { return JSON.stringify(value); }\n  return propDefinition.stringify(value);\n}\nmodule.exports.stringifyProperty = stringifyProperty;\n","/* global CustomEvent, location */\n/* Centralized place to reference utilities since utils is exposed to the user. */\n\nvar deepAssign = require('deep-assign');\nvar objectAssign = require('object-assign');\n\nmodule.exports.bind = require('./bind');\nmodule.exports.coordinates = require('./coordinates');\nmodule.exports.checkHeadsetConnected = require('./checkHeadsetConnected');\nmodule.exports.debug = require('./debug');\nmodule.exports.entity = require('./entity');\nmodule.exports.forceCanvasResizeSafariMobile = require('./forceCanvasResizeSafariMobile');\nmodule.exports.material = require('./material');\nmodule.exports.styleParser = require('./styleParser');\n\n/**\n * Fires a custom DOM event.\n *\n * @param {Element} el Element on which to fire the event.\n * @param {String} name Name of the event.\n * @param {Object=} [data={bubbles: true, {detail: <el>}}]\n *   Data to pass as `customEventInit` to the event.\n */\nmodule.exports.fireEvent = function (el, name, data) {\n  data = data || {};\n  data.detail = data.detail || {};\n  data.detail.target = data.detail.target || el;\n  var evt = new CustomEvent(name, data);\n  el.dispatchEvent(evt);\n};\n\n/**\n * Mix the properties of source object(s) into a destination object.\n *\n * @param  {object} dest - The object to which properties will be copied.\n * @param  {...object} source - The object(s) from which properties will be copied.\n */\nmodule.exports.extend = objectAssign;\nmodule.exports.extendDeep = deepAssign;\n\n/**\n * Checks if two objects have the same attributes and values, including nested objects.\n *\n * @param {object} a - First object.\n * @param {object} b - Second object.\n * @returns {boolean} Whether two objects are deeply equal.\n */\nfunction deepEqual (a, b) {\n  var keysA = Object.keys(a);\n  var keysB = Object.keys(b);\n  var i;\n  if (keysA.length !== keysB.length) { return false; }\n  // If there are no keys, compare the objects.\n  if (keysA.length === 0) { return a === b; }\n  for (i = 0; i < keysA.length; ++i) {\n    if (a[keysA[i]] !== b[keysA[i]]) { return false; }\n  }\n  return true;\n}\nmodule.exports.deepEqual = deepEqual;\n\n/**\n * Computes the difference between two objects.\n *\n * @param {object} a - First object to compare (e.g., oldData).\n * @param {object} b - Second object to compare (e.g., newData).\n * @returns {object}\n *   Difference object where set of keys note which values were not equal, and values are\n *   `b`'s values.\n */\nmodule.exports.diff = function (a, b) {\n  var diff = {};\n  var keys = Object.keys(a);\n  Object.keys(b).forEach(function collectKeys (bKey) {\n    if (keys.indexOf(bKey) === -1) {\n      keys.push(bKey);\n    }\n  });\n  keys.forEach(function doDiff (key) {\n    var aVal = a[key];\n    var bVal = b[key];\n    var isComparingObjects = aVal && bVal &&\n                             aVal.constructor === Object && bVal.constructor === Object;\n    if ((isComparingObjects && !deepEqual(aVal, bVal)) ||\n        (!isComparingObjects && aVal !== bVal)) {\n      diff[key] = bVal;\n    }\n  });\n  return diff;\n};\n\n/**\n * Checks if browser is mobile.\n * @return {Boolean} True if mobile browser detected.\n */\nmodule.exports.isMobile = function () {\n  var check = false;\n  (function (a) {\n    if (/(android|bb\\d+|meego).+mobile|avantgo|bada\\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(a) || /1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\\-(n|u)|c55\\/|capi|ccwa|cdm\\-|cell|chtm|cldc|cmd\\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\\-s|devi|dica|dmob|do(c|p)o|ds(12|\\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\\-|_)|g1 u|g560|gene|gf\\-5|g\\-mo|go(\\.w|od)|gr(ad|un)|haie|hcit|hd\\-(m|p|t)|hei\\-|hi(pt|ta)|hp( i|ip)|hs\\-c|ht(c(\\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\\-(20|go|ma)|i230|iac( |\\-|\\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\\/)|klon|kpt |kwc\\-|kyo(c|k)|le(no|xi)|lg( g|\\/(k|l|u)|50|54|\\-[a-w])|libw|lynx|m1\\-w|m3ga|m50\\/|ma(te|ui|xo)|mc(01|21|ca)|m\\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\\-2|po(ck|rt|se)|prox|psio|pt\\-g|qa\\-a|qc(07|12|21|32|60|\\-[2-7]|i\\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\\-|oo|p\\-)|sdk\\/|se(c(\\-|0|1)|47|mc|nd|ri)|sgh\\-|shar|sie(\\-|m)|sk\\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\\-|v\\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\\-|tdg\\-|tel(i|m)|tim\\-|t\\-mo|to(pl|sh)|ts(70|m\\-|m3|m5)|tx\\-9|up(\\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\\-|your|zeto|zte\\-/i.test(a.substr(0, 4))) {\n      check = true;\n    }\n    if (isIOS()) {\n      check = true;\n    }\n    if (isGearVR()) {\n      check = false;\n    }\n  })(navigator.userAgent || navigator.vendor || window.opera);\n  return check;\n};\n\nvar isIOS = module.exports.isIOS = function () {\n  return /iPad|iPhone|iPod/.test(navigator.platform);\n};\n\nvar isGearVR = module.exports.isGearVR = function () {\n  return /SamsungBrowser.+Mobile VR/i.test(navigator.userAgent);\n};\n\n/**\n * Checks mobile device orientation.\n * @return {Boolean} True if landscape orientation.\n */\nmodule.exports.isLandscape = function () {\n  return window.orientation === 90 || window.orientation === -90;\n};\n\n/**\n * Returns whether we should capture this keyboard event for keyboard shortcuts.\n * @param {Event} event Event object.\n * @returns {Boolean} Whether the key event should be captured.\n */\nmodule.exports.shouldCaptureKeyEvent = function (event) {\n  if (event.shiftKey || event.metaKey || event.altKey || event.ctrlKey) {\n    return false;\n  }\n  return document.activeElement === document.body;\n};\n\n/**\n * Splits a string into an array based on a delimiter.\n *\n * @param   {string=} [str='']        Source string\n * @param   {string=} [delimiter=' '] Delimiter to use\n * @returns {array}                   Array of delimited strings\n */\nmodule.exports.splitString = function (str, delimiter) {\n  if (typeof delimiter === 'undefined') { delimiter = ' '; }\n  // First collapse the whitespace (or whatever the delimiter is).\n  var regex = new RegExp(delimiter, 'g');\n  str = (str || '').replace(regex, delimiter);\n  // Then split.\n  return str.split(delimiter);\n};\n\n/**\n * Extracts data from the element given an object that contains expected keys.\n *\n * @param {Element} Source element.\n * @param {Object} [defaults={}] Object of default key-value pairs.\n * @returns {Object}\n */\nmodule.exports.getElData = function (el, defaults) {\n  defaults = defaults || {};\n  var data = {};\n  Object.keys(defaults).forEach(copyAttribute);\n  function copyAttribute (key) {\n    if (el.hasAttribute(key)) {\n      data[key] = el.getAttribute(key);\n    }\n  }\n  return data;\n};\n\n/**\n * Retrieves querystring value.\n * @param  {String} name Name of querystring key.\n * @return {String}      Value\n */\nmodule.exports.getUrlParameter = function (name) {\n  name = name.replace(/[\\[]/, '\\\\[').replace(/[\\]]/, '\\\\]');\n  var regex = new RegExp('[\\\\?&]' + name + '=([^&#]*)');\n  var results = regex.exec(location.search);\n  return results === null ? '' : decodeURIComponent(results[1].replace(/\\+/g, ' '));\n};\n\n/**\n * Detects whether context is within iframe.\n */\nmodule.exports.isIframed = function () {\n  return window.top !== window.self;\n};\n\n/**\n * Finds all elements under the element that have the isScene\n * property set to true\n */\nmodule.exports.findAllScenes = function (el) {\n  var matchingElements = [];\n  var allElements = el.getElementsByTagName('*');\n  for (var i = 0, n = allElements.length; i < n; i++) {\n    if (allElements[i].isScene) {\n      // Element exists with isScene set.\n      matchingElements.push(allElements[i]);\n    }\n  }\n  return matchingElements;\n};\n\n// Must be at bottom to avoid circular dependency.\nmodule.exports.srcLoader = require('./src-loader');\n","/* global Promise, screen */\nvar initMetaTags = require('./metaTags').inject;\nvar initWakelock = require('./wakelock');\nvar re = require('../a-register-element');\nvar systems = require('../system').systems;\nvar THREE = require('../../lib/three');\nvar TWEEN = require('tween.js');\nvar utils = require('../../utils/');\n// Require after.\nvar AEntity = require('../a-entity');\nvar ANode = require('../a-node');\nvar initPostMessageAPI = require('./postMessage');\n\nvar bind = utils.bind;\nvar checkHeadsetConnected = utils.checkHeadsetConnected;\nvar registerElement = re.registerElement;\nvar isIOS = utils.isIOS();\nvar isMobile = utils.isMobile();\nvar warn = utils.debug('core:a-scene:warn');\n\n/**\n * Scene element, holds all entities.\n *\n * @member {number} animationFrameID\n * @member {array} behaviors - Component instances that have registered themselves to be\n           updated on every tick.\n * @member {object} camera - three.js Camera object.\n * @member {object} canvas\n * @member {bool} isScene - Differentiates as scene entity as opposed to other entites.\n * @member {bool} isMobile - Whether browser is mobile (via UA detection).\n * @member {object} object3D - Root three.js Scene object.\n * @member {object} renderer\n * @member {bool} renderStarted\n * @member (object) effect - three.js VREffect\n * @member {object} systems - Registered instantiated systems.\n * @member {number} time\n */\nmodule.exports = registerElement('a-scene', {\n  prototype: Object.create(AEntity.prototype, {\n    defaultComponents: {\n      value: {\n        'canvas': '',\n        'inspector': '',\n        'keyboard-shortcuts': '',\n        'vr-mode-ui': ''\n      }\n    },\n\n    createdCallback: {\n      value: function () {\n        this.isIOS = isIOS;\n        this.isMobile = isMobile;\n        this.isScene = true;\n        this.object3D = new THREE.Scene();\n        this.render = bind(this.render, this);\n        this.systems = {};\n        this.time = 0;\n\n        this.init();\n      }\n    },\n\n    init: {\n      value: function () {\n        this.behaviors = [];\n        this.hasLoaded = false;\n        this.isPlaying = false;\n        this.originalHTML = this.innerHTML;\n        this.addEventListener('render-target-loaded', function () {\n          this.setupRenderer();\n          this.resize();\n        });\n        this.addFullScreenStyles();\n        initPostMessageAPI(this);\n      },\n      writable: true\n    },\n\n    addFullScreenStyles: {\n      value: function () {\n        var htmlEl = document.documentElement;\n        htmlEl.classList.add('a-html');\n        document.body.classList.add('a-body');\n        this.classList.add('fullscreen');\n      }\n    },\n\n    removeFullScreenStyles: {\n      value: function () {\n        var htmlEl = document.documentElement;\n        htmlEl.classList.remove('a-html');\n        document.body.classList.remove('a-body');\n        this.classList.remove('fullscreen');\n      }\n    },\n\n    attachedCallback: {\n      value: function () {\n        var resize = bind(this.resize, this);\n        initMetaTags(this);\n        initWakelock(this);\n        this.initSystems();\n\n        window.addEventListener('load', resize);\n        window.addEventListener('resize', resize);\n        this.play();\n      },\n      writable: window.debug\n    },\n\n    initSystems: {\n      value: function () {\n        Object.keys(systems).forEach(bind(this.initSystem, this));\n      }\n    },\n\n    initSystem: {\n      value: function (name) {\n        var system;\n        if (this.systems[name]) { return; }\n        system = this.systems[name] = new systems[name](this);\n        system.init();\n      }\n    },\n\n    /**\n     * Shuts down scene on detach.\n     */\n    detachedCallback: {\n      value: function () {\n        window.cancelAnimationFrame(this.animationFrameID);\n        this.animationFrameID = null;\n      }\n    },\n\n    /**\n     * @param {object} behavior - Generally a component. Must implement a .update() method to\n     *        be called on every tick.\n     */\n    addBehavior: {\n      value: function (behavior) {\n        var behaviors = this.behaviors;\n        if (behaviors.indexOf(behavior) !== -1) { return; }\n        behaviors.push(behavior);\n      }\n    },\n\n    enterVR: {\n      value: function (event) {\n        var self = this;\n        if (this.is('vr-mode')) { return; }\n        if (checkHeadsetConnected() || this.isMobile) {\n          return this.effect.requestPresent().then(enterVRSuccess, enterVRFailure);\n        }\n        enterVRSuccess();\n\n        function enterVRSuccess () {\n          self.addState('vr-mode');\n          self.emit('enter-vr', event);\n\n          // Lock to landscape orientation on mobile.\n          if (self.isMobile && screen.orientation && screen.orientation.lock) {\n            screen.orientation.lock('landscape');\n          }\n          self.addFullScreenStyles();\n\n          // On mobile, the polyfill handles fullscreen.\n          // TODO: 07/16 Chromium builds break when `requestFullscreen`ing on a canvas\n          // that we are also `requestPresent`ing. Until then, don't fullscreen if headset\n          // connected.\n          if (!self.isMobile && !checkHeadsetConnected()) { requestFullscreen(self.canvas); }\n          self.resize();\n        }\n\n        function enterVRFailure (err) {\n          if (err && err.message) {\n            throw new Error('Failed to enter VR mode (`requestPresent`): ' + err.message);\n          } else {\n            throw new Error('Failed to enter VR mode (`requestPresent`).');\n          }\n        }\n      }\n    },\n\n    exitVR: {\n      value: function () {\n        var self = this;\n        if (!this.is('vr-mode')) { return Promise.resolve(); }\n        if (checkHeadsetConnected() || this.isMobile) {\n          return this.effect.exitPresent().then(exitVRSuccess, exitVRFailure);\n        }\n        exitVRSuccess();\n        function exitVRSuccess () {\n          var embedded = self.getAttribute('embedded');\n          self.removeState('vr-mode');\n          // Lock to landscape orientation on mobile.\n          if (self.isMobile && screen.orientation && screen.orientation.unlock) {\n            screen.orientation.unlock();\n          }\n          // Exiting VR in embedded mode, no longer need fullscreen styles.\n          if (embedded) { self.removeFullScreenStyles(); }\n          self.resize();\n          if (self.isIOS) { utils.forceCanvasResizeSafariMobile(this.canvas); }\n          self.emit('exit-vr', {target: self});\n        }\n        function exitVRFailure (err) {\n          if (err && err.message) {\n            throw new Error('Failed to exit VR mode (`exitPresent`): ' + err.message);\n          } else {\n            throw new Error('Failed to exit VR mode (`exitPresent`).');\n          }\n        }\n      }\n    },\n\n    /**\n     * Wraps Entity.getAttribute to take into account for systems.\n     * If system exists, then return system data rather than possible component data.\n     */\n    getAttribute: {\n      value: function (attr) {\n        var system = this.systems[attr];\n        if (system) { return system.data; }\n        return AEntity.prototype.getAttribute.call(this, attr);\n      }\n    },\n\n    /**\n     * `getAttribute` used to be `getDOMAttribute` and `getComputedAttribute` used to be\n     * what `getAttribute` is now. Now legacy code.\n     */\n    getComputedAttribute: {\n      value: function (attr) {\n        warn('`getComputedAttribute` is deprecated. Use `getAttribute` instead.');\n        this.getAttribute(attr);\n      }\n    },\n\n    /**\n     * Wraps Entity.getDOMAttribute to take into account for systems.\n     * If system exists, then return system data rather than possible component data.\n     */\n    getDOMAttribute: {\n      value: function (attr) {\n        var system = this.systems[attr];\n        if (system) { return system.data; }\n        return AEntity.prototype.getDOMAttribute.call(this, attr);\n      }\n    },\n\n    /**\n     * Wraps Entity.setAttribute to take into account for systems.\n     * If system exists, then skip component initialization checks and do a normal\n     * setAttribute.\n     */\n    setAttribute: {\n      value: function (attr, value, componentPropValue) {\n        var system = this.systems[attr];\n        if (system) {\n          ANode.prototype.setAttribute.call(this, attr, value);\n          return;\n        }\n        AEntity.prototype.setAttribute.call(this, attr, value, componentPropValue);\n      }\n    },\n\n    /**\n     * @param {object} behavior - Generally a component. Has registered itself to behaviors.\n     */\n    removeBehavior: {\n      value: function (behavior) {\n        var behaviors = this.behaviors;\n        var index = behaviors.indexOf(behavior);\n        if (index === -1) { return; }\n        behaviors.splice(index, 1);\n      }\n    },\n\n    resize: {\n      value: function () {\n        var camera = this.camera;\n        var canvas = this.canvas;\n        var embedded = this.getAttribute('embedded') && !this.is('vr-mode');\n        var size;\n        // Possible camera or canvas not injected yet.\n        // ON MOBILE the webvr-polyfill relies on the fullscreen API to enter\n        // VR mode. The canvas is resized by VREffect following the values returned\n        // by getEyeParameters. We don't want to overwrite the size with the\n        // windows width and height.\n        if (!camera || !canvas || this.is('vr-mode') && isMobile) { return; }\n        // Update camera.\n        size = getCanvasSize(canvas, embedded);\n        camera.aspect = size.width / size.height;\n        camera.updateProjectionMatrix();\n        // Notify renderer of size change.\n        this.renderer.setSize(size.width, size.height);\n      },\n      writable: window.debug\n    },\n\n    setupRenderer: {\n      value: function () {\n        var canvas = this.canvas;\n        // Set at startup. To enable/disable antialias\n        // at runttime we would have to recreate the whole context\n        var antialias = this.getAttribute('antialias') === 'true';\n        var renderer = this.renderer = new THREE.WebGLRenderer({\n          canvas: canvas,\n          antialias: antialias || window.hasNativeWebVRImplementation,\n          alpha: true\n        });\n        renderer.setPixelRatio(window.devicePixelRatio);\n        renderer.sortObjects = false;\n        this.effect = new THREE.VREffect(renderer);\n      },\n      writable: window.debug\n    },\n\n    /**\n     * Handler attached to elements to help scene know when to kick off.\n     * Scene waits for all entities to load.\n     */\n    play: {\n      value: function () {\n        var self = this;\n        if (this.renderStarted) {\n          AEntity.prototype.play.call(this);\n          return;\n        }\n\n        this.addEventListener('loaded', function () {\n          AEntity.prototype.play.call(this);  // .play() *before* render.\n\n          // Wait for camera if necessary before rendering.\n          if (this.camera) {\n            startRender(this);\n            return;\n          }\n          this.addEventListener('camera-set-active', function () { startRender(this); });\n\n          function startRender (sceneEl) {\n            if (sceneEl.renderStarted) { return; }\n\n            sceneEl.resize();\n\n            // Kick off render loop.\n            if (sceneEl.renderer) {\n              if (window.performance) {\n                window.performance.mark('render-started');\n              }\n              sceneEl.render(0);\n              sceneEl.renderStarted = true;\n              sceneEl.emit('renderstart');\n            }\n          }\n        });\n\n        // setTimeout to wait for all nodes to attach and run their callbacks.\n        setTimeout(function () {\n          AEntity.prototype.load.call(self);\n        });\n      }\n    },\n\n    /**\n     * Reload the scene to the original DOM content.\n     *\n     * @param {bool} doPause - Whether to reload the scene with all dynamic behavior paused.\n     */\n    reload: {\n      value: function (doPause) {\n        var self = this;\n        if (doPause) { this.pause(); }\n        this.innerHTML = this.originalHTML;\n        this.init();\n        ANode.prototype.load.call(this, play);\n        function play () {\n          if (!self.isPlaying) { return; }\n          AEntity.prototype.play.call(self);\n        }\n      }\n    },\n\n    /**\n     * Behavior-updater meant to be called from scene render.\n     * Abstracted to a different function to facilitate unit testing (`scene.tick()`) without\n     * needing to render.\n     */\n    tick: {\n      value: function (time, timeDelta) {\n        var systems = this.systems;\n\n        // Animations.\n        TWEEN.update(time);\n        // Components.\n        this.behaviors.forEach(function (component) {\n          if (!component.el.isPlaying) { return; }\n          component.tick(time, timeDelta);\n        });\n        // Systems.\n        Object.keys(systems).forEach(function (key) {\n          if (!systems[key].tick) { return; }\n          systems[key].tick(time, timeDelta);\n        });\n      }\n    },\n\n    /**\n     * The render loop.\n     *\n     * Updates animations.\n     * Updates behaviors.\n     * Renders with request animation frame.\n     */\n    render: {\n      value: function (time) {\n        var effect = this.effect;\n        var timeDelta = time - this.time;\n\n        if (this.isPlaying) { this.tick(time, timeDelta); }\n\n        this.animationFrameID = effect.requestAnimationFrame(this.render);\n        effect.render(this.object3D, this.camera);\n        this.time = time;\n      },\n      writable: true\n    }\n  })\n});\n\n/**\n * Return the canvas size where the scene will be rendered\n * It will be always the window size except when the scene\n * is embedded. The parent size will be returned in that case\n *\n * @param {object} canvasEl - the canvas element\n * @param {boolean} embedded - Is the scene embedded?\n */\nfunction getCanvasSize (canvasEl, embedded) {\n  if (embedded) {\n    return {\n      height: canvasEl.parentElement.offsetHeight,\n      width: canvasEl.parentElement.offsetWidth\n    };\n  }\n  return {\n    height: window.innerHeight,\n    width: window.innerWidth\n  };\n}\n\nfunction requestFullscreen (canvas) {\n  var requestFullscreen =\n    canvas.requestFullscreen ||\n    canvas.webkitRequestFullscreen ||\n    canvas.mozRequestFullScreen ||  // The capitalized `S` is not a typo.\n    canvas.msRequestFullscreen;\n  requestFullscreen.apply(canvas);\n}\n","var AEntity = require('../../core/a-entity');\nvar components = require('../../core/component').components;\nvar registerElement = require('../../core/a-register-element').registerElement;\nvar utils = require('../../utils/');\n\nvar bind = utils.bind;\nvar debug = utils.debug;\nvar setComponentProperty = utils.entity.setComponentProperty;\nvar log = debug('extras:primitives:debug');\n\nvar primitives = module.exports.primitives = {};\n\nmodule.exports.registerPrimitive = function registerPrimitive (name, definition) {\n  name = name.toLowerCase();\n  log('Registering <%s>', name);\n\n  // Deprecation warning for defaultAttributes usage.\n  if (definition.defaultAttributes) {\n    console.warn(\"The 'defaultAttributes' object is deprecated. Use 'defaultComponents' instead.\");\n  }\n\n  var primitive = registerElement(name, {\n    prototype: Object.create(AEntity.prototype, {\n      defaultComponentsFromPrimitive: {\n        value: definition.defaultComponents || definition.defaultAttributes || {}\n      },\n\n      deprecated: {\n        value: definition.deprecated || null\n      },\n\n      deprecatedMappings: {\n        value: definition.deprecatedMappings || {}\n      },\n\n      mappings: {\n        value: definition.mappings || {}\n      },\n\n      transforms: {\n        value: definition.transforms || {}\n      },\n\n      createdCallback: {\n        value: function () {\n          this.componentData = {};\n          if (definition.deprecated) {\n            console.warn(definition.deprecated);\n          }\n        }\n      },\n\n      attachedCallback: {\n        value: function () {\n          var self = this;\n          var attributes = this.attributes;\n          this.applyDefaultComponents();\n          // Apply initial attributes.\n          Object.keys(attributes).forEach(function applyInitial (attributeName) {\n            var attr = attributes[attributeName];\n            self.syncAttributeToComponent(attr.name, attr.value);\n          });\n        }\n      },\n\n      /**\n       * Sync to attribute to component property whenever mapped attribute changes.\n       */\n      attributeChangedCallback: {\n        value: function (attr, oldVal, newVal) {\n          this.syncAttributeToComponent(attr, newVal);\n        }\n      },\n\n      applyDefaultComponents: {\n        value: function () {\n          var self = this;\n          var defaultData = this.defaultComponentsFromPrimitive;\n\n          // Apply default components.\n          Object.keys(defaultData).forEach(function applyDefault (componentName) {\n            var componentData = defaultData[componentName];\n\n            // Set component properties individually to not overwrite user-defined components.\n            if (componentData instanceof Object) {\n              var component = components[componentName];\n              var attrValues = self.getDOMAttribute(componentName) || {};\n              var data = component.parse(attrValues);\n\n              // Check if component property already defined.\n              Object.keys(componentData).forEach(function setProperty (propName) {\n                if (data[propName]) { return; }\n                data[propName] = componentData[propName];\n              });\n              self.setAttribute(componentName, data);\n              return;\n            }\n\n            // Component is single-property schema, just set the attribute.\n            self.setAttribute(componentName, componentData);\n          });\n        }\n      },\n\n      /**\n       * If attribute is mapped to a component property, set the component property using\n       * the attribute value.\n       */\n      syncAttributeToComponent: {\n        value: function (attr, value) {\n          var componentName = this.mappings[attr];\n\n          if (attr in this.deprecatedMappings) {\n            console.warn(this.deprecatedMappings[attr]);\n          }\n          if (!attr || !componentName) { return; }\n\n          // Run transform.\n          value = this.getTransformedValue(attr, value);\n\n          // Set value.\n          setComponentProperty(this, componentName, value);\n        }\n      },\n\n      /**\n       * Calls defined transform function on value if any.\n       */\n      getTransformedValue: {\n        value: function (attr, value) {\n          if (!this.transforms || !this.transforms[attr]) { return value; }\n          return bind(this.transforms[attr], this)(value);\n        }\n      }\n    })\n  });\n\n  // Store.\n  primitives[name] = primitive;\n  return primitive;\n};\n","/**\n * Common mesh defaults, mappings, and transforms.\n */\nmodule.exports = function getMeshMixin () {\n  return {\n    defaultComponents: {\n      material: {}\n    },\n\n    mappings: {\n      color: 'material.color',\n      metalness: 'material.metalness',\n      opacity: 'material.opacity',\n      repeat: 'material.repeat',\n      roughness: 'material.roughness',\n      shader: 'material.shader',\n      side: 'material.side',\n      src: 'material.src',\n      transparent: 'material.transparent'\n    },\n\n    transforms: {\n      src: function (value) {\n        // Selector.\n        if (value[0] === '#') { return value; }\n        // Inline url().\n        return 'url(' + value + ')';\n      }\n    }\n  };\n};\n","require('./pivot');\n","require('./primitives/a-camera');\nrequire('./primitives/a-collada-model');\nrequire('./primitives/a-cursor');\nrequire('./primitives/a-curvedimage');\nrequire('./primitives/a-image');\nrequire('./primitives/a-light');\nrequire('./primitives/a-obj-model');\nrequire('./primitives/a-sky');\nrequire('./primitives/a-sound');\nrequire('./primitives/a-video');\nrequire('./primitives/a-videosphere');\nrequire('./primitives/meshPrimitives');\n","(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})","/**\n * @author dmarcos / https://github.com/dmarcos\n * @author mrdoob / http://mrdoob.com\n */\n\nTHREE.VRControls = function ( object, onError ) {\n\n\tvar scope = this;\n\n\tvar vrInput;\n\n\tvar standingMatrix = new THREE.Matrix4();\n\n\tfunction gotVRDevices( devices ) {\n\n\t\tfor ( var i = 0; i < devices.length; i ++ ) {\n\n\t\t\tif ( ( 'VRDisplay' in window && devices[ i ] instanceof VRDisplay ) ||\n\t\t\t\t ( 'PositionSensorVRDevice' in window && devices[ i ] instanceof PositionSensorVRDevice ) ) {\n\n\t\t\t\tvrInput = devices[ i ];\n\t\t\t\tbreak;  // We keep the first we encounter\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( !vrInput ) {\n\n\t\t\tif ( onError ) onError( 'VR input not available.' );\n\n\t\t}\n\n\t}\n\n\tif ( navigator.getVRDisplays ) {\n\n\t\tnavigator.getVRDisplays().then( gotVRDevices );\n\n\t} else if ( navigator.getVRDevices ) {\n\n\t\t// Deprecated API.\n\t\tnavigator.getVRDevices().then( gotVRDevices );\n\n\t}\n\n\t// the Rift SDK returns the position in meters\n\t// this scale factor allows the user to define how meters\n\t// are converted to scene units.\n\n\tthis.scale = 1;\n\n\t// If true will use \"standing space\" coordinate system where y=0 is the\n\t// floor and x=0, z=0 is the center of the room.\n\tthis.standing = false;\n\n\t// Distance from the users eyes to the floor in meters. Used when\n\t// standing=true but the VRDisplay doesn't provide stageParameters.\n\tthis.userHeight = 1.6;\n\n\tthis.update = function () {\n\n\t\tif ( vrInput ) {\n\n\t\t\tif ( vrInput.getPose ) {\n\n\t\t\t\tvar pose = vrInput.getPose();\n\n\t\t\t\tif ( pose.orientation !== null ) {\n\n\t\t\t\t\tobject.quaternion.fromArray( pose.orientation );\n\n\t\t\t\t}\n\n\t\t\t\tif ( pose.position !== null ) {\n\n\t\t\t\t\tobject.position.fromArray( pose.position );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tobject.position.set( 0, 0, 0 );\n\n\t\t\t\t}\n\n\t\t\t} else {\n\n\t\t\t\t// Deprecated API.\n\t\t\t\tvar state = vrInput.getState();\n\n\t\t\t\tif ( state.orientation !== null ) {\n\n\t\t\t\t\tobject.quaternion.copy( state.orientation );\n\n\t\t\t\t}\n\n\t\t\t\tif ( state.position !== null ) {\n\n\t\t\t\t\tobject.position.copy( state.position );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tobject.position.set( 0, 0, 0 );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tif ( this.standing ) {\n\n\t\t\t\tif ( vrInput.stageParameters ) {\n\n\t\t\t\t\tobject.updateMatrix();\n\n\t\t\t\t\tstandingMatrix.fromArray(vrInput.stageParameters.sittingToStandingTransform);\n\t\t\t\t\tobject.applyMatrix( standingMatrix );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tobject.position.setY( object.position.y + this.userHeight );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tobject.position.multiplyScalar( scope.scale );\n\n\t\t}\n\n\t};\n\n\tthis.resetPose = function () {\n\n\t\tif ( vrInput ) {\n\n\t\t\tif ( vrInput.resetPose !== undefined ) {\n\n\t\t\t\tvrInput.resetPose();\n\n\t\t\t} else if ( vrInput.resetSensor !== undefined ) {\n\n\t\t\t\t// Deprecated API.\n\t\t\t\tvrInput.resetSensor();\n\n\t\t\t} else if ( vrInput.zeroSensor !== undefined ) {\n\n\t\t\t\t// Really deprecated API.\n\t\t\t\tvrInput.zeroSensor();\n\n\t\t\t}\n\n\t\t}\n\n\t};\n\n\tthis.resetSensor = function () {\n\n\t\tconsole.warn( 'THREE.VRControls: .resetSensor() is now .resetPose().' );\n\t\tthis.resetPose();\n\n\t};\n\n\tthis.zeroSensor = function () {\n\n\t\tconsole.warn( 'THREE.VRControls: .zeroSensor() is now .resetPose().' );\n\t\tthis.resetPose();\n\n\t};\n\n\tthis.dispose = function () {\n\n\t\tvrInput = null;\n\n\t};\n\n};\n","/**\n * @author dmarcos / https://github.com/dmarcos\n * @author mrdoob / http://mrdoob.com\n *\n * WebVR Spec: http://mozvr.github.io/webvr-spec/webvr.html\n *\n * Firefox: http://mozvr.com/downloads/\n * Chromium: https://webvr.info/get-chrome\n *\n */\n\nTHREE.VREffect = function ( renderer, onError ) {\n\n\tvar vrDisplay, vrDisplays;\n\tvar eyeTranslationL = new THREE.Vector3();\n\tvar eyeTranslationR = new THREE.Vector3();\n\tvar renderRectL, renderRectR;\n\n\tvar frameData = null;\n\tif ( 'VRFrameData' in window ) {\n\n\t\tframeData = new VRFrameData();\n\n\t}\n\n\tfunction gotVRDisplays( displays ) {\n\n\t\tvrDisplays = displays;\n\n\t\tif ( displays.length > 0 ) {\n\n\t\t\tvrDisplay = displays[ 0 ];\n\n\t\t} else {\n\n\t\t\tif ( onError ) onError( 'HMD not available' );\n\n\t\t}\n\n\t}\n\n\tif ( navigator.getVRDisplays ) {\n\n\t\tnavigator.getVRDisplays().then( gotVRDisplays );\n\n\t}\n\n\t//\n\n\tthis.isPresenting = false;\n\tthis.scale = 1;\n\n\tvar scope = this;\n\n\tvar rendererSize = renderer.getSize();\n\tvar rendererUpdateStyle = false;\n\tvar rendererPixelRatio = renderer.getPixelRatio();\n\n\tthis.getVRDisplay = function () {\n\n\t\treturn vrDisplay;\n\n\t};\n\n\tthis.getVRDisplays = function () {\n\n\t\treturn vrDisplays;\n\n\t};\n\n\tthis.setSize = function ( width, height, updateStyle ) {\n\n\t\trendererSize = { width: width, height: height };\n\t\trendererUpdateStyle = updateStyle;\n\n\t\tif ( scope.isPresenting ) {\n\n\t\t\tvar eyeParamsL = vrDisplay.getEyeParameters( 'left' );\n\t\t\trenderer.setPixelRatio( 1 );\n\t\t\trenderer.setSize( eyeParamsL.renderWidth * 2, eyeParamsL.renderHeight, false );\n\n\t\t} else {\n\n\t\t\trenderer.setPixelRatio( rendererPixelRatio );\n\t\t\trenderer.setSize( width, height, updateStyle );\n\n\t\t}\n\n\t};\n\n\t// fullscreen\n\n\tvar canvas = renderer.domElement;\n\tvar requestFullscreen;\n\tvar exitFullscreen;\n\tvar fullscreenElement;\n\tvar leftBounds = [ 0.0, 0.0, 0.5, 1.0 ];\n\tvar rightBounds = [ 0.5, 0.0, 0.5, 1.0 ];\n\n\tfunction onFullscreenChange() {\n\n\t\tvar wasPresenting = scope.isPresenting;\n\t\tscope.isPresenting = vrDisplay !== undefined && vrDisplay.isPresenting;\n\n\t\tif ( scope.isPresenting ) {\n\n\t\t\tvar eyeParamsL = vrDisplay.getEyeParameters( 'left' );\n\t\t\tvar eyeWidth = eyeParamsL.renderWidth;\n\t\t\tvar eyeHeight = eyeParamsL.renderHeight;\n\n\t\t\tvar layers = vrDisplay.getLayers();\n\t\t\tif ( layers.length ) {\n\n\t\t\t\tvar layer = layers[0];\n\n\t\t\t\tleftBounds = layer.leftBounds !== null && layer.leftBounds.length === 4 ? layer.leftBounds : [ 0.0, 0.0, 0.5, 1.0 ];\n\t\t\t\trightBounds = layer.rightBounds !== null && layer.rightBounds.length === 4 ? layer.rightBounds : [ 0.5, 0.0, 0.5, 1.0 ];\n\n\t\t\t}\n\n\t\t\tif ( !wasPresenting ) {\n\n\t\t\t\trendererPixelRatio = renderer.getPixelRatio();\n\t\t\t\trendererSize = renderer.getSize();\n\n\t\t\t\trenderer.setPixelRatio( 1 );\n\t\t\t\trenderer.setSize( eyeWidth * 2, eyeHeight, false );\n\n\t\t\t}\n\n\t\t} else if ( wasPresenting ) {\n\n\t\t\trenderer.setPixelRatio( rendererPixelRatio );\n\t\t\trenderer.setSize( rendererSize.width, rendererSize.height, rendererUpdateStyle );\n\n\t\t}\n\n\t}\n\n\twindow.addEventListener( 'vrdisplaypresentchange', onFullscreenChange, false );\n\n\tthis.setFullScreen = function ( boolean ) {\n\n\t\treturn new Promise( function ( resolve, reject ) {\n\n\t\t\tif ( vrDisplay === undefined ) {\n\n\t\t\t\treject( new Error( 'No VR hardware found.' ) );\n\t\t\t\treturn;\n\n\t\t\t}\n\n\t\t\tif ( scope.isPresenting === boolean ) {\n\n\t\t\t\tresolve();\n\t\t\t\treturn;\n\n\t\t\t}\n\n\t\t\tif ( boolean ) {\n\n\t\t\t\tresolve( vrDisplay.requestPresent( [ { source: canvas } ] ) );\n\n\t\t\t} else {\n\n\t\t\t\tresolve( vrDisplay.exitPresent() );\n\n\t\t\t}\n\n\t\t} );\n\n\t};\n\n\tthis.requestPresent = function () {\n\n\t\treturn this.setFullScreen( true );\n\n\t};\n\n\tthis.exitPresent = function () {\n\n\t\treturn this.setFullScreen( false );\n\n\t};\n\n\tthis.requestAnimationFrame = function ( f ) {\n\n\t\tif ( vrDisplay !== undefined ) {\n\n\t\t\treturn vrDisplay.requestAnimationFrame( f );\n\n\t\t} else {\n\n\t\t\treturn window.requestAnimationFrame( f );\n\n\t\t}\n\n\t};\n\n\tthis.cancelAnimationFrame = function ( h ) {\n\n\t\tif ( vrDisplay !== undefined ) {\n\n\t\t\tvrDisplay.cancelAnimationFrame( h );\n\n\t\t} else {\n\n\t\t\twindow.cancelAnimationFrame( h );\n\n\t\t}\n\n\t};\n\n\tthis.submitFrame = function () {\n\n\t\tif ( vrDisplay !== undefined && scope.isPresenting ) {\n\n\t\t\tvrDisplay.submitFrame();\n\n\t\t}\n\n\t};\n\n\tthis.autoSubmitFrame = true;\n\n\t// render\n\n\tvar cameraL = new THREE.PerspectiveCamera();\n\tcameraL.layers.enable( 1 );\n\n\tvar cameraR = new THREE.PerspectiveCamera();\n\tcameraR.layers.enable( 2 );\n\n\tthis.render = function ( scene, camera, renderTarget, forceClear ) {\n\n\t\tif ( vrDisplay && scope.isPresenting ) {\n\n\t\t\tvar autoUpdate = scene.autoUpdate;\n\n\t\t\tif ( autoUpdate ) {\n\n\t\t\t\tscene.updateMatrixWorld();\n\t\t\t\tscene.autoUpdate = false;\n\n\t\t\t}\n\n\t\t\tvar eyeParamsL = vrDisplay.getEyeParameters( 'left' );\n\t\t\tvar eyeParamsR = vrDisplay.getEyeParameters( 'right' );\n\n\t\t\teyeTranslationL.fromArray( eyeParamsL.offset );\n\t\t\teyeTranslationR.fromArray( eyeParamsR.offset );\n\n\t\t\tif ( Array.isArray( scene ) ) {\n\n\t\t\t\tconsole.warn( 'THREE.VREffect.render() no longer supports arrays. Use object.layers instead.' );\n\t\t\t\tscene = scene[ 0 ];\n\n\t\t\t}\n\n\t\t\t// When rendering we don't care what the recommended size is, only what the actual size\n\t\t\t// of the backbuffer is.\n\t\t\tvar size = renderer.getSize();\n\t\t\trenderRectL = {\n\t\t\t\tx: Math.round( size.width * leftBounds[ 0 ] ),\n\t\t\t\ty: Math.round( size.height * leftBounds[ 1 ] ),\n\t\t\t\twidth: Math.round( size.width * leftBounds[ 2 ] ),\n\t\t\t\theight:  Math.round(size.height * leftBounds[ 3 ] )\n\t\t\t};\n\t\t\trenderRectR = {\n\t\t\t\tx: Math.round( size.width * rightBounds[ 0 ] ),\n\t\t\t\ty: Math.round( size.height * rightBounds[ 1 ] ),\n\t\t\t\twidth: Math.round( size.width * rightBounds[ 2 ] ),\n\t\t\t\theight:  Math.round(size.height * rightBounds[ 3 ] )\n\t\t\t};\n\n\t\t\tif ( renderTarget ) {\n\n\t\t\t\trenderer.setRenderTarget( renderTarget );\n\t\t\t\trenderTarget.scissorTest = true;\n\n\t\t\t} else  {\n\n\t\t\t\trenderer.setRenderTarget( null );\n\t\t\t\trenderer.setScissorTest( true );\n\n\t\t\t}\n\n\t\t\tif ( renderer.autoClear || forceClear ) renderer.clear();\n\n\t\t\tif ( camera.parent === null ) camera.updateMatrixWorld();\n\n\t\t\tcamera.matrixWorld.decompose( cameraL.position, cameraL.quaternion, cameraL.scale );\n\t\t\tcamera.matrixWorld.decompose( cameraR.position, cameraR.quaternion, cameraR.scale );\n\n\t\t\tvar scale = this.scale;\n\t\t\tcameraL.translateOnAxis( eyeTranslationL, scale );\n\t\t\tcameraR.translateOnAxis( eyeTranslationR, scale );\n\n\t\t\tif ( vrDisplay.getFrameData ) {\n\n\t\t\t\tvrDisplay.depthNear = camera.near;\n\t\t\t\tvrDisplay.depthFar = camera.far;\n\n\t\t\t\tvrDisplay.getFrameData( frameData );\n\n\t\t\t\tcameraL.projectionMatrix.elements = frameData.leftProjectionMatrix;\n\t\t\t\tcameraR.projectionMatrix.elements = frameData.rightProjectionMatrix;\n\n\t\t\t} else {\n\n\t\t\t\tcameraL.projectionMatrix = fovToProjection( eyeParamsL.fieldOfView, true, camera.near, camera.far );\n\t\t\t\tcameraR.projectionMatrix = fovToProjection( eyeParamsR.fieldOfView, true, camera.near, camera.far );\n\n\n\t\t\t}\n\n\t\t\t// render left eye\n\t\t\tif ( renderTarget ) {\n\n\t\t\t\trenderTarget.viewport.set( renderRectL.x, renderRectL.y, renderRectL.width, renderRectL.height );\n\t\t\t\trenderTarget.scissor.set( renderRectL.x, renderRectL.y, renderRectL.width, renderRectL.height );\n\n\t\t\t} else {\n\n\t\t\t\trenderer.setViewport( renderRectL.x, renderRectL.y, renderRectL.width, renderRectL.height );\n\t\t\t\trenderer.setScissor( renderRectL.x, renderRectL.y, renderRectL.width, renderRectL.height );\n\n\t\t\t}\n\t\t\trenderer.render( scene, cameraL, renderTarget, forceClear );\n\n\t\t\t// render right eye\n\t\t\tif ( renderTarget ) {\n\n\t\t\t\trenderTarget.viewport.set( renderRectR.x, renderRectR.y, renderRectR.width, renderRectR.height );\n\t\t\t\trenderTarget.scissor.set( renderRectR.x, renderRectR.y, renderRectR.width, renderRectR.height );\n\n\t\t\t} else {\n\n\t\t\t\trenderer.setViewport( renderRectR.x, renderRectR.y, renderRectR.width, renderRectR.height );\n\t\t\t\trenderer.setScissor( renderRectR.x, renderRectR.y, renderRectR.width, renderRectR.height );\n\n\t\t\t}\n\t\t\trenderer.render( scene, cameraR, renderTarget, forceClear );\n\n\t\t\tif ( renderTarget ) {\n\n\t\t\t\trenderTarget.viewport.set( 0, 0, size.width, size.height );\n\t\t\t\trenderTarget.scissor.set( 0, 0, size.width, size.height );\n\t\t\t\trenderTarget.scissorTest = false;\n\t\t\t\trenderer.setRenderTarget( null );\n\n\t\t\t} else {\n\n\t\t\t\trenderer.setScissorTest( false );\n\n\t\t\t}\n\n\t\t\tif ( autoUpdate ) {\n\n\t\t\t\tscene.autoUpdate = true;\n\n\t\t\t}\n\n\t\t\tif ( scope.autoSubmitFrame ) {\n\n\t\t\t\tscope.submitFrame();\n\n\t\t\t}\n\n\t\t\treturn;\n\n\t\t}\n\n\t\t// Regular render mode if not HMD\n\n\t\trenderer.render( scene, camera, renderTarget, forceClear );\n\n\t};\n\n\t//\n\n\tfunction fovToNDCScaleOffset( fov ) {\n\n\t\tvar pxscale = 2.0 / ( fov.leftTan + fov.rightTan );\n\t\tvar pxoffset = ( fov.leftTan - fov.rightTan ) * pxscale * 0.5;\n\t\tvar pyscale = 2.0 / ( fov.upTan + fov.downTan );\n\t\tvar pyoffset = ( fov.upTan - fov.downTan ) * pyscale * 0.5;\n\t\treturn { scale: [ pxscale, pyscale ], offset: [ pxoffset, pyoffset ] };\n\n\t}\n\n\tfunction fovPortToProjection( fov, rightHanded, zNear, zFar ) {\n\n\t\trightHanded = rightHanded === undefined ? true : rightHanded;\n\t\tzNear = zNear === undefined ? 0.01 : zNear;\n\t\tzFar = zFar === undefined ? 10000.0 : zFar;\n\n\t\tvar handednessScale = rightHanded ? - 1.0 : 1.0;\n\n\t\t// start with an identity matrix\n\t\tvar mobj = new THREE.Matrix4();\n\t\tvar m = mobj.elements;\n\n\t\t// and with scale/offset info for normalized device coords\n\t\tvar scaleAndOffset = fovToNDCScaleOffset( fov );\n\n\t\t// X result, map clip edges to [-w,+w]\n\t\tm[ 0 * 4 + 0 ] = scaleAndOffset.scale[ 0 ];\n\t\tm[ 0 * 4 + 1 ] = 0.0;\n\t\tm[ 0 * 4 + 2 ] = scaleAndOffset.offset[ 0 ] * handednessScale;\n\t\tm[ 0 * 4 + 3 ] = 0.0;\n\n\t\t// Y result, map clip edges to [-w,+w]\n\t\t// Y offset is negated because this proj matrix transforms from world coords with Y=up,\n\t\t// but the NDC scaling has Y=down (thanks D3D?)\n\t\tm[ 1 * 4 + 0 ] = 0.0;\n\t\tm[ 1 * 4 + 1 ] = scaleAndOffset.scale[ 1 ];\n\t\tm[ 1 * 4 + 2 ] = - scaleAndOffset.offset[ 1 ] * handednessScale;\n\t\tm[ 1 * 4 + 3 ] = 0.0;\n\n\t\t// Z result (up to the app)\n\t\tm[ 2 * 4 + 0 ] = 0.0;\n\t\tm[ 2 * 4 + 1 ] = 0.0;\n\t\tm[ 2 * 4 + 2 ] = zFar / ( zNear - zFar ) * - handednessScale;\n\t\tm[ 2 * 4 + 3 ] = ( zFar * zNear ) / ( zNear - zFar );\n\n\t\t// W result (= Z in)\n\t\tm[ 3 * 4 + 0 ] = 0.0;\n\t\tm[ 3 * 4 + 1 ] = 0.0;\n\t\tm[ 3 * 4 + 2 ] = handednessScale;\n\t\tm[ 3 * 4 + 3 ] = 0.0;\n\n\t\tmobj.transpose();\n\n\t\treturn mobj;\n\n\t}\n\n\tfunction fovToProjection( fov, rightHanded, zNear, zFar ) {\n\n\t\tvar DEG2RAD = Math.PI / 180.0;\n\n\t\tvar fovPort = {\n\t\t\tupTan: Math.tan( fov.upDegrees * DEG2RAD ),\n\t\t\tdownTan: Math.tan( fov.downDegrees * DEG2RAD ),\n\t\t\tleftTan: Math.tan( fov.leftDegrees * DEG2RAD ),\n\t\t\trightTan: Math.tan( fov.rightDegrees * DEG2RAD )\n\t\t};\n\n\t\treturn fovPortToProjection( fovPort, rightHanded, zNear, zFar );\n\n\t}\n\n};\n","var registerGeometry = require('../core/geometry').registerGeometry;\nvar THREE = require('../lib/three');\n\nregisterGeometry('box', {\n  schema: {\n    depth: {default: 1, min: 0},\n    height: {default: 1, min: 0},\n    width: {default: 1, min: 0},\n    segmentsHeight: {default: 1, min: 1, max: 20, type: 'int'},\n    segmentsWidth: {default: 1, min: 1, max: 20, type: 'int'},\n    segmentsDepth: {default: 1, min: 1, max: 20, type: 'int'}\n  },\n\n  init: function (data) {\n    this.geometry = new THREE.BoxGeometry(data.width, data.height, data.depth);\n  }\n});\n","var registerGeometry = require('../core/geometry').registerGeometry;\nvar THREE = require('../lib/three');\n\nvar degToRad = THREE.Math.degToRad;\n\nregisterGeometry('circle', {\n  schema: {\n    radius: {default: 1, min: 0},\n    segments: {default: 32, min: 3, type: 'int'},\n    thetaLength: {default: 360, min: 0},\n    thetaStart: {default: 0}\n  },\n\n  init: function (data) {\n    this.geometry = new THREE.CircleGeometry(\n      data.radius, data.segments, degToRad(data.thetaStart), degToRad(data.thetaLength));\n  }\n});\n","var registerGeometry = require('../core/geometry').registerGeometry;\nvar THREE = require('../lib/three');\n\nvar degToRad = THREE.Math.degToRad;\n\nregisterGeometry('cone', {\n  schema: {\n    height: {default: 1, min: 0},\n    openEnded: {default: false},\n    radiusBottom: {default: 1, min: 0},\n    radiusTop: {default: 0.8, min: 0},\n    segmentsHeight: {default: 18, min: 1, type: 'int'},\n    segmentsRadial: {default: 36, min: 3, type: 'int'},\n    thetaLength: {default: 360, min: 0},\n    thetaStart: {default: 0}\n  },\n\n  init: function (data) {\n    this.geometry = new THREE.CylinderGeometry(\n        data.radiusTop, data.radiusBottom, data.height, data.segmentsRadial,\n        data.segmentsHeight, data.openEnded, degToRad(data.thetaStart),\n        degToRad(data.thetaLength));\n  }\n});\n","var registerGeometry = require('../core/geometry').registerGeometry;\nvar THREE = require('../lib/three');\n\nvar degToRad = THREE.Math.degToRad;\n\nregisterGeometry('cylinder', {\n  schema: {\n    height: {default: 1, min: 0},\n    openEnded: {default: false},\n    radius: {default: 1, min: 0},\n    segmentsHeight: {default: 18, min: 1, type: 'int'},\n    segmentsRadial: {default: 36, min: 3, type: 'int'},\n    thetaLength: {default: 360, min: 0},\n    thetaStart: {default: 0}\n  },\n\n  init: function (data) {\n    this.geometry = new THREE.CylinderGeometry(\n        data.radius, data.radius, data.height, data.segmentsRadial, data.segmentsHeight,\n        data.openEnded, degToRad(data.thetaStart), degToRad(data.thetaLength));\n  }\n});\n","var registerGeometry = require('../core/geometry').registerGeometry;\nvar THREE = require('../lib/three');\n\nregisterGeometry('dodecahedron', {\n  schema: {\n    detail: {default: 0, min: 0, max: 5, type: 'int'},\n    radius: {default: 1, min: 0}\n  },\n\n  init: function (data) {\n    this.geometry = new THREE.DodecahedronGeometry(data.radius, data.detail);\n  }\n});\n","var registerGeometry = require('../core/geometry').registerGeometry;\nvar THREE = require('../lib/three');\n\nregisterGeometry('icosahedron', {\n  schema: {\n    detail: {default: 0, min: 0, max: 5, type: 'int'},\n    radius: {default: 1, min: 0}\n  },\n\n  init: function (data) {\n    this.geometry = new THREE.IcosahedronGeometry(data.radius, data.detail);\n  }\n});\n","var registerGeometry = require('../core/geometry').registerGeometry;\nvar THREE = require('../lib/three');\n\nregisterGeometry('octahedron', {\n  schema: {\n    detail: {default: 0, min: 0, max: 5, type: 'int'},\n    radius: {default: 1, min: 0}\n  },\n\n  init: function (data) {\n    this.geometry = new THREE.OctahedronGeometry(data.radius, data.detail);\n  }\n});\n","var registerGeometry = require('../core/geometry').registerGeometry;\nvar THREE = require('../lib/three');\n\nregisterGeometry('plane', {\n  schema: {\n    height: {default: 1, min: 0},\n    width: {default: 1, min: 0},\n    segmentsHeight: {default: 1, min: 1, max: 20, type: 'int'},\n    segmentsWidth: {default: 1, min: 1, max: 20, type: 'int'}\n  },\n\n  init: function (data) {\n    this.geometry = new THREE.PlaneGeometry(data.width, data.height);\n  }\n});\n","var registerGeometry = require('../core/geometry').registerGeometry;\nvar THREE = require('../lib/three');\n\nvar degToRad = THREE.Math.degToRad;\n\nregisterGeometry('ring', {\n  schema: {\n    radiusInner: {default: 0.8, min: 0},\n    radiusOuter: {default: 1.2, min: 0},\n    segmentsPhi: {default: 10, min: 1, type: 'int'},\n    segmentsTheta: {default: 32, min: 3, type: 'int'},\n    thetaLength: {default: 360, min: 0},\n    thetaStart: {default: 0}\n  },\n\n  init: function (data) {\n    this.geometry = new THREE.RingGeometry(\n        data.radiusInner, data.radiusOuter, data.segmentsTheta, data.segmentsPhi,\n        degToRad(data.thetaStart), degToRad(data.thetaLength));\n  }\n});\n","var registerGeometry = require('../core/geometry').registerGeometry;\nvar THREE = require('../lib/three');\n\nvar degToRad = THREE.Math.degToRad;\n\nregisterGeometry('sphere', {\n  schema: {\n    radius: {default: 1, min: 0},\n    phiLength: {default: 360},\n    phiStart: {default: 0, min: 0},\n    thetaLength: {default: 180, min: 0},\n    thetaStart: {default: 0},\n    segmentsHeight: {default: 18, min: 2, type: 'int'},\n    segmentsWidth: {default: 36, min: 3, type: 'int'}\n  },\n\n  init: function (data) {\n    this.geometry = new THREE.SphereGeometry(\n      data.radius, data.segmentsWidth, data.segmentsHeight, degToRad(data.phiStart),\n      degToRad(data.phiLength), degToRad(data.thetaStart), degToRad(data.thetaLength));\n  }\n});\n","var registerGeometry = require('../core/geometry').registerGeometry;\nvar THREE = require('../lib/three');\n\nregisterGeometry('tetrahedron', {\n  schema: {\n    detail: {default: 0, min: 0, max: 5, type: 'int'},\n    radius: {default: 1, min: 0}\n  },\n\n  init: function (data) {\n    this.geometry = new THREE.TetrahedronGeometry(data.radius, data.detail);\n  }\n});\n","var registerGeometry = require('../core/geometry').registerGeometry;\nvar THREE = require('../lib/three');\n\nvar degToRad = THREE.Math.degToRad;\n\nregisterGeometry('torus', {\n  schema: {\n    arc: {default: 360},\n    radius: {default: 1, min: 0},\n    radiusTubular: {default: 0.2, min: 0},\n    segmentsRadial: {default: 36, min: 2, type: 'int'},\n    segmentsTubular: {default: 32, min: 3, type: 'int'}\n  },\n\n  init: function (data) {\n    this.geometry = new THREE.TorusGeometry(\n      data.radius, data.radiusTubular * 2, data.segmentsRadial, data.segmentsTubular,\n      degToRad(data.arc));\n  }\n});\n","var registerGeometry = require('../core/geometry').registerGeometry;\nvar THREE = require('../lib/three');\n\nregisterGeometry('torusKnot', {\n  schema: {\n    p: {default: 2, min: 1},\n    q: {default: 3, min: 1},\n    radius: {default: 1, min: 0},\n    radiusTubular: {default: 0.2, min: 0},\n    segmentsRadial: {default: 8, min: 3, type: 'int'},\n    segmentsTubular: {default: 100, min: 3, type: 'int'}\n  },\n\n  init: function (data) {\n    this.geometry = new THREE.TorusKnotGeometry(\n      data.radius, data.radiusTubular * 2, data.segmentsTubular, data.segmentsRadial,\n      data.p, data.q);\n  }\n});\n","var registerComponent = require('../core/component').registerComponent;\nvar THREE = require('../lib/three');\n\n/**\n * Blend character model component.\n * Loads a model with skeletal animation blending.\n */\nmodule.exports.Component = registerComponent('blend-character-model', {\n  schema: {type: 'src'},\n\n  init: function () {\n    this.model = null;\n  },\n\n  update: function () {\n    var self = this;\n    var el = this.el;\n    var src = this.data;\n\n    if (!src) { return; }\n\n    this.remove();\n    this.model = new THREE.BlendCharacter();\n\n    this.model.load(src, function () {\n      el.setObject3D('mesh', self.model);\n      el.emit('model-loaded', {format: 'blend', model: self.model});\n      self.model.castShadow = true;\n      self.model.receiveShadow = true;\n      self.model.material.shading = THREE.FlatShading;\n      self.model.geometry.computeBoundingBox();\n    });\n  },\n\n  remove: function () {\n    if (!this.model) { return; }\n    this.el.removeObject3D('mesh');\n  }\n});\n","var registerComponent = require('../core/component').registerComponent;\nvar THREE = require('../lib/three');\nvar utils = require('../utils/');\nvar bind = utils.bind;\n\nvar checkHeadsetConnected = utils.checkHeadsetConnected;\n\n/**\n * Camera component.\n * Pairs along with camera system to handle tracking the active camera.\n */\nmodule.exports.Component = registerComponent('camera', {\n  schema: {\n    active: {default: true},\n    far: {default: 10000},\n    fov: {default: 80, min: 0},\n    near: {default: 0.005, min: 0},\n    userHeight: {default: 0, min: 0},\n    zoom: {default: 1, min: 0}\n  },\n\n  /**\n   * Initialize three.js camera and add it to the entity.\n   * Add reference from scene to this entity as the camera.\n   */\n  init: function () {\n    var camera;\n    var el = this.el;\n    var sceneEl = el.sceneEl;\n\n    this.savedPose = null;\n\n    // Create camera.\n    camera = this.camera = new THREE.PerspectiveCamera();\n    el.setObject3D('camera', camera);\n\n    // Add listeners to save and restore camera pose if headset is present.\n    this.onEnterVR = bind(this.onEnterVR, this);\n    this.onExitVR = bind(this.onExitVR, this);\n    sceneEl.addEventListener('enter-vr', this.onEnterVR);\n    sceneEl.addEventListener('exit-vr', this.onExitVR);\n  },\n\n  /**\n   * Update three.js camera.\n   */\n  update: function (oldData) {\n    var el = this.el;\n    var data = this.data;\n    var camera = this.camera;\n    var system = this.system;\n\n    // Update height offset.\n    this.addHeightOffset(oldData.userHeight);\n\n    // Update properties.\n    camera.aspect = data.aspect || (window.innerWidth / window.innerHeight);\n    camera.far = data.far;\n    camera.fov = data.fov;\n    camera.near = data.near;\n    camera.zoom = data.zoom;\n    camera.updateProjectionMatrix();\n\n    // Active property did not change.\n    if (oldData && oldData.active === data.active) { return; }\n\n    // If `active` property changes, or first update, handle active camera with system.\n    if (data.active && system.activeCameraEl !== el) {\n      // Camera enabled. Set camera to this camera.\n      system.setActiveCamera(el);\n    } else if (!data.active && system.activeCameraEl === el) {\n      // Camera disabled. Set camera to another camera.\n      system.disableActiveCamera();\n    }\n  },\n\n  /**\n   * Remove camera on remove (callback).\n   */\n  remove: function () {\n    var sceneEl = this.el.sceneEl;\n    this.el.removeObject3D('camera');\n    sceneEl.removeEventListener('enter-vr', this.onEnterVR);\n    sceneEl.removeEventListener('exit-vr', this.onExitVR);\n  },\n\n  /**\n   * Save pose and remove the offset.\n   */\n  onEnterVR: function () {\n    this.saveCameraPose();\n    this.removeHeightOffset();\n  },\n\n  /**\n   * Restore the pose. Do not need to re-add the offset because it was saved on entering VR.\n   */\n  onExitVR: function () {\n    this.restoreCameraPose();\n  },\n\n  /**\n   * Offsets the position of the camera to set a human scale perspective\n   * This offset is not necessary when using a headset because the SDK\n   * will return the real user's head height and position.\n   */\n  addHeightOffset: function (oldOffset) {\n    var el = this.el;\n    var currentPosition;\n    var userHeightOffset = this.data.userHeight;\n\n    oldOffset = oldOffset || 0;\n    currentPosition = el.getAttribute('position') || {x: 0, y: 0, z: 0};\n    el.setAttribute('position', {\n      x: currentPosition.x,\n      y: currentPosition.y - oldOffset + userHeightOffset,\n      z: currentPosition.z\n    });\n  },\n\n  /**\n   * Remove the height offset (called when entering VR) since WebVR API gives absolute\n   * position.\n   * Does not apply for mobile.\n   */\n  removeHeightOffset: function () {\n    var currentPosition;\n    var el = this.el;\n    var headsetConnected;\n    var sceneEl = el.sceneEl;\n    var userHeightOffset = this.data.userHeight;\n\n    // If there's not a headset connected we keep the offset.\n    // Necessary for fullscreen mode with no headset.\n    // Checking this.headsetConnected to make the value injectable for unit tests.\n    headsetConnected = this.headsetConnected || checkHeadsetConnected();\n    if (sceneEl.isMobile || !userHeightOffset || !headsetConnected) { return; }\n\n    currentPosition = el.getAttribute('position') || {x: 0, y: 0, z: 0};\n    el.setAttribute('position', {\n      x: currentPosition.x,\n      y: currentPosition.y - userHeightOffset,\n      z: currentPosition.z\n    });\n  },\n\n  /**\n   * Save camera pose before entering VR to restore later if exiting.\n   */\n  saveCameraPose: function () {\n    var el = this.el;\n    var headsetConnected = this.headsetConnected || checkHeadsetConnected();\n\n    if (this.savedPose || !headsetConnected) { return; }\n\n    this.savedPose = {\n      position: el.getAttribute('position'),\n      rotation: el.getAttribute('rotation')\n    };\n  },\n\n  /**\n   * Reset camera pose to before entering VR.\n   */\n  restoreCameraPose: function () {\n    var el = this.el;\n    var savedPose = this.savedPose;\n    var headsetConnected = this.headsetConnected || checkHeadsetConnected();\n\n    if (!savedPose || !headsetConnected) { return; }\n\n    // Reset camera orientation.\n    el.setAttribute('position', savedPose.position);\n    el.setAttribute('rotation', savedPose.rotation);\n    this.savedPose = null;\n  }\n});\n","var registerComponent = require('../core/component').registerComponent;\nvar THREE = require('../lib/three');\n\nmodule.exports.Component = registerComponent('collada-model', {\n  schema: {\n    type: 'src'\n  },\n\n  init: function () {\n    this.model = null;\n    this.loader = new THREE.ColladaLoader();\n    this.loader.options.convertUpAxis = true;\n  },\n\n  update: function () {\n    var self = this;\n    var el = this.el;\n    var src = this.data;\n\n    if (!src) { return; }\n\n    this.remove();\n\n    this.loader.load(src, function (colladaModel) {\n      self.model = colladaModel.scene;\n      el.setObject3D('mesh', self.model);\n      el.emit('model-loaded', {format: 'collada', model: self.model});\n    });\n  },\n\n  remove: function () {\n    if (!this.model) { return; }\n    this.el.removeObject3D('mesh');\n  }\n});\n","var registerComponent = require('../core/component').registerComponent;\nvar utils = require('../utils/');\nvar bind = utils.bind;\n\nvar EVENTS = {\n  CLICK: 'click',\n  MOUSEENTER: 'mouseenter',\n  MOUSEDOWN: 'mousedown',\n  MOUSELEAVE: 'mouseleave',\n  MOUSEUP: 'mouseup'\n};\n\nvar STATES = {\n  FUSING: 'cursor-fusing',\n  HOVERING: 'cursor-hovering',\n  HOVERED: 'cursor-hovered'\n};\n\n/**\n * Cursor component. Applies the raycaster component specifically for starting the raycaster\n * from the camera and pointing from camera's facing direction, and then only returning the\n * closest intersection. Cursor can be fine-tuned by setting raycaster properties.\n *\n * @member {object} fuseTimeout - Timeout to trigger fuse-click.\n * @member {Element} mouseDownEl - Entity that was last mousedowned during current click.\n * @member {object} intersection - Attributes of the current intersection event, including\n *         3D- and 2D-space coordinates. See: http://threejs.org/docs/api/core/Raycaster.html\n * @member {Element} intersectedEl - Currently-intersected entity. Used to keep track to\n *         emit events when unintersecting.\n */\nmodule.exports.Component = registerComponent('cursor', {\n  dependencies: ['raycaster'],\n\n  schema: {\n    fuse: {default: utils.isMobile()},\n    fuseTimeout: {default: 1500, min: 0}\n  },\n\n  init: function () {\n    var cursorEl = this.el;\n    var canvas = cursorEl.sceneEl.canvas;\n    this.fuseTimeout = undefined;\n    this.mouseDownEl = null;\n    this.intersection = null;\n    this.intersectedEl = null;\n\n    // Wait for canvas to load.\n    if (!canvas) {\n      cursorEl.sceneEl.addEventListener('render-target-loaded', bind(this.init, this));\n      return;\n    }\n\n    // Attach event listeners.\n    canvas.addEventListener('mousedown', bind(this.onMouseDown, this));\n    canvas.addEventListener('mouseup', bind(this.onMouseUp, this));\n    cursorEl.addEventListener('raycaster-intersection', bind(this.onIntersection, this));\n    cursorEl.addEventListener('raycaster-intersection-cleared',\n                              bind(this.onIntersectionCleared, this));\n  },\n\n  /**\n   * Trigger mousedown and keep track of the mousedowned entity.\n   */\n  onMouseDown: function (evt) {\n    this.twoWayEmit(EVENTS.MOUSEDOWN);\n    this.mouseDownEl = this.intersectedEl;\n  },\n\n  /**\n   * Trigger mouseup if:\n   * - Not fusing (mobile has no mouse).\n   * - Currently intersecting an entity.\n   * - Currently-intersected entity is the same as the one when mousedown was triggered,\n   *   in case user mousedowned one entity, dragged to another, and mouseupped.\n   */\n  onMouseUp: function (evt) {\n    this.twoWayEmit(EVENTS.MOUSEUP);\n    if (this.data.fuse || !this.intersectedEl ||\n        this.mouseDownEl !== this.intersectedEl) { return; }\n    this.twoWayEmit(EVENTS.CLICK);\n  },\n\n  /**\n   * Handle intersection.\n   */\n  onIntersection: function (evt) {\n    var self = this;\n    var cursorEl = this.el;\n    var data = this.data;\n    var index;\n    var intersectedEl;\n    var intersection;\n\n    // Select closest object, excluding the cursor.\n    index = evt.detail.els[0] === cursorEl ? 1 : 0;\n    intersection = evt.detail.intersections[index];\n    intersectedEl = evt.detail.els[index];\n\n    // If cursor is the only intersected object, ignore the event.\n    if (!intersectedEl) { return; }\n\n    // Already intersecting this entity.\n    if (this.intersectedEl === intersectedEl) {\n      this.intersection = intersection;\n      return;\n    }\n\n    // Unset current intersection.\n    if (this.intersectedEl) { this.clearCurrentIntersection(); }\n\n    // Set new intersection.\n    this.intersection = intersection;\n    this.intersectedEl = intersectedEl;\n\n    // Hovering.\n    cursorEl.addState(STATES.HOVERING);\n    intersectedEl.addState(STATES.HOVERED);\n    self.twoWayEmit(EVENTS.MOUSEENTER);\n\n    // Begin fuse if necessary.\n    if (data.fuseTimeout === 0 || !data.fuse) { return; }\n    cursorEl.addState(STATES.FUSING);\n    this.fuseTimeout = setTimeout(function fuse () {\n      cursorEl.removeState(STATES.FUSING);\n      self.twoWayEmit(EVENTS.CLICK);\n    }, data.fuseTimeout);\n  },\n\n  /**\n   * Handle intersection cleared.\n   */\n  onIntersectionCleared: function (evt) {\n    var cursorEl = this.el;\n    var intersectedEl = evt.detail.el;\n\n    // Ignore the cursor.\n    if (cursorEl === intersectedEl) { return; }\n\n    // Ignore if the event didn't occur on the current intersection.\n    if (intersectedEl !== this.intersectedEl) { return; }\n\n    this.clearCurrentIntersection();\n  },\n\n  clearCurrentIntersection: function () {\n    var cursorEl = this.el;\n\n    // No longer hovering (or fusing).\n    this.intersectedEl.removeState(STATES.HOVERED);\n    cursorEl.removeState(STATES.HOVERING);\n    cursorEl.removeState(STATES.FUSING);\n    this.twoWayEmit(EVENTS.MOUSELEAVE);\n\n    // Unset intersected entity (after emitting the event).\n    this.intersection = null;\n    this.intersectedEl = null;\n\n    // Clear fuseTimeout.\n    clearTimeout(this.fuseTimeout);\n  },\n\n  /**\n   * Helper to emit on both the cursor and the intersected entity (if exists).\n   */\n  twoWayEmit: function (evtName) {\n    var el = this.el;\n    var intersectedEl = this.intersectedEl;\n    var intersection = this.intersection;\n    el.emit(evtName, {intersectedEl: intersectedEl, intersection: intersection});\n    if (!intersectedEl) { return; }\n    intersectedEl.emit(evtName, {cursorEl: el, intersection: intersection});\n  }\n});\n","var debug = require('../utils/debug');\nvar geometries = require('../core/geometry').geometries;\nvar geometryNames = require('../core/geometry').geometryNames;\nvar registerComponent = require('../core/component').registerComponent;\nvar THREE = require('../lib/three');\n\nvar dummyGeometry = new THREE.Geometry();\nvar warn = debug('components:geometry:warn');\n\n/**\n * Geometry component. Combined with material component to make a mesh in 3D object.\n * Extended with registered geometries.\n */\nmodule.exports.Component = registerComponent('geometry', {\n  schema: {\n    buffer: {default: true},\n    mergeTo: {type: 'selector'},\n    primitive: {default: 'box', oneOf: geometryNames},\n    skipCache: {default: false}\n  },\n\n  init: function () {\n    this.geometry = null;\n  },\n\n  /**\n   * Talk to geometry system to get or create geometry.\n   */\n  update: function (previousData) {\n    var data = this.data;\n    var mesh = this.el.getOrCreateObject3D('mesh', THREE.Mesh);\n    var system = this.system;\n\n    // Dispose old geometry if we created one.\n    if (this.geometry) {\n      system.unuseGeometry(previousData);\n      this.geometry = null;\n    }\n\n    // Create new geometry.\n    this.geometry = mesh.geometry = system.getOrCreateGeometry(data);\n    if (data.mergeTo) {\n      this.mergeTo(data.mergeTo);\n    }\n  },\n\n  /**\n   * Merge geometry to another entity's geometry.\n   * Remove the entity from the scene. Not a reversible operation.\n   *\n   * @param {Element} toEl - Entity where the geometry will be merged to.\n   */\n  mergeTo: function (toEl) {\n    var el = this.el;\n    var mesh = el.getObject3D('mesh');\n    var toMesh;\n\n    if (!toEl) {\n      warn('There is not a valid entity to merge the geometry to');\n      return;\n    }\n\n    if (toEl === el) {\n      warn('Source and target geometries cannot be the same for merge');\n      return;\n    }\n\n    // Create mesh if entity does not have one.\n    toMesh = toEl.getObject3D('mesh');\n    if (!toMesh) {\n      toMesh = toEl.getOrCreateObject3D('mesh', THREE.Mesh);\n      toEl.setAttribute('material', el.getAttribute('material'));\n      return;\n    }\n\n    if (toMesh.geometry instanceof THREE.Geometry === false ||\n        mesh.geometry instanceof THREE.Geometry === false) {\n      warn('Geometry merge is only available for `THREE.Geometry` types. ' +\n           'Check that both of the merging geometry and the target geometry have `buffer` ' +\n           'set to false');\n      return;\n    }\n\n    if (this.data.skipCache === false) {\n      warn('Cached geometries are not allowed to merge. Set `skipCache` to true');\n      return;\n    }\n\n    mesh.parent.updateMatrixWorld();\n    toMesh.geometry.merge(mesh.geometry, mesh.matrixWorld);\n    el.emit('geometry-merged', {mergeTarget: toEl});\n    el.parentNode.removeChild(el);\n  },\n\n  /**\n   * Tell geometry system that entity is no longer using the geometry.\n   * Unset the geometry on the mesh\n   */\n  remove: function () {\n    this.system.unuseGeometry(this.data);\n    this.el.getObject3D('mesh').geometry = dummyGeometry;\n    this.geometry = null;\n  },\n\n  /**\n   * Update geometry component schema based on geometry type.\n   *\n   * @param {object} data - New data passed by Component.\n   */\n  updateSchema: function (data) {\n    var newGeometryType = data.primitive;\n    var currentGeometryType = this.data && this.data.primitive;\n    var schema = geometries[newGeometryType] && geometries[newGeometryType].schema;\n\n    // Geometry has no schema.\n    if (!schema) { throw new Error('Unknown geometry schema `' + newGeometryType + '`'); }\n    // Nothing has changed.\n    if (currentGeometryType && currentGeometryType === newGeometryType) { return; }\n\n    this.extendSchema(schema);\n  }\n});\n","var bind = require('../utils/bind');\nvar diff = require('../utils').diff;\nvar debug = require('../utils/debug');\nvar registerComponent = require('../core/component').registerComponent;\nvar THREE = require('../lib/three');\n\nvar degToRad = THREE.Math.degToRad;\nvar warn = debug('components:light:warn');\n\n/**\n * Light component.\n */\nmodule.exports.Component = registerComponent('light', {\n  schema: {\n    angle: {default: 60, if: {type: ['spot']}},\n    color: {type: 'color'},\n    groundColor: {type: 'color', if: {type: ['hemisphere']}},\n    decay: {default: 1, if: {type: ['point', 'spot']}},\n    distance: {default: 0.0, min: 0, if: {type: ['point', 'spot']}},\n    intensity: {default: 1.0, min: 0, if: {type: ['ambient', 'directional', 'hemisphere', 'point', 'spot']}},\n    penumbra: {default: 0, min: 0, max: 1, if: {type: ['spot']}},\n    type: {default: 'directional',\n           oneOf: ['ambient', 'directional', 'hemisphere', 'point', 'spot']},\n    target: {type: 'selector', if: {type: ['spot', 'directional']}}\n  },\n\n  /**\n   * Notifies scene a light has been added to remove default lighting.\n   */\n  init: function () {\n    var el = this.el;\n    this.light = null;\n    this.defaultTarget = null;\n    this.system.registerLight(el);\n  },\n\n  /**\n   * (Re)create or update light.\n   */\n  update: function (oldData) {\n    var data = this.data;\n    var diffData = diff(data, oldData);\n    var light = this.light;\n    var self = this;\n\n    // Existing light.\n    if (light && !('type' in diffData)) {\n      // Light type has not changed. Update light.\n      Object.keys(diffData).forEach(function (key) {\n        var value = data[key];\n\n        switch (key) {\n          case 'color': {\n            light.color.set(value);\n            break;\n          }\n\n          case 'groundcolor': {\n            light.groundColor.set(value);\n            break;\n          }\n\n          case 'angle': {\n            light.angle = degToRad(value);\n            break;\n          }\n\n          case 'target': {\n            // Reset target if selector is null.\n            if (value === null) {\n              if (data.type === 'spot' || data.type === 'directional') {\n                light.target = self.defaultTarget;\n              }\n            } else {\n              // Target specified, set target to entity's `object3D` when it is loaded.\n              if (value.hasLoaded) {\n                self.onSetTarget(value);\n              } else {\n                value.addEventListener('loaded', bind(self.onSetTarget, self, value));\n              }\n            }\n            break;\n          }\n\n          default: {\n            light[key] = value;\n          }\n        }\n      });\n      return;\n    }\n\n    // No light yet or light type has changed. Create and add light.\n    this.setLight(this.data);\n  },\n\n  setLight: function (data) {\n    var el = this.el;\n    var newLight = this.getLight(data);\n    if (newLight) {\n      if (this.light) {\n        el.removeObject3D('light');\n      }\n\n      this.light = newLight;\n      this.light.el = el;\n      el.setObject3D('light', this.light);\n\n      // HACK solution for issue #1624\n      if (data.type === 'spot' || data.type === 'directional' || data.type === 'hemisphere') {\n        el.getObject3D('light').translateY(-1);\n      }\n\n      // set and position default lighttarget as a child to enable spotlight orientation\n      if (data.type === 'spot') {\n        el.setObject3D('light-target', this.defaultTarget);\n        el.getObject3D('light-target').position.set(0, 0, -1);\n      }\n    }\n  },\n\n  /**\n   * Creates a new three.js light object given data object defining the light.\n   *\n   * @param {object} data\n   */\n  getLight: function (data) {\n    var angle = data.angle;\n    var color = new THREE.Color(data.color).getHex();\n    var decay = data.decay;\n    var distance = data.distance;\n    var groundColor = new THREE.Color(data.groundColor).getHex();\n    var intensity = data.intensity;\n    var type = data.type;\n    var target = data.target;\n    var light = null;\n\n    switch (type.toLowerCase()) {\n      case 'ambient': {\n        return new THREE.AmbientLight(color, intensity);\n      }\n\n      case 'directional': {\n        light = new THREE.DirectionalLight(color, intensity);\n        this.defaultTarget = light.target;\n        if (target) {\n          if (target.hasLoaded) {\n            this.onSetTarget(target);\n          } else {\n            target.addEventListener('loaded', bind(this.onSetTarget, this, target));\n          }\n        }\n        return light;\n      }\n\n      case 'hemisphere': {\n        return new THREE.HemisphereLight(color, groundColor, intensity);\n      }\n\n      case 'point': {\n        return new THREE.PointLight(color, intensity, distance, decay);\n      }\n\n      case 'spot': {\n        light = new THREE.SpotLight(color, intensity, distance, degToRad(angle), data.penumbra, decay);\n        this.defaultTarget = light.target;\n        if (target) {\n          if (target.hasLoaded) {\n            this.onSetTarget(target);\n          } else {\n            target.addEventListener('loaded', bind(this.onSetTarget, this, target));\n          }\n        }\n        return light;\n      }\n\n      default: {\n        warn('%s is not a valid light type. ' +\n           'Choose from ambient, directional, hemisphere, point, spot.', type);\n      }\n    }\n  },\n\n  onSetTarget: function (targetEl) {\n    this.light.target = targetEl.object3D;\n  },\n\n  /**\n   * Remove light on remove (callback).\n   */\n  remove: function () {\n    this.el.removeObject3D('light');\n  }\n});\n","var registerComponent = require('../core/component').registerComponent;\n\nvar LEFT_HAND_MODEL_URL = 'https://cdn.aframe.io/controllers/hands/leftHand.json';\nvar RIGHT_HAND_MODEL_URL = 'https://cdn.aframe.io/controllers/hands/rightHand.json';\n\n/**\n*\n* Hand Controls component\n* Handle events coming from the vive-controls\n* Translate button events to hand related actions:\n* gripclose, gripopen, thumbup, thumbdown, pointup, pointdown\n* Load a hand model with gestures that are applied based\n* on the button pressed.\n*\n* @property {left/right} Hand mapping\n*/\nmodule.exports.Component = registerComponent('hand-controls', {\n  schema: {default: 'left'},\n\n  init: function () {\n    var self = this;\n    this.onGripDown = function () { self.handleButton('grip', 'down'); };\n    this.onGripUp = function () { self.handleButton('grip', 'up'); };\n    this.onTrackpadDown = function () { self.handleButton('trackpad', 'down'); };\n    this.onTrackpadUp = function () { self.handleButton('trackpad', 'up'); };\n    this.onTriggerDown = function () { self.handleButton('trigger', 'down'); };\n    this.onTriggerUp = function () { self.handleButton('trigger', 'up'); };\n  },\n\n  play: function () {\n    this.addEventListeners();\n  },\n\n  pause: function () {\n    this.removeEventListeners();\n  },\n\n  addEventListeners: function () {\n    var el = this.el;\n    el.addEventListener('gripdown', this.onGripDown);\n    el.addEventListener('gripup', this.onGripUp);\n    el.addEventListener('trackpaddown', this.onTrackpadDown);\n    el.addEventListener('trackpadup', this.onTrackpadUp);\n    el.addEventListener('triggerdown', this.onTriggerDown);\n    el.addEventListener('triggerup', this.onTriggerUp);\n  },\n\n  removeEventListeners: function () {\n    var el = this.el;\n    el.removeEventListener('gripdown', this.onGripDown);\n    el.removeEventListener('gripup', this.onGripUp);\n    el.removeEventListener('trackpaddown', this.onTrackpadDown);\n    el.removeEventListener('trackpadup', this.onTrackpadUp);\n    el.removeEventListener('triggerdown', this.onTriggerDown);\n    el.removeEventListener('triggerup', this.onTriggerUp);\n  },\n\n  update: function () {\n    var el = this.el;\n    var hand = this.data;\n    var modelUrl;\n    if (hand === 'left') {\n      modelUrl = 'url(' + LEFT_HAND_MODEL_URL + ')';\n    } else {\n      modelUrl = 'url(' + RIGHT_HAND_MODEL_URL + ')';\n    }\n    el.setAttribute('vive-controls', {hand: hand, model: false});\n    el.setAttribute('blend-character-model', modelUrl);\n  },\n\n /** Play the model animations based on the pressed button and kind of event.\n   *\n   * @param {string} button the name of the button\n   * @param {string} evt the event associated to the button\n   */\n  handleButton: function (button, evt) {\n    var el = this.el;\n    var isPressed = evt === 'down';\n    switch (button) {\n      case 'trackpad':\n        if (isPressed === this.trackpadPressed) { return; }\n        this.trackpadPressed = isPressed;\n        this.playAnimation('thumb', !isPressed);\n        evt = isPressed ? 'thumbup' : 'thumbdown';\n        el.emit(evt);\n        break;\n      case 'trigger':\n        if (isPressed === this.triggerPressed) { return; }\n        this.triggerPressed = isPressed;\n        this.playAnimation('pointing', !isPressed);\n        evt = isPressed ? 'pointup' : 'pointdown';\n        el.emit(evt);\n        break;\n      case 'grip':\n        if (isPressed === this.gripPressed) { return; }\n        this.gripPressed = isPressed;\n        this.playAnimation('close', !isPressed);\n        evt = isPressed ? 'gripclose' : 'gripopen';\n        el.emit(evt);\n        break;\n    }\n  },\n\n  /**\n  * Play the hand animations based on button state.\n  *\n  * @param {string} animation - the name of the animation.\n  * @param {string} reverse - It the animation has to play in reverse.\n  */\n  playAnimation: function (animation, reverse) {\n    var animationActive = this.animationActive;\n    var timeScale = 1;\n    var mesh = this.el.getObject3D('mesh');\n    if (!mesh) { return; }\n\n    // determine direction of the animation.\n    if (reverse) { timeScale = -1; }\n\n    // stop current animation.\n    if (animationActive) { mesh.play(animationActive, 0); }\n\n    // play new animation.\n    mesh.mixer.clipAction(animation).loop = 2200;\n    mesh.mixer.clipAction(animation).clampWhenFinished = true;\n    mesh.mixer.clipAction(animation).timeScale = timeScale;\n    mesh.play(animation, 1);\n    this.animationActive = animation;\n  }\n});\n","var registerComponent = require('../core/component').registerComponent;\nvar THREE = require('../lib/three');\nvar isMobile = require('../utils/').isMobile();\nvar bind = require('../utils/bind');\n\n// To avoid recalculation at every mouse movement tick\nvar PI_2 = Math.PI / 2;\nvar radToDeg = THREE.Math.radToDeg;\n\nmodule.exports.Component = registerComponent('look-controls', {\n  dependencies: ['position', 'rotation'],\n\n  schema: {\n    enabled: {default: true},\n    hmdEnabled: {default: true},\n    standing: {default: true}\n  },\n\n  init: function () {\n    var sceneEl = this.el.sceneEl;\n\n    this.previousHMDPosition = new THREE.Vector3();\n    this.setupMouseControls();\n    this.setupHMDControls();\n    this.bindMethods();\n\n    // Enable grab cursor class on canvas.\n    function enableGrabCursor () { sceneEl.canvas.classList.add('a-grab-cursor'); }\n    if (!sceneEl.canvas) {\n      sceneEl.addEventListener('render-target-loaded', enableGrabCursor);\n    } else {\n      enableGrabCursor();\n    }\n  },\n\n  update: function (oldData) {\n    var data = this.data;\n    var hmdEnabled = data.hmdEnabled;\n    if (!data.enabled) { return; }\n    if (!hmdEnabled && oldData && hmdEnabled !== oldData.hmdEnabled) {\n      this.pitchObject.rotation.set(0, 0, 0);\n      this.yawObject.rotation.set(0, 0, 0);\n    }\n    this.controls.standing = data.standing;\n    this.controls.update();\n    this.updateOrientation();\n    this.updatePosition();\n  },\n\n  play: function () {\n    this.addEventListeners();\n  },\n\n  pause: function () {\n    this.removeEventListeners();\n  },\n\n  tick: function (t) {\n    this.update();\n  },\n\n  remove: function () {\n    this.pause();\n  },\n\n  bindMethods: function () {\n    this.onMouseDown = bind(this.onMouseDown, this);\n    this.onMouseMove = bind(this.onMouseMove, this);\n    this.releaseMouse = bind(this.releaseMouse, this);\n    this.onTouchStart = bind(this.onTouchStart, this);\n    this.onTouchMove = bind(this.onTouchMove, this);\n    this.onTouchEnd = bind(this.onTouchEnd, this);\n  },\n\n  setupMouseControls: function () {\n    // The canvas where the scene is painted\n    this.mouseDown = false;\n    this.pitchObject = new THREE.Object3D();\n    this.yawObject = new THREE.Object3D();\n    this.yawObject.position.y = 10;\n    this.yawObject.add(this.pitchObject);\n  },\n\n  setupHMDControls: function () {\n    this.dolly = new THREE.Object3D();\n    this.euler = new THREE.Euler();\n    this.controls = new THREE.VRControls(this.dolly);\n    this.controls.userHeight = 0.0;\n  },\n\n  addEventListeners: function () {\n    var sceneEl = this.el.sceneEl;\n    var canvasEl = sceneEl.canvas;\n\n    // listen for canvas to load.\n    if (!canvasEl) {\n      sceneEl.addEventListener('render-target-loaded', bind(this.addEventListeners, this));\n      return;\n    }\n\n    // Mouse Events\n    canvasEl.addEventListener('mousedown', this.onMouseDown, false);\n    window.addEventListener('mousemove', this.onMouseMove, false);\n    window.addEventListener('mouseup', this.releaseMouse, false);\n\n    // Touch events\n    canvasEl.addEventListener('touchstart', this.onTouchStart);\n    window.addEventListener('touchmove', this.onTouchMove);\n    window.addEventListener('touchend', this.onTouchEnd);\n  },\n\n  removeEventListeners: function () {\n    var sceneEl = this.el.sceneEl;\n    var canvasEl = sceneEl && sceneEl.canvas;\n    if (!canvasEl) { return; }\n\n    // Mouse Events\n    canvasEl.removeEventListener('mousedown', this.onMouseDown);\n    canvasEl.removeEventListener('mousemove', this.onMouseMove);\n    canvasEl.removeEventListener('mouseup', this.releaseMouse);\n    canvasEl.removeEventListener('mouseout', this.releaseMouse);\n\n    // Touch events\n    canvasEl.removeEventListener('touchstart', this.onTouchStart);\n    canvasEl.removeEventListener('touchmove', this.onTouchMove);\n    canvasEl.removeEventListener('touchend', this.onTouchEnd);\n  },\n\n  updateOrientation: (function () {\n    var hmdEuler = new THREE.Euler();\n    return function () {\n      var currentRotation;\n      var deltaRotation;\n      var pitchObject = this.pitchObject;\n      var yawObject = this.yawObject;\n      var hmdQuaternion = this.calculateHMDQuaternion();\n      var sceneEl = this.el.sceneEl;\n      var rotation;\n      hmdEuler.setFromQuaternion(hmdQuaternion, 'YXZ');\n      if (isMobile) {\n        // In mobile we allow camera rotation with touch events and sensors\n        rotation = {\n          x: radToDeg(hmdEuler.x) + radToDeg(pitchObject.rotation.x),\n          y: radToDeg(hmdEuler.y) + radToDeg(yawObject.rotation.y),\n          z: radToDeg(hmdEuler.z)\n        };\n      } else if (!sceneEl.is('vr-mode') || isNullVector(hmdEuler) || !this.data.hmdEnabled) {\n        currentRotation = this.el.getAttribute('rotation');\n        deltaRotation = this.calculateDeltaRotation();\n        // Mouse look only if HMD disabled or no info coming from the sensors\n        rotation = {\n          x: currentRotation.x + deltaRotation.x,\n          y: currentRotation.y + deltaRotation.y,\n          z: currentRotation.z\n        };\n      } else {\n        // Mouse rotation ignored with an active headset.\n        // The user head rotation takes priority\n        rotation = {\n          x: radToDeg(hmdEuler.x),\n          y: radToDeg(hmdEuler.y),\n          z: radToDeg(hmdEuler.z)\n        };\n      }\n      this.el.setAttribute('rotation', rotation);\n    };\n  })(),\n\n  calculateDeltaRotation: (function () {\n    var previousRotationX;\n    var previousRotationY;\n    return function () {\n      var currentRotationX = radToDeg(this.pitchObject.rotation.x);\n      var currentRotationY = radToDeg(this.yawObject.rotation.y);\n      var deltaRotation;\n      previousRotationX = previousRotationX || currentRotationX;\n      previousRotationY = previousRotationY || currentRotationY;\n      deltaRotation = {\n        x: currentRotationX - previousRotationX,\n        y: currentRotationY - previousRotationY\n      };\n      previousRotationX = currentRotationX;\n      previousRotationY = currentRotationY;\n      return deltaRotation;\n    };\n  })(),\n\n  calculateHMDQuaternion: (function () {\n    var hmdQuaternion = new THREE.Quaternion();\n    return function () {\n      hmdQuaternion.copy(this.dolly.quaternion);\n      return hmdQuaternion;\n    };\n  })(),\n\n  updatePosition: (function () {\n    var deltaHMDPosition = new THREE.Vector3();\n    return function () {\n      var el = this.el;\n      var currentPosition = el.getAttribute('position');\n      var currentHMDPosition;\n      var previousHMDPosition = this.previousHMDPosition;\n      var sceneEl = this.el.sceneEl;\n      currentHMDPosition = this.calculateHMDPosition();\n      deltaHMDPosition.copy(currentHMDPosition).sub(previousHMDPosition);\n      if (!sceneEl.is('vr-mode') || isNullVector(deltaHMDPosition)) { return; }\n      previousHMDPosition.copy(currentHMDPosition);\n      // Do nothing if we have not moved.\n      if (!sceneEl.is('vr-mode')) { return; }\n      el.setAttribute('position', {\n        x: currentPosition.x + deltaHMDPosition.x,\n        y: currentPosition.y + deltaHMDPosition.y,\n        z: currentPosition.z + deltaHMDPosition.z\n      });\n    };\n  })(),\n\n  calculateHMDPosition: function () {\n    var dolly = this.dolly;\n    var position = new THREE.Vector3();\n    dolly.updateMatrix();\n    position.setFromMatrixPosition(dolly.matrix);\n    return position;\n  },\n\n  onMouseMove: function (event) {\n    var pitchObject = this.pitchObject;\n    var yawObject = this.yawObject;\n    var previousMouseEvent = this.previousMouseEvent;\n\n    if (!this.mouseDown || !this.data.enabled) { return; }\n\n    var movementX = event.movementX || event.mozMovementX;\n    var movementY = event.movementY || event.mozMovementY;\n\n    if (movementX === undefined || movementY === undefined) {\n      movementX = event.screenX - previousMouseEvent.screenX;\n      movementY = event.screenY - previousMouseEvent.screenY;\n    }\n    this.previousMouseEvent = event;\n\n    yawObject.rotation.y -= movementX * 0.002;\n    pitchObject.rotation.x -= movementY * 0.002;\n    pitchObject.rotation.x = Math.max(-PI_2, Math.min(PI_2, pitchObject.rotation.x));\n  },\n\n  onMouseDown: function (event) {\n    this.mouseDown = true;\n    this.previousMouseEvent = event;\n    document.body.classList.add('a-grabbing');\n  },\n\n  releaseMouse: function () {\n    this.mouseDown = false;\n    document.body.classList.remove('a-grabbing');\n  },\n\n  onTouchStart: function (e) {\n    if (e.touches.length !== 1) { return; }\n    this.touchStart = {\n      x: e.touches[0].pageX,\n      y: e.touches[0].pageY\n    };\n    this.touchStarted = true;\n  },\n\n  onTouchMove: function (e) {\n    var deltaY;\n    var yawObject = this.yawObject;\n    if (!this.touchStarted) { return; }\n    deltaY = 2 * Math.PI * (e.touches[0].pageX - this.touchStart.x) /\n            this.el.sceneEl.canvas.clientWidth;\n    // Limits touch orientaion to to yaw (y axis)\n    yawObject.rotation.y -= deltaY * 0.5;\n    this.touchStart = {\n      x: e.touches[0].pageX,\n      y: e.touches[0].pageY\n    };\n  },\n\n  onTouchEnd: function () {\n    this.touchStarted = false;\n  }\n});\n\nfunction isNullVector (vector) {\n  return vector.x === 0 && vector.y === 0 && vector.z === 0;\n}\n","/* global Promise */\nvar utils = require('../utils/');\nvar component = require('../core/component');\nvar THREE = require('../lib/three');\nvar shader = require('../core/shader');\n\nvar error = utils.debug('components:material:error');\nvar registerComponent = component.registerComponent;\nvar shaders = shader.shaders;\nvar shaderNames = shader.shaderNames;\n\n/**\n * Material component.\n *\n * @member {object} shader - Determines how material is shaded. Defaults to `standard`,\n *         three.js's implementation of PBR. Another standard shading model is `flat` which\n *         uses MeshBasicMaterial.\n */\nmodule.exports.Component = registerComponent('material', {\n  schema: {\n    depthTest: {default: true},\n    flatShading: {default: false},\n    opacity: {default: 1.0, min: 0.0, max: 1.0},\n    shader: {default: 'standard', oneOf: shaderNames},\n    side: {default: 'front', oneOf: ['front', 'back', 'double']},\n    transparent: {default: false},\n    visible: {default: true}\n  },\n\n  init: function () {\n    this.material = null;\n  },\n\n  /**\n   * Update or create material.\n   *\n   * @param {object|null} oldData\n   */\n  update: function (oldData) {\n    var data = this.data;\n    if (!this.shader || data.shader !== oldData.shader) {\n      this.updateShader(data.shader);\n    }\n    this.shader.update(this.data);\n    this.updateMaterial();\n  },\n\n  updateSchema: function (data) {\n    var newShader = data.shader;\n    var currentShader = this.data && this.data.shader;\n    var shader = newShader || currentShader;\n    var schema = shaders[shader] && shaders[shader].schema;\n    if (!schema) { error('Unknown shader schema ' + shader); }\n    if (currentShader && newShader === currentShader) { return; }\n    this.extendSchema(schema);\n    this.updateBehavior();\n  },\n\n  updateBehavior: function () {\n    var scene = this.el.sceneEl;\n    var schema = this.schema;\n    var self = this;\n    var tickProperties = {};\n    var tick = function (time, delta) {\n      var keys = Object.keys(tickProperties);\n      keys.forEach(update);\n      function update (key) { tickProperties[key] = time; }\n      self.shader.update(tickProperties);\n    };\n    var keys = Object.keys(schema);\n    keys.forEach(function (key) {\n      if (schema[key].type === 'time') {\n        self.tick = tick;\n        tickProperties[key] = true;\n        scene.addBehavior(self);\n      }\n    });\n    if (Object.keys(tickProperties).length === 0) {\n      scene.removeBehavior(this);\n    }\n  },\n\n  updateShader: function (shaderName) {\n    var data = this.data;\n    var Shader = shaders[shaderName] && shaders[shaderName].Shader;\n    var shaderInstance;\n\n    if (!Shader) { throw new Error('Unknown shader ' + shaderName); }\n\n    // Get material from A-Frame shader.\n    shaderInstance = this.shader = new Shader();\n    shaderInstance.el = this.el;\n    shaderInstance.init(data);\n    this.setMaterial(shaderInstance.material);\n    this.updateSchema(data);\n  },\n\n  updateMaterial: function () {\n    var data = this.data;\n    var material = this.material;\n    material.side = parseSide(data.side);\n    material.opacity = data.opacity;\n    material.transparent = data.transparent !== false || data.opacity < 1.0;\n    material.depthTest = data.depthTest !== false;\n    material.shading = data.flatShading ? THREE.FlatShading : THREE.SmoothShading;\n    material.visible = data.visible;\n  },\n\n  /**\n   * Remove material on remove (callback).\n   * Dispose of it from memory and unsubscribe from scene updates.\n   */\n  remove: function () {\n    var defaultMaterial = new THREE.MeshBasicMaterial();\n    var material = this.material;\n    var object3D = this.el.getObject3D('mesh');\n    if (object3D) { object3D.material = defaultMaterial; }\n    disposeMaterial(material, this.system);\n  },\n\n  /**\n   * (Re)create new material. Has side-effects of setting `this.material` and updating\n   * material registration in scene.\n   *\n   * @param {object} data - Material component data.\n   * @param {object} type - Material type to create.\n   * @returns {object} Material.\n   */\n  setMaterial: function (material) {\n    var mesh = this.el.getOrCreateObject3D('mesh', THREE.Mesh);\n    var system = this.system;\n    if (this.material) { disposeMaterial(this.material, system); }\n    this.material = mesh.material = material;\n    system.registerMaterial(material);\n  }\n});\n\n/**\n * Returns a three.js constant determining which material face sides to render\n * based on the side parameter (passed as a component property).\n *\n * @param {string} [side=front] - `front`, `back`, or `double`.\n * @returns {number} THREE.FrontSide, THREE.BackSide, or THREE.DoubleSide.\n */\nfunction parseSide (side) {\n  switch (side) {\n    case 'back': {\n      return THREE.BackSide;\n    }\n    case 'double': {\n      return THREE.DoubleSide;\n    }\n    default: {\n      // Including case `front`.\n      return THREE.FrontSide;\n    }\n  }\n}\n\n/**\n * Dispose of material from memory and unsubscribe material from scene updates like fog.\n */\nfunction disposeMaterial (material, system) {\n  material.dispose();\n  system.unregisterMaterial(material);\n}\n","var debug = require('../utils/debug');\nvar registerComponent = require('../core/component').registerComponent;\nvar THREE = require('../lib/three');\n\nvar warn = debug('components:obj-model:warn');\n\nmodule.exports.Component = registerComponent('obj-model', {\n  dependencies: ['material'],\n\n  schema: {\n    mtl: {type: 'src'},\n    obj: {type: 'src'}\n  },\n\n  init: function () {\n    this.model = null;\n    this.objLoader = new THREE.OBJLoader();\n    this.mtlLoader = new THREE.MTLLoader(this.objLoader.manager);\n    // Allow cross-origin images to be loaded.\n    this.mtlLoader.crossOrigin = '';\n  },\n\n  update: function () {\n    var data = this.data;\n    if (!data.obj) { return; }\n    this.remove();\n    this.loadObj(data.obj, data.mtl);\n  },\n\n  remove: function () {\n    if (!this.model) { return; }\n    this.el.removeObject3D('mesh');\n  },\n\n  loadObj: function (objUrl, mtlUrl) {\n    var self = this;\n    var el = this.el;\n    var mtlLoader = this.mtlLoader;\n    var objLoader = this.objLoader;\n\n    if (mtlUrl) {\n      // .OBJ with an .MTL.\n      if (el.hasAttribute('material')) {\n        warn('Material component properties are ignored when a .MTL is provided');\n      }\n      mtlLoader.setBaseUrl(mtlUrl.substr(0, mtlUrl.lastIndexOf('/') + 1));\n      mtlLoader.load(mtlUrl, function (materials) {\n        materials.preload();\n        objLoader.setMaterials(materials);\n        objLoader.load(objUrl, function (objModel) {\n          self.model = objModel;\n          el.setObject3D('mesh', objModel);\n          el.emit('model-loaded', {format: 'obj', model: objModel});\n        });\n      });\n      return;\n    }\n\n    // .OBJ only.\n    objLoader.load(objUrl, function (objModel) {\n      // Apply material.\n      var material = el.components.material;\n      if (material) {\n        objModel.traverse(function (child) {\n          if (child instanceof THREE.Mesh) {\n            child.material = material.material;\n          }\n        });\n      }\n\n      self.model = objModel;\n      el.setObject3D('mesh', objModel);\n      el.emit('model-loaded', {format: 'obj', model: objModel});\n    });\n  }\n});\n","var registerComponent = require('../core/component').registerComponent;\nvar THREE = require('../lib/three');\nvar bind = require('../utils/').bind;\n\nvar scaleDummy = new THREE.Vector3();\n\n/**\n * Raycaster component.\n *\n * Pass options to three.js Raycaster including which objects to test.\n * Poll for intersections.\n * Emit event on origin entity and on target entity on intersect.\n *\n * @member {array} intersectedEls - List of currently intersected entities.\n * @member {array} objects - Cached list of meshes to intersect.\n * @member {number} prevCheckTime - Previous time intersection was checked. To help interval.\n * @member {object} raycaster - three.js Raycaster.\n */\nmodule.exports.Component = registerComponent('raycaster', {\n  schema: {\n    far: {default: Infinity}, // Infinity.\n    interval: {default: 100},\n    near: {default: 0},\n    objects: {default: ''},\n    recursive: {default: true}\n  },\n\n  init: function () {\n    this.direction = new THREE.Vector3();\n    this.intersectedEls = [];\n    this.objects = null;\n    this.prevCheckTime = undefined;\n    this.raycaster = new THREE.Raycaster();\n    this.updateOriginDirection();\n    this.refreshObjects = bind(this.refreshObjects, this);\n  },\n\n  play: function () {\n    this.el.sceneEl.addEventListener('child-attached', this.refreshObjects);\n    this.el.sceneEl.addEventListener('child-detached', this.refreshObjects);\n  },\n\n  pause: function () {\n    this.el.sceneEl.removeEventListener('child-attached', this.refreshObjects);\n    this.el.sceneEl.removeEventListener('child-detached', this.refreshObjects);\n  },\n\n  /**\n   * Create or update raycaster object.\n   */\n  update: function () {\n    var data = this.data;\n    var raycaster = this.raycaster;\n\n    // Set raycaster properties.\n    raycaster.far = data.far;\n    raycaster.near = data.near;\n\n    this.refreshObjects();\n  },\n\n  /**\n   * Update list of objects to test for intersection.\n   */\n  refreshObjects: function () {\n    var data = this.data;\n    var i;\n    var objectEls;\n\n    // Push meshes onto list of objects to intersect.\n    if (data.objects) {\n      objectEls = this.el.sceneEl.querySelectorAll(data.objects);\n      this.objects = [];\n      for (i = 0; i < objectEls.length; i++) {\n        this.objects.push(objectEls[i].object3D);\n      }\n      return;\n    }\n\n    // If objects not defined, intersect with everything.\n    this.objects = this.el.sceneEl.object3D.children;\n  },\n\n  /**\n   * Check for intersections and cleared intersections on an interval.\n   */\n  tick: function (time) {\n    var el = this.el;\n    var data = this.data;\n    var intersectedEls;\n    var intersections;\n    var prevCheckTime = this.prevCheckTime;\n    var prevIntersectedEls;\n\n    // Only check for intersection if interval time has passed.\n    if (prevCheckTime && (time - prevCheckTime < data.interval)) { return; }\n\n    // Store old previously intersected entities.\n    prevIntersectedEls = this.intersectedEls.slice();\n\n    // Raycast.\n    this.updateOriginDirection();\n    intersections = this.raycaster.intersectObjects(this.objects, data.recursive);\n\n    // Only keep intersections against objects that have a reference to an entity.\n    intersections = intersections.filter(function hasEl (intersection) {\n      return !!intersection.object.el;\n    });\n\n    // Update intersectedEls.\n    intersectedEls = this.intersectedEls = intersections.map(function getEl (intersection) {\n      return intersection.object.el;\n    });\n\n    // Emit intersected on intersected entity per intersected entity.\n    intersections.forEach(function emitEvents (intersection) {\n      var intersectedEl = intersection.object.el;\n      intersectedEl.emit('raycaster-intersected', {el: el, intersection: intersection});\n    });\n\n    // Emit all intersections at once on raycasting entity.\n    if (intersections.length) {\n      el.emit('raycaster-intersection', {\n        els: intersectedEls.slice(),\n        intersections: intersections\n      });\n    }\n\n    // Emit intersection cleared on both entities per formerly intersected entity.\n    prevIntersectedEls.forEach(function checkStillIntersected (intersectedEl) {\n      if (intersectedEls.indexOf(intersectedEl) !== -1) { return; }\n      el.emit('raycaster-intersection-cleared', {el: intersectedEl});\n      intersectedEl.emit('raycaster-intersected-cleared', {el: el});\n    });\n  },\n\n  /**\n   * Set origin and direction of raycaster using entity position and rotation.\n   */\n  updateOriginDirection: (function () {\n    var directionHelper = new THREE.Quaternion();\n    var originVec3 = new THREE.Vector3();\n\n    // Closure to make quaternion/vector3 objects private.\n    return function updateOriginDirection () {\n      var el = this.el;\n      var object3D = el.object3D;\n\n      // Update matrix world.\n      object3D.updateMatrixWorld();\n      // Grab the position and rotation.\n      object3D.matrixWorld.decompose(originVec3, directionHelper, scaleDummy);\n      // Apply rotation to a 0, 0, -1 vector.\n      this.direction.set(0, 0, -1);\n      this.direction.applyQuaternion(directionHelper);\n\n      this.raycaster.set(originVec3, this.direction);\n    };\n  })()\n});\n","var registerComponent = require('../core/component').registerComponent;\n\nmodule.exports.Component = registerComponent('position', {\n  schema: {type: 'vec3'},\n\n  update: function () {\n    var object3D = this.el.object3D;\n    var data = this.data;\n    object3D.position.set(data.x, data.y, data.z);\n  }\n});\n","var degToRad = require('../lib/three').Math.degToRad;\nvar registerComponent = require('../core/component').registerComponent;\n\nmodule.exports.Component = registerComponent('rotation', {\n  schema: {type: 'vec3'},\n\n  /**\n   * Updates object3D rotation.\n   */\n  update: function () {\n    var data = this.data;\n    var object3D = this.el.object3D;\n    object3D.rotation.set(degToRad(data.x), degToRad(data.y), degToRad(data.z));\n    object3D.rotation.order = 'YXZ';\n  }\n});\n","var registerComponent = require('../core/component').registerComponent;\nvar debug = require('../utils/debug');\nvar bind = require('../utils/bind');\nvar THREE = require('../lib/three');\n\nvar warn = debug('components:sound:warn');\n\n/**\n * Sound component.\n */\nmodule.exports.Component = registerComponent('sound', {\n  schema: {\n    autoplay: {default: false},\n    loop: {default: false},\n    on: {default: ''},\n    poolSize: {default: 1},\n    src: {type: 'src'},\n    volume: {default: 1}\n  },\n\n  multiple: true,\n\n  init: function () {\n    this.listener = null;\n    this.audioLoader = new THREE.AudioLoader();\n    this.pool = new THREE.Group();\n    this.playSound = bind(this.playSound, this);\n  },\n\n  update: function (oldData) {\n    var data = this.data;\n    var srcChanged = data.src !== oldData.src;\n    // Create new sound if not yet created or changing `src`.\n    if (srcChanged) {\n      if (!data.src) {\n        warn('Audio source was not specified with `src`');\n        return;\n      }\n      this.setupSound();\n    }\n\n    this.pool.children.forEach(function (sound) {\n      sound.autoplay = data.autoplay;\n      sound.setLoop(data.loop);\n      sound.setVolume(data.volume);\n    });\n\n    if (data.on !== oldData.on) {\n      this.updateEventListener(oldData.on);\n    }\n\n    // All sound values set. Load in `src`.\n    if (srcChanged) {\n      var self = this;\n      this.audioLoader.load(data.src, function (buffer) {\n        self.pool.children.forEach(function (sound) {\n          sound.setBuffer(buffer);\n        });\n        // Remove this key from cache, otherwise we can't play it again\n        THREE.Cache.remove(data.src);\n      });\n    }\n  },\n\n  /**\n  *  Update listener attached to the user defined on event.\n  */\n  updateEventListener: function (oldEvt) {\n    var el = this.el;\n    if (oldEvt) { el.removeEventListener(oldEvt, this.playSound); }\n    el.addEventListener(this.data.on, this.playSound);\n  },\n\n  removeEventListener: function () {\n    this.el.removeEventListener(this.data.on, this.playSound);\n  },\n\n  remove: function () {\n    this.removeEventListener();\n    this.el.removeObject3D(this.attrName);\n    try {\n      this.pool.children.forEach(function (sound) {\n        sound.disconnect();\n      });\n    } catch (e) {\n      // disconnect() will throw if it was never connected initially.\n      warn('Audio source not properly disconnected');\n    }\n  },\n\n  play: function () {\n    // Look for an unused sound in the pool and play it if found.\n    if (this.data.autoplay) {\n      this.playSound();\n    }\n    this.updateEventListener();\n  },\n\n  /**\n   * Removes current sound object, creates new sound object, adds to entity.\n   *\n   * @returns {object} sound\n   */\n  setupSound: function () {\n    var el = this.el;\n    var sceneEl = el.sceneEl;\n\n    if (this.pool.children.length > 0) {\n      this.stop();\n      el.removeObject3D('sound');\n    }\n\n    // Only want one AudioListener. Cache it on the scene.\n    var listener = this.listener = sceneEl.audioListener || new THREE.AudioListener();\n    sceneEl.audioListener = listener;\n\n    if (sceneEl.camera) {\n      sceneEl.camera.add(listener);\n    }\n\n    // Wait for camera if necessary.\n    sceneEl.addEventListener('camera-set-active', function (evt) {\n      evt.detail.cameraEl.getObject3D('camera').add(listener);\n    });\n\n    // Create [poolSize] audio instances and attach them to pool\n    this.pool = new THREE.Group();\n    for (var i = 0; i < this.data.poolSize; i++) {\n      var sound = new THREE.PositionalAudio(listener);\n      this.pool.add(sound);\n    }\n    el.setObject3D(this.attrName, this.pool);\n\n    this.pool.children.forEach(function (sound) {\n      sound.source.onended = function () {\n        sound.onEnded();\n        el.emit('sound-ended', {index: i});\n      };\n    });\n  },\n\n  playSound: function () {\n    // Look for an unused sound in the pool and play it if found.\n    var found = false;\n    this.pool.children.forEach(function (sound) {\n      if (!sound.isPlaying && sound.source.buffer && !found) {\n        sound.play();\n        found = true;\n        return;\n      }\n    });\n\n    if (!found) {\n      warn('All the sounds are playing. If you need to play more sounds simultaneously consider increasing the size of pool with the `poolSize` attribute.');\n    }\n  },\n\n  stop: function () {\n    // Stop all the sounds in the pool\n    this.pool.children.forEach(function (sound) {\n      if (!sound.source.buffer) { return; }\n      sound.stop();\n    });\n  },\n\n  pause: function () {\n    // Pause all the sounds in the pool\n    this.pool.children.forEach(function (sound) {\n      if (!sound.source.buffer || !sound.isPlaying) { return; }\n      sound.pause();\n    });\n    this.removeEventListener();\n  }\n});\n","var registerComponent = require('../core/component').registerComponent;\n\n// Avoids triggering a zero-determinant which makes object3D matrix non-invertible.\nvar zeroScale = 0.00001;\n\nmodule.exports.Component = registerComponent('scale', {\n  schema: {\n    type: 'vec3',\n    default: {x: 1, y: 1, z: 1}\n  },\n\n  update: function () {\n    var data = this.data;\n    var object3D = this.el.object3D;\n    var x = data.x === 0 ? zeroScale : data.x;\n    var y = data.y === 0 ? zeroScale : data.y;\n    var z = data.z === 0 ? zeroScale : data.z;\n    object3D.scale.set(x, y, z);\n  }\n});\n","var registerComponent = require('../core/component').registerComponent;\nvar THREE = require('../lib/three');\n\n/**\n * Tracked controls component\n * Interface with the gamepad API to handled tracked controllers. Selects\n * the appropriate controller and applies pose to the entity. It also observes\n * buttons state and emits appropriate events.\n *\n * @property {number} controller - index of the controller in the array\n *                                 returned by the Gamepad API.\n * @property {string} id - Selects the controllers among those returned by the Gamepad API.\n */\nmodule.exports.Component = registerComponent('tracked-controls', {\n  schema: {\n    controller: {default: 0},\n    id: {default: 'OpenVR Gamepad'}\n  },\n\n  init: function () {\n    this.buttonStates = {};\n    this.previousAxis = [];\n  },\n\n  update: function () {\n    var controllers = this.system.controllers;\n    var data = this.data;\n    controllers = controllers.filter(hasId);\n    // handId: 0 - right, 1 - left\n    this.controller = controllers[data.controller];\n    function hasId (controller) { return controller.id === data.id; }\n  },\n\n  tick: function (time, delta) {\n    var mesh = this.el.getObject3D('mesh');\n    // Update mesh animations.\n    if (mesh && mesh.update) { mesh.update(delta / 1000); }\n    this.updatePose();\n    this.updateButtons();\n  },\n\n  updatePose: (function () {\n    var controllerEuler = new THREE.Euler();\n    var controllerPosition = new THREE.Vector3();\n    var controllerQuaternion = new THREE.Quaternion();\n    var dolly = new THREE.Object3D();\n    var standingMatrix = new THREE.Matrix4();\n    controllerEuler.order = 'YXZ';\n    return function () {\n      var controller;\n      var pose;\n      var orientation;\n      var position;\n      var el = this.el;\n      var vrDisplay = this.system.vrDisplay;\n      this.update();\n      controller = this.controller;\n      if (!controller) { return; }\n      pose = controller.pose;\n      orientation = pose.orientation || [0, 0, 0, 1];\n      position = pose.position || [0, 0, 0];\n      controllerQuaternion.fromArray(orientation);\n      dolly.quaternion.fromArray(orientation);\n      dolly.position.fromArray(position);\n      dolly.updateMatrix();\n      if (vrDisplay && vrDisplay.stageParameters) {\n        standingMatrix.fromArray(vrDisplay.stageParameters.sittingToStandingTransform);\n        dolly.applyMatrix(standingMatrix);\n      }\n      controllerEuler.setFromRotationMatrix(dolly.matrix);\n      controllerPosition.setFromMatrixPosition(dolly.matrix);\n      el.setAttribute('rotation', {\n        x: THREE.Math.radToDeg(controllerEuler.x),\n        y: THREE.Math.radToDeg(controllerEuler.y),\n        z: THREE.Math.radToDeg(controllerEuler.z)\n      });\n      el.setAttribute('position', {\n        x: controllerPosition.x,\n        y: controllerPosition.y,\n        z: controllerPosition.z\n      });\n    };\n  })(),\n\n  updateButtons: function () {\n    var i;\n    var buttonState;\n    var controller = this.controller;\n    if (!this.controller) { return; }\n    for (i = 0; i < controller.buttons.length; ++i) {\n      buttonState = controller.buttons[i];\n      this.handleButton(i, buttonState);\n    }\n    this.handleAxes(controller.axes);\n  },\n\n  handleAxes: function (controllerAxes) {\n    var previousAxis = this.previousAxis;\n    var changed = false;\n    var i;\n    for (i = 0; i < controllerAxes.length; ++i) {\n      if (previousAxis[i] !== controllerAxes[i]) {\n        changed = true;\n        break;\n      }\n    }\n    if (!changed) { return; }\n    this.previousAxis = controllerAxes.slice();\n    this.el.emit('axismove', {axis: this.previousAxis});\n  },\n\n  handleButton: function (id, buttonState) {\n    var changed = false;\n    changed = changed || this.handlePress(id, buttonState);\n    changed = changed || this.handleTouch(id, buttonState);\n    changed = changed || this.handleValue(id, buttonState);\n    if (!changed) { return; }\n    this.el.emit('buttonchanged', {id: id, state: buttonState});\n  },\n\n  handlePress: function (id, buttonState) {\n    var buttonStates = this.buttonStates;\n    var evtName;\n    var previousButtonState = buttonStates[id] = buttonStates[id] || {};\n    if (buttonState.pressed === previousButtonState.pressed) { return; }\n    if (buttonState.pressed) {\n      evtName = 'down';\n    } else {\n      evtName = 'up';\n    }\n    this.el.emit('button' + evtName, {id: id});\n    previousButtonState.pressed = buttonState.pressed;\n  },\n\n  handleTouch: function (id, buttonState) {\n    var buttonStates = this.buttonStates;\n    var evtName;\n    var previousButtonState = buttonStates[id] = buttonStates[id] || {};\n    if (buttonState.touched === previousButtonState.touched) {\n      return false;\n    }\n    if (buttonState.touched) {\n      evtName = 'start';\n    } else {\n      evtName = 'end';\n    }\n    previousButtonState.touched = buttonState.touched;\n    this.el.emit('touch' + evtName, {id: id, state: previousButtonState});\n    return true;\n  },\n\n  handleValue: function (id, buttonState) {\n    var buttonStates = this.buttonStates;\n    var previousButtonState = buttonStates[id] = buttonStates[id] || {};\n    if (buttonState.value === previousButtonState.value) { return false; }\n    previousButtonState.value = buttonState.value;\n    return true;\n  }\n});\n","var registerComponent = require('../core/component').registerComponent;\n\n/**\n * Visibility component.\n */\nmodule.exports.Component = registerComponent('visible', {\n  schema: {default: true},\n\n  update: function () {\n    this.el.object3D.visible = this.data;\n  }\n});\n","var KEYCODE_TO_CODE = require('../constants').keyboardevent.KEYCODE_TO_CODE;\nvar registerComponent = require('../core/component').registerComponent;\nvar THREE = require('../lib/three');\nvar utils = require('../utils/');\n\nvar bind = utils.bind;\nvar shouldCaptureKeyEvent = utils.shouldCaptureKeyEvent;\n\nvar CLAMP_VELOCITY = 0.00001;\nvar MAX_DELTA = 0.2;\n\n/**\n * WASD component to control entities using WASD keys.\n */\nmodule.exports.Component = registerComponent('wasd-controls', {\n  schema: {\n    acceleration: {default: 65},\n    adAxis: {default: 'x', oneOf: ['x', 'y', 'z']},\n    adEnabled: {default: true},\n    adInverted: {default: false},\n    easing: {default: 20},\n    enabled: {default: true},\n    fly: {default: false},\n    wsAxis: {default: 'z', oneOf: ['x', 'y', 'z']},\n    wsEnabled: {default: true},\n    wsInverted: {default: false}\n  },\n\n  init: function () {\n    // To keep track of the pressed keys.\n    this.keys = {};\n\n    this.velocity = new THREE.Vector3();\n\n    // Bind methods and add event listeners.\n    this.onBlur = bind(this.onBlur, this);\n    this.onFocus = bind(this.onFocus, this);\n    this.onKeyDown = bind(this.onKeyDown, this);\n    this.onKeyUp = bind(this.onKeyUp, this);\n    this.onVisibilityChange = bind(this.onVisibilityChange, this);\n    this.attachVisibilityEventListeners();\n  },\n\n  tick: function (time, delta) {\n    var data = this.data;\n    var el = this.el;\n    var movementVector;\n    var position;\n    var velocity = this.velocity;\n\n    // Use seconds.\n    delta = delta / 1000;\n\n    // Get velocity.\n    this.updateVelocity(delta);\n    if (!velocity[data.adAxis] && !velocity[data.wsAxis]) { return; }\n\n    // Get movement vector and translate position.\n    movementVector = this.getMovementVector(delta);\n    position = el.getAttribute('position');\n    el.setAttribute('position', {\n      x: position.x + movementVector.x,\n      y: position.y + movementVector.y,\n      z: position.z + movementVector.z\n    });\n  },\n\n  remove: function () {\n    this.removeKeyEventListeners();\n    this.removeVisibilityEventListeners();\n  },\n\n  play: function () {\n    this.attachKeyEventListeners();\n  },\n\n  pause: function () {\n    this.keys = {};\n    this.removeKeyEventListeners();\n  },\n\n  updateVelocity: function (delta) {\n    var acceleration;\n    var adAxis;\n    var adSign;\n    var data = this.data;\n    var keys = this.keys;\n    var velocity = this.velocity;\n    var wsAxis;\n    var wsSign;\n\n    adAxis = data.adAxis;\n    wsAxis = data.wsAxis;\n\n    // If FPS too low, reset velocity.\n    if (delta > MAX_DELTA) {\n      velocity[adAxis] = 0;\n      velocity[wsAxis] = 0;\n      return;\n    }\n\n    // Decay velocity.\n    if (velocity[adAxis] !== 0) {\n      velocity[adAxis] -= velocity[adAxis] * data.easing * delta;\n    }\n    if (velocity[wsAxis] !== 0) {\n      velocity[wsAxis] -= velocity[wsAxis] * data.easing * delta;\n    }\n\n    // Clamp velocity easing.\n    if (Math.abs(velocity[adAxis]) < CLAMP_VELOCITY) { velocity[adAxis] = 0; }\n    if (Math.abs(velocity[wsAxis]) < CLAMP_VELOCITY) { velocity[wsAxis] = 0; }\n\n    if (!data.enabled) { return; }\n\n    // Update velocity using keys pressed.\n    acceleration = data.acceleration;\n    if (data.adEnabled) {\n      adSign = data.adInverted ? -1 : 1;\n      if (keys.KeyA || keys.ArrowLeft) { velocity[adAxis] -= adSign * acceleration * delta; }\n      if (keys.KeyD || keys.ArrowRight) { velocity[adAxis] += adSign * acceleration * delta; }\n    }\n    if (data.wsEnabled) {\n      wsSign = data.wsInverted ? -1 : 1;\n      if (keys.KeyW || keys.ArrowUp) { velocity[wsAxis] -= wsSign * acceleration * delta; }\n      if (keys.KeyS || keys.ArrowDown) { velocity[wsAxis] += wsSign * acceleration * delta; }\n    }\n  },\n\n  getMovementVector: (function () {\n    var directionVector = new THREE.Vector3(0, 0, 0);\n    var rotationEuler = new THREE.Euler(0, 0, 0, 'YXZ');\n\n    return function (delta) {\n      var rotation = this.el.getAttribute('rotation');\n      var velocity = this.velocity;\n\n      directionVector.copy(velocity);\n      directionVector.multiplyScalar(delta);\n\n      // Absolute.\n      if (!rotation) { return directionVector; }\n\n      if (!this.data.fly) { rotation.x = 0; }\n\n      // Transform direction relative to heading.\n      rotationEuler.set(THREE.Math.degToRad(rotation.x), THREE.Math.degToRad(rotation.y), 0);\n      directionVector.applyEuler(rotationEuler);\n      return directionVector;\n    };\n  })(),\n\n  attachVisibilityEventListeners: function () {\n    window.addEventListener('blur', this.onBlur);\n    window.addEventListener('focus', this.onFocus);\n    document.addEventListener('visibilitychange', this.onVisibilityChange);\n  },\n\n  removeVisibilityEventListeners: function () {\n    window.removeEventListener('blur', this.onBlur);\n    window.removeEventListener('focus', this.onFocus);\n    document.removeEventListener('visibilitychange', this.onVisibilityChange);\n  },\n\n  attachKeyEventListeners: function () {\n    window.addEventListener('keydown', this.onKeyDown);\n    window.addEventListener('keyup', this.onKeyUp);\n  },\n\n  removeKeyEventListeners: function () {\n    window.removeEventListener('keydown', this.onKeyDown);\n    window.removeEventListener('keyup', this.onKeyUp);\n  },\n\n  onBlur: function () {\n    this.pause();\n  },\n\n  onFocus: function () {\n    this.play();\n  },\n\n  onVisibilityChange: function () {\n    if (document.hidden) {\n      this.onBlur();\n    } else {\n      this.onFocus();\n    }\n  },\n\n  onKeyDown: function (event) {\n    var code;\n    if (!shouldCaptureKeyEvent(event)) { return; }\n    code = event.code || KEYCODE_TO_CODE[event.keyCode];\n    this.keys[code] = true;\n  },\n\n  onKeyUp: function (event) {\n    var code;\n    if (!shouldCaptureKeyEvent(event)) { return; }\n    code = event.code || KEYCODE_TO_CODE[event.keyCode];\n    this.keys[code] = false;\n  }\n});\n","var registerComponent = require('../core/component').registerComponent;\nvar bind = require('../utils/bind');\n\nvar VIVE_CONTROLLER_MODEL_OBJ_URL = 'https://cdn.aframe.io/controllers/vive/vr_controller_vive.obj';\nvar VIVE_CONTROLLER_MODEL_OBJ_MTL = 'https://cdn.aframe.io/controllers/vive/vr_controller_vive.mtl';\n\n/**\n * Vive Controls Component\n * Interfaces with vive controls and maps Gamepad events to\n * vive controller buttons: trackpad, trigger, grip, menu and system\n * It loads a vive controller model and highlights the pressed buttons\n */\nmodule.exports.Component = registerComponent('vive-controls', {\n  dependencies: ['tracked-controls'],\n\n  schema: {\n    hand: {default: 'left'},\n    buttonColor: {default: '#FAFAFA'},  // Off-white.\n    buttonHighlightColor: {default: '#22D1EE'},  // Light blue.\n    model: {default: true}\n  },\n\n  // buttonId\n  // 0 - trackpad\n  // 1 - trigger ( intensity value from 0.5 to 1 )\n  // 2 - grip\n  // 3 - menu ( dispatch but better for menu options )\n  // 4 - system ( never dispatched on this layer )\n  mapping: {\n    axis0: 'trackpad',\n    axis1: 'trackpad',\n    button0: 'trackpad',\n    button1: 'trigger',\n    button2: 'grip',\n    button3: 'menu',\n    button4: 'system'\n  },\n\n  init: function () {\n    var self = this;\n    this.animationActive = 'pointing';\n    this.onButtonChanged = bind(this.onButtonChanged, this);\n    this.onButtonDown = function (evt) { self.onButtonEvent(evt.detail.id, 'down'); };\n    this.onButtonUp = function (evt) { self.onButtonEvent(evt.detail.id, 'up'); };\n    this.onModelLoaded = bind(this.onModelLoaded, this);\n  },\n\n  play: function () {\n    var el = this.el;\n    el.addEventListener('buttonchanged', this.onButtonChanged);\n    el.addEventListener('buttondown', this.onButtonDown);\n    el.addEventListener('buttonup', this.onButtonUp);\n    el.addEventListener('model-loaded', this.onModelLoaded);\n  },\n\n  pause: function () {\n    var el = this.el;\n    el.removeEventListener('buttonchanged', this.onButtonChanged);\n    el.removeEventListener('buttondown', this.onButtonDown);\n    el.removeEventListener('buttonup', this.onButtonUp);\n    el.removeEventListener('model-loaded', this.onModelLoaded);\n  },\n\n  update: function () {\n    var el = this.el;\n    var data = this.data;\n    var objUrl = 'url(' + VIVE_CONTROLLER_MODEL_OBJ_URL + ')';\n    var mtlUrl = 'url(' + VIVE_CONTROLLER_MODEL_OBJ_MTL + ')';\n    // handId: 0 - right, 1 - left\n    var controller = data.hand === 'right' ? 0 : 1;\n    el.setAttribute('tracked-controls', 'controller', controller);\n    if (!data.model) { return; }\n    el.setAttribute('obj-model', {obj: objUrl, mtl: mtlUrl});\n  },\n\n  onButtonChanged: function (evt) {\n    var button = this.mapping['button' + evt.detail.id];\n    var buttonMeshes = this.buttonMeshes;\n    var value;\n    if (button !== 'trigger' || !buttonMeshes) { return; }\n    value = evt.detail.state.value;\n    buttonMeshes.trigger.rotation.x = -value * (Math.PI / 12);\n  },\n\n  onModelLoaded: function (evt) {\n    var controllerObject3D = evt.detail.model;\n    var buttonMeshes;\n    if (!this.data.model) { return; }\n    buttonMeshes = this.buttonMeshes = {};\n    buttonMeshes.grip = {\n      left: controllerObject3D.getObjectByName('leftgrip'),\n      right: controllerObject3D.getObjectByName('rightgrip')\n    };\n    buttonMeshes.menu = controllerObject3D.getObjectByName('menubutton');\n    buttonMeshes.system = controllerObject3D.getObjectByName('systembutton');\n    buttonMeshes.trackpad = controllerObject3D.getObjectByName('touchpad');\n    buttonMeshes.trigger = controllerObject3D.getObjectByName('trigger');\n    // Offset pivot point\n    controllerObject3D.position.set(0, -0.015, 0.04);\n  },\n\n  onButtonEvent: function (id, evtName) {\n    var buttonName = this.mapping['button' + id];\n    this.el.emit(buttonName + evtName);\n    if (!this.data.model) { return; }\n    this.updateModel(buttonName, evtName);\n  },\n\n  updateModel: function (buttonName, state) {\n    var color = state === 'up' ? this.data.buttonColor : this.data.buttonHighlightColor;\n    var buttonMeshes = this.buttonMeshes;\n    if (!buttonMeshes) { return; }\n    if (buttonName === 'grip') {\n      buttonMeshes.grip.left.material.color.set(color);\n      buttonMeshes.grip.right.material.color.set(color);\n      return;\n    }\n    buttonMeshes[buttonName].material.color.set(color);\n  }\n});\n","var registerShader = require('../core/shader').registerShader;\nvar THREE = require('../lib/three');\nvar utils = require('../utils/');\n\n/**\n * Flat shader using THREE.MeshBasicMaterial.\n */\nmodule.exports.Component = registerShader('flat', {\n  schema: {\n    color: {type: 'color'},\n    fog: {default: true},\n    height: {default: 256},\n    repeat: {default: ''},\n    src: {default: ''},\n    width: {default: 512},\n    wireframe: {default: false},\n    wireframeLinewidth: {default: 2}\n  },\n\n  /**\n   * Initializes the shader.\n   * Adds a reference from the scene to this entity as the camera.\n   */\n  init: function (data) {\n    this.textureSrc = null;\n    this.material = new THREE.MeshBasicMaterial(getMaterialData(data));\n    utils.material.updateMap(this, data);\n  },\n\n  update: function (data) {\n    this.updateMaterial(data);\n    utils.material.updateMap(this, data);\n  },\n\n  /**\n   * Updating existing material.\n   *\n   * @param {object} data - Material component data.\n   */\n  updateMaterial: function (data) {\n    var material = this.material;\n    data = getMaterialData(data);\n    Object.keys(data).forEach(function (key) {\n      material[key] = data[key];\n    });\n  }\n});\n\n/**\n * Builds and normalize material data, normalizing stuff along the way.\n *\n * @param {object} data - Material data.\n * @returns {object} data - Processed material data.\n */\nfunction getMaterialData (data) {\n  return {\n    fog: data.fog,\n    color: new THREE.Color(data.color),\n    wireframe: data.wireframe,\n    wireframeLinewidth: data.wireframeLinewidth\n  };\n}\n","var registerShader = require('../core/shader').registerShader;\nvar THREE = require('../lib/three');\nvar utils = require('../utils/');\n\nvar CubeLoader = new THREE.CubeTextureLoader();\nvar texturePromises = {};\n\n/**\n * Standard (physically-based) shader using THREE.MeshStandardMaterial.\n */\nmodule.exports.Component = registerShader('standard', {\n  schema: {\n    ambientOcclusionMap: {default: ''},\n    ambientOcclusionMapIntensity: {default: 1},\n    ambientOcclusionTextureOffset: {default: ''},\n    ambientOcclusionTextureRepeat: {default: ''},\n\n    color: {type: 'color'},\n\n    displacementMap: {default: ''},\n    displacementScale: {default: 1},\n    displacementBias: {default: 0.5},\n    displacementTextureOffset: {default: ''},\n    displacementTextureRepeat: {default: ''},\n    envMap: {default: ''},\n\n    fog: {default: true},\n    height: {default: 256},\n    metalness: {default: 0.0, min: 0.0, max: 1.0},\n\n    normalMap: {default: ''},\n    normalScale: {type: 'vec2', default: '1 1'},\n    normalTextureOffset: {default: ''},\n    normalTextureRepeat: {default: ''},\n\n    repeat: {default: ''},\n    roughness: {default: 0.5, min: 0.0, max: 1.0},\n    sphericalEnvMap: {default: ''},\n    src: {default: ''},\n    width: {default: 512},\n    wireframe: {default: false},\n    wireframeLinewidth: {default: 2}\n  },\n\n  /**\n   * Initializes the shader.\n   * Adds a reference from the scene to this entity as the camera.\n   */\n  init: function (data) {\n    this.material = new THREE.MeshStandardMaterial(getMaterialData(data));\n    utils.material.updateMap(this, data);\n    if (data.normalMap) { utils.material.updateDistortionMap('normal', this, data); }\n    if (data.displacementMap) { utils.material.updateDistortionMap('displacement', this, data); }\n    if (data.ambientOcclusionMap) { utils.material.updateDistortionMap('ambientOcclusion', this, data); }\n    this.updateEnvMap(data);\n  },\n\n  update: function (data) {\n    this.updateMaterial(data);\n    utils.material.updateMap(this, data);\n    if (data.normalMap) { utils.material.updateDistortionMap('normal', this, data); }\n    if (data.displacementMap) { utils.material.updateDistortionMap('displacement', this, data); }\n    if (data.ambientOcclusionMap) { utils.material.updateDistortionMap('ambientOcclusion', this, data); }\n    this.updateEnvMap(data);\n  },\n\n  /**\n   * Updating existing material.\n   *\n   * @param {object} data - Material component data.\n   * @returns {object} Material.\n   */\n  updateMaterial: function (data) {\n    var material = this.material;\n    data = getMaterialData(data);\n    Object.keys(data).forEach(function (key) {\n      material[key] = data[key];\n    });\n  },\n\n  /**\n   * Handle environment cubemap. Textures are cached in texturePromises.\n   */\n  updateEnvMap: function (data) {\n    var self = this;\n    var material = this.material;\n    var envMap = data.envMap;\n    var sphericalEnvMap = data.sphericalEnvMap;\n\n    // No envMap defined or already loading.\n    if ((!envMap && !sphericalEnvMap) || this.isLoadingEnvMap) {\n      material.envMap = null;\n      material.needsUpdate = true;\n      return;\n    }\n    this.isLoadingEnvMap = true;\n\n    // if a spherical env map is defined then use it.\n    if (sphericalEnvMap) {\n      this.el.sceneEl.systems.material.loadTexture(sphericalEnvMap, { src: sphericalEnvMap }, function textureLoaded (texture) {\n        self.isLoadingEnvMap = false;\n        texture.mapping = THREE.SphericalReflectionMapping;\n        material.envMap = texture;\n        utils.material.handleTextureEvents(self.el, texture);\n        material.needsUpdate = true;\n      });\n      return;\n    }\n\n    // Another material is already loading this texture. Wait on promise.\n    if (texturePromises[envMap]) {\n      texturePromises[envMap].then(function (cube) {\n        self.isLoadingEnvMap = false;\n        material.envMap = cube;\n        utils.material.handleTextureEvents(self.el, cube);\n        material.needsUpdate = true;\n      });\n      return;\n    }\n\n    // Material is first to load this texture. Load and resolve texture.\n    texturePromises[envMap] = new Promise(function (resolve) {\n      utils.srcLoader.validateCubemapSrc(envMap, function loadEnvMap (urls) {\n        CubeLoader.load(urls, function (cube) {\n          // Texture loaded.\n          self.isLoadingEnvMap = false;\n          material.envMap = cube;\n          utils.material.handleTextureEvents(self.el, cube);\n          resolve(cube);\n        });\n      });\n    });\n  }\n});\n\n/**\n * Builds and normalize material data, normalizing stuff along the way.\n *\n * @param {object} data - Material data.\n * @returns {object} data - Processed material data.\n */\nfunction getMaterialData (data) {\n  var newData = {\n    color: new THREE.Color(data.color),\n    fog: data.fog,\n    metalness: data.metalness,\n    roughness: data.roughness,\n    wireframe: data.wireframe,\n    wireframeLinewidth: data.wireframeLinewidth\n  };\n\n  if (data.normalMap) { newData.normalScale = data.normalScale; }\n\n  if (data.ambientOcclusionMap) { newData.aoMapIntensity = data.ambientOcclusionMapIntensity; }\n\n  if (data.displacementMap) {\n    newData.displacementScale = data.displacementScale;\n    newData.displacementBias = data.displacementBias;\n  }\n\n  return newData;\n}\n","var bind = require('../utils/bind');\nvar constants = require('../constants/');\nvar registerSystem = require('../core/system').registerSystem;\n\nvar DEFAULT_CAMERA_ATTR = 'data-aframe-default-camera';\n\n/**\n * Camera system. Manages which camera is active among multiple cameras in scene.\n *\n * @member {object} activeCameraEl - Active camera entity.\n */\nmodule.exports.System = registerSystem('camera', {\n  init: function () {\n    this.activeCameraEl = null;\n    // Wait for all entities to fully load before checking for existence of camera.\n    // Since entities wait for <a-assets> to load, any cameras attaching to the scene\n    // will do so asynchronously.\n    this.sceneEl.addEventListener('loaded', bind(this.setupDefaultCamera, this));\n  },\n\n  /**\n   * Create a default camera if user has not added one during the initial scene traversal.\n   *\n   * Default camera offset height is at average eye level (~1.6m).\n   */\n  setupDefaultCamera: function () {\n    var sceneEl = this.sceneEl;\n    var defaultCameraEl;\n\n    // Camera already defined.\n    if (sceneEl.camera) {\n      sceneEl.emit('camera-ready', {cameraEl: sceneEl.camera.el});\n      return;\n    }\n\n    // Set up default camera.\n    defaultCameraEl = document.createElement('a-entity');\n    defaultCameraEl.setAttribute('position', '0 0 0');\n    defaultCameraEl.setAttribute(DEFAULT_CAMERA_ATTR, '');\n    defaultCameraEl.setAttribute('camera', {active: true, userHeight: constants.DEFAULT_CAMERA_HEIGHT});\n    defaultCameraEl.setAttribute('wasd-controls', '');\n    defaultCameraEl.setAttribute('look-controls', '');\n    defaultCameraEl.setAttribute(constants.AFRAME_INJECTED, '');\n    sceneEl.appendChild(defaultCameraEl);\n    sceneEl.addEventListener('enter-vr', this.removeDefaultOffset);\n    sceneEl.addEventListener('exit-vr', this.addDefaultOffset);\n    sceneEl.emit('camera-ready', {cameraEl: defaultCameraEl});\n  },\n\n  /**\n   * Set a different active camera.\n   * When we choose a (sort of) random scene camera as the replacement, set its `active` to\n   * true. The camera component will call `setActiveCamera` and handle passing the torch to\n   * the new camera.\n   */\n  disableActiveCamera: function () {\n    var cameraEls = this.sceneEl.querySelectorAll('[camera]');\n    var newActiveCameraEl = cameraEls[cameraEls.length - 1];\n    newActiveCameraEl.setAttribute('camera', 'active', true);\n  },\n\n  /**\n   * Set active camera to be used by renderer.\n   * Removes the default camera (if present).\n   * Disables all other cameras in the scene.\n   *\n   * @param {Element} newCameraEl - Entity with camera component.\n   */\n  setActiveCamera: function (newCameraEl) {\n    var cameraEl;\n    var cameraEls;\n    var i;\n    var newCamera;\n    var previousCamera = this.activeCameraEl;\n    var sceneEl = this.sceneEl;\n\n    // Same camera.\n    newCamera = newCameraEl.getObject3D('camera');\n    if (!newCamera || newCameraEl === this.activeCameraEl) { return; }\n\n    // Grab the default camera.\n    var defaultCameraWrapper = sceneEl.querySelector('[' + DEFAULT_CAMERA_ATTR + ']');\n    var defaultCameraEl = defaultCameraWrapper &&\n                          defaultCameraWrapper.querySelector('[camera]');\n\n    // Remove default camera if new camera is not the default camera.\n    if (newCameraEl !== defaultCameraEl) { removeDefaultCamera(sceneEl); }\n\n    // Make new camera active.\n    this.activeCameraEl = newCameraEl;\n    this.activeCameraEl.play();\n    sceneEl.camera = newCamera;\n\n    // Disable current camera\n    if (previousCamera) {\n      previousCamera.setAttribute('camera', 'active', false);\n    }\n\n    // Disable other cameras in the scene\n    cameraEls = sceneEl.querySelectorAll('[camera]');\n    for (i = 0; i < cameraEls.length; i++) {\n      cameraEl = cameraEls[i];\n      if (newCameraEl === cameraEl) { continue; }\n      cameraEl.setAttribute('camera', 'active', false);\n      cameraEl.pause();\n    }\n    sceneEl.emit('camera-set-active', {cameraEl: newCameraEl});\n  }\n});\n\n/**\n * Remove injected default camera from scene, if present.\n *\n * @param {Element} sceneEl\n */\nfunction removeDefaultCamera (sceneEl) {\n  var defaultCamera;\n  var camera = sceneEl.camera;\n  if (!camera) { return; }\n\n  // Remove default camera if present.\n  defaultCamera = sceneEl.querySelector('[' + DEFAULT_CAMERA_ATTR + ']');\n  if (!defaultCamera) { return; }\n  sceneEl.removeChild(defaultCamera);\n}\n","var geometries = require('../core/geometry').geometries;\nvar registerSystem = require('../core/system').registerSystem;\nvar THREE = require('../lib/three');\n\n/**\n * System for geometry component.\n * Handle geometry caching.\n *\n * @member {object} cache - Mapping of stringified component data to THREE.Geometry objects.\n * @member {object} cacheCount - Keep track of number of entities using a geometry to\n *         know whether to dispose on removal.\n */\nmodule.exports.System = registerSystem('geometry', {\n  init: function () {\n    this.cache = {};\n    this.cacheCount = {};\n  },\n\n  /**\n   * Reset cache. Mainly for testing.\n   */\n  clearCache: function () {\n    this.cache = {};\n    this.cacheCount = {};\n  },\n\n  /**\n   * Attempt to retrieve from cache.\n   *\n   * @returns {Object|null} A geometry if it exists, else null.\n   */\n  getOrCreateGeometry: function (data) {\n    var cache = this.cache;\n    var cachedGeometry;\n    var hash;\n\n    // Skip all caching logic.\n    if (data.skipCache) { return createGeometry(data); }\n\n    // Try to retrieve from cache first.\n    hash = this.hash(data);\n    cachedGeometry = cache[hash];\n    incrementCacheCount(this.cacheCount, hash);\n\n    if (cachedGeometry) { return cachedGeometry; }\n\n    // Create geometry.\n    cachedGeometry = createGeometry(data);\n\n    // Cache and return geometry.\n    cache[hash] = cachedGeometry;\n    return cachedGeometry;\n  },\n\n  /**\n   * Let system know that an entity is no longer using a geometry.\n   */\n  unuseGeometry: function (data) {\n    var cache = this.cache;\n    var cacheCount = this.cacheCount;\n    var geometry;\n    var hash;\n\n    if (data.skipCache) { return; }\n\n    hash = this.hash(data);\n\n    if (!cache[hash]) { return; }\n\n    decrementCacheCount(cacheCount, hash);\n\n    // Another entity is still using this geometry. No need to do anything.\n    if (cacheCount[hash] > 0) { return; }\n\n    // No more entities are using this geometry. Dispose.\n    geometry = cache[hash];\n    geometry.dispose();\n    delete cache[hash];\n    delete cacheCount[hash];\n  },\n\n  /**\n   * Use JSON.stringify to turn component data into hash.\n   * Should be deterministic within a single browser engine.\n   * If not, then look into json-stable-stringify.\n   */\n  hash: function (data) {\n    return JSON.stringify(data);\n  }\n});\n\n/**\n * Create geometry using component data.\n *\n * @param {object} data - Component data.\n * @returns {object} Geometry.\n */\nfunction createGeometry (data) {\n  var geometryType = data.primitive;\n  var GeometryClass = geometries[geometryType] && geometries[geometryType].Geometry;\n  var geometryInstance = new GeometryClass();\n\n  if (!GeometryClass) { throw new Error('Unknown geometry `' + geometryType + '`'); }\n\n  geometryInstance.init(data);\n  return toBufferGeometry(geometryInstance.geometry, data.buffer);\n}\n\n/**\n * Decreate count of entity using a geometry.\n */\nfunction decrementCacheCount (cacheCount, hash) {\n  cacheCount[hash]--;\n}\n\n/**\n * Increase count of entity using a geometry.\n */\nfunction incrementCacheCount (cacheCount, hash) {\n  cacheCount[hash] = cacheCount[hash] === undefined ? 1 : cacheCount[hash] + 1;\n}\n\n/**\n * Transform geometry to BufferGeometry if `doBuffer`.\n *\n * @param {object} geometry\n * @param {boolean} doBuffer\n * @returns {object} Geometry.\n */\nfunction toBufferGeometry (geometry, doBuffer) {\n  var bufferGeometry;\n  if (!doBuffer) { return geometry; }\n\n  bufferGeometry = new THREE.BufferGeometry().fromGeometry(geometry);\n  bufferGeometry.metadata = {type: geometry.type, parameters: geometry.parameters || {}};\n  geometry.dispose();  // Dispose no longer needed non-buffer geometry.\n  return bufferGeometry;\n}\n","var registerSystem = require('../core/system').registerSystem;\nvar bind = require('../utils/bind');\nvar constants = require('../constants/');\n\nvar DEFAULT_LIGHT_ATTR = 'data-aframe-default-light';\n\n/**\n * Light system.\n *\n * Prescribes default lighting if not specified (one ambient, one directional).\n * Removes default lighting from the scene when a new light is added.\n *\n * @param {bool} defaultLights - Whether default lighting are defined.\n * @param {bool} userDefinedLights - Whether user lighting is defined.\n */\nmodule.exports.System = registerSystem('light', {\n  init: function () {\n    this.defaultLights = false;\n    this.userDefinedLights = false;\n    // Wait for all entities to fully load before checking for existence of lights.\n    // Since entities wait for <a-assets> to load, any lights attaching to the scene\n    // will do so asynchronously.\n    this.sceneEl.addEventListener('loaded', bind(this.setupDefaultLights, this));\n  },\n\n  /**\n   * Notify scene that light has been added and to remove the default.\n   *\n   * @param {object} el - element holding the light component.\n   */\n  registerLight: function (el) {\n    if (!el.hasAttribute(DEFAULT_LIGHT_ATTR)) {\n      // User added a light, remove default lights through DOM.\n      this.removeDefaultLights();\n      this.userDefinedLights = true;\n    }\n  },\n\n  removeDefaultLights: function () {\n    var defaultLights;\n    var sceneEl = this.sceneEl;\n\n    if (!this.defaultLights) { return; }\n    defaultLights = document.querySelectorAll('[' + DEFAULT_LIGHT_ATTR + ']');\n    for (var i = 0; i < defaultLights.length; i++) {\n      sceneEl.removeChild(defaultLights[i]);\n    }\n    this.defaultLights = false;\n  },\n\n  /**\n   * Prescibe default lights to the scene.\n   * Does so by injecting markup such that this state is not invisible.\n   * These lights are removed if the user adds any lights.\n   */\n  setupDefaultLights: function () {\n    var sceneEl = this.sceneEl;\n    var ambientLight;\n    var directionalLight;\n\n    if (this.userDefinedLights || this.defaultLights) { return; }\n    ambientLight = document.createElement('a-entity');\n    directionalLight = document.createElement('a-entity');\n    ambientLight.setAttribute('light', {color: '#BBB', type: 'ambient'});\n    ambientLight.setAttribute(DEFAULT_LIGHT_ATTR, '');\n    ambientLight.setAttribute(constants.AFRAME_INJECTED, '');\n    sceneEl.appendChild(ambientLight);\n\n    directionalLight.setAttribute('light', {color: '#FFF', intensity: 0.6});\n    directionalLight.setAttribute('position', {x: -0.5, y: 1, z: 1});\n    directionalLight.setAttribute(DEFAULT_LIGHT_ATTR, '');\n    directionalLight.setAttribute(constants.AFRAME_INJECTED, '');\n    sceneEl.appendChild(directionalLight);\n\n    this.defaultLights = true;\n  }\n});\n","var registerSystem = require('../core/system').registerSystem;\nvar THREE = require('../lib/three');\nvar utils = require('../utils/');\n\nvar debug = utils.debug;\nvar error = debug('components:texture:error');\nvar TextureLoader = new THREE.TextureLoader();\nvar warn = debug('components:texture:warn');\n\n/**\n * System for material component.\n * Handle material registration, updates (for fog), and texture caching.\n *\n * @member materials {object} - Registered materials.\n * @member textureCache {object} - Texture cache for:\n *   - Images: textureCache has mapping of src -> repeat -> cached three.js texture.\n *   - Videos: textureCache has mapping of videoElement -> cached three.js texture.\n */\nmodule.exports.System = registerSystem('material', {\n  init: function () {\n    this.materials = {};\n    this.textureCache = {};\n  },\n\n  clearTextureCache: function () {\n    this.textureCache = {};\n  },\n\n  /**\n   * Determine whether `src` is a image or video. Then try to load the asset, then call back.\n   *\n   * @param {string} src - Texture URL.\n   * @param {string} data - Relevant texture data used for caching.\n   * @param {function} cb - Callback to pass texture to.\n   */\n  loadTexture: function (src, data, cb) {\n    var self = this;\n    utils.srcLoader.validateSrc(src, loadImageCb, loadVideoCb, loadCanvasCb);\n    function loadImageCb (src) { self.loadImage(src, data, cb); }\n    function loadVideoCb (src) { self.loadVideo(src, data, cb); }\n    function loadCanvasCb (src) { self.loadCanvas(src, data, cb); }\n  },\n\n  /**\n   * High-level function for loading image textures (THREE.Texture).\n   *\n   * @param {Element|string} src - Texture source.\n   * @param {object} data - Texture data.\n   * @param {function} cb - Callback to pass texture to.\n   */\n  loadImage: function (src, data, cb) {\n    var hash = this.hash(data);\n    var handleImageTextureLoaded = cb;\n    var textureCache = this.textureCache;\n\n    // Texture already being loaded or already loaded. Wait on promise.\n    if (textureCache[hash]) {\n      textureCache[hash].then(handleImageTextureLoaded);\n      return;\n    }\n\n    // Texture not yet being loaded. Start loading it.\n    textureCache[hash] = loadImageTexture(src, data);\n    textureCache[hash].then(handleImageTextureLoaded);\n  },\n\n  /**\n   * High-level function for loading canvas textures (THREE.Texture).\n   *\n   * @param {Element|string} src - Texture source.\n   * @param {object} data - Texture data.\n   * @param {function} cb - Callback to pass texture to.\n   */\n  loadCanvas: function (src, data, cb) {\n    // Hack readyState and HAVE_CURRENT_DATA on canvas to work with THREE.VideoTexture\n    src.readyState = 2;\n    src.HAVE_CURRENT_DATA = 2;\n    this.loadVideo(src, data, cb);\n  },\n\n    /**\n   * Load video texture (THREE.VideoTexture).\n   * Which is just an image texture that RAFs + needsUpdate.\n   * Note that creating a video texture is synchronous unlike loading an image texture.\n   * Made asynchronous to be consistent with image textures.\n   *\n   * @param {Element|string} src - Texture source.\n   * @param {object} data - Texture data.\n   * @param {function} cb - Callback to pass texture to.\n   */\n  loadVideo: function (src, data, cb) {\n    var hash;\n    var texture;\n    var textureCache = this.textureCache;\n    var videoEl;\n    var videoTextureResult;\n\n    function handleVideoTextureLoaded (result) {\n      result.texture.needsUpdate = true;\n      cb(result.texture, result.videoEl);\n    }\n\n    // Video element provided.\n    if (typeof src !== 'string') {\n      // Check cache before creating texture.\n      videoEl = src;\n      hash = this.hashVideo(data, videoEl);\n      if (textureCache[hash]) {\n        textureCache[hash].then(handleVideoTextureLoaded);\n        return;\n      }\n      // If not in cache, fix up the attributes then start to create the texture.\n      fixVideoAttributes(videoEl);\n    }\n\n    // Only URL provided. Use video element to create texture.\n    videoEl = videoEl || createVideoEl(src, data.width, data.height);\n\n    // Generated video element already cached. Use that.\n    hash = this.hashVideo(data, videoEl);\n    if (textureCache[hash]) {\n      textureCache[hash].then(handleVideoTextureLoaded);\n      return;\n    }\n\n    // Create new video texture.\n    texture = new THREE.VideoTexture(videoEl);\n    texture.minFilter = THREE.LinearFilter;\n    setTextureProperties(texture, data);\n\n    // Cache as promise to be consistent with image texture caching.\n    videoTextureResult = {texture: texture, videoEl: videoEl};\n    textureCache[hash] = Promise.resolve(videoTextureResult);\n    handleVideoTextureLoaded(videoTextureResult);\n  },\n\n  hash: function (data) {\n    return JSON.stringify(data);\n  },\n\n  hashVideo: function (data, videoEl) {\n    return calculateVideoCacheHash(data, videoEl);\n  },\n\n  /**\n   * Keep track of material in case an update trigger is needed (e.g., fog).\n   *\n   * @param {object} material\n   */\n  registerMaterial: function (material) {\n    this.materials[material.uuid] = material;\n  },\n\n  /**\n   * Stop tracking material.\n   *\n   * @param {object} material\n   */\n  unregisterMaterial: function (material) {\n    delete this.materials[material.uuid];\n  },\n\n  /**\n   * Trigger update to all registered materials.\n   */\n  updateMaterials: function (material) {\n    var materials = this.materials;\n    Object.keys(materials).forEach(function (uuid) {\n      materials[uuid].needsUpdate = true;\n    });\n  }\n});\n\n/**\n * Calculates consistent hash from a video element using its attributes.\n * If the video element has an ID, use that.\n * Else build a hash that looks like `src:myvideo.mp4;height:200;width:400;`.\n *\n * @param data {object} - Texture data such as repeat.\n * @param videoEl {Element} - Video element.\n * @returns {string}\n */\nfunction calculateVideoCacheHash (data, videoEl) {\n  var i;\n  var id = videoEl.getAttribute('id');\n  var hash;\n  var videoAttributes;\n\n  if (id) { return id; }\n\n  // Calculate hash using sorted video attributes.\n  hash = '';\n  videoAttributes = data || {};\n  for (i = 0; i < videoEl.attributes.length; i++) {\n    videoAttributes[videoEl.attributes[i].name] = videoEl.attributes[i].value;\n  }\n  Object.keys(videoAttributes).sort().forEach(function (name) {\n    hash += name + ':' + videoAttributes[name] + ';';\n  });\n\n  return hash;\n}\n\n/**\n * Load image texture.\n *\n * @private\n * @param {string|object} src - An <img> element or url to an image file.\n * @param {object} data - Data to set texture properties like `repeat`.\n * @returns {Promise} Resolves once texture is loaded.\n */\nfunction loadImageTexture (src, data) {\n  return new Promise(doLoadImageTexture);\n\n  function doLoadImageTexture (resolve, reject) {\n    var isEl = typeof src !== 'string';\n\n    function resolveTexture (texture) {\n      setTextureProperties(texture, data);\n      texture.needsUpdate = true;\n      resolve(texture);\n    }\n\n    // Create texture from an element.\n    if (isEl) {\n      resolveTexture(new THREE.Texture(src));\n      return;\n    }\n\n    // Load texture from src string. THREE will create underlying element.\n    // Use THREE.TextureLoader (src, onLoad, onProgress, onError) to load texture.\n    TextureLoader.load(\n      src,\n      resolveTexture,\n      function () { /* no-op */ },\n      function (xhr) {\n        error('`$s` could not be fetched (Error code: %s; Response: %s)', xhr.status,\n              xhr.statusText);\n      }\n    );\n  }\n}\n\n/**\n * Set texture properties such as repeat.\n *\n * @param {object} data - With keys like `repeat`.\n */\nfunction setTextureProperties (texture, data) {\n  // Handle UV repeat.\n  var repeat = data.repeat || '1 1';\n  var repeatXY = repeat.split(' ');\n\n  // Don't bother setting repeat if it is 1/1. Power-of-two is required to repeat.\n  if (repeat === '1 1' || repeatXY.length !== 2) { return; }\n\n  texture.wrapS = THREE.RepeatWrapping;\n  texture.wrapT = THREE.RepeatWrapping;\n  texture.repeat.set(parseFloat(repeatXY[0]), parseFloat(repeatXY[1]));\n\n  // Handle UV offset.\n  var offset = data.offset || '0 0';\n  var offsetXY = offset.split(' ');\n\n  // Don't bother setting offset if it is 0/0.\n  if (offset === '0 0' || offsetXY.length !== 2) { return; }\n  texture.offset.set(parseFloat(offsetXY[0]), parseFloat(offsetXY[1]));\n}\n\n/**\n * Create video element to be used as a texture.\n *\n * @param {string} src - Url to a video file.\n * @param {number} width - Width of the video.\n * @param {number} height - Height of the video.\n * @returns {Element} Video element.\n */\nfunction createVideoEl (src, width, height) {\n  var videoEl = document.createElement('video');\n  videoEl.width = width;\n  videoEl.height = height;\n  videoEl.setAttribute('webkit-playsinline', '');  // Support inline videos for iOS webviews.\n  videoEl.autoplay = true;\n  videoEl.loop = true;\n  videoEl.crossOrigin = 'anonymous';\n  videoEl.addEventListener('error', function () {\n    warn('`$s` is not a valid video', src);\n  }, true);\n  videoEl.src = src;\n  return videoEl;\n}\n\n/**\n * Fixes a video element's attributes to prevent developers from accidentally passing the\n * wrong attribute values to commonly misused video attributes.\n *\n * <video> does not treat `autoplay`, `controls`, `crossorigin`, `loop`, and `preload` as\n * as booleans. Existence of those attributes will mean truthy.\n *\n * For example, translates <video loop=\"false\"> to <video>.\n *\n * @see https://developer.mozilla.org/docs/Web/HTML/Element/video#Attributes\n * @param {Element} videoEl - Video element.\n * @returns {Element} Video element with the correct properties updated.\n */\nfunction fixVideoAttributes (videoEl) {\n  videoEl.autoplay = videoEl.getAttribute('autoplay') !== 'false';\n  videoEl.controls = videoEl.getAttribute('controls') !== 'false';\n  if (videoEl.getAttribute('loop') === 'false') {\n    videoEl.removeAttribute('loop');\n  }\n  if (videoEl.getAttribute('preload') === 'false') {\n    videoEl.preload = 'none';\n  }\n  videoEl.crossOrigin = videoEl.crossOrigin || 'anonymous';\n  // To support inline videos in iOS webviews.\n  videoEl.setAttribute('webkit-playsinline', '');\n  return videoEl;\n}\n","var registerSystem = require('../core/system').registerSystem;\n\n/**\n * Tracked controls system.\n * It maintains a list with the available tracked controllers\n */\nmodule.exports.System = registerSystem('tracked-controls', {\n  init: function () {\n    var self = this;\n    this.controllers = [];\n    if (!navigator.getVRDisplays) { return; }\n    navigator.getVRDisplays().then(function (displays) {\n      if (displays.length > 0) {\n        self.vrDisplay = displays[0];\n      }\n    });\n  },\n\n  tick: function () {\n    var gamepads = navigator.getGamepads && navigator.getGamepads();\n    var gamepad;\n    var controllers = this.controllers = [];\n    var i;\n    if (!gamepads) { return; }\n    for (i = 0; i < gamepads.length; ++i) {\n      gamepad = gamepads[i];\n      if (gamepad && gamepad.pose) { controllers.push(gamepad); }\n    }\n  }\n});\n","/**\n * Animation configuration options for TWEEN.js animations.\n * Used by `<a-animation>`.\n */\nvar TWEEN = require('tween.js');\n\nvar DIRECTIONS = {\n  alternate: 'alternate',\n  alternateReverse: 'alternate-reverse',\n  normal: 'normal',\n  reverse: 'reverse'\n};\n\nvar EASING_FUNCTIONS = {\n  'linear': TWEEN.Easing.Linear.None,\n\n  'ease': TWEEN.Easing.Cubic.InOut,\n  'ease-in': TWEEN.Easing.Cubic.In,\n  'ease-out': TWEEN.Easing.Cubic.Out,\n  'ease-in-out': TWEEN.Easing.Cubic.InOut,\n\n  'ease-cubic': TWEEN.Easing.Cubic.In,\n  'ease-in-cubic': TWEEN.Easing.Cubic.In,\n  'ease-out-cubic': TWEEN.Easing.Cubic.Out,\n  'ease-in-out-cubic': TWEEN.Easing.Cubic.InOut,\n\n  'ease-quad': TWEEN.Easing.Quadratic.InOut,\n  'ease-in-quad': TWEEN.Easing.Quadratic.In,\n  'ease-out-quad': TWEEN.Easing.Quadratic.Out,\n  'ease-in-out-quad': TWEEN.Easing.Quadratic.InOut,\n\n  'ease-quart': TWEEN.Easing.Quartic.InOut,\n  'ease-in-quart': TWEEN.Easing.Quartic.In,\n  'ease-out-quart': TWEEN.Easing.Quartic.Out,\n  'ease-in-out-quart': TWEEN.Easing.Quartic.InOut,\n\n  'ease-quint': TWEEN.Easing.Quintic.InOut,\n  'ease-in-quint': TWEEN.Easing.Quintic.In,\n  'ease-out-quint': TWEEN.Easing.Quintic.Out,\n  'ease-in-out-quint': TWEEN.Easing.Quintic.InOut,\n\n  'ease-sine': TWEEN.Easing.Sinusoidal.InOut,\n  'ease-in-sine': TWEEN.Easing.Sinusoidal.In,\n  'ease-out-sine': TWEEN.Easing.Sinusoidal.Out,\n  'ease-in-out-sine': TWEEN.Easing.Sinusoidal.InOut,\n\n  'ease-expo': TWEEN.Easing.Exponential.InOut,\n  'ease-in-expo': TWEEN.Easing.Exponential.In,\n  'ease-out-expo': TWEEN.Easing.Exponential.Out,\n  'ease-in-out-expo': TWEEN.Easing.Exponential.InOut,\n\n  'ease-circ': TWEEN.Easing.Circular.InOut,\n  'ease-in-circ': TWEEN.Easing.Circular.In,\n  'ease-out-circ': TWEEN.Easing.Circular.Out,\n  'ease-in-out-circ': TWEEN.Easing.Circular.InOut,\n\n  'ease-elastic': TWEEN.Easing.Elastic.InOut,\n  'ease-in-elastic': TWEEN.Easing.Elastic.In,\n  'ease-out-elastic': TWEEN.Easing.Elastic.Out,\n  'ease-in-out-elastic': TWEEN.Easing.Elastic.InOut,\n\n  'ease-back': TWEEN.Easing.Back.InOut,\n  'ease-in-back': TWEEN.Easing.Back.In,\n  'ease-out-back': TWEEN.Easing.Back.Out,\n  'ease-in-out-back': TWEEN.Easing.Back.InOut,\n\n  'ease-bounce': TWEEN.Easing.Bounce.InOut,\n  'ease-in-bounce': TWEEN.Easing.Bounce.In,\n  'ease-out-bounce': TWEEN.Easing.Bounce.Out,\n  'ease-in-out-bounce': TWEEN.Easing.Bounce.InOut\n};\n\nvar FILLS = {\n  backwards: 'backwards',\n  both: 'both',\n  forwards: 'forwards',\n  none: 'none'\n};\n\nvar REPEATS = {\n  indefinite: 'indefinite'\n};\n\nvar DEFAULTS = {\n  attribute: 'rotation',\n  begin: '',\n  end: '',\n  delay: 0,\n  dur: 1000,\n  easing: 'ease',\n  direction: DIRECTIONS.normal,\n  fill: FILLS.forwards,\n  from: undefined,\n  repeat: 0,\n  to: undefined\n};\n\nmodule.exports.defaults = DEFAULTS;\nmodule.exports.directions = DIRECTIONS;\nmodule.exports.easingFunctions = EASING_FUNCTIONS;\nmodule.exports.fills = FILLS;\nmodule.exports.repeats = REPEATS;\n","/**\n * Faster version of Function.prototype.bind\n * @param {Function} fn - Function to wrap.\n * @param {Object} ctx - What to bind as context.\n * @param {...*} arguments - Arguments to pass through.\n */\nmodule.exports = function bind (fn, ctx/* , arg1, arg2 */) {\n  return (function (prependedArgs) {\n    return function bound () {\n      // Concat the bound function arguments with those passed to original bind\n      var args = prependedArgs.concat(Array.prototype.slice.call(arguments, 0));\n      return fn.apply(ctx, args);\n    };\n  })(Array.prototype.slice.call(arguments, 2));\n};\n","var debugLib = require('debug');\nvar extend = require('object-assign');\n\nvar settings = {\n  colors: {\n    debug: 'gray',\n    error: 'red',\n    info: 'gray',\n    warn: 'orange'\n  }\n};\n\n/**\n * Monkeypatches `debug` so we can colorize error/warning messages.\n *\n * (See issue: https://github.com/visionmedia/debug/issues/137)\n */\nvar debug = function (namespace) {\n  var d = debugLib(namespace);\n\n  d.color = getDebugNamespaceColor(namespace);\n\n  return d;\n};\nextend(debug, debugLib);\n\n/**\n * Returns the type of the namespace (e.g., `error`, `warn`).\n *\n * @param {String} namespace\n *   The debug logger's namespace (e.g., `components:geometry:warn`).\n * @returns {String} The type of the namespace (e.g., `warn`).\n * @api private\n */\nfunction getDebugNamespaceType (namespace) {\n  var chunks = namespace.split(':');\n\n  return chunks[chunks.length - 1];  // Return the last one\n}\n\n/**\n * Returns the color of the namespace (e.g., `orange`).\n *\n * @param {String} namespace\n *   The debug logger's namespace (e.g., `components:geometry:warn`).\n * @returns {String} The color of the namespace (e.g., `orange`).\n * @api private\n */\nfunction getDebugNamespaceColor (namespace) {\n  var type = getDebugNamespaceType(namespace);\n\n  var color = settings.colors && settings.colors[type];\n\n  return color || null;\n}\n\n/**\n * Returns `localStorage` if possible.\n *\n * This is necessary because Safari throws when a user disables\n * cookies or `localStorage` and you attempt to access it.\n *\n * @returns {localStorage}\n * @api private\n */\nfunction storage () {\n  try {\n    return window.localStorage;\n  } catch (e) {\n  }\n}\n\n/**\n * To enable console logging, type this in the Console of your Dev Tools:\n *\n *   localStorage.logs = 1\n *\n * To disable console logging:\n *\n *   localStorage.logs = 0\n *\n */\nvar ls = storage();\nif (ls && (parseInt(ls.logs, 10) || ls.logs === 'true')) {\n  debug.enable('*');\n} else {\n  debug.enable('*:error,*:info,*:warn');\n}\n\nif (process.browser) { window.logs = debug; }\n\nmodule.exports = debug;\n","var coordinates = require('../utils/coordinates');\nvar debug = require('debug');\n\nvar error = debug('core:propertyTypes:warn');\nvar warn = debug('core:propertyTypes:warn');\n\nvar propertyTypes = module.exports.propertyTypes = {};\n\n// Built-in property types.\nregisterPropertyType('array', [], arrayParse, arrayStringify);\nregisterPropertyType('boolean', false, boolParse);\nregisterPropertyType('color', '#FFF', defaultParse, defaultStringify);\nregisterPropertyType('int', 0, intParse);\nregisterPropertyType('number', 0, numberParse);\nregisterPropertyType('selector', '', selectorParse, selectorStringify);\nregisterPropertyType('selectorAll', '', selectorAllParse, selectorAllStringify);\nregisterPropertyType('src', '', srcParse);\nregisterPropertyType('string', '', defaultParse, defaultStringify);\nregisterPropertyType('time', 0, intParse);\nregisterPropertyType('vec2', {x: 0, y: 0}, vecParse, coordinates.stringify);\nregisterPropertyType('vec3', {x: 0, y: 0, z: 0}, vecParse, coordinates.stringify);\nregisterPropertyType('vec4', {x: 0, y: 0, z: 0, w: 0}, vecParse, coordinates.stringify);\n\n/**\n * Register a parser for re-use such that when someone uses `type` in the schema,\n * `schema.process` will set the property `parse` and `stringify`.\n *\n * @param {string} type - Type name.\n * @param [defaultValue=null] -\n *   Default value to use if component does not define default value.\n * @param {function} [parse=defaultParse] - Parse string function.\n * @param {function} [stringify=defaultStringify] - Stringify to DOM function.\n */\nfunction registerPropertyType (type, defaultValue, parse, stringify) {\n  if ('type' in propertyTypes) {\n    error('Property type ' + type + ' is already registered.');\n    return;\n  }\n\n  propertyTypes[type] = {\n    default: defaultValue,\n    parse: parse || defaultParse,\n    stringify: stringify || defaultStringify\n  };\n}\nmodule.exports.registerPropertyType = registerPropertyType;\n\nfunction arrayParse (value) {\n  if (Array.isArray(value)) { return value; }\n  if (!value || typeof value !== 'string') { return []; }\n  return value.split(',').map(trim);\n  function trim (str) { return str.trim(); }\n}\n\nfunction arrayStringify (value) {\n  return value.join(', ');\n}\n\nfunction defaultParse (value) {\n  return value;\n}\n\nfunction defaultStringify (value) {\n  if (value === null) { return 'null'; }\n  return value.toString();\n}\n\nfunction boolParse (value) {\n  return value !== 'false' && value !== false;\n}\n\nfunction intParse (value) {\n  return parseInt(value, 10);\n}\n\nfunction numberParse (value) {\n  return parseFloat(value, 10);\n}\n\nfunction selectorParse (value) {\n  if (!value) { return null; }\n  if (typeof value !== 'string') { return value; }\n  return document.querySelector(value);\n}\n\nfunction selectorAllParse (value) {\n  if (!value) { return null; }\n  if (typeof value !== 'string') { return value; }\n  return Array.prototype.slice.call(document.querySelectorAll(value), 0);\n}\n\nfunction selectorStringify (value) {\n  if (value.getAttribute) {\n    return '#' + value.getAttribute('id');\n  }\n  return defaultStringify(value);\n}\n\nfunction selectorAllStringify (value) {\n  if (value instanceof Array) {\n    return value.map(function (element) {\n      return '#' + element.getAttribute('id');\n    }).join(', ');\n  }\n  return defaultStringify(value);\n}\n\n/**\n * `src` parser for assets.\n *\n * @param {string} value - Can either be `url(<value>)` or a selector to an asset.\n * @returns {string} Parsed value from `url(<value>)` or src from `<someasset src>`.\n */\nfunction srcParse (value) {\n  var parsedUrl = value.match(/\\url\\((.+)\\)/);\n  if (parsedUrl) { return parsedUrl[1]; }\n\n  var el = selectorParse(value);\n  if (el) { return el.getAttribute('src'); }\n\n  if (value.charAt(0) !== '#') {\n    warn('\"' + value + '\" is not a valid `src` attribute. ' +\n         'Value must be an ID selector (i.e. \"#someElement\") or wrapped in `url()`.');\n  }\n\n  return '';\n}\n\nfunction vecParse (value) {\n  return coordinates.parse(value, this.default);\n}\n","/* global THREE */\n\n// Coordinate string regex. Handles negative, positive, and decimals.\nvar regex = /\\s*(-?\\d*\\.{0,1}\\d+)\\s+(-?\\d*\\.{0,1}\\d+)\\s+(-?\\d*\\.{0,1}\\d+)\\s*/;\nmodule.exports.regex = regex;\n\n/**\n * Parses coordinates from an \"x y z\" string.\n * Example: \"3 10 -5\" to {x: 3, y: 10, z: -5}.\n *\n * @param {string} val - An \"x y z\" string.\n * @param {string} defaults - fallback value.\n * @returns {object} An object with keys [x, y, z].\n */\nfunction parse (value, defaultVec) {\n  var coordinate;\n  var vec = {};\n\n  if (value && typeof value === 'object') {\n    return vecParseFloat(value);\n  }\n\n  if (typeof value !== 'string' || value === null) {\n    return defaultVec;\n  }\n\n  coordinate = value.trim().replace(/\\s+/g, ' ').split(' ');\n  vec.x = coordinate[0] || defaultVec && defaultVec.x;\n  vec.y = coordinate[1] || defaultVec && defaultVec.y;\n  vec.z = coordinate[2] || defaultVec && defaultVec.z;\n  vec.w = coordinate[3] || defaultVec && defaultVec.w;\n  return vecParseFloat(vec);\n}\nmodule.exports.parse = parse;\n\n/**\n * Stringifies coordinates from an object with keys [x y z].\n * Example: {x: 3, y: 10, z: -5} to \"3 10 -5\".\n *\n * @param {object|string} data - An object with keys [x y z].\n * @returns {string} An \"x y z\" string.\n */\nfunction stringify (data) {\n  if (typeof data !== 'object') { return data; }\n  return [data.x, data.y, data.z, data.w].join(' ').trim();\n}\nmodule.exports.stringify = stringify;\n\n/**\n * @returns {bool}\n */\nmodule.exports.isCoordinate = function (value) {\n  return regex.test(value);\n};\n\nfunction vecParseFloat (vec) {\n  Object.keys(vec).forEach(function (key) {\n    if (vec[key] === undefined) {\n      delete vec[key];\n      return;\n    }\n    vec[key] = parseFloat(vec[key], 10);\n  });\n  return vec;\n}\n\n/**\n * Converts {x, y, z} object to three.js Vector3.\n */\nmodule.exports.toVector3 = function (vec3) {\n  return new THREE.Vector3(vec3.x, vec3.y, vec3.z);\n};\n","/**\n * Get component property using encoded component name + component property name with a\n * delimiter.\n */\nmodule.exports.getComponentProperty = function (el, name, delimiter) {\n  var splitName;\n  delimiter = delimiter || '.';\n  if (name.indexOf(delimiter) !== -1) {\n    splitName = name.split(delimiter);\n    return el.getAttribute(splitName[0])[splitName[1]];\n  }\n  return el.getAttribute(name);\n};\n\n/**\n * Set component property using encoded component name + component property name with a\n * delimiter.\n */\nmodule.exports.setComponentProperty = function (el, name, value, delimiter) {\n  var splitName;\n  delimiter = delimiter || '.';\n  if (name.indexOf(delimiter) !== -1) {\n    splitName = name.split(delimiter);\n    el.setAttribute(splitName[0], splitName[1], value);\n    return;\n  }\n  el.setAttribute(name, value);\n};\n","var THREE = require('../lib/three');\nvar dummyDolly = new THREE.Object3D();\nvar controls = new THREE.VRControls(dummyDolly);\n\n/**\n * Determine if a headset is connected by checking if the\n * orientation is available\n */\nmodule.exports = function checkHeadsetConnected () {\n  var orientation;\n  controls.update();\n  orientation = dummyDolly.quaternion;\n  if (orientation._x !== 0 || orientation._y !== 0 || orientation._z !== 0) {\n    return true;\n  }\n};\n","module.exports = function forceCanvasResizeSafariMobile (canvasEl) {\n  var width = canvasEl.style.width;\n  var height = canvasEl.style.height;\n  // Taken from webvr-polyfill (https://github.com/borismus/webvr-polyfill/blob/85f657cd502ec9417bf26b87c3cb2afa6a70e079/src/util.js#L200)\n  // iOS only workaround for https://bugs.webkit.org/show_bug.cgi?id=152556\n  // By changing the size 1 pixel and restoring the previous value\n  // we trigger a size recalculation cycle.\n  canvasEl.style.width = (parseInt(width, 10) + 1) + 'px';\n  canvasEl.style.height = (parseInt(height, 10) + 1) + 'px';\n  setTimeout(function () {\n    canvasEl.style.width = width;\n    canvasEl.style.height = height;\n  }, 200);\n};\n","/**\n * Update `material.map` given `data.src`. For standard and flat shaders.\n *\n * @param {object} shader - A-Frame shader instance.\n * @param {object} data\n */\nmodule.exports.updateMap = function (shader, data) {\n  var el = shader.el;\n  var material = shader.material;\n  var src = data.src;\n\n  if (src) {\n    if (src === shader.textureSrc) { return; }\n    // Texture added or changed.\n    shader.textureSrc = src;\n    el.sceneEl.systems.material.loadTexture(src, {src: src, repeat: data.repeat}, setMap);\n    return;\n  }\n\n  // Texture removed.\n  if (!material.map) { return; }\n  setMap(null);\n\n  function setMap (texture) {\n    material.map = texture;\n    material.needsUpdate = true;\n    handleTextureEvents(el, texture);\n  }\n};\n\n/**\n * Updates the material's maps which give the illusion of extra geometry.\n *\n * @param {string} longType - The friendly name of the map from the component e.g. ambientOcclusionMap becomes aoMap in THREE.js\n * @param {object} shader - A-Frame shader instance\n * @param {object} data\n */\nmodule.exports.updateDistortionMap = function (longType, shader, data) {\n  var shortType = longType;\n  if (longType === 'ambientOcclusion') { shortType = 'ao'; }\n  var el = shader.el;\n  var material = shader.material;\n  var src = data[longType + 'Map'];\n  var info = {};\n  info.src = src;\n\n  // Pass through the repeat and offset to be handled by the material loader.\n  info.offset = data[longType + 'TextureOffset'];\n  info.repeat = data[longType + 'TextureRepeat'];\n  info.wrap = data[longType + 'TextureWrap'];\n\n  if (src) {\n    if (src === shader[longType + 'TextureSrc']) { return; }\n\n    // Texture added or changed.\n    shader[longType + 'TextureSrc'] = src;\n    el.sceneEl.systems.material.loadTexture(src, info, setMap);\n    return;\n  }\n\n  // Texture removed.\n  if (!material.map) { return; }\n  setMap(null);\n\n  function setMap (texture) {\n    material[shortType + 'Map'] = texture;\n    material.needsUpdate = true;\n    handleTextureEvents(el, texture);\n  }\n};\n\n/**\n * Emit event on entities on texture-related events.\n *\n * @param {Element} el - Entity.\n * @param {object} texture - three.js Texture.\n */\nfunction handleTextureEvents (el, texture) {\n  if (!texture) { return; }\n\n  el.emit('materialtextureloaded', {src: texture.image, texture: texture});\n\n  // Video events.\n  if (texture.image.tagName !== 'VIDEO') { return; }\n  texture.image.addEventListener('loadeddata', function emitVideoTextureLoadedDataAll () {\n    el.emit('materialvideoloadeddata', {src: texture.image, texture: texture});\n  });\n  texture.image.addEventListener('ended', function emitVideoTextureEndedAll () {\n    // Works for non-looping videos only.\n    el.emit('materialvideoended', {src: texture.image, texture: texture});\n  });\n}\nmodule.exports.handleTextureEvents = handleTextureEvents;\n","/* global Image */\nvar debug = require('./debug');\n\nvar warn = debug('utils:src-loader:warn');\n\n/**\n * Validates a texture, either as a selector or as a URL.\n * Detects whether `src` is pointing to an image, video, or canvas, and invokes the\n * appropriate callback.\n *\n * If `src` is selector, check if it's valid, return the el in the callback.\n * An el is returned so that it can be reused for texture loading.\n *\n * If `src` is a URL, check if it's valid, return the src in the callback.\n *\n * @params {string} src - A selector or a URL. URLs must be wrapped by `url()`.\n * @params {function} isImageCb - callback if texture is an image.\n * @params {function} isVideoCb - callback if texture is a video.\n * @params {function} isCanvasCb - callback if texture is a canvas.\n */\nfunction validateSrc (src, isImageCb, isVideoCb, isCanvasCb) {\n  var textureEl;\n  var isImage;\n  var isVideo;\n  var isCanvas;\n  var url = parseUrl(src);\n\n  // src is a url.\n  if (url) {\n    validateImageUrl(url, function isAnImageUrl (isImage) {\n      if (!isImage) { isVideoCb(url); return; }\n      isImageCb(url);\n    });\n    return;\n  }\n\n  // src is a query selector.\n  textureEl = validateAndGetQuerySelector(src);\n  if (!textureEl) { return; }\n  isImage = textureEl && textureEl.tagName === 'IMG';\n  isVideo = textureEl && textureEl.tagName === 'VIDEO';\n  isCanvas = textureEl && textureEl.tagName === 'CANVAS';\n  if (isImage) { return isImageCb(textureEl); }\n  if (isVideo) { return isVideoCb(textureEl); }\n  if (isCanvas) { return isCanvasCb(textureEl); }\n\n  // src is a valid selector but doesn't match with a <img>, <video>, or <canvas> element.\n  warn('\"%s\" does not point to a valid <img>, <video>, or <canvas> element', src);\n}\n\n/**\n * Validates six images as a cubemap, either as selector or comma-separated\n * URLs.\n *\n * @param {string} src - A selector or comma-separated image URLs. Image URLs\n          must be wrapped by `url()`.\n * @param {string} src - A selector or comma-separated image URLs. Image URLs\n          must be wrapped by `url()`.\n */\nfunction validateCubemapSrc (src, cb) {\n  var aCubemap;\n  var cubemapSrcRegex = '';\n  var i;\n  var urls;\n  var validatedUrls = [];\n\n  for (i = 0; i < 5; i++) {\n    cubemapSrcRegex += '(url\\\\((?:[^\\\\)]+)\\\\),\\\\s*)';\n  }\n  cubemapSrcRegex += '(url\\\\((?:[^\\\\)]+)\\\\)\\\\s*)';\n  urls = src.match(new RegExp(cubemapSrcRegex));\n\n  // `src` is a comma-separated list of URLs.\n  // In this case, re-use validateSrc for each side of the cube.\n  function isImageCb (url) {\n    validatedUrls.push(url);\n    if (validatedUrls.length === 6) {\n      cb(validatedUrls);\n    }\n  }\n  if (urls) {\n    for (i = 1; i < 7; i++) {\n      validateSrc(urls[i], isImageCb);\n    }\n    return;\n  }\n\n  // `src` is a query selector to <a-cubemap> containing six $([src])s.\n  aCubemap = validateAndGetQuerySelector(src);\n  if (!aCubemap) { return; }\n  if (aCubemap.tagName === 'A-CUBEMAP' && aCubemap.srcs) {\n    return cb(aCubemap.srcs);\n  }\n  // Else if aCubeMap is not a <a-cubemap>.\n  warn('Selector \"%s\" does not point to <a-cubemap>', src);\n}\n\n/**\n * Parses src from `url(src)`.\n * @param  {string} src - String to parse.\n * @return {string} The parsed src, if parseable.\n */\nfunction parseUrl (src) {\n  var parsedSrc = src.match(/\\url\\((.+)\\)/);\n  if (!parsedSrc) { return; }\n  return parsedSrc[1];\n}\n\n/**\n * Validate src is a valid image url\n * @param  {string} src - url that will be tested\n * @param  {function} onResult - callback with the test result\n */\nfunction validateImageUrl (src, onResult) {\n  var tester = new Image();\n  tester.addEventListener('load', onLoad);\n  function onLoad () { onResult(true); }\n  tester.addEventListener('error', onError);\n  function onError () { onResult(false); }\n  tester.src = src;\n}\n\n/**\n * Query and validate a query selector,\n *\n * @param  {string} selector - DOM selector.\n * @return {object|null|undefined} Selected DOM element if exists.\n           null if query yields no results.\n           undefined if `selector` is not a valid selector.\n */\nfunction validateAndGetQuerySelector (selector) {\n  try {\n    var el = document.querySelector(selector);\n    if (!el) {\n      warn('No element was found matching the selector: \"%s\"', selector);\n    }\n    return el;\n  } catch (e) {  // Capture exception if it's not a valid selector.\n    warn('\"%s\" is not a valid selector', selector);\n    return undefined;\n  }\n}\n\nmodule.exports = {\n  parseUrl: parseUrl,\n  validateSrc: validateSrc,\n  validateCubemapSrc: validateCubemapSrc\n};\n","/* Utils for parsing style-like strings (e.g., \"primitive: box; width: 5; height: 4.5\"). */\nvar styleParser = require('style-attr');\n\n/**\n * Deserializes style-like string into an object of properties.\n *\n * @param {string} value - HTML attribute value.\n * @returns {object} Property data.\n */\nmodule.exports.parse = function (value) {\n  var parsedData;\n  if (typeof value !== 'string') { return value; }\n  parsedData = styleParser.parse(value);\n  // The style parser returns an object { \"\" : \"test\"} when fed a string\n  if (parsedData['']) { return value; }\n  return transformKeysToCamelCase(parsedData);\n};\n\n/**\n * Serialize an object of properties into a style-like string.\n *\n * @param {object} data - Property data.\n * @returns {string}\n */\nmodule.exports.stringify = function (data) {\n  if (typeof data === 'string') { return data; }\n  return styleParser.stringify(data);\n};\n\n/**\n * Converts string from hyphen to camelCase.\n *\n * @param {string} str - String to camelCase.\n * @return {string} CamelCased string.\n */\nfunction toCamelCase (str) {\n  return str.replace(/-([a-z])/g, camelCase);\n  function camelCase (g) { return g[1].toUpperCase(); }\n}\nmodule.exports.toCamelCase = toCamelCase;\n\n/**\n * Converts object's keys from hyphens to camelCase (e.g., `max-value` to\n * `maxValue`).\n *\n * @param {object} obj - The object to camelCase keys.\n * @return {object} The object with keys camelCased.\n */\nfunction transformKeysToCamelCase (obj) {\n  var keys = Object.keys(obj);\n  var camelCaseObj = {};\n  keys.forEach(function (key) {\n    var camelCaseKey = toCamelCase(key);\n    camelCaseObj[camelCaseKey] = obj[key];\n  });\n  return camelCaseObj;\n}\nmodule.exports.transformKeysToCamelCase = transformKeysToCamelCase;\n","'use strict';\n// For more information about browser field, check out the browser field at https://github.com/substack/browserify-handbook#browser-field.\n\nmodule.exports = {\n    // Create a <link> tag with optional data attributes\n    createLink: function(href, attributes) {\n        var head = document.head || document.getElementsByTagName('head')[0];\n        var link = document.createElement('link');\n\n        link.href = href;\n        link.rel = 'stylesheet';\n\n        for (var key in attributes) {\n            if ( ! attributes.hasOwnProperty(key)) {\n                continue;\n            }\n            var value = attributes[key];\n            link.setAttribute('data-' + key, value);\n        }\n\n        head.appendChild(link);\n    },\n    // Create a <style> tag with optional data attributes\n    createStyle: function(cssText, attributes) {\n        var head = document.head || document.getElementsByTagName('head')[0],\n            style = document.createElement('style');\n\n        style.type = 'text/css';\n\n        for (var key in attributes) {\n            if ( ! attributes.hasOwnProperty(key)) {\n                continue;\n            }\n            var value = attributes[key];\n            style.setAttribute('data-' + key, value);\n        }\n        \n        if (style.sheet) { // for jsdom and IE9+\n            style.innerHTML = cssText;\n            style.sheet.cssText = cssText;\n            head.appendChild(style);\n        } else if (style.styleSheet) { // for IE8 and below\n            head.appendChild(style);\n            style.styleSheet.cssText = cssText;\n        } else { // for Chrome, Firefox, and Safari\n            style.appendChild(document.createTextNode(cssText));\n            head.appendChild(style);\n        }\n    }\n};\n","var bind = require('../../utils/bind');\nvar register = require('../../core/component').registerComponent;\n\nmodule.exports.Component = register('canvas', {\n\n  init: function () {\n    var sceneEl = this.el;\n    var canvasEl = document.createElement('canvas');\n    canvasEl.classList.add('a-canvas');\n    // Mark canvas as provided/injected by A-Frame.\n    canvasEl.dataset.aframeCanvas = true;\n    sceneEl.appendChild(canvasEl);\n\n    document.addEventListener('fullscreenchange', onFullScreenChange);\n    document.addEventListener('mozfullscreenchange', onFullScreenChange);\n    document.addEventListener('webkitfullscreenchange', onFullScreenChange);\n\n    // Prevent overscroll on mobile.\n    canvasEl.addEventListener('touchmove', function (event) {\n      event.preventDefault();\n    });\n\n    // Handle fullscreeen styling\n    sceneEl.addEventListener('enter-vr', addFullscreenClass);\n    sceneEl.addEventListener('exit-vr', removeFullscreenClass);\n\n    // Set canvas on scene.\n    sceneEl.canvas = canvasEl;\n    sceneEl.emit('render-target-loaded', {\n      target: canvasEl\n    });\n\n    function addFullscreenClass (event) {\n      canvasEl.classList.add('fullscreen');\n    }\n\n    function removeFullscreenClass (event) {\n      canvasEl.classList.remove('fullscreen');\n    }\n\n    function onFullScreenChange () {\n      var fullscreenEl =\n        document.fullscreenElement ||\n        document.mozFullScreenElement ||\n        document.webkitFullscreenElement;\n      // No fullscren element === exit fullscreen\n      if (!fullscreenEl) { sceneEl.exitVR(); }\n      document.activeElement.blur();\n      document.body.focus();\n      // For unkown reasons a syncrhonous resize does\n      // not work on desktop when entering/exiting fullscreen\n      setTimeout(bind(sceneEl.resize, sceneEl), 0);\n    }\n  }\n\n});\n","var register = require('../../core/component').registerComponent;\n\nmodule.exports.Component = register('debug', {\n  schema: {default: true}\n});\n","var registerComponent = require('../../core/component').registerComponent;\n\n/**\n * Component to embed an a-frame scene within the layout of a 2D page.\n */\nmodule.exports.Component = registerComponent('embedded', {\n  dependencies: ['vr-mode-ui'],\n\n  schema: {default: true},\n\n  update: function () {\n    var sceneEl = this.el;\n    var enterVREl = sceneEl.querySelector('.a-enter-vr');\n    if (this.data === true) {\n      enterVREl.classList.add('embedded');\n      sceneEl.removeFullScreenStyles();\n    } else {\n      enterVREl.classList.remove('embedded');\n      sceneEl.addFullScreenStyles();\n    }\n  }\n\n});\n","/* global AFRAME */\nvar AFRAME_INJECTED = require('../../constants').AFRAME_INJECTED;\nvar bind = require('../../utils/bind');\nvar pkg = require('../../../package');\nvar registerComponent = require('../../core/component').registerComponent;\n\nvar INSPECTOR_URL = pkg.homepage + 'releases/' + pkg.version + '/aframe-inspector.min.js';\n\nmodule.exports.Component = registerComponent('inspector', {\n  schema: {\n    url: {default: INSPECTOR_URL}\n  },\n\n  init: function () {\n    this.onKeydown = bind(this.onKeydown, this);\n    window.addEventListener('keydown', this.onKeydown);\n  },\n\n  onKeydown: function (evt) {\n    // Alt + Ctrl + i\n    var shortcutPressed = evt.keyCode === 73 && evt.ctrlKey && evt.altKey;\n    if (!this.data || !shortcutPressed) { return; }\n    this.injectInspector();\n  },\n\n  injectInspector: function () {\n    var self = this;\n    var script;\n\n    if (AFRAME.INSPECTOR || AFRAME.inspectorInjected) { return; }\n\n    // Inject.\n    script = document.createElement('script');\n    script.src = this.data.url;\n    script.setAttribute('data-name', 'aframe-inspector');\n    script.setAttribute(AFRAME_INJECTED, '');\n    script.onload = function () {\n      AFRAME.INSPECTOR.open();\n      window.removeEventListener('keydown', self.onKeydown);\n    };\n    document.head.appendChild(script);\n    AFRAME.inspectorInjected = true;\n  },\n\n  remove: function () {\n    window.removeEventListener('keydown', this.onKeydown);\n  }\n});\n","var register = require('../../core/component').registerComponent;\nvar THREE = require('../../lib/three');\nvar debug = require('../../utils/debug');\n\nvar warn = debug('components:fog:warn');\n\n/**\n * Fog component.\n * Applies only to the scene entity.\n */\nmodule.exports.Component = register('fog', {\n  schema: {\n    color: {default: '#000'},\n    density: {default: 0.00025},\n    far: {default: 1000, min: 0},\n    near: {default: 1, min: 0},\n    type: {default: 'linear', oneOf: ['linear', 'exponential']}\n  },\n\n  update: function () {\n    var data = this.data;\n    var el = this.el;\n    var fog = this.el.object3D.fog;\n\n    if (!el.isScene) {\n      warn('Fog component can only be applied to <a-scene>');\n      return;\n    }\n\n    // (Re)create fog if fog doesn't exist or fog type changed.\n    if (!fog || data.type !== fog.name) {\n      el.object3D.fog = getFog(data);\n      el.systems.material.updateMaterials();\n      return;\n    }\n\n    // Fog data changed. Update fog.\n    Object.keys(this.schema).forEach(function (key) {\n      var value = data[key];\n      if (key === 'color') { value = new THREE.Color(value); }\n      fog[key] = value;\n    });\n  },\n\n  /**\n   * Remove fog on remove (callback).\n   */\n  remove: function () {\n    var fog = this.el.object3D.fog;\n    if (fog) {\n      fog.density = 0;\n      fog.far = 0;\n      fog.near = 0;\n    }\n  }\n});\n\n/**\n * Creates a fog object. Sets fog.name to be able to detect fog type changes.\n *\n * @param {object} data - Fog data.\n * @returns {object} fog\n */\nfunction getFog (data) {\n  var fog;\n  if (data.type === 'exponential') {\n    fog = new THREE.FogExp2(data.color, data.density);\n  } else {\n    fog = new THREE.Fog(data.color, data.near, data.far);\n  }\n  fog.name = data.type;\n  return fog;\n}\n","var registerComponent = require('../../core/component').registerComponent;\nvar shouldCaptureKeyEvent = require('../../utils/').shouldCaptureKeyEvent;\nvar THREE = require('../../lib/three');\n\nvar controls = new THREE.VRControls(new THREE.Object3D());\n\nmodule.exports.Component = registerComponent('keyboard-shortcuts', {\n  schema: {\n    enterVR: {default: true},\n    exitVR: {default: true},\n    resetSensor: {default: true}\n  },\n\n  init: function () {\n    var self = this;\n    var scene = this.el;\n\n    this.listener = window.addEventListener('keyup', function (event) {\n      if (!shouldCaptureKeyEvent(event)) { return; }\n      if (self.enterVREnabled && event.keyCode === 70) {  // f.\n        scene.enterVR();\n      }\n      if (self.enterVREnabled && event.keyCode === 27) {  // escape.\n        scene.exitVR();\n      }\n      if (self.resetSensorEnabled && event.keyCode === 90) {  // z.\n        controls.resetSensor();\n      }\n    }, false);\n  },\n\n  update: function (oldData) {\n    var data = this.data;\n    this.enterVREnabled = data.enterVR;\n    this.resetSensorEnabled = data.resetSensor;\n  },\n\n  remove: function () {\n    window.removeEventListener('keyup', this.listener);\n  }\n});\n","var debug = require('../../utils/debug');\nvar registerComponent = require('../../core/component').registerComponent;\n\nvar warn = debug('components:pool:warn');\n\n/**\n * Pool component.\n * A pool of entities that will be reused.\n * It avoids creating and destroying the same kind of entities\n * in dynamic scenes. It will help reduce GC pauses. Useful for example\n * in a game where you want to reuse enemies entities.\n *\n * @member {array} availableEls - Available entities in the pool.\n * @member {array} useedEls - Entities of the pool in use.\n *\n */\nmodule.exports.Component = registerComponent('pool', {\n  schema: {\n    mixin: {default: ''},\n    size: {default: 0},\n    dynamic: {default: false}\n  },\n\n  multiple: true,\n\n  init: function () {\n    this.initPool();\n  },\n\n  initPool: function () {\n    var i;\n    var mixin = this.data.mixin;\n    if (!mixin) { return; }\n    this.availableEls = [];\n    this.usedEls = [];\n    for (i = 0; i < this.data.size; ++i) {\n      this.createEntity();\n    }\n  },\n\n  update: function (oldData) {\n    var data = this.data;\n    if (oldData.mixin !== data.mixin || oldData.size !== data.size) {\n      this.initPool();\n    }\n  },\n\n  /**\n   * Add a new entity to the list of available entities.\n   */\n  createEntity: function () {\n    var el = document.createElement('a-entity');\n    el.play = this.wrapPlay(el.play);\n    el.setAttribute('mixin', this.data.mixin);\n    el.setAttribute('visible', false);\n    this.el.appendChild(el);\n    this.availableEls.push(el);\n  },\n\n  /**\n   * Play wrapper for pooled entities. When pausing and playing\n   * a scene we don't want to play the entities that are not in use\n   */\n  wrapPlay: function (playMethod) {\n    var usedEls = this.usedEls;\n    return function () {\n      if (usedEls.indexOf(this) === -1) { return; }\n      playMethod.call(this);\n    };\n  },\n\n  /**\n   * Used to request one of the available entities of the pool\n   */\n  requestEntity: function () {\n    var el;\n    if (this.availableEls.length === 0) {\n      if (this.data.dynamic === false) {\n        warn('Requested entity from empty pool ' + this.name);\n        return;\n      } else {\n        warn('Requested entity from empty pool. This pool is dynamic' +\n        'and will resize automatically. You might want to increase its initial size' + this.name);\n      }\n      this.createEntity();\n    }\n    el = this.availableEls.shift();\n    this.usedEls.push(el);\n    el.setAttribute('visible', true);\n    return el;\n  },\n\n  /**\n   * Used to return a used entity to the pool\n   */\n  returnEntity: function (el) {\n    var index = this.usedEls.indexOf(el);\n    if (index === -1) {\n      warn('The returned entity was not previously pooled from ' + this.name);\n      return;\n    }\n    this.usedEls.splice(index, 1);\n    this.availableEls.push(el);\n    el.setAttribute('visible', false);\n    el.pause();\n  }\n});\n","var registerComponent = require('../../core/component').registerComponent;\nvar RStats = require('../../../vendor/rStats');\nvar utils = require('../../utils');\nrequire('../../../vendor/rStats.extras');\nrequire('../../lib/rStatsAframe');\n\nvar AFrameStats = window.aframeStats;\nvar bind = utils.bind;\nvar HIDDEN_CLASS = 'a-hidden';\nvar ThreeStats = window.threeStats;\n\n/**\n * Stats appended to document.body by RStats.\n */\nmodule.exports.Component = registerComponent('stats', {\n  schema: {default: true},\n\n  init: function () {\n    var scene = this.el;\n\n    if (utils.getUrlParameter('stats') === 'false') { return; }\n\n    this.stats = createStats(scene);\n    this.statsEl = document.querySelector('.rs-base');\n\n    this.hideBound = bind(this.hide, this);\n    this.showBound = bind(this.show, this);\n\n    scene.addEventListener('enter-vr', this.hideBound);\n    scene.addEventListener('exit-vr', this.showBound);\n  },\n\n  update: function () {\n    if (!this.stats) { return; }\n    return (!this.data) ? this.hide() : this.show();\n  },\n\n  remove: function () {\n    this.el.removeEventListener('enter-vr', this.hideBound);\n    this.el.removeEventListener('exit-vr', this.showBound);\n    this.statsEl.parentNode.removeChild(this.statsEl);\n  },\n\n  tick: function () {\n    var stats = this.stats;\n\n    if (!stats) { return; }\n\n    stats('rAF').tick();\n    stats('FPS').frame();\n    stats().update();\n  },\n\n  hide: function () {\n    this.statsEl.classList.add(HIDDEN_CLASS);\n  },\n\n  show: function () {\n    this.statsEl.classList.remove(HIDDEN_CLASS);\n  }\n});\n\nfunction createStats (scene) {\n  var threeStats = new ThreeStats(scene.renderer);\n  var aframeStats = new AFrameStats(scene);\n  var plugins = scene.isMobile ? [] : [threeStats, aframeStats];\n  return new RStats({\n    css: [],  // Our stylesheet is injected from `src/index.js`.\n    values: {\n      fps: {caption: 'fps', below: 30}\n    },\n    groups: [\n      {caption: 'Framerate', values: ['fps', 'raf']}\n    ],\n    plugins: plugins\n  });\n}\n","var registerComponent = require('../../core/component').registerComponent;\nvar constants = require('../../constants/');\nvar utils = require('../../utils/');\nvar bind = utils.bind;\n\nvar ENTER_VR_CLASS = 'a-enter-vr';\nvar ENTER_VR_BTN_CLASS = 'a-enter-vr-button';\nvar HIDDEN_CLASS = 'a-hidden';\nvar ORIENTATION_MODAL_CLASS = 'a-orientation-modal';\n\n/**\n * UI for entering VR mode.\n */\nmodule.exports.Component = registerComponent('vr-mode-ui', {\n  dependencies: ['canvas'],\n\n  schema: {\n    enabled: {default: true}\n  },\n\n  init: function () {\n    var self = this;\n    var sceneEl = this.el;\n\n    if (utils.getUrlParameter('ui') === 'false') { return; }\n\n    this.enterVR = bind(sceneEl.enterVR, sceneEl);\n    this.exitVR = bind(sceneEl.exitVR, sceneEl);\n    this.insideLoader = false;\n    this.enterVREl = null;\n    this.orientationModalEl = null;\n\n    // Hide/show VR UI when entering/exiting VR mode.\n    sceneEl.addEventListener('enter-vr', bind(this.updateEnterVRInterface, this));\n    sceneEl.addEventListener('exit-vr', bind(this.updateEnterVRInterface, this));\n\n    window.addEventListener('message', function (event) {\n      if (event.data.type === 'loaderReady') {\n        self.insideLoader = true;\n        self.remove();\n      }\n    });\n\n    // Modal that tells the user to change orientation if in portrait.\n    window.addEventListener('orientationchange', bind(this.toggleOrientationModalIfNeeded, this));\n  },\n\n  update: function () {\n    var sceneEl = this.el;\n\n    if (!this.data.enabled || this.insideLoader || utils.getUrlParameter('ui') === 'false') {\n      return this.remove();\n    }\n    if (this.enterVREl || this.orientationModalEl) { return; }\n\n    // Add UI if enabled and not already present.\n    this.enterVREl = createEnterVRButton(this.enterVR);\n    sceneEl.appendChild(this.enterVREl);\n\n    this.orientationModalEl = createOrientationModal(this.exitVR);\n    sceneEl.appendChild(this.orientationModalEl);\n\n    this.updateEnterVRInterface();\n  },\n\n  remove: function () {\n    [this.enterVREl, this.orientationModalEl].forEach(function (uiElement) {\n      if (uiElement) {\n        uiElement.parentNode.removeChild(uiElement);\n      }\n    });\n  },\n\n  updateEnterVRInterface: function () {\n    this.toggleEnterVRButtonIfNeeded();\n    this.toggleOrientationModalIfNeeded();\n  },\n\n  toggleEnterVRButtonIfNeeded: function () {\n    var sceneEl = this.el;\n    if (!this.enterVREl) { return; }\n    if (sceneEl.is('vr-mode')) {\n      this.enterVREl.classList.add(HIDDEN_CLASS);\n    } else {\n      this.enterVREl.classList.remove(HIDDEN_CLASS);\n    }\n  },\n\n  toggleOrientationModalIfNeeded: function () {\n    var sceneEl = this.el;\n    var orientationModalEl = this.orientationModalEl;\n    if (!orientationModalEl || !sceneEl.isMobile) { return; }\n    if (!utils.isLandscape() && sceneEl.is('vr-mode')) {\n      // Show if in VR mode on portrait.\n      orientationModalEl.classList.remove(HIDDEN_CLASS);\n    } else {\n      orientationModalEl.classList.add(HIDDEN_CLASS);\n    }\n  }\n});\n\n/**\n * Creates a button that when clicked will enter into stereo-rendering mode for VR.\n *\n * Structure: <div><button></div>\n *\n * @returns {Element} Wrapper <div>.\n */\nfunction createEnterVRButton (enterVRHandler) {\n  var vrButton;\n  var wrapper;\n\n  // Create elements.\n  wrapper = document.createElement('div');\n  wrapper.classList.add(ENTER_VR_CLASS);\n  wrapper.setAttribute(constants.AFRAME_INJECTED, '');\n  vrButton = document.createElement('button');\n  vrButton.className = ENTER_VR_BTN_CLASS;\n  vrButton.setAttribute(constants.AFRAME_INJECTED, '');\n\n  // Insert elements.\n  wrapper.appendChild(vrButton);\n  vrButton.addEventListener('click', enterVRHandler);\n  return wrapper;\n}\n\n/**\n * Create a modal that tells mobile users to orient the phone to landscape.\n * Add a close button that if clicked, exits VR and closes the modal.\n */\nfunction createOrientationModal (exitVRHandler) {\n  var modal = document.createElement('div');\n  modal.className = ORIENTATION_MODAL_CLASS;\n  modal.classList.add(HIDDEN_CLASS);\n  modal.setAttribute(constants.AFRAME_INJECTED, '');\n\n  var exit = document.createElement('button');\n  exit.setAttribute(constants.AFRAME_INJECTED, '');\n  exit.innerHTML = 'Exit VR';\n\n  // Exit VR on close.\n  exit.addEventListener('click', exitVRHandler);\n\n  modal.appendChild(exit);\n\n  return modal;\n}\n","/*! (C) WebReflection Mit Style License */\n(function(t,n,r,i){\"use strict\";function st(e,t){for(var n=0,r=e.length;n<r;n++)gt(e[n],t)}function ot(e){for(var t=0,n=e.length,r;t<n;t++)r=e[t],it(r,w[at(r)])}function ut(e){return function(t){F(t)&&(gt(t,e),st(t.querySelectorAll(E),e))}}function at(e){var t=R.call(e,\"is\"),n=e.nodeName.toUpperCase(),r=x.call(b,t?m+t.toUpperCase():v+n);return t&&-1<r&&!ft(n,t)?-1:r}function ft(e,t){return-1<E.indexOf(e+'[is=\"'+t+'\"]')}function lt(e){var t=e.currentTarget,n=e.attrChange,r=e.attrName,i=e.target;Y&&(!i||i===t)&&t.attributeChangedCallback&&r!==\"style\"&&e.prevValue!==e.newValue&&t.attributeChangedCallback(r,n===e[f]?null:e.prevValue,n===e[c]?null:e.newValue)}function ct(e){var t=ut(e);return function(e){$.push(t,e.target)}}function ht(e){G&&(G=!1,e.currentTarget.removeEventListener(p,ht)),st((e.target||n).querySelectorAll(E),e.detail===u?u:o),j&&vt()}function pt(e,t){var n=this;U.call(n,e,t),Z.call(n,{target:n})}function dt(e,t){P(e,t),nt?nt.observe(e,X):(Q&&(e.setAttribute=pt,e[s]=tt(e),e.addEventListener(d,Z)),e.addEventListener(h,lt)),e.createdCallback&&Y&&(e.created=!0,e.createdCallback(),e.created=!1)}function vt(){for(var e,t=0,n=I.length;t<n;t++)e=I[t],S.contains(e)||(n--,I.splice(t--,1),gt(e,u))}function mt(e){throw new Error(\"A \"+e+\" type is already registered\")}function gt(e,t){var n,r=at(e);-1<r&&(rt(e,w[r]),r=0,t===o&&!e[o]?(e[u]=!1,e[o]=!0,r=1,j&&x.call(I,e)<0&&I.push(e)):t===u&&!e[u]&&(e[o]=!1,e[u]=!0,r=1),r&&(n=e[t+\"Callback\"])&&n.call(e))}if(i in n)return;var s=\"__\"+i+(Math.random()*1e5>>0),o=\"attached\",u=\"detached\",a=\"extends\",f=\"ADDITION\",l=\"MODIFICATION\",c=\"REMOVAL\",h=\"DOMAttrModified\",p=\"DOMContentLoaded\",d=\"DOMSubtreeModified\",v=\"<\",m=\"=\",g=/^[A-Z][A-Z0-9]*(?:-[A-Z0-9]+)+$/,y=[\"ANNOTATION-XML\",\"COLOR-PROFILE\",\"FONT-FACE\",\"FONT-FACE-SRC\",\"FONT-FACE-URI\",\"FONT-FACE-FORMAT\",\"FONT-FACE-NAME\",\"MISSING-GLYPH\"],b=[],w=[],E=\"\",S=n.documentElement,x=b.indexOf||function(e){for(var t=this.length;t--&&this[t]!==e;);return t},T=r.prototype,N=T.hasOwnProperty,C=T.isPrototypeOf,k=r.defineProperty,L=r.getOwnPropertyDescriptor,A=r.getOwnPropertyNames,O=r.getPrototypeOf,M=r.setPrototypeOf,_=!!r.__proto__,D=r.create||function yt(e){return e?(yt.prototype=e,new yt):this},P=M||(_?function(e,t){return e.__proto__=t,e}:A&&L?function(){function e(e,t){for(var n,r=A(t),i=0,s=r.length;i<s;i++)n=r[i],N.call(e,n)||k(e,n,L(t,n))}return function(t,n){do e(t,n);while((n=O(n))&&!C.call(n,t));return t}}():function(e,t){for(var n in t)e[n]=t[n];return e}),H=t.MutationObserver||t.WebKitMutationObserver,B=(t.HTMLElement||t.Element||t.Node).prototype,j=!C.call(B,S),F=j?function(e){return e.nodeType===1}:function(e){return C.call(B,e)},I=j&&[],q=B.cloneNode,R=B.getAttribute,U=B.setAttribute,z=B.removeAttribute,W=n.createElement,X=H&&{attributes:!0,characterData:!0,attributeOldValue:!0},V=H||function(e){Q=!1,S.removeEventListener(h,V)},$,J=t.requestAnimationFrame||t.webkitRequestAnimationFrame||t.mozRequestAnimationFrame||t.msRequestAnimationFrame||function(e){setTimeout(e,10)},K=!1,Q=!0,G=!0,Y=!0,Z,et,tt,nt,rt,it;M||_?(rt=function(e,t){C.call(t,e)||dt(e,t)},it=dt):(rt=function(e,t){e[s]||(e[s]=r(!0),dt(e,t))},it=rt),j?(Q=!1,function(){var t=L(B,\"addEventListener\"),n=t.value,r=function(e){var t=new CustomEvent(h,{bubbles:!0});t.attrName=e,t.prevValue=R.call(this,e),t.newValue=null,t[c]=t.attrChange=2,z.call(this,e),this.dispatchEvent(t)},i=function(t,n){var r=this.hasAttribute(t),i=r&&R.call(this,t);e=new CustomEvent(h,{bubbles:!0}),U.call(this,t,n),e.attrName=t,e.prevValue=r?i:null,e.newValue=n,r?e[l]=e.attrChange=1:e[f]=e.attrChange=0,this.dispatchEvent(e)},o=function(e){var t=e.currentTarget,n=t[s],r=e.propertyName,i;n.hasOwnProperty(r)&&(n=n[r],i=new CustomEvent(h,{bubbles:!0}),i.attrName=n.name,i.prevValue=n.value||null,i.newValue=n.value=t[r]||null,i.prevValue==null?i[f]=i.attrChange=0:i[l]=i.attrChange=1,t.dispatchEvent(i))};t.value=function(e,t,u){e===h&&this.attributeChangedCallback&&this.setAttribute!==i&&(this[s]={className:{name:\"class\",value:this.className}},this.setAttribute=i,this.removeAttribute=r,n.call(this,\"propertychange\",o)),n.call(this,e,t,u)},k(B,\"addEventListener\",t)}()):H||(S.addEventListener(h,V),S.setAttribute(s,1),S.removeAttribute(s),Q&&(Z=function(e){var t=this,n,r,i;if(t===e.target){n=t[s],t[s]=r=tt(t);for(i in r){if(!(i in n))return et(0,t,i,n[i],r[i],f);if(r[i]!==n[i])return et(1,t,i,n[i],r[i],l)}for(i in n)if(!(i in r))return et(2,t,i,n[i],r[i],c)}},et=function(e,t,n,r,i,s){var o={attrChange:e,currentTarget:t,attrName:n,prevValue:r,newValue:i};o[s]=e,lt(o)},tt=function(e){for(var t,n,r={},i=e.attributes,s=0,o=i.length;s<o;s++)t=i[s],n=t.name,n!==\"setAttribute\"&&(r[n]=t.value);return r})),n[i]=function(t,r){c=t.toUpperCase(),K||(K=!0,H?(nt=function(e,t){function n(e,t){for(var n=0,r=e.length;n<r;t(e[n++]));}return new H(function(r){for(var i,s,o,u=0,a=r.length;u<a;u++)i=r[u],i.type===\"childList\"?(n(i.addedNodes,e),n(i.removedNodes,t)):(s=i.target,Y&&s.attributeChangedCallback&&i.attributeName!==\"style\"&&(o=R.call(s,i.attributeName),o!==i.oldValue&&s.attributeChangedCallback(i.attributeName,i.oldValue,o)))})}(ut(o),ut(u)),nt.observe(n,{childList:!0,subtree:!0})):($=[],J(function d(){while($.length)$.shift().call(null,$.shift());J(d)}),n.addEventListener(\"DOMNodeInserted\",ct(o)),n.addEventListener(\"DOMNodeRemoved\",ct(u))),n.addEventListener(p,ht),n.addEventListener(\"readystatechange\",ht),n.createElement=function(e,t){var r=W.apply(n,arguments),i=\"\"+e,s=x.call(b,(t?m:v)+(t||i).toUpperCase()),o=-1<s;return t&&(r.setAttribute(\"is\",t=t.toLowerCase()),o&&(o=ft(i.toUpperCase(),t))),Y=!n.createElement.innerHTMLHelper,o&&it(r,w[s]),r},B.cloneNode=function(e){var t=q.call(this,!!e),n=at(t);return-1<n&&it(t,w[n]),e&&ot(t.querySelectorAll(E)),t}),-2<x.call(b,m+c)+x.call(b,v+c)&&mt(t);if(!g.test(c)||-1<x.call(y,c))throw new Error(\"The type \"+t+\" is invalid\");var i=function(){return f?n.createElement(l,c):n.createElement(l)},s=r||T,f=N.call(s,a),l=f?r[a].toUpperCase():c,c,h;return f&&-1<x.call(b,v+l)&&mt(l),h=b.push((f?m:v)+c)-1,E=E.concat(E.length?\",\":\"\",f?l+'[is=\"'+t.toLowerCase()+'\"]':l),i.prototype=w[h]=N.call(s,\"prototype\")?s.prototype:D(B),st(n.querySelectorAll(E),o),i}})(window,document,Object,\"registerElement\");","'use strict';\nvar isObj = require('is-obj');\nvar hasOwnProperty = Object.prototype.hasOwnProperty;\nvar propIsEnumerable = Object.prototype.propertyIsEnumerable;\n\nfunction toObject(val) {\n\tif (val === null || val === undefined) {\n\t\tthrow new TypeError('Sources cannot be null or undefined');\n\t}\n\n\treturn Object(val);\n}\n\nfunction assignKey(to, from, key) {\n\tvar val = from[key];\n\n\tif (val === undefined || val === null) {\n\t\treturn;\n\t}\n\n\tif (hasOwnProperty.call(to, key)) {\n\t\tif (to[key] === undefined || to[key] === null) {\n\t\t\tthrow new TypeError('Cannot convert undefined or null to object (' + key + ')');\n\t\t}\n\t}\n\n\tif (!hasOwnProperty.call(to, key) || !isObj(val)) {\n\t\tto[key] = val;\n\t} else {\n\t\tto[key] = assign(Object(to[key]), from[key]);\n\t}\n}\n\nfunction assign(to, from) {\n\tif (to === from) {\n\t\treturn to;\n\t}\n\n\tfrom = Object(from);\n\n\tfor (var key in from) {\n\t\tif (hasOwnProperty.call(from, key)) {\n\t\t\tassignKey(to, from, key);\n\t\t}\n\t}\n\n\tif (Object.getOwnPropertySymbols) {\n\t\tvar symbols = Object.getOwnPropertySymbols(from);\n\n\t\tfor (var i = 0; i < symbols.length; i++) {\n\t\t\tif (propIsEnumerable.call(from, symbols[i])) {\n\t\t\t\tassignKey(to, from, symbols[i]);\n\t\t\t}\n\t\t}\n\t}\n\n\treturn to;\n}\n\nmodule.exports = function deepAssign(target) {\n\ttarget = toObject(target);\n\n\tfor (var s = 1; s < arguments.length; s++) {\n\t\tassign(target, arguments[s]);\n\t}\n\n\treturn target;\n};\n","/* eslint-disable no-unused-vars */\n'use strict';\nvar hasOwnProperty = Object.prototype.hasOwnProperty;\nvar propIsEnumerable = Object.prototype.propertyIsEnumerable;\n\nfunction toObject(val) {\n\tif (val === null || val === undefined) {\n\t\tthrow new TypeError('Object.assign cannot be called with null or undefined');\n\t}\n\n\treturn Object(val);\n}\n\nmodule.exports = Object.assign || function (target, source) {\n\tvar from;\n\tvar to = toObject(target);\n\tvar symbols;\n\n\tfor (var s = 1; s < arguments.length; s++) {\n\t\tfrom = Object(arguments[s]);\n\n\t\tfor (var key in from) {\n\t\t\tif (hasOwnProperty.call(from, key)) {\n\t\t\t\tto[key] = from[key];\n\t\t\t}\n\t\t}\n\n\t\tif (Object.getOwnPropertySymbols) {\n\t\t\tsymbols = Object.getOwnPropertySymbols(from);\n\t\t\tfor (var i = 0; i < symbols.length; i++) {\n\t\t\t\tif (propIsEnumerable.call(from, symbols[i])) {\n\t\t\t\t\tto[symbols[i]] = from[symbols[i]];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\treturn to;\n};\n","var Wakelock = require('../../../vendor/wakelock/wakelock');\n\nmodule.exports = function initWakelock (scene) {\n  if (!scene.isMobile) { return; }\n\n  var wakelock = scene.wakelock = new Wakelock();\n  scene.addEventListener('enter-vr', function () { wakelock.request(); });\n  scene.addEventListener('exit-vr', function () { wakelock.release(); });\n};\n","var constants = require('../../constants/');\nvar extend = require('../../utils').extend;\n\nvar MOBILE_HEAD_TAGS = module.exports.MOBILE_HEAD_TAGS = [\n  Meta({name: 'viewport', content: 'width=device-width,initial-scale=1,maximum-scale=1,shrink-to-fit=no,user-scalable=no,minimal-ui'}),\n\n  // W3C-standardised meta tags.\n  Meta({name: 'mobile-web-app-capable', content: 'yes'}),\n  Meta({name: 'theme-color', content: 'black'})\n];\n\nvar MOBILE_IOS_HEAD_TAGS = [\n  // iOS-specific meta tags for fullscreen when pinning to homescreen.\n  Meta({name: 'apple-mobile-web-app-capable', content: 'yes'}),\n  Meta({name: 'apple-mobile-web-app-status-bar-style', content: 'black'}),\n  Link({rel: 'apple-touch-icon', href: 'https://aframe.io/images/aframe-logo-152.png'})\n];\n\nfunction Meta (attrs) {\n  return {\n    tagName: 'meta',\n    attributes: attrs,\n    exists: function () { return document.querySelector('meta[name=\"' + attrs.name + '\"]'); }\n  };\n}\n\nfunction Link (attrs) {\n  return {\n    tagName: 'link',\n    attributes: attrs,\n    exists: function () { return document.querySelector('link[rel=\"' + attrs.rel + '\"]'); }\n  };\n}\n\n/**\n * Injects the necessary metatags in the document for mobile support:\n * 1. Prevent the user to zoom in the document.\n * 2. Ensure that window.innerWidth and window.innerHeight have the correct\n *    values and the canvas is properly scaled.\n * 3. To allow fullscreen mode when pinning a web app on the home screen on\n *    iOS.\n * Adapted from https://www.reddit.com/r/web_design/comments/3la04p/\n *\n * @param {object} scene - Scene element\n * @returns {Array}\n */\nmodule.exports.inject = function injectHeadTags (scene) {\n  var headEl = document.head;\n  var headScriptEl = headEl.querySelector('script');\n  var tag;\n  var headTags = [];\n  MOBILE_HEAD_TAGS.forEach(createAndInjectTag);\n  if (scene.isIOS) {\n    MOBILE_IOS_HEAD_TAGS.forEach(createAndInjectTag);\n  }\n  return headTags;\n\n  function createAndInjectTag (tagObj) {\n    if (!tagObj || tagObj.exists()) { return; }\n\n    tag = createTag(tagObj);\n    if (!tag) { return; }\n\n    if (headScriptEl) {\n      headScriptEl.parentNode.insertBefore(tag, headScriptEl);\n    } else {\n      headEl.appendChild(tag);\n    }\n\n    headTags.push(tag);\n  }\n};\n\nfunction createTag (tagObj) {\n  if (!tagObj || !tagObj.tagName) { return; }\n  var meta = document.createElement(tagObj.tagName);\n  meta.setAttribute(constants.AFRAME_INJECTED, '');\n  return extend(meta, tagObj.attributes);\n}\n","var bind = require('../../utils/bind');\nvar isIframed = require('../../utils/').isIframed;\n\n/**\n * Provides a post message API for scenes contained\n * in an iframe.\n */\nmodule.exports = function initPostMessageAPI (scene) {\n  // Handles fullscreen behavior when inside an iframe.\n  if (!isIframed()) { return; }\n  // postMessage API handler\n  window.addEventListener('message', bind(postMessageAPIHandler, scene));\n};\n\nfunction postMessageAPIHandler (event) {\n  var scene = this;\n  if (!event.data) { return; }\n\n  switch (event.data.type) {\n    case 'vr': {\n      switch (event.data.data) {\n        case 'enter':\n          scene.enterVR();\n          break;\n        case 'exit':\n          scene.exitVR();\n          break;\n      }\n    }\n  }\n}\n","var registerComponent = require('../../core/component').registerComponent;\nvar THREE = require('../../lib/three');\n\nvar originalPosition = new THREE.Vector3();\nvar originalRotation = new THREE.Vector3();\n\n/**\n * Wrap el.object3D within an outer group. Apply pivot to el.object3D as position.\n */\nregisterComponent('pivot', {\n  dependencies: ['position'],\n\n  schema: {type: 'vec3'},\n\n  init: function () {\n    var data = this.data;\n    var el = this.el;\n    var originalParent = el.object3D.parent;\n    var originalGroup = el.object3D;\n    var outerGroup = new THREE.Group();\n\n    originalPosition.copy(originalGroup.position);\n    originalRotation.copy(originalGroup.rotation);\n\n    // Detach current group from parent.\n    originalParent.remove(originalGroup);\n    outerGroup.add(originalGroup);\n\n    // Set new group as the outer group.\n    originalParent.add(outerGroup);\n\n    // Set outer group as new object3D.\n    el.object3D = outerGroup;\n\n    // Apply pivot to original group.\n    originalGroup.position.set(-1 * data.x, -1 * data.y, -1 * data.z);\n\n    // Offset the pivot so that world position not affected.\n    // And restore position onto outer group.\n    outerGroup.position.set(data.x + originalPosition.x, data.y + originalPosition.y,\n                            data.z + originalPosition.z);\n\n    // Transfer rotation to outer group.\n    outerGroup.rotation.copy(originalGroup.rotation);\n    originalGroup.rotation.set(0, 0, 0);\n  }\n});\n","var self = self || {};// File:src/Three.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nvar THREE = { REVISION: '76' };\r\n\r\n//\r\n\r\nif ( typeof define === 'function' && define.amd ) {\r\n\r\n\tdefine( 'three', THREE );\r\n\r\n} else if ( 'undefined' !== typeof exports && 'undefined' !== typeof module ) {\r\n\r\n\tmodule.exports = THREE;\r\n\r\n}\r\n\r\n//\r\n\r\nif ( Number.EPSILON === undefined ) {\r\n\r\n\tNumber.EPSILON = Math.pow( 2, - 52 );\r\n\r\n}\r\n\r\n//\r\n\r\nif ( Math.sign === undefined ) {\r\n\r\n\t// https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Math/sign\r\n\r\n\tMath.sign = function ( x ) {\r\n\r\n\t\treturn ( x < 0 ) ? - 1 : ( x > 0 ) ? 1 : + x;\r\n\r\n\t};\r\n\r\n}\r\n\r\nif ( Function.prototype.name === undefined && Object.defineProperty !== undefined ) {\r\n\r\n\t// Missing in IE9-11.\r\n\t// https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function/name\r\n\r\n\tObject.defineProperty( Function.prototype, 'name', {\r\n\r\n\t\tget: function () {\r\n\r\n\t\t\treturn this.toString().match( /^\\s*function\\s*(\\S*)\\s*\\(/ )[ 1 ];\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n}\r\n\r\nif ( Object.assign === undefined ) {\r\n\r\n\t// https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/assign\r\n\r\n\tObject.defineProperty( Object, 'assign', {\r\n\r\n\t\twritable: true,\r\n\t\tconfigurable: true,\r\n\r\n\t\tvalue: function ( target ) {\r\n\r\n\t\t\t'use strict';\r\n\r\n\t\t\tif ( target === undefined || target === null ) {\r\n\r\n\t\t\t\tthrow new TypeError( \"Cannot convert first argument to object\" );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar to = Object( target );\r\n\r\n\t\t\tfor ( var i = 1, n = arguments.length; i !== n; ++ i ) {\r\n\r\n\t\t\t\tvar nextSource = arguments[ i ];\r\n\r\n\t\t\t\tif ( nextSource === undefined || nextSource === null ) continue;\r\n\r\n\t\t\t\tnextSource = Object( nextSource );\r\n\r\n\t\t\t\tvar keysArray = Object.keys( nextSource );\r\n\r\n\t\t\t\tfor ( var nextIndex = 0, len = keysArray.length; nextIndex !== len; ++ nextIndex ) {\r\n\r\n\t\t\t\t\tvar nextKey = keysArray[ nextIndex ];\r\n\t\t\t\t\tvar desc = Object.getOwnPropertyDescriptor( nextSource, nextKey );\r\n\r\n\t\t\t\t\tif ( desc !== undefined && desc.enumerable ) {\r\n\r\n\t\t\t\t\t\tto[ nextKey ] = nextSource[ nextKey ];\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn to;\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n}\r\n\r\n// https://developer.mozilla.org/en-US/docs/Web/API/MouseEvent.button\r\n\r\nTHREE.MOUSE = { LEFT: 0, MIDDLE: 1, RIGHT: 2 };\r\n\r\n// GL STATE CONSTANTS\r\n\r\nTHREE.CullFaceNone = 0;\r\nTHREE.CullFaceBack = 1;\r\nTHREE.CullFaceFront = 2;\r\nTHREE.CullFaceFrontBack = 3;\r\n\r\nTHREE.FrontFaceDirectionCW = 0;\r\nTHREE.FrontFaceDirectionCCW = 1;\r\n\r\n// SHADOWING TYPES\r\n\r\nTHREE.BasicShadowMap = 0;\r\nTHREE.PCFShadowMap = 1;\r\nTHREE.PCFSoftShadowMap = 2;\r\n\r\n// MATERIAL CONSTANTS\r\n\r\n// side\r\n\r\nTHREE.FrontSide = 0;\r\nTHREE.BackSide = 1;\r\nTHREE.DoubleSide = 2;\r\n\r\n// shading\r\n\r\nTHREE.FlatShading = 1;\r\nTHREE.SmoothShading = 2;\r\n\r\n// colors\r\n\r\nTHREE.NoColors = 0;\r\nTHREE.FaceColors = 1;\r\nTHREE.VertexColors = 2;\r\n\r\n// blending modes\r\n\r\nTHREE.NoBlending = 0;\r\nTHREE.NormalBlending = 1;\r\nTHREE.AdditiveBlending = 2;\r\nTHREE.SubtractiveBlending = 3;\r\nTHREE.MultiplyBlending = 4;\r\nTHREE.CustomBlending = 5;\r\n\r\n// custom blending equations\r\n// (numbers start from 100 not to clash with other\r\n// mappings to OpenGL constants defined in Texture.js)\r\n\r\nTHREE.AddEquation = 100;\r\nTHREE.SubtractEquation = 101;\r\nTHREE.ReverseSubtractEquation = 102;\r\nTHREE.MinEquation = 103;\r\nTHREE.MaxEquation = 104;\r\n\r\n// custom blending destination factors\r\n\r\nTHREE.ZeroFactor = 200;\r\nTHREE.OneFactor = 201;\r\nTHREE.SrcColorFactor = 202;\r\nTHREE.OneMinusSrcColorFactor = 203;\r\nTHREE.SrcAlphaFactor = 204;\r\nTHREE.OneMinusSrcAlphaFactor = 205;\r\nTHREE.DstAlphaFactor = 206;\r\nTHREE.OneMinusDstAlphaFactor = 207;\r\n\r\n// custom blending source factors\r\n\r\n//THREE.ZeroFactor = 200;\r\n//THREE.OneFactor = 201;\r\n//THREE.SrcAlphaFactor = 204;\r\n//THREE.OneMinusSrcAlphaFactor = 205;\r\n//THREE.DstAlphaFactor = 206;\r\n//THREE.OneMinusDstAlphaFactor = 207;\r\nTHREE.DstColorFactor = 208;\r\nTHREE.OneMinusDstColorFactor = 209;\r\nTHREE.SrcAlphaSaturateFactor = 210;\r\n\r\n// depth modes\r\n\r\nTHREE.NeverDepth = 0;\r\nTHREE.AlwaysDepth = 1;\r\nTHREE.LessDepth = 2;\r\nTHREE.LessEqualDepth = 3;\r\nTHREE.EqualDepth = 4;\r\nTHREE.GreaterEqualDepth = 5;\r\nTHREE.GreaterDepth = 6;\r\nTHREE.NotEqualDepth = 7;\r\n\r\n\r\n// TEXTURE CONSTANTS\r\n\r\nTHREE.MultiplyOperation = 0;\r\nTHREE.MixOperation = 1;\r\nTHREE.AddOperation = 2;\r\n\r\n// Tone Mapping modes\r\n\r\nTHREE.NoToneMapping = 0; // do not do any tone mapping, not even exposure (required for special purpose passes.)\r\nTHREE.LinearToneMapping = 1; // only apply exposure.\r\nTHREE.ReinhardToneMapping = 2;\r\nTHREE.Uncharted2ToneMapping = 3; // John Hable\r\nTHREE.CineonToneMapping = 4;  // optimized filmic operator by Jim Hejl and Richard Burgess-Dawson\r\n\r\n// Mapping modes\r\n\r\nTHREE.UVMapping = 300;\r\n\r\nTHREE.CubeReflectionMapping = 301;\r\nTHREE.CubeRefractionMapping = 302;\r\n\r\nTHREE.EquirectangularReflectionMapping = 303;\r\nTHREE.EquirectangularRefractionMapping = 304;\r\n\r\nTHREE.SphericalReflectionMapping = 305;\r\nTHREE.CubeUVReflectionMapping = 306;\r\nTHREE.CubeUVRefractionMapping = 307;\r\n\r\n// Wrapping modes\r\n\r\nTHREE.RepeatWrapping = 1000;\r\nTHREE.ClampToEdgeWrapping = 1001;\r\nTHREE.MirroredRepeatWrapping = 1002;\r\n\r\n// Filters\r\n\r\nTHREE.NearestFilter = 1003;\r\nTHREE.NearestMipMapNearestFilter = 1004;\r\nTHREE.NearestMipMapLinearFilter = 1005;\r\nTHREE.LinearFilter = 1006;\r\nTHREE.LinearMipMapNearestFilter = 1007;\r\nTHREE.LinearMipMapLinearFilter = 1008;\r\n\r\n// Data types\r\n\r\nTHREE.UnsignedByteType = 1009;\r\nTHREE.ByteType = 1010;\r\nTHREE.ShortType = 1011;\r\nTHREE.UnsignedShortType = 1012;\r\nTHREE.IntType = 1013;\r\nTHREE.UnsignedIntType = 1014;\r\nTHREE.FloatType = 1015;\r\nTHREE.HalfFloatType = 1025;\r\n\r\n// Pixel types\r\n\r\n//THREE.UnsignedByteType = 1009;\r\nTHREE.UnsignedShort4444Type = 1016;\r\nTHREE.UnsignedShort5551Type = 1017;\r\nTHREE.UnsignedShort565Type = 1018;\r\n\r\n// Pixel formats\r\n\r\nTHREE.AlphaFormat = 1019;\r\nTHREE.RGBFormat = 1020;\r\nTHREE.RGBAFormat = 1021;\r\nTHREE.LuminanceFormat = 1022;\r\nTHREE.LuminanceAlphaFormat = 1023;\r\n// THREE.RGBEFormat handled as THREE.RGBAFormat in shaders\r\nTHREE.RGBEFormat = THREE.RGBAFormat; //1024;\r\nTHREE.DepthFormat = 1026;\r\n\r\n// DDS / ST3C Compressed texture formats\r\n\r\nTHREE.RGB_S3TC_DXT1_Format = 2001;\r\nTHREE.RGBA_S3TC_DXT1_Format = 2002;\r\nTHREE.RGBA_S3TC_DXT3_Format = 2003;\r\nTHREE.RGBA_S3TC_DXT5_Format = 2004;\r\n\r\n\r\n// PVRTC compressed texture formats\r\n\r\nTHREE.RGB_PVRTC_4BPPV1_Format = 2100;\r\nTHREE.RGB_PVRTC_2BPPV1_Format = 2101;\r\nTHREE.RGBA_PVRTC_4BPPV1_Format = 2102;\r\nTHREE.RGBA_PVRTC_2BPPV1_Format = 2103;\r\n\r\n// ETC compressed texture formats\r\n\r\nTHREE.RGB_ETC1_Format = 2151;\r\n\r\n// Loop styles for AnimationAction\r\n\r\nTHREE.LoopOnce = 2200;\r\nTHREE.LoopRepeat = 2201;\r\nTHREE.LoopPingPong = 2202;\r\n\r\n// Interpolation\r\n\r\nTHREE.InterpolateDiscrete = 2300;\r\nTHREE.InterpolateLinear = 2301;\r\nTHREE.InterpolateSmooth = 2302;\r\n\r\n// Interpolant ending modes\r\n\r\nTHREE.ZeroCurvatureEnding = 2400;\r\nTHREE.ZeroSlopeEnding = 2401;\r\nTHREE.WrapAroundEnding = 2402;\r\n\r\n// Triangle Draw modes\r\n\r\nTHREE.TrianglesDrawMode = 0;\r\nTHREE.TriangleStripDrawMode = 1;\r\nTHREE.TriangleFanDrawMode = 2;\r\n\r\n// Texture Encodings\r\n\r\nTHREE.LinearEncoding = 3000; // No encoding at all.\r\nTHREE.sRGBEncoding = 3001;\r\nTHREE.GammaEncoding = 3007; // uses GAMMA_FACTOR, for backwards compatibility with WebGLRenderer.gammaInput/gammaOutput\r\n\r\n// The following Texture Encodings are for RGB-only (no alpha) HDR light emission sources.\r\n// These encodings should not specified as output encodings except in rare situations.\r\nTHREE.RGBEEncoding = 3002; // AKA Radiance.\r\nTHREE.LogLuvEncoding = 3003;\r\nTHREE.RGBM7Encoding = 3004;\r\nTHREE.RGBM16Encoding = 3005;\r\nTHREE.RGBDEncoding = 3006; // MaxRange is 256.\r\n\r\n// Depth packing strategies\r\n\r\nTHREE.BasicDepthPacking = 3200;  // for writing to float textures for high precision or for visualizing results in RGB buffers\r\nTHREE.RGBADepthPacking = 3201; // for packing into RGBA buffers.\r\n\r\n// File:src/math/Color.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.Color = function ( color ) {\r\n\r\n\tif ( arguments.length === 3 ) {\r\n\r\n\t\treturn this.fromArray( arguments );\r\n\r\n\t}\r\n\r\n\treturn this.set( color );\r\n\r\n};\r\n\r\nTHREE.Color.prototype = {\r\n\r\n\tconstructor: THREE.Color,\r\n\r\n\tr: 1, g: 1, b: 1,\r\n\r\n\tset: function ( value ) {\r\n\r\n\t\tif ( value instanceof THREE.Color ) {\r\n\r\n\t\t\tthis.copy( value );\r\n\r\n\t\t} else if ( typeof value === 'number' ) {\r\n\r\n\t\t\tthis.setHex( value );\r\n\r\n\t\t} else if ( typeof value === 'string' ) {\r\n\r\n\t\t\tthis.setStyle( value );\r\n\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tsetScalar: function ( scalar ) {\r\n\r\n\t\tthis.r = scalar;\r\n\t\tthis.g = scalar;\r\n\t\tthis.b = scalar;\r\n\r\n\t},\r\n\r\n\tsetHex: function ( hex ) {\r\n\r\n\t\thex = Math.floor( hex );\r\n\r\n\t\tthis.r = ( hex >> 16 & 255 ) / 255;\r\n\t\tthis.g = ( hex >> 8 & 255 ) / 255;\r\n\t\tthis.b = ( hex & 255 ) / 255;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tsetRGB: function ( r, g, b ) {\r\n\r\n\t\tthis.r = r;\r\n\t\tthis.g = g;\r\n\t\tthis.b = b;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tsetHSL: function () {\r\n\r\n\t\tfunction hue2rgb( p, q, t ) {\r\n\r\n\t\t\tif ( t < 0 ) t += 1;\r\n\t\t\tif ( t > 1 ) t -= 1;\r\n\t\t\tif ( t < 1 / 6 ) return p + ( q - p ) * 6 * t;\r\n\t\t\tif ( t < 1 / 2 ) return q;\r\n\t\t\tif ( t < 2 / 3 ) return p + ( q - p ) * 6 * ( 2 / 3 - t );\r\n\t\t\treturn p;\r\n\r\n\t\t}\r\n\r\n\t\treturn function ( h, s, l ) {\r\n\r\n\t\t\t// h,s,l ranges are in 0.0 - 1.0\r\n\t\t\th = THREE.Math.euclideanModulo( h, 1 );\r\n\t\t\ts = THREE.Math.clamp( s, 0, 1 );\r\n\t\t\tl = THREE.Math.clamp( l, 0, 1 );\r\n\r\n\t\t\tif ( s === 0 ) {\r\n\r\n\t\t\t\tthis.r = this.g = this.b = l;\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tvar p = l <= 0.5 ? l * ( 1 + s ) : l + s - ( l * s );\r\n\t\t\t\tvar q = ( 2 * l ) - p;\r\n\r\n\t\t\t\tthis.r = hue2rgb( q, p, h + 1 / 3 );\r\n\t\t\t\tthis.g = hue2rgb( q, p, h );\r\n\t\t\t\tthis.b = hue2rgb( q, p, h - 1 / 3 );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\tsetStyle: function ( style ) {\r\n\r\n\t\tfunction handleAlpha( string ) {\r\n\r\n\t\t\tif ( string === undefined ) return;\r\n\r\n\t\t\tif ( parseFloat( string ) < 1 ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.Color: Alpha component of ' + style + ' will be ignored.' );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\r\n\t\tvar m;\r\n\r\n\t\tif ( m = /^((?:rgb|hsl)a?)\\(\\s*([^\\)]*)\\)/.exec( style ) ) {\r\n\r\n\t\t\t// rgb / hsl\r\n\r\n\t\t\tvar color;\r\n\t\t\tvar name = m[ 1 ];\r\n\t\t\tvar components = m[ 2 ];\r\n\r\n\t\t\tswitch ( name ) {\r\n\r\n\t\t\t\tcase 'rgb':\r\n\t\t\t\tcase 'rgba':\r\n\r\n\t\t\t\t\tif ( color = /^(\\d+)\\s*,\\s*(\\d+)\\s*,\\s*(\\d+)\\s*(,\\s*([0-9]*\\.?[0-9]+)\\s*)?$/.exec( components ) ) {\r\n\r\n\t\t\t\t\t\t// rgb(255,0,0) rgba(255,0,0,0.5)\r\n\t\t\t\t\t\tthis.r = Math.min( 255, parseInt( color[ 1 ], 10 ) ) / 255;\r\n\t\t\t\t\t\tthis.g = Math.min( 255, parseInt( color[ 2 ], 10 ) ) / 255;\r\n\t\t\t\t\t\tthis.b = Math.min( 255, parseInt( color[ 3 ], 10 ) ) / 255;\r\n\r\n\t\t\t\t\t\thandleAlpha( color[ 5 ] );\r\n\r\n\t\t\t\t\t\treturn this;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif ( color = /^(\\d+)\\%\\s*,\\s*(\\d+)\\%\\s*,\\s*(\\d+)\\%\\s*(,\\s*([0-9]*\\.?[0-9]+)\\s*)?$/.exec( components ) ) {\r\n\r\n\t\t\t\t\t\t// rgb(100%,0%,0%) rgba(100%,0%,0%,0.5)\r\n\t\t\t\t\t\tthis.r = Math.min( 100, parseInt( color[ 1 ], 10 ) ) / 100;\r\n\t\t\t\t\t\tthis.g = Math.min( 100, parseInt( color[ 2 ], 10 ) ) / 100;\r\n\t\t\t\t\t\tthis.b = Math.min( 100, parseInt( color[ 3 ], 10 ) ) / 100;\r\n\r\n\t\t\t\t\t\thandleAlpha( color[ 5 ] );\r\n\r\n\t\t\t\t\t\treturn this;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'hsl':\r\n\t\t\t\tcase 'hsla':\r\n\r\n\t\t\t\t\tif ( color = /^([0-9]*\\.?[0-9]+)\\s*,\\s*(\\d+)\\%\\s*,\\s*(\\d+)\\%\\s*(,\\s*([0-9]*\\.?[0-9]+)\\s*)?$/.exec( components ) ) {\r\n\r\n\t\t\t\t\t\t// hsl(120,50%,50%) hsla(120,50%,50%,0.5)\r\n\t\t\t\t\t\tvar h = parseFloat( color[ 1 ] ) / 360;\r\n\t\t\t\t\t\tvar s = parseInt( color[ 2 ], 10 ) / 100;\r\n\t\t\t\t\t\tvar l = parseInt( color[ 3 ], 10 ) / 100;\r\n\r\n\t\t\t\t\t\thandleAlpha( color[ 5 ] );\r\n\r\n\t\t\t\t\t\treturn this.setHSL( h, s, l );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t}\r\n\r\n\t\t} else if ( m = /^\\#([A-Fa-f0-9]+)$/.exec( style ) ) {\r\n\r\n\t\t\t// hex color\r\n\r\n\t\t\tvar hex = m[ 1 ];\r\n\t\t\tvar size = hex.length;\r\n\r\n\t\t\tif ( size === 3 ) {\r\n\r\n\t\t\t\t// #ff0\r\n\t\t\t\tthis.r = parseInt( hex.charAt( 0 ) + hex.charAt( 0 ), 16 ) / 255;\r\n\t\t\t\tthis.g = parseInt( hex.charAt( 1 ) + hex.charAt( 1 ), 16 ) / 255;\r\n\t\t\t\tthis.b = parseInt( hex.charAt( 2 ) + hex.charAt( 2 ), 16 ) / 255;\r\n\r\n\t\t\t\treturn this;\r\n\r\n\t\t\t} else if ( size === 6 ) {\r\n\r\n\t\t\t\t// #ff0000\r\n\t\t\t\tthis.r = parseInt( hex.charAt( 0 ) + hex.charAt( 1 ), 16 ) / 255;\r\n\t\t\t\tthis.g = parseInt( hex.charAt( 2 ) + hex.charAt( 3 ), 16 ) / 255;\r\n\t\t\t\tthis.b = parseInt( hex.charAt( 4 ) + hex.charAt( 5 ), 16 ) / 255;\r\n\r\n\t\t\t\treturn this;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tif ( style && style.length > 0 ) {\r\n\r\n\t\t\t// color keywords\r\n\t\t\tvar hex = THREE.ColorKeywords[ style ];\r\n\r\n\t\t\tif ( hex !== undefined ) {\r\n\r\n\t\t\t\t// red\r\n\t\t\t\tthis.setHex( hex );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\t// unknown color\r\n\t\t\t\tconsole.warn( 'THREE.Color: Unknown color ' + style );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tclone: function () {\r\n\r\n\t\treturn new this.constructor( this.r, this.g, this.b );\r\n\r\n\t},\r\n\r\n\tcopy: function ( color ) {\r\n\r\n\t\tthis.r = color.r;\r\n\t\tthis.g = color.g;\r\n\t\tthis.b = color.b;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tcopyGammaToLinear: function ( color, gammaFactor ) {\r\n\r\n\t\tif ( gammaFactor === undefined ) gammaFactor = 2.0;\r\n\r\n\t\tthis.r = Math.pow( color.r, gammaFactor );\r\n\t\tthis.g = Math.pow( color.g, gammaFactor );\r\n\t\tthis.b = Math.pow( color.b, gammaFactor );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tcopyLinearToGamma: function ( color, gammaFactor ) {\r\n\r\n\t\tif ( gammaFactor === undefined ) gammaFactor = 2.0;\r\n\r\n\t\tvar safeInverse = ( gammaFactor > 0 ) ? ( 1.0 / gammaFactor ) : 1.0;\r\n\r\n\t\tthis.r = Math.pow( color.r, safeInverse );\r\n\t\tthis.g = Math.pow( color.g, safeInverse );\r\n\t\tthis.b = Math.pow( color.b, safeInverse );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tconvertGammaToLinear: function () {\r\n\r\n\t\tvar r = this.r, g = this.g, b = this.b;\r\n\r\n\t\tthis.r = r * r;\r\n\t\tthis.g = g * g;\r\n\t\tthis.b = b * b;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tconvertLinearToGamma: function () {\r\n\r\n\t\tthis.r = Math.sqrt( this.r );\r\n\t\tthis.g = Math.sqrt( this.g );\r\n\t\tthis.b = Math.sqrt( this.b );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tgetHex: function () {\r\n\r\n\t\treturn ( this.r * 255 ) << 16 ^ ( this.g * 255 ) << 8 ^ ( this.b * 255 ) << 0;\r\n\r\n\t},\r\n\r\n\tgetHexString: function () {\r\n\r\n\t\treturn ( '000000' + this.getHex().toString( 16 ) ).slice( - 6 );\r\n\r\n\t},\r\n\r\n\tgetHSL: function ( optionalTarget ) {\r\n\r\n\t\t// h,s,l ranges are in 0.0 - 1.0\r\n\r\n\t\tvar hsl = optionalTarget || { h: 0, s: 0, l: 0 };\r\n\r\n\t\tvar r = this.r, g = this.g, b = this.b;\r\n\r\n\t\tvar max = Math.max( r, g, b );\r\n\t\tvar min = Math.min( r, g, b );\r\n\r\n\t\tvar hue, saturation;\r\n\t\tvar lightness = ( min + max ) / 2.0;\r\n\r\n\t\tif ( min === max ) {\r\n\r\n\t\t\thue = 0;\r\n\t\t\tsaturation = 0;\r\n\r\n\t\t} else {\r\n\r\n\t\t\tvar delta = max - min;\r\n\r\n\t\t\tsaturation = lightness <= 0.5 ? delta / ( max + min ) : delta / ( 2 - max - min );\r\n\r\n\t\t\tswitch ( max ) {\r\n\r\n\t\t\t\tcase r: hue = ( g - b ) / delta + ( g < b ? 6 : 0 ); break;\r\n\t\t\t\tcase g: hue = ( b - r ) / delta + 2; break;\r\n\t\t\t\tcase b: hue = ( r - g ) / delta + 4; break;\r\n\r\n\t\t\t}\r\n\r\n\t\t\thue /= 6;\r\n\r\n\t\t}\r\n\r\n\t\thsl.h = hue;\r\n\t\thsl.s = saturation;\r\n\t\thsl.l = lightness;\r\n\r\n\t\treturn hsl;\r\n\r\n\t},\r\n\r\n\tgetStyle: function () {\r\n\r\n\t\treturn 'rgb(' + ( ( this.r * 255 ) | 0 ) + ',' + ( ( this.g * 255 ) | 0 ) + ',' + ( ( this.b * 255 ) | 0 ) + ')';\r\n\r\n\t},\r\n\r\n\toffsetHSL: function ( h, s, l ) {\r\n\r\n\t\tvar hsl = this.getHSL();\r\n\r\n\t\thsl.h += h; hsl.s += s; hsl.l += l;\r\n\r\n\t\tthis.setHSL( hsl.h, hsl.s, hsl.l );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tadd: function ( color ) {\r\n\r\n\t\tthis.r += color.r;\r\n\t\tthis.g += color.g;\r\n\t\tthis.b += color.b;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\taddColors: function ( color1, color2 ) {\r\n\r\n\t\tthis.r = color1.r + color2.r;\r\n\t\tthis.g = color1.g + color2.g;\r\n\t\tthis.b = color1.b + color2.b;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\taddScalar: function ( s ) {\r\n\r\n\t\tthis.r += s;\r\n\t\tthis.g += s;\r\n\t\tthis.b += s;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tmultiply: function ( color ) {\r\n\r\n\t\tthis.r *= color.r;\r\n\t\tthis.g *= color.g;\r\n\t\tthis.b *= color.b;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tmultiplyScalar: function ( s ) {\r\n\r\n\t\tthis.r *= s;\r\n\t\tthis.g *= s;\r\n\t\tthis.b *= s;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tlerp: function ( color, alpha ) {\r\n\r\n\t\tthis.r += ( color.r - this.r ) * alpha;\r\n\t\tthis.g += ( color.g - this.g ) * alpha;\r\n\t\tthis.b += ( color.b - this.b ) * alpha;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tequals: function ( c ) {\r\n\r\n\t\treturn ( c.r === this.r ) && ( c.g === this.g ) && ( c.b === this.b );\r\n\r\n\t},\r\n\r\n\tfromArray: function ( array, offset ) {\r\n\r\n\t\tif ( offset === undefined ) offset = 0;\r\n\r\n\t\tthis.r = array[ offset ];\r\n\t\tthis.g = array[ offset + 1 ];\r\n\t\tthis.b = array[ offset + 2 ];\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\ttoArray: function ( array, offset ) {\r\n\r\n\t\tif ( array === undefined ) array = [];\r\n\t\tif ( offset === undefined ) offset = 0;\r\n\r\n\t\tarray[ offset ] = this.r;\r\n\t\tarray[ offset + 1 ] = this.g;\r\n\t\tarray[ offset + 2 ] = this.b;\r\n\r\n\t\treturn array;\r\n\r\n\t}\r\n\r\n};\r\n\r\nTHREE.ColorKeywords = { 'aliceblue': 0xF0F8FF, 'antiquewhite': 0xFAEBD7, 'aqua': 0x00FFFF, 'aquamarine': 0x7FFFD4, 'azure': 0xF0FFFF,\r\n'beige': 0xF5F5DC, 'bisque': 0xFFE4C4, 'black': 0x000000, 'blanchedalmond': 0xFFEBCD, 'blue': 0x0000FF, 'blueviolet': 0x8A2BE2,\r\n'brown': 0xA52A2A, 'burlywood': 0xDEB887, 'cadetblue': 0x5F9EA0, 'chartreuse': 0x7FFF00, 'chocolate': 0xD2691E, 'coral': 0xFF7F50,\r\n'cornflowerblue': 0x6495ED, 'cornsilk': 0xFFF8DC, 'crimson': 0xDC143C, 'cyan': 0x00FFFF, 'darkblue': 0x00008B, 'darkcyan': 0x008B8B,\r\n'darkgoldenrod': 0xB8860B, 'darkgray': 0xA9A9A9, 'darkgreen': 0x006400, 'darkgrey': 0xA9A9A9, 'darkkhaki': 0xBDB76B, 'darkmagenta': 0x8B008B,\r\n'darkolivegreen': 0x556B2F, 'darkorange': 0xFF8C00, 'darkorchid': 0x9932CC, 'darkred': 0x8B0000, 'darksalmon': 0xE9967A, 'darkseagreen': 0x8FBC8F,\r\n'darkslateblue': 0x483D8B, 'darkslategray': 0x2F4F4F, 'darkslategrey': 0x2F4F4F, 'darkturquoise': 0x00CED1, 'darkviolet': 0x9400D3,\r\n'deeppink': 0xFF1493, 'deepskyblue': 0x00BFFF, 'dimgray': 0x696969, 'dimgrey': 0x696969, 'dodgerblue': 0x1E90FF, 'firebrick': 0xB22222,\r\n'floralwhite': 0xFFFAF0, 'forestgreen': 0x228B22, 'fuchsia': 0xFF00FF, 'gainsboro': 0xDCDCDC, 'ghostwhite': 0xF8F8FF, 'gold': 0xFFD700,\r\n'goldenrod': 0xDAA520, 'gray': 0x808080, 'green': 0x008000, 'greenyellow': 0xADFF2F, 'grey': 0x808080, 'honeydew': 0xF0FFF0, 'hotpink': 0xFF69B4,\r\n'indianred': 0xCD5C5C, 'indigo': 0x4B0082, 'ivory': 0xFFFFF0, 'khaki': 0xF0E68C, 'lavender': 0xE6E6FA, 'lavenderblush': 0xFFF0F5, 'lawngreen': 0x7CFC00,\r\n'lemonchiffon': 0xFFFACD, 'lightblue': 0xADD8E6, 'lightcoral': 0xF08080, 'lightcyan': 0xE0FFFF, 'lightgoldenrodyellow': 0xFAFAD2, 'lightgray': 0xD3D3D3,\r\n'lightgreen': 0x90EE90, 'lightgrey': 0xD3D3D3, 'lightpink': 0xFFB6C1, 'lightsalmon': 0xFFA07A, 'lightseagreen': 0x20B2AA, 'lightskyblue': 0x87CEFA,\r\n'lightslategray': 0x778899, 'lightslategrey': 0x778899, 'lightsteelblue': 0xB0C4DE, 'lightyellow': 0xFFFFE0, 'lime': 0x00FF00, 'limegreen': 0x32CD32,\r\n'linen': 0xFAF0E6, 'magenta': 0xFF00FF, 'maroon': 0x800000, 'mediumaquamarine': 0x66CDAA, 'mediumblue': 0x0000CD, 'mediumorchid': 0xBA55D3,\r\n'mediumpurple': 0x9370DB, 'mediumseagreen': 0x3CB371, 'mediumslateblue': 0x7B68EE, 'mediumspringgreen': 0x00FA9A, 'mediumturquoise': 0x48D1CC,\r\n'mediumvioletred': 0xC71585, 'midnightblue': 0x191970, 'mintcream': 0xF5FFFA, 'mistyrose': 0xFFE4E1, 'moccasin': 0xFFE4B5, 'navajowhite': 0xFFDEAD,\r\n'navy': 0x000080, 'oldlace': 0xFDF5E6, 'olive': 0x808000, 'olivedrab': 0x6B8E23, 'orange': 0xFFA500, 'orangered': 0xFF4500, 'orchid': 0xDA70D6,\r\n'palegoldenrod': 0xEEE8AA, 'palegreen': 0x98FB98, 'paleturquoise': 0xAFEEEE, 'palevioletred': 0xDB7093, 'papayawhip': 0xFFEFD5, 'peachpuff': 0xFFDAB9,\r\n'peru': 0xCD853F, 'pink': 0xFFC0CB, 'plum': 0xDDA0DD, 'powderblue': 0xB0E0E6, 'purple': 0x800080, 'red': 0xFF0000, 'rosybrown': 0xBC8F8F,\r\n'royalblue': 0x4169E1, 'saddlebrown': 0x8B4513, 'salmon': 0xFA8072, 'sandybrown': 0xF4A460, 'seagreen': 0x2E8B57, 'seashell': 0xFFF5EE,\r\n'sienna': 0xA0522D, 'silver': 0xC0C0C0, 'skyblue': 0x87CEEB, 'slateblue': 0x6A5ACD, 'slategray': 0x708090, 'slategrey': 0x708090, 'snow': 0xFFFAFA,\r\n'springgreen': 0x00FF7F, 'steelblue': 0x4682B4, 'tan': 0xD2B48C, 'teal': 0x008080, 'thistle': 0xD8BFD8, 'tomato': 0xFF6347, 'turquoise': 0x40E0D0,\r\n'violet': 0xEE82EE, 'wheat': 0xF5DEB3, 'white': 0xFFFFFF, 'whitesmoke': 0xF5F5F5, 'yellow': 0xFFFF00, 'yellowgreen': 0x9ACD32 };\r\n\r\n// File:src/math/Quaternion.js\r\n\r\n/**\r\n * @author mikael emtinger / http://gomo.se/\r\n * @author alteredq / http://alteredqualia.com/\r\n * @author WestLangley / http://github.com/WestLangley\r\n * @author bhouston / http://clara.io\r\n */\r\n\r\nTHREE.Quaternion = function ( x, y, z, w ) {\r\n\r\n\tthis._x = x || 0;\r\n\tthis._y = y || 0;\r\n\tthis._z = z || 0;\r\n\tthis._w = ( w !== undefined ) ? w : 1;\r\n\r\n};\r\n\r\nTHREE.Quaternion.prototype = {\r\n\r\n\tconstructor: THREE.Quaternion,\r\n\r\n\tget x () {\r\n\r\n\t\treturn this._x;\r\n\r\n\t},\r\n\r\n\tset x ( value ) {\r\n\r\n\t\tthis._x = value;\r\n\t\tthis.onChangeCallback();\r\n\r\n\t},\r\n\r\n\tget y () {\r\n\r\n\t\treturn this._y;\r\n\r\n\t},\r\n\r\n\tset y ( value ) {\r\n\r\n\t\tthis._y = value;\r\n\t\tthis.onChangeCallback();\r\n\r\n\t},\r\n\r\n\tget z () {\r\n\r\n\t\treturn this._z;\r\n\r\n\t},\r\n\r\n\tset z ( value ) {\r\n\r\n\t\tthis._z = value;\r\n\t\tthis.onChangeCallback();\r\n\r\n\t},\r\n\r\n\tget w () {\r\n\r\n\t\treturn this._w;\r\n\r\n\t},\r\n\r\n\tset w ( value ) {\r\n\r\n\t\tthis._w = value;\r\n\t\tthis.onChangeCallback();\r\n\r\n\t},\r\n\r\n\tset: function ( x, y, z, w ) {\r\n\r\n\t\tthis._x = x;\r\n\t\tthis._y = y;\r\n\t\tthis._z = z;\r\n\t\tthis._w = w;\r\n\r\n\t\tthis.onChangeCallback();\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tclone: function () {\r\n\r\n\t\treturn new this.constructor( this._x, this._y, this._z, this._w );\r\n\r\n\t},\r\n\r\n\tcopy: function ( quaternion ) {\r\n\r\n\t\tthis._x = quaternion.x;\r\n\t\tthis._y = quaternion.y;\r\n\t\tthis._z = quaternion.z;\r\n\t\tthis._w = quaternion.w;\r\n\r\n\t\tthis.onChangeCallback();\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tsetFromEuler: function ( euler, update ) {\r\n\r\n\t\tif ( euler instanceof THREE.Euler === false ) {\r\n\r\n\t\t\tthrow new Error( 'THREE.Quaternion: .setFromEuler() now expects a Euler rotation rather than a Vector3 and order.' );\r\n\r\n\t\t}\r\n\r\n\t\t// http://www.mathworks.com/matlabcentral/fileexchange/\r\n\t\t// \t20696-function-to-convert-between-dcm-euler-angles-quaternions-and-euler-vectors/\r\n\t\t//\tcontent/SpinCalc.m\r\n\r\n\t\tvar c1 = Math.cos( euler._x / 2 );\r\n\t\tvar c2 = Math.cos( euler._y / 2 );\r\n\t\tvar c3 = Math.cos( euler._z / 2 );\r\n\t\tvar s1 = Math.sin( euler._x / 2 );\r\n\t\tvar s2 = Math.sin( euler._y / 2 );\r\n\t\tvar s3 = Math.sin( euler._z / 2 );\r\n\r\n\t\tvar order = euler.order;\r\n\r\n\t\tif ( order === 'XYZ' ) {\r\n\r\n\t\t\tthis._x = s1 * c2 * c3 + c1 * s2 * s3;\r\n\t\t\tthis._y = c1 * s2 * c3 - s1 * c2 * s3;\r\n\t\t\tthis._z = c1 * c2 * s3 + s1 * s2 * c3;\r\n\t\t\tthis._w = c1 * c2 * c3 - s1 * s2 * s3;\r\n\r\n\t\t} else if ( order === 'YXZ' ) {\r\n\r\n\t\t\tthis._x = s1 * c2 * c3 + c1 * s2 * s3;\r\n\t\t\tthis._y = c1 * s2 * c3 - s1 * c2 * s3;\r\n\t\t\tthis._z = c1 * c2 * s3 - s1 * s2 * c3;\r\n\t\t\tthis._w = c1 * c2 * c3 + s1 * s2 * s3;\r\n\r\n\t\t} else if ( order === 'ZXY' ) {\r\n\r\n\t\t\tthis._x = s1 * c2 * c3 - c1 * s2 * s3;\r\n\t\t\tthis._y = c1 * s2 * c3 + s1 * c2 * s3;\r\n\t\t\tthis._z = c1 * c2 * s3 + s1 * s2 * c3;\r\n\t\t\tthis._w = c1 * c2 * c3 - s1 * s2 * s3;\r\n\r\n\t\t} else if ( order === 'ZYX' ) {\r\n\r\n\t\t\tthis._x = s1 * c2 * c3 - c1 * s2 * s3;\r\n\t\t\tthis._y = c1 * s2 * c3 + s1 * c2 * s3;\r\n\t\t\tthis._z = c1 * c2 * s3 - s1 * s2 * c3;\r\n\t\t\tthis._w = c1 * c2 * c3 + s1 * s2 * s3;\r\n\r\n\t\t} else if ( order === 'YZX' ) {\r\n\r\n\t\t\tthis._x = s1 * c2 * c3 + c1 * s2 * s3;\r\n\t\t\tthis._y = c1 * s2 * c3 + s1 * c2 * s3;\r\n\t\t\tthis._z = c1 * c2 * s3 - s1 * s2 * c3;\r\n\t\t\tthis._w = c1 * c2 * c3 - s1 * s2 * s3;\r\n\r\n\t\t} else if ( order === 'XZY' ) {\r\n\r\n\t\t\tthis._x = s1 * c2 * c3 - c1 * s2 * s3;\r\n\t\t\tthis._y = c1 * s2 * c3 - s1 * c2 * s3;\r\n\t\t\tthis._z = c1 * c2 * s3 + s1 * s2 * c3;\r\n\t\t\tthis._w = c1 * c2 * c3 + s1 * s2 * s3;\r\n\r\n\t\t}\r\n\r\n\t\tif ( update !== false ) this.onChangeCallback();\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tsetFromAxisAngle: function ( axis, angle ) {\r\n\r\n\t\t// http://www.euclideanspace.com/maths/geometry/rotations/conversions/angleToQuaternion/index.htm\r\n\r\n\t\t// assumes axis is normalized\r\n\r\n\t\tvar halfAngle = angle / 2, s = Math.sin( halfAngle );\r\n\r\n\t\tthis._x = axis.x * s;\r\n\t\tthis._y = axis.y * s;\r\n\t\tthis._z = axis.z * s;\r\n\t\tthis._w = Math.cos( halfAngle );\r\n\r\n\t\tthis.onChangeCallback();\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tsetFromRotationMatrix: function ( m ) {\r\n\r\n\t\t// http://www.euclideanspace.com/maths/geometry/rotations/conversions/matrixToQuaternion/index.htm\r\n\r\n\t\t// assumes the upper 3x3 of m is a pure rotation matrix (i.e, unscaled)\r\n\r\n\t\tvar te = m.elements,\r\n\r\n\t\t\tm11 = te[ 0 ], m12 = te[ 4 ], m13 = te[ 8 ],\r\n\t\t\tm21 = te[ 1 ], m22 = te[ 5 ], m23 = te[ 9 ],\r\n\t\t\tm31 = te[ 2 ], m32 = te[ 6 ], m33 = te[ 10 ],\r\n\r\n\t\t\ttrace = m11 + m22 + m33,\r\n\t\t\ts;\r\n\r\n\t\tif ( trace > 0 ) {\r\n\r\n\t\t\ts = 0.5 / Math.sqrt( trace + 1.0 );\r\n\r\n\t\t\tthis._w = 0.25 / s;\r\n\t\t\tthis._x = ( m32 - m23 ) * s;\r\n\t\t\tthis._y = ( m13 - m31 ) * s;\r\n\t\t\tthis._z = ( m21 - m12 ) * s;\r\n\r\n\t\t} else if ( m11 > m22 && m11 > m33 ) {\r\n\r\n\t\t\ts = 2.0 * Math.sqrt( 1.0 + m11 - m22 - m33 );\r\n\r\n\t\t\tthis._w = ( m32 - m23 ) / s;\r\n\t\t\tthis._x = 0.25 * s;\r\n\t\t\tthis._y = ( m12 + m21 ) / s;\r\n\t\t\tthis._z = ( m13 + m31 ) / s;\r\n\r\n\t\t} else if ( m22 > m33 ) {\r\n\r\n\t\t\ts = 2.0 * Math.sqrt( 1.0 + m22 - m11 - m33 );\r\n\r\n\t\t\tthis._w = ( m13 - m31 ) / s;\r\n\t\t\tthis._x = ( m12 + m21 ) / s;\r\n\t\t\tthis._y = 0.25 * s;\r\n\t\t\tthis._z = ( m23 + m32 ) / s;\r\n\r\n\t\t} else {\r\n\r\n\t\t\ts = 2.0 * Math.sqrt( 1.0 + m33 - m11 - m22 );\r\n\r\n\t\t\tthis._w = ( m21 - m12 ) / s;\r\n\t\t\tthis._x = ( m13 + m31 ) / s;\r\n\t\t\tthis._y = ( m23 + m32 ) / s;\r\n\t\t\tthis._z = 0.25 * s;\r\n\r\n\t\t}\r\n\r\n\t\tthis.onChangeCallback();\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tsetFromUnitVectors: function () {\r\n\r\n\t\t// http://lolengine.net/blog/2014/02/24/quaternion-from-two-vectors-final\r\n\r\n\t\t// assumes direction vectors vFrom and vTo are normalized\r\n\r\n\t\tvar v1, r;\r\n\r\n\t\tvar EPS = 0.000001;\r\n\r\n\t\treturn function ( vFrom, vTo ) {\r\n\r\n\t\t\tif ( v1 === undefined ) v1 = new THREE.Vector3();\r\n\r\n\t\t\tr = vFrom.dot( vTo ) + 1;\r\n\r\n\t\t\tif ( r < EPS ) {\r\n\r\n\t\t\t\tr = 0;\r\n\r\n\t\t\t\tif ( Math.abs( vFrom.x ) > Math.abs( vFrom.z ) ) {\r\n\r\n\t\t\t\t\tv1.set( - vFrom.y, vFrom.x, 0 );\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tv1.set( 0, - vFrom.z, vFrom.y );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tv1.crossVectors( vFrom, vTo );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tthis._x = v1.x;\r\n\t\t\tthis._y = v1.y;\r\n\t\t\tthis._z = v1.z;\r\n\t\t\tthis._w = r;\r\n\r\n\t\t\tthis.normalize();\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\tinverse: function () {\r\n\r\n\t\tthis.conjugate().normalize();\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tconjugate: function () {\r\n\r\n\t\tthis._x *= - 1;\r\n\t\tthis._y *= - 1;\r\n\t\tthis._z *= - 1;\r\n\r\n\t\tthis.onChangeCallback();\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tdot: function ( v ) {\r\n\r\n\t\treturn this._x * v._x + this._y * v._y + this._z * v._z + this._w * v._w;\r\n\r\n\t},\r\n\r\n\tlengthSq: function () {\r\n\r\n\t\treturn this._x * this._x + this._y * this._y + this._z * this._z + this._w * this._w;\r\n\r\n\t},\r\n\r\n\tlength: function () {\r\n\r\n\t\treturn Math.sqrt( this._x * this._x + this._y * this._y + this._z * this._z + this._w * this._w );\r\n\r\n\t},\r\n\r\n\tnormalize: function () {\r\n\r\n\t\tvar l = this.length();\r\n\r\n\t\tif ( l === 0 ) {\r\n\r\n\t\t\tthis._x = 0;\r\n\t\t\tthis._y = 0;\r\n\t\t\tthis._z = 0;\r\n\t\t\tthis._w = 1;\r\n\r\n\t\t} else {\r\n\r\n\t\t\tl = 1 / l;\r\n\r\n\t\t\tthis._x = this._x * l;\r\n\t\t\tthis._y = this._y * l;\r\n\t\t\tthis._z = this._z * l;\r\n\t\t\tthis._w = this._w * l;\r\n\r\n\t\t}\r\n\r\n\t\tthis.onChangeCallback();\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tmultiply: function ( q, p ) {\r\n\r\n\t\tif ( p !== undefined ) {\r\n\r\n\t\t\tconsole.warn( 'THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead.' );\r\n\t\t\treturn this.multiplyQuaternions( q, p );\r\n\r\n\t\t}\r\n\r\n\t\treturn this.multiplyQuaternions( this, q );\r\n\r\n\t},\r\n\r\n\tmultiplyQuaternions: function ( a, b ) {\r\n\r\n\t\t// from http://www.euclideanspace.com/maths/algebra/realNormedAlgebra/quaternions/code/index.htm\r\n\r\n\t\tvar qax = a._x, qay = a._y, qaz = a._z, qaw = a._w;\r\n\t\tvar qbx = b._x, qby = b._y, qbz = b._z, qbw = b._w;\r\n\r\n\t\tthis._x = qax * qbw + qaw * qbx + qay * qbz - qaz * qby;\r\n\t\tthis._y = qay * qbw + qaw * qby + qaz * qbx - qax * qbz;\r\n\t\tthis._z = qaz * qbw + qaw * qbz + qax * qby - qay * qbx;\r\n\t\tthis._w = qaw * qbw - qax * qbx - qay * qby - qaz * qbz;\r\n\r\n\t\tthis.onChangeCallback();\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tslerp: function ( qb, t ) {\r\n\r\n\t\tif ( t === 0 ) return this;\r\n\t\tif ( t === 1 ) return this.copy( qb );\r\n\r\n\t\tvar x = this._x, y = this._y, z = this._z, w = this._w;\r\n\r\n\t\t// http://www.euclideanspace.com/maths/algebra/realNormedAlgebra/quaternions/slerp/\r\n\r\n\t\tvar cosHalfTheta = w * qb._w + x * qb._x + y * qb._y + z * qb._z;\r\n\r\n\t\tif ( cosHalfTheta < 0 ) {\r\n\r\n\t\t\tthis._w = - qb._w;\r\n\t\t\tthis._x = - qb._x;\r\n\t\t\tthis._y = - qb._y;\r\n\t\t\tthis._z = - qb._z;\r\n\r\n\t\t\tcosHalfTheta = - cosHalfTheta;\r\n\r\n\t\t} else {\r\n\r\n\t\t\tthis.copy( qb );\r\n\r\n\t\t}\r\n\r\n\t\tif ( cosHalfTheta >= 1.0 ) {\r\n\r\n\t\t\tthis._w = w;\r\n\t\t\tthis._x = x;\r\n\t\t\tthis._y = y;\r\n\t\t\tthis._z = z;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t}\r\n\r\n\t\tvar sinHalfTheta = Math.sqrt( 1.0 - cosHalfTheta * cosHalfTheta );\r\n\r\n\t\tif ( Math.abs( sinHalfTheta ) < 0.001 ) {\r\n\r\n\t\t\tthis._w = 0.5 * ( w + this._w );\r\n\t\t\tthis._x = 0.5 * ( x + this._x );\r\n\t\t\tthis._y = 0.5 * ( y + this._y );\r\n\t\t\tthis._z = 0.5 * ( z + this._z );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t}\r\n\r\n\t\tvar halfTheta = Math.atan2( sinHalfTheta, cosHalfTheta );\r\n\t\tvar ratioA = Math.sin( ( 1 - t ) * halfTheta ) / sinHalfTheta,\r\n\t\tratioB = Math.sin( t * halfTheta ) / sinHalfTheta;\r\n\r\n\t\tthis._w = ( w * ratioA + this._w * ratioB );\r\n\t\tthis._x = ( x * ratioA + this._x * ratioB );\r\n\t\tthis._y = ( y * ratioA + this._y * ratioB );\r\n\t\tthis._z = ( z * ratioA + this._z * ratioB );\r\n\r\n\t\tthis.onChangeCallback();\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tequals: function ( quaternion ) {\r\n\r\n\t\treturn ( quaternion._x === this._x ) && ( quaternion._y === this._y ) && ( quaternion._z === this._z ) && ( quaternion._w === this._w );\r\n\r\n\t},\r\n\r\n\tfromArray: function ( array, offset ) {\r\n\r\n\t\tif ( offset === undefined ) offset = 0;\r\n\r\n\t\tthis._x = array[ offset ];\r\n\t\tthis._y = array[ offset + 1 ];\r\n\t\tthis._z = array[ offset + 2 ];\r\n\t\tthis._w = array[ offset + 3 ];\r\n\r\n\t\tthis.onChangeCallback();\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\ttoArray: function ( array, offset ) {\r\n\r\n\t\tif ( array === undefined ) array = [];\r\n\t\tif ( offset === undefined ) offset = 0;\r\n\r\n\t\tarray[ offset ] = this._x;\r\n\t\tarray[ offset + 1 ] = this._y;\r\n\t\tarray[ offset + 2 ] = this._z;\r\n\t\tarray[ offset + 3 ] = this._w;\r\n\r\n\t\treturn array;\r\n\r\n\t},\r\n\r\n\tonChange: function ( callback ) {\r\n\r\n\t\tthis.onChangeCallback = callback;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tonChangeCallback: function () {}\r\n\r\n};\r\n\r\nObject.assign( THREE.Quaternion, {\r\n\r\n\tslerp: function( qa, qb, qm, t ) {\r\n\r\n\t\treturn qm.copy( qa ).slerp( qb, t );\r\n\r\n\t},\r\n\r\n\tslerpFlat: function(\r\n\t\t\tdst, dstOffset, src0, srcOffset0, src1, srcOffset1, t ) {\r\n\r\n\t\t// fuzz-free, array-based Quaternion SLERP operation\r\n\r\n\t\tvar x0 = src0[ srcOffset0 + 0 ],\r\n\t\t\ty0 = src0[ srcOffset0 + 1 ],\r\n\t\t\tz0 = src0[ srcOffset0 + 2 ],\r\n\t\t\tw0 = src0[ srcOffset0 + 3 ],\r\n\r\n\t\t\tx1 = src1[ srcOffset1 + 0 ],\r\n\t\t\ty1 = src1[ srcOffset1 + 1 ],\r\n\t\t\tz1 = src1[ srcOffset1 + 2 ],\r\n\t\t\tw1 = src1[ srcOffset1 + 3 ];\r\n\r\n\t\tif ( w0 !== w1 || x0 !== x1 || y0 !== y1 || z0 !== z1 ) {\r\n\r\n\t\t\tvar s = 1 - t,\r\n\r\n\t\t\t\tcos = x0 * x1 + y0 * y1 + z0 * z1 + w0 * w1,\r\n\r\n\t\t\t\tdir = ( cos >= 0 ? 1 : - 1 ),\r\n\t\t\t\tsqrSin = 1 - cos * cos;\r\n\r\n\t\t\t// Skip the Slerp for tiny steps to avoid numeric problems:\r\n\t\t\tif ( sqrSin > Number.EPSILON ) {\r\n\r\n\t\t\t\tvar sin = Math.sqrt( sqrSin ),\r\n\t\t\t\t\tlen = Math.atan2( sin, cos * dir );\r\n\r\n\t\t\t\ts = Math.sin( s * len ) / sin;\r\n\t\t\t\tt = Math.sin( t * len ) / sin;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar tDir = t * dir;\r\n\r\n\t\t\tx0 = x0 * s + x1 * tDir;\r\n\t\t\ty0 = y0 * s + y1 * tDir;\r\n\t\t\tz0 = z0 * s + z1 * tDir;\r\n\t\t\tw0 = w0 * s + w1 * tDir;\r\n\r\n\t\t\t// Normalize in case we just did a lerp:\r\n\t\t\tif ( s === 1 - t ) {\r\n\r\n\t\t\t\tvar f = 1 / Math.sqrt( x0 * x0 + y0 * y0 + z0 * z0 + w0 * w0 );\r\n\r\n\t\t\t\tx0 *= f;\r\n\t\t\t\ty0 *= f;\r\n\t\t\t\tz0 *= f;\r\n\t\t\t\tw0 *= f;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tdst[ dstOffset ] = x0;\r\n\t\tdst[ dstOffset + 1 ] = y0;\r\n\t\tdst[ dstOffset + 2 ] = z0;\r\n\t\tdst[ dstOffset + 3 ] = w0;\r\n\r\n\t}\r\n\r\n} );\r\n\r\n// File:src/math/Vector2.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author philogb / http://blog.thejit.org/\r\n * @author egraether / http://egraether.com/\r\n * @author zz85 / http://www.lab4games.net/zz85/blog\r\n */\r\n\r\nTHREE.Vector2 = function ( x, y ) {\r\n\r\n\tthis.x = x || 0;\r\n\tthis.y = y || 0;\r\n\r\n};\r\n\r\nTHREE.Vector2.prototype = {\r\n\r\n\tconstructor: THREE.Vector2,\r\n\r\n\tget width() {\r\n\r\n\t\treturn this.x;\r\n\r\n\t},\r\n\r\n\tset width( value ) {\r\n\r\n\t\tthis.x = value;\r\n\r\n\t},\r\n\r\n\tget height() {\r\n\r\n\t\treturn this.y;\r\n\r\n\t},\r\n\r\n\tset height( value ) {\r\n\r\n\t\tthis.y = value;\r\n\r\n\t},\r\n\r\n\t//\r\n\r\n\tset: function ( x, y ) {\r\n\r\n\t\tthis.x = x;\r\n\t\tthis.y = y;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tsetScalar: function ( scalar ) {\r\n\r\n\t\tthis.x = scalar;\r\n\t\tthis.y = scalar;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tsetX: function ( x ) {\r\n\r\n\t\tthis.x = x;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tsetY: function ( y ) {\r\n\r\n\t\tthis.y = y;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tsetComponent: function ( index, value ) {\r\n\r\n\t\tswitch ( index ) {\r\n\r\n\t\t\tcase 0: this.x = value; break;\r\n\t\t\tcase 1: this.y = value; break;\r\n\t\t\tdefault: throw new Error( 'index is out of range: ' + index );\r\n\r\n\t\t}\r\n\r\n\t},\r\n\r\n\tgetComponent: function ( index ) {\r\n\r\n\t\tswitch ( index ) {\r\n\r\n\t\t\tcase 0: return this.x;\r\n\t\t\tcase 1: return this.y;\r\n\t\t\tdefault: throw new Error( 'index is out of range: ' + index );\r\n\r\n\t\t}\r\n\r\n\t},\r\n\r\n\tclone: function () {\r\n\r\n\t\treturn new this.constructor( this.x, this.y );\r\n\r\n\t},\r\n\r\n\tcopy: function ( v ) {\r\n\r\n\t\tthis.x = v.x;\r\n\t\tthis.y = v.y;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tadd: function ( v, w ) {\r\n\r\n\t\tif ( w !== undefined ) {\r\n\r\n\t\t\tconsole.warn( 'THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead.' );\r\n\t\t\treturn this.addVectors( v, w );\r\n\r\n\t\t}\r\n\r\n\t\tthis.x += v.x;\r\n\t\tthis.y += v.y;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\taddScalar: function ( s ) {\r\n\r\n\t\tthis.x += s;\r\n\t\tthis.y += s;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\taddVectors: function ( a, b ) {\r\n\r\n\t\tthis.x = a.x + b.x;\r\n\t\tthis.y = a.y + b.y;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\taddScaledVector: function ( v, s ) {\r\n\r\n\t\tthis.x += v.x * s;\r\n\t\tthis.y += v.y * s;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tsub: function ( v, w ) {\r\n\r\n\t\tif ( w !== undefined ) {\r\n\r\n\t\t\tconsole.warn( 'THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead.' );\r\n\t\t\treturn this.subVectors( v, w );\r\n\r\n\t\t}\r\n\r\n\t\tthis.x -= v.x;\r\n\t\tthis.y -= v.y;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tsubScalar: function ( s ) {\r\n\r\n\t\tthis.x -= s;\r\n\t\tthis.y -= s;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tsubVectors: function ( a, b ) {\r\n\r\n\t\tthis.x = a.x - b.x;\r\n\t\tthis.y = a.y - b.y;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tmultiply: function ( v ) {\r\n\r\n\t\tthis.x *= v.x;\r\n\t\tthis.y *= v.y;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tmultiplyScalar: function ( scalar ) {\r\n\r\n\t\tif ( isFinite( scalar ) ) {\r\n\r\n\t\t\tthis.x *= scalar;\r\n\t\t\tthis.y *= scalar;\r\n\r\n\t\t} else {\r\n\r\n\t\t\tthis.x = 0;\r\n\t\t\tthis.y = 0;\r\n\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tdivide: function ( v ) {\r\n\r\n\t\tthis.x /= v.x;\r\n\t\tthis.y /= v.y;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tdivideScalar: function ( scalar ) {\r\n\r\n\t\treturn this.multiplyScalar( 1 / scalar );\r\n\r\n\t},\r\n\r\n\tmin: function ( v ) {\r\n\r\n\t\tthis.x = Math.min( this.x, v.x );\r\n\t\tthis.y = Math.min( this.y, v.y );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tmax: function ( v ) {\r\n\r\n\t\tthis.x = Math.max( this.x, v.x );\r\n\t\tthis.y = Math.max( this.y, v.y );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tclamp: function ( min, max ) {\r\n\r\n\t\t// This function assumes min < max, if this assumption isn't true it will not operate correctly\r\n\r\n\t\tthis.x = Math.max( min.x, Math.min( max.x, this.x ) );\r\n\t\tthis.y = Math.max( min.y, Math.min( max.y, this.y ) );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tclampScalar: function () {\r\n\r\n\t\tvar min, max;\r\n\r\n\t\treturn function clampScalar( minVal, maxVal ) {\r\n\r\n\t\t\tif ( min === undefined ) {\r\n\r\n\t\t\t\tmin = new THREE.Vector2();\r\n\t\t\t\tmax = new THREE.Vector2();\r\n\r\n\t\t\t}\r\n\r\n\t\t\tmin.set( minVal, minVal );\r\n\t\t\tmax.set( maxVal, maxVal );\r\n\r\n\t\t\treturn this.clamp( min, max );\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\tclampLength: function ( min, max ) {\r\n\r\n\t\tvar length = this.length();\r\n\r\n\t\tthis.multiplyScalar( Math.max( min, Math.min( max, length ) ) / length );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tfloor: function () {\r\n\r\n\t\tthis.x = Math.floor( this.x );\r\n\t\tthis.y = Math.floor( this.y );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tceil: function () {\r\n\r\n\t\tthis.x = Math.ceil( this.x );\r\n\t\tthis.y = Math.ceil( this.y );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tround: function () {\r\n\r\n\t\tthis.x = Math.round( this.x );\r\n\t\tthis.y = Math.round( this.y );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\troundToZero: function () {\r\n\r\n\t\tthis.x = ( this.x < 0 ) ? Math.ceil( this.x ) : Math.floor( this.x );\r\n\t\tthis.y = ( this.y < 0 ) ? Math.ceil( this.y ) : Math.floor( this.y );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tnegate: function () {\r\n\r\n\t\tthis.x = - this.x;\r\n\t\tthis.y = - this.y;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tdot: function ( v ) {\r\n\r\n\t\treturn this.x * v.x + this.y * v.y;\r\n\r\n\t},\r\n\r\n\tlengthSq: function () {\r\n\r\n\t\treturn this.x * this.x + this.y * this.y;\r\n\r\n\t},\r\n\r\n\tlength: function () {\r\n\r\n\t\treturn Math.sqrt( this.x * this.x + this.y * this.y );\r\n\r\n\t},\r\n\r\n\tlengthManhattan: function() {\r\n\r\n\t\treturn Math.abs( this.x ) + Math.abs( this.y );\r\n\r\n\t},\r\n\r\n\tnormalize: function () {\r\n\r\n\t\treturn this.divideScalar( this.length() );\r\n\r\n\t},\r\n\r\n\tangle: function () {\r\n\r\n\t\t// computes the angle in radians with respect to the positive x-axis\r\n\r\n\t\tvar angle = Math.atan2( this.y, this.x );\r\n\r\n\t\tif ( angle < 0 ) angle += 2 * Math.PI;\r\n\r\n\t\treturn angle;\r\n\r\n\t},\r\n\r\n\tdistanceTo: function ( v ) {\r\n\r\n\t\treturn Math.sqrt( this.distanceToSquared( v ) );\r\n\r\n\t},\r\n\r\n\tdistanceToSquared: function ( v ) {\r\n\r\n\t\tvar dx = this.x - v.x, dy = this.y - v.y;\r\n\t\treturn dx * dx + dy * dy;\r\n\r\n\t},\r\n\r\n\tsetLength: function ( length ) {\r\n\r\n\t\treturn this.multiplyScalar( length / this.length() );\r\n\r\n\t},\r\n\r\n\tlerp: function ( v, alpha ) {\r\n\r\n\t\tthis.x += ( v.x - this.x ) * alpha;\r\n\t\tthis.y += ( v.y - this.y ) * alpha;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tlerpVectors: function ( v1, v2, alpha ) {\r\n\r\n\t\tthis.subVectors( v2, v1 ).multiplyScalar( alpha ).add( v1 );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tequals: function ( v ) {\r\n\r\n\t\treturn ( ( v.x === this.x ) && ( v.y === this.y ) );\r\n\r\n\t},\r\n\r\n\tfromArray: function ( array, offset ) {\r\n\r\n\t\tif ( offset === undefined ) offset = 0;\r\n\r\n\t\tthis.x = array[ offset ];\r\n\t\tthis.y = array[ offset + 1 ];\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\ttoArray: function ( array, offset ) {\r\n\r\n\t\tif ( array === undefined ) array = [];\r\n\t\tif ( offset === undefined ) offset = 0;\r\n\r\n\t\tarray[ offset ] = this.x;\r\n\t\tarray[ offset + 1 ] = this.y;\r\n\r\n\t\treturn array;\r\n\r\n\t},\r\n\r\n\tfromAttribute: function ( attribute, index, offset ) {\r\n\r\n\t\tif ( offset === undefined ) offset = 0;\r\n\r\n\t\tindex = index * attribute.itemSize + offset;\r\n\r\n\t\tthis.x = attribute.array[ index ];\r\n\t\tthis.y = attribute.array[ index + 1 ];\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\trotateAround: function ( center, angle ) {\r\n\r\n\t\tvar c = Math.cos( angle ), s = Math.sin( angle );\r\n\r\n\t\tvar x = this.x - center.x;\r\n\t\tvar y = this.y - center.y;\r\n\r\n\t\tthis.x = x * c - y * s + center.x;\r\n\t\tthis.y = x * s + y * c + center.y;\r\n\r\n\t\treturn this;\r\n\r\n\t}\r\n\r\n};\r\n\r\n// File:src/math/Vector3.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author *kile / http://kile.stravaganza.org/\r\n * @author philogb / http://blog.thejit.org/\r\n * @author mikael emtinger / http://gomo.se/\r\n * @author egraether / http://egraether.com/\r\n * @author WestLangley / http://github.com/WestLangley\r\n */\r\n\r\nTHREE.Vector3 = function ( x, y, z ) {\r\n\r\n\tthis.x = x || 0;\r\n\tthis.y = y || 0;\r\n\tthis.z = z || 0;\r\n\r\n};\r\n\r\nTHREE.Vector3.prototype = {\r\n\r\n\tconstructor: THREE.Vector3,\r\n\r\n\tset: function ( x, y, z ) {\r\n\r\n\t\tthis.x = x;\r\n\t\tthis.y = y;\r\n\t\tthis.z = z;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tsetScalar: function ( scalar ) {\r\n\r\n\t\tthis.x = scalar;\r\n\t\tthis.y = scalar;\r\n\t\tthis.z = scalar;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tsetX: function ( x ) {\r\n\r\n\t\tthis.x = x;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tsetY: function ( y ) {\r\n\r\n\t\tthis.y = y;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tsetZ: function ( z ) {\r\n\r\n\t\tthis.z = z;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tsetComponent: function ( index, value ) {\r\n\r\n\t\tswitch ( index ) {\r\n\r\n\t\t\tcase 0: this.x = value; break;\r\n\t\t\tcase 1: this.y = value; break;\r\n\t\t\tcase 2: this.z = value; break;\r\n\t\t\tdefault: throw new Error( 'index is out of range: ' + index );\r\n\r\n\t\t}\r\n\r\n\t},\r\n\r\n\tgetComponent: function ( index ) {\r\n\r\n\t\tswitch ( index ) {\r\n\r\n\t\t\tcase 0: return this.x;\r\n\t\t\tcase 1: return this.y;\r\n\t\t\tcase 2: return this.z;\r\n\t\t\tdefault: throw new Error( 'index is out of range: ' + index );\r\n\r\n\t\t}\r\n\r\n\t},\r\n\r\n\tclone: function () {\r\n\r\n\t\treturn new this.constructor( this.x, this.y, this.z );\r\n\r\n\t},\r\n\r\n\tcopy: function ( v ) {\r\n\r\n\t\tthis.x = v.x;\r\n\t\tthis.y = v.y;\r\n\t\tthis.z = v.z;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tadd: function ( v, w ) {\r\n\r\n\t\tif ( w !== undefined ) {\r\n\r\n\t\t\tconsole.warn( 'THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead.' );\r\n\t\t\treturn this.addVectors( v, w );\r\n\r\n\t\t}\r\n\r\n\t\tthis.x += v.x;\r\n\t\tthis.y += v.y;\r\n\t\tthis.z += v.z;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\taddScalar: function ( s ) {\r\n\r\n\t\tthis.x += s;\r\n\t\tthis.y += s;\r\n\t\tthis.z += s;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\taddVectors: function ( a, b ) {\r\n\r\n\t\tthis.x = a.x + b.x;\r\n\t\tthis.y = a.y + b.y;\r\n\t\tthis.z = a.z + b.z;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\taddScaledVector: function ( v, s ) {\r\n\r\n\t\tthis.x += v.x * s;\r\n\t\tthis.y += v.y * s;\r\n\t\tthis.z += v.z * s;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tsub: function ( v, w ) {\r\n\r\n\t\tif ( w !== undefined ) {\r\n\r\n\t\t\tconsole.warn( 'THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead.' );\r\n\t\t\treturn this.subVectors( v, w );\r\n\r\n\t\t}\r\n\r\n\t\tthis.x -= v.x;\r\n\t\tthis.y -= v.y;\r\n\t\tthis.z -= v.z;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tsubScalar: function ( s ) {\r\n\r\n\t\tthis.x -= s;\r\n\t\tthis.y -= s;\r\n\t\tthis.z -= s;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tsubVectors: function ( a, b ) {\r\n\r\n\t\tthis.x = a.x - b.x;\r\n\t\tthis.y = a.y - b.y;\r\n\t\tthis.z = a.z - b.z;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tmultiply: function ( v, w ) {\r\n\r\n\t\tif ( w !== undefined ) {\r\n\r\n\t\t\tconsole.warn( 'THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead.' );\r\n\t\t\treturn this.multiplyVectors( v, w );\r\n\r\n\t\t}\r\n\r\n\t\tthis.x *= v.x;\r\n\t\tthis.y *= v.y;\r\n\t\tthis.z *= v.z;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tmultiplyScalar: function ( scalar ) {\r\n\r\n\t\tif ( isFinite( scalar ) ) {\r\n\r\n\t\t\tthis.x *= scalar;\r\n\t\t\tthis.y *= scalar;\r\n\t\t\tthis.z *= scalar;\r\n\r\n\t\t} else {\r\n\r\n\t\t\tthis.x = 0;\r\n\t\t\tthis.y = 0;\r\n\t\t\tthis.z = 0;\r\n\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tmultiplyVectors: function ( a, b ) {\r\n\r\n\t\tthis.x = a.x * b.x;\r\n\t\tthis.y = a.y * b.y;\r\n\t\tthis.z = a.z * b.z;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tapplyEuler: function () {\r\n\r\n\t\tvar quaternion;\r\n\r\n\t\treturn function applyEuler( euler ) {\r\n\r\n\t\t\tif ( euler instanceof THREE.Euler === false ) {\r\n\r\n\t\t\t\tconsole.error( 'THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order.' );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( quaternion === undefined ) quaternion = new THREE.Quaternion();\r\n\r\n\t\t\tthis.applyQuaternion( quaternion.setFromEuler( euler ) );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\tapplyAxisAngle: function () {\r\n\r\n\t\tvar quaternion;\r\n\r\n\t\treturn function applyAxisAngle( axis, angle ) {\r\n\r\n\t\t\tif ( quaternion === undefined ) quaternion = new THREE.Quaternion();\r\n\r\n\t\t\tthis.applyQuaternion( quaternion.setFromAxisAngle( axis, angle ) );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\tapplyMatrix3: function ( m ) {\r\n\r\n\t\tvar x = this.x;\r\n\t\tvar y = this.y;\r\n\t\tvar z = this.z;\r\n\r\n\t\tvar e = m.elements;\r\n\r\n\t\tthis.x = e[ 0 ] * x + e[ 3 ] * y + e[ 6 ] * z;\r\n\t\tthis.y = e[ 1 ] * x + e[ 4 ] * y + e[ 7 ] * z;\r\n\t\tthis.z = e[ 2 ] * x + e[ 5 ] * y + e[ 8 ] * z;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tapplyMatrix4: function ( m ) {\r\n\r\n\t\t// input: THREE.Matrix4 affine matrix\r\n\r\n\t\tvar x = this.x, y = this.y, z = this.z;\r\n\r\n\t\tvar e = m.elements;\r\n\r\n\t\tthis.x = e[ 0 ] * x + e[ 4 ] * y + e[ 8 ]  * z + e[ 12 ];\r\n\t\tthis.y = e[ 1 ] * x + e[ 5 ] * y + e[ 9 ]  * z + e[ 13 ];\r\n\t\tthis.z = e[ 2 ] * x + e[ 6 ] * y + e[ 10 ] * z + e[ 14 ];\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tapplyProjection: function ( m ) {\r\n\r\n\t\t// input: THREE.Matrix4 projection matrix\r\n\r\n\t\tvar x = this.x, y = this.y, z = this.z;\r\n\r\n\t\tvar e = m.elements;\r\n\t\tvar d = 1 / ( e[ 3 ] * x + e[ 7 ] * y + e[ 11 ] * z + e[ 15 ] ); // perspective divide\r\n\r\n\t\tthis.x = ( e[ 0 ] * x + e[ 4 ] * y + e[ 8 ]  * z + e[ 12 ] ) * d;\r\n\t\tthis.y = ( e[ 1 ] * x + e[ 5 ] * y + e[ 9 ]  * z + e[ 13 ] ) * d;\r\n\t\tthis.z = ( e[ 2 ] * x + e[ 6 ] * y + e[ 10 ] * z + e[ 14 ] ) * d;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tapplyQuaternion: function ( q ) {\r\n\r\n\t\tvar x = this.x;\r\n\t\tvar y = this.y;\r\n\t\tvar z = this.z;\r\n\r\n\t\tvar qx = q.x;\r\n\t\tvar qy = q.y;\r\n\t\tvar qz = q.z;\r\n\t\tvar qw = q.w;\r\n\r\n\t\t// calculate quat * vector\r\n\r\n\t\tvar ix =  qw * x + qy * z - qz * y;\r\n\t\tvar iy =  qw * y + qz * x - qx * z;\r\n\t\tvar iz =  qw * z + qx * y - qy * x;\r\n\t\tvar iw = - qx * x - qy * y - qz * z;\r\n\r\n\t\t// calculate result * inverse quat\r\n\r\n\t\tthis.x = ix * qw + iw * - qx + iy * - qz - iz * - qy;\r\n\t\tthis.y = iy * qw + iw * - qy + iz * - qx - ix * - qz;\r\n\t\tthis.z = iz * qw + iw * - qz + ix * - qy - iy * - qx;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tproject: function () {\r\n\r\n\t\tvar matrix;\r\n\r\n\t\treturn function project( camera ) {\r\n\r\n\t\t\tif ( matrix === undefined ) matrix = new THREE.Matrix4();\r\n\r\n\t\t\tmatrix.multiplyMatrices( camera.projectionMatrix, matrix.getInverse( camera.matrixWorld ) );\r\n\t\t\treturn this.applyProjection( matrix );\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\tunproject: function () {\r\n\r\n\t\tvar matrix;\r\n\r\n\t\treturn function unproject( camera ) {\r\n\r\n\t\t\tif ( matrix === undefined ) matrix = new THREE.Matrix4();\r\n\r\n\t\t\tmatrix.multiplyMatrices( camera.matrixWorld, matrix.getInverse( camera.projectionMatrix ) );\r\n\t\t\treturn this.applyProjection( matrix );\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\ttransformDirection: function ( m ) {\r\n\r\n\t\t// input: THREE.Matrix4 affine matrix\r\n\t\t// vector interpreted as a direction\r\n\r\n\t\tvar x = this.x, y = this.y, z = this.z;\r\n\r\n\t\tvar e = m.elements;\r\n\r\n\t\tthis.x = e[ 0 ] * x + e[ 4 ] * y + e[ 8 ]  * z;\r\n\t\tthis.y = e[ 1 ] * x + e[ 5 ] * y + e[ 9 ]  * z;\r\n\t\tthis.z = e[ 2 ] * x + e[ 6 ] * y + e[ 10 ] * z;\r\n\r\n\t\tthis.normalize();\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tdivide: function ( v ) {\r\n\r\n\t\tthis.x /= v.x;\r\n\t\tthis.y /= v.y;\r\n\t\tthis.z /= v.z;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tdivideScalar: function ( scalar ) {\r\n\r\n\t\treturn this.multiplyScalar( 1 / scalar );\r\n\r\n\t},\r\n\r\n\tmin: function ( v ) {\r\n\r\n\t\tthis.x = Math.min( this.x, v.x );\r\n\t\tthis.y = Math.min( this.y, v.y );\r\n\t\tthis.z = Math.min( this.z, v.z );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tmax: function ( v ) {\r\n\r\n\t\tthis.x = Math.max( this.x, v.x );\r\n\t\tthis.y = Math.max( this.y, v.y );\r\n\t\tthis.z = Math.max( this.z, v.z );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tclamp: function ( min, max ) {\r\n\r\n\t\t// This function assumes min < max, if this assumption isn't true it will not operate correctly\r\n\r\n\t\tthis.x = Math.max( min.x, Math.min( max.x, this.x ) );\r\n\t\tthis.y = Math.max( min.y, Math.min( max.y, this.y ) );\r\n\t\tthis.z = Math.max( min.z, Math.min( max.z, this.z ) );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tclampScalar: function () {\r\n\r\n\t\tvar min, max;\r\n\r\n\t\treturn function clampScalar( minVal, maxVal ) {\r\n\r\n\t\t\tif ( min === undefined ) {\r\n\r\n\t\t\t\tmin = new THREE.Vector3();\r\n\t\t\t\tmax = new THREE.Vector3();\r\n\r\n\t\t\t}\r\n\r\n\t\t\tmin.set( minVal, minVal, minVal );\r\n\t\t\tmax.set( maxVal, maxVal, maxVal );\r\n\r\n\t\t\treturn this.clamp( min, max );\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\tclampLength: function ( min, max ) {\r\n\r\n\t\tvar length = this.length();\r\n\r\n\t\tthis.multiplyScalar( Math.max( min, Math.min( max, length ) ) / length );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tfloor: function () {\r\n\r\n\t\tthis.x = Math.floor( this.x );\r\n\t\tthis.y = Math.floor( this.y );\r\n\t\tthis.z = Math.floor( this.z );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tceil: function () {\r\n\r\n\t\tthis.x = Math.ceil( this.x );\r\n\t\tthis.y = Math.ceil( this.y );\r\n\t\tthis.z = Math.ceil( this.z );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tround: function () {\r\n\r\n\t\tthis.x = Math.round( this.x );\r\n\t\tthis.y = Math.round( this.y );\r\n\t\tthis.z = Math.round( this.z );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\troundToZero: function () {\r\n\r\n\t\tthis.x = ( this.x < 0 ) ? Math.ceil( this.x ) : Math.floor( this.x );\r\n\t\tthis.y = ( this.y < 0 ) ? Math.ceil( this.y ) : Math.floor( this.y );\r\n\t\tthis.z = ( this.z < 0 ) ? Math.ceil( this.z ) : Math.floor( this.z );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tnegate: function () {\r\n\r\n\t\tthis.x = - this.x;\r\n\t\tthis.y = - this.y;\r\n\t\tthis.z = - this.z;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tdot: function ( v ) {\r\n\r\n\t\treturn this.x * v.x + this.y * v.y + this.z * v.z;\r\n\r\n\t},\r\n\r\n\tlengthSq: function () {\r\n\r\n\t\treturn this.x * this.x + this.y * this.y + this.z * this.z;\r\n\r\n\t},\r\n\r\n\tlength: function () {\r\n\r\n\t\treturn Math.sqrt( this.x * this.x + this.y * this.y + this.z * this.z );\r\n\r\n\t},\r\n\r\n\tlengthManhattan: function () {\r\n\r\n\t\treturn Math.abs( this.x ) + Math.abs( this.y ) + Math.abs( this.z );\r\n\r\n\t},\r\n\r\n\tnormalize: function () {\r\n\r\n\t\treturn this.divideScalar( this.length() );\r\n\r\n\t},\r\n\r\n\tsetLength: function ( length ) {\r\n\r\n\t\treturn this.multiplyScalar( length / this.length() );\r\n\r\n\t},\r\n\r\n\tlerp: function ( v, alpha ) {\r\n\r\n\t\tthis.x += ( v.x - this.x ) * alpha;\r\n\t\tthis.y += ( v.y - this.y ) * alpha;\r\n\t\tthis.z += ( v.z - this.z ) * alpha;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tlerpVectors: function ( v1, v2, alpha ) {\r\n\r\n\t\tthis.subVectors( v2, v1 ).multiplyScalar( alpha ).add( v1 );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tcross: function ( v, w ) {\r\n\r\n\t\tif ( w !== undefined ) {\r\n\r\n\t\t\tconsole.warn( 'THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead.' );\r\n\t\t\treturn this.crossVectors( v, w );\r\n\r\n\t\t}\r\n\r\n\t\tvar x = this.x, y = this.y, z = this.z;\r\n\r\n\t\tthis.x = y * v.z - z * v.y;\r\n\t\tthis.y = z * v.x - x * v.z;\r\n\t\tthis.z = x * v.y - y * v.x;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tcrossVectors: function ( a, b ) {\r\n\r\n\t\tvar ax = a.x, ay = a.y, az = a.z;\r\n\t\tvar bx = b.x, by = b.y, bz = b.z;\r\n\r\n\t\tthis.x = ay * bz - az * by;\r\n\t\tthis.y = az * bx - ax * bz;\r\n\t\tthis.z = ax * by - ay * bx;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tprojectOnVector: function () {\r\n\r\n\t\tvar v1, dot;\r\n\r\n\t\treturn function projectOnVector( vector ) {\r\n\r\n\t\t\tif ( v1 === undefined ) v1 = new THREE.Vector3();\r\n\r\n\t\t\tv1.copy( vector ).normalize();\r\n\r\n\t\t\tdot = this.dot( v1 );\r\n\r\n\t\t\treturn this.copy( v1 ).multiplyScalar( dot );\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\tprojectOnPlane: function () {\r\n\r\n\t\tvar v1;\r\n\r\n\t\treturn function projectOnPlane( planeNormal ) {\r\n\r\n\t\t\tif ( v1 === undefined ) v1 = new THREE.Vector3();\r\n\r\n\t\t\tv1.copy( this ).projectOnVector( planeNormal );\r\n\r\n\t\t\treturn this.sub( v1 );\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\treflect: function () {\r\n\r\n\t\t// reflect incident vector off plane orthogonal to normal\r\n\t\t// normal is assumed to have unit length\r\n\r\n\t\tvar v1;\r\n\r\n\t\treturn function reflect( normal ) {\r\n\r\n\t\t\tif ( v1 === undefined ) v1 = new THREE.Vector3();\r\n\r\n\t\t\treturn this.sub( v1.copy( normal ).multiplyScalar( 2 * this.dot( normal ) ) );\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\tangleTo: function ( v ) {\r\n\r\n\t\tvar theta = this.dot( v ) / ( Math.sqrt( this.lengthSq() * v.lengthSq() ) );\r\n\r\n\t\t// clamp, to handle numerical problems\r\n\r\n\t\treturn Math.acos( THREE.Math.clamp( theta, - 1, 1 ) );\r\n\r\n\t},\r\n\r\n\tdistanceTo: function ( v ) {\r\n\r\n\t\treturn Math.sqrt( this.distanceToSquared( v ) );\r\n\r\n\t},\r\n\r\n\tdistanceToSquared: function ( v ) {\r\n\r\n\t\tvar dx = this.x - v.x;\r\n\t\tvar dy = this.y - v.y;\r\n\t\tvar dz = this.z - v.z;\r\n\r\n\t\treturn dx * dx + dy * dy + dz * dz;\r\n\r\n\t},\r\n\r\n\tsetFromSpherical: function( s ) {\r\n\r\n\t\tvar sinPhiRadius = Math.sin( s.phi ) * s.radius;\r\n\r\n\t\tthis.x = sinPhiRadius * Math.sin( s.theta );\r\n\t\tthis.y = Math.cos( s.phi ) * s.radius;\r\n\t\tthis.z = sinPhiRadius * Math.cos( s.theta );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tsetFromMatrixPosition: function ( m ) {\r\n\r\n\t\treturn this.setFromMatrixColumn( m, 3 );\r\n\r\n\t},\r\n\r\n\tsetFromMatrixScale: function ( m ) {\r\n\r\n\t\tvar sx = this.setFromMatrixColumn( m, 0 ).length();\r\n\t\tvar sy = this.setFromMatrixColumn( m, 1 ).length();\r\n\t\tvar sz = this.setFromMatrixColumn( m, 2 ).length();\r\n\r\n\t\tthis.x = sx;\r\n\t\tthis.y = sy;\r\n\t\tthis.z = sz;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tsetFromMatrixColumn: function ( m, index ) {\r\n\r\n\t\tif ( typeof m === 'number' ) {\r\n\r\n\t\t\tconsole.warn( 'THREE.Vector3: setFromMatrixColumn now expects ( matrix, index ).' );\r\n\r\n\t\t\tm = arguments[ 1 ];\r\n\t\t\tindex = arguments[ 0 ];\r\n\r\n\t\t}\r\n\r\n\t\treturn this.fromArray( m.elements, index * 4 );\r\n\r\n\t},\r\n\r\n\tequals: function ( v ) {\r\n\r\n\t\treturn ( ( v.x === this.x ) && ( v.y === this.y ) && ( v.z === this.z ) );\r\n\r\n\t},\r\n\r\n\tfromArray: function ( array, offset ) {\r\n\r\n\t\tif ( offset === undefined ) offset = 0;\r\n\r\n\t\tthis.x = array[ offset ];\r\n\t\tthis.y = array[ offset + 1 ];\r\n\t\tthis.z = array[ offset + 2 ];\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\ttoArray: function ( array, offset ) {\r\n\r\n\t\tif ( array === undefined ) array = [];\r\n\t\tif ( offset === undefined ) offset = 0;\r\n\r\n\t\tarray[ offset ] = this.x;\r\n\t\tarray[ offset + 1 ] = this.y;\r\n\t\tarray[ offset + 2 ] = this.z;\r\n\r\n\t\treturn array;\r\n\r\n\t},\r\n\r\n\tfromAttribute: function ( attribute, index, offset ) {\r\n\r\n\t\tif ( offset === undefined ) offset = 0;\r\n\r\n\t\tindex = index * attribute.itemSize + offset;\r\n\r\n\t\tthis.x = attribute.array[ index ];\r\n\t\tthis.y = attribute.array[ index + 1 ];\r\n\t\tthis.z = attribute.array[ index + 2 ];\r\n\r\n\t\treturn this;\r\n\r\n\t}\r\n\r\n};\r\n\r\n// File:src/math/Vector4.js\r\n\r\n/**\r\n * @author supereggbert / http://www.paulbrunt.co.uk/\r\n * @author philogb / http://blog.thejit.org/\r\n * @author mikael emtinger / http://gomo.se/\r\n * @author egraether / http://egraether.com/\r\n * @author WestLangley / http://github.com/WestLangley\r\n */\r\n\r\nTHREE.Vector4 = function ( x, y, z, w ) {\r\n\r\n\tthis.x = x || 0;\r\n\tthis.y = y || 0;\r\n\tthis.z = z || 0;\r\n\tthis.w = ( w !== undefined ) ? w : 1;\r\n\r\n};\r\n\r\nTHREE.Vector4.prototype = {\r\n\r\n\tconstructor: THREE.Vector4,\r\n\r\n\tset: function ( x, y, z, w ) {\r\n\r\n\t\tthis.x = x;\r\n\t\tthis.y = y;\r\n\t\tthis.z = z;\r\n\t\tthis.w = w;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tsetScalar: function ( scalar ) {\r\n\r\n\t\tthis.x = scalar;\r\n\t\tthis.y = scalar;\r\n\t\tthis.z = scalar;\r\n\t\tthis.w = scalar;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tsetX: function ( x ) {\r\n\r\n\t\tthis.x = x;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tsetY: function ( y ) {\r\n\r\n\t\tthis.y = y;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tsetZ: function ( z ) {\r\n\r\n\t\tthis.z = z;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tsetW: function ( w ) {\r\n\r\n\t\tthis.w = w;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tsetComponent: function ( index, value ) {\r\n\r\n\t\tswitch ( index ) {\r\n\r\n\t\t\tcase 0: this.x = value; break;\r\n\t\t\tcase 1: this.y = value; break;\r\n\t\t\tcase 2: this.z = value; break;\r\n\t\t\tcase 3: this.w = value; break;\r\n\t\t\tdefault: throw new Error( 'index is out of range: ' + index );\r\n\r\n\t\t}\r\n\r\n\t},\r\n\r\n\tgetComponent: function ( index ) {\r\n\r\n\t\tswitch ( index ) {\r\n\r\n\t\t\tcase 0: return this.x;\r\n\t\t\tcase 1: return this.y;\r\n\t\t\tcase 2: return this.z;\r\n\t\t\tcase 3: return this.w;\r\n\t\t\tdefault: throw new Error( 'index is out of range: ' + index );\r\n\r\n\t\t}\r\n\r\n\t},\r\n\r\n\tclone: function () {\r\n\r\n\t\treturn new this.constructor( this.x, this.y, this.z, this.w );\r\n\r\n\t},\r\n\r\n\tcopy: function ( v ) {\r\n\r\n\t\tthis.x = v.x;\r\n\t\tthis.y = v.y;\r\n\t\tthis.z = v.z;\r\n\t\tthis.w = ( v.w !== undefined ) ? v.w : 1;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tadd: function ( v, w ) {\r\n\r\n\t\tif ( w !== undefined ) {\r\n\r\n\t\t\tconsole.warn( 'THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead.' );\r\n\t\t\treturn this.addVectors( v, w );\r\n\r\n\t\t}\r\n\r\n\t\tthis.x += v.x;\r\n\t\tthis.y += v.y;\r\n\t\tthis.z += v.z;\r\n\t\tthis.w += v.w;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\taddScalar: function ( s ) {\r\n\r\n\t\tthis.x += s;\r\n\t\tthis.y += s;\r\n\t\tthis.z += s;\r\n\t\tthis.w += s;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\taddVectors: function ( a, b ) {\r\n\r\n\t\tthis.x = a.x + b.x;\r\n\t\tthis.y = a.y + b.y;\r\n\t\tthis.z = a.z + b.z;\r\n\t\tthis.w = a.w + b.w;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\taddScaledVector: function ( v, s ) {\r\n\r\n\t\tthis.x += v.x * s;\r\n\t\tthis.y += v.y * s;\r\n\t\tthis.z += v.z * s;\r\n\t\tthis.w += v.w * s;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tsub: function ( v, w ) {\r\n\r\n\t\tif ( w !== undefined ) {\r\n\r\n\t\t\tconsole.warn( 'THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead.' );\r\n\t\t\treturn this.subVectors( v, w );\r\n\r\n\t\t}\r\n\r\n\t\tthis.x -= v.x;\r\n\t\tthis.y -= v.y;\r\n\t\tthis.z -= v.z;\r\n\t\tthis.w -= v.w;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tsubScalar: function ( s ) {\r\n\r\n\t\tthis.x -= s;\r\n\t\tthis.y -= s;\r\n\t\tthis.z -= s;\r\n\t\tthis.w -= s;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tsubVectors: function ( a, b ) {\r\n\r\n\t\tthis.x = a.x - b.x;\r\n\t\tthis.y = a.y - b.y;\r\n\t\tthis.z = a.z - b.z;\r\n\t\tthis.w = a.w - b.w;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tmultiplyScalar: function ( scalar ) {\r\n\r\n\t\tif ( isFinite( scalar ) ) {\r\n\r\n\t\t\tthis.x *= scalar;\r\n\t\t\tthis.y *= scalar;\r\n\t\t\tthis.z *= scalar;\r\n\t\t\tthis.w *= scalar;\r\n\r\n\t\t} else {\r\n\r\n\t\t\tthis.x = 0;\r\n\t\t\tthis.y = 0;\r\n\t\t\tthis.z = 0;\r\n\t\t\tthis.w = 0;\r\n\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tapplyMatrix4: function ( m ) {\r\n\r\n\t\tvar x = this.x;\r\n\t\tvar y = this.y;\r\n\t\tvar z = this.z;\r\n\t\tvar w = this.w;\r\n\r\n\t\tvar e = m.elements;\r\n\r\n\t\tthis.x = e[ 0 ] * x + e[ 4 ] * y + e[ 8 ] * z + e[ 12 ] * w;\r\n\t\tthis.y = e[ 1 ] * x + e[ 5 ] * y + e[ 9 ] * z + e[ 13 ] * w;\r\n\t\tthis.z = e[ 2 ] * x + e[ 6 ] * y + e[ 10 ] * z + e[ 14 ] * w;\r\n\t\tthis.w = e[ 3 ] * x + e[ 7 ] * y + e[ 11 ] * z + e[ 15 ] * w;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tdivideScalar: function ( scalar ) {\r\n\r\n\t\treturn this.multiplyScalar( 1 / scalar );\r\n\r\n\t},\r\n\r\n\tsetAxisAngleFromQuaternion: function ( q ) {\r\n\r\n\t\t// http://www.euclideanspace.com/maths/geometry/rotations/conversions/quaternionToAngle/index.htm\r\n\r\n\t\t// q is assumed to be normalized\r\n\r\n\t\tthis.w = 2 * Math.acos( q.w );\r\n\r\n\t\tvar s = Math.sqrt( 1 - q.w * q.w );\r\n\r\n\t\tif ( s < 0.0001 ) {\r\n\r\n\t\t\t this.x = 1;\r\n\t\t\t this.y = 0;\r\n\t\t\t this.z = 0;\r\n\r\n\t\t} else {\r\n\r\n\t\t\t this.x = q.x / s;\r\n\t\t\t this.y = q.y / s;\r\n\t\t\t this.z = q.z / s;\r\n\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tsetAxisAngleFromRotationMatrix: function ( m ) {\r\n\r\n\t\t// http://www.euclideanspace.com/maths/geometry/rotations/conversions/matrixToAngle/index.htm\r\n\r\n\t\t// assumes the upper 3x3 of m is a pure rotation matrix (i.e, unscaled)\r\n\r\n\t\tvar angle, x, y, z,\t\t// variables for result\r\n\t\t\tepsilon = 0.01,\t\t// margin to allow for rounding errors\r\n\t\t\tepsilon2 = 0.1,\t\t// margin to distinguish between 0 and 180 degrees\r\n\r\n\t\t\tte = m.elements,\r\n\r\n\t\t\tm11 = te[ 0 ], m12 = te[ 4 ], m13 = te[ 8 ],\r\n\t\t\tm21 = te[ 1 ], m22 = te[ 5 ], m23 = te[ 9 ],\r\n\t\t\tm31 = te[ 2 ], m32 = te[ 6 ], m33 = te[ 10 ];\r\n\r\n\t\tif ( ( Math.abs( m12 - m21 ) < epsilon ) &&\r\n\t\t     ( Math.abs( m13 - m31 ) < epsilon ) &&\r\n\t\t     ( Math.abs( m23 - m32 ) < epsilon ) ) {\r\n\r\n\t\t\t// singularity found\r\n\t\t\t// first check for identity matrix which must have +1 for all terms\r\n\t\t\t// in leading diagonal and zero in other terms\r\n\r\n\t\t\tif ( ( Math.abs( m12 + m21 ) < epsilon2 ) &&\r\n\t\t\t     ( Math.abs( m13 + m31 ) < epsilon2 ) &&\r\n\t\t\t     ( Math.abs( m23 + m32 ) < epsilon2 ) &&\r\n\t\t\t     ( Math.abs( m11 + m22 + m33 - 3 ) < epsilon2 ) ) {\r\n\r\n\t\t\t\t// this singularity is identity matrix so angle = 0\r\n\r\n\t\t\t\tthis.set( 1, 0, 0, 0 );\r\n\r\n\t\t\t\treturn this; // zero angle, arbitrary axis\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// otherwise this singularity is angle = 180\r\n\r\n\t\t\tangle = Math.PI;\r\n\r\n\t\t\tvar xx = ( m11 + 1 ) / 2;\r\n\t\t\tvar yy = ( m22 + 1 ) / 2;\r\n\t\t\tvar zz = ( m33 + 1 ) / 2;\r\n\t\t\tvar xy = ( m12 + m21 ) / 4;\r\n\t\t\tvar xz = ( m13 + m31 ) / 4;\r\n\t\t\tvar yz = ( m23 + m32 ) / 4;\r\n\r\n\t\t\tif ( ( xx > yy ) && ( xx > zz ) ) {\r\n\r\n\t\t\t\t// m11 is the largest diagonal term\r\n\r\n\t\t\t\tif ( xx < epsilon ) {\r\n\r\n\t\t\t\t\tx = 0;\r\n\t\t\t\t\ty = 0.707106781;\r\n\t\t\t\t\tz = 0.707106781;\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tx = Math.sqrt( xx );\r\n\t\t\t\t\ty = xy / x;\r\n\t\t\t\t\tz = xz / x;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t} else if ( yy > zz ) {\r\n\r\n\t\t\t\t// m22 is the largest diagonal term\r\n\r\n\t\t\t\tif ( yy < epsilon ) {\r\n\r\n\t\t\t\t\tx = 0.707106781;\r\n\t\t\t\t\ty = 0;\r\n\t\t\t\t\tz = 0.707106781;\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\ty = Math.sqrt( yy );\r\n\t\t\t\t\tx = xy / y;\r\n\t\t\t\t\tz = yz / y;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\t// m33 is the largest diagonal term so base result on this\r\n\r\n\t\t\t\tif ( zz < epsilon ) {\r\n\r\n\t\t\t\t\tx = 0.707106781;\r\n\t\t\t\t\ty = 0.707106781;\r\n\t\t\t\t\tz = 0;\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tz = Math.sqrt( zz );\r\n\t\t\t\t\tx = xz / z;\r\n\t\t\t\t\ty = yz / z;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tthis.set( x, y, z, angle );\r\n\r\n\t\t\treturn this; // return 180 deg rotation\r\n\r\n\t\t}\r\n\r\n\t\t// as we have reached here there are no singularities so we can handle normally\r\n\r\n\t\tvar s = Math.sqrt( ( m32 - m23 ) * ( m32 - m23 ) +\r\n\t\t                   ( m13 - m31 ) * ( m13 - m31 ) +\r\n\t\t                   ( m21 - m12 ) * ( m21 - m12 ) ); // used to normalize\r\n\r\n\t\tif ( Math.abs( s ) < 0.001 ) s = 1;\r\n\r\n\t\t// prevent divide by zero, should not happen if matrix is orthogonal and should be\r\n\t\t// caught by singularity test above, but I've left it in just in case\r\n\r\n\t\tthis.x = ( m32 - m23 ) / s;\r\n\t\tthis.y = ( m13 - m31 ) / s;\r\n\t\tthis.z = ( m21 - m12 ) / s;\r\n\t\tthis.w = Math.acos( ( m11 + m22 + m33 - 1 ) / 2 );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tmin: function ( v ) {\r\n\r\n\t\tthis.x = Math.min( this.x, v.x );\r\n\t\tthis.y = Math.min( this.y, v.y );\r\n\t\tthis.z = Math.min( this.z, v.z );\r\n\t\tthis.w = Math.min( this.w, v.w );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tmax: function ( v ) {\r\n\r\n\t\tthis.x = Math.max( this.x, v.x );\r\n\t\tthis.y = Math.max( this.y, v.y );\r\n\t\tthis.z = Math.max( this.z, v.z );\r\n\t\tthis.w = Math.max( this.w, v.w );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tclamp: function ( min, max ) {\r\n\r\n\t\t// This function assumes min < max, if this assumption isn't true it will not operate correctly\r\n\r\n\t\tthis.x = Math.max( min.x, Math.min( max.x, this.x ) );\r\n\t\tthis.y = Math.max( min.y, Math.min( max.y, this.y ) );\r\n\t\tthis.z = Math.max( min.z, Math.min( max.z, this.z ) );\r\n\t\tthis.w = Math.max( min.w, Math.min( max.w, this.w ) );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tclampScalar: function () {\r\n\r\n\t\tvar min, max;\r\n\r\n\t\treturn function clampScalar( minVal, maxVal ) {\r\n\r\n\t\t\tif ( min === undefined ) {\r\n\r\n\t\t\t\tmin = new THREE.Vector4();\r\n\t\t\t\tmax = new THREE.Vector4();\r\n\r\n\t\t\t}\r\n\r\n\t\t\tmin.set( minVal, minVal, minVal, minVal );\r\n\t\t\tmax.set( maxVal, maxVal, maxVal, maxVal );\r\n\r\n\t\t\treturn this.clamp( min, max );\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\tfloor: function () {\r\n\r\n\t\tthis.x = Math.floor( this.x );\r\n\t\tthis.y = Math.floor( this.y );\r\n\t\tthis.z = Math.floor( this.z );\r\n\t\tthis.w = Math.floor( this.w );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tceil: function () {\r\n\r\n\t\tthis.x = Math.ceil( this.x );\r\n\t\tthis.y = Math.ceil( this.y );\r\n\t\tthis.z = Math.ceil( this.z );\r\n\t\tthis.w = Math.ceil( this.w );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tround: function () {\r\n\r\n\t\tthis.x = Math.round( this.x );\r\n\t\tthis.y = Math.round( this.y );\r\n\t\tthis.z = Math.round( this.z );\r\n\t\tthis.w = Math.round( this.w );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\troundToZero: function () {\r\n\r\n\t\tthis.x = ( this.x < 0 ) ? Math.ceil( this.x ) : Math.floor( this.x );\r\n\t\tthis.y = ( this.y < 0 ) ? Math.ceil( this.y ) : Math.floor( this.y );\r\n\t\tthis.z = ( this.z < 0 ) ? Math.ceil( this.z ) : Math.floor( this.z );\r\n\t\tthis.w = ( this.w < 0 ) ? Math.ceil( this.w ) : Math.floor( this.w );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tnegate: function () {\r\n\r\n\t\tthis.x = - this.x;\r\n\t\tthis.y = - this.y;\r\n\t\tthis.z = - this.z;\r\n\t\tthis.w = - this.w;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tdot: function ( v ) {\r\n\r\n\t\treturn this.x * v.x + this.y * v.y + this.z * v.z + this.w * v.w;\r\n\r\n\t},\r\n\r\n\tlengthSq: function () {\r\n\r\n\t\treturn this.x * this.x + this.y * this.y + this.z * this.z + this.w * this.w;\r\n\r\n\t},\r\n\r\n\tlength: function () {\r\n\r\n\t\treturn Math.sqrt( this.x * this.x + this.y * this.y + this.z * this.z + this.w * this.w );\r\n\r\n\t},\r\n\r\n\tlengthManhattan: function () {\r\n\r\n\t\treturn Math.abs( this.x ) + Math.abs( this.y ) + Math.abs( this.z ) + Math.abs( this.w );\r\n\r\n\t},\r\n\r\n\tnormalize: function () {\r\n\r\n\t\treturn this.divideScalar( this.length() );\r\n\r\n\t},\r\n\r\n\tsetLength: function ( length ) {\r\n\r\n\t\treturn this.multiplyScalar( length / this.length() );\r\n\r\n\t},\r\n\r\n\tlerp: function ( v, alpha ) {\r\n\r\n\t\tthis.x += ( v.x - this.x ) * alpha;\r\n\t\tthis.y += ( v.y - this.y ) * alpha;\r\n\t\tthis.z += ( v.z - this.z ) * alpha;\r\n\t\tthis.w += ( v.w - this.w ) * alpha;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tlerpVectors: function ( v1, v2, alpha ) {\r\n\r\n\t\tthis.subVectors( v2, v1 ).multiplyScalar( alpha ).add( v1 );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tequals: function ( v ) {\r\n\r\n\t\treturn ( ( v.x === this.x ) && ( v.y === this.y ) && ( v.z === this.z ) && ( v.w === this.w ) );\r\n\r\n\t},\r\n\r\n\tfromArray: function ( array, offset ) {\r\n\r\n\t\tif ( offset === undefined ) offset = 0;\r\n\r\n\t\tthis.x = array[ offset ];\r\n\t\tthis.y = array[ offset + 1 ];\r\n\t\tthis.z = array[ offset + 2 ];\r\n\t\tthis.w = array[ offset + 3 ];\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\ttoArray: function ( array, offset ) {\r\n\r\n\t\tif ( array === undefined ) array = [];\r\n\t\tif ( offset === undefined ) offset = 0;\r\n\r\n\t\tarray[ offset ] = this.x;\r\n\t\tarray[ offset + 1 ] = this.y;\r\n\t\tarray[ offset + 2 ] = this.z;\r\n\t\tarray[ offset + 3 ] = this.w;\r\n\r\n\t\treturn array;\r\n\r\n\t},\r\n\r\n\tfromAttribute: function ( attribute, index, offset ) {\r\n\r\n\t\tif ( offset === undefined ) offset = 0;\r\n\r\n\t\tindex = index * attribute.itemSize + offset;\r\n\r\n\t\tthis.x = attribute.array[ index ];\r\n\t\tthis.y = attribute.array[ index + 1 ];\r\n\t\tthis.z = attribute.array[ index + 2 ];\r\n\t\tthis.w = attribute.array[ index + 3 ];\r\n\r\n\t\treturn this;\r\n\r\n\t}\r\n\r\n};\r\n\r\n// File:src/math/Euler.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author WestLangley / http://github.com/WestLangley\r\n * @author bhouston / http://clara.io\r\n */\r\n\r\nTHREE.Euler = function ( x, y, z, order ) {\r\n\r\n\tthis._x = x || 0;\r\n\tthis._y = y || 0;\r\n\tthis._z = z || 0;\r\n\tthis._order = order || THREE.Euler.DefaultOrder;\r\n\r\n};\r\n\r\nTHREE.Euler.RotationOrders = [ 'XYZ', 'YZX', 'ZXY', 'XZY', 'YXZ', 'ZYX' ];\r\n\r\nTHREE.Euler.DefaultOrder = 'XYZ';\r\n\r\nTHREE.Euler.prototype = {\r\n\r\n\tconstructor: THREE.Euler,\r\n\r\n\tget x () {\r\n\r\n\t\treturn this._x;\r\n\r\n\t},\r\n\r\n\tset x ( value ) {\r\n\r\n\t\tthis._x = value;\r\n\t\tthis.onChangeCallback();\r\n\r\n\t},\r\n\r\n\tget y () {\r\n\r\n\t\treturn this._y;\r\n\r\n\t},\r\n\r\n\tset y ( value ) {\r\n\r\n\t\tthis._y = value;\r\n\t\tthis.onChangeCallback();\r\n\r\n\t},\r\n\r\n\tget z () {\r\n\r\n\t\treturn this._z;\r\n\r\n\t},\r\n\r\n\tset z ( value ) {\r\n\r\n\t\tthis._z = value;\r\n\t\tthis.onChangeCallback();\r\n\r\n\t},\r\n\r\n\tget order () {\r\n\r\n\t\treturn this._order;\r\n\r\n\t},\r\n\r\n\tset order ( value ) {\r\n\r\n\t\tthis._order = value;\r\n\t\tthis.onChangeCallback();\r\n\r\n\t},\r\n\r\n\tset: function ( x, y, z, order ) {\r\n\r\n\t\tthis._x = x;\r\n\t\tthis._y = y;\r\n\t\tthis._z = z;\r\n\t\tthis._order = order || this._order;\r\n\r\n\t\tthis.onChangeCallback();\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tclone: function () {\r\n\r\n\t\treturn new this.constructor( this._x, this._y, this._z, this._order );\r\n\r\n\t},\r\n\r\n\tcopy: function ( euler ) {\r\n\r\n\t\tthis._x = euler._x;\r\n\t\tthis._y = euler._y;\r\n\t\tthis._z = euler._z;\r\n\t\tthis._order = euler._order;\r\n\r\n\t\tthis.onChangeCallback();\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tsetFromRotationMatrix: function ( m, order, update ) {\r\n\r\n\t\tvar clamp = THREE.Math.clamp;\r\n\r\n\t\t// assumes the upper 3x3 of m is a pure rotation matrix (i.e, unscaled)\r\n\r\n\t\tvar te = m.elements;\r\n\t\tvar m11 = te[ 0 ], m12 = te[ 4 ], m13 = te[ 8 ];\r\n\t\tvar m21 = te[ 1 ], m22 = te[ 5 ], m23 = te[ 9 ];\r\n\t\tvar m31 = te[ 2 ], m32 = te[ 6 ], m33 = te[ 10 ];\r\n\r\n\t\torder = order || this._order;\r\n\r\n\t\tif ( order === 'XYZ' ) {\r\n\r\n\t\t\tthis._y = Math.asin( clamp( m13, - 1, 1 ) );\r\n\r\n\t\t\tif ( Math.abs( m13 ) < 0.99999 ) {\r\n\r\n\t\t\t\tthis._x = Math.atan2( - m23, m33 );\r\n\t\t\t\tthis._z = Math.atan2( - m12, m11 );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tthis._x = Math.atan2( m32, m22 );\r\n\t\t\t\tthis._z = 0;\r\n\r\n\t\t\t}\r\n\r\n\t\t} else if ( order === 'YXZ' ) {\r\n\r\n\t\t\tthis._x = Math.asin( - clamp( m23, - 1, 1 ) );\r\n\r\n\t\t\tif ( Math.abs( m23 ) < 0.99999 ) {\r\n\r\n\t\t\t\tthis._y = Math.atan2( m13, m33 );\r\n\t\t\t\tthis._z = Math.atan2( m21, m22 );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tthis._y = Math.atan2( - m31, m11 );\r\n\t\t\t\tthis._z = 0;\r\n\r\n\t\t\t}\r\n\r\n\t\t} else if ( order === 'ZXY' ) {\r\n\r\n\t\t\tthis._x = Math.asin( clamp( m32, - 1, 1 ) );\r\n\r\n\t\t\tif ( Math.abs( m32 ) < 0.99999 ) {\r\n\r\n\t\t\t\tthis._y = Math.atan2( - m31, m33 );\r\n\t\t\t\tthis._z = Math.atan2( - m12, m22 );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tthis._y = 0;\r\n\t\t\t\tthis._z = Math.atan2( m21, m11 );\r\n\r\n\t\t\t}\r\n\r\n\t\t} else if ( order === 'ZYX' ) {\r\n\r\n\t\t\tthis._y = Math.asin( - clamp( m31, - 1, 1 ) );\r\n\r\n\t\t\tif ( Math.abs( m31 ) < 0.99999 ) {\r\n\r\n\t\t\t\tthis._x = Math.atan2( m32, m33 );\r\n\t\t\t\tthis._z = Math.atan2( m21, m11 );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tthis._x = 0;\r\n\t\t\t\tthis._z = Math.atan2( - m12, m22 );\r\n\r\n\t\t\t}\r\n\r\n\t\t} else if ( order === 'YZX' ) {\r\n\r\n\t\t\tthis._z = Math.asin( clamp( m21, - 1, 1 ) );\r\n\r\n\t\t\tif ( Math.abs( m21 ) < 0.99999 ) {\r\n\r\n\t\t\t\tthis._x = Math.atan2( - m23, m22 );\r\n\t\t\t\tthis._y = Math.atan2( - m31, m11 );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tthis._x = 0;\r\n\t\t\t\tthis._y = Math.atan2( m13, m33 );\r\n\r\n\t\t\t}\r\n\r\n\t\t} else if ( order === 'XZY' ) {\r\n\r\n\t\t\tthis._z = Math.asin( - clamp( m12, - 1, 1 ) );\r\n\r\n\t\t\tif ( Math.abs( m12 ) < 0.99999 ) {\r\n\r\n\t\t\t\tthis._x = Math.atan2( m32, m22 );\r\n\t\t\t\tthis._y = Math.atan2( m13, m11 );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tthis._x = Math.atan2( - m23, m33 );\r\n\t\t\t\tthis._y = 0;\r\n\r\n\t\t\t}\r\n\r\n\t\t} else {\r\n\r\n\t\t\tconsole.warn( 'THREE.Euler: .setFromRotationMatrix() given unsupported order: ' + order );\r\n\r\n\t\t}\r\n\r\n\t\tthis._order = order;\r\n\r\n\t\tif ( update !== false ) this.onChangeCallback();\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tsetFromQuaternion: function () {\r\n\r\n\t\tvar matrix;\r\n\r\n\t\treturn function ( q, order, update ) {\r\n\r\n\t\t\tif ( matrix === undefined ) matrix = new THREE.Matrix4();\r\n\t\t\tmatrix.makeRotationFromQuaternion( q );\r\n\t\t\tthis.setFromRotationMatrix( matrix, order, update );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\tsetFromVector3: function ( v, order ) {\r\n\r\n\t\treturn this.set( v.x, v.y, v.z, order || this._order );\r\n\r\n\t},\r\n\r\n\treorder: function () {\r\n\r\n\t\t// WARNING: this discards revolution information -bhouston\r\n\r\n\t\tvar q = new THREE.Quaternion();\r\n\r\n\t\treturn function ( newOrder ) {\r\n\r\n\t\t\tq.setFromEuler( this );\r\n\t\t\tthis.setFromQuaternion( q, newOrder );\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\tequals: function ( euler ) {\r\n\r\n\t\treturn ( euler._x === this._x ) && ( euler._y === this._y ) && ( euler._z === this._z ) && ( euler._order === this._order );\r\n\r\n\t},\r\n\r\n\tfromArray: function ( array ) {\r\n\r\n\t\tthis._x = array[ 0 ];\r\n\t\tthis._y = array[ 1 ];\r\n\t\tthis._z = array[ 2 ];\r\n\t\tif ( array[ 3 ] !== undefined ) this._order = array[ 3 ];\r\n\r\n\t\tthis.onChangeCallback();\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\ttoArray: function ( array, offset ) {\r\n\r\n\t\tif ( array === undefined ) array = [];\r\n\t\tif ( offset === undefined ) offset = 0;\r\n\r\n\t\tarray[ offset ] = this._x;\r\n\t\tarray[ offset + 1 ] = this._y;\r\n\t\tarray[ offset + 2 ] = this._z;\r\n\t\tarray[ offset + 3 ] = this._order;\r\n\r\n\t\treturn array;\r\n\r\n\t},\r\n\r\n\ttoVector3: function ( optionalResult ) {\r\n\r\n\t\tif ( optionalResult ) {\r\n\r\n\t\t\treturn optionalResult.set( this._x, this._y, this._z );\r\n\r\n\t\t} else {\r\n\r\n\t\t\treturn new THREE.Vector3( this._x, this._y, this._z );\r\n\r\n\t\t}\r\n\r\n\t},\r\n\r\n\tonChange: function ( callback ) {\r\n\r\n\t\tthis.onChangeCallback = callback;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tonChangeCallback: function () {}\r\n\r\n};\r\n\r\n// File:src/math/Line3.js\r\n\r\n/**\r\n * @author bhouston / http://clara.io\r\n */\r\n\r\nTHREE.Line3 = function ( start, end ) {\r\n\r\n\tthis.start = ( start !== undefined ) ? start : new THREE.Vector3();\r\n\tthis.end = ( end !== undefined ) ? end : new THREE.Vector3();\r\n\r\n};\r\n\r\nTHREE.Line3.prototype = {\r\n\r\n\tconstructor: THREE.Line3,\r\n\r\n\tset: function ( start, end ) {\r\n\r\n\t\tthis.start.copy( start );\r\n\t\tthis.end.copy( end );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tclone: function () {\r\n\r\n\t\treturn new this.constructor().copy( this );\r\n\r\n\t},\r\n\r\n\tcopy: function ( line ) {\r\n\r\n\t\tthis.start.copy( line.start );\r\n\t\tthis.end.copy( line.end );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tcenter: function ( optionalTarget ) {\r\n\r\n\t\tvar result = optionalTarget || new THREE.Vector3();\r\n\t\treturn result.addVectors( this.start, this.end ).multiplyScalar( 0.5 );\r\n\r\n\t},\r\n\r\n\tdelta: function ( optionalTarget ) {\r\n\r\n\t\tvar result = optionalTarget || new THREE.Vector3();\r\n\t\treturn result.subVectors( this.end, this.start );\r\n\r\n\t},\r\n\r\n\tdistanceSq: function () {\r\n\r\n\t\treturn this.start.distanceToSquared( this.end );\r\n\r\n\t},\r\n\r\n\tdistance: function () {\r\n\r\n\t\treturn this.start.distanceTo( this.end );\r\n\r\n\t},\r\n\r\n\tat: function ( t, optionalTarget ) {\r\n\r\n\t\tvar result = optionalTarget || new THREE.Vector3();\r\n\r\n\t\treturn this.delta( result ).multiplyScalar( t ).add( this.start );\r\n\r\n\t},\r\n\r\n\tclosestPointToPointParameter: function () {\r\n\r\n\t\tvar startP = new THREE.Vector3();\r\n\t\tvar startEnd = new THREE.Vector3();\r\n\r\n\t\treturn function ( point, clampToLine ) {\r\n\r\n\t\t\tstartP.subVectors( point, this.start );\r\n\t\t\tstartEnd.subVectors( this.end, this.start );\r\n\r\n\t\t\tvar startEnd2 = startEnd.dot( startEnd );\r\n\t\t\tvar startEnd_startP = startEnd.dot( startP );\r\n\r\n\t\t\tvar t = startEnd_startP / startEnd2;\r\n\r\n\t\t\tif ( clampToLine ) {\r\n\r\n\t\t\t\tt = THREE.Math.clamp( t, 0, 1 );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn t;\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\tclosestPointToPoint: function ( point, clampToLine, optionalTarget ) {\r\n\r\n\t\tvar t = this.closestPointToPointParameter( point, clampToLine );\r\n\r\n\t\tvar result = optionalTarget || new THREE.Vector3();\r\n\r\n\t\treturn this.delta( result ).multiplyScalar( t ).add( this.start );\r\n\r\n\t},\r\n\r\n\tapplyMatrix4: function ( matrix ) {\r\n\r\n\t\tthis.start.applyMatrix4( matrix );\r\n\t\tthis.end.applyMatrix4( matrix );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tequals: function ( line ) {\r\n\r\n\t\treturn line.start.equals( this.start ) && line.end.equals( this.end );\r\n\r\n\t}\r\n\r\n};\r\n\r\n// File:src/math/Box2.js\r\n\r\n/**\r\n * @author bhouston / http://clara.io\r\n */\r\n\r\nTHREE.Box2 = function ( min, max ) {\r\n\r\n\tthis.min = ( min !== undefined ) ? min : new THREE.Vector2( + Infinity, + Infinity );\r\n\tthis.max = ( max !== undefined ) ? max : new THREE.Vector2( - Infinity, - Infinity );\r\n\r\n};\r\n\r\nTHREE.Box2.prototype = {\r\n\r\n\tconstructor: THREE.Box2,\r\n\r\n\tset: function ( min, max ) {\r\n\r\n\t\tthis.min.copy( min );\r\n\t\tthis.max.copy( max );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tsetFromPoints: function ( points ) {\r\n\r\n\t\tthis.makeEmpty();\r\n\r\n\t\tfor ( var i = 0, il = points.length; i < il; i ++ ) {\r\n\r\n\t\t\tthis.expandByPoint( points[ i ] );\r\n\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tsetFromCenterAndSize: function () {\r\n\r\n\t\tvar v1 = new THREE.Vector2();\r\n\r\n\t\treturn function ( center, size ) {\r\n\r\n\t\t\tvar halfSize = v1.copy( size ).multiplyScalar( 0.5 );\r\n\t\t\tthis.min.copy( center ).sub( halfSize );\r\n\t\t\tthis.max.copy( center ).add( halfSize );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\tclone: function () {\r\n\r\n\t\treturn new this.constructor().copy( this );\r\n\r\n\t},\r\n\r\n\tcopy: function ( box ) {\r\n\r\n\t\tthis.min.copy( box.min );\r\n\t\tthis.max.copy( box.max );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tmakeEmpty: function () {\r\n\r\n\t\tthis.min.x = this.min.y = + Infinity;\r\n\t\tthis.max.x = this.max.y = - Infinity;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tisEmpty: function () {\r\n\r\n\t\t// this is a more robust check for empty than ( volume <= 0 ) because volume can get positive with two negative axes\r\n\r\n\t\treturn ( this.max.x < this.min.x ) || ( this.max.y < this.min.y );\r\n\r\n\t},\r\n\r\n\tcenter: function ( optionalTarget ) {\r\n\r\n\t\tvar result = optionalTarget || new THREE.Vector2();\r\n\t\treturn result.addVectors( this.min, this.max ).multiplyScalar( 0.5 );\r\n\r\n\t},\r\n\r\n\tsize: function ( optionalTarget ) {\r\n\r\n\t\tvar result = optionalTarget || new THREE.Vector2();\r\n\t\treturn result.subVectors( this.max, this.min );\r\n\r\n\t},\r\n\r\n\texpandByPoint: function ( point ) {\r\n\r\n\t\tthis.min.min( point );\r\n\t\tthis.max.max( point );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\texpandByVector: function ( vector ) {\r\n\r\n\t\tthis.min.sub( vector );\r\n\t\tthis.max.add( vector );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\texpandByScalar: function ( scalar ) {\r\n\r\n\t\tthis.min.addScalar( - scalar );\r\n\t\tthis.max.addScalar( scalar );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tcontainsPoint: function ( point ) {\r\n\r\n\t\tif ( point.x < this.min.x || point.x > this.max.x ||\r\n\t\t     point.y < this.min.y || point.y > this.max.y ) {\r\n\r\n\t\t\treturn false;\r\n\r\n\t\t}\r\n\r\n\t\treturn true;\r\n\r\n\t},\r\n\r\n\tcontainsBox: function ( box ) {\r\n\r\n\t\tif ( ( this.min.x <= box.min.x ) && ( box.max.x <= this.max.x ) &&\r\n\t\t     ( this.min.y <= box.min.y ) && ( box.max.y <= this.max.y ) ) {\r\n\r\n\t\t\treturn true;\r\n\r\n\t\t}\r\n\r\n\t\treturn false;\r\n\r\n\t},\r\n\r\n\tgetParameter: function ( point, optionalTarget ) {\r\n\r\n\t\t// This can potentially have a divide by zero if the box\r\n\t\t// has a size dimension of 0.\r\n\r\n\t\tvar result = optionalTarget || new THREE.Vector2();\r\n\r\n\t\treturn result.set(\r\n\t\t\t( point.x - this.min.x ) / ( this.max.x - this.min.x ),\r\n\t\t\t( point.y - this.min.y ) / ( this.max.y - this.min.y )\r\n\t\t);\r\n\r\n\t},\r\n\r\n\tintersectsBox: function ( box ) {\r\n\r\n\t\t// using 6 splitting planes to rule out intersections.\r\n\r\n\t\tif ( box.max.x < this.min.x || box.min.x > this.max.x ||\r\n\t\t     box.max.y < this.min.y || box.min.y > this.max.y ) {\r\n\r\n\t\t\treturn false;\r\n\r\n\t\t}\r\n\r\n\t\treturn true;\r\n\r\n\t},\r\n\r\n\tclampPoint: function ( point, optionalTarget ) {\r\n\r\n\t\tvar result = optionalTarget || new THREE.Vector2();\r\n\t\treturn result.copy( point ).clamp( this.min, this.max );\r\n\r\n\t},\r\n\r\n\tdistanceToPoint: function () {\r\n\r\n\t\tvar v1 = new THREE.Vector2();\r\n\r\n\t\treturn function ( point ) {\r\n\r\n\t\t\tvar clampedPoint = v1.copy( point ).clamp( this.min, this.max );\r\n\t\t\treturn clampedPoint.sub( point ).length();\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\tintersect: function ( box ) {\r\n\r\n\t\tthis.min.max( box.min );\r\n\t\tthis.max.min( box.max );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tunion: function ( box ) {\r\n\r\n\t\tthis.min.min( box.min );\r\n\t\tthis.max.max( box.max );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\ttranslate: function ( offset ) {\r\n\r\n\t\tthis.min.add( offset );\r\n\t\tthis.max.add( offset );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tequals: function ( box ) {\r\n\r\n\t\treturn box.min.equals( this.min ) && box.max.equals( this.max );\r\n\r\n\t}\r\n\r\n};\r\n\r\n// File:src/math/Box3.js\r\n\r\n/**\r\n * @author bhouston / http://clara.io\r\n * @author WestLangley / http://github.com/WestLangley\r\n */\r\n\r\nTHREE.Box3 = function ( min, max ) {\r\n\r\n\tthis.min = ( min !== undefined ) ? min : new THREE.Vector3( + Infinity, + Infinity, + Infinity );\r\n\tthis.max = ( max !== undefined ) ? max : new THREE.Vector3( - Infinity, - Infinity, - Infinity );\r\n\r\n};\r\n\r\nTHREE.Box3.prototype = {\r\n\r\n\tconstructor: THREE.Box3,\r\n\r\n\tset: function ( min, max ) {\r\n\r\n\t\tthis.min.copy( min );\r\n\t\tthis.max.copy( max );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tsetFromArray: function ( array ) {\r\n\r\n\t\tvar minX = + Infinity;\r\n\t\tvar minY = + Infinity;\r\n\t\tvar minZ = + Infinity;\r\n\r\n\t\tvar maxX = - Infinity;\r\n\t\tvar maxY = - Infinity;\r\n\t\tvar maxZ = - Infinity;\r\n\r\n\t\tfor ( var i = 0, l = array.length; i < l; i += 3 ) {\r\n\r\n\t\t\tvar x = array[ i ];\r\n\t\t\tvar y = array[ i + 1 ];\r\n\t\t\tvar z = array[ i + 2 ];\r\n\r\n\t\t\tif ( x < minX ) minX = x;\r\n\t\t\tif ( y < minY ) minY = y;\r\n\t\t\tif ( z < minZ ) minZ = z;\r\n\r\n\t\t\tif ( x > maxX ) maxX = x;\r\n\t\t\tif ( y > maxY ) maxY = y;\r\n\t\t\tif ( z > maxZ ) maxZ = z;\r\n\r\n\t\t}\r\n\r\n\t\tthis.min.set( minX, minY, minZ );\r\n\t\tthis.max.set( maxX, maxY, maxZ );\r\n\r\n\t},\r\n\r\n\tsetFromPoints: function ( points ) {\r\n\r\n\t\tthis.makeEmpty();\r\n\r\n\t\tfor ( var i = 0, il = points.length; i < il; i ++ ) {\r\n\r\n\t\t\tthis.expandByPoint( points[ i ] );\r\n\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tsetFromCenterAndSize: function () {\r\n\r\n\t\tvar v1 = new THREE.Vector3();\r\n\r\n\t\treturn function ( center, size ) {\r\n\r\n\t\t\tvar halfSize = v1.copy( size ).multiplyScalar( 0.5 );\r\n\r\n\t\t\tthis.min.copy( center ).sub( halfSize );\r\n\t\t\tthis.max.copy( center ).add( halfSize );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\tsetFromObject: function () {\r\n\r\n\t\t// Computes the world-axis-aligned bounding box of an object (including its children),\r\n\t\t// accounting for both the object's, and children's, world transforms\r\n\r\n\t\tvar v1 = new THREE.Vector3();\r\n\r\n\t\treturn function ( object ) {\r\n\r\n\t\t\tvar scope = this;\r\n\r\n\t\t\tobject.updateMatrixWorld( true );\r\n\r\n\t\t\tthis.makeEmpty();\r\n\r\n\t\t\tobject.traverse( function ( node ) {\r\n\r\n\t\t\t\tvar geometry = node.geometry;\r\n\r\n\t\t\t\tif ( geometry !== undefined ) {\r\n\r\n\t\t\t\t\tif ( geometry instanceof THREE.Geometry ) {\r\n\r\n\t\t\t\t\t\tvar vertices = geometry.vertices;\r\n\r\n\t\t\t\t\t\tfor ( var i = 0, il = vertices.length; i < il; i ++ ) {\r\n\r\n\t\t\t\t\t\t\tv1.copy( vertices[ i ] );\r\n\t\t\t\t\t\t\tv1.applyMatrix4( node.matrixWorld );\r\n\r\n\t\t\t\t\t\t\tscope.expandByPoint( v1 );\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t} else if ( geometry instanceof THREE.BufferGeometry && geometry.attributes[ 'position' ] !== undefined ) {\r\n\r\n\t\t\t\t\t\tvar positions = geometry.attributes[ 'position' ].array;\r\n\r\n\t\t\t\t\t\tfor ( var i = 0, il = positions.length; i < il; i += 3 ) {\r\n\r\n\t\t\t\t\t\t\tv1.fromArray( positions, i );\r\n\t\t\t\t\t\t\tv1.applyMatrix4( node.matrixWorld );\r\n\r\n\t\t\t\t\t\t\tscope.expandByPoint( v1 );\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t} );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\tclone: function () {\r\n\r\n\t\treturn new this.constructor().copy( this );\r\n\r\n\t},\r\n\r\n\tcopy: function ( box ) {\r\n\r\n\t\tthis.min.copy( box.min );\r\n\t\tthis.max.copy( box.max );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tmakeEmpty: function () {\r\n\r\n\t\tthis.min.x = this.min.y = this.min.z = + Infinity;\r\n\t\tthis.max.x = this.max.y = this.max.z = - Infinity;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tisEmpty: function () {\r\n\r\n\t\t// this is a more robust check for empty than ( volume <= 0 ) because volume can get positive with two negative axes\r\n\r\n\t\treturn ( this.max.x < this.min.x ) || ( this.max.y < this.min.y ) || ( this.max.z < this.min.z );\r\n\r\n\t},\r\n\r\n\tcenter: function ( optionalTarget ) {\r\n\r\n\t\tvar result = optionalTarget || new THREE.Vector3();\r\n\t\treturn result.addVectors( this.min, this.max ).multiplyScalar( 0.5 );\r\n\r\n\t},\r\n\r\n\tsize: function ( optionalTarget ) {\r\n\r\n\t\tvar result = optionalTarget || new THREE.Vector3();\r\n\t\treturn result.subVectors( this.max, this.min );\r\n\r\n\t},\r\n\r\n\texpandByPoint: function ( point ) {\r\n\r\n\t\tthis.min.min( point );\r\n\t\tthis.max.max( point );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\texpandByVector: function ( vector ) {\r\n\r\n\t\tthis.min.sub( vector );\r\n\t\tthis.max.add( vector );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\texpandByScalar: function ( scalar ) {\r\n\r\n\t\tthis.min.addScalar( - scalar );\r\n\t\tthis.max.addScalar( scalar );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tcontainsPoint: function ( point ) {\r\n\r\n\t\tif ( point.x < this.min.x || point.x > this.max.x ||\r\n\t\t\t\t point.y < this.min.y || point.y > this.max.y ||\r\n\t\t\t\t point.z < this.min.z || point.z > this.max.z ) {\r\n\r\n\t\t\treturn false;\r\n\r\n\t\t}\r\n\r\n\t\treturn true;\r\n\r\n\t},\r\n\r\n\tcontainsBox: function ( box ) {\r\n\r\n\t\tif ( ( this.min.x <= box.min.x ) && ( box.max.x <= this.max.x ) &&\r\n\t\t\t ( this.min.y <= box.min.y ) && ( box.max.y <= this.max.y ) &&\r\n\t\t\t ( this.min.z <= box.min.z ) && ( box.max.z <= this.max.z ) ) {\r\n\r\n\t\t\treturn true;\r\n\r\n\t\t}\r\n\r\n\t\treturn false;\r\n\r\n\t},\r\n\r\n\tgetParameter: function ( point, optionalTarget ) {\r\n\r\n\t\t// This can potentially have a divide by zero if the box\r\n\t\t// has a size dimension of 0.\r\n\r\n\t\tvar result = optionalTarget || new THREE.Vector3();\r\n\r\n\t\treturn result.set(\r\n\t\t\t( point.x - this.min.x ) / ( this.max.x - this.min.x ),\r\n\t\t\t( point.y - this.min.y ) / ( this.max.y - this.min.y ),\r\n\t\t\t( point.z - this.min.z ) / ( this.max.z - this.min.z )\r\n\t\t);\r\n\r\n\t},\r\n\r\n\tintersectsBox: function ( box ) {\r\n\r\n\t\t// using 6 splitting planes to rule out intersections.\r\n\r\n\t\tif ( box.max.x < this.min.x || box.min.x > this.max.x ||\r\n\t\t\t\t box.max.y < this.min.y || box.min.y > this.max.y ||\r\n\t\t\t\t box.max.z < this.min.z || box.min.z > this.max.z ) {\r\n\r\n\t\t\treturn false;\r\n\r\n\t\t}\r\n\r\n\t\treturn true;\r\n\r\n\t},\r\n\r\n\tintersectsSphere: ( function () {\r\n\r\n\t\tvar closestPoint;\r\n\r\n\t\treturn function intersectsSphere( sphere ) {\r\n\r\n\t\t\tif ( closestPoint === undefined ) closestPoint = new THREE.Vector3();\r\n\r\n\t\t\t// Find the point on the AABB closest to the sphere center.\r\n\t\t\tthis.clampPoint( sphere.center, closestPoint );\r\n\r\n\t\t\t// If that point is inside the sphere, the AABB and sphere intersect.\r\n\t\t\treturn closestPoint.distanceToSquared( sphere.center ) <= ( sphere.radius * sphere.radius );\r\n\r\n\t\t};\r\n\r\n\t} )(),\r\n\r\n\tintersectsPlane: function ( plane ) {\r\n\r\n\t\t// We compute the minimum and maximum dot product values. If those values\r\n\t\t// are on the same side (back or front) of the plane, then there is no intersection.\r\n\r\n\t\tvar min, max;\r\n\r\n\t\tif ( plane.normal.x > 0 ) {\r\n\r\n\t\t\tmin = plane.normal.x * this.min.x;\r\n\t\t\tmax = plane.normal.x * this.max.x;\r\n\r\n\t\t} else {\r\n\r\n\t\t\tmin = plane.normal.x * this.max.x;\r\n\t\t\tmax = plane.normal.x * this.min.x;\r\n\r\n\t\t}\r\n\r\n\t\tif ( plane.normal.y > 0 ) {\r\n\r\n\t\t\tmin += plane.normal.y * this.min.y;\r\n\t\t\tmax += plane.normal.y * this.max.y;\r\n\r\n\t\t} else {\r\n\r\n\t\t\tmin += plane.normal.y * this.max.y;\r\n\t\t\tmax += plane.normal.y * this.min.y;\r\n\r\n\t\t}\r\n\r\n\t\tif ( plane.normal.z > 0 ) {\r\n\r\n\t\t\tmin += plane.normal.z * this.min.z;\r\n\t\t\tmax += plane.normal.z * this.max.z;\r\n\r\n\t\t} else {\r\n\r\n\t\t\tmin += plane.normal.z * this.max.z;\r\n\t\t\tmax += plane.normal.z * this.min.z;\r\n\r\n\t\t}\r\n\r\n\t\treturn ( min <= plane.constant && max >= plane.constant );\r\n\r\n\t},\r\n\r\n\tclampPoint: function ( point, optionalTarget ) {\r\n\r\n\t\tvar result = optionalTarget || new THREE.Vector3();\r\n\t\treturn result.copy( point ).clamp( this.min, this.max );\r\n\r\n\t},\r\n\r\n\tdistanceToPoint: function () {\r\n\r\n\t\tvar v1 = new THREE.Vector3();\r\n\r\n\t\treturn function ( point ) {\r\n\r\n\t\t\tvar clampedPoint = v1.copy( point ).clamp( this.min, this.max );\r\n\t\t\treturn clampedPoint.sub( point ).length();\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\tgetBoundingSphere: function () {\r\n\r\n\t\tvar v1 = new THREE.Vector3();\r\n\r\n\t\treturn function ( optionalTarget ) {\r\n\r\n\t\t\tvar result = optionalTarget || new THREE.Sphere();\r\n\r\n\t\t\tresult.center = this.center();\r\n\t\t\tresult.radius = this.size( v1 ).length() * 0.5;\r\n\r\n\t\t\treturn result;\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\tintersect: function ( box ) {\r\n\r\n\t\tthis.min.max( box.min );\r\n\t\tthis.max.min( box.max );\r\n\r\n\t\t// ensure that if there is no overlap, the result is fully empty, not slightly empty with non-inf/+inf values that will cause subsequence intersects to erroneously return valid values.\r\n\t\tif( this.isEmpty() ) this.makeEmpty();\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tunion: function ( box ) {\r\n\r\n\t\tthis.min.min( box.min );\r\n\t\tthis.max.max( box.max );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tapplyMatrix4: function () {\r\n\r\n\t\tvar points = [\r\n\t\t\tnew THREE.Vector3(),\r\n\t\t\tnew THREE.Vector3(),\r\n\t\t\tnew THREE.Vector3(),\r\n\t\t\tnew THREE.Vector3(),\r\n\t\t\tnew THREE.Vector3(),\r\n\t\t\tnew THREE.Vector3(),\r\n\t\t\tnew THREE.Vector3(),\r\n\t\t\tnew THREE.Vector3()\r\n\t\t];\r\n\r\n\t\treturn function ( matrix ) {\r\n\r\n\t\t\t// transform of empty box is an empty box.\r\n\t\t\tif( this.isEmpty() ) return this;\r\n\r\n\t\t\t// NOTE: I am using a binary pattern to specify all 2^3 combinations below\r\n\t\t\tpoints[ 0 ].set( this.min.x, this.min.y, this.min.z ).applyMatrix4( matrix ); // 000\r\n\t\t\tpoints[ 1 ].set( this.min.x, this.min.y, this.max.z ).applyMatrix4( matrix ); // 001\r\n\t\t\tpoints[ 2 ].set( this.min.x, this.max.y, this.min.z ).applyMatrix4( matrix ); // 010\r\n\t\t\tpoints[ 3 ].set( this.min.x, this.max.y, this.max.z ).applyMatrix4( matrix ); // 011\r\n\t\t\tpoints[ 4 ].set( this.max.x, this.min.y, this.min.z ).applyMatrix4( matrix ); // 100\r\n\t\t\tpoints[ 5 ].set( this.max.x, this.min.y, this.max.z ).applyMatrix4( matrix ); // 101\r\n\t\t\tpoints[ 6 ].set( this.max.x, this.max.y, this.min.z ).applyMatrix4( matrix ); // 110\r\n\t\t\tpoints[ 7 ].set( this.max.x, this.max.y, this.max.z ).applyMatrix4( matrix );\t// 111\r\n\r\n\t\t\tthis.setFromPoints( points );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\ttranslate: function ( offset ) {\r\n\r\n\t\tthis.min.add( offset );\r\n\t\tthis.max.add( offset );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tequals: function ( box ) {\r\n\r\n\t\treturn box.min.equals( this.min ) && box.max.equals( this.max );\r\n\r\n\t}\r\n\r\n};\r\n\r\n// File:src/math/Matrix3.js\r\n\r\n/**\r\n * @author alteredq / http://alteredqualia.com/\r\n * @author WestLangley / http://github.com/WestLangley\r\n * @author bhouston / http://clara.io\r\n * @author tschw\r\n */\r\n\r\nTHREE.Matrix3 = function () {\r\n\r\n\tthis.elements = new Float32Array( [\r\n\r\n\t\t1, 0, 0,\r\n\t\t0, 1, 0,\r\n\t\t0, 0, 1\r\n\r\n\t] );\r\n\r\n\tif ( arguments.length > 0 ) {\r\n\r\n\t\tconsole.error( 'THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.' );\r\n\r\n\t}\r\n\r\n};\r\n\r\nTHREE.Matrix3.prototype = {\r\n\r\n\tconstructor: THREE.Matrix3,\r\n\r\n\tset: function ( n11, n12, n13, n21, n22, n23, n31, n32, n33 ) {\r\n\r\n\t\tvar te = this.elements;\r\n\r\n\t\tte[ 0 ] = n11; te[ 1 ] = n21; te[ 2 ] = n31;\r\n\t\tte[ 3 ] = n12; te[ 4 ] = n22; te[ 5 ] = n32;\r\n\t\tte[ 6 ] = n13; te[ 7 ] = n23; te[ 8 ] = n33;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tidentity: function () {\r\n\r\n\t\tthis.set(\r\n\r\n\t\t\t1, 0, 0,\r\n\t\t\t0, 1, 0,\r\n\t\t\t0, 0, 1\r\n\r\n\t\t);\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tclone: function () {\r\n\r\n\t\treturn new this.constructor().fromArray( this.elements );\r\n\r\n\t},\r\n\r\n\tcopy: function ( m ) {\r\n\r\n\t\tvar me = m.elements;\r\n\r\n\t\tthis.set(\r\n\r\n\t\t\tme[ 0 ], me[ 3 ], me[ 6 ],\r\n\t\t\tme[ 1 ], me[ 4 ], me[ 7 ],\r\n\t\t\tme[ 2 ], me[ 5 ], me[ 8 ]\r\n\r\n\t\t);\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tsetFromMatrix4: function( m ) {\r\n\r\n\t\tvar me = m.elements;\r\n\r\n\t\tthis.set(\r\n\r\n\t\t\tme[ 0 ], me[ 4 ], me[  8 ],\r\n\t\t\tme[ 1 ], me[ 5 ], me[  9 ],\r\n\t\t\tme[ 2 ], me[ 6 ], me[ 10 ]\r\n\r\n\t\t);\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tapplyToVector3Array: function () {\r\n\r\n\t\tvar v1;\r\n\r\n\t\treturn function ( array, offset, length ) {\r\n\r\n\t\t\tif ( v1 === undefined ) v1 = new THREE.Vector3();\r\n\t\t\tif ( offset === undefined ) offset = 0;\r\n\t\t\tif ( length === undefined ) length = array.length;\r\n\r\n\t\t\tfor ( var i = 0, j = offset; i < length; i += 3, j += 3 ) {\r\n\r\n\t\t\t\tv1.fromArray( array, j );\r\n\t\t\t\tv1.applyMatrix3( this );\r\n\t\t\t\tv1.toArray( array, j );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn array;\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\tapplyToBuffer: function () {\r\n\r\n\t\tvar v1;\r\n\r\n\t\treturn function applyToBuffer( buffer, offset, length ) {\r\n\r\n\t\t\tif ( v1 === undefined ) v1 = new THREE.Vector3();\r\n\t\t\tif ( offset === undefined ) offset = 0;\r\n\t\t\tif ( length === undefined ) length = buffer.length / buffer.itemSize;\r\n\r\n\t\t\tfor ( var i = 0, j = offset; i < length; i ++, j ++ ) {\r\n\r\n\t\t\t\tv1.x = buffer.getX( j );\r\n\t\t\t\tv1.y = buffer.getY( j );\r\n\t\t\t\tv1.z = buffer.getZ( j );\r\n\r\n\t\t\t\tv1.applyMatrix3( this );\r\n\r\n\t\t\t\tbuffer.setXYZ( v1.x, v1.y, v1.z );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn buffer;\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\tmultiplyScalar: function ( s ) {\r\n\r\n\t\tvar te = this.elements;\r\n\r\n\t\tte[ 0 ] *= s; te[ 3 ] *= s; te[ 6 ] *= s;\r\n\t\tte[ 1 ] *= s; te[ 4 ] *= s; te[ 7 ] *= s;\r\n\t\tte[ 2 ] *= s; te[ 5 ] *= s; te[ 8 ] *= s;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tdeterminant: function () {\r\n\r\n\t\tvar te = this.elements;\r\n\r\n\t\tvar a = te[ 0 ], b = te[ 1 ], c = te[ 2 ],\r\n\t\t\td = te[ 3 ], e = te[ 4 ], f = te[ 5 ],\r\n\t\t\tg = te[ 6 ], h = te[ 7 ], i = te[ 8 ];\r\n\r\n\t\treturn a * e * i - a * f * h - b * d * i + b * f * g + c * d * h - c * e * g;\r\n\r\n\t},\r\n\r\n\tgetInverse: function ( matrix, throwOnDegenerate ) {\r\n\r\n\t\tif ( matrix instanceof THREE.Matrix4 ) {\r\n\r\n\t\t\tconsole.error( \"THREE.Matrix3.getInverse no longer takes a Matrix4 argument.\" );\r\n\r\n\t\t}\r\n\r\n\t\tvar me = matrix.elements,\r\n\t\t\tte = this.elements,\r\n\r\n\t\t\tn11 = me[ 0 ], n21 = me[ 1 ], n31 = me[ 2 ],\r\n\t\t\tn12 = me[ 3 ], n22 = me[ 4 ], n32 = me[ 5 ],\r\n\t\t\tn13 = me[ 6 ], n23 = me[ 7 ], n33 = me[ 8 ],\r\n\r\n\t\t\tt11 = n33 * n22 - n32 * n23,\r\n\t\t\tt12 = n32 * n13 - n33 * n12,\r\n\t\t\tt13 = n23 * n12 - n22 * n13,\r\n\r\n\t\t\tdet = n11 * t11 + n21 * t12 + n31 * t13;\r\n\r\n\t\tif ( det === 0 ) {\r\n\r\n\t\t\tvar msg = \"THREE.Matrix3.getInverse(): can't invert matrix, determinant is 0\";\r\n\r\n\t\t\tif ( throwOnDegenerate || false ) {\r\n\r\n\t\t\t\tthrow new Error( msg );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tconsole.warn( msg );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn this.identity();\r\n\t\t}\r\n\r\n\t\tte[ 0 ] = t11;\r\n\t\tte[ 1 ] = n31 * n23 - n33 * n21;\r\n\t\tte[ 2 ] = n32 * n21 - n31 * n22;\r\n\r\n\t\tte[ 3 ] = t12;\r\n\t\tte[ 4 ] = n33 * n11 - n31 * n13;\r\n\t\tte[ 5 ] = n31 * n12 - n32 * n11;\r\n\r\n\t\tte[ 6 ] = t13;\r\n\t\tte[ 7 ] = n21 * n13 - n23 * n11;\r\n\t\tte[ 8 ] = n22 * n11 - n21 * n12;\r\n\r\n\t\treturn this.multiplyScalar( 1 / det );\r\n\r\n\t},\r\n\r\n\ttranspose: function () {\r\n\r\n\t\tvar tmp, m = this.elements;\r\n\r\n\t\ttmp = m[ 1 ]; m[ 1 ] = m[ 3 ]; m[ 3 ] = tmp;\r\n\t\ttmp = m[ 2 ]; m[ 2 ] = m[ 6 ]; m[ 6 ] = tmp;\r\n\t\ttmp = m[ 5 ]; m[ 5 ] = m[ 7 ]; m[ 7 ] = tmp;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tflattenToArrayOffset: function ( array, offset ) {\r\n\r\n\t\tconsole.warn( \"THREE.Matrix3: .flattenToArrayOffset is deprecated \" +\r\n\t\t\t\t\"- just use .toArray instead.\" );\r\n\r\n\t\treturn this.toArray( array, offset );\r\n\r\n\t},\r\n\r\n\tgetNormalMatrix: function ( matrix4 ) {\r\n\r\n\t\treturn this.setFromMatrix4( matrix4 ).getInverse( this ).transpose();\r\n\r\n\t},\r\n\r\n\ttransposeIntoArray: function ( r ) {\r\n\r\n\t\tvar m = this.elements;\r\n\r\n\t\tr[ 0 ] = m[ 0 ];\r\n\t\tr[ 1 ] = m[ 3 ];\r\n\t\tr[ 2 ] = m[ 6 ];\r\n\t\tr[ 3 ] = m[ 1 ];\r\n\t\tr[ 4 ] = m[ 4 ];\r\n\t\tr[ 5 ] = m[ 7 ];\r\n\t\tr[ 6 ] = m[ 2 ];\r\n\t\tr[ 7 ] = m[ 5 ];\r\n\t\tr[ 8 ] = m[ 8 ];\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tfromArray: function ( array ) {\r\n\r\n\t\tthis.elements.set( array );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\ttoArray: function ( array, offset ) {\r\n\r\n\t\tif ( array === undefined ) array = [];\r\n\t\tif ( offset === undefined ) offset = 0;\r\n\r\n\t\tvar te = this.elements;\r\n\r\n\t\tarray[ offset ] = te[ 0 ];\r\n\t\tarray[ offset + 1 ] = te[ 1 ];\r\n\t\tarray[ offset + 2 ] = te[ 2 ];\r\n\r\n\t\tarray[ offset + 3 ] = te[ 3 ];\r\n\t\tarray[ offset + 4 ] = te[ 4 ];\r\n\t\tarray[ offset + 5 ] = te[ 5 ];\r\n\r\n\t\tarray[ offset + 6 ] = te[ 6 ];\r\n\t\tarray[ offset + 7 ] = te[ 7 ];\r\n\t\tarray[ offset + 8 ]  = te[ 8 ];\r\n\r\n\t\treturn array;\r\n\r\n\t}\r\n\r\n};\r\n\r\n// File:src/math/Matrix4.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author supereggbert / http://www.paulbrunt.co.uk/\r\n * @author philogb / http://blog.thejit.org/\r\n * @author jordi_ros / http://plattsoft.com\r\n * @author D1plo1d / http://github.com/D1plo1d\r\n * @author alteredq / http://alteredqualia.com/\r\n * @author mikael emtinger / http://gomo.se/\r\n * @author timknip / http://www.floorplanner.com/\r\n * @author bhouston / http://clara.io\r\n * @author WestLangley / http://github.com/WestLangley\r\n */\r\n\r\nTHREE.Matrix4 = function () {\r\n\r\n\tthis.elements = new Float32Array( [\r\n\r\n\t\t1, 0, 0, 0,\r\n\t\t0, 1, 0, 0,\r\n\t\t0, 0, 1, 0,\r\n\t\t0, 0, 0, 1\r\n\r\n\t] );\r\n\r\n\tif ( arguments.length > 0 ) {\r\n\r\n\t\tconsole.error( 'THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.' );\r\n\r\n\t}\r\n\r\n};\r\n\r\nTHREE.Matrix4.prototype = {\r\n\r\n\tconstructor: THREE.Matrix4,\r\n\r\n\tset: function ( n11, n12, n13, n14, n21, n22, n23, n24, n31, n32, n33, n34, n41, n42, n43, n44 ) {\r\n\r\n\t\tvar te = this.elements;\r\n\r\n\t\tte[ 0 ] = n11; te[ 4 ] = n12; te[ 8 ] = n13; te[ 12 ] = n14;\r\n\t\tte[ 1 ] = n21; te[ 5 ] = n22; te[ 9 ] = n23; te[ 13 ] = n24;\r\n\t\tte[ 2 ] = n31; te[ 6 ] = n32; te[ 10 ] = n33; te[ 14 ] = n34;\r\n\t\tte[ 3 ] = n41; te[ 7 ] = n42; te[ 11 ] = n43; te[ 15 ] = n44;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tidentity: function () {\r\n\r\n\t\tthis.set(\r\n\r\n\t\t\t1, 0, 0, 0,\r\n\t\t\t0, 1, 0, 0,\r\n\t\t\t0, 0, 1, 0,\r\n\t\t\t0, 0, 0, 1\r\n\r\n\t\t);\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tclone: function () {\r\n\r\n\t\treturn new THREE.Matrix4().fromArray( this.elements );\r\n\r\n\t},\r\n\r\n\tcopy: function ( m ) {\r\n\r\n\t\tthis.elements.set( m.elements );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tcopyPosition: function ( m ) {\r\n\r\n\t\tvar te = this.elements;\r\n\t\tvar me = m.elements;\r\n\r\n\t\tte[ 12 ] = me[ 12 ];\r\n\t\tte[ 13 ] = me[ 13 ];\r\n\t\tte[ 14 ] = me[ 14 ];\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\textractBasis: function ( xAxis, yAxis, zAxis ) {\r\n\r\n\t\txAxis.setFromMatrixColumn( this, 0 );\r\n\t\tyAxis.setFromMatrixColumn( this, 1 );\r\n\t\tzAxis.setFromMatrixColumn( this, 2 );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tmakeBasis: function ( xAxis, yAxis, zAxis ) {\r\n\r\n\t\tthis.set(\r\n\t\t\txAxis.x, yAxis.x, zAxis.x, 0,\r\n\t\t\txAxis.y, yAxis.y, zAxis.y, 0,\r\n\t\t\txAxis.z, yAxis.z, zAxis.z, 0,\r\n\t\t\t0,       0,       0,       1\r\n\t\t);\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\textractRotation: function () {\r\n\r\n\t\tvar v1;\r\n\r\n\t\treturn function ( m ) {\r\n\r\n\t\t\tif ( v1 === undefined ) v1 = new THREE.Vector3();\r\n\r\n\t\t\tvar te = this.elements;\r\n\t\t\tvar me = m.elements;\r\n\r\n\t\t\tvar scaleX = 1 / v1.setFromMatrixColumn( m, 0 ).length();\r\n\t\t\tvar scaleY = 1 / v1.setFromMatrixColumn( m, 1 ).length();\r\n\t\t\tvar scaleZ = 1 / v1.setFromMatrixColumn( m, 2 ).length();\r\n\r\n\t\t\tte[ 0 ] = me[ 0 ] * scaleX;\r\n\t\t\tte[ 1 ] = me[ 1 ] * scaleX;\r\n\t\t\tte[ 2 ] = me[ 2 ] * scaleX;\r\n\r\n\t\t\tte[ 4 ] = me[ 4 ] * scaleY;\r\n\t\t\tte[ 5 ] = me[ 5 ] * scaleY;\r\n\t\t\tte[ 6 ] = me[ 6 ] * scaleY;\r\n\r\n\t\t\tte[ 8 ] = me[ 8 ] * scaleZ;\r\n\t\t\tte[ 9 ] = me[ 9 ] * scaleZ;\r\n\t\t\tte[ 10 ] = me[ 10 ] * scaleZ;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\tmakeRotationFromEuler: function ( euler ) {\r\n\r\n\t\tif ( euler instanceof THREE.Euler === false ) {\r\n\r\n\t\t\tconsole.error( 'THREE.Matrix: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.' );\r\n\r\n\t\t}\r\n\r\n\t\tvar te = this.elements;\r\n\r\n\t\tvar x = euler.x, y = euler.y, z = euler.z;\r\n\t\tvar a = Math.cos( x ), b = Math.sin( x );\r\n\t\tvar c = Math.cos( y ), d = Math.sin( y );\r\n\t\tvar e = Math.cos( z ), f = Math.sin( z );\r\n\r\n\t\tif ( euler.order === 'XYZ' ) {\r\n\r\n\t\t\tvar ae = a * e, af = a * f, be = b * e, bf = b * f;\r\n\r\n\t\t\tte[ 0 ] = c * e;\r\n\t\t\tte[ 4 ] = - c * f;\r\n\t\t\tte[ 8 ] = d;\r\n\r\n\t\t\tte[ 1 ] = af + be * d;\r\n\t\t\tte[ 5 ] = ae - bf * d;\r\n\t\t\tte[ 9 ] = - b * c;\r\n\r\n\t\t\tte[ 2 ] = bf - ae * d;\r\n\t\t\tte[ 6 ] = be + af * d;\r\n\t\t\tte[ 10 ] = a * c;\r\n\r\n\t\t} else if ( euler.order === 'YXZ' ) {\r\n\r\n\t\t\tvar ce = c * e, cf = c * f, de = d * e, df = d * f;\r\n\r\n\t\t\tte[ 0 ] = ce + df * b;\r\n\t\t\tte[ 4 ] = de * b - cf;\r\n\t\t\tte[ 8 ] = a * d;\r\n\r\n\t\t\tte[ 1 ] = a * f;\r\n\t\t\tte[ 5 ] = a * e;\r\n\t\t\tte[ 9 ] = - b;\r\n\r\n\t\t\tte[ 2 ] = cf * b - de;\r\n\t\t\tte[ 6 ] = df + ce * b;\r\n\t\t\tte[ 10 ] = a * c;\r\n\r\n\t\t} else if ( euler.order === 'ZXY' ) {\r\n\r\n\t\t\tvar ce = c * e, cf = c * f, de = d * e, df = d * f;\r\n\r\n\t\t\tte[ 0 ] = ce - df * b;\r\n\t\t\tte[ 4 ] = - a * f;\r\n\t\t\tte[ 8 ] = de + cf * b;\r\n\r\n\t\t\tte[ 1 ] = cf + de * b;\r\n\t\t\tte[ 5 ] = a * e;\r\n\t\t\tte[ 9 ] = df - ce * b;\r\n\r\n\t\t\tte[ 2 ] = - a * d;\r\n\t\t\tte[ 6 ] = b;\r\n\t\t\tte[ 10 ] = a * c;\r\n\r\n\t\t} else if ( euler.order === 'ZYX' ) {\r\n\r\n\t\t\tvar ae = a * e, af = a * f, be = b * e, bf = b * f;\r\n\r\n\t\t\tte[ 0 ] = c * e;\r\n\t\t\tte[ 4 ] = be * d - af;\r\n\t\t\tte[ 8 ] = ae * d + bf;\r\n\r\n\t\t\tte[ 1 ] = c * f;\r\n\t\t\tte[ 5 ] = bf * d + ae;\r\n\t\t\tte[ 9 ] = af * d - be;\r\n\r\n\t\t\tte[ 2 ] = - d;\r\n\t\t\tte[ 6 ] = b * c;\r\n\t\t\tte[ 10 ] = a * c;\r\n\r\n\t\t} else if ( euler.order === 'YZX' ) {\r\n\r\n\t\t\tvar ac = a * c, ad = a * d, bc = b * c, bd = b * d;\r\n\r\n\t\t\tte[ 0 ] = c * e;\r\n\t\t\tte[ 4 ] = bd - ac * f;\r\n\t\t\tte[ 8 ] = bc * f + ad;\r\n\r\n\t\t\tte[ 1 ] = f;\r\n\t\t\tte[ 5 ] = a * e;\r\n\t\t\tte[ 9 ] = - b * e;\r\n\r\n\t\t\tte[ 2 ] = - d * e;\r\n\t\t\tte[ 6 ] = ad * f + bc;\r\n\t\t\tte[ 10 ] = ac - bd * f;\r\n\r\n\t\t} else if ( euler.order === 'XZY' ) {\r\n\r\n\t\t\tvar ac = a * c, ad = a * d, bc = b * c, bd = b * d;\r\n\r\n\t\t\tte[ 0 ] = c * e;\r\n\t\t\tte[ 4 ] = - f;\r\n\t\t\tte[ 8 ] = d * e;\r\n\r\n\t\t\tte[ 1 ] = ac * f + bd;\r\n\t\t\tte[ 5 ] = a * e;\r\n\t\t\tte[ 9 ] = ad * f - bc;\r\n\r\n\t\t\tte[ 2 ] = bc * f - ad;\r\n\t\t\tte[ 6 ] = b * e;\r\n\t\t\tte[ 10 ] = bd * f + ac;\r\n\r\n\t\t}\r\n\r\n\t\t// last column\r\n\t\tte[ 3 ] = 0;\r\n\t\tte[ 7 ] = 0;\r\n\t\tte[ 11 ] = 0;\r\n\r\n\t\t// bottom row\r\n\t\tte[ 12 ] = 0;\r\n\t\tte[ 13 ] = 0;\r\n\t\tte[ 14 ] = 0;\r\n\t\tte[ 15 ] = 1;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tmakeRotationFromQuaternion: function ( q ) {\r\n\r\n\t\tvar te = this.elements;\r\n\r\n\t\tvar x = q.x, y = q.y, z = q.z, w = q.w;\r\n\t\tvar x2 = x + x, y2 = y + y, z2 = z + z;\r\n\t\tvar xx = x * x2, xy = x * y2, xz = x * z2;\r\n\t\tvar yy = y * y2, yz = y * z2, zz = z * z2;\r\n\t\tvar wx = w * x2, wy = w * y2, wz = w * z2;\r\n\r\n\t\tte[ 0 ] = 1 - ( yy + zz );\r\n\t\tte[ 4 ] = xy - wz;\r\n\t\tte[ 8 ] = xz + wy;\r\n\r\n\t\tte[ 1 ] = xy + wz;\r\n\t\tte[ 5 ] = 1 - ( xx + zz );\r\n\t\tte[ 9 ] = yz - wx;\r\n\r\n\t\tte[ 2 ] = xz - wy;\r\n\t\tte[ 6 ] = yz + wx;\r\n\t\tte[ 10 ] = 1 - ( xx + yy );\r\n\r\n\t\t// last column\r\n\t\tte[ 3 ] = 0;\r\n\t\tte[ 7 ] = 0;\r\n\t\tte[ 11 ] = 0;\r\n\r\n\t\t// bottom row\r\n\t\tte[ 12 ] = 0;\r\n\t\tte[ 13 ] = 0;\r\n\t\tte[ 14 ] = 0;\r\n\t\tte[ 15 ] = 1;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tlookAt: function () {\r\n\r\n\t\tvar x, y, z;\r\n\r\n\t\treturn function ( eye, target, up ) {\r\n\r\n\t\t\tif ( x === undefined ) x = new THREE.Vector3();\r\n\t\t\tif ( y === undefined ) y = new THREE.Vector3();\r\n\t\t\tif ( z === undefined ) z = new THREE.Vector3();\r\n\r\n\t\t\tvar te = this.elements;\r\n\r\n\t\t\tz.subVectors( eye, target ).normalize();\r\n\r\n\t\t\tif ( z.lengthSq() === 0 ) {\r\n\r\n\t\t\t\tz.z = 1;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tx.crossVectors( up, z ).normalize();\r\n\r\n\t\t\tif ( x.lengthSq() === 0 ) {\r\n\r\n\t\t\t\tz.x += 0.0001;\r\n\t\t\t\tx.crossVectors( up, z ).normalize();\r\n\r\n\t\t\t}\r\n\r\n\t\t\ty.crossVectors( z, x );\r\n\r\n\r\n\t\t\tte[ 0 ] = x.x; te[ 4 ] = y.x; te[ 8 ] = z.x;\r\n\t\t\tte[ 1 ] = x.y; te[ 5 ] = y.y; te[ 9 ] = z.y;\r\n\t\t\tte[ 2 ] = x.z; te[ 6 ] = y.z; te[ 10 ] = z.z;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\tmultiply: function ( m, n ) {\r\n\r\n\t\tif ( n !== undefined ) {\r\n\r\n\t\t\tconsole.warn( 'THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead.' );\r\n\t\t\treturn this.multiplyMatrices( m, n );\r\n\r\n\t\t}\r\n\r\n\t\treturn this.multiplyMatrices( this, m );\r\n\r\n\t},\r\n\r\n\tpremultiply: function ( m ) {\r\n\r\n\t\treturn this.multiplyMatrices( m, this );\r\n\r\n\t},\r\n\r\n\tmultiplyMatrices: function ( a, b ) {\r\n\r\n\t\tvar ae = a.elements;\r\n\t\tvar be = b.elements;\r\n\t\tvar te = this.elements;\r\n\r\n\t\tvar a11 = ae[ 0 ], a12 = ae[ 4 ], a13 = ae[ 8 ], a14 = ae[ 12 ];\r\n\t\tvar a21 = ae[ 1 ], a22 = ae[ 5 ], a23 = ae[ 9 ], a24 = ae[ 13 ];\r\n\t\tvar a31 = ae[ 2 ], a32 = ae[ 6 ], a33 = ae[ 10 ], a34 = ae[ 14 ];\r\n\t\tvar a41 = ae[ 3 ], a42 = ae[ 7 ], a43 = ae[ 11 ], a44 = ae[ 15 ];\r\n\r\n\t\tvar b11 = be[ 0 ], b12 = be[ 4 ], b13 = be[ 8 ], b14 = be[ 12 ];\r\n\t\tvar b21 = be[ 1 ], b22 = be[ 5 ], b23 = be[ 9 ], b24 = be[ 13 ];\r\n\t\tvar b31 = be[ 2 ], b32 = be[ 6 ], b33 = be[ 10 ], b34 = be[ 14 ];\r\n\t\tvar b41 = be[ 3 ], b42 = be[ 7 ], b43 = be[ 11 ], b44 = be[ 15 ];\r\n\r\n\t\tte[ 0 ] = a11 * b11 + a12 * b21 + a13 * b31 + a14 * b41;\r\n\t\tte[ 4 ] = a11 * b12 + a12 * b22 + a13 * b32 + a14 * b42;\r\n\t\tte[ 8 ] = a11 * b13 + a12 * b23 + a13 * b33 + a14 * b43;\r\n\t\tte[ 12 ] = a11 * b14 + a12 * b24 + a13 * b34 + a14 * b44;\r\n\r\n\t\tte[ 1 ] = a21 * b11 + a22 * b21 + a23 * b31 + a24 * b41;\r\n\t\tte[ 5 ] = a21 * b12 + a22 * b22 + a23 * b32 + a24 * b42;\r\n\t\tte[ 9 ] = a21 * b13 + a22 * b23 + a23 * b33 + a24 * b43;\r\n\t\tte[ 13 ] = a21 * b14 + a22 * b24 + a23 * b34 + a24 * b44;\r\n\r\n\t\tte[ 2 ] = a31 * b11 + a32 * b21 + a33 * b31 + a34 * b41;\r\n\t\tte[ 6 ] = a31 * b12 + a32 * b22 + a33 * b32 + a34 * b42;\r\n\t\tte[ 10 ] = a31 * b13 + a32 * b23 + a33 * b33 + a34 * b43;\r\n\t\tte[ 14 ] = a31 * b14 + a32 * b24 + a33 * b34 + a34 * b44;\r\n\r\n\t\tte[ 3 ] = a41 * b11 + a42 * b21 + a43 * b31 + a44 * b41;\r\n\t\tte[ 7 ] = a41 * b12 + a42 * b22 + a43 * b32 + a44 * b42;\r\n\t\tte[ 11 ] = a41 * b13 + a42 * b23 + a43 * b33 + a44 * b43;\r\n\t\tte[ 15 ] = a41 * b14 + a42 * b24 + a43 * b34 + a44 * b44;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tmultiplyToArray: function ( a, b, r ) {\r\n\r\n\t\tvar te = this.elements;\r\n\r\n\t\tthis.multiplyMatrices( a, b );\r\n\r\n\t\tr[ 0 ] = te[ 0 ]; r[ 1 ] = te[ 1 ]; r[ 2 ] = te[ 2 ]; r[ 3 ] = te[ 3 ];\r\n\t\tr[ 4 ] = te[ 4 ]; r[ 5 ] = te[ 5 ]; r[ 6 ] = te[ 6 ]; r[ 7 ] = te[ 7 ];\r\n\t\tr[ 8 ]  = te[ 8 ]; r[ 9 ]  = te[ 9 ]; r[ 10 ] = te[ 10 ]; r[ 11 ] = te[ 11 ];\r\n\t\tr[ 12 ] = te[ 12 ]; r[ 13 ] = te[ 13 ]; r[ 14 ] = te[ 14 ]; r[ 15 ] = te[ 15 ];\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tmultiplyScalar: function ( s ) {\r\n\r\n\t\tvar te = this.elements;\r\n\r\n\t\tte[ 0 ] *= s; te[ 4 ] *= s; te[ 8 ] *= s; te[ 12 ] *= s;\r\n\t\tte[ 1 ] *= s; te[ 5 ] *= s; te[ 9 ] *= s; te[ 13 ] *= s;\r\n\t\tte[ 2 ] *= s; te[ 6 ] *= s; te[ 10 ] *= s; te[ 14 ] *= s;\r\n\t\tte[ 3 ] *= s; te[ 7 ] *= s; te[ 11 ] *= s; te[ 15 ] *= s;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tapplyToVector3Array: function () {\r\n\r\n\t\tvar v1;\r\n\r\n\t\treturn function ( array, offset, length ) {\r\n\r\n\t\t\tif ( v1 === undefined ) v1 = new THREE.Vector3();\r\n\t\t\tif ( offset === undefined ) offset = 0;\r\n\t\t\tif ( length === undefined ) length = array.length;\r\n\r\n\t\t\tfor ( var i = 0, j = offset; i < length; i += 3, j += 3 ) {\r\n\r\n\t\t\t\tv1.fromArray( array, j );\r\n\t\t\t\tv1.applyMatrix4( this );\r\n\t\t\t\tv1.toArray( array, j );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn array;\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\tapplyToBuffer: function () {\r\n\r\n\t\tvar v1;\r\n\r\n\t\treturn function applyToBuffer( buffer, offset, length ) {\r\n\r\n\t\t\tif ( v1 === undefined ) v1 = new THREE.Vector3();\r\n\t\t\tif ( offset === undefined ) offset = 0;\r\n\t\t\tif ( length === undefined ) length = buffer.length / buffer.itemSize;\r\n\r\n\t\t\tfor ( var i = 0, j = offset; i < length; i ++, j ++ ) {\r\n\r\n\t\t\t\tv1.x = buffer.getX( j );\r\n\t\t\t\tv1.y = buffer.getY( j );\r\n\t\t\t\tv1.z = buffer.getZ( j );\r\n\r\n\t\t\t\tv1.applyMatrix4( this );\r\n\r\n\t\t\t\tbuffer.setXYZ( v1.x, v1.y, v1.z );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn buffer;\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\tdeterminant: function () {\r\n\r\n\t\tvar te = this.elements;\r\n\r\n\t\tvar n11 = te[ 0 ], n12 = te[ 4 ], n13 = te[ 8 ], n14 = te[ 12 ];\r\n\t\tvar n21 = te[ 1 ], n22 = te[ 5 ], n23 = te[ 9 ], n24 = te[ 13 ];\r\n\t\tvar n31 = te[ 2 ], n32 = te[ 6 ], n33 = te[ 10 ], n34 = te[ 14 ];\r\n\t\tvar n41 = te[ 3 ], n42 = te[ 7 ], n43 = te[ 11 ], n44 = te[ 15 ];\r\n\r\n\t\t//TODO: make this more efficient\r\n\t\t//( based on http://www.euclideanspace.com/maths/algebra/matrix/functions/inverse/fourD/index.htm )\r\n\r\n\t\treturn (\r\n\t\t\tn41 * (\r\n\t\t\t\t+ n14 * n23 * n32\r\n\t\t\t\t - n13 * n24 * n32\r\n\t\t\t\t - n14 * n22 * n33\r\n\t\t\t\t + n12 * n24 * n33\r\n\t\t\t\t + n13 * n22 * n34\r\n\t\t\t\t - n12 * n23 * n34\r\n\t\t\t) +\r\n\t\t\tn42 * (\r\n\t\t\t\t+ n11 * n23 * n34\r\n\t\t\t\t - n11 * n24 * n33\r\n\t\t\t\t + n14 * n21 * n33\r\n\t\t\t\t - n13 * n21 * n34\r\n\t\t\t\t + n13 * n24 * n31\r\n\t\t\t\t - n14 * n23 * n31\r\n\t\t\t) +\r\n\t\t\tn43 * (\r\n\t\t\t\t+ n11 * n24 * n32\r\n\t\t\t\t - n11 * n22 * n34\r\n\t\t\t\t - n14 * n21 * n32\r\n\t\t\t\t + n12 * n21 * n34\r\n\t\t\t\t + n14 * n22 * n31\r\n\t\t\t\t - n12 * n24 * n31\r\n\t\t\t) +\r\n\t\t\tn44 * (\r\n\t\t\t\t- n13 * n22 * n31\r\n\t\t\t\t - n11 * n23 * n32\r\n\t\t\t\t + n11 * n22 * n33\r\n\t\t\t\t + n13 * n21 * n32\r\n\t\t\t\t - n12 * n21 * n33\r\n\t\t\t\t + n12 * n23 * n31\r\n\t\t\t)\r\n\r\n\t\t);\r\n\r\n\t},\r\n\r\n\ttranspose: function () {\r\n\r\n\t\tvar te = this.elements;\r\n\t\tvar tmp;\r\n\r\n\t\ttmp = te[ 1 ]; te[ 1 ] = te[ 4 ]; te[ 4 ] = tmp;\r\n\t\ttmp = te[ 2 ]; te[ 2 ] = te[ 8 ]; te[ 8 ] = tmp;\r\n\t\ttmp = te[ 6 ]; te[ 6 ] = te[ 9 ]; te[ 9 ] = tmp;\r\n\r\n\t\ttmp = te[ 3 ]; te[ 3 ] = te[ 12 ]; te[ 12 ] = tmp;\r\n\t\ttmp = te[ 7 ]; te[ 7 ] = te[ 13 ]; te[ 13 ] = tmp;\r\n\t\ttmp = te[ 11 ]; te[ 11 ] = te[ 14 ]; te[ 14 ] = tmp;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tflattenToArrayOffset: function ( array, offset ) {\r\n\r\n\t\tconsole.warn( \"THREE.Matrix3: .flattenToArrayOffset is deprecated \" +\r\n\t\t\t\t\"- just use .toArray instead.\" );\r\n\r\n\t\treturn this.toArray( array, offset );\r\n\r\n\t},\r\n\r\n\tgetPosition: function () {\r\n\r\n\t\tvar v1;\r\n\r\n\t\treturn function () {\r\n\r\n\t\t\tif ( v1 === undefined ) v1 = new THREE.Vector3();\r\n\t\t\tconsole.warn( 'THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead.' );\r\n\r\n\t\t\treturn v1.setFromMatrixColumn( this, 3 );\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\tsetPosition: function ( v ) {\r\n\r\n\t\tvar te = this.elements;\r\n\r\n\t\tte[ 12 ] = v.x;\r\n\t\tte[ 13 ] = v.y;\r\n\t\tte[ 14 ] = v.z;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tgetInverse: function ( m, throwOnDegenerate ) {\r\n\r\n\t\t// based on http://www.euclideanspace.com/maths/algebra/matrix/functions/inverse/fourD/index.htm\r\n\t\tvar te = this.elements,\r\n\t\t\tme = m.elements,\r\n\r\n\t\t\tn11 = me[ 0 ], n21 = me[ 1 ], n31 = me[ 2 ], n41 = me[ 3 ],\r\n\t\t\tn12 = me[ 4 ], n22 = me[ 5 ], n32 = me[ 6 ], n42 = me[ 7 ],\r\n\t\t\tn13 = me[ 8 ], n23 = me[ 9 ], n33 = me[ 10 ], n43 = me[ 11 ],\r\n\t\t\tn14 = me[ 12 ], n24 = me[ 13 ], n34 = me[ 14 ], n44 = me[ 15 ],\r\n\r\n\t\t\tt11 = n23 * n34 * n42 - n24 * n33 * n42 + n24 * n32 * n43 - n22 * n34 * n43 - n23 * n32 * n44 + n22 * n33 * n44,\r\n\t\t\tt12 = n14 * n33 * n42 - n13 * n34 * n42 - n14 * n32 * n43 + n12 * n34 * n43 + n13 * n32 * n44 - n12 * n33 * n44,\r\n\t\t\tt13 = n13 * n24 * n42 - n14 * n23 * n42 + n14 * n22 * n43 - n12 * n24 * n43 - n13 * n22 * n44 + n12 * n23 * n44,\r\n\t\t\tt14 = n14 * n23 * n32 - n13 * n24 * n32 - n14 * n22 * n33 + n12 * n24 * n33 + n13 * n22 * n34 - n12 * n23 * n34;\r\n\r\n\t\tvar det = n11 * t11 + n21 * t12 + n31 * t13 + n41 * t14;\r\n\r\n\t\tif ( det === 0 ) {\r\n\r\n\t\t\tvar msg = \"THREE.Matrix4.getInverse(): can't invert matrix, determinant is 0\";\r\n\r\n\t\t\tif ( throwOnDegenerate || false ) {\r\n\r\n\t\t\t\tthrow new Error( msg );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tconsole.warn( msg );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn this.identity();\r\n\r\n\t\t}\r\n\r\n\t\tte[ 0 ] = t11;\r\n\t\tte[ 1 ] = n24 * n33 * n41 - n23 * n34 * n41 - n24 * n31 * n43 + n21 * n34 * n43 + n23 * n31 * n44 - n21 * n33 * n44;\r\n\t\tte[ 2 ] = n22 * n34 * n41 - n24 * n32 * n41 + n24 * n31 * n42 - n21 * n34 * n42 - n22 * n31 * n44 + n21 * n32 * n44;\r\n\t\tte[ 3 ] = n23 * n32 * n41 - n22 * n33 * n41 - n23 * n31 * n42 + n21 * n33 * n42 + n22 * n31 * n43 - n21 * n32 * n43;\r\n\r\n\t\tte[ 4 ] = t12;\r\n\t\tte[ 5 ] = n13 * n34 * n41 - n14 * n33 * n41 + n14 * n31 * n43 - n11 * n34 * n43 - n13 * n31 * n44 + n11 * n33 * n44;\r\n\t\tte[ 6 ] = n14 * n32 * n41 - n12 * n34 * n41 - n14 * n31 * n42 + n11 * n34 * n42 + n12 * n31 * n44 - n11 * n32 * n44;\r\n\t\tte[ 7 ] = n12 * n33 * n41 - n13 * n32 * n41 + n13 * n31 * n42 - n11 * n33 * n42 - n12 * n31 * n43 + n11 * n32 * n43;\r\n\r\n\t\tte[ 8 ] = t13;\r\n\t\tte[ 9 ] = n14 * n23 * n41 - n13 * n24 * n41 - n14 * n21 * n43 + n11 * n24 * n43 + n13 * n21 * n44 - n11 * n23 * n44;\r\n\t\tte[ 10 ] = n12 * n24 * n41 - n14 * n22 * n41 + n14 * n21 * n42 - n11 * n24 * n42 - n12 * n21 * n44 + n11 * n22 * n44;\r\n\t\tte[ 11 ] = n13 * n22 * n41 - n12 * n23 * n41 - n13 * n21 * n42 + n11 * n23 * n42 + n12 * n21 * n43 - n11 * n22 * n43;\r\n\r\n\t\tte[ 12 ] = t14;\r\n\t\tte[ 13 ] = n13 * n24 * n31 - n14 * n23 * n31 + n14 * n21 * n33 - n11 * n24 * n33 - n13 * n21 * n34 + n11 * n23 * n34;\r\n\t\tte[ 14 ] = n14 * n22 * n31 - n12 * n24 * n31 - n14 * n21 * n32 + n11 * n24 * n32 + n12 * n21 * n34 - n11 * n22 * n34;\r\n\t\tte[ 15 ] = n12 * n23 * n31 - n13 * n22 * n31 + n13 * n21 * n32 - n11 * n23 * n32 - n12 * n21 * n33 + n11 * n22 * n33;\r\n\r\n\t\treturn this.multiplyScalar( 1 / det );\r\n\r\n\t},\r\n\r\n\tscale: function ( v ) {\r\n\r\n\t\tvar te = this.elements;\r\n\t\tvar x = v.x, y = v.y, z = v.z;\r\n\r\n\t\tte[ 0 ] *= x; te[ 4 ] *= y; te[ 8 ] *= z;\r\n\t\tte[ 1 ] *= x; te[ 5 ] *= y; te[ 9 ] *= z;\r\n\t\tte[ 2 ] *= x; te[ 6 ] *= y; te[ 10 ] *= z;\r\n\t\tte[ 3 ] *= x; te[ 7 ] *= y; te[ 11 ] *= z;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tgetMaxScaleOnAxis: function () {\r\n\r\n\t\tvar te = this.elements;\r\n\r\n\t\tvar scaleXSq = te[ 0 ] * te[ 0 ] + te[ 1 ] * te[ 1 ] + te[ 2 ] * te[ 2 ];\r\n\t\tvar scaleYSq = te[ 4 ] * te[ 4 ] + te[ 5 ] * te[ 5 ] + te[ 6 ] * te[ 6 ];\r\n\t\tvar scaleZSq = te[ 8 ] * te[ 8 ] + te[ 9 ] * te[ 9 ] + te[ 10 ] * te[ 10 ];\r\n\r\n\t\treturn Math.sqrt( Math.max( scaleXSq, scaleYSq, scaleZSq ) );\r\n\r\n\t},\r\n\r\n\tmakeTranslation: function ( x, y, z ) {\r\n\r\n\t\tthis.set(\r\n\r\n\t\t\t1, 0, 0, x,\r\n\t\t\t0, 1, 0, y,\r\n\t\t\t0, 0, 1, z,\r\n\t\t\t0, 0, 0, 1\r\n\r\n\t\t);\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tmakeRotationX: function ( theta ) {\r\n\r\n\t\tvar c = Math.cos( theta ), s = Math.sin( theta );\r\n\r\n\t\tthis.set(\r\n\r\n\t\t\t1, 0,  0, 0,\r\n\t\t\t0, c, - s, 0,\r\n\t\t\t0, s,  c, 0,\r\n\t\t\t0, 0,  0, 1\r\n\r\n\t\t);\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tmakeRotationY: function ( theta ) {\r\n\r\n\t\tvar c = Math.cos( theta ), s = Math.sin( theta );\r\n\r\n\t\tthis.set(\r\n\r\n\t\t\t c, 0, s, 0,\r\n\t\t\t 0, 1, 0, 0,\r\n\t\t\t- s, 0, c, 0,\r\n\t\t\t 0, 0, 0, 1\r\n\r\n\t\t);\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tmakeRotationZ: function ( theta ) {\r\n\r\n\t\tvar c = Math.cos( theta ), s = Math.sin( theta );\r\n\r\n\t\tthis.set(\r\n\r\n\t\t\tc, - s, 0, 0,\r\n\t\t\ts,  c, 0, 0,\r\n\t\t\t0,  0, 1, 0,\r\n\t\t\t0,  0, 0, 1\r\n\r\n\t\t);\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tmakeRotationAxis: function ( axis, angle ) {\r\n\r\n\t\t// Based on http://www.gamedev.net/reference/articles/article1199.asp\r\n\r\n\t\tvar c = Math.cos( angle );\r\n\t\tvar s = Math.sin( angle );\r\n\t\tvar t = 1 - c;\r\n\t\tvar x = axis.x, y = axis.y, z = axis.z;\r\n\t\tvar tx = t * x, ty = t * y;\r\n\r\n\t\tthis.set(\r\n\r\n\t\t\ttx * x + c, tx * y - s * z, tx * z + s * y, 0,\r\n\t\t\ttx * y + s * z, ty * y + c, ty * z - s * x, 0,\r\n\t\t\ttx * z - s * y, ty * z + s * x, t * z * z + c, 0,\r\n\t\t\t0, 0, 0, 1\r\n\r\n\t\t);\r\n\r\n\t\t return this;\r\n\r\n\t},\r\n\r\n\tmakeScale: function ( x, y, z ) {\r\n\r\n\t\tthis.set(\r\n\r\n\t\t\tx, 0, 0, 0,\r\n\t\t\t0, y, 0, 0,\r\n\t\t\t0, 0, z, 0,\r\n\t\t\t0, 0, 0, 1\r\n\r\n\t\t);\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tcompose: function ( position, quaternion, scale ) {\r\n\r\n\t\tthis.makeRotationFromQuaternion( quaternion );\r\n\t\tthis.scale( scale );\r\n\t\tthis.setPosition( position );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tdecompose: function () {\r\n\r\n\t\tvar vector, matrix;\r\n\r\n\t\treturn function ( position, quaternion, scale ) {\r\n\r\n\t\t\tif ( vector === undefined ) vector = new THREE.Vector3();\r\n\t\t\tif ( matrix === undefined ) matrix = new THREE.Matrix4();\r\n\r\n\t\t\tvar te = this.elements;\r\n\r\n\t\t\tvar sx = vector.set( te[ 0 ], te[ 1 ], te[ 2 ] ).length();\r\n\t\t\tvar sy = vector.set( te[ 4 ], te[ 5 ], te[ 6 ] ).length();\r\n\t\t\tvar sz = vector.set( te[ 8 ], te[ 9 ], te[ 10 ] ).length();\r\n\r\n\t\t\t// if determine is negative, we need to invert one scale\r\n\t\t\tvar det = this.determinant();\r\n\t\t\tif ( det < 0 ) {\r\n\r\n\t\t\t\tsx = - sx;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tposition.x = te[ 12 ];\r\n\t\t\tposition.y = te[ 13 ];\r\n\t\t\tposition.z = te[ 14 ];\r\n\r\n\t\t\t// scale the rotation part\r\n\r\n\t\t\tmatrix.elements.set( this.elements ); // at this point matrix is incomplete so we can't use .copy()\r\n\r\n\t\t\tvar invSX = 1 / sx;\r\n\t\t\tvar invSY = 1 / sy;\r\n\t\t\tvar invSZ = 1 / sz;\r\n\r\n\t\t\tmatrix.elements[ 0 ] *= invSX;\r\n\t\t\tmatrix.elements[ 1 ] *= invSX;\r\n\t\t\tmatrix.elements[ 2 ] *= invSX;\r\n\r\n\t\t\tmatrix.elements[ 4 ] *= invSY;\r\n\t\t\tmatrix.elements[ 5 ] *= invSY;\r\n\t\t\tmatrix.elements[ 6 ] *= invSY;\r\n\r\n\t\t\tmatrix.elements[ 8 ] *= invSZ;\r\n\t\t\tmatrix.elements[ 9 ] *= invSZ;\r\n\t\t\tmatrix.elements[ 10 ] *= invSZ;\r\n\r\n\t\t\tquaternion.setFromRotationMatrix( matrix );\r\n\r\n\t\t\tscale.x = sx;\r\n\t\t\tscale.y = sy;\r\n\t\t\tscale.z = sz;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\tmakeFrustum: function ( left, right, bottom, top, near, far ) {\r\n\r\n\t\tvar te = this.elements;\r\n\t\tvar x = 2 * near / ( right - left );\r\n\t\tvar y = 2 * near / ( top - bottom );\r\n\r\n\t\tvar a = ( right + left ) / ( right - left );\r\n\t\tvar b = ( top + bottom ) / ( top - bottom );\r\n\t\tvar c = - ( far + near ) / ( far - near );\r\n\t\tvar d = - 2 * far * near / ( far - near );\r\n\r\n\t\tte[ 0 ] = x;\tte[ 4 ] = 0;\tte[ 8 ] = a;\tte[ 12 ] = 0;\r\n\t\tte[ 1 ] = 0;\tte[ 5 ] = y;\tte[ 9 ] = b;\tte[ 13 ] = 0;\r\n\t\tte[ 2 ] = 0;\tte[ 6 ] = 0;\tte[ 10 ] = c;\tte[ 14 ] = d;\r\n\t\tte[ 3 ] = 0;\tte[ 7 ] = 0;\tte[ 11 ] = - 1;\tte[ 15 ] = 0;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tmakePerspective: function ( fov, aspect, near, far ) {\r\n\r\n\t\tvar ymax = near * Math.tan( THREE.Math.DEG2RAD * fov * 0.5 );\r\n\t\tvar ymin = - ymax;\r\n\t\tvar xmin = ymin * aspect;\r\n\t\tvar xmax = ymax * aspect;\r\n\r\n\t\treturn this.makeFrustum( xmin, xmax, ymin, ymax, near, far );\r\n\r\n\t},\r\n\r\n\tmakeOrthographic: function ( left, right, top, bottom, near, far ) {\r\n\r\n\t\tvar te = this.elements;\r\n\t\tvar w = 1.0 / ( right - left );\r\n\t\tvar h = 1.0 / ( top - bottom );\r\n\t\tvar p = 1.0 / ( far - near );\r\n\r\n\t\tvar x = ( right + left ) * w;\r\n\t\tvar y = ( top + bottom ) * h;\r\n\t\tvar z = ( far + near ) * p;\r\n\r\n\t\tte[ 0 ] = 2 * w;\tte[ 4 ] = 0;\tte[ 8 ] = 0;\tte[ 12 ] = - x;\r\n\t\tte[ 1 ] = 0;\tte[ 5 ] = 2 * h;\tte[ 9 ] = 0;\tte[ 13 ] = - y;\r\n\t\tte[ 2 ] = 0;\tte[ 6 ] = 0;\tte[ 10 ] = - 2 * p;\tte[ 14 ] = - z;\r\n\t\tte[ 3 ] = 0;\tte[ 7 ] = 0;\tte[ 11 ] = 0;\tte[ 15 ] = 1;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tequals: function ( matrix ) {\r\n\r\n\t\tvar te = this.elements;\r\n\t\tvar me = matrix.elements;\r\n\r\n\t\tfor ( var i = 0; i < 16; i ++ ) {\r\n\r\n\t\t\tif ( te[ i ] !== me[ i ] ) return false;\r\n\r\n\t\t}\r\n\r\n\t\treturn true;\r\n\r\n\t},\r\n\r\n\tfromArray: function ( array ) {\r\n\r\n\t\tthis.elements.set( array );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\ttoArray: function ( array, offset ) {\r\n\r\n\t\tif ( array === undefined ) array = [];\r\n\t\tif ( offset === undefined ) offset = 0;\r\n\r\n\t\tvar te = this.elements;\r\n\r\n\t\tarray[ offset ] = te[ 0 ];\r\n\t\tarray[ offset + 1 ] = te[ 1 ];\r\n\t\tarray[ offset + 2 ] = te[ 2 ];\r\n\t\tarray[ offset + 3 ] = te[ 3 ];\r\n\r\n\t\tarray[ offset + 4 ] = te[ 4 ];\r\n\t\tarray[ offset + 5 ] = te[ 5 ];\r\n\t\tarray[ offset + 6 ] = te[ 6 ];\r\n\t\tarray[ offset + 7 ] = te[ 7 ];\r\n\r\n\t\tarray[ offset + 8 ]  = te[ 8 ];\r\n\t\tarray[ offset + 9 ]  = te[ 9 ];\r\n\t\tarray[ offset + 10 ] = te[ 10 ];\r\n\t\tarray[ offset + 11 ] = te[ 11 ];\r\n\r\n\t\tarray[ offset + 12 ] = te[ 12 ];\r\n\t\tarray[ offset + 13 ] = te[ 13 ];\r\n\t\tarray[ offset + 14 ] = te[ 14 ];\r\n\t\tarray[ offset + 15 ] = te[ 15 ];\r\n\r\n\t\treturn array;\r\n\r\n\t}\r\n\r\n};\r\n\r\n// File:src/math/Ray.js\r\n\r\n/**\r\n * @author bhouston / http://clara.io\r\n */\r\n\r\nTHREE.Ray = function ( origin, direction ) {\r\n\r\n\tthis.origin = ( origin !== undefined ) ? origin : new THREE.Vector3();\r\n\tthis.direction = ( direction !== undefined ) ? direction : new THREE.Vector3();\r\n\r\n};\r\n\r\nTHREE.Ray.prototype = {\r\n\r\n\tconstructor: THREE.Ray,\r\n\r\n\tset: function ( origin, direction ) {\r\n\r\n\t\tthis.origin.copy( origin );\r\n\t\tthis.direction.copy( direction );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tclone: function () {\r\n\r\n\t\treturn new this.constructor().copy( this );\r\n\r\n\t},\r\n\r\n\tcopy: function ( ray ) {\r\n\r\n\t\tthis.origin.copy( ray.origin );\r\n\t\tthis.direction.copy( ray.direction );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tat: function ( t, optionalTarget ) {\r\n\r\n\t\tvar result = optionalTarget || new THREE.Vector3();\r\n\r\n\t\treturn result.copy( this.direction ).multiplyScalar( t ).add( this.origin );\r\n\r\n\t},\r\n\r\n\tlookAt: function ( v ) {\r\n\r\n\t\tthis.direction.copy( v ).sub( this.origin ).normalize();\r\n\r\n\t},\r\n\r\n\trecast: function () {\r\n\r\n\t\tvar v1 = new THREE.Vector3();\r\n\r\n\t\treturn function ( t ) {\r\n\r\n\t\t\tthis.origin.copy( this.at( t, v1 ) );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\tclosestPointToPoint: function ( point, optionalTarget ) {\r\n\r\n\t\tvar result = optionalTarget || new THREE.Vector3();\r\n\t\tresult.subVectors( point, this.origin );\r\n\t\tvar directionDistance = result.dot( this.direction );\r\n\r\n\t\tif ( directionDistance < 0 ) {\r\n\r\n\t\t\treturn result.copy( this.origin );\r\n\r\n\t\t}\r\n\r\n\t\treturn result.copy( this.direction ).multiplyScalar( directionDistance ).add( this.origin );\r\n\r\n\t},\r\n\r\n\tdistanceToPoint: function ( point ) {\r\n\r\n\t\treturn Math.sqrt( this.distanceSqToPoint( point ) );\r\n\r\n\t},\r\n\r\n\tdistanceSqToPoint: function () {\r\n\r\n\t\tvar v1 = new THREE.Vector3();\r\n\r\n\t\treturn function ( point ) {\r\n\r\n\t\t\tvar directionDistance = v1.subVectors( point, this.origin ).dot( this.direction );\r\n\r\n\t\t\t// point behind the ray\r\n\r\n\t\t\tif ( directionDistance < 0 ) {\r\n\r\n\t\t\t\treturn this.origin.distanceToSquared( point );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tv1.copy( this.direction ).multiplyScalar( directionDistance ).add( this.origin );\r\n\r\n\t\t\treturn v1.distanceToSquared( point );\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\tdistanceSqToSegment: function () {\r\n\r\n\t\tvar segCenter = new THREE.Vector3();\r\n\t\tvar segDir = new THREE.Vector3();\r\n\t\tvar diff = new THREE.Vector3();\r\n\r\n\t\treturn function ( v0, v1, optionalPointOnRay, optionalPointOnSegment ) {\r\n\r\n\t\t\t// from http://www.geometrictools.com/LibMathematics/Distance/Wm5DistRay3Segment3.cpp\r\n\t\t\t// It returns the min distance between the ray and the segment\r\n\t\t\t// defined by v0 and v1\r\n\t\t\t// It can also set two optional targets :\r\n\t\t\t// - The closest point on the ray\r\n\t\t\t// - The closest point on the segment\r\n\r\n\t\t\tsegCenter.copy( v0 ).add( v1 ).multiplyScalar( 0.5 );\r\n\t\t\tsegDir.copy( v1 ).sub( v0 ).normalize();\r\n\t\t\tdiff.copy( this.origin ).sub( segCenter );\r\n\r\n\t\t\tvar segExtent = v0.distanceTo( v1 ) * 0.5;\r\n\t\t\tvar a01 = - this.direction.dot( segDir );\r\n\t\t\tvar b0 = diff.dot( this.direction );\r\n\t\t\tvar b1 = - diff.dot( segDir );\r\n\t\t\tvar c = diff.lengthSq();\r\n\t\t\tvar det = Math.abs( 1 - a01 * a01 );\r\n\t\t\tvar s0, s1, sqrDist, extDet;\r\n\r\n\t\t\tif ( det > 0 ) {\r\n\r\n\t\t\t\t// The ray and segment are not parallel.\r\n\r\n\t\t\t\ts0 = a01 * b1 - b0;\r\n\t\t\t\ts1 = a01 * b0 - b1;\r\n\t\t\t\textDet = segExtent * det;\r\n\r\n\t\t\t\tif ( s0 >= 0 ) {\r\n\r\n\t\t\t\t\tif ( s1 >= - extDet ) {\r\n\r\n\t\t\t\t\t\tif ( s1 <= extDet ) {\r\n\r\n\t\t\t\t\t\t\t// region 0\r\n\t\t\t\t\t\t\t// Minimum at interior points of ray and segment.\r\n\r\n\t\t\t\t\t\t\tvar invDet = 1 / det;\r\n\t\t\t\t\t\t\ts0 *= invDet;\r\n\t\t\t\t\t\t\ts1 *= invDet;\r\n\t\t\t\t\t\t\tsqrDist = s0 * ( s0 + a01 * s1 + 2 * b0 ) + s1 * ( a01 * s0 + s1 + 2 * b1 ) + c;\r\n\r\n\t\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\t\t// region 1\r\n\r\n\t\t\t\t\t\t\ts1 = segExtent;\r\n\t\t\t\t\t\t\ts0 = Math.max( 0, - ( a01 * s1 + b0 ) );\r\n\t\t\t\t\t\t\tsqrDist = - s0 * s0 + s1 * ( s1 + 2 * b1 ) + c;\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\t// region 5\r\n\r\n\t\t\t\t\t\ts1 = - segExtent;\r\n\t\t\t\t\t\ts0 = Math.max( 0, - ( a01 * s1 + b0 ) );\r\n\t\t\t\t\t\tsqrDist = - s0 * s0 + s1 * ( s1 + 2 * b1 ) + c;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tif ( s1 <= - extDet ) {\r\n\r\n\t\t\t\t\t\t// region 4\r\n\r\n\t\t\t\t\t\ts0 = Math.max( 0, - ( - a01 * segExtent + b0 ) );\r\n\t\t\t\t\t\ts1 = ( s0 > 0 ) ? - segExtent : Math.min( Math.max( - segExtent, - b1 ), segExtent );\r\n\t\t\t\t\t\tsqrDist = - s0 * s0 + s1 * ( s1 + 2 * b1 ) + c;\r\n\r\n\t\t\t\t\t} else if ( s1 <= extDet ) {\r\n\r\n\t\t\t\t\t\t// region 3\r\n\r\n\t\t\t\t\t\ts0 = 0;\r\n\t\t\t\t\t\ts1 = Math.min( Math.max( - segExtent, - b1 ), segExtent );\r\n\t\t\t\t\t\tsqrDist = s1 * ( s1 + 2 * b1 ) + c;\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\t// region 2\r\n\r\n\t\t\t\t\t\ts0 = Math.max( 0, - ( a01 * segExtent + b0 ) );\r\n\t\t\t\t\t\ts1 = ( s0 > 0 ) ? segExtent : Math.min( Math.max( - segExtent, - b1 ), segExtent );\r\n\t\t\t\t\t\tsqrDist = - s0 * s0 + s1 * ( s1 + 2 * b1 ) + c;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\t// Ray and segment are parallel.\r\n\r\n\t\t\t\ts1 = ( a01 > 0 ) ? - segExtent : segExtent;\r\n\t\t\t\ts0 = Math.max( 0, - ( a01 * s1 + b0 ) );\r\n\t\t\t\tsqrDist = - s0 * s0 + s1 * ( s1 + 2 * b1 ) + c;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( optionalPointOnRay ) {\r\n\r\n\t\t\t\toptionalPointOnRay.copy( this.direction ).multiplyScalar( s0 ).add( this.origin );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( optionalPointOnSegment ) {\r\n\r\n\t\t\t\toptionalPointOnSegment.copy( segDir ).multiplyScalar( s1 ).add( segCenter );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn sqrDist;\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\tintersectSphere: function () {\r\n\r\n\t\tvar v1 = new THREE.Vector3();\r\n\r\n\t\treturn function ( sphere, optionalTarget ) {\r\n\r\n\t\t\tv1.subVectors( sphere.center, this.origin );\r\n\t\t\tvar tca = v1.dot( this.direction );\r\n\t\t\tvar d2 = v1.dot( v1 ) - tca * tca;\r\n\t\t\tvar radius2 = sphere.radius * sphere.radius;\r\n\r\n\t\t\tif ( d2 > radius2 ) return null;\r\n\r\n\t\t\tvar thc = Math.sqrt( radius2 - d2 );\r\n\r\n\t\t\t// t0 = first intersect point - entrance on front of sphere\r\n\t\t\tvar t0 = tca - thc;\r\n\r\n\t\t\t// t1 = second intersect point - exit point on back of sphere\r\n\t\t\tvar t1 = tca + thc;\r\n\r\n\t\t\t// test to see if both t0 and t1 are behind the ray - if so, return null\r\n\t\t\tif ( t0 < 0 && t1 < 0 ) return null;\r\n\r\n\t\t\t// test to see if t0 is behind the ray:\r\n\t\t\t// if it is, the ray is inside the sphere, so return the second exit point scaled by t1,\r\n\t\t\t// in order to always return an intersect point that is in front of the ray.\r\n\t\t\tif ( t0 < 0 ) return this.at( t1, optionalTarget );\r\n\r\n\t\t\t// else t0 is in front of the ray, so return the first collision point scaled by t0\r\n\t\t\treturn this.at( t0, optionalTarget );\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\tintersectsSphere: function ( sphere ) {\r\n\r\n\t\treturn this.distanceToPoint( sphere.center ) <= sphere.radius;\r\n\r\n\t},\r\n\r\n\tdistanceToPlane: function ( plane ) {\r\n\r\n\t\tvar denominator = plane.normal.dot( this.direction );\r\n\r\n\t\tif ( denominator === 0 ) {\r\n\r\n\t\t\t// line is coplanar, return origin\r\n\t\t\tif ( plane.distanceToPoint( this.origin ) === 0 ) {\r\n\r\n\t\t\t\treturn 0;\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// Null is preferable to undefined since undefined means.... it is undefined\r\n\r\n\t\t\treturn null;\r\n\r\n\t\t}\r\n\r\n\t\tvar t = - ( this.origin.dot( plane.normal ) + plane.constant ) / denominator;\r\n\r\n\t\t// Return if the ray never intersects the plane\r\n\r\n\t\treturn t >= 0 ? t :  null;\r\n\r\n\t},\r\n\r\n\tintersectPlane: function ( plane, optionalTarget ) {\r\n\r\n\t\tvar t = this.distanceToPlane( plane );\r\n\r\n\t\tif ( t === null ) {\r\n\r\n\t\t\treturn null;\r\n\r\n\t\t}\r\n\r\n\t\treturn this.at( t, optionalTarget );\r\n\r\n\t},\r\n\r\n\r\n\r\n\tintersectsPlane: function ( plane ) {\r\n\r\n\t\t// check if the ray lies on the plane first\r\n\r\n\t\tvar distToPoint = plane.distanceToPoint( this.origin );\r\n\r\n\t\tif ( distToPoint === 0 ) {\r\n\r\n\t\t\treturn true;\r\n\r\n\t\t}\r\n\r\n\t\tvar denominator = plane.normal.dot( this.direction );\r\n\r\n\t\tif ( denominator * distToPoint < 0 ) {\r\n\r\n\t\t\treturn true;\r\n\r\n\t\t}\r\n\r\n\t\t// ray origin is behind the plane (and is pointing behind it)\r\n\r\n\t\treturn false;\r\n\r\n\t},\r\n\r\n\tintersectBox: function ( box, optionalTarget ) {\r\n\r\n\t\tvar tmin, tmax, tymin, tymax, tzmin, tzmax;\r\n\r\n\t\tvar invdirx = 1 / this.direction.x,\r\n\t\t\tinvdiry = 1 / this.direction.y,\r\n\t\t\tinvdirz = 1 / this.direction.z;\r\n\r\n\t\tvar origin = this.origin;\r\n\r\n\t\tif ( invdirx >= 0 ) {\r\n\r\n\t\t\ttmin = ( box.min.x - origin.x ) * invdirx;\r\n\t\t\ttmax = ( box.max.x - origin.x ) * invdirx;\r\n\r\n\t\t} else {\r\n\r\n\t\t\ttmin = ( box.max.x - origin.x ) * invdirx;\r\n\t\t\ttmax = ( box.min.x - origin.x ) * invdirx;\r\n\r\n\t\t}\r\n\r\n\t\tif ( invdiry >= 0 ) {\r\n\r\n\t\t\ttymin = ( box.min.y - origin.y ) * invdiry;\r\n\t\t\ttymax = ( box.max.y - origin.y ) * invdiry;\r\n\r\n\t\t} else {\r\n\r\n\t\t\ttymin = ( box.max.y - origin.y ) * invdiry;\r\n\t\t\ttymax = ( box.min.y - origin.y ) * invdiry;\r\n\r\n\t\t}\r\n\r\n\t\tif ( ( tmin > tymax ) || ( tymin > tmax ) ) return null;\r\n\r\n\t\t// These lines also handle the case where tmin or tmax is NaN\r\n\t\t// (result of 0 * Infinity). x !== x returns true if x is NaN\r\n\r\n\t\tif ( tymin > tmin || tmin !== tmin ) tmin = tymin;\r\n\r\n\t\tif ( tymax < tmax || tmax !== tmax ) tmax = tymax;\r\n\r\n\t\tif ( invdirz >= 0 ) {\r\n\r\n\t\t\ttzmin = ( box.min.z - origin.z ) * invdirz;\r\n\t\t\ttzmax = ( box.max.z - origin.z ) * invdirz;\r\n\r\n\t\t} else {\r\n\r\n\t\t\ttzmin = ( box.max.z - origin.z ) * invdirz;\r\n\t\t\ttzmax = ( box.min.z - origin.z ) * invdirz;\r\n\r\n\t\t}\r\n\r\n\t\tif ( ( tmin > tzmax ) || ( tzmin > tmax ) ) return null;\r\n\r\n\t\tif ( tzmin > tmin || tmin !== tmin ) tmin = tzmin;\r\n\r\n\t\tif ( tzmax < tmax || tmax !== tmax ) tmax = tzmax;\r\n\r\n\t\t//return point closest to the ray (positive side)\r\n\r\n\t\tif ( tmax < 0 ) return null;\r\n\r\n\t\treturn this.at( tmin >= 0 ? tmin : tmax, optionalTarget );\r\n\r\n\t},\r\n\r\n\tintersectsBox: ( function () {\r\n\r\n\t\tvar v = new THREE.Vector3();\r\n\r\n\t\treturn function ( box ) {\r\n\r\n\t\t\treturn this.intersectBox( box, v ) !== null;\r\n\r\n\t\t};\r\n\r\n\t} )(),\r\n\r\n\tintersectTriangle: function () {\r\n\r\n\t\t// Compute the offset origin, edges, and normal.\r\n\t\tvar diff = new THREE.Vector3();\r\n\t\tvar edge1 = new THREE.Vector3();\r\n\t\tvar edge2 = new THREE.Vector3();\r\n\t\tvar normal = new THREE.Vector3();\r\n\r\n\t\treturn function ( a, b, c, backfaceCulling, optionalTarget ) {\r\n\r\n\t\t\t// from http://www.geometrictools.com/LibMathematics/Intersection/Wm5IntrRay3Triangle3.cpp\r\n\r\n\t\t\tedge1.subVectors( b, a );\r\n\t\t\tedge2.subVectors( c, a );\r\n\t\t\tnormal.crossVectors( edge1, edge2 );\r\n\r\n\t\t\t// Solve Q + t*D = b1*E1 + b2*E2 (Q = kDiff, D = ray direction,\r\n\t\t\t// E1 = kEdge1, E2 = kEdge2, N = Cross(E1,E2)) by\r\n\t\t\t//   |Dot(D,N)|*b1 = sign(Dot(D,N))*Dot(D,Cross(Q,E2))\r\n\t\t\t//   |Dot(D,N)|*b2 = sign(Dot(D,N))*Dot(D,Cross(E1,Q))\r\n\t\t\t//   |Dot(D,N)|*t = -sign(Dot(D,N))*Dot(Q,N)\r\n\t\t\tvar DdN = this.direction.dot( normal );\r\n\t\t\tvar sign;\r\n\r\n\t\t\tif ( DdN > 0 ) {\r\n\r\n\t\t\t\tif ( backfaceCulling ) return null;\r\n\t\t\t\tsign = 1;\r\n\r\n\t\t\t} else if ( DdN < 0 ) {\r\n\r\n\t\t\t\tsign = - 1;\r\n\t\t\t\tDdN = - DdN;\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\treturn null;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tdiff.subVectors( this.origin, a );\r\n\t\t\tvar DdQxE2 = sign * this.direction.dot( edge2.crossVectors( diff, edge2 ) );\r\n\r\n\t\t\t// b1 < 0, no intersection\r\n\t\t\tif ( DdQxE2 < 0 ) {\r\n\r\n\t\t\t\treturn null;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar DdE1xQ = sign * this.direction.dot( edge1.cross( diff ) );\r\n\r\n\t\t\t// b2 < 0, no intersection\r\n\t\t\tif ( DdE1xQ < 0 ) {\r\n\r\n\t\t\t\treturn null;\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// b1+b2 > 1, no intersection\r\n\t\t\tif ( DdQxE2 + DdE1xQ > DdN ) {\r\n\r\n\t\t\t\treturn null;\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// Line intersects triangle, check if ray does.\r\n\t\t\tvar QdN = - sign * diff.dot( normal );\r\n\r\n\t\t\t// t < 0, no intersection\r\n\t\t\tif ( QdN < 0 ) {\r\n\r\n\t\t\t\treturn null;\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// Ray intersects triangle.\r\n\t\t\treturn this.at( QdN / DdN, optionalTarget );\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\tapplyMatrix4: function ( matrix4 ) {\r\n\r\n\t\tthis.direction.add( this.origin ).applyMatrix4( matrix4 );\r\n\t\tthis.origin.applyMatrix4( matrix4 );\r\n\t\tthis.direction.sub( this.origin );\r\n\t\tthis.direction.normalize();\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tequals: function ( ray ) {\r\n\r\n\t\treturn ray.origin.equals( this.origin ) && ray.direction.equals( this.direction );\r\n\r\n\t}\r\n\r\n};\r\n\r\n// File:src/math/Sphere.js\r\n\r\n/**\r\n * @author bhouston / http://clara.io\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.Sphere = function ( center, radius ) {\r\n\r\n\tthis.center = ( center !== undefined ) ? center : new THREE.Vector3();\r\n\tthis.radius = ( radius !== undefined ) ? radius : 0;\r\n\r\n};\r\n\r\nTHREE.Sphere.prototype = {\r\n\r\n\tconstructor: THREE.Sphere,\r\n\r\n\tset: function ( center, radius ) {\r\n\r\n\t\tthis.center.copy( center );\r\n\t\tthis.radius = radius;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tsetFromPoints: function () {\r\n\r\n\t\tvar box = new THREE.Box3();\r\n\r\n\t\treturn function ( points, optionalCenter ) {\r\n\r\n\t\t\tvar center = this.center;\r\n\r\n\t\t\tif ( optionalCenter !== undefined ) {\r\n\r\n\t\t\t\tcenter.copy( optionalCenter );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tbox.setFromPoints( points ).center( center );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar maxRadiusSq = 0;\r\n\r\n\t\t\tfor ( var i = 0, il = points.length; i < il; i ++ ) {\r\n\r\n\t\t\t\tmaxRadiusSq = Math.max( maxRadiusSq, center.distanceToSquared( points[ i ] ) );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tthis.radius = Math.sqrt( maxRadiusSq );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\tclone: function () {\r\n\r\n\t\treturn new this.constructor().copy( this );\r\n\r\n\t},\r\n\r\n\tcopy: function ( sphere ) {\r\n\r\n\t\tthis.center.copy( sphere.center );\r\n\t\tthis.radius = sphere.radius;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tempty: function () {\r\n\r\n\t\treturn ( this.radius <= 0 );\r\n\r\n\t},\r\n\r\n\tcontainsPoint: function ( point ) {\r\n\r\n\t\treturn ( point.distanceToSquared( this.center ) <= ( this.radius * this.radius ) );\r\n\r\n\t},\r\n\r\n\tdistanceToPoint: function ( point ) {\r\n\r\n\t\treturn ( point.distanceTo( this.center ) - this.radius );\r\n\r\n\t},\r\n\r\n\tintersectsSphere: function ( sphere ) {\r\n\r\n\t\tvar radiusSum = this.radius + sphere.radius;\r\n\r\n\t\treturn sphere.center.distanceToSquared( this.center ) <= ( radiusSum * radiusSum );\r\n\r\n\t},\r\n\r\n\tintersectsBox: function ( box ) {\r\n\r\n\t\treturn box.intersectsSphere( this );\r\n\r\n\t},\r\n\r\n\tintersectsPlane: function ( plane ) {\r\n\r\n\t\t// We use the following equation to compute the signed distance from\r\n\t\t// the center of the sphere to the plane.\r\n\t\t//\r\n\t\t// distance = q * n - d\r\n\t\t//\r\n\t\t// If this distance is greater than the radius of the sphere,\r\n\t\t// then there is no intersection.\r\n\r\n\t\treturn Math.abs( this.center.dot( plane.normal ) - plane.constant ) <= this.radius;\r\n\r\n\t},\r\n\r\n\tclampPoint: function ( point, optionalTarget ) {\r\n\r\n\t\tvar deltaLengthSq = this.center.distanceToSquared( point );\r\n\r\n\t\tvar result = optionalTarget || new THREE.Vector3();\r\n\r\n\t\tresult.copy( point );\r\n\r\n\t\tif ( deltaLengthSq > ( this.radius * this.radius ) ) {\r\n\r\n\t\t\tresult.sub( this.center ).normalize();\r\n\t\t\tresult.multiplyScalar( this.radius ).add( this.center );\r\n\r\n\t\t}\r\n\r\n\t\treturn result;\r\n\r\n\t},\r\n\r\n\tgetBoundingBox: function ( optionalTarget ) {\r\n\r\n\t\tvar box = optionalTarget || new THREE.Box3();\r\n\r\n\t\tbox.set( this.center, this.center );\r\n\t\tbox.expandByScalar( this.radius );\r\n\r\n\t\treturn box;\r\n\r\n\t},\r\n\r\n\tapplyMatrix4: function ( matrix ) {\r\n\r\n\t\tthis.center.applyMatrix4( matrix );\r\n\t\tthis.radius = this.radius * matrix.getMaxScaleOnAxis();\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\ttranslate: function ( offset ) {\r\n\r\n\t\tthis.center.add( offset );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tequals: function ( sphere ) {\r\n\r\n\t\treturn sphere.center.equals( this.center ) && ( sphere.radius === this.radius );\r\n\r\n\t}\r\n\r\n};\r\n\r\n// File:src/math/Frustum.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author alteredq / http://alteredqualia.com/\r\n * @author bhouston / http://clara.io\r\n */\r\n\r\nTHREE.Frustum = function ( p0, p1, p2, p3, p4, p5 ) {\r\n\r\n\tthis.planes = [\r\n\r\n\t\t( p0 !== undefined ) ? p0 : new THREE.Plane(),\r\n\t\t( p1 !== undefined ) ? p1 : new THREE.Plane(),\r\n\t\t( p2 !== undefined ) ? p2 : new THREE.Plane(),\r\n\t\t( p3 !== undefined ) ? p3 : new THREE.Plane(),\r\n\t\t( p4 !== undefined ) ? p4 : new THREE.Plane(),\r\n\t\t( p5 !== undefined ) ? p5 : new THREE.Plane()\r\n\r\n\t];\r\n\r\n};\r\n\r\nTHREE.Frustum.prototype = {\r\n\r\n\tconstructor: THREE.Frustum,\r\n\r\n\tset: function ( p0, p1, p2, p3, p4, p5 ) {\r\n\r\n\t\tvar planes = this.planes;\r\n\r\n\t\tplanes[ 0 ].copy( p0 );\r\n\t\tplanes[ 1 ].copy( p1 );\r\n\t\tplanes[ 2 ].copy( p2 );\r\n\t\tplanes[ 3 ].copy( p3 );\r\n\t\tplanes[ 4 ].copy( p4 );\r\n\t\tplanes[ 5 ].copy( p5 );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tclone: function () {\r\n\r\n\t\treturn new this.constructor().copy( this );\r\n\r\n\t},\r\n\r\n\tcopy: function ( frustum ) {\r\n\r\n\t\tvar planes = this.planes;\r\n\r\n\t\tfor ( var i = 0; i < 6; i ++ ) {\r\n\r\n\t\t\tplanes[ i ].copy( frustum.planes[ i ] );\r\n\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tsetFromMatrix: function ( m ) {\r\n\r\n\t\tvar planes = this.planes;\r\n\t\tvar me = m.elements;\r\n\t\tvar me0 = me[ 0 ], me1 = me[ 1 ], me2 = me[ 2 ], me3 = me[ 3 ];\r\n\t\tvar me4 = me[ 4 ], me5 = me[ 5 ], me6 = me[ 6 ], me7 = me[ 7 ];\r\n\t\tvar me8 = me[ 8 ], me9 = me[ 9 ], me10 = me[ 10 ], me11 = me[ 11 ];\r\n\t\tvar me12 = me[ 12 ], me13 = me[ 13 ], me14 = me[ 14 ], me15 = me[ 15 ];\r\n\r\n\t\tplanes[ 0 ].setComponents( me3 - me0, me7 - me4, me11 - me8, me15 - me12 ).normalize();\r\n\t\tplanes[ 1 ].setComponents( me3 + me0, me7 + me4, me11 + me8, me15 + me12 ).normalize();\r\n\t\tplanes[ 2 ].setComponents( me3 + me1, me7 + me5, me11 + me9, me15 + me13 ).normalize();\r\n\t\tplanes[ 3 ].setComponents( me3 - me1, me7 - me5, me11 - me9, me15 - me13 ).normalize();\r\n\t\tplanes[ 4 ].setComponents( me3 - me2, me7 - me6, me11 - me10, me15 - me14 ).normalize();\r\n\t\tplanes[ 5 ].setComponents( me3 + me2, me7 + me6, me11 + me10, me15 + me14 ).normalize();\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tintersectsObject: function () {\r\n\r\n\t\tvar sphere = new THREE.Sphere();\r\n\r\n\t\treturn function ( object ) {\r\n\r\n\t\t\tvar geometry = object.geometry;\r\n\r\n\t\t\tif ( geometry.boundingSphere === null ) geometry.computeBoundingSphere();\r\n\r\n\t\t\tsphere.copy( geometry.boundingSphere );\r\n\t\t\tsphere.applyMatrix4( object.matrixWorld );\r\n\r\n\t\t\treturn this.intersectsSphere( sphere );\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\tintersectsSphere: function ( sphere ) {\r\n\r\n\t\tvar planes = this.planes;\r\n\t\tvar center = sphere.center;\r\n\t\tvar negRadius = - sphere.radius;\r\n\r\n\t\tfor ( var i = 0; i < 6; i ++ ) {\r\n\r\n\t\t\tvar distance = planes[ i ].distanceToPoint( center );\r\n\r\n\t\t\tif ( distance < negRadius ) {\r\n\r\n\t\t\t\treturn false;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\treturn true;\r\n\r\n\t},\r\n\r\n\tintersectsBox: function () {\r\n\r\n\t\tvar p1 = new THREE.Vector3(),\r\n\t\t\tp2 = new THREE.Vector3();\r\n\r\n\t\treturn function ( box ) {\r\n\r\n\t\t\tvar planes = this.planes;\r\n\r\n\t\t\tfor ( var i = 0; i < 6 ; i ++ ) {\r\n\r\n\t\t\t\tvar plane = planes[ i ];\r\n\r\n\t\t\t\tp1.x = plane.normal.x > 0 ? box.min.x : box.max.x;\r\n\t\t\t\tp2.x = plane.normal.x > 0 ? box.max.x : box.min.x;\r\n\t\t\t\tp1.y = plane.normal.y > 0 ? box.min.y : box.max.y;\r\n\t\t\t\tp2.y = plane.normal.y > 0 ? box.max.y : box.min.y;\r\n\t\t\t\tp1.z = plane.normal.z > 0 ? box.min.z : box.max.z;\r\n\t\t\t\tp2.z = plane.normal.z > 0 ? box.max.z : box.min.z;\r\n\r\n\t\t\t\tvar d1 = plane.distanceToPoint( p1 );\r\n\t\t\t\tvar d2 = plane.distanceToPoint( p2 );\r\n\r\n\t\t\t\t// if both outside plane, no intersection\r\n\r\n\t\t\t\tif ( d1 < 0 && d2 < 0 ) {\r\n\r\n\t\t\t\t\treturn false;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn true;\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\r\n\tcontainsPoint: function ( point ) {\r\n\r\n\t\tvar planes = this.planes;\r\n\r\n\t\tfor ( var i = 0; i < 6; i ++ ) {\r\n\r\n\t\t\tif ( planes[ i ].distanceToPoint( point ) < 0 ) {\r\n\r\n\t\t\t\treturn false;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\treturn true;\r\n\r\n\t}\r\n\r\n};\r\n\r\n// File:src/math/Plane.js\r\n\r\n/**\r\n * @author bhouston / http://clara.io\r\n */\r\n\r\nTHREE.Plane = function ( normal, constant ) {\r\n\r\n\tthis.normal = ( normal !== undefined ) ? normal : new THREE.Vector3( 1, 0, 0 );\r\n\tthis.constant = ( constant !== undefined ) ? constant : 0;\r\n\r\n};\r\n\r\nTHREE.Plane.prototype = {\r\n\r\n\tconstructor: THREE.Plane,\r\n\r\n\tset: function ( normal, constant ) {\r\n\r\n\t\tthis.normal.copy( normal );\r\n\t\tthis.constant = constant;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tsetComponents: function ( x, y, z, w ) {\r\n\r\n\t\tthis.normal.set( x, y, z );\r\n\t\tthis.constant = w;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tsetFromNormalAndCoplanarPoint: function ( normal, point ) {\r\n\r\n\t\tthis.normal.copy( normal );\r\n\t\tthis.constant = - point.dot( this.normal );\t// must be this.normal, not normal, as this.normal is normalized\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tsetFromCoplanarPoints: function () {\r\n\r\n\t\tvar v1 = new THREE.Vector3();\r\n\t\tvar v2 = new THREE.Vector3();\r\n\r\n\t\treturn function ( a, b, c ) {\r\n\r\n\t\t\tvar normal = v1.subVectors( c, b ).cross( v2.subVectors( a, b ) ).normalize();\r\n\r\n\t\t\t// Q: should an error be thrown if normal is zero (e.g. degenerate plane)?\r\n\r\n\t\t\tthis.setFromNormalAndCoplanarPoint( normal, a );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\tclone: function () {\r\n\r\n\t\treturn new this.constructor().copy( this );\r\n\r\n\t},\r\n\r\n\tcopy: function ( plane ) {\r\n\r\n\t\tthis.normal.copy( plane.normal );\r\n\t\tthis.constant = plane.constant;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tnormalize: function () {\r\n\r\n\t\t// Note: will lead to a divide by zero if the plane is invalid.\r\n\r\n\t\tvar inverseNormalLength = 1.0 / this.normal.length();\r\n\t\tthis.normal.multiplyScalar( inverseNormalLength );\r\n\t\tthis.constant *= inverseNormalLength;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tnegate: function () {\r\n\r\n\t\tthis.constant *= - 1;\r\n\t\tthis.normal.negate();\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tdistanceToPoint: function ( point ) {\r\n\r\n\t\treturn this.normal.dot( point ) + this.constant;\r\n\r\n\t},\r\n\r\n\tdistanceToSphere: function ( sphere ) {\r\n\r\n\t\treturn this.distanceToPoint( sphere.center ) - sphere.radius;\r\n\r\n\t},\r\n\r\n\tprojectPoint: function ( point, optionalTarget ) {\r\n\r\n\t\treturn this.orthoPoint( point, optionalTarget ).sub( point ).negate();\r\n\r\n\t},\r\n\r\n\torthoPoint: function ( point, optionalTarget ) {\r\n\r\n\t\tvar perpendicularMagnitude = this.distanceToPoint( point );\r\n\r\n\t\tvar result = optionalTarget || new THREE.Vector3();\r\n\t\treturn result.copy( this.normal ).multiplyScalar( perpendicularMagnitude );\r\n\r\n\t},\r\n\r\n\tintersectLine: function () {\r\n\r\n\t\tvar v1 = new THREE.Vector3();\r\n\r\n\t\treturn function ( line, optionalTarget ) {\r\n\r\n\t\t\tvar result = optionalTarget || new THREE.Vector3();\r\n\r\n\t\t\tvar direction = line.delta( v1 );\r\n\r\n\t\t\tvar denominator = this.normal.dot( direction );\r\n\r\n\t\t\tif ( denominator === 0 ) {\r\n\r\n\t\t\t\t// line is coplanar, return origin\r\n\t\t\t\tif ( this.distanceToPoint( line.start ) === 0 ) {\r\n\r\n\t\t\t\t\treturn result.copy( line.start );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// Unsure if this is the correct method to handle this case.\r\n\t\t\t\treturn undefined;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar t = - ( line.start.dot( this.normal ) + this.constant ) / denominator;\r\n\r\n\t\t\tif ( t < 0 || t > 1 ) {\r\n\r\n\t\t\t\treturn undefined;\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn result.copy( direction ).multiplyScalar( t ).add( line.start );\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\tintersectsLine: function ( line ) {\r\n\r\n\t\t// Note: this tests if a line intersects the plane, not whether it (or its end-points) are coplanar with it.\r\n\r\n\t\tvar startSign = this.distanceToPoint( line.start );\r\n\t\tvar endSign = this.distanceToPoint( line.end );\r\n\r\n\t\treturn ( startSign < 0 && endSign > 0 ) || ( endSign < 0 && startSign > 0 );\r\n\r\n\t},\r\n\r\n\tintersectsBox: function ( box ) {\r\n\r\n\t\treturn box.intersectsPlane( this );\r\n\r\n\t},\r\n\r\n\tintersectsSphere: function ( sphere ) {\r\n\r\n\t\treturn sphere.intersectsPlane( this );\r\n\r\n\t},\r\n\r\n\tcoplanarPoint: function ( optionalTarget ) {\r\n\r\n\t\tvar result = optionalTarget || new THREE.Vector3();\r\n\t\treturn result.copy( this.normal ).multiplyScalar( - this.constant );\r\n\r\n\t},\r\n\r\n\tapplyMatrix4: function () {\r\n\r\n\t\tvar v1 = new THREE.Vector3();\r\n\t\tvar m1 = new THREE.Matrix3();\r\n\r\n\t\treturn function ( matrix, optionalNormalMatrix ) {\r\n\r\n\t\t\tvar referencePoint = this.coplanarPoint( v1 ).applyMatrix4( matrix );\r\n\r\n\t\t\t// transform normal based on theory here:\r\n\t\t\t// http://www.songho.ca/opengl/gl_normaltransform.html\r\n\t\t\tvar normalMatrix = optionalNormalMatrix || m1.getNormalMatrix( matrix );\r\n\t\t\tvar normal = this.normal.applyMatrix3( normalMatrix ).normalize();\r\n\r\n\t\t\t// recalculate constant (like in setFromNormalAndCoplanarPoint)\r\n\t\t\tthis.constant = - referencePoint.dot( normal );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\ttranslate: function ( offset ) {\r\n\r\n\t\tthis.constant = this.constant - offset.dot( this.normal );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tequals: function ( plane ) {\r\n\r\n\t\treturn plane.normal.equals( this.normal ) && ( plane.constant === this.constant );\r\n\r\n\t}\r\n\r\n};\r\n\r\n// File:src/math/Spherical.js\r\n\r\n/**\r\n * @author bhouston / http://clara.io\r\n * @author WestLangley / http://github.com/WestLangley\r\n *\r\n * Ref: https://en.wikipedia.org/wiki/Spherical_coordinate_system\r\n *\r\n * The poles (phi) are at the positive and negative y axis.\r\n * The equator starts at positive z.\r\n */\r\n\r\nTHREE.Spherical = function ( radius, phi, theta ) {\r\n\r\n\tthis.radius = ( radius !== undefined ) ? radius : 1.0;\r\n\tthis.phi = ( phi !== undefined ) ? phi : 0; // up / down towards top and bottom pole\r\n\tthis.theta = ( theta !== undefined ) ? theta : 0; // around the equator of the sphere\r\n\r\n\treturn this;\r\n\r\n};\r\n\r\nTHREE.Spherical.prototype = {\r\n\r\n\tconstructor: THREE.Spherical,\r\n\r\n\tset: function ( radius, phi, theta ) {\r\n\r\n\t\tthis.radius = radius;\r\n\t\tthis.phi = phi;\r\n\t\tthis.theta = theta;\r\n\r\n\t},\r\n\r\n\tclone: function () {\r\n\r\n\t\treturn new this.constructor().copy( this );\r\n\r\n\t},\r\n\r\n\tcopy: function ( other ) {\r\n\r\n\t\tthis.radius.copy( other.radius );\r\n\t\tthis.phi.copy( other.phi );\r\n\t\tthis.theta.copy( other.theta );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\t// restrict phi to be betwee EPS and PI-EPS\r\n\tmakeSafe: function() {\r\n\r\n\t\tvar EPS = 0.000001;\r\n\t\tthis.phi = Math.max( EPS, Math.min( Math.PI - EPS, this.phi ) );\r\n\r\n\t},\r\n\r\n\tsetFromVector3: function( vec3 ) {\r\n\r\n\t\tthis.radius = vec3.length();\r\n\r\n\t\tif ( this.radius === 0 ) {\r\n\r\n\t\t\tthis.theta = 0;\r\n\t\t\tthis.phi = 0;\r\n\r\n\t\t} else {\r\n\r\n\t\t\tthis.theta = Math.atan2( vec3.x, vec3.z ); // equator angle around y-up axis\r\n\t\t\tthis.phi = Math.acos( THREE.Math.clamp( vec3.y / this.radius, - 1, 1 ) ); // polar angle\r\n\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n};\r\n\r\n// File:src/math/Math.js\r\n\r\n/**\r\n * @author alteredq / http://alteredqualia.com/\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.Math = {\r\n\r\n\tDEG2RAD: Math.PI / 180,\r\n\tRAD2DEG: 180 / Math.PI,\r\n\r\n\tgenerateUUID: function () {\r\n\r\n\t\t// http://www.broofa.com/Tools/Math.uuid.htm\r\n\r\n\t\tvar chars = '0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz'.split( '' );\r\n\t\tvar uuid = new Array( 36 );\r\n\t\tvar rnd = 0, r;\r\n\r\n\t\treturn function () {\r\n\r\n\t\t\tfor ( var i = 0; i < 36; i ++ ) {\r\n\r\n\t\t\t\tif ( i === 8 || i === 13 || i === 18 || i === 23 ) {\r\n\r\n\t\t\t\t\tuuid[ i ] = '-';\r\n\r\n\t\t\t\t} else if ( i === 14 ) {\r\n\r\n\t\t\t\t\tuuid[ i ] = '4';\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tif ( rnd <= 0x02 ) rnd = 0x2000000 + ( Math.random() * 0x1000000 ) | 0;\r\n\t\t\t\t\tr = rnd & 0xf;\r\n\t\t\t\t\trnd = rnd >> 4;\r\n\t\t\t\t\tuuid[ i ] = chars[ ( i === 19 ) ? ( r & 0x3 ) | 0x8 : r ];\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn uuid.join( '' );\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\tclamp: function ( value, min, max ) {\r\n\r\n\t\treturn Math.max( min, Math.min( max, value ) );\r\n\r\n\t},\r\n\r\n\t// compute euclidian modulo of m % n\r\n\t// https://en.wikipedia.org/wiki/Modulo_operation\r\n\r\n\teuclideanModulo: function ( n, m ) {\r\n\r\n\t\treturn ( ( n % m ) + m ) % m;\r\n\r\n\t},\r\n\r\n\t// Linear mapping from range <a1, a2> to range <b1, b2>\r\n\r\n\tmapLinear: function ( x, a1, a2, b1, b2 ) {\r\n\r\n\t\treturn b1 + ( x - a1 ) * ( b2 - b1 ) / ( a2 - a1 );\r\n\r\n\t},\r\n\r\n\t// http://en.wikipedia.org/wiki/Smoothstep\r\n\r\n\tsmoothstep: function ( x, min, max ) {\r\n\r\n\t\tif ( x <= min ) return 0;\r\n\t\tif ( x >= max ) return 1;\r\n\r\n\t\tx = ( x - min ) / ( max - min );\r\n\r\n\t\treturn x * x * ( 3 - 2 * x );\r\n\r\n\t},\r\n\r\n\tsmootherstep: function ( x, min, max ) {\r\n\r\n\t\tif ( x <= min ) return 0;\r\n\t\tif ( x >= max ) return 1;\r\n\r\n\t\tx = ( x - min ) / ( max - min );\r\n\r\n\t\treturn x * x * x * ( x * ( x * 6 - 15 ) + 10 );\r\n\r\n\t},\r\n\r\n\trandom16: function () {\r\n\r\n\t\tconsole.warn( 'THREE.Math.random16() has been deprecated. Use Math.random() instead.' );\r\n\t\treturn Math.random();\r\n\r\n\t},\r\n\r\n\t// Random integer from <low, high> interval\r\n\r\n\trandInt: function ( low, high ) {\r\n\r\n\t\treturn low + Math.floor( Math.random() * ( high - low + 1 ) );\r\n\r\n\t},\r\n\r\n\t// Random float from <low, high> interval\r\n\r\n\trandFloat: function ( low, high ) {\r\n\r\n\t\treturn low + Math.random() * ( high - low );\r\n\r\n\t},\r\n\r\n\t// Random float from <-range/2, range/2> interval\r\n\r\n\trandFloatSpread: function ( range ) {\r\n\r\n\t\treturn range * ( 0.5 - Math.random() );\r\n\r\n\t},\r\n\r\n\tdegToRad: function ( degrees ) {\r\n\r\n\t\treturn degrees * THREE.Math.DEG2RAD;\r\n\r\n\t},\r\n\r\n\tradToDeg: function ( radians ) {\r\n\r\n\t\treturn radians * THREE.Math.RAD2DEG;\r\n\r\n\t},\r\n\r\n\tisPowerOfTwo: function ( value ) {\r\n\r\n\t\treturn ( value & ( value - 1 ) ) === 0 && value !== 0;\r\n\r\n\t},\r\n\r\n\tnearestPowerOfTwo: function ( value ) {\r\n\r\n\t\treturn Math.pow( 2, Math.round( Math.log( value ) / Math.LN2 ) );\r\n\r\n\t},\r\n\r\n\tnextPowerOfTwo: function ( value ) {\r\n\r\n\t\tvalue --;\r\n\t\tvalue |= value >> 1;\r\n\t\tvalue |= value >> 2;\r\n\t\tvalue |= value >> 4;\r\n\t\tvalue |= value >> 8;\r\n\t\tvalue |= value >> 16;\r\n\t\tvalue ++;\r\n\r\n\t\treturn value;\r\n\r\n\t}\r\n\r\n};\r\n\r\n// File:src/math/Spline.js\r\n\r\n/**\r\n * Spline from Tween.js, slightly optimized (and trashed)\r\n * http://sole.github.com/tween.js/examples/05_spline.html\r\n *\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author alteredq / http://alteredqualia.com/\r\n */\r\n\r\nTHREE.Spline = function ( points ) {\r\n\r\n\tthis.points = points;\r\n\r\n\tvar c = [], v3 = { x: 0, y: 0, z: 0 },\r\n\tpoint, intPoint, weight, w2, w3,\r\n\tpa, pb, pc, pd;\r\n\r\n\tthis.initFromArray = function ( a ) {\r\n\r\n\t\tthis.points = [];\r\n\r\n\t\tfor ( var i = 0; i < a.length; i ++ ) {\r\n\r\n\t\t\tthis.points[ i ] = { x: a[ i ][ 0 ], y: a[ i ][ 1 ], z: a[ i ][ 2 ] };\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n\tthis.getPoint = function ( k ) {\r\n\r\n\t\tpoint = ( this.points.length - 1 ) * k;\r\n\t\tintPoint = Math.floor( point );\r\n\t\tweight = point - intPoint;\r\n\r\n\t\tc[ 0 ] = intPoint === 0 ? intPoint : intPoint - 1;\r\n\t\tc[ 1 ] = intPoint;\r\n\t\tc[ 2 ] = intPoint  > this.points.length - 2 ? this.points.length - 1 : intPoint + 1;\r\n\t\tc[ 3 ] = intPoint  > this.points.length - 3 ? this.points.length - 1 : intPoint + 2;\r\n\r\n\t\tpa = this.points[ c[ 0 ] ];\r\n\t\tpb = this.points[ c[ 1 ] ];\r\n\t\tpc = this.points[ c[ 2 ] ];\r\n\t\tpd = this.points[ c[ 3 ] ];\r\n\r\n\t\tw2 = weight * weight;\r\n\t\tw3 = weight * w2;\r\n\r\n\t\tv3.x = interpolate( pa.x, pb.x, pc.x, pd.x, weight, w2, w3 );\r\n\t\tv3.y = interpolate( pa.y, pb.y, pc.y, pd.y, weight, w2, w3 );\r\n\t\tv3.z = interpolate( pa.z, pb.z, pc.z, pd.z, weight, w2, w3 );\r\n\r\n\t\treturn v3;\r\n\r\n\t};\r\n\r\n\tthis.getControlPointsArray = function () {\r\n\r\n\t\tvar i, p, l = this.points.length,\r\n\t\t\tcoords = [];\r\n\r\n\t\tfor ( i = 0; i < l; i ++ ) {\r\n\r\n\t\t\tp = this.points[ i ];\r\n\t\t\tcoords[ i ] = [ p.x, p.y, p.z ];\r\n\r\n\t\t}\r\n\r\n\t\treturn coords;\r\n\r\n\t};\r\n\r\n\t// approximate length by summing linear segments\r\n\r\n\tthis.getLength = function ( nSubDivisions ) {\r\n\r\n\t\tvar i, index, nSamples, position,\r\n\t\t\tpoint = 0, intPoint = 0, oldIntPoint = 0,\r\n\t\t\toldPosition = new THREE.Vector3(),\r\n\t\t\ttmpVec = new THREE.Vector3(),\r\n\t\t\tchunkLengths = [],\r\n\t\t\ttotalLength = 0;\r\n\r\n\t\t// first point has 0 length\r\n\r\n\t\tchunkLengths[ 0 ] = 0;\r\n\r\n\t\tif ( ! nSubDivisions ) nSubDivisions = 100;\r\n\r\n\t\tnSamples = this.points.length * nSubDivisions;\r\n\r\n\t\toldPosition.copy( this.points[ 0 ] );\r\n\r\n\t\tfor ( i = 1; i < nSamples; i ++ ) {\r\n\r\n\t\t\tindex = i / nSamples;\r\n\r\n\t\t\tposition = this.getPoint( index );\r\n\t\t\ttmpVec.copy( position );\r\n\r\n\t\t\ttotalLength += tmpVec.distanceTo( oldPosition );\r\n\r\n\t\t\toldPosition.copy( position );\r\n\r\n\t\t\tpoint = ( this.points.length - 1 ) * index;\r\n\t\t\tintPoint = Math.floor( point );\r\n\r\n\t\t\tif ( intPoint !== oldIntPoint ) {\r\n\r\n\t\t\t\tchunkLengths[ intPoint ] = totalLength;\r\n\t\t\t\toldIntPoint = intPoint;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\t// last point ends with total length\r\n\r\n\t\tchunkLengths[ chunkLengths.length ] = totalLength;\r\n\r\n\t\treturn { chunks: chunkLengths, total: totalLength };\r\n\r\n\t};\r\n\r\n\tthis.reparametrizeByArcLength = function ( samplingCoef ) {\r\n\r\n\t\tvar i, j,\r\n\t\t\tindex, indexCurrent, indexNext,\r\n\t\t\trealDistance,\r\n\t\t\tsampling, position,\r\n\t\t\tnewpoints = [],\r\n\t\t\ttmpVec = new THREE.Vector3(),\r\n\t\t\tsl = this.getLength();\r\n\r\n\t\tnewpoints.push( tmpVec.copy( this.points[ 0 ] ).clone() );\r\n\r\n\t\tfor ( i = 1; i < this.points.length; i ++ ) {\r\n\r\n\t\t\t//tmpVec.copy( this.points[ i - 1 ] );\r\n\t\t\t//linearDistance = tmpVec.distanceTo( this.points[ i ] );\r\n\r\n\t\t\trealDistance = sl.chunks[ i ] - sl.chunks[ i - 1 ];\r\n\r\n\t\t\tsampling = Math.ceil( samplingCoef * realDistance / sl.total );\r\n\r\n\t\t\tindexCurrent = ( i - 1 ) / ( this.points.length - 1 );\r\n\t\t\tindexNext = i / ( this.points.length - 1 );\r\n\r\n\t\t\tfor ( j = 1; j < sampling - 1; j ++ ) {\r\n\r\n\t\t\t\tindex = indexCurrent + j * ( 1 / sampling ) * ( indexNext - indexCurrent );\r\n\r\n\t\t\t\tposition = this.getPoint( index );\r\n\t\t\t\tnewpoints.push( tmpVec.copy( position ).clone() );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tnewpoints.push( tmpVec.copy( this.points[ i ] ).clone() );\r\n\r\n\t\t}\r\n\r\n\t\tthis.points = newpoints;\r\n\r\n\t};\r\n\r\n\t// Catmull-Rom\r\n\r\n\tfunction interpolate( p0, p1, p2, p3, t, t2, t3 ) {\r\n\r\n\t\tvar v0 = ( p2 - p0 ) * 0.5,\r\n\t\t\tv1 = ( p3 - p1 ) * 0.5;\r\n\r\n\t\treturn ( 2 * ( p1 - p2 ) + v0 + v1 ) * t3 + ( - 3 * ( p1 - p2 ) - 2 * v0 - v1 ) * t2 + v0 * t + p1;\r\n\r\n\t}\r\n\r\n};\r\n\r\n// File:src/math/Triangle.js\r\n\r\n/**\r\n * @author bhouston / http://clara.io\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.Triangle = function ( a, b, c ) {\r\n\r\n\tthis.a = ( a !== undefined ) ? a : new THREE.Vector3();\r\n\tthis.b = ( b !== undefined ) ? b : new THREE.Vector3();\r\n\tthis.c = ( c !== undefined ) ? c : new THREE.Vector3();\r\n\r\n};\r\n\r\nTHREE.Triangle.normal = function () {\r\n\r\n\tvar v0 = new THREE.Vector3();\r\n\r\n\treturn function ( a, b, c, optionalTarget ) {\r\n\r\n\t\tvar result = optionalTarget || new THREE.Vector3();\r\n\r\n\t\tresult.subVectors( c, b );\r\n\t\tv0.subVectors( a, b );\r\n\t\tresult.cross( v0 );\r\n\r\n\t\tvar resultLengthSq = result.lengthSq();\r\n\t\tif ( resultLengthSq > 0 ) {\r\n\r\n\t\t\treturn result.multiplyScalar( 1 / Math.sqrt( resultLengthSq ) );\r\n\r\n\t\t}\r\n\r\n\t\treturn result.set( 0, 0, 0 );\r\n\r\n\t};\r\n\r\n}();\r\n\r\n// static/instance method to calculate barycentric coordinates\r\n// based on: http://www.blackpawn.com/texts/pointinpoly/default.html\r\nTHREE.Triangle.barycoordFromPoint = function () {\r\n\r\n\tvar v0 = new THREE.Vector3();\r\n\tvar v1 = new THREE.Vector3();\r\n\tvar v2 = new THREE.Vector3();\r\n\r\n\treturn function ( point, a, b, c, optionalTarget ) {\r\n\r\n\t\tv0.subVectors( c, a );\r\n\t\tv1.subVectors( b, a );\r\n\t\tv2.subVectors( point, a );\r\n\r\n\t\tvar dot00 = v0.dot( v0 );\r\n\t\tvar dot01 = v0.dot( v1 );\r\n\t\tvar dot02 = v0.dot( v2 );\r\n\t\tvar dot11 = v1.dot( v1 );\r\n\t\tvar dot12 = v1.dot( v2 );\r\n\r\n\t\tvar denom = ( dot00 * dot11 - dot01 * dot01 );\r\n\r\n\t\tvar result = optionalTarget || new THREE.Vector3();\r\n\r\n\t\t// collinear or singular triangle\r\n\t\tif ( denom === 0 ) {\r\n\r\n\t\t\t// arbitrary location outside of triangle?\r\n\t\t\t// not sure if this is the best idea, maybe should be returning undefined\r\n\t\t\treturn result.set( - 2, - 1, - 1 );\r\n\r\n\t\t}\r\n\r\n\t\tvar invDenom = 1 / denom;\r\n\t\tvar u = ( dot11 * dot02 - dot01 * dot12 ) * invDenom;\r\n\t\tvar v = ( dot00 * dot12 - dot01 * dot02 ) * invDenom;\r\n\r\n\t\t// barycentric coordinates must always sum to 1\r\n\t\treturn result.set( 1 - u - v, v, u );\r\n\r\n\t};\r\n\r\n}();\r\n\r\nTHREE.Triangle.containsPoint = function () {\r\n\r\n\tvar v1 = new THREE.Vector3();\r\n\r\n\treturn function ( point, a, b, c ) {\r\n\r\n\t\tvar result = THREE.Triangle.barycoordFromPoint( point, a, b, c, v1 );\r\n\r\n\t\treturn ( result.x >= 0 ) && ( result.y >= 0 ) && ( ( result.x + result.y ) <= 1 );\r\n\r\n\t};\r\n\r\n}();\r\n\r\nTHREE.Triangle.prototype = {\r\n\r\n\tconstructor: THREE.Triangle,\r\n\r\n\tset: function ( a, b, c ) {\r\n\r\n\t\tthis.a.copy( a );\r\n\t\tthis.b.copy( b );\r\n\t\tthis.c.copy( c );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tsetFromPointsAndIndices: function ( points, i0, i1, i2 ) {\r\n\r\n\t\tthis.a.copy( points[ i0 ] );\r\n\t\tthis.b.copy( points[ i1 ] );\r\n\t\tthis.c.copy( points[ i2 ] );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tclone: function () {\r\n\r\n\t\treturn new this.constructor().copy( this );\r\n\r\n\t},\r\n\r\n\tcopy: function ( triangle ) {\r\n\r\n\t\tthis.a.copy( triangle.a );\r\n\t\tthis.b.copy( triangle.b );\r\n\t\tthis.c.copy( triangle.c );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tarea: function () {\r\n\r\n\t\tvar v0 = new THREE.Vector3();\r\n\t\tvar v1 = new THREE.Vector3();\r\n\r\n\t\treturn function () {\r\n\r\n\t\t\tv0.subVectors( this.c, this.b );\r\n\t\t\tv1.subVectors( this.a, this.b );\r\n\r\n\t\t\treturn v0.cross( v1 ).length() * 0.5;\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\tmidpoint: function ( optionalTarget ) {\r\n\r\n\t\tvar result = optionalTarget || new THREE.Vector3();\r\n\t\treturn result.addVectors( this.a, this.b ).add( this.c ).multiplyScalar( 1 / 3 );\r\n\r\n\t},\r\n\r\n\tnormal: function ( optionalTarget ) {\r\n\r\n\t\treturn THREE.Triangle.normal( this.a, this.b, this.c, optionalTarget );\r\n\r\n\t},\r\n\r\n\tplane: function ( optionalTarget ) {\r\n\r\n\t\tvar result = optionalTarget || new THREE.Plane();\r\n\r\n\t\treturn result.setFromCoplanarPoints( this.a, this.b, this.c );\r\n\r\n\t},\r\n\r\n\tbarycoordFromPoint: function ( point, optionalTarget ) {\r\n\r\n\t\treturn THREE.Triangle.barycoordFromPoint( point, this.a, this.b, this.c, optionalTarget );\r\n\r\n\t},\r\n\r\n\tcontainsPoint: function ( point ) {\r\n\r\n\t\treturn THREE.Triangle.containsPoint( point, this.a, this.b, this.c );\r\n\r\n\t},\r\n\r\n\tclosestPointToPoint: function () {\r\n\r\n\t\tvar plane, edgeList, projectedPoint, closestPoint;\r\n\r\n\t\treturn function closestPointToPoint( point, optionalTarget ) {\r\n\r\n\t\t\tif ( plane === undefined ) {\r\n\r\n\t\t\t\tplane = new THREE.Plane();\r\n\t\t\t\tedgeList = [ new THREE.Line3(), new THREE.Line3(), new THREE.Line3() ];\r\n\t\t\t\tprojectedPoint = new THREE.Vector3();\r\n\t\t\t\tclosestPoint = new THREE.Vector3();\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar result = optionalTarget || new THREE.Vector3();\r\n\t\t\tvar minDistance = Infinity;\r\n\r\n\t\t\t// project the point onto the plane of the triangle\r\n\r\n\t\t\tplane.setFromCoplanarPoints( this.a, this.b, this.c );\r\n\t\t\tplane.projectPoint( point, projectedPoint );\r\n\r\n\t\t\t// check if the projection lies within the triangle\r\n\r\n\t\t\tif( this.containsPoint( projectedPoint ) === true ) {\r\n\r\n\t\t\t\t// if so, this is the closest point\r\n\r\n\t\t\t\tresult.copy( projectedPoint );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\t// if not, the point falls outside the triangle. the result is the closest point to the triangle's edges or vertices\r\n\r\n\t\t\t\tedgeList[ 0 ].set( this.a, this.b );\r\n\t\t\t\tedgeList[ 1 ].set( this.b, this.c );\r\n\t\t\t\tedgeList[ 2 ].set( this.c, this.a );\r\n\r\n\t\t\t\tfor( var i = 0; i < edgeList.length; i ++ ) {\r\n\r\n\t\t\t\t\tedgeList[ i ].closestPointToPoint( projectedPoint, true, closestPoint );\r\n\r\n\t\t\t\t\tvar distance = projectedPoint.distanceToSquared( closestPoint );\r\n\r\n\t\t\t\t\tif( distance < minDistance ) {\r\n\r\n\t\t\t\t\t\tminDistance = distance;\r\n\r\n\t\t\t\t\t\tresult.copy( closestPoint );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn result;\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\tequals: function ( triangle ) {\r\n\r\n\t\treturn triangle.a.equals( this.a ) && triangle.b.equals( this.b ) && triangle.c.equals( this.c );\r\n\r\n\t}\r\n\r\n};\r\n\r\n// File:src/math/Interpolant.js\r\n\r\n/**\r\n * Abstract base class of interpolants over parametric samples.\r\n *\r\n * The parameter domain is one dimensional, typically the time or a path\r\n * along a curve defined by the data.\r\n *\r\n * The sample values can have any dimensionality and derived classes may\r\n * apply special interpretations to the data.\r\n *\r\n * This class provides the interval seek in a Template Method, deferring\r\n * the actual interpolation to derived classes.\r\n *\r\n * Time complexity is O(1) for linear access crossing at most two points\r\n * and O(log N) for random access, where N is the number of positions.\r\n *\r\n * References:\r\n *\r\n * \t\thttp://www.oodesign.com/template-method-pattern.html\r\n *\r\n * @author tschw\r\n */\r\n\r\nTHREE.Interpolant = function(\r\n\t\tparameterPositions, sampleValues, sampleSize, resultBuffer ) {\r\n\r\n\tthis.parameterPositions = parameterPositions;\r\n\tthis._cachedIndex = 0;\r\n\r\n\tthis.resultBuffer = resultBuffer !== undefined ?\r\n\t\t\tresultBuffer : new sampleValues.constructor( sampleSize );\r\n\tthis.sampleValues = sampleValues;\r\n\tthis.valueSize = sampleSize;\r\n\r\n};\r\n\r\nTHREE.Interpolant.prototype = {\r\n\r\n\tconstructor: THREE.Interpolant,\r\n\r\n\tevaluate: function( t ) {\r\n\r\n\t\tvar pp = this.parameterPositions,\r\n\t\t\ti1 = this._cachedIndex,\r\n\r\n\t\t\tt1 = pp[   i1   ],\r\n\t\t\tt0 = pp[ i1 - 1 ];\r\n\r\n\t\tvalidate_interval: {\r\n\r\n\t\t\tseek: {\r\n\r\n\t\t\t\tvar right;\r\n\r\n\t\t\t\tlinear_scan: {\r\n//- See http://jsperf.com/comparison-to-undefined/3\r\n//- slower code:\r\n//-\r\n//- \t\t\t\tif ( t >= t1 || t1 === undefined ) {\r\n\t\t\t\t\tforward_scan: if ( ! ( t < t1 ) ) {\r\n\r\n\t\t\t\t\t\tfor ( var giveUpAt = i1 + 2; ;) {\r\n\r\n\t\t\t\t\t\t\tif ( t1 === undefined ) {\r\n\r\n\t\t\t\t\t\t\t\tif ( t < t0 ) break forward_scan;\r\n\r\n\t\t\t\t\t\t\t\t// after end\r\n\r\n\t\t\t\t\t\t\t\ti1 = pp.length;\r\n\t\t\t\t\t\t\t\tthis._cachedIndex = i1;\r\n\t\t\t\t\t\t\t\treturn this.afterEnd_( i1 - 1, t, t0 );\r\n\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\tif ( i1 === giveUpAt ) break; // this loop\r\n\r\n\t\t\t\t\t\t\tt0 = t1;\r\n\t\t\t\t\t\t\tt1 = pp[ ++ i1 ];\r\n\r\n\t\t\t\t\t\t\tif ( t < t1 ) {\r\n\r\n\t\t\t\t\t\t\t\t// we have arrived at the sought interval\r\n\t\t\t\t\t\t\t\tbreak seek;\r\n\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t// prepare binary search on the right side of the index\r\n\t\t\t\t\t\tright = pp.length;\r\n\t\t\t\t\t\tbreak linear_scan;\r\n\r\n\t\t\t\t\t}\r\n\r\n//- slower code:\r\n//-\t\t\t\t\tif ( t < t0 || t0 === undefined ) {\r\n\t\t\t\t\tif ( ! ( t >= t0 ) ) {\r\n\r\n\t\t\t\t\t\t// looping?\r\n\r\n\t\t\t\t\t\tvar t1global = pp[ 1 ];\r\n\r\n\t\t\t\t\t\tif ( t < t1global ) {\r\n\r\n\t\t\t\t\t\t\ti1 = 2; // + 1, using the scan for the details\r\n\t\t\t\t\t\t\tt0 = t1global;\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t// linear reverse scan\r\n\r\n\t\t\t\t\t\tfor ( var giveUpAt = i1 - 2; ;) {\r\n\r\n\t\t\t\t\t\t\tif ( t0 === undefined ) {\r\n\r\n\t\t\t\t\t\t\t\t// before start\r\n\r\n\t\t\t\t\t\t\t\tthis._cachedIndex = 0;\r\n\t\t\t\t\t\t\t\treturn this.beforeStart_( 0, t, t1 );\r\n\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\tif ( i1 === giveUpAt ) break; // this loop\r\n\r\n\t\t\t\t\t\t\tt1 = t0;\r\n\t\t\t\t\t\t\tt0 = pp[ -- i1 - 1 ];\r\n\r\n\t\t\t\t\t\t\tif ( t >= t0 ) {\r\n\r\n\t\t\t\t\t\t\t\t// we have arrived at the sought interval\r\n\t\t\t\t\t\t\t\tbreak seek;\r\n\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t// prepare binary search on the left side of the index\r\n\t\t\t\t\t\tright = i1;\r\n\t\t\t\t\t\ti1 = 0;\r\n\t\t\t\t\t\tbreak linear_scan;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t// the interval is valid\r\n\r\n\t\t\t\t\tbreak validate_interval;\r\n\r\n\t\t\t\t} // linear scan\r\n\r\n\t\t\t\t// binary search\r\n\r\n\t\t\t\twhile ( i1 < right ) {\r\n\r\n\t\t\t\t\tvar mid = ( i1 + right ) >>> 1;\r\n\r\n\t\t\t\t\tif ( t < pp[ mid ] ) {\r\n\r\n\t\t\t\t\t\tright = mid;\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\ti1 = mid + 1;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tt1 = pp[   i1   ];\r\n\t\t\t\tt0 = pp[ i1 - 1 ];\r\n\r\n\t\t\t\t// check boundary cases, again\r\n\r\n\t\t\t\tif ( t0 === undefined ) {\r\n\r\n\t\t\t\t\tthis._cachedIndex = 0;\r\n\t\t\t\t\treturn this.beforeStart_( 0, t, t1 );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( t1 === undefined ) {\r\n\r\n\t\t\t\t\ti1 = pp.length;\r\n\t\t\t\t\tthis._cachedIndex = i1;\r\n\t\t\t\t\treturn this.afterEnd_( i1 - 1, t0, t );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t} // seek\r\n\r\n\t\t\tthis._cachedIndex = i1;\r\n\r\n\t\t\tthis.intervalChanged_( i1, t0, t1 );\r\n\r\n\t\t} // validate_interval\r\n\r\n\t\treturn this.interpolate_( i1, t0, t, t1 );\r\n\r\n\t},\r\n\r\n\tsettings: null, // optional, subclass-specific settings structure\r\n\t// Note: The indirection allows central control of many interpolants.\r\n\r\n\t// --- Protected interface\r\n\r\n\tDefaultSettings_: {},\r\n\r\n\tgetSettings_: function() {\r\n\r\n\t\treturn this.settings || this.DefaultSettings_;\r\n\r\n\t},\r\n\r\n\tcopySampleValue_: function( index ) {\r\n\r\n\t\t// copies a sample value to the result buffer\r\n\r\n\t\tvar result = this.resultBuffer,\r\n\t\t\tvalues = this.sampleValues,\r\n\t\t\tstride = this.valueSize,\r\n\t\t\toffset = index * stride;\r\n\r\n\t\tfor ( var i = 0; i !== stride; ++ i ) {\r\n\r\n\t\t\tresult[ i ] = values[ offset + i ];\r\n\r\n\t\t}\r\n\r\n\t\treturn result;\r\n\r\n\t},\r\n\r\n\t// Template methods for derived classes:\r\n\r\n\tinterpolate_: function( i1, t0, t, t1 ) {\r\n\r\n\t\tthrow new Error( \"call to abstract method\" );\r\n\t\t// implementations shall return this.resultBuffer\r\n\r\n\t},\r\n\r\n\tintervalChanged_: function( i1, t0, t1 ) {\r\n\r\n\t\t// empty\r\n\r\n\t}\r\n\r\n};\r\n\r\nObject.assign( THREE.Interpolant.prototype, {\r\n\r\n\tbeforeStart_: //( 0, t, t0 ), returns this.resultBuffer\r\n\t\tTHREE.Interpolant.prototype.copySampleValue_,\r\n\r\n\tafterEnd_: //( N-1, tN-1, t ), returns this.resultBuffer\r\n\t\tTHREE.Interpolant.prototype.copySampleValue_\r\n\r\n} );\r\n\r\n// File:src/math/interpolants/CubicInterpolant.js\r\n\r\n/**\r\n * Fast and simple cubic spline interpolant.\r\n *\r\n * It was derived from a Hermitian construction setting the first derivative\r\n * at each sample position to the linear slope between neighboring positions\r\n * over their parameter interval.\r\n *\r\n * @author tschw\r\n */\r\n\r\nTHREE.CubicInterpolant = function(\r\n\t\tparameterPositions, sampleValues, sampleSize, resultBuffer ) {\r\n\r\n\tTHREE.Interpolant.call(\r\n\t\t\tthis, parameterPositions, sampleValues, sampleSize, resultBuffer );\r\n\r\n\tthis._weightPrev = -0;\r\n\tthis._offsetPrev = -0;\r\n\tthis._weightNext = -0;\r\n\tthis._offsetNext = -0;\r\n\r\n};\r\n\r\nTHREE.CubicInterpolant.prototype =\r\n\t\tObject.assign( Object.create( THREE.Interpolant.prototype ), {\r\n\r\n\tconstructor: THREE.CubicInterpolant,\r\n\r\n\tDefaultSettings_: {\r\n\r\n\t\tendingStart: \tTHREE.ZeroCurvatureEnding,\r\n\t\tendingEnd:\t\tTHREE.ZeroCurvatureEnding\r\n\r\n\t},\r\n\r\n\tintervalChanged_: function( i1, t0, t1 ) {\r\n\r\n\t\tvar pp = this.parameterPositions,\r\n\t\t\tiPrev = i1 - 2,\r\n\t\t\tiNext = i1 + 1,\r\n\r\n\t\t\ttPrev = pp[ iPrev ],\r\n\t\t\ttNext = pp[ iNext ];\r\n\r\n\t\tif ( tPrev === undefined ) {\r\n\r\n\t\t\tswitch ( this.getSettings_().endingStart ) {\r\n\r\n\t\t\t\tcase THREE.ZeroSlopeEnding:\r\n\r\n\t\t\t\t\t// f'(t0) = 0\r\n\t\t\t\t\tiPrev = i1;\r\n\t\t\t\t\ttPrev = 2 * t0 - t1;\r\n\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase THREE.WrapAroundEnding:\r\n\r\n\t\t\t\t\t// use the other end of the curve\r\n\t\t\t\t\tiPrev = pp.length - 2;\r\n\t\t\t\t\ttPrev = t0 + pp[ iPrev ] - pp[ iPrev + 1 ];\r\n\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tdefault: // ZeroCurvatureEnding\r\n\r\n\t\t\t\t\t// f''(t0) = 0 a.k.a. Natural Spline\r\n\t\t\t\t\tiPrev = i1;\r\n\t\t\t\t\ttPrev = t1;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tif ( tNext === undefined ) {\r\n\r\n\t\t\tswitch ( this.getSettings_().endingEnd ) {\r\n\r\n\t\t\t\tcase THREE.ZeroSlopeEnding:\r\n\r\n\t\t\t\t\t// f'(tN) = 0\r\n\t\t\t\t\tiNext = i1;\r\n\t\t\t\t\ttNext = 2 * t1 - t0;\r\n\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase THREE.WrapAroundEnding:\r\n\r\n\t\t\t\t\t// use the other end of the curve\r\n\t\t\t\t\tiNext = 1;\r\n\t\t\t\t\ttNext = t1 + pp[ 1 ] - pp[ 0 ];\r\n\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tdefault: // ZeroCurvatureEnding\r\n\r\n\t\t\t\t\t// f''(tN) = 0, a.k.a. Natural Spline\r\n\t\t\t\t\tiNext = i1 - 1;\r\n\t\t\t\t\ttNext = t0;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tvar halfDt = ( t1 - t0 ) * 0.5,\r\n\t\t\tstride = this.valueSize;\r\n\r\n\t\tthis._weightPrev = halfDt / ( t0 - tPrev );\r\n\t\tthis._weightNext = halfDt / ( tNext - t1 );\r\n\t\tthis._offsetPrev = iPrev * stride;\r\n\t\tthis._offsetNext = iNext * stride;\r\n\r\n\t},\r\n\r\n\tinterpolate_: function( i1, t0, t, t1 ) {\r\n\r\n\t\tvar result = this.resultBuffer,\r\n\t\t\tvalues = this.sampleValues,\r\n\t\t\tstride = this.valueSize,\r\n\r\n\t\t\to1 = i1 * stride,\t\to0 = o1 - stride,\r\n\t\t\toP = this._offsetPrev, \toN = this._offsetNext,\r\n\t\t\twP = this._weightPrev,\twN = this._weightNext,\r\n\r\n\t\t\tp = ( t - t0 ) / ( t1 - t0 ),\r\n\t\t\tpp = p * p,\r\n\t\t\tppp = pp * p;\r\n\r\n\t\t// evaluate polynomials\r\n\r\n\t\tvar sP =     - wP   * ppp   +         2 * wP    * pp    -          wP   * p;\r\n\t\tvar s0 = ( 1 + wP ) * ppp   + (-1.5 - 2 * wP )  * pp    + ( -0.5 + wP ) * p     + 1;\r\n\t\tvar s1 = (-1 - wN ) * ppp   + ( 1.5 +   wN   )  * pp    +    0.5        * p;\r\n\t\tvar sN =       wN   * ppp   -           wN      * pp;\r\n\r\n\t\t// combine data linearly\r\n\r\n\t\tfor ( var i = 0; i !== stride; ++ i ) {\r\n\r\n\t\t\tresult[ i ] =\r\n\t\t\t\t\tsP * values[ oP + i ] +\r\n\t\t\t\t\ts0 * values[ o0 + i ] +\r\n\t\t\t\t\ts1 * values[ o1 + i ] +\r\n\t\t\t\t\tsN * values[ oN + i ];\r\n\r\n\t\t}\r\n\r\n\t\treturn result;\r\n\r\n\t}\r\n\r\n} );\r\n\r\n// File:src/math/interpolants/DiscreteInterpolant.js\r\n\r\n/**\r\n *\r\n * Interpolant that evaluates to the sample value at the position preceeding\r\n * the parameter.\r\n *\r\n * @author tschw\r\n */\r\n\r\nTHREE.DiscreteInterpolant = function(\r\n\t\tparameterPositions, sampleValues, sampleSize, resultBuffer ) {\r\n\r\n\tTHREE.Interpolant.call(\r\n\t\t\tthis, parameterPositions, sampleValues, sampleSize, resultBuffer );\r\n\r\n};\r\n\r\nTHREE.DiscreteInterpolant.prototype =\r\n\t\tObject.assign( Object.create( THREE.Interpolant.prototype ), {\r\n\r\n\tconstructor: THREE.DiscreteInterpolant,\r\n\r\n\tinterpolate_: function( i1, t0, t, t1 ) {\r\n\r\n\t\treturn this.copySampleValue_( i1 - 1 );\r\n\r\n\t}\r\n\r\n} );\r\n\r\n// File:src/math/interpolants/LinearInterpolant.js\r\n\r\n/**\r\n * @author tschw\r\n */\r\n\r\nTHREE.LinearInterpolant = function(\r\n\t\tparameterPositions, sampleValues, sampleSize, resultBuffer ) {\r\n\r\n\tTHREE.Interpolant.call(\r\n\t\t\tthis, parameterPositions, sampleValues, sampleSize, resultBuffer );\r\n\r\n};\r\n\r\nTHREE.LinearInterpolant.prototype =\r\n\t\tObject.assign( Object.create( THREE.Interpolant.prototype ), {\r\n\r\n\tconstructor: THREE.LinearInterpolant,\r\n\r\n\tinterpolate_: function( i1, t0, t, t1 ) {\r\n\r\n\t\tvar result = this.resultBuffer,\r\n\t\t\tvalues = this.sampleValues,\r\n\t\t\tstride = this.valueSize,\r\n\r\n\t\t\toffset1 = i1 * stride,\r\n\t\t\toffset0 = offset1 - stride,\r\n\r\n\t\t\tweight1 = ( t - t0 ) / ( t1 - t0 ),\r\n\t\t\tweight0 = 1 - weight1;\r\n\r\n\t\tfor ( var i = 0; i !== stride; ++ i ) {\r\n\r\n\t\t\tresult[ i ] =\r\n\t\t\t\t\tvalues[ offset0 + i ] * weight0 +\r\n\t\t\t\t\tvalues[ offset1 + i ] * weight1;\r\n\r\n\t\t}\r\n\r\n\t\treturn result;\r\n\r\n\t}\r\n\r\n} );\r\n\r\n// File:src/math/interpolants/QuaternionLinearInterpolant.js\r\n\r\n/**\r\n * Spherical linear unit quaternion interpolant.\r\n *\r\n * @author tschw\r\n */\r\n\r\nTHREE.QuaternionLinearInterpolant = function(\r\n\t\tparameterPositions, sampleValues, sampleSize, resultBuffer ) {\r\n\r\n\tTHREE.Interpolant.call(\r\n\t\t\tthis, parameterPositions, sampleValues, sampleSize, resultBuffer );\r\n\r\n};\r\n\r\nTHREE.QuaternionLinearInterpolant.prototype =\r\n\t\tObject.assign( Object.create( THREE.Interpolant.prototype ), {\r\n\r\n\tconstructor: THREE.QuaternionLinearInterpolant,\r\n\r\n\tinterpolate_: function( i1, t0, t, t1 ) {\r\n\r\n\t\tvar result = this.resultBuffer,\r\n\t\t\tvalues = this.sampleValues,\r\n\t\t\tstride = this.valueSize,\r\n\r\n\t\t\toffset = i1 * stride,\r\n\r\n\t\t\talpha = ( t - t0 ) / ( t1 - t0 );\r\n\r\n\t\tfor ( var end = offset + stride; offset !== end; offset += 4 ) {\r\n\r\n\t\t\tTHREE.Quaternion.slerpFlat( result, 0,\r\n\t\t\t\t\tvalues, offset - stride, values, offset, alpha );\r\n\r\n\t\t}\r\n\r\n\t\treturn result;\r\n\r\n\t}\r\n\r\n} );\r\n\r\n// File:src/core/Clock.js\r\n\r\n/**\r\n * @author alteredq / http://alteredqualia.com/\r\n */\r\n\r\nTHREE.Clock = function ( autoStart ) {\r\n\r\n\tthis.autoStart = ( autoStart !== undefined ) ? autoStart : true;\r\n\r\n\tthis.startTime = 0;\r\n\tthis.oldTime = 0;\r\n\tthis.elapsedTime = 0;\r\n\r\n\tthis.running = false;\r\n\r\n};\r\n\r\nTHREE.Clock.prototype = {\r\n\r\n\tconstructor: THREE.Clock,\r\n\r\n\tstart: function () {\r\n\r\n\t\tthis.startTime = ( performance || Date ).now();\r\n\r\n\t\tthis.oldTime = this.startTime;\r\n\t\tthis.running = true;\r\n\r\n\t},\r\n\r\n\tstop: function () {\r\n\r\n\t\tthis.getElapsedTime();\r\n\t\tthis.running = false;\r\n\r\n\t},\r\n\r\n\tgetElapsedTime: function () {\r\n\r\n\t\tthis.getDelta();\r\n\t\treturn this.elapsedTime;\r\n\r\n\t},\r\n\r\n\tgetDelta: function () {\r\n\r\n\t\tvar diff = 0;\r\n\r\n\t\tif ( this.autoStart && ! this.running ) {\r\n\r\n\t\t\tthis.start();\r\n\r\n\t\t}\r\n\r\n\t\tif ( this.running ) {\r\n\r\n\t\t\tvar newTime = ( performance || Date ).now();\r\n\r\n\t\t\tdiff = ( newTime - this.oldTime ) / 1000;\r\n\t\t\tthis.oldTime = newTime;\r\n\r\n\t\t\tthis.elapsedTime += diff;\r\n\r\n\t\t}\r\n\r\n\t\treturn diff;\r\n\r\n\t}\r\n\r\n};\r\n\r\n// File:src/core/EventDispatcher.js\r\n\r\n/**\r\n * https://github.com/mrdoob/eventdispatcher.js/\r\n */\r\n\r\nTHREE.EventDispatcher = function () {};\r\n\r\nTHREE.EventDispatcher.prototype = {\r\n\r\n\tconstructor: THREE.EventDispatcher,\r\n\r\n\tapply: function ( object ) {\r\n\r\n\t\tobject.addEventListener = THREE.EventDispatcher.prototype.addEventListener;\r\n\t\tobject.hasEventListener = THREE.EventDispatcher.prototype.hasEventListener;\r\n\t\tobject.removeEventListener = THREE.EventDispatcher.prototype.removeEventListener;\r\n\t\tobject.dispatchEvent = THREE.EventDispatcher.prototype.dispatchEvent;\r\n\r\n\t},\r\n\r\n\taddEventListener: function ( type, listener ) {\r\n\r\n\t\tif ( this._listeners === undefined ) this._listeners = {};\r\n\r\n\t\tvar listeners = this._listeners;\r\n\r\n\t\tif ( listeners[ type ] === undefined ) {\r\n\r\n\t\t\tlisteners[ type ] = [];\r\n\r\n\t\t}\r\n\r\n\t\tif ( listeners[ type ].indexOf( listener ) === - 1 ) {\r\n\r\n\t\t\tlisteners[ type ].push( listener );\r\n\r\n\t\t}\r\n\r\n\t},\r\n\r\n\thasEventListener: function ( type, listener ) {\r\n\r\n\t\tif ( this._listeners === undefined ) return false;\r\n\r\n\t\tvar listeners = this._listeners;\r\n\r\n\t\tif ( listeners[ type ] !== undefined && listeners[ type ].indexOf( listener ) !== - 1 ) {\r\n\r\n\t\t\treturn true;\r\n\r\n\t\t}\r\n\r\n\t\treturn false;\r\n\r\n\t},\r\n\r\n\tremoveEventListener: function ( type, listener ) {\r\n\r\n\t\tif ( this._listeners === undefined ) return;\r\n\r\n\t\tvar listeners = this._listeners;\r\n\t\tvar listenerArray = listeners[ type ];\r\n\r\n\t\tif ( listenerArray !== undefined ) {\r\n\r\n\t\t\tvar index = listenerArray.indexOf( listener );\r\n\r\n\t\t\tif ( index !== - 1 ) {\r\n\r\n\t\t\t\tlistenerArray.splice( index, 1 );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t},\r\n\r\n\tdispatchEvent: function ( event ) {\r\n\r\n\t\tif ( this._listeners === undefined ) return;\r\n\r\n\t\tvar listeners = this._listeners;\r\n\t\tvar listenerArray = listeners[ event.type ];\r\n\r\n\t\tif ( listenerArray !== undefined ) {\r\n\r\n\t\t\tevent.target = this;\r\n\r\n\t\t\tvar array = [];\r\n\t\t\tvar length = listenerArray.length;\r\n\r\n\t\t\tfor ( var i = 0; i < length; i ++ ) {\r\n\r\n\t\t\t\tarray[ i ] = listenerArray[ i ];\r\n\r\n\t\t\t}\r\n\r\n\t\t\tfor ( var i = 0; i < length; i ++ ) {\r\n\r\n\t\t\t\tarray[ i ].call( this, event );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n};\r\n\r\n// File:src/core/Layers.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.Layers = function () {\r\n\r\n\tthis.mask = 1;\r\n\r\n};\r\n\r\nTHREE.Layers.prototype = {\r\n\r\n\tconstructor: THREE.Layers,\r\n\r\n\tset: function ( channel ) {\r\n\r\n\t\tthis.mask = 1 << channel;\r\n\r\n\t},\r\n\r\n\tenable: function ( channel ) {\r\n\r\n\t\tthis.mask |= 1 << channel;\r\n\r\n\t},\r\n\r\n\ttoggle: function ( channel ) {\r\n\r\n\t\tthis.mask ^= 1 << channel;\r\n\r\n\t},\r\n\r\n\tdisable: function ( channel ) {\r\n\r\n\t\tthis.mask &= ~ ( 1 << channel );\r\n\r\n\t},\r\n\r\n\ttest: function ( layers ) {\r\n\r\n\t\treturn ( this.mask & layers.mask ) !== 0;\r\n\r\n\t}\r\n\r\n};\r\n\r\n// File:src/core/Raycaster.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author bhouston / http://clara.io/\r\n * @author stephomi / http://stephaneginier.com/\r\n */\r\n\r\n( function ( THREE ) {\r\n\r\n\tTHREE.Raycaster = function ( origin, direction, near, far ) {\r\n\r\n\t\tthis.ray = new THREE.Ray( origin, direction );\r\n\t\t// direction is assumed to be normalized (for accurate distance calculations)\r\n\r\n\t\tthis.near = near || 0;\r\n\t\tthis.far = far || Infinity;\r\n\r\n\t\tthis.params = {\r\n\t\t\tMesh: {},\r\n\t\t\tLine: {},\r\n\t\t\tLOD: {},\r\n\t\t\tPoints: { threshold: 1 },\r\n\t\t\tSprite: {}\r\n\t\t};\r\n\r\n\t\tObject.defineProperties( this.params, {\r\n\t\t\tPointCloud: {\r\n\t\t\t\tget: function () {\r\n\t\t\t\t\tconsole.warn( 'THREE.Raycaster: params.PointCloud has been renamed to params.Points.' );\r\n\t\t\t\t\treturn this.Points;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t} );\r\n\r\n\t};\r\n\r\n\tfunction ascSort( a, b ) {\r\n\r\n\t\treturn a.distance - b.distance;\r\n\r\n\t}\r\n\r\n\tfunction intersectObject( object, raycaster, intersects, recursive ) {\r\n\r\n\t\tif ( object.visible === false ) return;\r\n\r\n\t\tobject.raycast( raycaster, intersects );\r\n\r\n\t\tif ( recursive === true ) {\r\n\r\n\t\t\tvar children = object.children;\r\n\r\n\t\t\tfor ( var i = 0, l = children.length; i < l; i ++ ) {\r\n\r\n\t\t\t\tintersectObject( children[ i ], raycaster, intersects, true );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t//\r\n\r\n\tTHREE.Raycaster.prototype = {\r\n\r\n\t\tconstructor: THREE.Raycaster,\r\n\r\n\t\tlinePrecision: 1,\r\n\r\n\t\tset: function ( origin, direction ) {\r\n\r\n\t\t\t// direction is assumed to be normalized (for accurate distance calculations)\r\n\r\n\t\t\tthis.ray.set( origin, direction );\r\n\r\n\t\t},\r\n\r\n\t\tsetFromCamera: function ( coords, camera ) {\r\n\r\n\t\t\tif ( camera instanceof THREE.PerspectiveCamera ) {\r\n\r\n\t\t\t\tthis.ray.origin.setFromMatrixPosition( camera.matrixWorld );\r\n\t\t\t\tthis.ray.direction.set( coords.x, coords.y, 0.5 ).unproject( camera ).sub( this.ray.origin ).normalize();\r\n\r\n\t\t\t} else if ( camera instanceof THREE.OrthographicCamera ) {\r\n\r\n\t\t\t\tthis.ray.origin.set( coords.x, coords.y, - 1 ).unproject( camera );\r\n\t\t\t\tthis.ray.direction.set( 0, 0, - 1 ).transformDirection( camera.matrixWorld );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tconsole.error( 'THREE.Raycaster: Unsupported camera type.' );\r\n\r\n\t\t\t}\r\n\r\n\t\t},\r\n\r\n\t\tintersectObject: function ( object, recursive ) {\r\n\r\n\t\t\tvar intersects = [];\r\n\r\n\t\t\tintersectObject( object, this, intersects, recursive );\r\n\r\n\t\t\tintersects.sort( ascSort );\r\n\r\n\t\t\treturn intersects;\r\n\r\n\t\t},\r\n\r\n\t\tintersectObjects: function ( objects, recursive ) {\r\n\r\n\t\t\tvar intersects = [];\r\n\r\n\t\t\tif ( Array.isArray( objects ) === false ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.Raycaster.intersectObjects: objects is not an Array.' );\r\n\t\t\t\treturn intersects;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tfor ( var i = 0, l = objects.length; i < l; i ++ ) {\r\n\r\n\t\t\t\tintersectObject( objects[ i ], this, intersects, recursive );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tintersects.sort( ascSort );\r\n\r\n\t\t\treturn intersects;\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n}( THREE ) );\r\n\r\n// File:src/core/Object3D.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author mikael emtinger / http://gomo.se/\r\n * @author alteredq / http://alteredqualia.com/\r\n * @author WestLangley / http://github.com/WestLangley\r\n * @author elephantatwork / www.elephantatwork.ch\r\n */\r\n\r\nTHREE.Object3D = function () {\r\n\r\n\tObject.defineProperty( this, 'id', { value: THREE.Object3DIdCount ++ } );\r\n\r\n\tthis.uuid = THREE.Math.generateUUID();\r\n\r\n\tthis.name = '';\r\n\tthis.type = 'Object3D';\r\n\r\n\tthis.parent = null;\r\n\tthis.children = [];\r\n\r\n\tthis.up = THREE.Object3D.DefaultUp.clone();\r\n\r\n\tvar position = new THREE.Vector3();\r\n\tvar rotation = new THREE.Euler();\r\n\tvar quaternion = new THREE.Quaternion();\r\n\tvar scale = new THREE.Vector3( 1, 1, 1 );\r\n\r\n\tfunction onRotationChange() {\r\n\r\n\t\tquaternion.setFromEuler( rotation, false );\r\n\r\n\t}\r\n\r\n\tfunction onQuaternionChange() {\r\n\r\n\t\trotation.setFromQuaternion( quaternion, undefined, false );\r\n\r\n\t}\r\n\r\n\trotation.onChange( onRotationChange );\r\n\tquaternion.onChange( onQuaternionChange );\r\n\r\n\tObject.defineProperties( this, {\r\n\t\tposition: {\r\n\t\t\tenumerable: true,\r\n\t\t\tvalue: position\r\n\t\t},\r\n\t\trotation: {\r\n\t\t\tenumerable: true,\r\n\t\t\tvalue: rotation\r\n\t\t},\r\n\t\tquaternion: {\r\n\t\t\tenumerable: true,\r\n\t\t\tvalue: quaternion\r\n\t\t},\r\n\t\tscale: {\r\n\t\t\tenumerable: true,\r\n\t\t\tvalue: scale\r\n\t\t},\r\n\t\tmodelViewMatrix: {\r\n\t\t\tvalue: new THREE.Matrix4()\r\n\t\t},\r\n\t\tnormalMatrix: {\r\n\t\t\tvalue: new THREE.Matrix3()\r\n\t\t}\r\n\t} );\r\n\r\n\tthis.rotationAutoUpdate = true;\r\n\r\n\tthis.matrix = new THREE.Matrix4();\r\n\tthis.matrixWorld = new THREE.Matrix4();\r\n\r\n\tthis.matrixAutoUpdate = THREE.Object3D.DefaultMatrixAutoUpdate;\r\n\tthis.matrixWorldNeedsUpdate = false;\r\n\r\n\tthis.layers = new THREE.Layers();\r\n\tthis.visible = true;\r\n\r\n\tthis.castShadow = false;\r\n\tthis.receiveShadow = false;\r\n\r\n\tthis.frustumCulled = true;\r\n\tthis.renderOrder = 0;\r\n\r\n\tthis.userData = {};\r\n\r\n};\r\n\r\nTHREE.Object3D.DefaultUp = new THREE.Vector3( 0, 1, 0 );\r\nTHREE.Object3D.DefaultMatrixAutoUpdate = true;\r\n\r\nTHREE.Object3D.prototype = {\r\n\r\n\tconstructor: THREE.Object3D,\r\n\r\n\tapplyMatrix: function ( matrix ) {\r\n\r\n\t\tthis.matrix.multiplyMatrices( matrix, this.matrix );\r\n\r\n\t\tthis.matrix.decompose( this.position, this.quaternion, this.scale );\r\n\r\n\t},\r\n\r\n\tsetRotationFromAxisAngle: function ( axis, angle ) {\r\n\r\n\t\t// assumes axis is normalized\r\n\r\n\t\tthis.quaternion.setFromAxisAngle( axis, angle );\r\n\r\n\t},\r\n\r\n\tsetRotationFromEuler: function ( euler ) {\r\n\r\n\t\tthis.quaternion.setFromEuler( euler, true );\r\n\r\n\t},\r\n\r\n\tsetRotationFromMatrix: function ( m ) {\r\n\r\n\t\t// assumes the upper 3x3 of m is a pure rotation matrix (i.e, unscaled)\r\n\r\n\t\tthis.quaternion.setFromRotationMatrix( m );\r\n\r\n\t},\r\n\r\n\tsetRotationFromQuaternion: function ( q ) {\r\n\r\n\t\t// assumes q is normalized\r\n\r\n\t\tthis.quaternion.copy( q );\r\n\r\n\t},\r\n\r\n\trotateOnAxis: function () {\r\n\r\n\t\t// rotate object on axis in object space\r\n\t\t// axis is assumed to be normalized\r\n\r\n\t\tvar q1 = new THREE.Quaternion();\r\n\r\n\t\treturn function ( axis, angle ) {\r\n\r\n\t\t\tq1.setFromAxisAngle( axis, angle );\r\n\r\n\t\t\tthis.quaternion.multiply( q1 );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\trotateX: function () {\r\n\r\n\t\tvar v1 = new THREE.Vector3( 1, 0, 0 );\r\n\r\n\t\treturn function ( angle ) {\r\n\r\n\t\t\treturn this.rotateOnAxis( v1, angle );\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\trotateY: function () {\r\n\r\n\t\tvar v1 = new THREE.Vector3( 0, 1, 0 );\r\n\r\n\t\treturn function ( angle ) {\r\n\r\n\t\t\treturn this.rotateOnAxis( v1, angle );\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\trotateZ: function () {\r\n\r\n\t\tvar v1 = new THREE.Vector3( 0, 0, 1 );\r\n\r\n\t\treturn function ( angle ) {\r\n\r\n\t\t\treturn this.rotateOnAxis( v1, angle );\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\ttranslateOnAxis: function () {\r\n\r\n\t\t// translate object by distance along axis in object space\r\n\t\t// axis is assumed to be normalized\r\n\r\n\t\tvar v1 = new THREE.Vector3();\r\n\r\n\t\treturn function ( axis, distance ) {\r\n\r\n\t\t\tv1.copy( axis ).applyQuaternion( this.quaternion );\r\n\r\n\t\t\tthis.position.add( v1.multiplyScalar( distance ) );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\ttranslateX: function () {\r\n\r\n\t\tvar v1 = new THREE.Vector3( 1, 0, 0 );\r\n\r\n\t\treturn function ( distance ) {\r\n\r\n\t\t\treturn this.translateOnAxis( v1, distance );\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\ttranslateY: function () {\r\n\r\n\t\tvar v1 = new THREE.Vector3( 0, 1, 0 );\r\n\r\n\t\treturn function ( distance ) {\r\n\r\n\t\t\treturn this.translateOnAxis( v1, distance );\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\ttranslateZ: function () {\r\n\r\n\t\tvar v1 = new THREE.Vector3( 0, 0, 1 );\r\n\r\n\t\treturn function ( distance ) {\r\n\r\n\t\t\treturn this.translateOnAxis( v1, distance );\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\tlocalToWorld: function ( vector ) {\r\n\r\n\t\treturn vector.applyMatrix4( this.matrixWorld );\r\n\r\n\t},\r\n\r\n\tworldToLocal: function () {\r\n\r\n\t\tvar m1 = new THREE.Matrix4();\r\n\r\n\t\treturn function ( vector ) {\r\n\r\n\t\t\treturn vector.applyMatrix4( m1.getInverse( this.matrixWorld ) );\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\tlookAt: function () {\r\n\r\n\t\t// This routine does not support objects with rotated and/or translated parent(s)\r\n\r\n\t\tvar m1 = new THREE.Matrix4();\r\n\r\n\t\treturn function ( vector ) {\r\n\r\n\t\t\tm1.lookAt( vector, this.position, this.up );\r\n\r\n\t\t\tthis.quaternion.setFromRotationMatrix( m1 );\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\tadd: function ( object ) {\r\n\r\n\t\tif ( arguments.length > 1 ) {\r\n\r\n\t\t\tfor ( var i = 0; i < arguments.length; i ++ ) {\r\n\r\n\t\t\t\tthis.add( arguments[ i ] );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t}\r\n\r\n\t\tif ( object === this ) {\r\n\r\n\t\t\tconsole.error( \"THREE.Object3D.add: object can't be added as a child of itself.\", object );\r\n\t\t\treturn this;\r\n\r\n\t\t}\r\n\r\n\t\tif ( object instanceof THREE.Object3D ) {\r\n\r\n\t\t\tif ( object.parent !== null ) {\r\n\r\n\t\t\t\tobject.parent.remove( object );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tobject.parent = this;\r\n\t\t\tobject.dispatchEvent( { type: 'added' } );\r\n\r\n\t\t\tthis.children.push( object );\r\n\r\n\t\t} else {\r\n\r\n\t\t\tconsole.error( \"THREE.Object3D.add: object not an instance of THREE.Object3D.\", object );\r\n\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tremove: function ( object ) {\r\n\r\n\t\tif ( arguments.length > 1 ) {\r\n\r\n\t\t\tfor ( var i = 0; i < arguments.length; i ++ ) {\r\n\r\n\t\t\t\tthis.remove( arguments[ i ] );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tvar index = this.children.indexOf( object );\r\n\r\n\t\tif ( index !== - 1 ) {\r\n\r\n\t\t\tobject.parent = null;\r\n\r\n\t\t\tobject.dispatchEvent( { type: 'removed' } );\r\n\r\n\t\t\tthis.children.splice( index, 1 );\r\n\r\n\t\t}\r\n\r\n\t},\r\n\r\n\tgetObjectById: function ( id ) {\r\n\r\n\t\treturn this.getObjectByProperty( 'id', id );\r\n\r\n\t},\r\n\r\n\tgetObjectByName: function ( name ) {\r\n\r\n\t\treturn this.getObjectByProperty( 'name', name );\r\n\r\n\t},\r\n\r\n\tgetObjectByProperty: function ( name, value ) {\r\n\r\n\t\tif ( this[ name ] === value ) return this;\r\n\r\n\t\tfor ( var i = 0, l = this.children.length; i < l; i ++ ) {\r\n\r\n\t\t\tvar child = this.children[ i ];\r\n\t\t\tvar object = child.getObjectByProperty( name, value );\r\n\r\n\t\t\tif ( object !== undefined ) {\r\n\r\n\t\t\t\treturn object;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\treturn undefined;\r\n\r\n\t},\r\n\r\n\tgetWorldPosition: function ( optionalTarget ) {\r\n\r\n\t\tvar result = optionalTarget || new THREE.Vector3();\r\n\r\n\t\tthis.updateMatrixWorld( true );\r\n\r\n\t\treturn result.setFromMatrixPosition( this.matrixWorld );\r\n\r\n\t},\r\n\r\n\tgetWorldQuaternion: function () {\r\n\r\n\t\tvar position = new THREE.Vector3();\r\n\t\tvar scale = new THREE.Vector3();\r\n\r\n\t\treturn function ( optionalTarget ) {\r\n\r\n\t\t\tvar result = optionalTarget || new THREE.Quaternion();\r\n\r\n\t\t\tthis.updateMatrixWorld( true );\r\n\r\n\t\t\tthis.matrixWorld.decompose( position, result, scale );\r\n\r\n\t\t\treturn result;\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\tgetWorldRotation: function () {\r\n\r\n\t\tvar quaternion = new THREE.Quaternion();\r\n\r\n\t\treturn function ( optionalTarget ) {\r\n\r\n\t\t\tvar result = optionalTarget || new THREE.Euler();\r\n\r\n\t\t\tthis.getWorldQuaternion( quaternion );\r\n\r\n\t\t\treturn result.setFromQuaternion( quaternion, this.rotation.order, false );\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\tgetWorldScale: function () {\r\n\r\n\t\tvar position = new THREE.Vector3();\r\n\t\tvar quaternion = new THREE.Quaternion();\r\n\r\n\t\treturn function ( optionalTarget ) {\r\n\r\n\t\t\tvar result = optionalTarget || new THREE.Vector3();\r\n\r\n\t\t\tthis.updateMatrixWorld( true );\r\n\r\n\t\t\tthis.matrixWorld.decompose( position, quaternion, result );\r\n\r\n\t\t\treturn result;\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\tgetWorldDirection: function () {\r\n\r\n\t\tvar quaternion = new THREE.Quaternion();\r\n\r\n\t\treturn function ( optionalTarget ) {\r\n\r\n\t\t\tvar result = optionalTarget || new THREE.Vector3();\r\n\r\n\t\t\tthis.getWorldQuaternion( quaternion );\r\n\r\n\t\t\treturn result.set( 0, 0, 1 ).applyQuaternion( quaternion );\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\traycast: function () {},\r\n\r\n\ttraverse: function ( callback ) {\r\n\r\n\t\tcallback( this );\r\n\r\n\t\tvar children = this.children;\r\n\r\n\t\tfor ( var i = 0, l = children.length; i < l; i ++ ) {\r\n\r\n\t\t\tchildren[ i ].traverse( callback );\r\n\r\n\t\t}\r\n\r\n\t},\r\n\r\n\ttraverseVisible: function ( callback ) {\r\n\r\n\t\tif ( this.visible === false ) return;\r\n\r\n\t\tcallback( this );\r\n\r\n\t\tvar children = this.children;\r\n\r\n\t\tfor ( var i = 0, l = children.length; i < l; i ++ ) {\r\n\r\n\t\t\tchildren[ i ].traverseVisible( callback );\r\n\r\n\t\t}\r\n\r\n\t},\r\n\r\n\ttraverseAncestors: function ( callback ) {\r\n\r\n\t\tvar parent = this.parent;\r\n\r\n\t\tif ( parent !== null ) {\r\n\r\n\t\t\tcallback( parent );\r\n\r\n\t\t\tparent.traverseAncestors( callback );\r\n\r\n\t\t}\r\n\r\n\t},\r\n\r\n\tupdateMatrix: function () {\r\n\r\n\t\tthis.matrix.compose( this.position, this.quaternion, this.scale );\r\n\r\n\t\tthis.matrixWorldNeedsUpdate = true;\r\n\r\n\t},\r\n\r\n\tupdateMatrixWorld: function ( force ) {\r\n\r\n\t\tif ( this.matrixAutoUpdate === true ) this.updateMatrix();\r\n\r\n\t\tif ( this.matrixWorldNeedsUpdate === true || force === true ) {\r\n\r\n\t\t\tif ( this.parent === null ) {\r\n\r\n\t\t\t\tthis.matrixWorld.copy( this.matrix );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tthis.matrixWorld.multiplyMatrices( this.parent.matrixWorld, this.matrix );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tthis.matrixWorldNeedsUpdate = false;\r\n\r\n\t\t\tforce = true;\r\n\r\n\t\t}\r\n\r\n\t\t// update children\r\n\r\n\t\tfor ( var i = 0, l = this.children.length; i < l; i ++ ) {\r\n\r\n\t\t\tthis.children[ i ].updateMatrixWorld( force );\r\n\r\n\t\t}\r\n\r\n\t},\r\n\r\n\ttoJSON: function ( meta ) {\r\n\r\n\t\t// meta is '' when called from JSON.stringify\r\n\t\tvar isRootObject = ( meta === undefined || meta === '' );\r\n\r\n\t\tvar output = {};\r\n\r\n\t\t// meta is a hash used to collect geometries, materials.\r\n\t\t// not providing it implies that this is the root object\r\n\t\t// being serialized.\r\n\t\tif ( isRootObject ) {\r\n\r\n\t\t\t// initialize meta obj\r\n\t\t\tmeta = {\r\n\t\t\t\tgeometries: {},\r\n\t\t\t\tmaterials: {},\r\n\t\t\t\ttextures: {},\r\n\t\t\t\timages: {}\r\n\t\t\t};\r\n\r\n\t\t\toutput.metadata = {\r\n\t\t\t\tversion: 4.4,\r\n\t\t\t\ttype: 'Object',\r\n\t\t\t\tgenerator: 'Object3D.toJSON'\r\n\t\t\t};\r\n\r\n\t\t}\r\n\r\n\t\t// standard Object3D serialization\r\n\r\n\t\tvar object = {};\r\n\r\n\t\tobject.uuid = this.uuid;\r\n\t\tobject.type = this.type;\r\n\r\n\t\tif ( this.name !== '' ) object.name = this.name;\r\n\t\tif ( JSON.stringify( this.userData ) !== '{}' ) object.userData = this.userData;\r\n\t\tif ( this.castShadow === true ) object.castShadow = true;\r\n\t\tif ( this.receiveShadow === true ) object.receiveShadow = true;\r\n\t\tif ( this.visible === false ) object.visible = false;\r\n\r\n\t\tobject.matrix = this.matrix.toArray();\r\n\r\n\t\t//\r\n\r\n\t\tif ( this.geometry !== undefined ) {\r\n\r\n\t\t\tif ( meta.geometries[ this.geometry.uuid ] === undefined ) {\r\n\r\n\t\t\t\tmeta.geometries[ this.geometry.uuid ] = this.geometry.toJSON( meta );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tobject.geometry = this.geometry.uuid;\r\n\r\n\t\t}\r\n\r\n\t\tif ( this.material !== undefined ) {\r\n\r\n\t\t\tif ( meta.materials[ this.material.uuid ] === undefined ) {\r\n\r\n\t\t\t\tmeta.materials[ this.material.uuid ] = this.material.toJSON( meta );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tobject.material = this.material.uuid;\r\n\r\n\t\t}\r\n\r\n\t\t//\r\n\r\n\t\tif ( this.children.length > 0 ) {\r\n\r\n\t\t\tobject.children = [];\r\n\r\n\t\t\tfor ( var i = 0; i < this.children.length; i ++ ) {\r\n\r\n\t\t\t\tobject.children.push( this.children[ i ].toJSON( meta ).object );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tif ( isRootObject ) {\r\n\r\n\t\t\tvar geometries = extractFromCache( meta.geometries );\r\n\t\t\tvar materials = extractFromCache( meta.materials );\r\n\t\t\tvar textures = extractFromCache( meta.textures );\r\n\t\t\tvar images = extractFromCache( meta.images );\r\n\r\n\t\t\tif ( geometries.length > 0 ) output.geometries = geometries;\r\n\t\t\tif ( materials.length > 0 ) output.materials = materials;\r\n\t\t\tif ( textures.length > 0 ) output.textures = textures;\r\n\t\t\tif ( images.length > 0 ) output.images = images;\r\n\r\n\t\t}\r\n\r\n\t\toutput.object = object;\r\n\r\n\t\treturn output;\r\n\r\n\t\t// extract data from the cache hash\r\n\t\t// remove metadata on each item\r\n\t\t// and return as array\r\n\t\tfunction extractFromCache ( cache ) {\r\n\r\n\t\t\tvar values = [];\r\n\t\t\tfor ( var key in cache ) {\r\n\r\n\t\t\t\tvar data = cache[ key ];\r\n\t\t\t\tdelete data.metadata;\r\n\t\t\t\tvalues.push( data );\r\n\r\n\t\t\t}\r\n\t\t\treturn values;\r\n\r\n\t\t}\r\n\r\n\t},\r\n\r\n\tclone: function ( recursive ) {\r\n\r\n\t\treturn new this.constructor().copy( this, recursive );\r\n\r\n\t},\r\n\r\n\tcopy: function ( source, recursive ) {\r\n\r\n\t\tif ( recursive === undefined ) recursive = true;\r\n\r\n\t\tthis.name = source.name;\r\n\r\n\t\tthis.up.copy( source.up );\r\n\r\n\t\tthis.position.copy( source.position );\r\n\t\tthis.quaternion.copy( source.quaternion );\r\n\t\tthis.scale.copy( source.scale );\r\n\r\n\t\tthis.rotationAutoUpdate = source.rotationAutoUpdate;\r\n\r\n\t\tthis.matrix.copy( source.matrix );\r\n\t\tthis.matrixWorld.copy( source.matrixWorld );\r\n\r\n\t\tthis.matrixAutoUpdate = source.matrixAutoUpdate;\r\n\t\tthis.matrixWorldNeedsUpdate = source.matrixWorldNeedsUpdate;\r\n\r\n\t\tthis.visible = source.visible;\r\n\r\n\t\tthis.castShadow = source.castShadow;\r\n\t\tthis.receiveShadow = source.receiveShadow;\r\n\r\n\t\tthis.frustumCulled = source.frustumCulled;\r\n\t\tthis.renderOrder = source.renderOrder;\r\n\r\n\t\tthis.userData = JSON.parse( JSON.stringify( source.userData ) );\r\n\r\n\t\tif ( recursive === true ) {\r\n\r\n\t\t\tfor ( var i = 0; i < source.children.length; i ++ ) {\r\n\r\n\t\t\t\tvar child = source.children[ i ];\r\n\t\t\t\tthis.add( child.clone() );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\r\n\t}\r\n\r\n};\r\n\r\nTHREE.EventDispatcher.prototype.apply( THREE.Object3D.prototype );\r\n\r\nTHREE.Object3DIdCount = 0;\r\n\r\n// File:src/core/Face3.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author alteredq / http://alteredqualia.com/\r\n */\r\n\r\nTHREE.Face3 = function ( a, b, c, normal, color, materialIndex ) {\r\n\r\n\tthis.a = a;\r\n\tthis.b = b;\r\n\tthis.c = c;\r\n\r\n\tthis.normal = normal instanceof THREE.Vector3 ? normal : new THREE.Vector3();\r\n\tthis.vertexNormals = Array.isArray( normal ) ? normal : [];\r\n\r\n\tthis.color = color instanceof THREE.Color ? color : new THREE.Color();\r\n\tthis.vertexColors = Array.isArray( color ) ? color : [];\r\n\r\n\tthis.materialIndex = materialIndex !== undefined ? materialIndex : 0;\r\n\r\n};\r\n\r\nTHREE.Face3.prototype = {\r\n\r\n\tconstructor: THREE.Face3,\r\n\r\n\tclone: function () {\r\n\r\n\t\treturn new this.constructor().copy( this );\r\n\r\n\t},\r\n\r\n\tcopy: function ( source ) {\r\n\r\n\t\tthis.a = source.a;\r\n\t\tthis.b = source.b;\r\n\t\tthis.c = source.c;\r\n\r\n\t\tthis.normal.copy( source.normal );\r\n\t\tthis.color.copy( source.color );\r\n\r\n\t\tthis.materialIndex = source.materialIndex;\r\n\r\n\t\tfor ( var i = 0, il = source.vertexNormals.length; i < il; i ++ ) {\r\n\r\n\t\t\tthis.vertexNormals[ i ] = source.vertexNormals[ i ].clone();\r\n\r\n\t\t}\r\n\r\n\t\tfor ( var i = 0, il = source.vertexColors.length; i < il; i ++ ) {\r\n\r\n\t\t\tthis.vertexColors[ i ] = source.vertexColors[ i ].clone();\r\n\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\r\n\t}\r\n\r\n};\r\n\r\n// File:src/core/BufferAttribute.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.BufferAttribute = function ( array, itemSize, normalized ) {\r\n\r\n\tthis.uuid = THREE.Math.generateUUID();\r\n\r\n\tthis.array = array;\r\n\tthis.itemSize = itemSize;\r\n\r\n\tthis.dynamic = false;\r\n\tthis.updateRange = { offset: 0, count: - 1 };\r\n\r\n\tthis.version = 0;\r\n\tthis.normalized = normalized === true;\r\n\r\n};\r\n\r\nTHREE.BufferAttribute.prototype = {\r\n\r\n\tconstructor: THREE.BufferAttribute,\r\n\r\n\tget count() {\r\n\r\n\t\treturn this.array.length / this.itemSize;\r\n\r\n\t},\r\n\r\n\tset needsUpdate( value ) {\r\n\r\n\t\tif ( value === true ) this.version ++;\r\n\r\n\t},\r\n\r\n\tsetDynamic: function ( value ) {\r\n\r\n\t\tthis.dynamic = value;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tcopy: function ( source ) {\r\n\r\n\t\tthis.array = new source.array.constructor( source.array );\r\n\t\tthis.itemSize = source.itemSize;\r\n\r\n\t\tthis.dynamic = source.dynamic;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tcopyAt: function ( index1, attribute, index2 ) {\r\n\r\n\t\tindex1 *= this.itemSize;\r\n\t\tindex2 *= attribute.itemSize;\r\n\r\n\t\tfor ( var i = 0, l = this.itemSize; i < l; i ++ ) {\r\n\r\n\t\t\tthis.array[ index1 + i ] = attribute.array[ index2 + i ];\r\n\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tcopyArray: function ( array ) {\r\n\r\n\t\tthis.array.set( array );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tcopyColorsArray: function ( colors ) {\r\n\r\n\t\tvar array = this.array, offset = 0;\r\n\r\n\t\tfor ( var i = 0, l = colors.length; i < l; i ++ ) {\r\n\r\n\t\t\tvar color = colors[ i ];\r\n\r\n\t\t\tif ( color === undefined ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.BufferAttribute.copyColorsArray(): color is undefined', i );\r\n\t\t\t\tcolor = new THREE.Color();\r\n\r\n\t\t\t}\r\n\r\n\t\t\tarray[ offset ++ ] = color.r;\r\n\t\t\tarray[ offset ++ ] = color.g;\r\n\t\t\tarray[ offset ++ ] = color.b;\r\n\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tcopyIndicesArray: function ( indices ) {\r\n\r\n\t\tvar array = this.array, offset = 0;\r\n\r\n\t\tfor ( var i = 0, l = indices.length; i < l; i ++ ) {\r\n\r\n\t\t\tvar index = indices[ i ];\r\n\r\n\t\t\tarray[ offset ++ ] = index.a;\r\n\t\t\tarray[ offset ++ ] = index.b;\r\n\t\t\tarray[ offset ++ ] = index.c;\r\n\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tcopyVector2sArray: function ( vectors ) {\r\n\r\n\t\tvar array = this.array, offset = 0;\r\n\r\n\t\tfor ( var i = 0, l = vectors.length; i < l; i ++ ) {\r\n\r\n\t\t\tvar vector = vectors[ i ];\r\n\r\n\t\t\tif ( vector === undefined ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.BufferAttribute.copyVector2sArray(): vector is undefined', i );\r\n\t\t\t\tvector = new THREE.Vector2();\r\n\r\n\t\t\t}\r\n\r\n\t\t\tarray[ offset ++ ] = vector.x;\r\n\t\t\tarray[ offset ++ ] = vector.y;\r\n\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tcopyVector3sArray: function ( vectors ) {\r\n\r\n\t\tvar array = this.array, offset = 0;\r\n\r\n\t\tfor ( var i = 0, l = vectors.length; i < l; i ++ ) {\r\n\r\n\t\t\tvar vector = vectors[ i ];\r\n\r\n\t\t\tif ( vector === undefined ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.BufferAttribute.copyVector3sArray(): vector is undefined', i );\r\n\t\t\t\tvector = new THREE.Vector3();\r\n\r\n\t\t\t}\r\n\r\n\t\t\tarray[ offset ++ ] = vector.x;\r\n\t\t\tarray[ offset ++ ] = vector.y;\r\n\t\t\tarray[ offset ++ ] = vector.z;\r\n\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tcopyVector4sArray: function ( vectors ) {\r\n\r\n\t\tvar array = this.array, offset = 0;\r\n\r\n\t\tfor ( var i = 0, l = vectors.length; i < l; i ++ ) {\r\n\r\n\t\t\tvar vector = vectors[ i ];\r\n\r\n\t\t\tif ( vector === undefined ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.BufferAttribute.copyVector4sArray(): vector is undefined', i );\r\n\t\t\t\tvector = new THREE.Vector4();\r\n\r\n\t\t\t}\r\n\r\n\t\t\tarray[ offset ++ ] = vector.x;\r\n\t\t\tarray[ offset ++ ] = vector.y;\r\n\t\t\tarray[ offset ++ ] = vector.z;\r\n\t\t\tarray[ offset ++ ] = vector.w;\r\n\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tset: function ( value, offset ) {\r\n\r\n\t\tif ( offset === undefined ) offset = 0;\r\n\r\n\t\tthis.array.set( value, offset );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tgetX: function ( index ) {\r\n\r\n\t\treturn this.array[ index * this.itemSize ];\r\n\r\n\t},\r\n\r\n\tsetX: function ( index, x ) {\r\n\r\n\t\tthis.array[ index * this.itemSize ] = x;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tgetY: function ( index ) {\r\n\r\n\t\treturn this.array[ index * this.itemSize + 1 ];\r\n\r\n\t},\r\n\r\n\tsetY: function ( index, y ) {\r\n\r\n\t\tthis.array[ index * this.itemSize + 1 ] = y;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tgetZ: function ( index ) {\r\n\r\n\t\treturn this.array[ index * this.itemSize + 2 ];\r\n\r\n\t},\r\n\r\n\tsetZ: function ( index, z ) {\r\n\r\n\t\tthis.array[ index * this.itemSize + 2 ] = z;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tgetW: function ( index ) {\r\n\r\n\t\treturn this.array[ index * this.itemSize + 3 ];\r\n\r\n\t},\r\n\r\n\tsetW: function ( index, w ) {\r\n\r\n\t\tthis.array[ index * this.itemSize + 3 ] = w;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tsetXY: function ( index, x, y ) {\r\n\r\n\t\tindex *= this.itemSize;\r\n\r\n\t\tthis.array[ index + 0 ] = x;\r\n\t\tthis.array[ index + 1 ] = y;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tsetXYZ: function ( index, x, y, z ) {\r\n\r\n\t\tindex *= this.itemSize;\r\n\r\n\t\tthis.array[ index + 0 ] = x;\r\n\t\tthis.array[ index + 1 ] = y;\r\n\t\tthis.array[ index + 2 ] = z;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tsetXYZW: function ( index, x, y, z, w ) {\r\n\r\n\t\tindex *= this.itemSize;\r\n\r\n\t\tthis.array[ index + 0 ] = x;\r\n\t\tthis.array[ index + 1 ] = y;\r\n\t\tthis.array[ index + 2 ] = z;\r\n\t\tthis.array[ index + 3 ] = w;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tclone: function () {\r\n\r\n\t\treturn new this.constructor().copy( this );\r\n\r\n\t}\r\n\r\n};\r\n\r\n//\r\n\r\nTHREE.Int8Attribute = function ( array, itemSize ) {\r\n\r\n\treturn new THREE.BufferAttribute( new Int8Array( array ), itemSize );\r\n\r\n};\r\n\r\nTHREE.Uint8Attribute = function ( array, itemSize ) {\r\n\r\n\treturn new THREE.BufferAttribute( new Uint8Array( array ), itemSize );\r\n\r\n};\r\n\r\nTHREE.Uint8ClampedAttribute = function ( array, itemSize ) {\r\n\r\n\treturn new THREE.BufferAttribute( new Uint8ClampedArray( array ), itemSize );\r\n\r\n};\r\n\r\nTHREE.Int16Attribute = function ( array, itemSize ) {\r\n\r\n\treturn new THREE.BufferAttribute( new Int16Array( array ), itemSize );\r\n\r\n};\r\n\r\nTHREE.Uint16Attribute = function ( array, itemSize ) {\r\n\r\n\treturn new THREE.BufferAttribute( new Uint16Array( array ), itemSize );\r\n\r\n};\r\n\r\nTHREE.Int32Attribute = function ( array, itemSize ) {\r\n\r\n\treturn new THREE.BufferAttribute( new Int32Array( array ), itemSize );\r\n\r\n};\r\n\r\nTHREE.Uint32Attribute = function ( array, itemSize ) {\r\n\r\n\treturn new THREE.BufferAttribute( new Uint32Array( array ), itemSize );\r\n\r\n};\r\n\r\nTHREE.Float32Attribute = function ( array, itemSize ) {\r\n\r\n\treturn new THREE.BufferAttribute( new Float32Array( array ), itemSize );\r\n\r\n};\r\n\r\nTHREE.Float64Attribute = function ( array, itemSize ) {\r\n\r\n\treturn new THREE.BufferAttribute( new Float64Array( array ), itemSize );\r\n\r\n};\r\n\r\n\r\n// Deprecated\r\n\r\nTHREE.DynamicBufferAttribute = function ( array, itemSize ) {\r\n\r\n\tconsole.warn( 'THREE.DynamicBufferAttribute has been removed. Use new THREE.BufferAttribute().setDynamic( true ) instead.' );\r\n\treturn new THREE.BufferAttribute( array, itemSize ).setDynamic( true );\r\n\r\n};\r\n\r\n// File:src/core/InstancedBufferAttribute.js\r\n\r\n/**\r\n * @author benaadams / https://twitter.com/ben_a_adams\r\n */\r\n\r\nTHREE.InstancedBufferAttribute = function ( array, itemSize, meshPerAttribute ) {\r\n\r\n\tTHREE.BufferAttribute.call( this, array, itemSize );\r\n\r\n\tthis.meshPerAttribute = meshPerAttribute || 1;\r\n\r\n};\r\n\r\nTHREE.InstancedBufferAttribute.prototype = Object.create( THREE.BufferAttribute.prototype );\r\nTHREE.InstancedBufferAttribute.prototype.constructor = THREE.InstancedBufferAttribute;\r\n\r\nTHREE.InstancedBufferAttribute.prototype.copy = function ( source ) {\r\n\r\n\tTHREE.BufferAttribute.prototype.copy.call( this, source );\r\n\r\n\tthis.meshPerAttribute = source.meshPerAttribute;\r\n\r\n\treturn this;\r\n\r\n};\r\n\r\n// File:src/core/InterleavedBuffer.js\r\n\r\n/**\r\n * @author benaadams / https://twitter.com/ben_a_adams\r\n */\r\n\r\nTHREE.InterleavedBuffer = function ( array, stride ) {\r\n\r\n\tthis.uuid = THREE.Math.generateUUID();\r\n\r\n\tthis.array = array;\r\n\tthis.stride = stride;\r\n\r\n\tthis.dynamic = false;\r\n\tthis.updateRange = { offset: 0, count: - 1 };\r\n\r\n\tthis.version = 0;\r\n\r\n};\r\n\r\nTHREE.InterleavedBuffer.prototype = {\r\n\r\n\tconstructor: THREE.InterleavedBuffer,\r\n\r\n\tget length () {\r\n\r\n\t\treturn this.array.length;\r\n\r\n\t},\r\n\r\n\tget count () {\r\n\r\n\t\treturn this.array.length / this.stride;\r\n\r\n\t},\r\n\r\n\tset needsUpdate( value ) {\r\n\r\n\t\tif ( value === true ) this.version ++;\r\n\r\n\t},\r\n\r\n\tsetDynamic: function ( value ) {\r\n\r\n\t\tthis.dynamic = value;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tcopy: function ( source ) {\r\n\r\n\t\tthis.array = new source.array.constructor( source.array );\r\n\t\tthis.stride = source.stride;\r\n\t\tthis.dynamic = source.dynamic;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tcopyAt: function ( index1, attribute, index2 ) {\r\n\r\n\t\tindex1 *= this.stride;\r\n\t\tindex2 *= attribute.stride;\r\n\r\n\t\tfor ( var i = 0, l = this.stride; i < l; i ++ ) {\r\n\r\n\t\t\tthis.array[ index1 + i ] = attribute.array[ index2 + i ];\r\n\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tset: function ( value, offset ) {\r\n\r\n\t\tif ( offset === undefined ) offset = 0;\r\n\r\n\t\tthis.array.set( value, offset );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tclone: function () {\r\n\r\n\t\treturn new this.constructor().copy( this );\r\n\r\n\t}\r\n\r\n};\r\n\r\n// File:src/core/InstancedInterleavedBuffer.js\r\n\r\n/**\r\n * @author benaadams / https://twitter.com/ben_a_adams\r\n */\r\n\r\nTHREE.InstancedInterleavedBuffer = function ( array, stride, meshPerAttribute ) {\r\n\r\n\tTHREE.InterleavedBuffer.call( this, array, stride );\r\n\r\n\tthis.meshPerAttribute = meshPerAttribute || 1;\r\n\r\n};\r\n\r\nTHREE.InstancedInterleavedBuffer.prototype = Object.create( THREE.InterleavedBuffer.prototype );\r\nTHREE.InstancedInterleavedBuffer.prototype.constructor = THREE.InstancedInterleavedBuffer;\r\n\r\nTHREE.InstancedInterleavedBuffer.prototype.copy = function ( source ) {\r\n\r\n\tTHREE.InterleavedBuffer.prototype.copy.call( this, source );\r\n\r\n\tthis.meshPerAttribute = source.meshPerAttribute;\r\n\r\n\treturn this;\r\n\r\n};\r\n\r\n// File:src/core/InterleavedBufferAttribute.js\r\n\r\n/**\r\n * @author benaadams / https://twitter.com/ben_a_adams\r\n */\r\n\r\nTHREE.InterleavedBufferAttribute = function ( interleavedBuffer, itemSize, offset ) {\r\n\r\n\tthis.uuid = THREE.Math.generateUUID();\r\n\r\n\tthis.data = interleavedBuffer;\r\n\tthis.itemSize = itemSize;\r\n\tthis.offset = offset;\r\n\r\n};\r\n\r\n\r\nTHREE.InterleavedBufferAttribute.prototype = {\r\n\r\n\tconstructor: THREE.InterleavedBufferAttribute,\r\n\r\n\tget length() {\r\n\r\n\t\tconsole.warn( 'THREE.BufferAttribute: .length has been deprecated. Please use .count.' );\r\n\t\treturn this.array.length;\r\n\r\n\t},\r\n\r\n\tget count() {\r\n\r\n\t\treturn this.data.count;\r\n\r\n\t},\r\n\r\n\tsetX: function ( index, x ) {\r\n\r\n\t\tthis.data.array[ index * this.data.stride + this.offset ] = x;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tsetY: function ( index, y ) {\r\n\r\n\t\tthis.data.array[ index * this.data.stride + this.offset + 1 ] = y;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tsetZ: function ( index, z ) {\r\n\r\n\t\tthis.data.array[ index * this.data.stride + this.offset + 2 ] = z;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tsetW: function ( index, w ) {\r\n\r\n\t\tthis.data.array[ index * this.data.stride + this.offset + 3 ] = w;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tgetX: function ( index ) {\r\n\r\n\t\treturn this.data.array[ index * this.data.stride + this.offset ];\r\n\r\n\t},\r\n\r\n\tgetY: function ( index ) {\r\n\r\n\t\treturn this.data.array[ index * this.data.stride + this.offset + 1 ];\r\n\r\n\t},\r\n\r\n\tgetZ: function ( index ) {\r\n\r\n\t\treturn this.data.array[ index * this.data.stride + this.offset + 2 ];\r\n\r\n\t},\r\n\r\n\tgetW: function ( index ) {\r\n\r\n\t\treturn this.data.array[ index * this.data.stride + this.offset + 3 ];\r\n\r\n\t},\r\n\r\n\tsetXY: function ( index, x, y ) {\r\n\r\n\t\tindex = index * this.data.stride + this.offset;\r\n\r\n\t\tthis.data.array[ index + 0 ] = x;\r\n\t\tthis.data.array[ index + 1 ] = y;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tsetXYZ: function ( index, x, y, z ) {\r\n\r\n\t\tindex = index * this.data.stride + this.offset;\r\n\r\n\t\tthis.data.array[ index + 0 ] = x;\r\n\t\tthis.data.array[ index + 1 ] = y;\r\n\t\tthis.data.array[ index + 2 ] = z;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tsetXYZW: function ( index, x, y, z, w ) {\r\n\r\n\t\tindex = index * this.data.stride + this.offset;\r\n\r\n\t\tthis.data.array[ index + 0 ] = x;\r\n\t\tthis.data.array[ index + 1 ] = y;\r\n\t\tthis.data.array[ index + 2 ] = z;\r\n\t\tthis.data.array[ index + 3 ] = w;\r\n\r\n\t\treturn this;\r\n\r\n\t}\r\n\r\n};\r\n\r\n// File:src/core/Geometry.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author kile / http://kile.stravaganza.org/\r\n * @author alteredq / http://alteredqualia.com/\r\n * @author mikael emtinger / http://gomo.se/\r\n * @author zz85 / http://www.lab4games.net/zz85/blog\r\n * @author bhouston / http://clara.io\r\n */\r\n\r\nTHREE.Geometry = function () {\r\n\r\n\tObject.defineProperty( this, 'id', { value: THREE.GeometryIdCount ++ } );\r\n\r\n\tthis.uuid = THREE.Math.generateUUID();\r\n\r\n\tthis.name = '';\r\n\tthis.type = 'Geometry';\r\n\r\n\tthis.vertices = [];\r\n\tthis.colors = [];\r\n\tthis.faces = [];\r\n\tthis.faceVertexUvs = [ [] ];\r\n\r\n\tthis.morphTargets = [];\r\n\tthis.morphNormals = [];\r\n\r\n\tthis.skinWeights = [];\r\n\tthis.skinIndices = [];\r\n\r\n\tthis.lineDistances = [];\r\n\r\n\tthis.boundingBox = null;\r\n\tthis.boundingSphere = null;\r\n\r\n\t// update flags\r\n\r\n\tthis.verticesNeedUpdate = false;\r\n\tthis.elementsNeedUpdate = false;\r\n\tthis.uvsNeedUpdate = false;\r\n\tthis.normalsNeedUpdate = false;\r\n\tthis.colorsNeedUpdate = false;\r\n\tthis.lineDistancesNeedUpdate = false;\r\n\tthis.groupsNeedUpdate = false;\r\n\r\n};\r\n\r\nTHREE.Geometry.prototype = {\r\n\r\n\tconstructor: THREE.Geometry,\r\n\r\n\tapplyMatrix: function ( matrix ) {\r\n\r\n\t\tvar normalMatrix = new THREE.Matrix3().getNormalMatrix( matrix );\r\n\r\n\t\tfor ( var i = 0, il = this.vertices.length; i < il; i ++ ) {\r\n\r\n\t\t\tvar vertex = this.vertices[ i ];\r\n\t\t\tvertex.applyMatrix4( matrix );\r\n\r\n\t\t}\r\n\r\n\t\tfor ( var i = 0, il = this.faces.length; i < il; i ++ ) {\r\n\r\n\t\t\tvar face = this.faces[ i ];\r\n\t\t\tface.normal.applyMatrix3( normalMatrix ).normalize();\r\n\r\n\t\t\tfor ( var j = 0, jl = face.vertexNormals.length; j < jl; j ++ ) {\r\n\r\n\t\t\t\tface.vertexNormals[ j ].applyMatrix3( normalMatrix ).normalize();\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tif ( this.boundingBox !== null ) {\r\n\r\n\t\t\tthis.computeBoundingBox();\r\n\r\n\t\t}\r\n\r\n\t\tif ( this.boundingSphere !== null ) {\r\n\r\n\t\t\tthis.computeBoundingSphere();\r\n\r\n\t\t}\r\n\r\n\t\tthis.verticesNeedUpdate = true;\r\n\t\tthis.normalsNeedUpdate = true;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\trotateX: function () {\r\n\r\n\t\t// rotate geometry around world x-axis\r\n\r\n\t\tvar m1;\r\n\r\n\t\treturn function rotateX( angle ) {\r\n\r\n\t\t\tif ( m1 === undefined ) m1 = new THREE.Matrix4();\r\n\r\n\t\t\tm1.makeRotationX( angle );\r\n\r\n\t\t\tthis.applyMatrix( m1 );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\trotateY: function () {\r\n\r\n\t\t// rotate geometry around world y-axis\r\n\r\n\t\tvar m1;\r\n\r\n\t\treturn function rotateY( angle ) {\r\n\r\n\t\t\tif ( m1 === undefined ) m1 = new THREE.Matrix4();\r\n\r\n\t\t\tm1.makeRotationY( angle );\r\n\r\n\t\t\tthis.applyMatrix( m1 );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\trotateZ: function () {\r\n\r\n\t\t// rotate geometry around world z-axis\r\n\r\n\t\tvar m1;\r\n\r\n\t\treturn function rotateZ( angle ) {\r\n\r\n\t\t\tif ( m1 === undefined ) m1 = new THREE.Matrix4();\r\n\r\n\t\t\tm1.makeRotationZ( angle );\r\n\r\n\t\t\tthis.applyMatrix( m1 );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\ttranslate: function () {\r\n\r\n\t\t// translate geometry\r\n\r\n\t\tvar m1;\r\n\r\n\t\treturn function translate( x, y, z ) {\r\n\r\n\t\t\tif ( m1 === undefined ) m1 = new THREE.Matrix4();\r\n\r\n\t\t\tm1.makeTranslation( x, y, z );\r\n\r\n\t\t\tthis.applyMatrix( m1 );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\tscale: function () {\r\n\r\n\t\t// scale geometry\r\n\r\n\t\tvar m1;\r\n\r\n\t\treturn function scale( x, y, z ) {\r\n\r\n\t\t\tif ( m1 === undefined ) m1 = new THREE.Matrix4();\r\n\r\n\t\t\tm1.makeScale( x, y, z );\r\n\r\n\t\t\tthis.applyMatrix( m1 );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\tlookAt: function () {\r\n\r\n\t\tvar obj;\r\n\r\n\t\treturn function lookAt( vector ) {\r\n\r\n\t\t\tif ( obj === undefined ) obj = new THREE.Object3D();\r\n\r\n\t\t\tobj.lookAt( vector );\r\n\r\n\t\t\tobj.updateMatrix();\r\n\r\n\t\t\tthis.applyMatrix( obj.matrix );\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\tfromBufferGeometry: function ( geometry ) {\r\n\r\n\t\tvar scope = this;\r\n\r\n\t\tvar indices = geometry.index !== null ? geometry.index.array : undefined;\r\n\t\tvar attributes = geometry.attributes;\r\n\r\n\t\tvar positions = attributes.position.array;\r\n\t\tvar normals = attributes.normal !== undefined ? attributes.normal.array : undefined;\r\n\t\tvar colors = attributes.color !== undefined ? attributes.color.array : undefined;\r\n\t\tvar uvs = attributes.uv !== undefined ? attributes.uv.array : undefined;\r\n\t\tvar uvs2 = attributes.uv2 !== undefined ? attributes.uv2.array : undefined;\r\n\r\n\t\tif ( uvs2 !== undefined ) this.faceVertexUvs[ 1 ] = [];\r\n\r\n\t\tvar tempNormals = [];\r\n\t\tvar tempUVs = [];\r\n\t\tvar tempUVs2 = [];\r\n\r\n\t\tfor ( var i = 0, j = 0; i < positions.length; i += 3, j += 2 ) {\r\n\r\n\t\t\tscope.vertices.push( new THREE.Vector3( positions[ i ], positions[ i + 1 ], positions[ i + 2 ] ) );\r\n\r\n\t\t\tif ( normals !== undefined ) {\r\n\r\n\t\t\t\ttempNormals.push( new THREE.Vector3( normals[ i ], normals[ i + 1 ], normals[ i + 2 ] ) );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( colors !== undefined ) {\r\n\r\n\t\t\t\tscope.colors.push( new THREE.Color( colors[ i ], colors[ i + 1 ], colors[ i + 2 ] ) );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( uvs !== undefined ) {\r\n\r\n\t\t\t\ttempUVs.push( new THREE.Vector2( uvs[ j ], uvs[ j + 1 ] ) );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( uvs2 !== undefined ) {\r\n\r\n\t\t\t\ttempUVs2.push( new THREE.Vector2( uvs2[ j ], uvs2[ j + 1 ] ) );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tfunction addFace( a, b, c, materialIndex ) {\r\n\r\n\t\t\tvar vertexNormals = normals !== undefined ? [ tempNormals[ a ].clone(), tempNormals[ b ].clone(), tempNormals[ c ].clone() ] : [];\r\n\t\t\tvar vertexColors = colors !== undefined ? [ scope.colors[ a ].clone(), scope.colors[ b ].clone(), scope.colors[ c ].clone() ] : [];\r\n\r\n\t\t\tvar face = new THREE.Face3( a, b, c, vertexNormals, vertexColors, materialIndex );\r\n\r\n\t\t\tscope.faces.push( face );\r\n\r\n\t\t\tif ( uvs !== undefined ) {\r\n\r\n\t\t\t\tscope.faceVertexUvs[ 0 ].push( [ tempUVs[ a ].clone(), tempUVs[ b ].clone(), tempUVs[ c ].clone() ] );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( uvs2 !== undefined ) {\r\n\r\n\t\t\t\tscope.faceVertexUvs[ 1 ].push( [ tempUVs2[ a ].clone(), tempUVs2[ b ].clone(), tempUVs2[ c ].clone() ] );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tif ( indices !== undefined ) {\r\n\r\n\t\t\tvar groups = geometry.groups;\r\n\r\n\t\t\tif ( groups.length > 0 ) {\r\n\r\n\t\t\t\tfor ( var i = 0; i < groups.length; i ++ ) {\r\n\r\n\t\t\t\t\tvar group = groups[ i ];\r\n\r\n\t\t\t\t\tvar start = group.start;\r\n\t\t\t\t\tvar count = group.count;\r\n\r\n\t\t\t\t\tfor ( var j = start, jl = start + count; j < jl; j += 3 ) {\r\n\r\n\t\t\t\t\t\taddFace( indices[ j ], indices[ j + 1 ], indices[ j + 2 ], group.materialIndex  );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tfor ( var i = 0; i < indices.length; i += 3 ) {\r\n\r\n\t\t\t\t\taddFace( indices[ i ], indices[ i + 1 ], indices[ i + 2 ] );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t} else {\r\n\r\n\t\t\tfor ( var i = 0; i < positions.length / 3; i += 3 ) {\r\n\r\n\t\t\t\taddFace( i, i + 1, i + 2 );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tthis.computeFaceNormals();\r\n\r\n\t\tif ( geometry.boundingBox !== null ) {\r\n\r\n\t\t\tthis.boundingBox = geometry.boundingBox.clone();\r\n\r\n\t\t}\r\n\r\n\t\tif ( geometry.boundingSphere !== null ) {\r\n\r\n\t\t\tthis.boundingSphere = geometry.boundingSphere.clone();\r\n\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tcenter: function () {\r\n\r\n\t\tthis.computeBoundingBox();\r\n\r\n\t\tvar offset = this.boundingBox.center().negate();\r\n\r\n\t\tthis.translate( offset.x, offset.y, offset.z );\r\n\r\n\t\treturn offset;\r\n\r\n\t},\r\n\r\n\tnormalize: function () {\r\n\r\n\t\tthis.computeBoundingSphere();\r\n\r\n\t\tvar center = this.boundingSphere.center;\r\n\t\tvar radius = this.boundingSphere.radius;\r\n\r\n\t\tvar s = radius === 0 ? 1 : 1.0 / radius;\r\n\r\n\t\tvar matrix = new THREE.Matrix4();\r\n\t\tmatrix.set(\r\n\t\t\ts, 0, 0, - s * center.x,\r\n\t\t\t0, s, 0, - s * center.y,\r\n\t\t\t0, 0, s, - s * center.z,\r\n\t\t\t0, 0, 0, 1\r\n\t\t);\r\n\r\n\t\tthis.applyMatrix( matrix );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tcomputeFaceNormals: function () {\r\n\r\n\t\tvar cb = new THREE.Vector3(), ab = new THREE.Vector3();\r\n\r\n\t\tfor ( var f = 0, fl = this.faces.length; f < fl; f ++ ) {\r\n\r\n\t\t\tvar face = this.faces[ f ];\r\n\r\n\t\t\tvar vA = this.vertices[ face.a ];\r\n\t\t\tvar vB = this.vertices[ face.b ];\r\n\t\t\tvar vC = this.vertices[ face.c ];\r\n\r\n\t\t\tcb.subVectors( vC, vB );\r\n\t\t\tab.subVectors( vA, vB );\r\n\t\t\tcb.cross( ab );\r\n\r\n\t\t\tcb.normalize();\r\n\r\n\t\t\tface.normal.copy( cb );\r\n\r\n\t\t}\r\n\r\n\t},\r\n\r\n\tcomputeVertexNormals: function ( areaWeighted ) {\r\n\r\n\t\tif ( areaWeighted === undefined ) areaWeighted = true;\r\n\r\n\t\tvar v, vl, f, fl, face, vertices;\r\n\r\n\t\tvertices = new Array( this.vertices.length );\r\n\r\n\t\tfor ( v = 0, vl = this.vertices.length; v < vl; v ++ ) {\r\n\r\n\t\t\tvertices[ v ] = new THREE.Vector3();\r\n\r\n\t\t}\r\n\r\n\t\tif ( areaWeighted ) {\r\n\r\n\t\t\t// vertex normals weighted by triangle areas\r\n\t\t\t// http://www.iquilezles.org/www/articles/normals/normals.htm\r\n\r\n\t\t\tvar vA, vB, vC;\r\n\t\t\tvar cb = new THREE.Vector3(), ab = new THREE.Vector3();\r\n\r\n\t\t\tfor ( f = 0, fl = this.faces.length; f < fl; f ++ ) {\r\n\r\n\t\t\t\tface = this.faces[ f ];\r\n\r\n\t\t\t\tvA = this.vertices[ face.a ];\r\n\t\t\t\tvB = this.vertices[ face.b ];\r\n\t\t\t\tvC = this.vertices[ face.c ];\r\n\r\n\t\t\t\tcb.subVectors( vC, vB );\r\n\t\t\t\tab.subVectors( vA, vB );\r\n\t\t\t\tcb.cross( ab );\r\n\r\n\t\t\t\tvertices[ face.a ].add( cb );\r\n\t\t\t\tvertices[ face.b ].add( cb );\r\n\t\t\t\tvertices[ face.c ].add( cb );\r\n\r\n\t\t\t}\r\n\r\n\t\t} else {\r\n\r\n\t\t\tfor ( f = 0, fl = this.faces.length; f < fl; f ++ ) {\r\n\r\n\t\t\t\tface = this.faces[ f ];\r\n\r\n\t\t\t\tvertices[ face.a ].add( face.normal );\r\n\t\t\t\tvertices[ face.b ].add( face.normal );\r\n\t\t\t\tvertices[ face.c ].add( face.normal );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tfor ( v = 0, vl = this.vertices.length; v < vl; v ++ ) {\r\n\r\n\t\t\tvertices[ v ].normalize();\r\n\r\n\t\t}\r\n\r\n\t\tfor ( f = 0, fl = this.faces.length; f < fl; f ++ ) {\r\n\r\n\t\t\tface = this.faces[ f ];\r\n\r\n\t\t\tvar vertexNormals = face.vertexNormals;\r\n\r\n\t\t\tif ( vertexNormals.length === 3 ) {\r\n\r\n\t\t\t\tvertexNormals[ 0 ].copy( vertices[ face.a ] );\r\n\t\t\t\tvertexNormals[ 1 ].copy( vertices[ face.b ] );\r\n\t\t\t\tvertexNormals[ 2 ].copy( vertices[ face.c ] );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tvertexNormals[ 0 ] = vertices[ face.a ].clone();\r\n\t\t\t\tvertexNormals[ 1 ] = vertices[ face.b ].clone();\r\n\t\t\t\tvertexNormals[ 2 ] = vertices[ face.c ].clone();\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tif ( this.faces.length > 0 ) {\r\n\r\n\t\t\tthis.normalsNeedUpdate = true;\r\n\r\n\t\t}\r\n\r\n\t},\r\n\r\n\tcomputeMorphNormals: function () {\r\n\r\n\t\tvar i, il, f, fl, face;\r\n\r\n\t\t// save original normals\r\n\t\t// - create temp variables on first access\r\n\t\t//   otherwise just copy (for faster repeated calls)\r\n\r\n\t\tfor ( f = 0, fl = this.faces.length; f < fl; f ++ ) {\r\n\r\n\t\t\tface = this.faces[ f ];\r\n\r\n\t\t\tif ( ! face.__originalFaceNormal ) {\r\n\r\n\t\t\t\tface.__originalFaceNormal = face.normal.clone();\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tface.__originalFaceNormal.copy( face.normal );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( ! face.__originalVertexNormals ) face.__originalVertexNormals = [];\r\n\r\n\t\t\tfor ( i = 0, il = face.vertexNormals.length; i < il; i ++ ) {\r\n\r\n\t\t\t\tif ( ! face.__originalVertexNormals[ i ] ) {\r\n\r\n\t\t\t\t\tface.__originalVertexNormals[ i ] = face.vertexNormals[ i ].clone();\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tface.__originalVertexNormals[ i ].copy( face.vertexNormals[ i ] );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\t// use temp geometry to compute face and vertex normals for each morph\r\n\r\n\t\tvar tmpGeo = new THREE.Geometry();\r\n\t\ttmpGeo.faces = this.faces;\r\n\r\n\t\tfor ( i = 0, il = this.morphTargets.length; i < il; i ++ ) {\r\n\r\n\t\t\t// create on first access\r\n\r\n\t\t\tif ( ! this.morphNormals[ i ] ) {\r\n\r\n\t\t\t\tthis.morphNormals[ i ] = {};\r\n\t\t\t\tthis.morphNormals[ i ].faceNormals = [];\r\n\t\t\t\tthis.morphNormals[ i ].vertexNormals = [];\r\n\r\n\t\t\t\tvar dstNormalsFace = this.morphNormals[ i ].faceNormals;\r\n\t\t\t\tvar dstNormalsVertex = this.morphNormals[ i ].vertexNormals;\r\n\r\n\t\t\t\tvar faceNormal, vertexNormals;\r\n\r\n\t\t\t\tfor ( f = 0, fl = this.faces.length; f < fl; f ++ ) {\r\n\r\n\t\t\t\t\tfaceNormal = new THREE.Vector3();\r\n\t\t\t\t\tvertexNormals = { a: new THREE.Vector3(), b: new THREE.Vector3(), c: new THREE.Vector3() };\r\n\r\n\t\t\t\t\tdstNormalsFace.push( faceNormal );\r\n\t\t\t\t\tdstNormalsVertex.push( vertexNormals );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar morphNormals = this.morphNormals[ i ];\r\n\r\n\t\t\t// set vertices to morph target\r\n\r\n\t\t\ttmpGeo.vertices = this.morphTargets[ i ].vertices;\r\n\r\n\t\t\t// compute morph normals\r\n\r\n\t\t\ttmpGeo.computeFaceNormals();\r\n\t\t\ttmpGeo.computeVertexNormals();\r\n\r\n\t\t\t// store morph normals\r\n\r\n\t\t\tvar faceNormal, vertexNormals;\r\n\r\n\t\t\tfor ( f = 0, fl = this.faces.length; f < fl; f ++ ) {\r\n\r\n\t\t\t\tface = this.faces[ f ];\r\n\r\n\t\t\t\tfaceNormal = morphNormals.faceNormals[ f ];\r\n\t\t\t\tvertexNormals = morphNormals.vertexNormals[ f ];\r\n\r\n\t\t\t\tfaceNormal.copy( face.normal );\r\n\r\n\t\t\t\tvertexNormals.a.copy( face.vertexNormals[ 0 ] );\r\n\t\t\t\tvertexNormals.b.copy( face.vertexNormals[ 1 ] );\r\n\t\t\t\tvertexNormals.c.copy( face.vertexNormals[ 2 ] );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\t// restore original normals\r\n\r\n\t\tfor ( f = 0, fl = this.faces.length; f < fl; f ++ ) {\r\n\r\n\t\t\tface = this.faces[ f ];\r\n\r\n\t\t\tface.normal = face.__originalFaceNormal;\r\n\t\t\tface.vertexNormals = face.__originalVertexNormals;\r\n\r\n\t\t}\r\n\r\n\t},\r\n\r\n\tcomputeTangents: function () {\r\n\r\n\t\tconsole.warn( 'THREE.Geometry: .computeTangents() has been removed.' );\r\n\r\n\t},\r\n\r\n\tcomputeLineDistances: function () {\r\n\r\n\t\tvar d = 0;\r\n\t\tvar vertices = this.vertices;\r\n\r\n\t\tfor ( var i = 0, il = vertices.length; i < il; i ++ ) {\r\n\r\n\t\t\tif ( i > 0 ) {\r\n\r\n\t\t\t\td += vertices[ i ].distanceTo( vertices[ i - 1 ] );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tthis.lineDistances[ i ] = d;\r\n\r\n\t\t}\r\n\r\n\t},\r\n\r\n\tcomputeBoundingBox: function () {\r\n\r\n\t\tif ( this.boundingBox === null ) {\r\n\r\n\t\t\tthis.boundingBox = new THREE.Box3();\r\n\r\n\t\t}\r\n\r\n\t\tthis.boundingBox.setFromPoints( this.vertices );\r\n\r\n\t},\r\n\r\n\tcomputeBoundingSphere: function () {\r\n\r\n\t\tif ( this.boundingSphere === null ) {\r\n\r\n\t\t\tthis.boundingSphere = new THREE.Sphere();\r\n\r\n\t\t}\r\n\r\n\t\tthis.boundingSphere.setFromPoints( this.vertices );\r\n\r\n\t},\r\n\r\n\tmerge: function ( geometry, matrix, materialIndexOffset ) {\r\n\r\n\t\tif ( geometry instanceof THREE.Geometry === false ) {\r\n\r\n\t\t\tconsole.error( 'THREE.Geometry.merge(): geometry not an instance of THREE.Geometry.', geometry );\r\n\t\t\treturn;\r\n\r\n\t\t}\r\n\r\n\t\tvar normalMatrix,\r\n\t\tvertexOffset = this.vertices.length,\r\n\t\tvertices1 = this.vertices,\r\n\t\tvertices2 = geometry.vertices,\r\n\t\tfaces1 = this.faces,\r\n\t\tfaces2 = geometry.faces,\r\n\t\tuvs1 = this.faceVertexUvs[ 0 ],\r\n\t\tuvs2 = geometry.faceVertexUvs[ 0 ];\r\n\r\n\t\tif ( materialIndexOffset === undefined ) materialIndexOffset = 0;\r\n\r\n\t\tif ( matrix !== undefined ) {\r\n\r\n\t\t\tnormalMatrix = new THREE.Matrix3().getNormalMatrix( matrix );\r\n\r\n\t\t}\r\n\r\n\t\t// vertices\r\n\r\n\t\tfor ( var i = 0, il = vertices2.length; i < il; i ++ ) {\r\n\r\n\t\t\tvar vertex = vertices2[ i ];\r\n\r\n\t\t\tvar vertexCopy = vertex.clone();\r\n\r\n\t\t\tif ( matrix !== undefined ) vertexCopy.applyMatrix4( matrix );\r\n\r\n\t\t\tvertices1.push( vertexCopy );\r\n\r\n\t\t}\r\n\r\n\t\t// faces\r\n\r\n\t\tfor ( i = 0, il = faces2.length; i < il; i ++ ) {\r\n\r\n\t\t\tvar face = faces2[ i ], faceCopy, normal, color,\r\n\t\t\tfaceVertexNormals = face.vertexNormals,\r\n\t\t\tfaceVertexColors = face.vertexColors;\r\n\r\n\t\t\tfaceCopy = new THREE.Face3( face.a + vertexOffset, face.b + vertexOffset, face.c + vertexOffset );\r\n\t\t\tfaceCopy.normal.copy( face.normal );\r\n\r\n\t\t\tif ( normalMatrix !== undefined ) {\r\n\r\n\t\t\t\tfaceCopy.normal.applyMatrix3( normalMatrix ).normalize();\r\n\r\n\t\t\t}\r\n\r\n\t\t\tfor ( var j = 0, jl = faceVertexNormals.length; j < jl; j ++ ) {\r\n\r\n\t\t\t\tnormal = faceVertexNormals[ j ].clone();\r\n\r\n\t\t\t\tif ( normalMatrix !== undefined ) {\r\n\r\n\t\t\t\t\tnormal.applyMatrix3( normalMatrix ).normalize();\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tfaceCopy.vertexNormals.push( normal );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tfaceCopy.color.copy( face.color );\r\n\r\n\t\t\tfor ( var j = 0, jl = faceVertexColors.length; j < jl; j ++ ) {\r\n\r\n\t\t\t\tcolor = faceVertexColors[ j ];\r\n\t\t\t\tfaceCopy.vertexColors.push( color.clone() );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tfaceCopy.materialIndex = face.materialIndex + materialIndexOffset;\r\n\r\n\t\t\tfaces1.push( faceCopy );\r\n\r\n\t\t}\r\n\r\n\t\t// uvs\r\n\r\n\t\tfor ( i = 0, il = uvs2.length; i < il; i ++ ) {\r\n\r\n\t\t\tvar uv = uvs2[ i ], uvCopy = [];\r\n\r\n\t\t\tif ( uv === undefined ) {\r\n\r\n\t\t\t\tcontinue;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tfor ( var j = 0, jl = uv.length; j < jl; j ++ ) {\r\n\r\n\t\t\t\tuvCopy.push( uv[ j ].clone() );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tuvs1.push( uvCopy );\r\n\r\n\t\t}\r\n\r\n\t},\r\n\r\n\tmergeMesh: function ( mesh ) {\r\n\r\n\t\tif ( mesh instanceof THREE.Mesh === false ) {\r\n\r\n\t\t\tconsole.error( 'THREE.Geometry.mergeMesh(): mesh not an instance of THREE.Mesh.', mesh );\r\n\t\t\treturn;\r\n\r\n\t\t}\r\n\r\n\t\tmesh.matrixAutoUpdate && mesh.updateMatrix();\r\n\r\n\t\tthis.merge( mesh.geometry, mesh.matrix );\r\n\r\n\t},\r\n\r\n\t/*\r\n\t * Checks for duplicate vertices with hashmap.\r\n\t * Duplicated vertices are removed\r\n\t * and faces' vertices are updated.\r\n\t */\r\n\r\n\tmergeVertices: function () {\r\n\r\n\t\tvar verticesMap = {}; // Hashmap for looking up vertices by position coordinates (and making sure they are unique)\r\n\t\tvar unique = [], changes = [];\r\n\r\n\t\tvar v, key;\r\n\t\tvar precisionPoints = 4; // number of decimal points, e.g. 4 for epsilon of 0.0001\r\n\t\tvar precision = Math.pow( 10, precisionPoints );\r\n\t\tvar i, il, face;\r\n\t\tvar indices, j, jl;\r\n\r\n\t\tfor ( i = 0, il = this.vertices.length; i < il; i ++ ) {\r\n\r\n\t\t\tv = this.vertices[ i ];\r\n\t\t\tkey = Math.round( v.x * precision ) + '_' + Math.round( v.y * precision ) + '_' + Math.round( v.z * precision );\r\n\r\n\t\t\tif ( verticesMap[ key ] === undefined ) {\r\n\r\n\t\t\t\tverticesMap[ key ] = i;\r\n\t\t\t\tunique.push( this.vertices[ i ] );\r\n\t\t\t\tchanges[ i ] = unique.length - 1;\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\t//console.log('Duplicate vertex found. ', i, ' could be using ', verticesMap[key]);\r\n\t\t\t\tchanges[ i ] = changes[ verticesMap[ key ] ];\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\r\n\t\t// if faces are completely degenerate after merging vertices, we\r\n\t\t// have to remove them from the geometry.\r\n\t\tvar faceIndicesToRemove = [];\r\n\r\n\t\tfor ( i = 0, il = this.faces.length; i < il; i ++ ) {\r\n\r\n\t\t\tface = this.faces[ i ];\r\n\r\n\t\t\tface.a = changes[ face.a ];\r\n\t\t\tface.b = changes[ face.b ];\r\n\t\t\tface.c = changes[ face.c ];\r\n\r\n\t\t\tindices = [ face.a, face.b, face.c ];\r\n\r\n\t\t\tvar dupIndex = - 1;\r\n\r\n\t\t\t// if any duplicate vertices are found in a Face3\r\n\t\t\t// we have to remove the face as nothing can be saved\r\n\t\t\tfor ( var n = 0; n < 3; n ++ ) {\r\n\r\n\t\t\t\tif ( indices[ n ] === indices[ ( n + 1 ) % 3 ] ) {\r\n\r\n\t\t\t\t\tdupIndex = n;\r\n\t\t\t\t\tfaceIndicesToRemove.push( i );\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tfor ( i = faceIndicesToRemove.length - 1; i >= 0; i -- ) {\r\n\r\n\t\t\tvar idx = faceIndicesToRemove[ i ];\r\n\r\n\t\t\tthis.faces.splice( idx, 1 );\r\n\r\n\t\t\tfor ( j = 0, jl = this.faceVertexUvs.length; j < jl; j ++ ) {\r\n\r\n\t\t\t\tthis.faceVertexUvs[ j ].splice( idx, 1 );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\t// Use unique set of vertices\r\n\r\n\t\tvar diff = this.vertices.length - unique.length;\r\n\t\tthis.vertices = unique;\r\n\t\treturn diff;\r\n\r\n\t},\r\n\r\n\tsortFacesByMaterialIndex: function () {\r\n\r\n\t\tvar faces = this.faces;\r\n\t\tvar length = faces.length;\r\n\r\n\t\t// tag faces\r\n\r\n\t\tfor ( var i = 0; i < length; i ++ ) {\r\n\r\n\t\t\tfaces[ i ]._id = i;\r\n\r\n\t\t}\r\n\r\n\t\t// sort faces\r\n\r\n\t\tfunction materialIndexSort( a, b ) {\r\n\r\n\t\t\treturn a.materialIndex - b.materialIndex;\r\n\r\n\t\t}\r\n\r\n\t\tfaces.sort( materialIndexSort );\r\n\r\n\t\t// sort uvs\r\n\r\n\t\tvar uvs1 = this.faceVertexUvs[ 0 ];\r\n\t\tvar uvs2 = this.faceVertexUvs[ 1 ];\r\n\r\n\t\tvar newUvs1, newUvs2;\r\n\r\n\t\tif ( uvs1 && uvs1.length === length ) newUvs1 = [];\r\n\t\tif ( uvs2 && uvs2.length === length ) newUvs2 = [];\r\n\r\n\t\tfor ( var i = 0; i < length; i ++ ) {\r\n\r\n\t\t\tvar id = faces[ i ]._id;\r\n\r\n\t\t\tif ( newUvs1 ) newUvs1.push( uvs1[ id ] );\r\n\t\t\tif ( newUvs2 ) newUvs2.push( uvs2[ id ] );\r\n\r\n\t\t}\r\n\r\n\t\tif ( newUvs1 ) this.faceVertexUvs[ 0 ] = newUvs1;\r\n\t\tif ( newUvs2 ) this.faceVertexUvs[ 1 ] = newUvs2;\r\n\r\n\t},\r\n\r\n\ttoJSON: function () {\r\n\r\n\t\tvar data = {\r\n\t\t\tmetadata: {\r\n\t\t\t\tversion: 4.4,\r\n\t\t\t\ttype: 'Geometry',\r\n\t\t\t\tgenerator: 'Geometry.toJSON'\r\n\t\t\t}\r\n\t\t};\r\n\r\n\t\t// standard Geometry serialization\r\n\r\n\t\tdata.uuid = this.uuid;\r\n\t\tdata.type = this.type;\r\n\t\tif ( this.name !== '' ) data.name = this.name;\r\n\r\n\t\tif ( this.parameters !== undefined ) {\r\n\r\n\t\t\tvar parameters = this.parameters;\r\n\r\n\t\t\tfor ( var key in parameters ) {\r\n\r\n\t\t\t\tif ( parameters[ key ] !== undefined ) data[ key ] = parameters[ key ];\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn data;\r\n\r\n\t\t}\r\n\r\n\t\tvar vertices = [];\r\n\r\n\t\tfor ( var i = 0; i < this.vertices.length; i ++ ) {\r\n\r\n\t\t\tvar vertex = this.vertices[ i ];\r\n\t\t\tvertices.push( vertex.x, vertex.y, vertex.z );\r\n\r\n\t\t}\r\n\r\n\t\tvar faces = [];\r\n\t\tvar normals = [];\r\n\t\tvar normalsHash = {};\r\n\t\tvar colors = [];\r\n\t\tvar colorsHash = {};\r\n\t\tvar uvs = [];\r\n\t\tvar uvsHash = {};\r\n\r\n\t\tfor ( var i = 0; i < this.faces.length; i ++ ) {\r\n\r\n\t\t\tvar face = this.faces[ i ];\r\n\r\n\t\t\tvar hasMaterial = true;\r\n\t\t\tvar hasFaceUv = false; // deprecated\r\n\t\t\tvar hasFaceVertexUv = this.faceVertexUvs[ 0 ][ i ] !== undefined;\r\n\t\t\tvar hasFaceNormal = face.normal.length() > 0;\r\n\t\t\tvar hasFaceVertexNormal = face.vertexNormals.length > 0;\r\n\t\t\tvar hasFaceColor = face.color.r !== 1 || face.color.g !== 1 || face.color.b !== 1;\r\n\t\t\tvar hasFaceVertexColor = face.vertexColors.length > 0;\r\n\r\n\t\t\tvar faceType = 0;\r\n\r\n\t\t\tfaceType = setBit( faceType, 0, 0 ); // isQuad\r\n\t\t\tfaceType = setBit( faceType, 1, hasMaterial );\r\n\t\t\tfaceType = setBit( faceType, 2, hasFaceUv );\r\n\t\t\tfaceType = setBit( faceType, 3, hasFaceVertexUv );\r\n\t\t\tfaceType = setBit( faceType, 4, hasFaceNormal );\r\n\t\t\tfaceType = setBit( faceType, 5, hasFaceVertexNormal );\r\n\t\t\tfaceType = setBit( faceType, 6, hasFaceColor );\r\n\t\t\tfaceType = setBit( faceType, 7, hasFaceVertexColor );\r\n\r\n\t\t\tfaces.push( faceType );\r\n\t\t\tfaces.push( face.a, face.b, face.c );\r\n\t\t\tfaces.push( face.materialIndex );\r\n\r\n\t\t\tif ( hasFaceVertexUv ) {\r\n\r\n\t\t\t\tvar faceVertexUvs = this.faceVertexUvs[ 0 ][ i ];\r\n\r\n\t\t\t\tfaces.push(\r\n\t\t\t\t\tgetUvIndex( faceVertexUvs[ 0 ] ),\r\n\t\t\t\t\tgetUvIndex( faceVertexUvs[ 1 ] ),\r\n\t\t\t\t\tgetUvIndex( faceVertexUvs[ 2 ] )\r\n\t\t\t\t);\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( hasFaceNormal ) {\r\n\r\n\t\t\t\tfaces.push( getNormalIndex( face.normal ) );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( hasFaceVertexNormal ) {\r\n\r\n\t\t\t\tvar vertexNormals = face.vertexNormals;\r\n\r\n\t\t\t\tfaces.push(\r\n\t\t\t\t\tgetNormalIndex( vertexNormals[ 0 ] ),\r\n\t\t\t\t\tgetNormalIndex( vertexNormals[ 1 ] ),\r\n\t\t\t\t\tgetNormalIndex( vertexNormals[ 2 ] )\r\n\t\t\t\t);\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( hasFaceColor ) {\r\n\r\n\t\t\t\tfaces.push( getColorIndex( face.color ) );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( hasFaceVertexColor ) {\r\n\r\n\t\t\t\tvar vertexColors = face.vertexColors;\r\n\r\n\t\t\t\tfaces.push(\r\n\t\t\t\t\tgetColorIndex( vertexColors[ 0 ] ),\r\n\t\t\t\t\tgetColorIndex( vertexColors[ 1 ] ),\r\n\t\t\t\t\tgetColorIndex( vertexColors[ 2 ] )\r\n\t\t\t\t);\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tfunction setBit( value, position, enabled ) {\r\n\r\n\t\t\treturn enabled ? value | ( 1 << position ) : value & ( ~ ( 1 << position ) );\r\n\r\n\t\t}\r\n\r\n\t\tfunction getNormalIndex( normal ) {\r\n\r\n\t\t\tvar hash = normal.x.toString() + normal.y.toString() + normal.z.toString();\r\n\r\n\t\t\tif ( normalsHash[ hash ] !== undefined ) {\r\n\r\n\t\t\t\treturn normalsHash[ hash ];\r\n\r\n\t\t\t}\r\n\r\n\t\t\tnormalsHash[ hash ] = normals.length / 3;\r\n\t\t\tnormals.push( normal.x, normal.y, normal.z );\r\n\r\n\t\t\treturn normalsHash[ hash ];\r\n\r\n\t\t}\r\n\r\n\t\tfunction getColorIndex( color ) {\r\n\r\n\t\t\tvar hash = color.r.toString() + color.g.toString() + color.b.toString();\r\n\r\n\t\t\tif ( colorsHash[ hash ] !== undefined ) {\r\n\r\n\t\t\t\treturn colorsHash[ hash ];\r\n\r\n\t\t\t}\r\n\r\n\t\t\tcolorsHash[ hash ] = colors.length;\r\n\t\t\tcolors.push( color.getHex() );\r\n\r\n\t\t\treturn colorsHash[ hash ];\r\n\r\n\t\t}\r\n\r\n\t\tfunction getUvIndex( uv ) {\r\n\r\n\t\t\tvar hash = uv.x.toString() + uv.y.toString();\r\n\r\n\t\t\tif ( uvsHash[ hash ] !== undefined ) {\r\n\r\n\t\t\t\treturn uvsHash[ hash ];\r\n\r\n\t\t\t}\r\n\r\n\t\t\tuvsHash[ hash ] = uvs.length / 2;\r\n\t\t\tuvs.push( uv.x, uv.y );\r\n\r\n\t\t\treturn uvsHash[ hash ];\r\n\r\n\t\t}\r\n\r\n\t\tdata.data = {};\r\n\r\n\t\tdata.data.vertices = vertices;\r\n\t\tdata.data.normals = normals;\r\n\t\tif ( colors.length > 0 ) data.data.colors = colors;\r\n\t\tif ( uvs.length > 0 ) data.data.uvs = [ uvs ]; // temporal backward compatibility\r\n\t\tdata.data.faces = faces;\r\n\r\n\t\treturn data;\r\n\r\n\t},\r\n\r\n\tclone: function () {\r\n\r\n\t\t/*\r\n\t\t// Handle primitives\r\n\r\n\t\tvar parameters = this.parameters;\r\n\r\n\t\tif ( parameters !== undefined ) {\r\n\r\n\t\t\tvar values = [];\r\n\r\n\t\t\tfor ( var key in parameters ) {\r\n\r\n\t\t\t\tvalues.push( parameters[ key ] );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar geometry = Object.create( this.constructor.prototype );\r\n\t\t\tthis.constructor.apply( geometry, values );\r\n\t\t\treturn geometry;\r\n\r\n\t\t}\r\n\r\n\t\treturn new this.constructor().copy( this );\r\n\t\t*/\r\n\r\n\t\treturn new THREE.Geometry().copy( this );\r\n\r\n\t},\r\n\r\n\tcopy: function ( source ) {\r\n\r\n\t\tthis.vertices = [];\r\n\t\tthis.faces = [];\r\n\t\tthis.faceVertexUvs = [ [] ];\r\n\r\n\t\tvar vertices = source.vertices;\r\n\r\n\t\tfor ( var i = 0, il = vertices.length; i < il; i ++ ) {\r\n\r\n\t\t\tthis.vertices.push( vertices[ i ].clone() );\r\n\r\n\t\t}\r\n\r\n\t\tvar faces = source.faces;\r\n\r\n\t\tfor ( var i = 0, il = faces.length; i < il; i ++ ) {\r\n\r\n\t\t\tthis.faces.push( faces[ i ].clone() );\r\n\r\n\t\t}\r\n\r\n\t\tfor ( var i = 0, il = source.faceVertexUvs.length; i < il; i ++ ) {\r\n\r\n\t\t\tvar faceVertexUvs = source.faceVertexUvs[ i ];\r\n\r\n\t\t\tif ( this.faceVertexUvs[ i ] === undefined ) {\r\n\r\n\t\t\t\tthis.faceVertexUvs[ i ] = [];\r\n\r\n\t\t\t}\r\n\r\n\t\t\tfor ( var j = 0, jl = faceVertexUvs.length; j < jl; j ++ ) {\r\n\r\n\t\t\t\tvar uvs = faceVertexUvs[ j ], uvsCopy = [];\r\n\r\n\t\t\t\tfor ( var k = 0, kl = uvs.length; k < kl; k ++ ) {\r\n\r\n\t\t\t\t\tvar uv = uvs[ k ];\r\n\r\n\t\t\t\t\tuvsCopy.push( uv.clone() );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tthis.faceVertexUvs[ i ].push( uvsCopy );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tdispose: function () {\r\n\r\n\t\tthis.dispatchEvent( { type: 'dispose' } );\r\n\r\n\t}\r\n\r\n};\r\n\r\nTHREE.EventDispatcher.prototype.apply( THREE.Geometry.prototype );\r\n\r\nTHREE.GeometryIdCount = 0;\r\n\r\n// File:src/core/DirectGeometry.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.DirectGeometry = function () {\r\n\r\n\tObject.defineProperty( this, 'id', { value: THREE.GeometryIdCount ++ } );\r\n\r\n\tthis.uuid = THREE.Math.generateUUID();\r\n\r\n\tthis.name = '';\r\n\tthis.type = 'DirectGeometry';\r\n\r\n\tthis.indices = [];\r\n\tthis.vertices = [];\r\n\tthis.normals = [];\r\n\tthis.colors = [];\r\n\tthis.uvs = [];\r\n\tthis.uvs2 = [];\r\n\r\n\tthis.groups = [];\r\n\r\n\tthis.morphTargets = {};\r\n\r\n\tthis.skinWeights = [];\r\n\tthis.skinIndices = [];\r\n\r\n\t// this.lineDistances = [];\r\n\r\n\tthis.boundingBox = null;\r\n\tthis.boundingSphere = null;\r\n\r\n\t// update flags\r\n\r\n\tthis.verticesNeedUpdate = false;\r\n\tthis.normalsNeedUpdate = false;\r\n\tthis.colorsNeedUpdate = false;\r\n\tthis.uvsNeedUpdate = false;\r\n\tthis.groupsNeedUpdate = false;\r\n\r\n};\r\n\r\nTHREE.DirectGeometry.prototype = {\r\n\r\n\tconstructor: THREE.DirectGeometry,\r\n\r\n\tcomputeBoundingBox: THREE.Geometry.prototype.computeBoundingBox,\r\n\tcomputeBoundingSphere: THREE.Geometry.prototype.computeBoundingSphere,\r\n\r\n\tcomputeFaceNormals: function () {\r\n\r\n\t\tconsole.warn( 'THREE.DirectGeometry: computeFaceNormals() is not a method of this type of geometry.' );\r\n\r\n\t},\r\n\r\n\tcomputeVertexNormals: function () {\r\n\r\n\t\tconsole.warn( 'THREE.DirectGeometry: computeVertexNormals() is not a method of this type of geometry.' );\r\n\r\n\t},\r\n\r\n\tcomputeGroups: function ( geometry ) {\r\n\r\n\t\tvar group;\r\n\t\tvar groups = [];\r\n\t\tvar materialIndex;\r\n\r\n\t\tvar faces = geometry.faces;\r\n\r\n\t\tfor ( var i = 0; i < faces.length; i ++ ) {\r\n\r\n\t\t\tvar face = faces[ i ];\r\n\r\n\t\t\t// materials\r\n\r\n\t\t\tif ( face.materialIndex !== materialIndex ) {\r\n\r\n\t\t\t\tmaterialIndex = face.materialIndex;\r\n\r\n\t\t\t\tif ( group !== undefined ) {\r\n\r\n\t\t\t\t\tgroup.count = ( i * 3 ) - group.start;\r\n\t\t\t\t\tgroups.push( group );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tgroup = {\r\n\t\t\t\t\tstart: i * 3,\r\n\t\t\t\t\tmaterialIndex: materialIndex\r\n\t\t\t\t};\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tif ( group !== undefined ) {\r\n\r\n\t\t\tgroup.count = ( i * 3 ) - group.start;\r\n\t\t\tgroups.push( group );\r\n\r\n\t\t}\r\n\r\n\t\tthis.groups = groups;\r\n\r\n\t},\r\n\r\n\tfromGeometry: function ( geometry ) {\r\n\r\n\t\tvar faces = geometry.faces;\r\n\t\tvar vertices = geometry.vertices;\r\n\t\tvar faceVertexUvs = geometry.faceVertexUvs;\r\n\r\n\t\tvar hasFaceVertexUv = faceVertexUvs[ 0 ] && faceVertexUvs[ 0 ].length > 0;\r\n\t\tvar hasFaceVertexUv2 = faceVertexUvs[ 1 ] && faceVertexUvs[ 1 ].length > 0;\r\n\r\n\t\t// morphs\r\n\r\n\t\tvar morphTargets = geometry.morphTargets;\r\n\t\tvar morphTargetsLength = morphTargets.length;\r\n\r\n\t\tvar morphTargetsPosition;\r\n\r\n\t\tif ( morphTargetsLength > 0 ) {\r\n\r\n\t\t\tmorphTargetsPosition = [];\r\n\r\n\t\t\tfor ( var i = 0; i < morphTargetsLength; i ++ ) {\r\n\r\n\t\t\t\tmorphTargetsPosition[ i ] = [];\r\n\r\n\t\t\t}\r\n\r\n\t\t\tthis.morphTargets.position = morphTargetsPosition;\r\n\r\n\t\t}\r\n\r\n\t\tvar morphNormals = geometry.morphNormals;\r\n\t\tvar morphNormalsLength = morphNormals.length;\r\n\r\n\t\tvar morphTargetsNormal;\r\n\r\n\t\tif ( morphNormalsLength > 0 ) {\r\n\r\n\t\t\tmorphTargetsNormal = [];\r\n\r\n\t\t\tfor ( var i = 0; i < morphNormalsLength; i ++ ) {\r\n\r\n\t\t\t\tmorphTargetsNormal[ i ] = [];\r\n\r\n\t\t\t}\r\n\r\n\t\t\tthis.morphTargets.normal = morphTargetsNormal;\r\n\r\n\t\t}\r\n\r\n\t\t// skins\r\n\r\n\t\tvar skinIndices = geometry.skinIndices;\r\n\t\tvar skinWeights = geometry.skinWeights;\r\n\r\n\t\tvar hasSkinIndices = skinIndices.length === vertices.length;\r\n\t\tvar hasSkinWeights = skinWeights.length === vertices.length;\r\n\r\n\t\t//\r\n\r\n\t\tfor ( var i = 0; i < faces.length; i ++ ) {\r\n\r\n\t\t\tvar face = faces[ i ];\r\n\r\n\t\t\tthis.vertices.push( vertices[ face.a ], vertices[ face.b ], vertices[ face.c ] );\r\n\r\n\t\t\tvar vertexNormals = face.vertexNormals;\r\n\r\n\t\t\tif ( vertexNormals.length === 3 ) {\r\n\r\n\t\t\t\tthis.normals.push( vertexNormals[ 0 ], vertexNormals[ 1 ], vertexNormals[ 2 ] );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tvar normal = face.normal;\r\n\r\n\t\t\t\tthis.normals.push( normal, normal, normal );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar vertexColors = face.vertexColors;\r\n\r\n\t\t\tif ( vertexColors.length === 3 ) {\r\n\r\n\t\t\t\tthis.colors.push( vertexColors[ 0 ], vertexColors[ 1 ], vertexColors[ 2 ] );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tvar color = face.color;\r\n\r\n\t\t\t\tthis.colors.push( color, color, color );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( hasFaceVertexUv === true ) {\r\n\r\n\t\t\t\tvar vertexUvs = faceVertexUvs[ 0 ][ i ];\r\n\r\n\t\t\t\tif ( vertexUvs !== undefined ) {\r\n\r\n\t\t\t\t\tthis.uvs.push( vertexUvs[ 0 ], vertexUvs[ 1 ], vertexUvs[ 2 ] );\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tconsole.warn( 'THREE.DirectGeometry.fromGeometry(): Undefined vertexUv ', i );\r\n\r\n\t\t\t\t\tthis.uvs.push( new THREE.Vector2(), new THREE.Vector2(), new THREE.Vector2() );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( hasFaceVertexUv2 === true ) {\r\n\r\n\t\t\t\tvar vertexUvs = faceVertexUvs[ 1 ][ i ];\r\n\r\n\t\t\t\tif ( vertexUvs !== undefined ) {\r\n\r\n\t\t\t\t\tthis.uvs2.push( vertexUvs[ 0 ], vertexUvs[ 1 ], vertexUvs[ 2 ] );\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tconsole.warn( 'THREE.DirectGeometry.fromGeometry(): Undefined vertexUv2 ', i );\r\n\r\n\t\t\t\t\tthis.uvs2.push( new THREE.Vector2(), new THREE.Vector2(), new THREE.Vector2() );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// morphs\r\n\r\n\t\t\tfor ( var j = 0; j < morphTargetsLength; j ++ ) {\r\n\r\n\t\t\t\tvar morphTarget = morphTargets[ j ].vertices;\r\n\r\n\t\t\t\tmorphTargetsPosition[ j ].push( morphTarget[ face.a ], morphTarget[ face.b ], morphTarget[ face.c ] );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tfor ( var j = 0; j < morphNormalsLength; j ++ ) {\r\n\r\n\t\t\t\tvar morphNormal = morphNormals[ j ].vertexNormals[ i ];\r\n\r\n\t\t\t\tmorphTargetsNormal[ j ].push( morphNormal.a, morphNormal.b, morphNormal.c );\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// skins\r\n\r\n\t\t\tif ( hasSkinIndices ) {\r\n\r\n\t\t\t\tthis.skinIndices.push( skinIndices[ face.a ], skinIndices[ face.b ], skinIndices[ face.c ] );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( hasSkinWeights ) {\r\n\r\n\t\t\t\tthis.skinWeights.push( skinWeights[ face.a ], skinWeights[ face.b ], skinWeights[ face.c ] );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tthis.computeGroups( geometry );\r\n\r\n\t\tthis.verticesNeedUpdate = geometry.verticesNeedUpdate;\r\n\t\tthis.normalsNeedUpdate = geometry.normalsNeedUpdate;\r\n\t\tthis.colorsNeedUpdate = geometry.colorsNeedUpdate;\r\n\t\tthis.uvsNeedUpdate = geometry.uvsNeedUpdate;\r\n\t\tthis.groupsNeedUpdate = geometry.groupsNeedUpdate;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tdispose: function () {\r\n\r\n\t\tthis.dispatchEvent( { type: 'dispose' } );\r\n\r\n\t}\r\n\r\n};\r\n\r\nTHREE.EventDispatcher.prototype.apply( THREE.DirectGeometry.prototype );\r\n\r\n// File:src/core/BufferGeometry.js\r\n\r\n/**\r\n * @author alteredq / http://alteredqualia.com/\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.BufferGeometry = function () {\r\n\r\n\tObject.defineProperty( this, 'id', { value: THREE.GeometryIdCount ++ } );\r\n\r\n\tthis.uuid = THREE.Math.generateUUID();\r\n\r\n\tthis.name = '';\r\n\tthis.type = 'BufferGeometry';\r\n\r\n\tthis.index = null;\r\n\tthis.attributes = {};\r\n\r\n\tthis.morphAttributes = {};\r\n\r\n\tthis.groups = [];\r\n\r\n\tthis.boundingBox = null;\r\n\tthis.boundingSphere = null;\r\n\r\n\tthis.drawRange = { start: 0, count: Infinity };\r\n\r\n};\r\n\r\nTHREE.BufferGeometry.prototype = {\r\n\r\n\tconstructor: THREE.BufferGeometry,\r\n\r\n\tgetIndex: function () {\r\n\r\n\t\treturn this.index;\r\n\r\n\t},\r\n\r\n\tsetIndex: function ( index ) {\r\n\r\n\t\tthis.index = index;\r\n\r\n\t},\r\n\r\n\taddAttribute: function ( name, attribute ) {\r\n\r\n\t\tif ( attribute instanceof THREE.BufferAttribute === false && attribute instanceof THREE.InterleavedBufferAttribute === false ) {\r\n\r\n\t\t\tconsole.warn( 'THREE.BufferGeometry: .addAttribute() now expects ( name, attribute ).' );\r\n\r\n\t\t\tthis.addAttribute( name, new THREE.BufferAttribute( arguments[ 1 ], arguments[ 2 ] ) );\r\n\r\n\t\t\treturn;\r\n\r\n\t\t}\r\n\r\n\t\tif ( name === 'index' ) {\r\n\r\n\t\t\tconsole.warn( 'THREE.BufferGeometry.addAttribute: Use .setIndex() for index attribute.' );\r\n\t\t\tthis.setIndex( attribute );\r\n\r\n\t\t\treturn;\r\n\r\n\t\t}\r\n\r\n\t\tthis.attributes[ name ] = attribute;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tgetAttribute: function ( name ) {\r\n\r\n\t\treturn this.attributes[ name ];\r\n\r\n\t},\r\n\r\n\tremoveAttribute: function ( name ) {\r\n\r\n\t\tdelete this.attributes[ name ];\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\taddGroup: function ( start, count, materialIndex ) {\r\n\r\n\t\tthis.groups.push( {\r\n\r\n\t\t\tstart: start,\r\n\t\t\tcount: count,\r\n\t\t\tmaterialIndex: materialIndex !== undefined ? materialIndex : 0\r\n\r\n\t\t} );\r\n\r\n\t},\r\n\r\n\tclearGroups: function () {\r\n\r\n\t\tthis.groups = [];\r\n\r\n\t},\r\n\r\n\tsetDrawRange: function ( start, count ) {\r\n\r\n\t\tthis.drawRange.start = start;\r\n\t\tthis.drawRange.count = count;\r\n\r\n\t},\r\n\r\n\tapplyMatrix: function ( matrix ) {\r\n\r\n\t\tvar position = this.attributes.position;\r\n\r\n\t\tif ( position !== undefined ) {\r\n\r\n\t\t\tmatrix.applyToVector3Array( position.array );\r\n\t\t\tposition.needsUpdate = true;\r\n\r\n\t\t}\r\n\r\n\t\tvar normal = this.attributes.normal;\r\n\r\n\t\tif ( normal !== undefined ) {\r\n\r\n\t\t\tvar normalMatrix = new THREE.Matrix3().getNormalMatrix( matrix );\r\n\r\n\t\t\tnormalMatrix.applyToVector3Array( normal.array );\r\n\t\t\tnormal.needsUpdate = true;\r\n\r\n\t\t}\r\n\r\n\t\tif ( this.boundingBox !== null ) {\r\n\r\n\t\t\tthis.computeBoundingBox();\r\n\r\n\t\t}\r\n\r\n\t\tif ( this.boundingSphere !== null ) {\r\n\r\n\t\t\tthis.computeBoundingSphere();\r\n\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\trotateX: function () {\r\n\r\n\t\t// rotate geometry around world x-axis\r\n\r\n\t\tvar m1;\r\n\r\n\t\treturn function rotateX( angle ) {\r\n\r\n\t\t\tif ( m1 === undefined ) m1 = new THREE.Matrix4();\r\n\r\n\t\t\tm1.makeRotationX( angle );\r\n\r\n\t\t\tthis.applyMatrix( m1 );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\trotateY: function () {\r\n\r\n\t\t// rotate geometry around world y-axis\r\n\r\n\t\tvar m1;\r\n\r\n\t\treturn function rotateY( angle ) {\r\n\r\n\t\t\tif ( m1 === undefined ) m1 = new THREE.Matrix4();\r\n\r\n\t\t\tm1.makeRotationY( angle );\r\n\r\n\t\t\tthis.applyMatrix( m1 );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\trotateZ: function () {\r\n\r\n\t\t// rotate geometry around world z-axis\r\n\r\n\t\tvar m1;\r\n\r\n\t\treturn function rotateZ( angle ) {\r\n\r\n\t\t\tif ( m1 === undefined ) m1 = new THREE.Matrix4();\r\n\r\n\t\t\tm1.makeRotationZ( angle );\r\n\r\n\t\t\tthis.applyMatrix( m1 );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\ttranslate: function () {\r\n\r\n\t\t// translate geometry\r\n\r\n\t\tvar m1;\r\n\r\n\t\treturn function translate( x, y, z ) {\r\n\r\n\t\t\tif ( m1 === undefined ) m1 = new THREE.Matrix4();\r\n\r\n\t\t\tm1.makeTranslation( x, y, z );\r\n\r\n\t\t\tthis.applyMatrix( m1 );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\tscale: function () {\r\n\r\n\t\t// scale geometry\r\n\r\n\t\tvar m1;\r\n\r\n\t\treturn function scale( x, y, z ) {\r\n\r\n\t\t\tif ( m1 === undefined ) m1 = new THREE.Matrix4();\r\n\r\n\t\t\tm1.makeScale( x, y, z );\r\n\r\n\t\t\tthis.applyMatrix( m1 );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\tlookAt: function () {\r\n\r\n\t\tvar obj;\r\n\r\n\t\treturn function lookAt( vector ) {\r\n\r\n\t\t\tif ( obj === undefined ) obj = new THREE.Object3D();\r\n\r\n\t\t\tobj.lookAt( vector );\r\n\r\n\t\t\tobj.updateMatrix();\r\n\r\n\t\t\tthis.applyMatrix( obj.matrix );\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\tcenter: function () {\r\n\r\n\t\tthis.computeBoundingBox();\r\n\r\n\t\tvar offset = this.boundingBox.center().negate();\r\n\r\n\t\tthis.translate( offset.x, offset.y, offset.z );\r\n\r\n\t\treturn offset;\r\n\r\n\t},\r\n\r\n\tsetFromObject: function ( object ) {\r\n\r\n\t\t// console.log( 'THREE.BufferGeometry.setFromObject(). Converting', object, this );\r\n\r\n\t\tvar geometry = object.geometry;\r\n\r\n\t\tif ( object instanceof THREE.Points || object instanceof THREE.Line ) {\r\n\r\n\t\t\tvar positions = new THREE.Float32Attribute( geometry.vertices.length * 3, 3 );\r\n\t\t\tvar colors = new THREE.Float32Attribute( geometry.colors.length * 3, 3 );\r\n\r\n\t\t\tthis.addAttribute( 'position', positions.copyVector3sArray( geometry.vertices ) );\r\n\t\t\tthis.addAttribute( 'color', colors.copyColorsArray( geometry.colors ) );\r\n\r\n\t\t\tif ( geometry.lineDistances && geometry.lineDistances.length === geometry.vertices.length ) {\r\n\r\n\t\t\t\tvar lineDistances = new THREE.Float32Attribute( geometry.lineDistances.length, 1 );\r\n\r\n\t\t\t\tthis.addAttribute( 'lineDistance', lineDistances.copyArray( geometry.lineDistances ) );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( geometry.boundingSphere !== null ) {\r\n\r\n\t\t\t\tthis.boundingSphere = geometry.boundingSphere.clone();\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( geometry.boundingBox !== null ) {\r\n\r\n\t\t\t\tthis.boundingBox = geometry.boundingBox.clone();\r\n\r\n\t\t\t}\r\n\r\n\t\t} else if ( object instanceof THREE.Mesh ) {\r\n\r\n\t\t\tif ( geometry instanceof THREE.Geometry ) {\r\n\r\n\t\t\t\tthis.fromGeometry( geometry );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tupdateFromObject: function ( object ) {\r\n\r\n\t\tvar geometry = object.geometry;\r\n\r\n\t\tif ( object instanceof THREE.Mesh ) {\r\n\r\n\t\t\tvar direct = geometry.__directGeometry;\r\n\r\n\t\t\tif ( direct === undefined ) {\r\n\r\n\t\t\t\treturn this.fromGeometry( geometry );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tdirect.verticesNeedUpdate = geometry.verticesNeedUpdate;\r\n\t\t\tdirect.normalsNeedUpdate = geometry.normalsNeedUpdate;\r\n\t\t\tdirect.colorsNeedUpdate = geometry.colorsNeedUpdate;\r\n\t\t\tdirect.uvsNeedUpdate = geometry.uvsNeedUpdate;\r\n\t\t\tdirect.groupsNeedUpdate = geometry.groupsNeedUpdate;\r\n\r\n\t\t\tgeometry.verticesNeedUpdate = false;\r\n\t\t\tgeometry.normalsNeedUpdate = false;\r\n\t\t\tgeometry.colorsNeedUpdate = false;\r\n\t\t\tgeometry.uvsNeedUpdate = false;\r\n\t\t\tgeometry.groupsNeedUpdate = false;\r\n\r\n\t\t\tgeometry = direct;\r\n\r\n\t\t}\r\n\r\n\t\tif ( geometry.verticesNeedUpdate === true ) {\r\n\r\n\t\t\tvar attribute = this.attributes.position;\r\n\r\n\t\t\tif ( attribute !== undefined ) {\r\n\r\n\t\t\t\tattribute.copyVector3sArray( geometry.vertices );\r\n\t\t\t\tattribute.needsUpdate = true;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tgeometry.verticesNeedUpdate = false;\r\n\r\n\t\t}\r\n\r\n\t\tif ( geometry.normalsNeedUpdate === true ) {\r\n\r\n\t\t\tvar attribute = this.attributes.normal;\r\n\r\n\t\t\tif ( attribute !== undefined ) {\r\n\r\n\t\t\t\tattribute.copyVector3sArray( geometry.normals );\r\n\t\t\t\tattribute.needsUpdate = true;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tgeometry.normalsNeedUpdate = false;\r\n\r\n\t\t}\r\n\r\n\t\tif ( geometry.colorsNeedUpdate === true ) {\r\n\r\n\t\t\tvar attribute = this.attributes.color;\r\n\r\n\t\t\tif ( attribute !== undefined ) {\r\n\r\n\t\t\t\tattribute.copyColorsArray( geometry.colors );\r\n\t\t\t\tattribute.needsUpdate = true;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tgeometry.colorsNeedUpdate = false;\r\n\r\n\t\t}\r\n\r\n\t\tif ( geometry.uvsNeedUpdate ) {\r\n\r\n\t\t\tvar attribute = this.attributes.uv;\r\n\r\n\t\t\tif ( attribute !== undefined ) {\r\n\r\n\t\t\t\tattribute.copyVector2sArray( geometry.uvs );\r\n\t\t\t\tattribute.needsUpdate = true;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tgeometry.uvsNeedUpdate = false;\r\n\r\n\t\t}\r\n\r\n\t\tif ( geometry.lineDistancesNeedUpdate ) {\r\n\r\n\t\t\tvar attribute = this.attributes.lineDistance;\r\n\r\n\t\t\tif ( attribute !== undefined ) {\r\n\r\n\t\t\t\tattribute.copyArray( geometry.lineDistances );\r\n\t\t\t\tattribute.needsUpdate = true;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tgeometry.lineDistancesNeedUpdate = false;\r\n\r\n\t\t}\r\n\r\n\t\tif ( geometry.groupsNeedUpdate ) {\r\n\r\n\t\t\tgeometry.computeGroups( object.geometry );\r\n\t\t\tthis.groups = geometry.groups;\r\n\r\n\t\t\tgeometry.groupsNeedUpdate = false;\r\n\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tfromGeometry: function ( geometry ) {\r\n\r\n\t\tgeometry.__directGeometry = new THREE.DirectGeometry().fromGeometry( geometry );\r\n\r\n\t\treturn this.fromDirectGeometry( geometry.__directGeometry );\r\n\r\n\t},\r\n\r\n\tfromDirectGeometry: function ( geometry ) {\r\n\r\n\t\tvar positions = new Float32Array( geometry.vertices.length * 3 );\r\n\t\tthis.addAttribute( 'position', new THREE.BufferAttribute( positions, 3 ).copyVector3sArray( geometry.vertices ) );\r\n\r\n\t\tif ( geometry.normals.length > 0 ) {\r\n\r\n\t\t\tvar normals = new Float32Array( geometry.normals.length * 3 );\r\n\t\t\tthis.addAttribute( 'normal', new THREE.BufferAttribute( normals, 3 ).copyVector3sArray( geometry.normals ) );\r\n\r\n\t\t}\r\n\r\n\t\tif ( geometry.colors.length > 0 ) {\r\n\r\n\t\t\tvar colors = new Float32Array( geometry.colors.length * 3 );\r\n\t\t\tthis.addAttribute( 'color', new THREE.BufferAttribute( colors, 3 ).copyColorsArray( geometry.colors ) );\r\n\r\n\t\t}\r\n\r\n\t\tif ( geometry.uvs.length > 0 ) {\r\n\r\n\t\t\tvar uvs = new Float32Array( geometry.uvs.length * 2 );\r\n\t\t\tthis.addAttribute( 'uv', new THREE.BufferAttribute( uvs, 2 ).copyVector2sArray( geometry.uvs ) );\r\n\r\n\t\t}\r\n\r\n\t\tif ( geometry.uvs2.length > 0 ) {\r\n\r\n\t\t\tvar uvs2 = new Float32Array( geometry.uvs2.length * 2 );\r\n\t\t\tthis.addAttribute( 'uv2', new THREE.BufferAttribute( uvs2, 2 ).copyVector2sArray( geometry.uvs2 ) );\r\n\r\n\t\t}\r\n\r\n\t\tif ( geometry.indices.length > 0 ) {\r\n\r\n\t\t\tvar TypeArray = geometry.vertices.length > 65535 ? Uint32Array : Uint16Array;\r\n\t\t\tvar indices = new TypeArray( geometry.indices.length * 3 );\r\n\t\t\tthis.setIndex( new THREE.BufferAttribute( indices, 1 ).copyIndicesArray( geometry.indices ) );\r\n\r\n\t\t}\r\n\r\n\t\t// groups\r\n\r\n\t\tthis.groups = geometry.groups;\r\n\r\n\t\t// morphs\r\n\r\n\t\tfor ( var name in geometry.morphTargets ) {\r\n\r\n\t\t\tvar array = [];\r\n\t\t\tvar morphTargets = geometry.morphTargets[ name ];\r\n\r\n\t\t\tfor ( var i = 0, l = morphTargets.length; i < l; i ++ ) {\r\n\r\n\t\t\t\tvar morphTarget = morphTargets[ i ];\r\n\r\n\t\t\t\tvar attribute = new THREE.Float32Attribute( morphTarget.length * 3, 3 );\r\n\r\n\t\t\t\tarray.push( attribute.copyVector3sArray( morphTarget ) );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tthis.morphAttributes[ name ] = array;\r\n\r\n\t\t}\r\n\r\n\t\t// skinning\r\n\r\n\t\tif ( geometry.skinIndices.length > 0 ) {\r\n\r\n\t\t\tvar skinIndices = new THREE.Float32Attribute( geometry.skinIndices.length * 4, 4 );\r\n\t\t\tthis.addAttribute( 'skinIndex', skinIndices.copyVector4sArray( geometry.skinIndices ) );\r\n\r\n\t\t}\r\n\r\n\t\tif ( geometry.skinWeights.length > 0 ) {\r\n\r\n\t\t\tvar skinWeights = new THREE.Float32Attribute( geometry.skinWeights.length * 4, 4 );\r\n\t\t\tthis.addAttribute( 'skinWeight', skinWeights.copyVector4sArray( geometry.skinWeights ) );\r\n\r\n\t\t}\r\n\r\n\t\t//\r\n\r\n\t\tif ( geometry.boundingSphere !== null ) {\r\n\r\n\t\t\tthis.boundingSphere = geometry.boundingSphere.clone();\r\n\r\n\t\t}\r\n\r\n\t\tif ( geometry.boundingBox !== null ) {\r\n\r\n\t\t\tthis.boundingBox = geometry.boundingBox.clone();\r\n\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tcomputeBoundingBox: function () {\r\n\r\n\t\tif ( this.boundingBox === null ) {\r\n\r\n\t\t\tthis.boundingBox = new THREE.Box3();\r\n\r\n\t\t}\r\n\r\n\t\tvar positions = this.attributes.position.array;\r\n\r\n\t\tif ( positions !== undefined ) {\r\n\r\n\t\t\tthis.boundingBox.setFromArray( positions );\r\n\r\n\t\t} else {\r\n\r\n\t\t\tthis.boundingBox.makeEmpty();\r\n\r\n\t\t}\r\n\r\n\t\tif ( isNaN( this.boundingBox.min.x ) || isNaN( this.boundingBox.min.y ) || isNaN( this.boundingBox.min.z ) ) {\r\n\r\n\t\t\tconsole.error( 'THREE.BufferGeometry.computeBoundingBox: Computed min/max have NaN values. The \"position\" attribute is likely to have NaN values.', this );\r\n\r\n\t\t}\r\n\r\n\t},\r\n\r\n\tcomputeBoundingSphere: function () {\r\n\r\n\t\tvar box = new THREE.Box3();\r\n\t\tvar vector = new THREE.Vector3();\r\n\r\n\t\treturn function () {\r\n\r\n\t\t\tif ( this.boundingSphere === null ) {\r\n\r\n\t\t\t\tthis.boundingSphere = new THREE.Sphere();\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar positions = this.attributes.position.array;\r\n\r\n\t\t\tif ( positions ) {\r\n\r\n\t\t\t\tvar center = this.boundingSphere.center;\r\n\r\n\t\t\t\tbox.setFromArray( positions );\r\n\t\t\t\tbox.center( center );\r\n\r\n\t\t\t\t// hoping to find a boundingSphere with a radius smaller than the\r\n\t\t\t\t// boundingSphere of the boundingBox: sqrt(3) smaller in the best case\r\n\r\n\t\t\t\tvar maxRadiusSq = 0;\r\n\r\n\t\t\t\tfor ( var i = 0, il = positions.length; i < il; i += 3 ) {\r\n\r\n\t\t\t\t\tvector.fromArray( positions, i );\r\n\t\t\t\t\tmaxRadiusSq = Math.max( maxRadiusSq, center.distanceToSquared( vector ) );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tthis.boundingSphere.radius = Math.sqrt( maxRadiusSq );\r\n\r\n\t\t\t\tif ( isNaN( this.boundingSphere.radius ) ) {\r\n\r\n\t\t\t\t\tconsole.error( 'THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The \"position\" attribute is likely to have NaN values.', this );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\tcomputeFaceNormals: function () {\r\n\r\n\t\t// backwards compatibility\r\n\r\n\t},\r\n\r\n\tcomputeVertexNormals: function () {\r\n\r\n\t\tvar index = this.index;\r\n\t\tvar attributes = this.attributes;\r\n\t\tvar groups = this.groups;\r\n\r\n\t\tif ( attributes.position ) {\r\n\r\n\t\t\tvar positions = attributes.position.array;\r\n\r\n\t\t\tif ( attributes.normal === undefined ) {\r\n\r\n\t\t\t\tthis.addAttribute( 'normal', new THREE.BufferAttribute( new Float32Array( positions.length ), 3 ) );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\t// reset existing normals to zero\r\n\r\n\t\t\t\tvar array = attributes.normal.array;\r\n\r\n\t\t\t\tfor ( var i = 0, il = array.length; i < il; i ++ ) {\r\n\r\n\t\t\t\t\tarray[ i ] = 0;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar normals = attributes.normal.array;\r\n\r\n\t\t\tvar vA, vB, vC,\r\n\r\n\t\t\tpA = new THREE.Vector3(),\r\n\t\t\tpB = new THREE.Vector3(),\r\n\t\t\tpC = new THREE.Vector3(),\r\n\r\n\t\t\tcb = new THREE.Vector3(),\r\n\t\t\tab = new THREE.Vector3();\r\n\r\n\t\t\t// indexed elements\r\n\r\n\t\t\tif ( index ) {\r\n\r\n\t\t\t\tvar indices = index.array;\r\n\r\n\t\t\t\tif ( groups.length === 0 ) {\r\n\r\n\t\t\t\t\tthis.addGroup( 0, indices.length );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tfor ( var j = 0, jl = groups.length; j < jl; ++ j ) {\r\n\r\n\t\t\t\t\tvar group = groups[ j ];\r\n\r\n\t\t\t\t\tvar start = group.start;\r\n\t\t\t\t\tvar count = group.count;\r\n\r\n\t\t\t\t\tfor ( var i = start, il = start + count; i < il; i += 3 ) {\r\n\r\n\t\t\t\t\t\tvA = indices[ i + 0 ] * 3;\r\n\t\t\t\t\t\tvB = indices[ i + 1 ] * 3;\r\n\t\t\t\t\t\tvC = indices[ i + 2 ] * 3;\r\n\r\n\t\t\t\t\t\tpA.fromArray( positions, vA );\r\n\t\t\t\t\t\tpB.fromArray( positions, vB );\r\n\t\t\t\t\t\tpC.fromArray( positions, vC );\r\n\r\n\t\t\t\t\t\tcb.subVectors( pC, pB );\r\n\t\t\t\t\t\tab.subVectors( pA, pB );\r\n\t\t\t\t\t\tcb.cross( ab );\r\n\r\n\t\t\t\t\t\tnormals[ vA ] += cb.x;\r\n\t\t\t\t\t\tnormals[ vA + 1 ] += cb.y;\r\n\t\t\t\t\t\tnormals[ vA + 2 ] += cb.z;\r\n\r\n\t\t\t\t\t\tnormals[ vB ] += cb.x;\r\n\t\t\t\t\t\tnormals[ vB + 1 ] += cb.y;\r\n\t\t\t\t\t\tnormals[ vB + 2 ] += cb.z;\r\n\r\n\t\t\t\t\t\tnormals[ vC ] += cb.x;\r\n\t\t\t\t\t\tnormals[ vC + 1 ] += cb.y;\r\n\t\t\t\t\t\tnormals[ vC + 2 ] += cb.z;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\t// non-indexed elements (unconnected triangle soup)\r\n\r\n\t\t\t\tfor ( var i = 0, il = positions.length; i < il; i += 9 ) {\r\n\r\n\t\t\t\t\tpA.fromArray( positions, i );\r\n\t\t\t\t\tpB.fromArray( positions, i + 3 );\r\n\t\t\t\t\tpC.fromArray( positions, i + 6 );\r\n\r\n\t\t\t\t\tcb.subVectors( pC, pB );\r\n\t\t\t\t\tab.subVectors( pA, pB );\r\n\t\t\t\t\tcb.cross( ab );\r\n\r\n\t\t\t\t\tnormals[ i ] = cb.x;\r\n\t\t\t\t\tnormals[ i + 1 ] = cb.y;\r\n\t\t\t\t\tnormals[ i + 2 ] = cb.z;\r\n\r\n\t\t\t\t\tnormals[ i + 3 ] = cb.x;\r\n\t\t\t\t\tnormals[ i + 4 ] = cb.y;\r\n\t\t\t\t\tnormals[ i + 5 ] = cb.z;\r\n\r\n\t\t\t\t\tnormals[ i + 6 ] = cb.x;\r\n\t\t\t\t\tnormals[ i + 7 ] = cb.y;\r\n\t\t\t\t\tnormals[ i + 8 ] = cb.z;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tthis.normalizeNormals();\r\n\r\n\t\t\tattributes.normal.needsUpdate = true;\r\n\r\n\t\t}\r\n\r\n\t},\r\n\r\n\tmerge: function ( geometry, offset ) {\r\n\r\n\t\tif ( geometry instanceof THREE.BufferGeometry === false ) {\r\n\r\n\t\t\tconsole.error( 'THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.', geometry );\r\n\t\t\treturn;\r\n\r\n\t\t}\r\n\r\n\t\tif ( offset === undefined ) offset = 0;\r\n\r\n\t\tvar attributes = this.attributes;\r\n\r\n\t\tfor ( var key in attributes ) {\r\n\r\n\t\t\tif ( geometry.attributes[ key ] === undefined ) continue;\r\n\r\n\t\t\tvar attribute1 = attributes[ key ];\r\n\t\t\tvar attributeArray1 = attribute1.array;\r\n\r\n\t\t\tvar attribute2 = geometry.attributes[ key ];\r\n\t\t\tvar attributeArray2 = attribute2.array;\r\n\r\n\t\t\tvar attributeSize = attribute2.itemSize;\r\n\r\n\t\t\tfor ( var i = 0, j = attributeSize * offset; i < attributeArray2.length; i ++, j ++ ) {\r\n\r\n\t\t\t\tattributeArray1[ j ] = attributeArray2[ i ];\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tnormalizeNormals: function () {\r\n\r\n\t\tvar normals = this.attributes.normal.array;\r\n\r\n\t\tvar x, y, z, n;\r\n\r\n\t\tfor ( var i = 0, il = normals.length; i < il; i += 3 ) {\r\n\r\n\t\t\tx = normals[ i ];\r\n\t\t\ty = normals[ i + 1 ];\r\n\t\t\tz = normals[ i + 2 ];\r\n\r\n\t\t\tn = 1.0 / Math.sqrt( x * x + y * y + z * z );\r\n\r\n\t\t\tnormals[ i ] *= n;\r\n\t\t\tnormals[ i + 1 ] *= n;\r\n\t\t\tnormals[ i + 2 ] *= n;\r\n\r\n\t\t}\r\n\r\n\t},\r\n\r\n\ttoNonIndexed: function () {\r\n\r\n\t\tif ( this.index === null ) {\r\n\r\n\t\t\tconsole.warn( 'THREE.BufferGeometry.toNonIndexed(): Geometry is already non-indexed.' );\r\n\t\t\treturn this;\r\n\r\n\t\t}\r\n\r\n\t\tvar geometry2 = new THREE.BufferGeometry();\r\n\r\n\t\tvar indices = this.index.array;\r\n\t\tvar attributes = this.attributes;\r\n\r\n\t\tfor ( var name in attributes ) {\r\n\r\n\t\t\tvar attribute = attributes[ name ];\r\n\r\n\t\t\tvar array = attribute.array;\r\n\t\t\tvar itemSize = attribute.itemSize;\r\n\r\n\t\t\tvar array2 = new array.constructor( indices.length * itemSize );\r\n\r\n\t\t\tvar index = 0, index2 = 0;\r\n\r\n\t\t\tfor ( var i = 0, l = indices.length; i < l; i ++ ) {\r\n\r\n\t\t\t\tindex = indices[ i ] * itemSize;\r\n\r\n\t\t\t\tfor ( var j = 0; j < itemSize; j ++ ) {\r\n\r\n\t\t\t\t\tarray2[ index2 ++ ] = array[ index ++ ];\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tgeometry2.addAttribute( name, new THREE.BufferAttribute( array2, itemSize ) );\r\n\r\n\t\t}\r\n\r\n\t\treturn geometry2;\r\n\r\n\t},\r\n\r\n\ttoJSON: function () {\r\n\r\n\t\tvar data = {\r\n\t\t\tmetadata: {\r\n\t\t\t\tversion: 4.4,\r\n\t\t\t\ttype: 'BufferGeometry',\r\n\t\t\t\tgenerator: 'BufferGeometry.toJSON'\r\n\t\t\t}\r\n\t\t};\r\n\r\n\t\t// standard BufferGeometry serialization\r\n\r\n\t\tdata.uuid = this.uuid;\r\n\t\tdata.type = this.type;\r\n\t\tif ( this.name !== '' ) data.name = this.name;\r\n\r\n\t\tif ( this.parameters !== undefined ) {\r\n\r\n\t\t\tvar parameters = this.parameters;\r\n\r\n\t\t\tfor ( var key in parameters ) {\r\n\r\n\t\t\t\tif ( parameters[ key ] !== undefined ) data[ key ] = parameters[ key ];\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn data;\r\n\r\n\t\t}\r\n\r\n\t\tdata.data = { attributes: {} };\r\n\r\n\t\tvar index = this.index;\r\n\r\n\t\tif ( index !== null ) {\r\n\r\n\t\t\tvar array = Array.prototype.slice.call( index.array );\r\n\r\n\t\t\tdata.data.index = {\r\n\t\t\t\ttype: index.array.constructor.name,\r\n\t\t\t\tarray: array\r\n\t\t\t};\r\n\r\n\t\t}\r\n\r\n\t\tvar attributes = this.attributes;\r\n\r\n\t\tfor ( var key in attributes ) {\r\n\r\n\t\t\tvar attribute = attributes[ key ];\r\n\r\n\t\t\tvar array = Array.prototype.slice.call( attribute.array );\r\n\r\n\t\t\tdata.data.attributes[ key ] = {\r\n\t\t\t\titemSize: attribute.itemSize,\r\n\t\t\t\ttype: attribute.array.constructor.name,\r\n\t\t\t\tarray: array,\r\n\t\t\t\tnormalized: attribute.normalized\r\n\t\t\t};\r\n\r\n\t\t}\r\n\r\n\t\tvar groups = this.groups;\r\n\r\n\t\tif ( groups.length > 0 ) {\r\n\r\n\t\t\tdata.data.groups = JSON.parse( JSON.stringify( groups ) );\r\n\r\n\t\t}\r\n\r\n\t\tvar boundingSphere = this.boundingSphere;\r\n\r\n\t\tif ( boundingSphere !== null ) {\r\n\r\n\t\t\tdata.data.boundingSphere = {\r\n\t\t\t\tcenter: boundingSphere.center.toArray(),\r\n\t\t\t\tradius: boundingSphere.radius\r\n\t\t\t};\r\n\r\n\t\t}\r\n\r\n\t\treturn data;\r\n\r\n\t},\r\n\r\n\tclone: function () {\r\n\r\n\t\t/*\r\n\t\t// Handle primitives\r\n\r\n\t\tvar parameters = this.parameters;\r\n\r\n\t\tif ( parameters !== undefined ) {\r\n\r\n\t\t\tvar values = [];\r\n\r\n\t\t\tfor ( var key in parameters ) {\r\n\r\n\t\t\t\tvalues.push( parameters[ key ] );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar geometry = Object.create( this.constructor.prototype );\r\n\t\t\tthis.constructor.apply( geometry, values );\r\n\t\t\treturn geometry;\r\n\r\n\t\t}\r\n\r\n\t\treturn new this.constructor().copy( this );\r\n\t\t*/\r\n\r\n\t\treturn new THREE.BufferGeometry().copy( this );\r\n\r\n\t},\r\n\r\n\tcopy: function ( source ) {\r\n\r\n\t\tvar index = source.index;\r\n\r\n\t\tif ( index !== null ) {\r\n\r\n\t\t\tthis.setIndex( index.clone() );\r\n\r\n\t\t}\r\n\r\n\t\tvar attributes = source.attributes;\r\n\r\n\t\tfor ( var name in attributes ) {\r\n\r\n\t\t\tvar attribute = attributes[ name ];\r\n\t\t\tthis.addAttribute( name, attribute.clone() );\r\n\r\n\t\t}\r\n\r\n\t\tvar groups = source.groups;\r\n\r\n\t\tfor ( var i = 0, l = groups.length; i < l; i ++ ) {\r\n\r\n\t\t\tvar group = groups[ i ];\r\n\t\t\tthis.addGroup( group.start, group.count, group.materialIndex );\r\n\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tdispose: function () {\r\n\r\n\t\tthis.dispatchEvent( { type: 'dispose' } );\r\n\r\n\t}\r\n\r\n};\r\n\r\nTHREE.EventDispatcher.prototype.apply( THREE.BufferGeometry.prototype );\r\n\r\nTHREE.BufferGeometry.MaxIndex = 65535;\r\n\r\n// File:src/core/InstancedBufferGeometry.js\r\n\r\n/**\r\n * @author benaadams / https://twitter.com/ben_a_adams\r\n */\r\n\r\nTHREE.InstancedBufferGeometry = function () {\r\n\r\n\tTHREE.BufferGeometry.call( this );\r\n\r\n\tthis.type = 'InstancedBufferGeometry';\r\n\tthis.maxInstancedCount = undefined;\r\n\r\n};\r\n\r\nTHREE.InstancedBufferGeometry.prototype = Object.create( THREE.BufferGeometry.prototype );\r\nTHREE.InstancedBufferGeometry.prototype.constructor = THREE.InstancedBufferGeometry;\r\n\r\nTHREE.InstancedBufferGeometry.prototype.addGroup = function ( start, count, instances ) {\r\n\r\n\tthis.groups.push( {\r\n\r\n\t\tstart: start,\r\n\t\tcount: count,\r\n\t\tinstances: instances\r\n\r\n\t} );\r\n\r\n};\r\n\r\nTHREE.InstancedBufferGeometry.prototype.copy = function ( source ) {\r\n\r\n\tvar index = source.index;\r\n\r\n\tif ( index !== null ) {\r\n\r\n\t\tthis.setIndex( index.clone() );\r\n\r\n\t}\r\n\r\n\tvar attributes = source.attributes;\r\n\r\n\tfor ( var name in attributes ) {\r\n\r\n\t\tvar attribute = attributes[ name ];\r\n\t\tthis.addAttribute( name, attribute.clone() );\r\n\r\n\t}\r\n\r\n\tvar groups = source.groups;\r\n\r\n\tfor ( var i = 0, l = groups.length; i < l; i ++ ) {\r\n\r\n\t\tvar group = groups[ i ];\r\n\t\tthis.addGroup( group.start, group.count, group.instances );\r\n\r\n\t}\r\n\r\n\treturn this;\r\n\r\n};\r\n\r\nTHREE.EventDispatcher.prototype.apply( THREE.InstancedBufferGeometry.prototype );\r\n\r\n// File:src/core/Uniform.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.Uniform = function ( value ) {\r\n\r\n\tif ( typeof value === 'string' ) {\r\n\r\n\t\tconsole.warn( 'THREE.Uniform: Type parameter is no longer needed.' );\r\n\t\tvalue = arguments[ 1 ];\r\n\r\n\t}\r\n\r\n\tthis.value = value;\r\n\r\n\tthis.dynamic = false;\r\n\r\n};\r\n\r\nTHREE.Uniform.prototype = {\r\n\r\n\tconstructor: THREE.Uniform,\r\n\r\n\tonUpdate: function ( callback ) {\r\n\r\n\t\tthis.dynamic = true;\r\n\t\tthis.onUpdateCallback = callback;\r\n\r\n\t\treturn this;\r\n\r\n\t}\r\n\r\n};\r\n\r\n// File:src/animation/AnimationClip.js\r\n\r\n/**\r\n *\r\n * Reusable set of Tracks that represent an animation.\r\n *\r\n * @author Ben Houston / http://clara.io/\r\n * @author David Sarno / http://lighthaus.us/\r\n */\r\n\r\nTHREE.AnimationClip = function ( name, duration, tracks ) {\r\n\r\n\tthis.name = name || THREE.Math.generateUUID();\r\n\tthis.tracks = tracks;\r\n\tthis.duration = ( duration !== undefined ) ? duration : -1;\r\n\r\n\t// this means it should figure out its duration by scanning the tracks\r\n\tif ( this.duration < 0 ) {\r\n\r\n\t\tthis.resetDuration();\r\n\r\n\t}\r\n\r\n\t// maybe only do these on demand, as doing them here could potentially slow down loading\r\n\t// but leaving these here during development as this ensures a lot of testing of these functions\r\n\tthis.trim();\r\n\tthis.optimize();\r\n\r\n};\r\n\r\nTHREE.AnimationClip.prototype = {\r\n\r\n\tconstructor: THREE.AnimationClip,\r\n\r\n\tresetDuration: function() {\r\n\r\n\t\tvar tracks = this.tracks,\r\n\t\t\tduration = 0;\r\n\r\n\t\tfor ( var i = 0, n = tracks.length; i !== n; ++ i ) {\r\n\r\n\t\t\tvar track = this.tracks[ i ];\r\n\r\n\t\t\tduration = Math.max(\r\n\t\t\t\t\tduration, track.times[ track.times.length - 1 ] );\r\n\r\n\t\t}\r\n\r\n\t\tthis.duration = duration;\r\n\r\n\t},\r\n\r\n\ttrim: function() {\r\n\r\n\t\tfor ( var i = 0; i < this.tracks.length; i ++ ) {\r\n\r\n\t\t\tthis.tracks[ i ].trim( 0, this.duration );\r\n\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\toptimize: function() {\r\n\r\n\t\tfor ( var i = 0; i < this.tracks.length; i ++ ) {\r\n\r\n\t\t\tthis.tracks[ i ].optimize();\r\n\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\r\n\t}\r\n\r\n};\r\n\r\n// Static methods:\r\n\r\nObject.assign( THREE.AnimationClip, {\r\n\r\n\tparse: function( json ) {\r\n\r\n\t\tvar tracks = [],\r\n\t\t\tjsonTracks = json.tracks,\r\n\t\t\tframeTime = 1.0 / ( json.fps || 1.0 );\r\n\r\n\t\tfor ( var i = 0, n = jsonTracks.length; i !== n; ++ i ) {\r\n\r\n\t\t\ttracks.push( THREE.KeyframeTrack.parse( jsonTracks[ i ] ).scale( frameTime ) );\r\n\r\n\t\t}\r\n\r\n\t\treturn new THREE.AnimationClip( json.name, json.duration, tracks );\r\n\r\n\t},\r\n\r\n\r\n\ttoJSON: function( clip ) {\r\n\r\n\t\tvar tracks = [],\r\n\t\t\tclipTracks = clip.tracks;\r\n\r\n\t\tvar json = {\r\n\r\n\t\t\t'name': clip.name,\r\n\t\t\t'duration': clip.duration,\r\n\t\t\t'tracks': tracks\r\n\r\n\t\t};\r\n\r\n\t\tfor ( var i = 0, n = clipTracks.length; i !== n; ++ i ) {\r\n\r\n\t\t\ttracks.push( THREE.KeyframeTrack.toJSON( clipTracks[ i ] ) );\r\n\r\n\t\t}\r\n\r\n\t\treturn json;\r\n\r\n\t},\r\n\r\n\r\n\tCreateFromMorphTargetSequence: function( name, morphTargetSequence, fps, noLoop ) {\r\n\r\n\t\tvar numMorphTargets = morphTargetSequence.length;\r\n\t\tvar tracks = [];\r\n\r\n\t\tfor ( var i = 0; i < numMorphTargets; i ++ ) {\r\n\r\n\t\t\tvar times = [];\r\n\t\t\tvar values = [];\r\n\r\n\t\t\ttimes.push(\r\n\t\t\t\t\t( i + numMorphTargets - 1 ) % numMorphTargets,\r\n\t\t\t\t\ti,\r\n\t\t\t\t\t( i + 1 ) % numMorphTargets );\r\n\r\n\t\t\tvalues.push( 0, 1, 0 );\r\n\r\n\t\t\tvar order = THREE.AnimationUtils.getKeyframeOrder( times );\r\n\t\t\ttimes = THREE.AnimationUtils.sortedArray( times, 1, order );\r\n\t\t\tvalues = THREE.AnimationUtils.sortedArray( values, 1, order );\r\n\r\n\t\t\t// if there is a key at the first frame, duplicate it as the\r\n\t\t\t// last frame as well for perfect loop.\r\n\t\t\tif ( ! noLoop && times[ 0 ] === 0 ) {\r\n\r\n\t\t\t\ttimes.push( numMorphTargets );\r\n\t\t\t\tvalues.push( values[ 0 ] );\r\n\r\n\t\t\t}\r\n\r\n\t\t\ttracks.push(\r\n\t\t\t\t\tnew THREE.NumberKeyframeTrack(\r\n\t\t\t\t\t\t'.morphTargetInfluences[' + morphTargetSequence[ i ].name + ']',\r\n\t\t\t\t\t\ttimes, values\r\n\t\t\t\t\t).scale( 1.0 / fps ) );\r\n\t\t}\r\n\r\n\t\treturn new THREE.AnimationClip( name, -1, tracks );\r\n\r\n\t},\r\n\r\n\tfindByName: function( clipArray, name ) {\r\n\r\n\t\tfor ( var i = 0; i < clipArray.length; i ++ ) {\r\n\r\n\t\t\tif ( clipArray[ i ].name === name ) {\r\n\r\n\t\t\t\treturn clipArray[ i ];\r\n\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn null;\r\n\r\n\t},\r\n\r\n\tCreateClipsFromMorphTargetSequences: function( morphTargets, fps, noLoop ) {\r\n\r\n\t\tvar animationToMorphTargets = {};\r\n\r\n\t\t// tested with https://regex101.com/ on trick sequences\r\n\t\t// such flamingo_flyA_003, flamingo_run1_003, crdeath0059\r\n\t\tvar pattern = /^([\\w-]*?)([\\d]+)$/;\r\n\r\n\t\t// sort morph target names into animation groups based\r\n\t\t// patterns like Walk_001, Walk_002, Run_001, Run_002\r\n\t\tfor ( var i = 0, il = morphTargets.length; i < il; i ++ ) {\r\n\r\n\t\t\tvar morphTarget = morphTargets[ i ];\r\n\t\t\tvar parts = morphTarget.name.match( pattern );\r\n\r\n\t\t\tif ( parts && parts.length > 1 ) {\r\n\r\n\t\t\t\tvar name = parts[ 1 ];\r\n\r\n\t\t\t\tvar animationMorphTargets = animationToMorphTargets[ name ];\r\n\t\t\t\tif ( ! animationMorphTargets ) {\r\n\r\n\t\t\t\t\tanimationToMorphTargets[ name ] = animationMorphTargets = [];\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tanimationMorphTargets.push( morphTarget );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tvar clips = [];\r\n\r\n\t\tfor ( var name in animationToMorphTargets ) {\r\n\r\n\t\t\tclips.push( THREE.AnimationClip.CreateFromMorphTargetSequence( name, animationToMorphTargets[ name ], fps, noLoop ) );\r\n\r\n\t\t}\r\n\r\n\t\treturn clips;\r\n\r\n\t},\r\n\r\n\t// parse the animation.hierarchy format\r\n\tparseAnimation: function( animation, bones, nodeName ) {\r\n\r\n\t\tif ( ! animation ) {\r\n\r\n\t\t\tconsole.error( \"  no animation in JSONLoader data\" );\r\n\t\t\treturn null;\r\n\r\n\t\t}\r\n\r\n\t\tvar addNonemptyTrack = function(\r\n\t\t\t\ttrackType, trackName, animationKeys, propertyName, destTracks ) {\r\n\r\n\t\t\t// only return track if there are actually keys.\r\n\t\t\tif ( animationKeys.length !== 0 ) {\r\n\r\n\t\t\t\tvar times = [];\r\n\t\t\t\tvar values = [];\r\n\r\n\t\t\t\tTHREE.AnimationUtils.flattenJSON(\r\n\t\t\t\t\t\tanimationKeys, times, values, propertyName );\r\n\r\n\t\t\t\t// empty keys are filtered out, so check again\r\n\t\t\t\tif ( times.length !== 0 ) {\r\n\r\n\t\t\t\t\tdestTracks.push( new trackType( trackName, times, values ) );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t};\r\n\r\n\t\tvar tracks = [];\r\n\r\n\t\tvar clipName = animation.name || 'default';\r\n\t\t// automatic length determination in AnimationClip.\r\n\t\tvar duration = animation.length || -1;\r\n\t\tvar fps = animation.fps || 30;\r\n\r\n\t\tvar hierarchyTracks = animation.hierarchy || [];\r\n\r\n\t\tfor ( var h = 0; h < hierarchyTracks.length; h ++ ) {\r\n\r\n\t\t\tvar animationKeys = hierarchyTracks[ h ].keys;\r\n\r\n\t\t\t// skip empty tracks\r\n\t\t\tif ( ! animationKeys || animationKeys.length == 0 ) continue;\r\n\r\n\t\t\t// process morph targets in a way exactly compatible\r\n\t\t\t// with AnimationHandler.init( animation )\r\n\t\t\tif ( animationKeys[0].morphTargets ) {\r\n\r\n\t\t\t\t// figure out all morph targets used in this track\r\n\t\t\t\tvar morphTargetNames = {};\r\n\t\t\t\tfor ( var k = 0; k < animationKeys.length; k ++ ) {\r\n\r\n\t\t\t\t\tif ( animationKeys[k].morphTargets ) {\r\n\r\n\t\t\t\t\t\tfor ( var m = 0; m < animationKeys[k].morphTargets.length; m ++ ) {\r\n\r\n\t\t\t\t\t\t\tmorphTargetNames[ animationKeys[k].morphTargets[m] ] = -1;\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// create a track for each morph target with all zero\r\n\t\t\t\t// morphTargetInfluences except for the keys in which\r\n\t\t\t\t// the morphTarget is named.\r\n\t\t\t\tfor ( var morphTargetName in morphTargetNames ) {\r\n\r\n\t\t\t\t\tvar times = [];\r\n\t\t\t\t\tvar values = [];\r\n\r\n\t\t\t\t\tfor ( var m = 0;\r\n\t\t\t\t\t\t\tm !== animationKeys[k].morphTargets.length; ++ m ) {\r\n\r\n\t\t\t\t\t\tvar animationKey = animationKeys[k];\r\n\r\n\t\t\t\t\t\ttimes.push( animationKey.time );\r\n\t\t\t\t\t\tvalues.push( ( animationKey.morphTarget === morphTargetName ) ? 1 : 0 )\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\ttracks.push( new THREE.NumberKeyframeTrack(\r\n\t\t\t\t\t\t\t'.morphTargetInfluence[' + morphTargetName + ']', times, values ) );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tduration = morphTargetNames.length * ( fps || 1.0 );\r\n\r\n\t\t\t} else {\r\n\t\t\t\t// ...assume skeletal animation\r\n\r\n\t\t\t\tvar boneName = '.bones[' + bones[ h ].name + ']';\r\n\r\n\t\t\t\taddNonemptyTrack(\r\n\t\t\t\t\t\tTHREE.VectorKeyframeTrack, boneName + '.position',\r\n\t\t\t\t\t\tanimationKeys, 'pos', tracks );\r\n\r\n\t\t\t\taddNonemptyTrack(\r\n\t\t\t\t\t\tTHREE.QuaternionKeyframeTrack, boneName + '.quaternion',\r\n\t\t\t\t\t\tanimationKeys, 'rot', tracks );\r\n\r\n\t\t\t\taddNonemptyTrack(\r\n\t\t\t\t\t\tTHREE.VectorKeyframeTrack, boneName + '.scale',\r\n\t\t\t\t\t\tanimationKeys, 'scl', tracks );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tif ( tracks.length === 0 ) {\r\n\r\n\t\t\treturn null;\r\n\r\n\t\t}\r\n\r\n\t\tvar clip = new THREE.AnimationClip( clipName, duration, tracks );\r\n\r\n\t\treturn clip;\r\n\r\n\t}\r\n\r\n} );\r\n\r\n\r\n// File:src/animation/AnimationMixer.js\r\n\r\n/**\r\n *\r\n * Player for AnimationClips.\r\n *\r\n *\r\n * @author Ben Houston / http://clara.io/\r\n * @author David Sarno / http://lighthaus.us/\r\n * @author tschw\r\n */\r\n\r\nTHREE.AnimationMixer = function( root ) {\r\n\r\n\tthis._root = root;\r\n\tthis._initMemoryManager();\r\n\tthis._accuIndex = 0;\r\n\r\n\tthis.time = 0;\r\n\r\n\tthis.timeScale = 1.0;\r\n\r\n};\r\n\r\nTHREE.AnimationMixer.prototype = {\r\n\r\n\tconstructor: THREE.AnimationMixer,\r\n\r\n\t// return an action for a clip optionally using a custom root target\r\n\t// object (this method allocates a lot of dynamic memory in case a\r\n\t// previously unknown clip/root combination is specified)\r\n\tclipAction: function( clip, optionalRoot ) {\r\n\r\n\t\tvar root = optionalRoot || this._root,\r\n\t\t\trootUuid = root.uuid,\r\n\t\t\tclipName = ( typeof clip === 'string' ) ? clip : clip.name,\r\n\t\t\tclipObject = ( clip !== clipName ) ? clip : null,\r\n\r\n\t\t\tactionsForClip = this._actionsByClip[ clipName ],\r\n\t\t\tprototypeAction;\r\n\r\n\t\tif ( actionsForClip !== undefined ) {\r\n\r\n\t\t\tvar existingAction =\r\n\t\t\t\t\tactionsForClip.actionByRoot[ rootUuid ];\r\n\r\n\t\t\tif ( existingAction !== undefined ) {\r\n\r\n\t\t\t\treturn existingAction;\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// we know the clip, so we don't have to parse all\r\n\t\t\t// the bindings again but can just copy\r\n\t\t\tprototypeAction = actionsForClip.knownActions[ 0 ];\r\n\r\n\t\t\t// also, take the clip from the prototype action\r\n\t\t\tclipObject = prototypeAction._clip;\r\n\r\n\t\t\tif ( clip !== clipName && clip !== clipObject ) {\r\n\r\n\t\t\t\tthrow new Error(\r\n\t\t\t\t\t\t\"Different clips with the same name detected!\" );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\t// clip must be known when specified via string\r\n\t\tif ( clipObject === null ) return null;\r\n\r\n\t\t// allocate all resources required to run it\r\n\t\tvar newAction = new THREE.\r\n\t\t\t\tAnimationMixer._Action( this, clipObject, optionalRoot );\r\n\r\n\t\tthis._bindAction( newAction, prototypeAction );\r\n\r\n\t\t// and make the action known to the memory manager\r\n\t\tthis._addInactiveAction( newAction, clipName, rootUuid );\r\n\r\n\t\treturn newAction;\r\n\r\n\t},\r\n\r\n\t// get an existing action\r\n\texistingAction: function( clip, optionalRoot ) {\r\n\r\n\t\tvar root = optionalRoot || this._root,\r\n\t\t\trootUuid = root.uuid,\r\n\t\t\tclipName = ( typeof clip === 'string' ) ? clip : clip.name,\r\n\t\t\tactionsForClip = this._actionsByClip[ clipName ];\r\n\r\n\t\tif ( actionsForClip !== undefined ) {\r\n\r\n\t\t\treturn actionsForClip.actionByRoot[ rootUuid ] || null;\r\n\r\n\t\t}\r\n\r\n\t\treturn null;\r\n\r\n\t},\r\n\r\n\t// deactivates all previously scheduled actions\r\n\tstopAllAction: function() {\r\n\r\n\t\tvar actions = this._actions,\r\n\t\t\tnActions = this._nActiveActions,\r\n\t\t\tbindings = this._bindings,\r\n\t\t\tnBindings = this._nActiveBindings;\r\n\r\n\t\tthis._nActiveActions = 0;\r\n\t\tthis._nActiveBindings = 0;\r\n\r\n\t\tfor ( var i = 0; i !== nActions; ++ i ) {\r\n\r\n\t\t\tactions[ i ].reset();\r\n\r\n\t\t}\r\n\r\n\t\tfor ( var i = 0; i !== nBindings; ++ i ) {\r\n\r\n\t\t\tbindings[ i ].useCount = 0;\r\n\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\t// advance the time and update apply the animation\r\n\tupdate: function( deltaTime ) {\r\n\r\n\t\tdeltaTime *= this.timeScale;\r\n\r\n\t\tvar actions = this._actions,\r\n\t\t\tnActions = this._nActiveActions,\r\n\r\n\t\t\ttime = this.time += deltaTime,\r\n\t\t\ttimeDirection = Math.sign( deltaTime ),\r\n\r\n\t\t\taccuIndex = this._accuIndex ^= 1;\r\n\r\n\t\t// run active actions\r\n\r\n\t\tfor ( var i = 0; i !== nActions; ++ i ) {\r\n\r\n\t\t\tvar action = actions[ i ];\r\n\r\n\t\t\tif ( action.enabled ) {\r\n\r\n\t\t\t\taction._update( time, deltaTime, timeDirection, accuIndex );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\t// update scene graph\r\n\r\n\t\tvar bindings = this._bindings,\r\n\t\t\tnBindings = this._nActiveBindings;\r\n\r\n\t\tfor ( var i = 0; i !== nBindings; ++ i ) {\r\n\r\n\t\t\tbindings[ i ].apply( accuIndex );\r\n\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\t// return this mixer's root target object\r\n\tgetRoot: function() {\r\n\r\n\t\treturn this._root;\r\n\r\n\t},\r\n\r\n\t// free all resources specific to a particular clip\r\n\tuncacheClip: function( clip ) {\r\n\r\n\t\tvar actions = this._actions,\r\n\t\t\tclipName = clip.name,\r\n\t\t\tactionsByClip = this._actionsByClip,\r\n\t\t\tactionsForClip = actionsByClip[ clipName ];\r\n\r\n\t\tif ( actionsForClip !== undefined ) {\r\n\r\n\t\t\t// note: just calling _removeInactiveAction would mess up the\r\n\t\t\t// iteration state and also require updating the state we can\r\n\t\t\t// just throw away\r\n\r\n\t\t\tvar actionsToRemove = actionsForClip.knownActions;\r\n\r\n\t\t\tfor ( var i = 0, n = actionsToRemove.length; i !== n; ++ i ) {\r\n\r\n\t\t\t\tvar action = actionsToRemove[ i ];\r\n\r\n\t\t\t\tthis._deactivateAction( action );\r\n\r\n\t\t\t\tvar cacheIndex = action._cacheIndex,\r\n\t\t\t\t\tlastInactiveAction = actions[ actions.length - 1 ];\r\n\r\n\t\t\t\taction._cacheIndex = null;\r\n\t\t\t\taction._byClipCacheIndex = null;\r\n\r\n\t\t\t\tlastInactiveAction._cacheIndex = cacheIndex;\r\n\t\t\t\tactions[ cacheIndex ] = lastInactiveAction;\r\n\t\t\t\tactions.pop();\r\n\r\n\t\t\t\tthis._removeInactiveBindingsForAction( action );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tdelete actionsByClip[ clipName ];\r\n\r\n\t\t}\r\n\r\n\t},\r\n\r\n\t// free all resources specific to a particular root target object\r\n\tuncacheRoot: function( root ) {\r\n\r\n\t\tvar rootUuid = root.uuid,\r\n\t\t\tactionsByClip = this._actionsByClip;\r\n\r\n\t\tfor ( var clipName in actionsByClip ) {\r\n\r\n\t\t\tvar actionByRoot = actionsByClip[ clipName ].actionByRoot,\r\n\t\t\t\taction = actionByRoot[ rootUuid ];\r\n\r\n\t\t\tif ( action !== undefined ) {\r\n\r\n\t\t\t\tthis._deactivateAction( action );\r\n\t\t\t\tthis._removeInactiveAction( action );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tvar bindingsByRoot = this._bindingsByRootAndName,\r\n\t\t\tbindingByName = bindingsByRoot[ rootUuid ];\r\n\r\n\t\tif ( bindingByName !== undefined ) {\r\n\r\n\t\t\tfor ( var trackName in bindingByName ) {\r\n\r\n\t\t\t\tvar binding = bindingByName[ trackName ];\r\n\t\t\t\tbinding.restoreOriginalState();\r\n\t\t\t\tthis._removeInactiveBinding( binding );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t},\r\n\r\n\t// remove a targeted clip from the cache\r\n\tuncacheAction: function( clip, optionalRoot ) {\r\n\r\n\t\tvar action = this.existingAction( clip, optionalRoot );\r\n\r\n\t\tif ( action !== null ) {\r\n\r\n\t\t\tthis._deactivateAction( action );\r\n\t\t\tthis._removeInactiveAction( action );\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n};\r\n\r\nTHREE.EventDispatcher.prototype.apply( THREE.AnimationMixer.prototype );\r\n\r\nTHREE.AnimationMixer._Action =\r\n\t\tfunction( mixer, clip, localRoot ) {\r\n\r\n\tthis._mixer = mixer;\r\n\tthis._clip = clip;\r\n\tthis._localRoot = localRoot || null;\r\n\r\n\tvar tracks = clip.tracks,\r\n\t\tnTracks = tracks.length,\r\n\t\tinterpolants = new Array( nTracks );\r\n\r\n\tvar interpolantSettings = {\r\n\t\t\tendingStart: \tTHREE.ZeroCurvatureEnding,\r\n\t\t\tendingEnd:\t\tTHREE.ZeroCurvatureEnding\r\n\t};\r\n\r\n\tfor ( var i = 0; i !== nTracks; ++ i ) {\r\n\r\n\t\tvar interpolant = tracks[ i ].createInterpolant( null );\r\n\t\tinterpolants[ i ] = interpolant;\r\n\t\tinterpolant.settings = interpolantSettings\r\n\r\n\t}\r\n\r\n\tthis._interpolantSettings = interpolantSettings;\r\n\r\n\tthis._interpolants = interpolants;\t// bound by the mixer\r\n\r\n\t// inside: PropertyMixer (managed by the mixer)\r\n\tthis._propertyBindings = new Array( nTracks );\r\n\r\n\tthis._cacheIndex = null;\t\t\t// for the memory manager\r\n\tthis._byClipCacheIndex = null;\t\t// for the memory manager\r\n\r\n\tthis._timeScaleInterpolant = null;\r\n\tthis._weightInterpolant = null;\r\n\r\n\tthis.loop = THREE.LoopRepeat;\r\n\tthis._loopCount = -1;\r\n\r\n\t// global mixer time when the action is to be started\r\n\t// it's set back to 'null' upon start of the action\r\n\tthis._startTime = null;\r\n\r\n\t// scaled local time of the action\r\n\t// gets clamped or wrapped to 0..clip.duration according to loop\r\n\tthis.time = 0;\r\n\r\n\tthis.timeScale = 1;\r\n\tthis._effectiveTimeScale = 1;\r\n\r\n\tthis.weight = 1;\r\n\tthis._effectiveWeight = 1;\r\n\r\n\tthis.repetitions = Infinity; \t\t// no. of repetitions when looping\r\n\r\n\tthis.paused = false;\t\t\t\t// false -> zero effective time scale\r\n\tthis.enabled = true;\t\t\t\t// true -> zero effective weight\r\n\r\n\tthis.clampWhenFinished \t= false;\t// keep feeding the last frame?\r\n\r\n\tthis.zeroSlopeAtStart \t= true;\t\t// for smooth interpolation w/o separate\r\n\tthis.zeroSlopeAtEnd\t\t= true;\t\t// clips for start, loop and end\r\n\r\n};\r\n\r\nTHREE.AnimationMixer._Action.prototype = {\r\n\r\n\tconstructor: THREE.AnimationMixer._Action,\r\n\r\n\t// State & Scheduling\r\n\r\n\tplay: function() {\r\n\r\n\t\tthis._mixer._activateAction( this );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tstop: function() {\r\n\r\n\t\tthis._mixer._deactivateAction( this );\r\n\r\n\t\treturn this.reset();\r\n\r\n\t},\r\n\r\n\treset: function() {\r\n\r\n\t\tthis.paused = false;\r\n\t\tthis.enabled = true;\r\n\r\n\t\tthis.time = 0;\t\t\t// restart clip\r\n\t\tthis._loopCount = -1;\t// forget previous loops\r\n\t\tthis._startTime = null;\t// forget scheduling\r\n\r\n\t\treturn this.stopFading().stopWarping();\r\n\r\n\t},\r\n\r\n\tisRunning: function() {\r\n\r\n\t\tvar start = this._startTime;\r\n\r\n\t\treturn this.enabled && ! this.paused && this.timeScale !== 0 &&\r\n\t\t\t\tthis._startTime === null && this._mixer._isActiveAction( this )\r\n\r\n\t},\r\n\r\n\t// return true when play has been called\r\n\tisScheduled: function() {\r\n\r\n\t\treturn this._mixer._isActiveAction( this );\r\n\r\n\t},\r\n\r\n\tstartAt: function( time ) {\r\n\r\n\t\tthis._startTime = time;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tsetLoop: function( mode, repetitions ) {\r\n\r\n\t\tthis.loop = mode;\r\n\t\tthis.repetitions = repetitions;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\t// Weight\r\n\r\n\t// set the weight stopping any scheduled fading\r\n\t// although .enabled = false yields an effective weight of zero, this\r\n\t// method does *not* change .enabled, because it would be confusing\r\n\tsetEffectiveWeight: function( weight ) {\r\n\r\n\t\tthis.weight = weight;\r\n\r\n\t\t// note: same logic as when updated at runtime\r\n\t\tthis._effectiveWeight = this.enabled ? weight : 0;\r\n\r\n\t\treturn this.stopFading();\r\n\r\n\t},\r\n\r\n\t// return the weight considering fading and .enabled\r\n\tgetEffectiveWeight: function() {\r\n\r\n\t\treturn this._effectiveWeight;\r\n\r\n\t},\r\n\r\n\tfadeIn: function( duration ) {\r\n\r\n\t\treturn this._scheduleFading( duration, 0, 1 );\r\n\r\n\t},\r\n\r\n\tfadeOut: function( duration ) {\r\n\r\n\t\treturn this._scheduleFading( duration, 1, 0 );\r\n\r\n\t},\r\n\r\n\tcrossFadeFrom: function( fadeOutAction, duration, warp ) {\r\n\r\n\t\tvar mixer = this._mixer;\r\n\r\n\t\tfadeOutAction.fadeOut( duration );\r\n\t\tthis.fadeIn( duration );\r\n\r\n\t\tif( warp ) {\r\n\r\n\t\t\tvar fadeInDuration = this._clip.duration,\r\n\t\t\t\tfadeOutDuration = fadeOutAction._clip.duration,\r\n\r\n\t\t\t\tstartEndRatio = fadeOutDuration / fadeInDuration,\r\n\t\t\t\tendStartRatio = fadeInDuration / fadeOutDuration;\r\n\r\n\t\t\tfadeOutAction.warp( 1.0, startEndRatio, duration );\r\n\t\t\tthis.warp( endStartRatio, 1.0, duration );\r\n\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tcrossFadeTo: function( fadeInAction, duration, warp ) {\r\n\r\n\t\treturn fadeInAction.crossFadeFrom( this, duration, warp );\r\n\r\n\t},\r\n\r\n\tstopFading: function() {\r\n\r\n\t\tvar weightInterpolant = this._weightInterpolant;\r\n\r\n\t\tif ( weightInterpolant !== null ) {\r\n\r\n\t\t\tthis._weightInterpolant = null;\r\n\t\t\tthis._mixer._takeBackControlInterpolant( weightInterpolant );\r\n\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\t// Time Scale Control\r\n\r\n\t// set the weight stopping any scheduled warping\r\n\t// although .paused = true yields an effective time scale of zero, this\r\n\t// method does *not* change .paused, because it would be confusing\r\n\tsetEffectiveTimeScale: function( timeScale ) {\r\n\r\n\t\tthis.timeScale = timeScale;\r\n\t\tthis._effectiveTimeScale = this.paused ? 0 :timeScale;\r\n\r\n\t\treturn this.stopWarping();\r\n\r\n\t},\r\n\r\n\t// return the time scale considering warping and .paused\r\n\tgetEffectiveTimeScale: function() {\r\n\r\n\t\treturn this._effectiveTimeScale;\r\n\r\n\t},\r\n\r\n\tsetDuration: function( duration ) {\r\n\r\n\t\tthis.timeScale = this._clip.duration / duration;\r\n\r\n\t\treturn this.stopWarping();\r\n\r\n\t},\r\n\r\n\tsyncWith: function( action ) {\r\n\r\n\t\tthis.time = action.time;\r\n\t\tthis.timeScale = action.timeScale;\r\n\r\n\t\treturn this.stopWarping();\r\n\r\n\t},\r\n\r\n\thalt: function( duration ) {\r\n\r\n\t\treturn this.warp( this._currentTimeScale, 0, duration );\r\n\r\n\t},\r\n\r\n\twarp: function( startTimeScale, endTimeScale, duration ) {\r\n\r\n\t\tvar mixer = this._mixer, now = mixer.time,\r\n\t\t\tinterpolant = this._timeScaleInterpolant,\r\n\r\n\t\t\ttimeScale = this.timeScale;\r\n\r\n\t\tif ( interpolant === null ) {\r\n\r\n\t\t\tinterpolant = mixer._lendControlInterpolant(),\r\n\t\t\tthis._timeScaleInterpolant = interpolant;\r\n\r\n\t\t}\r\n\r\n\t\tvar times = interpolant.parameterPositions,\r\n\t\t\tvalues = interpolant.sampleValues;\r\n\r\n\t\ttimes[ 0 ] = now;\r\n\t\ttimes[ 1 ] = now + duration;\r\n\r\n\t\tvalues[ 0 ] = startTimeScale / timeScale;\r\n\t\tvalues[ 1 ] = endTimeScale / timeScale;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tstopWarping: function() {\r\n\r\n\t\tvar timeScaleInterpolant = this._timeScaleInterpolant;\r\n\r\n\t\tif ( timeScaleInterpolant !== null ) {\r\n\r\n\t\t\tthis._timeScaleInterpolant = null;\r\n\t\t\tthis._mixer._takeBackControlInterpolant( timeScaleInterpolant );\r\n\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\t// Object Accessors\r\n\r\n\tgetMixer: function() {\r\n\r\n\t\treturn this._mixer;\r\n\r\n\t},\r\n\r\n\tgetClip: function() {\r\n\r\n\t\treturn this._clip;\r\n\r\n\t},\r\n\r\n\tgetRoot: function() {\r\n\r\n\t\treturn this._localRoot || this._mixer._root;\r\n\r\n\t},\r\n\r\n\t// Interna\r\n\r\n\t_update: function( time, deltaTime, timeDirection, accuIndex ) {\r\n\t\t// called by the mixer\r\n\r\n\t\tvar startTime = this._startTime;\r\n\r\n\t\tif ( startTime !== null ) {\r\n\r\n\t\t\t// check for scheduled start of action\r\n\r\n\t\t\tvar timeRunning = ( time - startTime ) * timeDirection;\r\n\t\t\tif ( timeRunning < 0 || timeDirection === 0 ) {\r\n\r\n\t\t\t\treturn; // yet to come / don't decide when delta = 0\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// start\r\n\r\n\t\t\tthis._startTime = null; // unschedule\r\n\t\t\tdeltaTime = timeDirection * timeRunning;\r\n\r\n\t\t}\r\n\r\n\t\t// apply time scale and advance time\r\n\r\n\t\tdeltaTime *= this._updateTimeScale( time );\r\n\t\tvar clipTime = this._updateTime( deltaTime );\r\n\r\n\t\t// note: _updateTime may disable the action resulting in\r\n\t\t// an effective weight of 0\r\n\r\n\t\tvar weight = this._updateWeight( time );\r\n\r\n\t\tif ( weight > 0 ) {\r\n\r\n\t\t\tvar interpolants = this._interpolants;\r\n\t\t\tvar propertyMixers = this._propertyBindings;\r\n\r\n\t\t\tfor ( var j = 0, m = interpolants.length; j !== m; ++ j ) {\r\n\r\n\t\t\t\tinterpolants[ j ].evaluate( clipTime );\r\n\t\t\t\tpropertyMixers[ j ].accumulate( accuIndex, weight );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t},\r\n\r\n\t_updateWeight: function( time ) {\r\n\r\n\t\tvar weight = 0;\r\n\r\n\t\tif ( this.enabled ) {\r\n\r\n\t\t\tweight = this.weight;\r\n\t\t\tvar interpolant = this._weightInterpolant;\r\n\r\n\t\t\tif ( interpolant !== null ) {\r\n\r\n\t\t\t\tvar interpolantValue = interpolant.evaluate( time )[ 0 ];\r\n\r\n\t\t\t\tweight *= interpolantValue;\r\n\r\n\t\t\t\tif ( time > interpolant.parameterPositions[ 1 ] ) {\r\n\r\n\t\t\t\t\tthis.stopFading();\r\n\r\n\t\t\t\t\tif ( interpolantValue === 0 ) {\r\n\r\n\t\t\t\t\t\t// faded out, disable\r\n\t\t\t\t\t\tthis.enabled = false;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tthis._effectiveWeight = weight;\r\n\t\treturn weight;\r\n\r\n\t},\r\n\r\n\t_updateTimeScale: function( time ) {\r\n\r\n\t\tvar timeScale = 0;\r\n\r\n\t\tif ( ! this.paused ) {\r\n\r\n\t\t\ttimeScale = this.timeScale;\r\n\r\n\t\t\tvar interpolant = this._timeScaleInterpolant;\r\n\r\n\t\t\tif ( interpolant !== null ) {\r\n\r\n\t\t\t\tvar interpolantValue = interpolant.evaluate( time )[ 0 ];\r\n\r\n\t\t\t\ttimeScale *= interpolantValue;\r\n\r\n\t\t\t\tif ( time > interpolant.parameterPositions[ 1 ] ) {\r\n\r\n\t\t\t\t\tthis.stopWarping();\r\n\r\n\t\t\t\t\tif ( timeScale === 0 ) {\r\n\r\n\t\t\t\t\t\t// motion has halted, pause\r\n\t\t\t\t\t\tthis.pause = true;\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\t// warp done - apply final time scale\r\n\t\t\t\t\t\tthis.timeScale = timeScale;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tthis._effectiveTimeScale = timeScale;\r\n\t\treturn timeScale;\r\n\r\n\t},\r\n\r\n\t_updateTime: function( deltaTime ) {\r\n\r\n\t\tvar time = this.time + deltaTime;\r\n\r\n\t\tif ( deltaTime === 0 ) return time;\r\n\r\n\t\tvar duration = this._clip.duration,\r\n\r\n\t\t\tloop = this.loop,\r\n\t\t\tloopCount = this._loopCount,\r\n\r\n\t\t\tpingPong = false;\r\n\r\n\t\tswitch ( loop ) {\r\n\r\n\t\t\tcase THREE.LoopOnce:\r\n\r\n\t\t\t\tif ( loopCount === -1 ) {\r\n\r\n\t\t\t\t\t// just started\r\n\r\n\t\t\t\t\tthis.loopCount = 0;\r\n\t\t\t\t\tthis._setEndings( true, true, false );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( time >= duration ) {\r\n\r\n\t\t\t\t\ttime = duration;\r\n\r\n\t\t\t\t} else if ( time < 0 ) {\r\n\r\n\t\t\t\t\ttime = 0;\r\n\r\n\t\t\t\t} else break;\r\n\r\n\t\t\t\t// reached the end\r\n\r\n\t\t\t\tif ( this.clampWhenFinished ) this.pause = true;\r\n\t\t\t\telse this.enabled = false;\r\n\r\n\t\t\t\tthis._mixer.dispatchEvent( {\r\n\t\t\t\t\ttype: 'finished', action: this,\r\n\t\t\t\t\tdirection: deltaTime < 0 ? -1 : 1\r\n\t\t\t\t} );\r\n\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tcase THREE.LoopPingPong:\r\n\r\n\t\t\t\tpingPong = true;\r\n\r\n\t\t\tcase THREE.LoopRepeat:\r\n\r\n\t\t\t\tif ( loopCount === -1 ) {\r\n\r\n\t\t\t\t\t// just started\r\n\r\n\t\t\t\t\tif ( deltaTime > 0 ) {\r\n\r\n\t\t\t\t\t\tloopCount = 0;\r\n\r\n\t\t\t\t\t\tthis._setEndings(\r\n\t\t\t\t\t\t\t\ttrue, this.repetitions === 0, pingPong );\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\t// when looping in reverse direction, the initial\r\n\t\t\t\t\t\t// transition through zero counts as a repetition,\r\n\t\t\t\t\t\t// so leave loopCount at -1\r\n\r\n\t\t\t\t\t\tthis._setEndings(\r\n\t\t\t\t\t\t\t\tthis.repetitions === 0, true, pingPong );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( time >= duration || time < 0 ) {\r\n\r\n\t\t\t\t\t// wrap around\r\n\r\n\t\t\t\t\tvar loopDelta = Math.floor( time / duration ); // signed\r\n\t\t\t\t\ttime -= duration * loopDelta;\r\n\r\n\t\t\t\t\tloopCount += Math.abs( loopDelta );\r\n\r\n\t\t\t\t\tvar pending = this.repetitions - loopCount;\r\n\r\n\t\t\t\t\tif ( pending < 0 ) {\r\n\r\n\t\t\t\t\t\t// stop (switch state, clamp time, fire event)\r\n\r\n\t\t\t\t\t\tif ( this.clampWhenFinished ) this.paused = true;\r\n\t\t\t\t\t\telse this.enabled = false;\r\n\r\n\t\t\t\t\t\ttime = deltaTime > 0 ? duration : 0;\r\n\r\n\t\t\t\t\t\tthis._mixer.dispatchEvent( {\r\n\t\t\t\t\t\t\ttype: 'finished', action: this,\r\n\t\t\t\t\t\t\tdirection: deltaTime > 0 ? 1 : -1\r\n\t\t\t\t\t\t} );\r\n\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t} else if ( pending === 0 ) {\r\n\r\n\t\t\t\t\t\t// transition to last round\r\n\r\n\t\t\t\t\t\tvar atStart = deltaTime < 0;\r\n\t\t\t\t\t\tthis._setEndings( atStart, ! atStart, pingPong );\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\tthis._setEndings( false, false, pingPong );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tthis._loopCount = loopCount;\r\n\r\n\t\t\t\t\tthis._mixer.dispatchEvent( {\r\n\t\t\t\t\t\ttype: 'loop', action: this, loopDelta: loopDelta\r\n\t\t\t\t\t} );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( loop === THREE.LoopPingPong && ( loopCount & 1 ) === 1 ) {\r\n\r\n\t\t\t\t\t// invert time for the \"pong round\"\r\n\r\n\t\t\t\t\tthis.time = time;\r\n\r\n\t\t\t\t\treturn duration - time;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tbreak;\r\n\r\n\t\t}\r\n\r\n\t\tthis.time = time;\r\n\r\n\t\treturn time;\r\n\r\n\t},\r\n\r\n\t_setEndings: function( atStart, atEnd, pingPong ) {\r\n\r\n\t\tvar settings = this._interpolantSettings;\r\n\r\n\t\tif ( pingPong ) {\r\n\r\n\t\t\tsettings.endingStart \t= THREE.ZeroSlopeEnding;\r\n\t\t\tsettings.endingEnd\t\t= THREE.ZeroSlopeEnding;\r\n\r\n\t\t} else {\r\n\r\n\t\t\t// assuming for LoopOnce atStart == atEnd == true\r\n\r\n\t\t\tif ( atStart ) {\r\n\r\n\t\t\t\tsettings.endingStart = this.zeroSlopeAtStart ?\r\n\t\t\t\t\t\tTHREE.ZeroSlopeEnding : THREE.ZeroCurvatureEnding;\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tsettings.endingStart = THREE.WrapAroundEnding;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( atEnd ) {\r\n\r\n\t\t\t\tsettings.endingEnd = this.zeroSlopeAtEnd ?\r\n\t\t\t\t\t\tTHREE.ZeroSlopeEnding : THREE.ZeroCurvatureEnding;\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tsettings.endingEnd \t = THREE.WrapAroundEnding;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t},\r\n\r\n\t_scheduleFading: function( duration, weightNow, weightThen ) {\r\n\r\n\t\tvar mixer = this._mixer, now = mixer.time,\r\n\t\t\tinterpolant = this._weightInterpolant;\r\n\r\n\t\tif ( interpolant === null ) {\r\n\r\n\t\t\tinterpolant = mixer._lendControlInterpolant(),\r\n\t\t\tthis._weightInterpolant = interpolant;\r\n\r\n\t\t}\r\n\r\n\t\tvar times = interpolant.parameterPositions,\r\n\t\t\tvalues = interpolant.sampleValues;\r\n\r\n\t\ttimes[ 0 ] = now; \t\t\t\tvalues[ 0 ] = weightNow;\r\n\t\ttimes[ 1 ] = now + duration;\tvalues[ 1 ] = weightThen;\r\n\r\n\t\treturn this;\r\n\r\n\t}\r\n\r\n};\r\n\r\n// Implementation details:\r\n\r\nObject.assign( THREE.AnimationMixer.prototype, {\r\n\r\n\t_bindAction: function( action, prototypeAction ) {\r\n\r\n\t\tvar root = action._localRoot || this._root,\r\n\t\t\ttracks = action._clip.tracks,\r\n\t\t\tnTracks = tracks.length,\r\n\t\t\tbindings = action._propertyBindings,\r\n\t\t\tinterpolants = action._interpolants,\r\n\t\t\trootUuid = root.uuid,\r\n\t\t\tbindingsByRoot = this._bindingsByRootAndName,\r\n\t\t\tbindingsByName = bindingsByRoot[ rootUuid ];\r\n\r\n\t\tif ( bindingsByName === undefined ) {\r\n\r\n\t\t\tbindingsByName = {};\r\n\t\t\tbindingsByRoot[ rootUuid ] = bindingsByName;\r\n\r\n\t\t}\r\n\r\n\t\tfor ( var i = 0; i !== nTracks; ++ i ) {\r\n\r\n\t\t\tvar track = tracks[ i ],\r\n\t\t\t\ttrackName = track.name,\r\n\t\t\t\tbinding = bindingsByName[ trackName ];\r\n\r\n\t\t\tif ( binding !== undefined ) {\r\n\r\n\t\t\t\tbindings[ i ] = binding;\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tbinding = bindings[ i ];\r\n\r\n\t\t\t\tif ( binding !== undefined ) {\r\n\r\n\t\t\t\t\t// existing binding, make sure the cache knows\r\n\r\n\t\t\t\t\tif ( binding._cacheIndex === null ) {\r\n\r\n\t\t\t\t\t\t++ binding.referenceCount;\r\n\t\t\t\t\t\tthis._addInactiveBinding( binding, rootUuid, trackName );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tcontinue;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tvar path = prototypeAction && prototypeAction.\r\n\t\t\t\t\t\t_propertyBindings[ i ].binding.parsedPath;\r\n\r\n\t\t\t\tbinding = new THREE.PropertyMixer(\r\n\t\t\t\t\t\tTHREE.PropertyBinding.create( root, trackName, path ),\r\n\t\t\t\t\t\ttrack.ValueTypeName, track.getValueSize() );\r\n\r\n\t\t\t\t++ binding.referenceCount;\r\n\t\t\t\tthis._addInactiveBinding( binding, rootUuid, trackName );\r\n\r\n\t\t\t\tbindings[ i ] = binding;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tinterpolants[ i ].resultBuffer = binding.buffer;\r\n\r\n\t\t}\r\n\r\n\t},\r\n\r\n\t_activateAction: function( action ) {\r\n\r\n\t\tif ( ! this._isActiveAction( action ) ) {\r\n\r\n\t\t\tif ( action._cacheIndex === null ) {\r\n\r\n\t\t\t\t// this action has been forgotten by the cache, but the user\r\n\t\t\t\t// appears to be still using it -> rebind\r\n\r\n\t\t\t\tvar rootUuid = ( action._localRoot || this._root ).uuid,\r\n\t\t\t\t\tclipName = action._clip.name,\r\n\t\t\t\t\tactionsForClip = this._actionsByClip[ clipName ];\r\n\r\n\t\t\t\tthis._bindAction( action,\r\n\t\t\t\t\t\tactionsForClip && actionsForClip.knownActions[ 0 ] );\r\n\r\n\t\t\t\tthis._addInactiveAction( action, clipName, rootUuid );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar bindings = action._propertyBindings;\r\n\r\n\t\t\t// increment reference counts / sort out state\r\n\t\t\tfor ( var i = 0, n = bindings.length; i !== n; ++ i ) {\r\n\r\n\t\t\t\tvar binding = bindings[ i ];\r\n\r\n\t\t\t\tif ( binding.useCount ++ === 0 ) {\r\n\r\n\t\t\t\t\tthis._lendBinding( binding );\r\n\t\t\t\t\tbinding.saveOriginalState();\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tthis._lendAction( action );\r\n\r\n\t\t}\r\n\r\n\t},\r\n\r\n\t_deactivateAction: function( action ) {\r\n\r\n\t\tif ( this._isActiveAction( action ) ) {\r\n\r\n\t\t\tvar bindings = action._propertyBindings;\r\n\r\n\t\t\t// decrement reference counts / sort out state\r\n\t\t\tfor ( var i = 0, n = bindings.length; i !== n; ++ i ) {\r\n\r\n\t\t\t\tvar binding = bindings[ i ];\r\n\r\n\t\t\t\tif ( -- binding.useCount === 0 ) {\r\n\r\n\t\t\t\t\tbinding.restoreOriginalState();\r\n\t\t\t\t\tthis._takeBackBinding( binding );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tthis._takeBackAction( action );\r\n\r\n\t\t}\r\n\r\n\t},\r\n\r\n\t// Memory manager\r\n\r\n\t_initMemoryManager: function() {\r\n\r\n\t\tthis._actions = []; // 'nActiveActions' followed by inactive ones\r\n\t\tthis._nActiveActions = 0;\r\n\r\n\t\tthis._actionsByClip = {};\r\n\t\t// inside:\r\n\t\t// {\r\n\t\t// \t\tknownActions: Array< _Action >\t- used as prototypes\r\n\t\t// \t\tactionByRoot: _Action\t\t\t- lookup\r\n\t\t// }\r\n\r\n\r\n\t\tthis._bindings = []; // 'nActiveBindings' followed by inactive ones\r\n\t\tthis._nActiveBindings = 0;\r\n\r\n\t\tthis._bindingsByRootAndName = {}; // inside: Map< name, PropertyMixer >\r\n\r\n\r\n\t\tthis._controlInterpolants = []; // same game as above\r\n\t\tthis._nActiveControlInterpolants = 0;\r\n\r\n\t\tvar scope = this;\r\n\r\n\t\tthis.stats = {\r\n\r\n\t\t\tactions: {\r\n\t\t\t\tget total() { return scope._actions.length; },\r\n\t\t\t\tget inUse() { return scope._nActiveActions; }\r\n\t\t\t},\r\n\t\t\tbindings: {\r\n\t\t\t\tget total() { return scope._bindings.length; },\r\n\t\t\t\tget inUse() { return scope._nActiveBindings; }\r\n\t\t\t},\r\n\t\t\tcontrolInterpolants: {\r\n\t\t\t\tget total() { return scope._controlInterpolants.length; },\r\n\t\t\t\tget inUse() { return scope._nActiveControlInterpolants; }\r\n\t\t\t}\r\n\r\n\t\t};\r\n\r\n\t},\r\n\r\n\t// Memory management for _Action objects\r\n\r\n\t_isActiveAction: function( action ) {\r\n\r\n\t\tvar index = action._cacheIndex;\r\n\t\treturn index !== null && index < this._nActiveActions;\r\n\r\n\t},\r\n\r\n\t_addInactiveAction: function( action, clipName, rootUuid ) {\r\n\r\n\t\tvar actions = this._actions,\r\n\t\t\tactionsByClip = this._actionsByClip,\r\n\t\t\tactionsForClip = actionsByClip[ clipName ];\r\n\r\n\t\tif ( actionsForClip === undefined ) {\r\n\r\n\t\t\tactionsForClip = {\r\n\r\n\t\t\t\tknownActions: [ action ],\r\n\t\t\t\tactionByRoot: {}\r\n\r\n\t\t\t};\r\n\r\n\t\t\taction._byClipCacheIndex = 0;\r\n\r\n\t\t\tactionsByClip[ clipName ] = actionsForClip;\r\n\r\n\t\t} else {\r\n\r\n\t\t\tvar knownActions = actionsForClip.knownActions;\r\n\r\n\t\t\taction._byClipCacheIndex = knownActions.length;\r\n\t\t\tknownActions.push( action );\r\n\r\n\t\t}\r\n\r\n\t\taction._cacheIndex = actions.length;\r\n\t\tactions.push( action );\r\n\r\n\t\tactionsForClip.actionByRoot[ rootUuid ] = action;\r\n\r\n\t},\r\n\r\n\t_removeInactiveAction: function( action ) {\r\n\r\n\t\tvar actions = this._actions,\r\n\t\t\tlastInactiveAction = actions[ actions.length - 1 ],\r\n\t\t\tcacheIndex = action._cacheIndex;\r\n\r\n\t\tlastInactiveAction._cacheIndex = cacheIndex;\r\n\t\tactions[ cacheIndex ] = lastInactiveAction;\r\n\t\tactions.pop();\r\n\r\n\t\taction._cacheIndex = null;\r\n\r\n\r\n\t\tvar clipName = action._clip.name,\r\n\t\t\tactionsByClip = this._actionsByClip,\r\n\t\t\tactionsForClip = actionsByClip[ clipName ],\r\n\t\t\tknownActionsForClip = actionsForClip.knownActions,\r\n\r\n\t\t\tlastKnownAction =\r\n\t\t\t\tknownActionsForClip[ knownActionsForClip.length - 1 ],\r\n\r\n\t\t\tbyClipCacheIndex = action._byClipCacheIndex;\r\n\r\n\t\tlastKnownAction._byClipCacheIndex = byClipCacheIndex;\r\n\t\tknownActionsForClip[ byClipCacheIndex ] = lastKnownAction;\r\n\t\tknownActionsForClip.pop();\r\n\r\n\t\taction._byClipCacheIndex = null;\r\n\r\n\r\n\t\tvar actionByRoot = actionsForClip.actionByRoot,\r\n\t\t\trootUuid = ( actions._localRoot || this._root ).uuid;\r\n\r\n\t\tdelete actionByRoot[ rootUuid ];\r\n\r\n\t\tif ( knownActionsForClip.length === 0 ) {\r\n\r\n\t\t\tdelete actionsByClip[ clipName ];\r\n\r\n\t\t}\r\n\r\n\t\tthis._removeInactiveBindingsForAction( action );\r\n\r\n\t},\r\n\r\n\t_removeInactiveBindingsForAction: function( action ) {\r\n\r\n\t\tvar bindings = action._propertyBindings;\r\n\t\tfor ( var i = 0, n = bindings.length; i !== n; ++ i ) {\r\n\r\n\t\t\tvar binding = bindings[ i ];\r\n\r\n\t\t\tif ( -- binding.referenceCount === 0 ) {\r\n\r\n\t\t\t\tthis._removeInactiveBinding( binding );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t},\r\n\r\n\t_lendAction: function( action ) {\r\n\r\n\t\t// [ active actions |  inactive actions  ]\r\n\t\t// [  active actions >| inactive actions ]\r\n\t\t//                 s        a\r\n\t\t//                  <-swap->\r\n\t\t//                 a        s\r\n\r\n\t\tvar actions = this._actions,\r\n\t\t\tprevIndex = action._cacheIndex,\r\n\r\n\t\t\tlastActiveIndex = this._nActiveActions ++,\r\n\r\n\t\t\tfirstInactiveAction = actions[ lastActiveIndex ];\r\n\r\n\t\taction._cacheIndex = lastActiveIndex;\r\n\t\tactions[ lastActiveIndex ] = action;\r\n\r\n\t\tfirstInactiveAction._cacheIndex = prevIndex;\r\n\t\tactions[ prevIndex ] = firstInactiveAction;\r\n\r\n\t},\r\n\r\n\t_takeBackAction: function( action ) {\r\n\r\n\t\t// [  active actions  | inactive actions ]\r\n\t\t// [ active actions |< inactive actions  ]\r\n\t\t//        a        s\r\n\t\t//         <-swap->\r\n\t\t//        s        a\r\n\r\n\t\tvar actions = this._actions,\r\n\t\t\tprevIndex = action._cacheIndex,\r\n\r\n\t\t\tfirstInactiveIndex = -- this._nActiveActions,\r\n\r\n\t\t\tlastActiveAction = actions[ firstInactiveIndex ];\r\n\r\n\t\taction._cacheIndex = firstInactiveIndex;\r\n\t\tactions[ firstInactiveIndex ] = action;\r\n\r\n\t\tlastActiveAction._cacheIndex = prevIndex;\r\n\t\tactions[ prevIndex ] = lastActiveAction;\r\n\r\n\t},\r\n\r\n\t// Memory management for PropertyMixer objects\r\n\r\n\t_addInactiveBinding: function( binding, rootUuid, trackName ) {\r\n\r\n\t\tvar bindingsByRoot = this._bindingsByRootAndName,\r\n\t\t\tbindingByName = bindingsByRoot[ rootUuid ],\r\n\r\n\t\t\tbindings = this._bindings;\r\n\r\n\t\tif ( bindingByName === undefined ) {\r\n\r\n\t\t\tbindingByName = {};\r\n\t\t\tbindingsByRoot[ rootUuid ] = bindingByName;\r\n\r\n\t\t}\r\n\r\n\t\tbindingByName[ trackName ] = binding;\r\n\r\n\t\tbinding._cacheIndex = bindings.length;\r\n\t\tbindings.push( binding );\r\n\r\n\t},\r\n\r\n\t_removeInactiveBinding: function( binding ) {\r\n\r\n\t\tvar bindings = this._bindings,\r\n\t\t\tpropBinding = binding.binding,\r\n\t\t\trootUuid = propBinding.rootNode.uuid,\r\n\t\t\ttrackName = propBinding.path,\r\n\t\t\tbindingsByRoot = this._bindingsByRootAndName,\r\n\t\t\tbindingByName = bindingsByRoot[ rootUuid ],\r\n\r\n\t\t\tlastInactiveBinding = bindings[ bindings.length - 1 ],\r\n\t\t\tcacheIndex = binding._cacheIndex;\r\n\r\n\t\tlastInactiveBinding._cacheIndex = cacheIndex;\r\n\t\tbindings[ cacheIndex ] = lastInactiveBinding;\r\n\t\tbindings.pop();\r\n\r\n\t\tdelete bindingByName[ trackName ];\r\n\r\n\t\tremove_empty_map: {\r\n\r\n\t\t\tfor ( var _ in bindingByName ) break remove_empty_map;\r\n\r\n\t\t\tdelete bindingsByRoot[ rootUuid ];\r\n\r\n\t\t}\r\n\r\n\t},\r\n\r\n\t_lendBinding: function( binding ) {\r\n\r\n\t\tvar bindings = this._bindings,\r\n\t\t\tprevIndex = binding._cacheIndex,\r\n\r\n\t\t\tlastActiveIndex = this._nActiveBindings ++,\r\n\r\n\t\t\tfirstInactiveBinding = bindings[ lastActiveIndex ];\r\n\r\n\t\tbinding._cacheIndex = lastActiveIndex;\r\n\t\tbindings[ lastActiveIndex ] = binding;\r\n\r\n\t\tfirstInactiveBinding._cacheIndex = prevIndex;\r\n\t\tbindings[ prevIndex ] = firstInactiveBinding;\r\n\r\n\t},\r\n\r\n\t_takeBackBinding: function( binding ) {\r\n\r\n\t\tvar bindings = this._bindings,\r\n\t\t\tprevIndex = binding._cacheIndex,\r\n\r\n\t\t\tfirstInactiveIndex = -- this._nActiveBindings,\r\n\r\n\t\t\tlastActiveBinding = bindings[ firstInactiveIndex ];\r\n\r\n\t\tbinding._cacheIndex = firstInactiveIndex;\r\n\t\tbindings[ firstInactiveIndex ] = binding;\r\n\r\n\t\tlastActiveBinding._cacheIndex = prevIndex;\r\n\t\tbindings[ prevIndex ] = lastActiveBinding;\r\n\r\n\t},\r\n\r\n\r\n\t// Memory management of Interpolants for weight and time scale\r\n\r\n\t_lendControlInterpolant: function() {\r\n\r\n\t\tvar interpolants = this._controlInterpolants,\r\n\t\t\tlastActiveIndex = this._nActiveControlInterpolants ++,\r\n\t\t\tinterpolant = interpolants[ lastActiveIndex ];\r\n\r\n\t\tif ( interpolant === undefined ) {\r\n\r\n\t\t\tinterpolant = new THREE.LinearInterpolant(\r\n\t\t\t\t\tnew Float32Array( 2 ), new Float32Array( 2 ),\r\n\t\t\t\t\t\t1, this._controlInterpolantsResultBuffer );\r\n\r\n\t\t\tinterpolant.__cacheIndex = lastActiveIndex;\r\n\t\t\tinterpolants[ lastActiveIndex ] = interpolant;\r\n\r\n\t\t}\r\n\r\n\t\treturn interpolant;\r\n\r\n\t},\r\n\r\n\t_takeBackControlInterpolant: function( interpolant ) {\r\n\r\n\t\tvar interpolants = this._controlInterpolants,\r\n\t\t\tprevIndex = interpolant.__cacheIndex,\r\n\r\n\t\t\tfirstInactiveIndex = -- this._nActiveControlInterpolants,\r\n\r\n\t\t\tlastActiveInterpolant = interpolants[ firstInactiveIndex ];\r\n\r\n\t\tinterpolant.__cacheIndex = firstInactiveIndex;\r\n\t\tinterpolants[ firstInactiveIndex ] = interpolant;\r\n\r\n\t\tlastActiveInterpolant.__cacheIndex = prevIndex;\r\n\t\tinterpolants[ prevIndex ] = lastActiveInterpolant;\r\n\r\n\t},\r\n\r\n\t_controlInterpolantsResultBuffer: new Float32Array( 1 )\r\n\r\n} );\r\n\r\n\r\n// File:src/animation/AnimationObjectGroup.js\r\n\r\n/**\r\n *\r\n * A group of objects that receives a shared animation state.\r\n *\r\n * Usage:\r\n *\r\n * \t-\tAdd objects you would otherwise pass as 'root' to the\r\n * \t\tconstructor or the .clipAction method of AnimationMixer.\r\n *\r\n * \t-\tInstead pass this object as 'root'.\r\n *\r\n * \t-\tYou can also add and remove objects later when the mixer\r\n * \t\tis running.\r\n *\r\n * Note:\r\n *\r\n *  \tObjects of this class appear as one object to the mixer,\r\n *  \tso cache control of the individual objects must be done\r\n *  \ton the group.\r\n *\r\n * Limitation:\r\n *\r\n * \t- \tThe animated properties must be compatible among the\r\n * \t\tall objects in the group.\r\n *\r\n *  -\tA single property can either be controlled through a\r\n *  \ttarget group or directly, but not both.\r\n *\r\n * @author tschw\r\n */\r\n\r\nTHREE.AnimationObjectGroup = function( var_args ) {\r\n\r\n\tthis.uuid = THREE.Math.generateUUID();\r\n\r\n\t// cached objects followed by the active ones\r\n\tthis._objects = Array.prototype.slice.call( arguments );\r\n\r\n\tthis.nCachedObjects_ = 0;\t\t\t// threshold\r\n\t// note: read by PropertyBinding.Composite\r\n\r\n\tvar indices = {};\r\n\tthis._indicesByUUID = indices;\t\t// for bookkeeping\r\n\r\n\tfor ( var i = 0, n = arguments.length; i !== n; ++ i ) {\r\n\r\n\t\tindices[ arguments[ i ].uuid ] = i;\r\n\r\n\t}\r\n\r\n\tthis._paths = [];\t\t\t\t\t// inside: string\r\n\tthis._parsedPaths = [];\t\t\t\t// inside: { we don't care, here }\r\n\tthis._bindings = []; \t\t\t\t// inside: Array< PropertyBinding >\r\n\tthis._bindingsIndicesByPath = {}; \t// inside: indices in these arrays\r\n\r\n\tvar scope = this;\r\n\r\n\tthis.stats = {\r\n\r\n\t\tobjects: {\r\n\t\t\tget total() { return scope._objects.length; },\r\n\t\t\tget inUse() { return this.total - scope.nCachedObjects_;  }\r\n\t\t},\r\n\r\n\t\tget bindingsPerObject() { return scope._bindings.length; }\r\n\r\n\t};\r\n\r\n};\r\n\r\nTHREE.AnimationObjectGroup.prototype = {\r\n\r\n\tconstructor: THREE.AnimationObjectGroup,\r\n\r\n\tadd: function( var_args ) {\r\n\r\n\t\tvar objects = this._objects,\r\n\t\t\tnObjects = objects.length,\r\n\t\t\tnCachedObjects = this.nCachedObjects_,\r\n\t\t\tindicesByUUID = this._indicesByUUID,\r\n\t\t\tpaths = this._paths,\r\n\t\t\tparsedPaths = this._parsedPaths,\r\n\t\t\tbindings = this._bindings,\r\n\t\t\tnBindings = bindings.length;\r\n\r\n\t\tfor ( var i = 0, n = arguments.length; i !== n; ++ i ) {\r\n\r\n\t\t\tvar object = arguments[ i ],\r\n\t\t\t\tuuid = object.uuid,\r\n\t\t\t\tindex = indicesByUUID[ uuid ];\r\n\r\n\t\t\tif ( index === undefined ) {\r\n\r\n\t\t\t\t// unknown object -> add it to the ACTIVE region\r\n\r\n\t\t\t\tindex = nObjects ++;\r\n\t\t\t\tindicesByUUID[ uuid ] = index;\r\n\t\t\t\tobjects.push( object );\r\n\r\n\t\t\t\t// accounting is done, now do the same for all bindings\r\n\r\n\t\t\t\tfor ( var j = 0, m = nBindings; j !== m; ++ j ) {\r\n\r\n\t\t\t\t\tbindings[ j ].push(\r\n\t\t\t\t\t\t\tnew THREE.PropertyBinding(\r\n\t\t\t\t\t\t\t\tobject, paths[ j ], parsedPaths[ j ] ) );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t} else if ( index < nCachedObjects ) {\r\n\r\n\t\t\t\tvar knownObject = objects[ index ];\r\n\r\n\t\t\t\t// move existing object to the ACTIVE region\r\n\r\n\t\t\t\tvar firstActiveIndex = -- nCachedObjects,\r\n\t\t\t\t\tlastCachedObject = objects[ firstActiveIndex ];\r\n\r\n\t\t\t\tindicesByUUID[ lastCachedObject.uuid ] = index;\r\n\t\t\t\tobjects[ index ] = lastCachedObject;\r\n\r\n\t\t\t\tindicesByUUID[ uuid ] = firstActiveIndex;\r\n\t\t\t\tobjects[ firstActiveIndex ] = object;\r\n\r\n\t\t\t\t// accounting is done, now do the same for all bindings\r\n\r\n\t\t\t\tfor ( var j = 0, m = nBindings; j !== m; ++ j ) {\r\n\r\n\t\t\t\t\tvar bindingsForPath = bindings[ j ],\r\n\t\t\t\t\t\tlastCached = bindingsForPath[ firstActiveIndex ],\r\n\t\t\t\t\t\tbinding = bindingsForPath[ index ];\r\n\r\n\t\t\t\t\tbindingsForPath[ index ] = lastCached;\r\n\r\n\t\t\t\t\tif ( binding === undefined ) {\r\n\r\n\t\t\t\t\t\t// since we do not bother to create new bindings\r\n\t\t\t\t\t\t// for objects that are cached, the binding may\r\n\t\t\t\t\t\t// or may not exist\r\n\r\n\t\t\t\t\t\tbinding = new THREE.PropertyBinding(\r\n\t\t\t\t\t\t\t\tobject, paths[ j ], parsedPaths[ j ] );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tbindingsForPath[ firstActiveIndex ] = binding;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t} else if ( objects[ index ] !== knownObject) {\r\n\r\n\t\t\t\tconsole.error( \"Different objects with the same UUID \" +\r\n\t\t\t\t\t\t\"detected. Clean the caches or recreate your \" +\r\n\t\t\t\t\t\t\"infrastructure when reloading scenes...\" );\r\n\r\n\t\t\t} // else the object is already where we want it to be\r\n\r\n\t\t} // for arguments\r\n\r\n\t\tthis.nCachedObjects_ = nCachedObjects;\r\n\r\n\t},\r\n\r\n\tremove: function( var_args ) {\r\n\r\n\t\tvar objects = this._objects,\r\n\t\t\tnObjects = objects.length,\r\n\t\t\tnCachedObjects = this.nCachedObjects_,\r\n\t\t\tindicesByUUID = this._indicesByUUID,\r\n\t\t\tbindings = this._bindings,\r\n\t\t\tnBindings = bindings.length;\r\n\r\n\t\tfor ( var i = 0, n = arguments.length; i !== n; ++ i ) {\r\n\r\n\t\t\tvar object = arguments[ i ],\r\n\t\t\t\tuuid = object.uuid,\r\n\t\t\t\tindex = indicesByUUID[ uuid ];\r\n\r\n\t\t\tif ( index !== undefined && index >= nCachedObjects ) {\r\n\r\n\t\t\t\t// move existing object into the CACHED region\r\n\r\n\t\t\t\tvar lastCachedIndex = nCachedObjects ++,\r\n\t\t\t\t\tfirstActiveObject = objects[ lastCachedIndex ];\r\n\r\n\t\t\t\tindicesByUUID[ firstActiveObject.uuid ] = index;\r\n\t\t\t\tobjects[ index ] = firstActiveObject;\r\n\r\n\t\t\t\tindicesByUUID[ uuid ] = lastCachedIndex;\r\n\t\t\t\tobjects[ lastCachedIndex ] = object;\r\n\r\n\t\t\t\t// accounting is done, now do the same for all bindings\r\n\r\n\t\t\t\tfor ( var j = 0, m = nBindings; j !== m; ++ j ) {\r\n\r\n\t\t\t\t\tvar bindingsForPath = bindings[ j ],\r\n\t\t\t\t\t\tfirstActive = bindingsForPath[ lastCachedIndex ],\r\n\t\t\t\t\t\tbinding = bindingsForPath[ index ];\r\n\r\n\t\t\t\t\tbindingsForPath[ index ] = firstActive;\r\n\t\t\t\t\tbindingsForPath[ lastCachedIndex ] = binding;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t} // for arguments\r\n\r\n\t\tthis.nCachedObjects_ = nCachedObjects;\r\n\r\n\t},\r\n\r\n\t// remove & forget\r\n\tuncache: function( var_args ) {\r\n\r\n\t\tvar objects = this._objects,\r\n\t\t\tnObjects = objects.length,\r\n\t\t\tnCachedObjects = this.nCachedObjects_,\r\n\t\t\tindicesByUUID = this._indicesByUUID,\r\n\t\t\tbindings = this._bindings,\r\n\t\t\tnBindings = bindings.length;\r\n\r\n\t\tfor ( var i = 0, n = arguments.length; i !== n; ++ i ) {\r\n\r\n\t\t\tvar object = arguments[ i ],\r\n\t\t\t\tuuid = object.uuid,\r\n\t\t\t\tindex = indicesByUUID[ uuid ];\r\n\r\n\t\t\tif ( index !== undefined ) {\r\n\r\n\t\t\t\tdelete indicesByUUID[ uuid ];\r\n\r\n\t\t\t\tif ( index < nCachedObjects ) {\r\n\r\n\t\t\t\t\t// object is cached, shrink the CACHED region\r\n\r\n\t\t\t\t\tvar firstActiveIndex = -- nCachedObjects,\r\n\t\t\t\t\t\tlastCachedObject = objects[ firstActiveIndex ],\r\n\t\t\t\t\t\tlastIndex = -- nObjects,\r\n\t\t\t\t\t\tlastObject = objects[ lastIndex ];\r\n\r\n\t\t\t\t\t// last cached object takes this object's place\r\n\t\t\t\t\tindicesByUUID[ lastCachedObject.uuid ] = index;\r\n\t\t\t\t\tobjects[ index ] = lastCachedObject;\r\n\r\n\t\t\t\t\t// last object goes to the activated slot and pop\r\n\t\t\t\t\tindicesByUUID[ lastObject.uuid ] = firstActiveIndex;\r\n\t\t\t\t\tobjects[ firstActiveIndex ] = lastObject;\r\n\t\t\t\t\tobjects.pop();\r\n\r\n\t\t\t\t\t// accounting is done, now do the same for all bindings\r\n\r\n\t\t\t\t\tfor ( var j = 0, m = nBindings; j !== m; ++ j ) {\r\n\r\n\t\t\t\t\t\tvar bindingsForPath = bindings[ j ],\r\n\t\t\t\t\t\t\tlastCached = bindingsForPath[ firstActiveIndex ],\r\n\t\t\t\t\t\t\tlast = bindingsForPath[ lastIndex ];\r\n\r\n\t\t\t\t\t\tbindingsForPath[ index ] = lastCached;\r\n\t\t\t\t\t\tbindingsForPath[ firstActiveIndex ] = last;\r\n\t\t\t\t\t\tbindingsForPath.pop();\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\t// object is active, just swap with the last and pop\r\n\r\n\t\t\t\t\tvar lastIndex = -- nObjects,\r\n\t\t\t\t\t\tlastObject = objects[ lastIndex ];\r\n\r\n\t\t\t\t\tindicesByUUID[ lastObject.uuid ] = index;\r\n\t\t\t\t\tobjects[ index ] = lastObject;\r\n\t\t\t\t\tobjects.pop();\r\n\r\n\t\t\t\t\t// accounting is done, now do the same for all bindings\r\n\r\n\t\t\t\t\tfor ( var j = 0, m = nBindings; j !== m; ++ j ) {\r\n\r\n\t\t\t\t\t\tvar bindingsForPath = bindings[ j ];\r\n\r\n\t\t\t\t\t\tbindingsForPath[ index ] = bindingsForPath[ lastIndex ];\r\n\t\t\t\t\t\tbindingsForPath.pop();\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t} // cached or active\r\n\r\n\t\t\t} // if object is known\r\n\r\n\t\t} // for arguments\r\n\r\n\t\tthis.nCachedObjects_ = nCachedObjects;\r\n\r\n\t},\r\n\r\n\t// Internal interface used by befriended PropertyBinding.Composite:\r\n\r\n\tsubscribe_: function( path, parsedPath ) {\r\n\t\t// returns an array of bindings for the given path that is changed\r\n\t\t// according to the contained objects in the group\r\n\r\n\t\tvar indicesByPath = this._bindingsIndicesByPath,\r\n\t\t\tindex = indicesByPath[ path ],\r\n\t\t\tbindings = this._bindings;\r\n\r\n\t\tif ( index !== undefined ) return bindings[ index ];\r\n\r\n\t\tvar paths = this._paths,\r\n\t\t\tparsedPaths = this._parsedPaths,\r\n\t\t\tobjects = this._objects,\r\n\t\t\tnObjects = objects.length,\r\n\t\t\tnCachedObjects = this.nCachedObjects_,\r\n\t\t\tbindingsForPath = new Array( nObjects );\r\n\r\n\t\tindex = bindings.length;\r\n\r\n\t\tindicesByPath[ path ] = index;\r\n\r\n\t\tpaths.push( path );\r\n\t\tparsedPaths.push( parsedPath );\r\n\t\tbindings.push( bindingsForPath );\r\n\r\n\t\tfor ( var i = nCachedObjects,\r\n\t\t\t\tn = objects.length; i !== n; ++ i ) {\r\n\r\n\t\t\tvar object = objects[ i ];\r\n\r\n\t\t\tbindingsForPath[ i ] =\r\n\t\t\t\t\tnew THREE.PropertyBinding( object, path, parsedPath );\r\n\r\n\t\t}\r\n\r\n\t\treturn bindingsForPath;\r\n\r\n\t},\r\n\r\n\tunsubscribe_: function( path ) {\r\n\t\t// tells the group to forget about a property path and no longer\r\n\t\t// update the array previously obtained with 'subscribe_'\r\n\r\n\t\tvar indicesByPath = this._bindingsIndicesByPath,\r\n\t\t\tindex = indicesByPath[ path ];\r\n\r\n\t\tif ( index !== undefined ) {\r\n\r\n\t\t\tvar paths = this._paths,\r\n\t\t\t\tparsedPaths = this._parsedPaths,\r\n\t\t\t\tbindings = this._bindings,\r\n\t\t\t\tlastBindingsIndex = bindings.length - 1,\r\n\t\t\t\tlastBindings = bindings[ lastBindingsIndex ],\r\n\t\t\t\tlastBindingsPath = path[ lastBindingsIndex ];\r\n\r\n\t\t\tindicesByPath[ lastBindingsPath ] = index;\r\n\r\n\t\t\tbindings[ index ] = lastBindings;\r\n\t\t\tbindings.pop();\r\n\r\n\t\t\tparsedPaths[ index ] = parsedPaths[ lastBindingsIndex ];\r\n\t\t\tparsedPaths.pop();\r\n\r\n\t\t\tpaths[ index ] = paths[ lastBindingsIndex ];\r\n\t\t\tpaths.pop();\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n};\r\n\r\n\r\n// File:src/animation/AnimationUtils.js\r\n\r\n/**\r\n * @author tschw\r\n * @author Ben Houston / http://clara.io/\r\n * @author David Sarno / http://lighthaus.us/\r\n */\r\n\r\nTHREE.AnimationUtils = {\r\n\r\n\t// same as Array.prototype.slice, but also works on typed arrays\r\n\tarraySlice: function( array, from, to ) {\r\n\r\n\t\tif ( THREE.AnimationUtils.isTypedArray( array ) ) {\r\n\r\n\t\t\treturn new array.constructor( array.subarray( from, to ) );\r\n\r\n\t\t}\r\n\r\n\t\treturn array.slice( from, to );\r\n\r\n\t},\r\n\r\n\t// converts an array to a specific type\r\n\tconvertArray: function( array, type, forceClone ) {\r\n\r\n\t\tif ( ! array || // let 'undefined' and 'null' pass\r\n\t\t\t\t! forceClone && array.constructor === type ) return array;\r\n\r\n\t\tif ( typeof type.BYTES_PER_ELEMENT === 'number' ) {\r\n\r\n\t\t\treturn new type( array ); // create typed array\r\n\r\n\t\t}\r\n\r\n\t\treturn Array.prototype.slice.call( array ); // create Array\r\n\r\n\t},\r\n\r\n\tisTypedArray: function( object ) {\r\n\r\n\t\treturn ArrayBuffer.isView( object ) &&\r\n\t\t\t\t! ( object instanceof DataView );\r\n\r\n\t},\r\n\r\n\t// returns an array by which times and values can be sorted\r\n\tgetKeyframeOrder: function( times ) {\r\n\r\n\t\tfunction compareTime( i, j ) {\r\n\r\n\t\t\treturn times[ i ] - times[ j ];\r\n\r\n\t\t}\r\n\r\n\t\tvar n = times.length;\r\n\t\tvar result = new Array( n );\r\n\t\tfor ( var i = 0; i !== n; ++ i ) result[ i ] = i;\r\n\r\n\t\tresult.sort( compareTime );\r\n\r\n\t\treturn result;\r\n\r\n\t},\r\n\r\n\t// uses the array previously returned by 'getKeyframeOrder' to sort data\r\n\tsortedArray: function( values, stride, order ) {\r\n\r\n\t\tvar nValues = values.length;\r\n\t\tvar result = new values.constructor( nValues );\r\n\r\n\t\tfor ( var i = 0, dstOffset = 0; dstOffset !== nValues; ++ i ) {\r\n\r\n\t\t\tvar srcOffset = order[ i ] * stride;\r\n\r\n\t\t\tfor ( var j = 0; j !== stride; ++ j ) {\r\n\r\n\t\t\t\tresult[ dstOffset ++ ] = values[ srcOffset + j ];\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\treturn result;\r\n\r\n\t},\r\n\r\n\t// function for parsing AOS keyframe formats\r\n\tflattenJSON: function( jsonKeys, times, values, valuePropertyName ) {\r\n\r\n\t\tvar i = 1, key = jsonKeys[ 0 ];\r\n\r\n\t\twhile ( key !== undefined && key[ valuePropertyName ] === undefined ) {\r\n\r\n\t\t\tkey = jsonKeys[ i ++ ];\r\n\r\n\t\t}\r\n\r\n\t\tif ( key === undefined ) return; // no data\r\n\r\n\t\tvar value = key[ valuePropertyName ];\r\n\t\tif ( value === undefined ) return; // no data\r\n\r\n\t\tif ( Array.isArray( value ) ) {\r\n\r\n\t\t\tdo {\r\n\r\n\t\t\t\tvalue = key[ valuePropertyName ];\r\n\r\n\t\t\t\tif ( value !== undefined ) {\r\n\r\n\t\t\t\t\ttimes.push( key.time );\r\n\t\t\t\t\tvalues.push.apply( values, value ); // push all elements\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tkey = jsonKeys[ i ++ ];\r\n\r\n\t\t\t} while ( key !== undefined );\r\n\r\n\t\t} else if ( value.toArray !== undefined ) {\r\n\t\t\t// ...assume THREE.Math-ish\r\n\r\n\t\t\tdo {\r\n\r\n\t\t\t\tvalue = key[ valuePropertyName ];\r\n\r\n\t\t\t\tif ( value !== undefined ) {\r\n\r\n\t\t\t\t\ttimes.push( key.time );\r\n\t\t\t\t\tvalue.toArray( values, values.length );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tkey = jsonKeys[ i ++ ];\r\n\r\n\t\t\t} while ( key !== undefined );\r\n\r\n\t\t} else {\r\n\t\t\t// otherwise push as-is\r\n\r\n\t\t\tdo {\r\n\r\n\t\t\t\tvalue = key[ valuePropertyName ];\r\n\r\n\t\t\t\tif ( value !== undefined ) {\r\n\r\n\t\t\t\t\ttimes.push( key.time );\r\n\t\t\t\t\tvalues.push( value );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tkey = jsonKeys[ i ++ ];\r\n\r\n\t\t\t} while ( key !== undefined );\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n};\r\n\r\n// File:src/animation/KeyframeTrack.js\r\n\r\n/**\r\n *\r\n * A timed sequence of keyframes for a specific property.\r\n *\r\n *\r\n * @author Ben Houston / http://clara.io/\r\n * @author David Sarno / http://lighthaus.us/\r\n * @author tschw\r\n */\r\n\r\nTHREE.KeyframeTrack = function ( name, times, values, interpolation ) {\r\n\r\n\tif( name === undefined ) throw new Error( \"track name is undefined\" );\r\n\r\n\tif( times === undefined || times.length === 0 ) {\r\n\r\n\t\tthrow new Error( \"no keyframes in track named \" + name );\r\n\r\n\t}\r\n\r\n\tthis.name = name;\r\n\r\n\tthis.times = THREE.AnimationUtils.convertArray( times, this.TimeBufferType );\r\n\tthis.values = THREE.AnimationUtils.convertArray( values, this.ValueBufferType );\r\n\r\n\tthis.setInterpolation( interpolation || this.DefaultInterpolation );\r\n\r\n\tthis.validate();\r\n\tthis.optimize();\r\n\r\n};\r\n\r\nTHREE.KeyframeTrack.prototype = {\r\n\r\n\tconstructor: THREE.KeyframeTrack,\r\n\r\n\tTimeBufferType: Float32Array,\r\n\tValueBufferType: Float32Array,\r\n\r\n\tDefaultInterpolation: THREE.InterpolateLinear,\r\n\r\n\tInterpolantFactoryMethodDiscrete: function( result ) {\r\n\r\n\t\treturn new THREE.DiscreteInterpolant(\r\n\t\t\t\tthis.times, this.values, this.getValueSize(), result );\r\n\r\n\t},\r\n\r\n\tInterpolantFactoryMethodLinear: function( result ) {\r\n\r\n\t\treturn new THREE.LinearInterpolant(\r\n\t\t\t\tthis.times, this.values, this.getValueSize(), result );\r\n\r\n\t},\r\n\r\n\tInterpolantFactoryMethodSmooth: function( result ) {\r\n\r\n\t\treturn new THREE.CubicInterpolant(\r\n\t\t\t\tthis.times, this.values, this.getValueSize(), result );\r\n\r\n\t},\r\n\r\n\tsetInterpolation: function( interpolation ) {\r\n\r\n\t\tvar factoryMethod = undefined;\r\n\r\n\t\tswitch ( interpolation ) {\r\n\r\n\t\t\tcase THREE.InterpolateDiscrete:\r\n\r\n\t\t\t\tfactoryMethod = this.InterpolantFactoryMethodDiscrete;\r\n\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tcase THREE.InterpolateLinear:\r\n\r\n\t\t\t\tfactoryMethod = this.InterpolantFactoryMethodLinear;\r\n\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tcase THREE.InterpolateSmooth:\r\n\r\n\t\t\t\tfactoryMethod = this.InterpolantFactoryMethodSmooth;\r\n\r\n\t\t\t\tbreak;\r\n\r\n\t\t}\r\n\r\n\t\tif ( factoryMethod === undefined ) {\r\n\r\n\t\t\tvar message = \"unsupported interpolation for \" +\r\n\t\t\t\t\tthis.ValueTypeName + \" keyframe track named \" + this.name;\r\n\r\n\t\t\tif ( this.createInterpolant === undefined ) {\r\n\r\n\t\t\t\t// fall back to default, unless the default itself is messed up\r\n\t\t\t\tif ( interpolation !== this.DefaultInterpolation ) {\r\n\r\n\t\t\t\t\tthis.setInterpolation( this.DefaultInterpolation );\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tthrow new Error( message ); // fatal, in this case\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tconsole.warn( message );\r\n\t\t\treturn;\r\n\r\n\t\t}\r\n\r\n\t\tthis.createInterpolant = factoryMethod;\r\n\r\n\t},\r\n\r\n\tgetInterpolation: function() {\r\n\r\n\t\tswitch ( this.createInterpolant ) {\r\n\r\n\t\t\tcase this.InterpolantFactoryMethodDiscrete:\r\n\r\n\t\t\t\treturn THREE.InterpolateDiscrete;\r\n\r\n\t\t\tcase this.InterpolantFactoryMethodLinear:\r\n\r\n\t\t\t\treturn THREE.InterpolateLinear;\r\n\r\n\t\t\tcase this.InterpolantFactoryMethodSmooth:\r\n\r\n\t\t\t\treturn THREE.InterpolateSmooth;\r\n\r\n\t\t}\r\n\r\n\t},\r\n\r\n\tgetValueSize: function() {\r\n\r\n\t\treturn this.values.length / this.times.length;\r\n\r\n\t},\r\n\r\n\t// move all keyframes either forwards or backwards in time\r\n\tshift: function( timeOffset ) {\r\n\r\n\t\tif( timeOffset !== 0.0 ) {\r\n\r\n\t\t\tvar times = this.times;\r\n\r\n\t\t\tfor( var i = 0, n = times.length; i !== n; ++ i ) {\r\n\r\n\t\t\t\ttimes[ i ] += timeOffset;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\t// scale all keyframe times by a factor (useful for frame <-> seconds conversions)\r\n\tscale: function( timeScale ) {\r\n\r\n\t\tif( timeScale !== 1.0 ) {\r\n\r\n\t\t\tvar times = this.times;\r\n\r\n\t\t\tfor( var i = 0, n = times.length; i !== n; ++ i ) {\r\n\r\n\t\t\t\ttimes[ i ] *= timeScale;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\t// removes keyframes before and after animation without changing any values within the range [startTime, endTime].\r\n\t// IMPORTANT: We do not shift around keys to the start of the track time, because for interpolated keys this will change their values\r\n\ttrim: function( startTime, endTime ) {\r\n\r\n\t\tvar times = this.times,\r\n\t\t\tnKeys = times.length,\r\n\t\t\tfrom = 0,\r\n\t\t\tto = nKeys - 1;\r\n\r\n\t\twhile ( from !== nKeys && times[ from ] < startTime ) ++ from;\r\n\t\twhile ( to !== -1 && times[ to ] > endTime ) -- to;\r\n\r\n\t\t++ to; // inclusive -> exclusive bound\r\n\r\n\t\tif( from !== 0 || to !== nKeys ) {\r\n\r\n\t\t\t// empty tracks are forbidden, so keep at least one keyframe\r\n\t\t\tif ( from >= to ) to = Math.max( to , 1 ), from = to - 1;\r\n\r\n\t\t\tvar stride = this.getValueSize();\r\n\t\t\tthis.times = THREE.AnimationUtils.arraySlice( times, from, to );\r\n\t\t\tthis.values = THREE.AnimationUtils.\r\n\t\t\t\t\tarraySlice( this.values, from * stride, to * stride );\r\n\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\t// ensure we do not get a GarbageInGarbageOut situation, make sure tracks are at least minimally viable\r\n\tvalidate: function() {\r\n\r\n\t\tvar valid = true;\r\n\r\n\t\tvar valueSize = this.getValueSize();\r\n\t\tif ( valueSize - Math.floor( valueSize ) !== 0 ) {\r\n\r\n\t\t\tconsole.error( \"invalid value size in track\", this );\r\n\t\t\tvalid = false;\r\n\r\n\t\t}\r\n\r\n\t\tvar times = this.times,\r\n\t\t\tvalues = this.values,\r\n\r\n\t\t\tnKeys = times.length;\r\n\r\n\t\tif( nKeys === 0 ) {\r\n\r\n\t\t\tconsole.error( \"track is empty\", this );\r\n\t\t\tvalid = false;\r\n\r\n\t\t}\r\n\r\n\t\tvar prevTime = null;\r\n\r\n\t\tfor( var i = 0; i !== nKeys; i ++ ) {\r\n\r\n\t\t\tvar currTime = times[ i ];\r\n\r\n\t\t\tif ( typeof currTime === 'number' && isNaN( currTime ) ) {\r\n\r\n\t\t\t\tconsole.error( \"time is not a valid number\", this, i, currTime );\r\n\t\t\t\tvalid = false;\r\n\t\t\t\tbreak;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif( prevTime !== null && prevTime > currTime ) {\r\n\r\n\t\t\t\tconsole.error( \"out of order keys\", this, i, currTime, prevTime );\r\n\t\t\t\tvalid = false;\r\n\t\t\t\tbreak;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tprevTime = currTime;\r\n\r\n\t\t}\r\n\r\n\t\tif ( values !== undefined ) {\r\n\r\n\t\t\tif ( THREE.AnimationUtils.isTypedArray( values ) ) {\r\n\r\n\t\t\t\tfor ( var i = 0, n = values.length; i !== n; ++ i ) {\r\n\r\n\t\t\t\t\tvar value = values[ i ];\r\n\r\n\t\t\t\t\tif ( isNaN( value ) ) {\r\n\r\n\t\t\t\t\t\tconsole.error( \"value is not a valid number\", this, i, value );\r\n\t\t\t\t\t\tvalid = false;\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\treturn valid;\r\n\r\n\t},\r\n\r\n\t// removes equivalent sequential keys as common in morph target sequences\r\n\t// (0,0,0,0,1,1,1,0,0,0,0,0,0,0) --> (0,0,1,1,0,0)\r\n\toptimize: function() {\r\n\r\n\t\tvar times = this.times,\r\n\t\t\tvalues = this.values,\r\n\t\t\tstride = this.getValueSize(),\r\n\r\n\t\t\twriteIndex = 1;\r\n\r\n\t\tfor( var i = 1, n = times.length - 1; i <= n; ++ i ) {\r\n\r\n\t\t\tvar keep = false;\r\n\r\n\t\t\tvar time = times[ i ];\r\n\t\t\tvar timeNext = times[ i + 1 ];\r\n\r\n\t\t\t// remove adjacent keyframes scheduled at the same time\r\n\r\n\t\t\tif ( time !== timeNext && ( i !== 1 || time !== time[ 0 ] ) ) {\r\n\r\n\t\t\t\t// remove unnecessary keyframes same as their neighbors\r\n\t\t\t\tvar offset = i * stride,\r\n\t\t\t\t\toffsetP = offset - stride,\r\n\t\t\t\t\toffsetN = offset + stride;\r\n\r\n\t\t\t\tfor ( var j = 0; j !== stride; ++ j ) {\r\n\r\n\t\t\t\t\tvar value = values[ offset + j ];\r\n\r\n\t\t\t\t\tif ( value !== values[ offsetP + j ] ||\r\n\t\t\t\t\t\t\tvalue !== values[ offsetN + j ] ) {\r\n\r\n\t\t\t\t\t\tkeep = true;\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// in-place compaction\r\n\r\n\t\t\tif ( keep ) {\r\n\r\n\t\t\t\tif ( i !== writeIndex ) {\r\n\r\n\t\t\t\t\ttimes[ writeIndex ] = times[ i ];\r\n\r\n\t\t\t\t\tvar readOffset = i * stride,\r\n\t\t\t\t\t\twriteOffset = writeIndex * stride;\r\n\r\n\t\t\t\t\tfor ( var j = 0; j !== stride; ++ j ) {\r\n\r\n\t\t\t\t\t\tvalues[ writeOffset + j ] = values[ readOffset + j ];\r\n\r\n\t\t\t\t\t}\r\n\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\t++ writeIndex;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tif ( writeIndex !== times.length ) {\r\n\r\n\t\t\tthis.times = THREE.AnimationUtils.arraySlice( times, 0, writeIndex );\r\n\t\t\tthis.values = THREE.AnimationUtils.arraySlice( values, 0, writeIndex * stride );\r\n\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\r\n\t}\r\n\r\n};\r\n\r\n// Static methods:\r\n\r\nObject.assign( THREE.KeyframeTrack, {\r\n\r\n\t// Serialization (in static context, because of constructor invocation\r\n\t// and automatic invocation of .toJSON):\r\n\r\n\tparse: function( json ) {\r\n\r\n\t\tif( json.type === undefined ) {\r\n\r\n\t\t\tthrow new Error( \"track type undefined, can not parse\" );\r\n\r\n\t\t}\r\n\r\n\t\tvar trackType = THREE.KeyframeTrack._getTrackTypeForValueTypeName( json.type );\r\n\r\n\t\tif ( json.times === undefined ) {\r\n\r\n\t\t\tconsole.warn( \"legacy JSON format detected, converting\" );\r\n\r\n\t\t\tvar times = [], values = [];\r\n\r\n\t\t\tTHREE.AnimationUtils.flattenJSON( json.keys, times, values, 'value' );\r\n\r\n\t\t\tjson.times = times;\r\n\t\t\tjson.values = values;\r\n\r\n\t\t}\r\n\r\n\t\t// derived classes can define a static parse method\r\n\t\tif ( trackType.parse !== undefined ) {\r\n\r\n\t\t\treturn trackType.parse( json );\r\n\r\n\t\t} else {\r\n\r\n\t\t\t// by default, we asssume a constructor compatible with the base\r\n\t\t\treturn new trackType(\r\n\t\t\t\t\tjson.name, json.times, json.values, json.interpolation );\r\n\r\n\t\t}\r\n\r\n\t},\r\n\r\n\ttoJSON: function( track ) {\r\n\r\n\t\tvar trackType = track.constructor;\r\n\r\n\t\tvar json;\r\n\r\n\t\t// derived classes can define a static toJSON method\r\n\t\tif ( trackType.toJSON !== undefined ) {\r\n\r\n\t\t\tjson = trackType.toJSON( track );\r\n\r\n\t\t} else {\r\n\r\n\t\t\t// by default, we assume the data can be serialized as-is\r\n\t\t\tjson = {\r\n\r\n\t\t\t\t'name': track.name,\r\n\t\t\t\t'times': THREE.AnimationUtils.convertArray( track.times, Array ),\r\n\t\t\t\t'values': THREE.AnimationUtils.convertArray( track.values, Array )\r\n\r\n\t\t\t};\r\n\r\n\t\t\tvar interpolation = track.getInterpolation();\r\n\r\n\t\t\tif ( interpolation !== track.DefaultInterpolation ) {\r\n\r\n\t\t\t\tjson.interpolation = interpolation;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tjson.type = track.ValueTypeName; // mandatory\r\n\r\n\t\treturn json;\r\n\r\n\t},\r\n\r\n\t_getTrackTypeForValueTypeName: function( typeName ) {\r\n\r\n\t\tswitch( typeName.toLowerCase() ) {\r\n\r\n\t\t\tcase \"scalar\":\r\n\t\t\tcase \"double\":\r\n\t\t\tcase \"float\":\r\n\t\t\tcase \"number\":\r\n\t\t\tcase \"integer\":\r\n\r\n\t\t\t\treturn THREE.NumberKeyframeTrack;\r\n\r\n\t\t\tcase \"vector\":\r\n\t\t\tcase \"vector2\":\r\n\t\t\tcase \"vector3\":\r\n\t\t\tcase \"vector4\":\r\n\r\n\t\t\t\treturn THREE.VectorKeyframeTrack;\r\n\r\n\t\t\tcase \"color\":\r\n\r\n\t\t\t\treturn THREE.ColorKeyframeTrack;\r\n\r\n\t\t\tcase \"quaternion\":\r\n\r\n\t\t\t\treturn THREE.QuaternionKeyframeTrack;\r\n\r\n\t\t\tcase \"bool\":\r\n\t\t\tcase \"boolean\":\r\n\r\n\t\t\t\treturn THREE.BooleanKeyframeTrack;\r\n\r\n\t\t\tcase \"string\":\r\n\r\n\t\t\t\treturn THREE.StringKeyframeTrack;\r\n\r\n\t\t};\r\n\r\n\t\tthrow new Error( \"Unsupported typeName: \" + typeName );\r\n\r\n\t}\r\n\r\n} );\r\n\r\n// File:src/animation/PropertyBinding.js\r\n\r\n/**\r\n *\r\n * A reference to a real property in the scene graph.\r\n *\r\n *\r\n * @author Ben Houston / http://clara.io/\r\n * @author David Sarno / http://lighthaus.us/\r\n * @author tschw\r\n */\r\n\r\nTHREE.PropertyBinding = function ( rootNode, path, parsedPath ) {\r\n\r\n\tthis.path = path;\r\n\tthis.parsedPath = parsedPath ||\r\n\t\t\tTHREE.PropertyBinding.parseTrackName( path );\r\n\r\n\tthis.node = THREE.PropertyBinding.findNode(\r\n\t\t\trootNode, this.parsedPath.nodeName ) || rootNode;\r\n\r\n\tthis.rootNode = rootNode;\r\n\r\n};\r\n\r\nTHREE.PropertyBinding.prototype = {\r\n\r\n\tconstructor: THREE.PropertyBinding,\r\n\r\n\tgetValue: function getValue_unbound( targetArray, offset ) {\r\n\r\n\t\tthis.bind();\r\n\t\tthis.getValue( targetArray, offset );\r\n\r\n\t\t// Note: This class uses a State pattern on a per-method basis:\r\n\t\t// 'bind' sets 'this.getValue' / 'setValue' and shadows the\r\n\t\t// prototype version of these methods with one that represents\r\n\t\t// the bound state. When the property is not found, the methods\r\n\t\t// become no-ops.\r\n\r\n\t},\r\n\r\n\tsetValue: function getValue_unbound( sourceArray, offset ) {\r\n\r\n\t\tthis.bind();\r\n\t\tthis.setValue( sourceArray, offset );\r\n\r\n\t},\r\n\r\n\t// create getter / setter pair for a property in the scene graph\r\n\tbind: function() {\r\n\r\n\t\tvar targetObject = this.node,\r\n\t\t\tparsedPath = this.parsedPath,\r\n\r\n\t\t\tobjectName = parsedPath.objectName,\r\n\t\t\tpropertyName = parsedPath.propertyName,\r\n\t\t\tpropertyIndex = parsedPath.propertyIndex;\r\n\r\n\t\tif ( ! targetObject ) {\r\n\r\n\t\t\ttargetObject = THREE.PropertyBinding.findNode(\r\n\t\t\t\t\tthis.rootNode, parsedPath.nodeName ) || this.rootNode;\r\n\r\n\t\t\tthis.node = targetObject;\r\n\r\n\t\t}\r\n\r\n\t\t// set fail state so we can just 'return' on error\r\n\t\tthis.getValue = this._getValue_unavailable;\r\n\t\tthis.setValue = this._setValue_unavailable;\r\n\r\n \t\t// ensure there is a value node\r\n\t\tif ( ! targetObject ) {\r\n\r\n\t\t\tconsole.error( \"  trying to update node for track: \" + this.path + \" but it wasn't found.\" );\r\n\t\t\treturn;\r\n\r\n\t\t}\r\n\r\n\t\tif( objectName ) {\r\n\r\n\t\t\tvar objectIndex = parsedPath.objectIndex;\r\n\r\n\t\t\t// special cases were we need to reach deeper into the hierarchy to get the face materials....\r\n\t\t\tswitch ( objectName ) {\r\n\r\n\t\t\t\tcase 'materials':\r\n\r\n\t\t\t\t\tif( ! targetObject.material ) {\r\n\r\n\t\t\t\t\t\tconsole.error( '  can not bind to material as node does not have a material', this );\r\n\t\t\t\t\t\treturn;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif( ! targetObject.material.materials ) {\r\n\r\n\t\t\t\t\t\tconsole.error( '  can not bind to material.materials as node.material does not have a materials array', this );\r\n\t\t\t\t\t\treturn;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\ttargetObject = targetObject.material.materials;\r\n\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'bones':\r\n\r\n\t\t\t\t\tif( ! targetObject.skeleton ) {\r\n\r\n\t\t\t\t\t\tconsole.error( '  can not bind to bones as node does not have a skeleton', this );\r\n\t\t\t\t\t\treturn;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t// potential future optimization: skip this if propertyIndex is already an integer\r\n\t\t\t\t\t// and convert the integer string to a true integer.\r\n\r\n\t\t\t\t\ttargetObject = targetObject.skeleton.bones;\r\n\r\n\t\t\t\t\t// support resolving morphTarget names into indices.\r\n\t\t\t\t\tfor ( var i = 0; i < targetObject.length; i ++ ) {\r\n\r\n\t\t\t\t\t\tif ( targetObject[i].name === objectIndex ) {\r\n\r\n\t\t\t\t\t\t\tobjectIndex = i;\r\n\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tdefault:\r\n\r\n\t\t\t\t\tif ( targetObject[ objectName ] === undefined ) {\r\n\r\n\t\t\t\t\t\tconsole.error( '  can not bind to objectName of node, undefined', this );\r\n\t\t\t\t\t\treturn;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\ttargetObject = targetObject[ objectName ];\r\n\r\n\t\t\t}\r\n\r\n\r\n\t\t\tif ( objectIndex !== undefined ) {\r\n\r\n\t\t\t\tif( targetObject[ objectIndex ] === undefined ) {\r\n\r\n\t\t\t\t\tconsole.error( \"  trying to bind to objectIndex of objectName, but is undefined:\", this, targetObject );\r\n\t\t\t\t\treturn;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\ttargetObject = targetObject[ objectIndex ];\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\t// resolve property\r\n\t\tvar nodeProperty = targetObject[ propertyName ];\r\n\r\n\t\tif ( ! nodeProperty ) {\r\n\r\n\t\t\tvar nodeName = parsedPath.nodeName;\r\n\r\n\t\t\tconsole.error( \"  trying to update property for track: \" + nodeName +\r\n\t\t\t\t\t'.' + propertyName + \" but it wasn't found.\", targetObject );\r\n\t\t\treturn;\r\n\r\n\t\t}\r\n\r\n\t\t// determine versioning scheme\r\n\t\tvar versioning = this.Versioning.None;\r\n\r\n\t\tif ( targetObject.needsUpdate !== undefined ) { // material\r\n\r\n\t\t\tversioning = this.Versioning.NeedsUpdate;\r\n\t\t\tthis.targetObject = targetObject;\r\n\r\n\t\t} else if ( targetObject.matrixWorldNeedsUpdate !== undefined ) { // node transform\r\n\r\n\t\t\tversioning = this.Versioning.MatrixWorldNeedsUpdate;\r\n\t\t\tthis.targetObject = targetObject;\r\n\r\n\t\t}\r\n\r\n\t\t// determine how the property gets bound\r\n\t\tvar bindingType = this.BindingType.Direct;\r\n\r\n\t\tif ( propertyIndex !== undefined ) {\r\n\t\t\t// access a sub element of the property array (only primitives are supported right now)\r\n\r\n\t\t\tif ( propertyName === \"morphTargetInfluences\" ) {\r\n\t\t\t\t// potential optimization, skip this if propertyIndex is already an integer, and convert the integer string to a true integer.\r\n\r\n\t\t\t\t// support resolving morphTarget names into indices.\r\n\t\t\t\tif ( ! targetObject.geometry ) {\r\n\r\n\t\t\t\t\tconsole.error( '  can not bind to morphTargetInfluences becasuse node does not have a geometry', this );\r\n\t\t\t\t\treturn;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( ! targetObject.geometry.morphTargets ) {\r\n\r\n\t\t\t\t\tconsole.error( '  can not bind to morphTargetInfluences becasuse node does not have a geometry.morphTargets', this );\r\n\t\t\t\t\treturn;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tfor ( var i = 0; i < this.node.geometry.morphTargets.length; i ++ ) {\r\n\r\n\t\t\t\t\tif ( targetObject.geometry.morphTargets[i].name === propertyIndex ) {\r\n\r\n\t\t\t\t\t\tpropertyIndex = i;\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tbindingType = this.BindingType.ArrayElement;\r\n\r\n\t\t\tthis.resolvedProperty = nodeProperty;\r\n\t\t\tthis.propertyIndex = propertyIndex;\r\n\r\n\t\t} else if ( nodeProperty.fromArray !== undefined && nodeProperty.toArray !== undefined ) {\r\n\t\t\t// must use copy for Object3D.Euler/Quaternion\r\n\r\n\t\t\tbindingType = this.BindingType.HasFromToArray;\r\n\r\n\t\t\tthis.resolvedProperty = nodeProperty;\r\n\r\n\t\t} else if ( nodeProperty.length !== undefined ) {\r\n\r\n\t\t\tbindingType = this.BindingType.EntireArray;\r\n\r\n\t\t\tthis.resolvedProperty = nodeProperty;\r\n\r\n\t\t} else {\r\n\r\n\t\t\tthis.propertyName = propertyName;\r\n\r\n\t\t}\r\n\r\n\t\t// select getter / setter\r\n\t\tthis.getValue = this.GetterByBindingType[ bindingType ];\r\n\t\tthis.setValue = this.SetterByBindingTypeAndVersioning[ bindingType ][ versioning ];\r\n\r\n\t},\r\n\r\n\tunbind: function() {\r\n\r\n\t\tthis.node = null;\r\n\r\n\t\t// back to the prototype version of getValue / setValue\r\n\t\t// note: avoiding to mutate the shape of 'this' via 'delete'\r\n\t\tthis.getValue = this._getValue_unbound;\r\n\t\tthis.setValue = this._setValue_unbound;\r\n\r\n\t}\r\n\r\n};\r\n\r\nObject.assign( THREE.PropertyBinding.prototype, { // prototype, continued\r\n\r\n\t// these are used to \"bind\" a nonexistent property\r\n\t_getValue_unavailable: function() {},\r\n\t_setValue_unavailable: function() {},\r\n\r\n\t// initial state of these methods that calls 'bind'\r\n\t_getValue_unbound: THREE.PropertyBinding.prototype.getValue,\r\n\t_setValue_unbound: THREE.PropertyBinding.prototype.setValue,\r\n\r\n\tBindingType: {\r\n\t\tDirect: 0,\r\n\t\tEntireArray: 1,\r\n\t\tArrayElement: 2,\r\n\t\tHasFromToArray: 3\r\n\t},\r\n\r\n\tVersioning: {\r\n\t\tNone: 0,\r\n\t\tNeedsUpdate: 1,\r\n\t\tMatrixWorldNeedsUpdate: 2\r\n\t},\r\n\r\n\tGetterByBindingType: [\r\n\r\n\t\tfunction getValue_direct( buffer, offset ) {\r\n\r\n\t\t\tbuffer[ offset ] = this.node[ this.propertyName ];\r\n\r\n\t\t},\r\n\r\n\t\tfunction getValue_array( buffer, offset ) {\r\n\r\n\t\t\tvar source = this.resolvedProperty;\r\n\r\n\t\t\tfor ( var i = 0, n = source.length; i !== n; ++ i ) {\r\n\r\n\t\t\t\tbuffer[ offset ++ ] = source[ i ];\r\n\r\n\t\t\t}\r\n\r\n\t\t},\r\n\r\n\t\tfunction getValue_arrayElement( buffer, offset ) {\r\n\r\n\t\t\tbuffer[ offset ] = this.resolvedProperty[ this.propertyIndex ];\r\n\r\n\t\t},\r\n\r\n\t\tfunction getValue_toArray( buffer, offset ) {\r\n\r\n\t\t\tthis.resolvedProperty.toArray( buffer, offset );\r\n\r\n\t\t}\r\n\r\n\t],\r\n\r\n\tSetterByBindingTypeAndVersioning: [\r\n\r\n\t\t[\r\n\t\t\t// Direct\r\n\r\n\t\t\tfunction setValue_direct( buffer, offset ) {\r\n\r\n\t\t\t\tthis.node[ this.propertyName ] = buffer[ offset ];\r\n\r\n\t\t\t},\r\n\r\n\t\t\tfunction setValue_direct_setNeedsUpdate( buffer, offset ) {\r\n\r\n\t\t\t\tthis.node[ this.propertyName ] = buffer[ offset ];\r\n\t\t\t\tthis.targetObject.needsUpdate = true;\r\n\r\n\t\t\t},\r\n\r\n\t\t\tfunction setValue_direct_setMatrixWorldNeedsUpdate( buffer, offset ) {\r\n\r\n\t\t\t\tthis.node[ this.propertyName ] = buffer[ offset ];\r\n\t\t\t\tthis.targetObject.matrixWorldNeedsUpdate = true;\r\n\r\n\t\t\t}\r\n\r\n\t\t], [\r\n\r\n\t\t\t// EntireArray\r\n\r\n\t\t\tfunction setValue_array( buffer, offset ) {\r\n\r\n\t\t\t\tvar dest = this.resolvedProperty;\r\n\r\n\t\t\t\tfor ( var i = 0, n = dest.length; i !== n; ++ i ) {\r\n\r\n\t\t\t\t\tdest[ i ] = buffer[ offset ++ ];\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t},\r\n\r\n\t\t\tfunction setValue_array_setNeedsUpdate( buffer, offset ) {\r\n\r\n\t\t\t\tvar dest = this.resolvedProperty;\r\n\r\n\t\t\t\tfor ( var i = 0, n = dest.length; i !== n; ++ i ) {\r\n\r\n\t\t\t\t\tdest[ i ] = buffer[ offset ++ ];\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tthis.targetObject.needsUpdate = true;\r\n\r\n\t\t\t},\r\n\r\n\t\t\tfunction setValue_array_setMatrixWorldNeedsUpdate( buffer, offset ) {\r\n\r\n\t\t\t\tvar dest = this.resolvedProperty;\r\n\r\n\t\t\t\tfor ( var i = 0, n = dest.length; i !== n; ++ i ) {\r\n\r\n\t\t\t\t\tdest[ i ] = buffer[ offset ++ ];\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tthis.targetObject.matrixWorldNeedsUpdate = true;\r\n\r\n\t\t\t}\r\n\r\n\t\t], [\r\n\r\n\t\t\t// ArrayElement\r\n\r\n\t\t\tfunction setValue_arrayElement( buffer, offset ) {\r\n\r\n\t\t\t\tthis.resolvedProperty[ this.propertyIndex ] = buffer[ offset ];\r\n\r\n\t\t\t},\r\n\r\n\t\t\tfunction setValue_arrayElement_setNeedsUpdate( buffer, offset ) {\r\n\r\n\t\t\t\tthis.resolvedProperty[ this.propertyIndex ] = buffer[ offset ];\r\n\t\t\t\tthis.targetObject.needsUpdate = true;\r\n\r\n\t\t\t},\r\n\r\n\t\t\tfunction setValue_arrayElement_setMatrixWorldNeedsUpdate( buffer, offset ) {\r\n\r\n\t\t\t\tthis.resolvedProperty[ this.propertyIndex ] = buffer[ offset ];\r\n\t\t\t\tthis.targetObject.matrixWorldNeedsUpdate = true;\r\n\r\n\t\t\t}\r\n\r\n\t\t], [\r\n\r\n\t\t\t// HasToFromArray\r\n\r\n\t\t\tfunction setValue_fromArray( buffer, offset ) {\r\n\r\n\t\t\t\tthis.resolvedProperty.fromArray( buffer, offset );\r\n\r\n\t\t\t},\r\n\r\n\t\t\tfunction setValue_fromArray_setNeedsUpdate( buffer, offset ) {\r\n\r\n\t\t\t\tthis.resolvedProperty.fromArray( buffer, offset );\r\n\t\t\t\tthis.targetObject.needsUpdate = true;\r\n\r\n\t\t\t},\r\n\r\n\t\t\tfunction setValue_fromArray_setMatrixWorldNeedsUpdate( buffer, offset ) {\r\n\r\n\t\t\t\tthis.resolvedProperty.fromArray( buffer, offset );\r\n\t\t\t\tthis.targetObject.matrixWorldNeedsUpdate = true;\r\n\r\n\t\t\t}\r\n\r\n\t\t]\r\n\r\n\t]\r\n\r\n} );\r\n\r\nTHREE.PropertyBinding.Composite =\r\n\t\tfunction( targetGroup, path, optionalParsedPath ) {\r\n\r\n\tvar parsedPath = optionalParsedPath ||\r\n\t\t\tTHREE.PropertyBinding.parseTrackName( path );\r\n\r\n\tthis._targetGroup = targetGroup;\r\n\tthis._bindings = targetGroup.subscribe_( path, parsedPath );\r\n\r\n};\r\n\r\nTHREE.PropertyBinding.Composite.prototype = {\r\n\r\n\tconstructor: THREE.PropertyBinding.Composite,\r\n\r\n\tgetValue: function( array, offset ) {\r\n\r\n\t\tthis.bind(); // bind all binding\r\n\r\n\t\tvar firstValidIndex = this._targetGroup.nCachedObjects_,\r\n\t\t\tbinding = this._bindings[ firstValidIndex ];\r\n\r\n\t\t// and only call .getValue on the first\r\n\t\tif ( binding !== undefined ) binding.getValue( array, offset );\r\n\r\n\t},\r\n\r\n\tsetValue: function( array, offset ) {\r\n\r\n\t\tvar bindings = this._bindings;\r\n\r\n\t\tfor ( var i = this._targetGroup.nCachedObjects_,\r\n\t\t\t\tn = bindings.length; i !== n; ++ i ) {\r\n\r\n\t\t\tbindings[ i ].setValue( array, offset );\r\n\r\n\t\t}\r\n\r\n\t},\r\n\r\n\tbind: function() {\r\n\r\n\t\tvar bindings = this._bindings;\r\n\r\n\t\tfor ( var i = this._targetGroup.nCachedObjects_,\r\n\t\t\t\tn = bindings.length; i !== n; ++ i ) {\r\n\r\n\t\t\tbindings[ i ].bind();\r\n\r\n\t\t}\r\n\r\n\t},\r\n\r\n\tunbind: function() {\r\n\r\n\t\tvar bindings = this._bindings;\r\n\r\n\t\tfor ( var i = this._targetGroup.nCachedObjects_,\r\n\t\t\t\tn = bindings.length; i !== n; ++ i ) {\r\n\r\n\t\t\tbindings[ i ].unbind();\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n};\r\n\r\nTHREE.PropertyBinding.create = function( root, path, parsedPath ) {\r\n\r\n\tif ( ! ( root instanceof THREE.AnimationObjectGroup ) ) {\r\n\r\n\t\treturn new THREE.PropertyBinding( root, path, parsedPath );\r\n\r\n\t} else {\r\n\r\n\t\treturn new THREE.PropertyBinding.Composite( root, path, parsedPath );\r\n\r\n\t}\r\n\r\n};\r\n\r\nTHREE.PropertyBinding.parseTrackName = function( trackName ) {\r\n\r\n\t// matches strings in the form of:\r\n\t//    nodeName.property\r\n\t//    nodeName.property[accessor]\r\n\t//    nodeName.material.property[accessor]\r\n\t//    uuid.property[accessor]\r\n\t//    uuid.objectName[objectIndex].propertyName[propertyIndex]\r\n\t//    parentName/nodeName.property\r\n\t//    parentName/parentName/nodeName.property[index]\r\n\t//\t  .bone[Armature.DEF_cog].position\r\n\t// created and tested via https://regex101.com/#javascript\r\n\r\n\tvar re = /^(([\\w]+\\/)*)([\\w-\\d]+)?(\\.([\\w]+)(\\[([\\w\\d\\[\\]\\_.:\\- ]+)\\])?)?(\\.([\\w.]+)(\\[([\\w\\d\\[\\]\\_. ]+)\\])?)$/;\r\n\tvar matches = re.exec(trackName);\r\n\r\n\tif( ! matches ) {\r\n\t\tthrow new Error( \"cannot parse trackName at all: \" + trackName );\r\n\t}\r\n\r\n    if (matches.index === re.lastIndex) {\r\n        re.lastIndex++;\r\n    }\r\n\r\n\tvar results = {\r\n\t\t// directoryName: matches[1], // (tschw) currently unused\r\n\t\tnodeName: matches[3], \t// allowed to be null, specified root node.\r\n\t\tobjectName: matches[5],\r\n\t\tobjectIndex: matches[7],\r\n\t\tpropertyName: matches[9],\r\n\t\tpropertyIndex: matches[11]\t// allowed to be null, specifies that the whole property is set.\r\n\t};\r\n\r\n\tif( results.propertyName === null || results.propertyName.length === 0 ) {\r\n\t\tthrow new Error( \"can not parse propertyName from trackName: \" + trackName );\r\n\t}\r\n\r\n\treturn results;\r\n\r\n};\r\n\r\nTHREE.PropertyBinding.findNode = function( root, nodeName ) {\r\n\r\n\tif( ! nodeName || nodeName === \"\" || nodeName === \"root\" || nodeName === \".\" || nodeName === -1 || nodeName === root.name || nodeName === root.uuid ) {\r\n\r\n\t\treturn root;\r\n\r\n\t}\r\n\r\n\t// search into skeleton bones.\r\n\tif( root.skeleton ) {\r\n\r\n\t\tvar searchSkeleton = function( skeleton ) {\r\n\r\n\t\t\tfor( var i = 0; i < skeleton.bones.length; i ++ ) {\r\n\r\n\t\t\t\tvar bone = skeleton.bones[i];\r\n\r\n\t\t\t\tif( bone.name === nodeName ) {\r\n\r\n\t\t\t\t\treturn bone;\r\n\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\treturn null;\r\n\r\n\t\t};\r\n\r\n\t\tvar bone = searchSkeleton( root.skeleton );\r\n\r\n\t\tif( bone ) {\r\n\r\n\t\t\treturn bone;\r\n\r\n\t\t}\r\n\t}\r\n\r\n\t// search into node subtree.\r\n\tif( root.children ) {\r\n\r\n\t\tvar searchNodeSubtree = function( children ) {\r\n\r\n\t\t\tfor( var i = 0; i < children.length; i ++ ) {\r\n\r\n\t\t\t\tvar childNode = children[i];\r\n\r\n\t\t\t\tif( childNode.name === nodeName || childNode.uuid === nodeName ) {\r\n\r\n\t\t\t\t\treturn childNode;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tvar result = searchNodeSubtree( childNode.children );\r\n\r\n\t\t\t\tif( result ) return result;\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn null;\r\n\r\n\t\t};\r\n\r\n\t\tvar subTreeNode = searchNodeSubtree( root.children );\r\n\r\n\t\tif( subTreeNode ) {\r\n\r\n\t\t\treturn subTreeNode;\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\treturn null;\r\n\r\n}\r\n\r\n// File:src/animation/PropertyMixer.js\r\n\r\n/**\r\n *\r\n * Buffered scene graph property that allows weighted accumulation.\r\n *\r\n *\r\n * @author Ben Houston / http://clara.io/\r\n * @author David Sarno / http://lighthaus.us/\r\n * @author tschw\r\n */\r\n\r\nTHREE.PropertyMixer = function ( binding, typeName, valueSize ) {\r\n\r\n\tthis.binding = binding;\r\n\tthis.valueSize = valueSize;\r\n\r\n\tvar bufferType = Float64Array,\r\n\t\tmixFunction;\r\n\r\n\tswitch ( typeName ) {\r\n\r\n\t\tcase 'quaternion':\t\t\tmixFunction = this._slerp;\t\tbreak;\r\n\r\n\t\tcase 'string':\r\n\t\tcase 'bool':\r\n\r\n\t\t\tbufferType = Array,\t\tmixFunction = this._select;\t\tbreak;\r\n\r\n\t\tdefault:\t\t\t\t\tmixFunction = this._lerp;\r\n\r\n\t}\r\n\r\n\tthis.buffer = new bufferType( valueSize * 4 );\r\n\t// layout: [ incoming | accu0 | accu1 | orig ]\r\n\t//\r\n\t// interpolators can use .buffer as their .result\r\n\t// the data then goes to 'incoming'\r\n\t//\r\n\t// 'accu0' and 'accu1' are used frame-interleaved for\r\n\t// the cumulative result and are compared to detect\r\n\t// changes\r\n\t//\r\n\t// 'orig' stores the original state of the property\r\n\r\n\tthis._mixBufferRegion = mixFunction;\r\n\r\n\tthis.cumulativeWeight = 0;\r\n\r\n\tthis.useCount = 0;\r\n\tthis.referenceCount = 0;\r\n\r\n};\r\n\r\nTHREE.PropertyMixer.prototype = {\r\n\r\n\tconstructor: THREE.PropertyMixer,\r\n\r\n\t// accumulate data in the 'incoming' region into 'accu<i>'\r\n\taccumulate: function( accuIndex, weight ) {\r\n\r\n\t\t// note: happily accumulating nothing when weight = 0, the caller knows\r\n\t\t// the weight and shouldn't have made the call in the first place\r\n\r\n\t\tvar buffer = this.buffer,\r\n\t\t\tstride = this.valueSize,\r\n\t\t\toffset = accuIndex * stride + stride,\r\n\r\n\t\t\tcurrentWeight = this.cumulativeWeight;\r\n\r\n\t\tif ( currentWeight === 0 ) {\r\n\r\n\t\t\t// accuN := incoming * weight\r\n\r\n\t\t\tfor ( var i = 0; i !== stride; ++ i ) {\r\n\r\n\t\t\t\tbuffer[ offset + i ] = buffer[ i ];\r\n\r\n\t\t\t}\r\n\r\n\t\t\tcurrentWeight = weight;\r\n\r\n\t\t} else {\r\n\r\n\t\t\t// accuN := accuN + incoming * weight\r\n\r\n\t\t\tcurrentWeight += weight;\r\n\t\t\tvar mix = weight / currentWeight;\r\n\t\t\tthis._mixBufferRegion( buffer, offset, 0, mix, stride );\r\n\r\n\t\t}\r\n\r\n\t\tthis.cumulativeWeight = currentWeight;\r\n\r\n\t},\r\n\r\n\t// apply the state of 'accu<i>' to the binding when accus differ\r\n\tapply: function( accuIndex ) {\r\n\r\n\t\tvar stride = this.valueSize,\r\n\t\t\tbuffer = this.buffer,\r\n\t\t\toffset = accuIndex * stride + stride,\r\n\r\n\t\t\tweight = this.cumulativeWeight,\r\n\r\n\t\t\tbinding = this.binding;\r\n\r\n\t\tthis.cumulativeWeight = 0;\r\n\r\n\t\tif ( weight < 1 ) {\r\n\r\n\t\t\t// accuN := accuN + original * ( 1 - cumulativeWeight )\r\n\r\n\t\t\tvar originalValueOffset = stride * 3;\r\n\r\n\t\t\tthis._mixBufferRegion(\r\n\t\t\t\t\tbuffer, offset, originalValueOffset, 1 - weight, stride );\r\n\r\n\t\t}\r\n\r\n\t\tfor ( var i = stride, e = stride + stride; i !== e; ++ i ) {\r\n\r\n\t\t\tif ( buffer[ i ] !== buffer[ i + stride ] ) {\r\n\r\n\t\t\t\t// value has changed -> update scene graph\r\n\r\n\t\t\t\tbinding.setValue( buffer, offset );\r\n\t\t\t\tbreak;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t},\r\n\r\n\t// remember the state of the bound property and copy it to both accus\r\n\tsaveOriginalState: function() {\r\n\r\n\t\tvar binding = this.binding;\r\n\r\n\t\tvar buffer = this.buffer,\r\n\t\t\tstride = this.valueSize,\r\n\r\n\t\t\toriginalValueOffset = stride * 3;\r\n\r\n\t\tbinding.getValue( buffer, originalValueOffset );\r\n\r\n\t\t// accu[0..1] := orig -- initially detect changes against the original\r\n\t\tfor ( var i = stride, e = originalValueOffset; i !== e; ++ i ) {\r\n\r\n\t\t\tbuffer[ i ] = buffer[ originalValueOffset + ( i % stride ) ];\r\n\r\n\t\t}\r\n\r\n\t\tthis.cumulativeWeight = 0;\r\n\r\n\t},\r\n\r\n\t// apply the state previously taken via 'saveOriginalState' to the binding\r\n\trestoreOriginalState: function() {\r\n\r\n\t\tvar originalValueOffset = this.valueSize * 3;\r\n\t\tthis.binding.setValue( this.buffer, originalValueOffset );\r\n\r\n\t},\r\n\r\n\r\n\t// mix functions\r\n\r\n\t_select: function( buffer, dstOffset, srcOffset, t, stride ) {\r\n\r\n\t\tif ( t >= 0.5 ) {\r\n\r\n\t\t\tfor ( var i = 0; i !== stride; ++ i ) {\r\n\r\n\t\t\t\tbuffer[ dstOffset + i ] = buffer[ srcOffset + i ];\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t},\r\n\r\n\t_slerp: function( buffer, dstOffset, srcOffset, t, stride ) {\r\n\r\n\t\tTHREE.Quaternion.slerpFlat( buffer, dstOffset,\r\n\t\t\t\tbuffer, dstOffset, buffer, srcOffset, t );\r\n\r\n\t},\r\n\r\n\t_lerp: function( buffer, dstOffset, srcOffset, t, stride ) {\r\n\r\n\t\tvar s = 1 - t;\r\n\r\n\t\tfor ( var i = 0; i !== stride; ++ i ) {\r\n\r\n\t\t\tvar j = dstOffset + i;\r\n\r\n\t\t\tbuffer[ j ] = buffer[ j ] * s + buffer[ srcOffset + i ] * t;\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n};\r\n\r\n// File:src/animation/tracks/BooleanKeyframeTrack.js\r\n\r\n/**\r\n *\r\n * A Track of Boolean keyframe values.\r\n *\r\n *\r\n * @author Ben Houston / http://clara.io/\r\n * @author David Sarno / http://lighthaus.us/\r\n * @author tschw\r\n */\r\n\r\nTHREE.BooleanKeyframeTrack = function ( name, times, values ) {\r\n\r\n\tTHREE.KeyframeTrack.call( this, name, times, values );\r\n\r\n};\r\n\r\nTHREE.BooleanKeyframeTrack.prototype =\r\n\t\tObject.assign( Object.create( THREE.KeyframeTrack.prototype ), {\r\n\r\n\tconstructor: THREE.BooleanKeyframeTrack,\r\n\r\n\tValueTypeName: 'bool',\r\n\tValueBufferType: Array,\r\n\r\n\tDefaultInterpolation: THREE.InterpolateDiscrete,\r\n\r\n\tInterpolantFactoryMethodLinear: undefined,\r\n\tInterpolantFactoryMethodSmooth: undefined\r\n\r\n\t// Note: Actually this track could have a optimized / compressed\r\n\t// representation of a single value and a custom interpolant that\r\n\t// computes \"firstValue ^ isOdd( index )\".\r\n\r\n} );\r\n\r\n// File:src/animation/tracks/ColorKeyframeTrack.js\r\n\r\n/**\r\n *\r\n * A Track of keyframe values that represent color.\r\n *\r\n *\r\n * @author Ben Houston / http://clara.io/\r\n * @author David Sarno / http://lighthaus.us/\r\n * @author tschw\r\n */\r\n\r\nTHREE.ColorKeyframeTrack = function ( name, times, values, interpolation ) {\r\n\r\n\tTHREE.KeyframeTrack.call( this, name, times, values, interpolation );\r\n\r\n};\r\n\r\nTHREE.ColorKeyframeTrack.prototype =\r\n\t\tObject.assign( Object.create( THREE.KeyframeTrack.prototype ), {\r\n\r\n\tconstructor: THREE.ColorKeyframeTrack,\r\n\r\n\tValueTypeName: 'color'\r\n\r\n\t// ValueBufferType is inherited\r\n\r\n\t// DefaultInterpolation is inherited\r\n\r\n\r\n\t// Note: Very basic implementation and nothing special yet.\r\n\t// However, this is the place for color space parameterization.\r\n\r\n} );\r\n\r\n// File:src/animation/tracks/NumberKeyframeTrack.js\r\n\r\n/**\r\n *\r\n * A Track of numeric keyframe values.\r\n *\r\n * @author Ben Houston / http://clara.io/\r\n * @author David Sarno / http://lighthaus.us/\r\n * @author tschw\r\n */\r\n\r\nTHREE.NumberKeyframeTrack = function ( name, times, values, interpolation ) {\r\n\r\n\tTHREE.KeyframeTrack.call( this, name, times, values, interpolation );\r\n\r\n};\r\n\r\nTHREE.NumberKeyframeTrack.prototype =\r\n\t\tObject.assign( Object.create( THREE.KeyframeTrack.prototype ), {\r\n\r\n\tconstructor: THREE.NumberKeyframeTrack,\r\n\r\n\tValueTypeName: 'number',\r\n\r\n\t// ValueBufferType is inherited\r\n\r\n\t// DefaultInterpolation is inherited\r\n\r\n} );\r\n\r\n// File:src/animation/tracks/QuaternionKeyframeTrack.js\r\n\r\n/**\r\n *\r\n * A Track of quaternion keyframe values.\r\n *\r\n * @author Ben Houston / http://clara.io/\r\n * @author David Sarno / http://lighthaus.us/\r\n * @author tschw\r\n */\r\n\r\nTHREE.QuaternionKeyframeTrack = function ( name, times, values, interpolation ) {\r\n\r\n\tTHREE.KeyframeTrack.call( this, name, times, values, interpolation );\r\n\r\n};\r\n\r\nTHREE.QuaternionKeyframeTrack.prototype =\r\n\t\tObject.assign( Object.create( THREE.KeyframeTrack.prototype ), {\r\n\r\n\tconstructor: THREE.QuaternionKeyframeTrack,\r\n\r\n\tValueTypeName: 'quaternion',\r\n\r\n\t// ValueBufferType is inherited\r\n\r\n\tDefaultInterpolation: THREE.InterpolateLinear,\r\n\r\n\tInterpolantFactoryMethodLinear: function( result ) {\r\n\r\n\t\treturn new THREE.QuaternionLinearInterpolant(\r\n\t\t\t\tthis.times, this.values, this.getValueSize(), result );\r\n\r\n\t},\r\n\r\n\tInterpolantFactoryMethodSmooth: undefined // not yet implemented\r\n\r\n} );\r\n\r\n// File:src/animation/tracks/StringKeyframeTrack.js\r\n\r\n/**\r\n *\r\n * A Track that interpolates Strings\r\n *\r\n *\r\n * @author Ben Houston / http://clara.io/\r\n * @author David Sarno / http://lighthaus.us/\r\n * @author tschw\r\n */\r\n\r\nTHREE.StringKeyframeTrack = function ( name, times, values, interpolation ) {\r\n\r\n\tTHREE.KeyframeTrack.call( this, name, times, values, interpolation );\r\n\r\n};\r\n\r\nTHREE.StringKeyframeTrack.prototype =\r\n\t\tObject.assign( Object.create( THREE.KeyframeTrack.prototype ), {\r\n\r\n\tconstructor: THREE.StringKeyframeTrack,\r\n\r\n\tValueTypeName: 'string',\r\n\tValueBufferType: Array,\r\n\r\n\tDefaultInterpolation: THREE.InterpolateDiscrete,\r\n\r\n\tInterpolantFactoryMethodLinear: undefined,\r\n\r\n\tInterpolantFactoryMethodSmooth: undefined\r\n\r\n} );\r\n\r\n// File:src/animation/tracks/VectorKeyframeTrack.js\r\n\r\n/**\r\n *\r\n * A Track of vectored keyframe values.\r\n *\r\n *\r\n * @author Ben Houston / http://clara.io/\r\n * @author David Sarno / http://lighthaus.us/\r\n * @author tschw\r\n */\r\n\r\nTHREE.VectorKeyframeTrack = function ( name, times, values, interpolation ) {\r\n\r\n\tTHREE.KeyframeTrack.call( this, name, times, values, interpolation );\r\n\r\n};\r\n\r\nTHREE.VectorKeyframeTrack.prototype =\r\n\t\tObject.assign( Object.create( THREE.KeyframeTrack.prototype ), {\r\n\r\n\tconstructor: THREE.VectorKeyframeTrack,\r\n\r\n\tValueTypeName: 'vector'\r\n\r\n\t// ValueBufferType is inherited\r\n\r\n\t// DefaultInterpolation is inherited\r\n\r\n} );\r\n\r\n// File:src/audio/Audio.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author Reece Aaron Lecrivain / http://reecenotes.com/\r\n */\r\n\r\nTHREE.Audio = function ( listener ) {\r\n\r\n\tTHREE.Object3D.call( this );\r\n\r\n\tthis.type = 'Audio';\r\n\r\n\tthis.context = listener.context;\r\n\tthis.source = this.context.createBufferSource();\r\n\tthis.source.onended = this.onEnded.bind( this );\r\n\r\n\tthis.gain = this.context.createGain();\r\n\tthis.gain.connect( listener.getInput() );\r\n\r\n\tthis.autoplay = false;\r\n\r\n\tthis.startTime = 0;\r\n\tthis.playbackRate = 1;\r\n\tthis.isPlaying = false;\r\n\tthis.hasPlaybackControl = true;\r\n\tthis.sourceType = 'empty';\r\n\r\n\tthis.filter = null;\r\n\r\n};\r\n\r\nTHREE.Audio.prototype = Object.create( THREE.Object3D.prototype );\r\nTHREE.Audio.prototype.constructor = THREE.Audio;\r\n\r\nTHREE.Audio.prototype.getOutput = function () {\r\n\r\n\treturn this.gain;\r\n\r\n};\r\n\r\nTHREE.Audio.prototype.setNodeSource = function ( audioNode ) {\r\n\r\n\tthis.hasPlaybackControl = false;\r\n\tthis.sourceType = 'audioNode';\r\n\tthis.source = audioNode;\r\n\tthis.connect();\r\n\r\n\treturn this;\r\n\r\n};\r\n\r\nTHREE.Audio.prototype.setBuffer = function ( audioBuffer ) {\r\n\r\n\tvar scope = this;\r\n\r\n\tscope.source.buffer = audioBuffer;\r\n\tscope.sourceType = 'buffer';\r\n\tif ( scope.autoplay ) scope.play();\r\n\r\n\treturn this;\r\n\r\n};\r\n\r\nTHREE.Audio.prototype.play = function () {\r\n\r\n\tif ( this.isPlaying === true ) {\r\n\r\n\t\tconsole.warn( 'THREE.Audio: Audio is already playing.' );\r\n\t\treturn;\r\n\r\n\t}\r\n\r\n\tif ( this.hasPlaybackControl === false ) {\r\n\r\n\t\tconsole.warn( 'THREE.Audio: this Audio has no playback control.' );\r\n\t\treturn;\r\n\r\n\t}\r\n\r\n\tvar source = this.context.createBufferSource();\r\n\r\n\tsource.buffer = this.source.buffer;\r\n\tsource.loop = this.source.loop;\r\n\tsource.onended = this.source.onended;\r\n\tsource.start( 0, this.startTime );\r\n\tsource.playbackRate.value = this.playbackRate;\r\n\r\n\tthis.isPlaying = true;\r\n\r\n\tthis.source = source;\r\n\r\n\tthis.connect();\r\n\r\n};\r\n\r\nTHREE.Audio.prototype.pause = function () {\r\n\r\n\tif ( this.hasPlaybackControl === false ) {\r\n\r\n\t\tconsole.warn( 'THREE.Audio: this Audio has no playback control.' );\r\n\t\treturn;\r\n\r\n\t}\r\n\r\n\tthis.source.stop();\r\n\tthis.startTime = this.context.currentTime;\r\n\r\n};\r\n\r\nTHREE.Audio.prototype.stop = function () {\r\n\r\n\tif ( this.hasPlaybackControl === false ) {\r\n\r\n\t\tconsole.warn( 'THREE.Audio: this Audio has no playback control.' );\r\n\t\treturn;\r\n\r\n\t}\r\n\r\n\tthis.source.stop();\r\n\tthis.startTime = 0;\r\n\r\n};\r\n\r\nTHREE.Audio.prototype.connect = function () {\r\n\r\n\tif ( this.filter !== null ) {\r\n\r\n\t\tthis.source.connect( this.filter );\r\n\t\tthis.filter.connect( this.getOutput() );\r\n\r\n\t} else {\r\n\r\n\t\tthis.source.connect( this.getOutput() );\r\n\r\n\t}\r\n\r\n};\r\n\r\nTHREE.Audio.prototype.disconnect = function () {\r\n\r\n\tif ( this.filter !== null ) {\r\n\r\n\t\tthis.source.disconnect( this.filter );\r\n\t\tthis.filter.disconnect( this.getOutput() );\r\n\r\n\t} else {\r\n\r\n\t\tthis.source.disconnect( this.getOutput() );\r\n\r\n\t}\r\n\r\n};\r\n\r\nTHREE.Audio.prototype.getFilter = function () {\r\n\r\n\treturn this.filter;\r\n\r\n};\r\n\r\nTHREE.Audio.prototype.setFilter = function ( value ) {\r\n\r\n\tif ( value === undefined ) value = null;\r\n\r\n\tif ( this.isPlaying === true ) {\r\n\r\n\t\tthis.disconnect();\r\n\t\tthis.filter = value;\r\n\t\tthis.connect();\r\n\r\n\t} else {\r\n\r\n\t\tthis.filter = value;\r\n\r\n\t}\r\n\r\n};\r\n\r\nTHREE.Audio.prototype.setPlaybackRate = function ( value ) {\r\n\r\n\tif ( this.hasPlaybackControl === false ) {\r\n\r\n\t\tconsole.warn( 'THREE.Audio: this Audio has no playback control.' );\r\n\t\treturn;\r\n\r\n\t}\r\n\r\n\tthis.playbackRate = value;\r\n\r\n\tif ( this.isPlaying === true ) {\r\n\r\n\t\tthis.source.playbackRate.value = this.playbackRate;\r\n\r\n\t}\r\n\r\n};\r\n\r\nTHREE.Audio.prototype.getPlaybackRate = function () {\r\n\r\n\treturn this.playbackRate;\r\n\r\n};\r\n\r\nTHREE.Audio.prototype.onEnded = function () {\r\n\r\n\tthis.isPlaying = false;\r\n\r\n};\r\n\r\nTHREE.Audio.prototype.setLoop = function ( value ) {\r\n\r\n\tif ( this.hasPlaybackControl === false ) {\r\n\r\n\t\tconsole.warn( 'THREE.Audio: this Audio has no playback control.' );\r\n\t\treturn;\r\n\r\n\t}\r\n\r\n\tthis.source.loop = value;\r\n\r\n};\r\n\r\nTHREE.Audio.prototype.getLoop = function () {\r\n\r\n\tif ( this.hasPlaybackControl === false ) {\r\n\r\n\t\tconsole.warn( 'THREE.Audio: this Audio has no playback control.' );\r\n\t\treturn false;\r\n\r\n\t}\r\n\r\n\treturn this.source.loop;\r\n\r\n};\r\n\r\n\r\nTHREE.Audio.prototype.setVolume = function ( value ) {\r\n\r\n\tthis.gain.gain.value = value;\r\n\r\n};\r\n\r\nTHREE.Audio.prototype.getVolume = function () {\r\n\r\n\treturn this.gain.gain.value;\r\n\r\n};\r\n\r\n// File:src/audio/AudioAnalyser.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.AudioAnalyser = function ( audio, fftSize ) {\r\n\r\n\tthis.analyser = audio.context.createAnalyser();\r\n\tthis.analyser.fftSize = fftSize !== undefined ? fftSize : 2048;\r\n\r\n\tthis.data = new Uint8Array( this.analyser.frequencyBinCount );\r\n\r\n\taudio.getOutput().connect( this.analyser );\r\n\r\n};\r\n\r\nTHREE.AudioAnalyser.prototype = {\r\n\r\n\tconstructor: THREE.AudioAnalyser,\r\n\r\n\tgetData: function () {\r\n\r\n\t\tthis.analyser.getByteFrequencyData( this.data );\r\n\t\treturn this.data;\r\n\r\n\t}\r\n\r\n};\r\n\r\n// File:src/audio/AudioContext.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nObject.defineProperty( THREE, 'AudioContext', {\r\n\r\n\tget: ( function () {\r\n\r\n\t\tvar context;\r\n\r\n\t\treturn function () {\r\n\r\n\t\t\tif ( context === undefined ) {\r\n\r\n\t\t\t\tcontext = new ( window.AudioContext || window.webkitAudioContext )();\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn context;\r\n\r\n\t\t};\r\n\r\n\t} )()\r\n\r\n} );\r\n\r\n// File:src/audio/PositionalAudio.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.PositionalAudio = function ( listener ) {\r\n\r\n\tTHREE.Audio.call( this, listener );\r\n\r\n\tthis.panner = this.context.createPanner();\r\n\tthis.panner.connect( this.gain );\r\n\r\n};\r\n\r\nTHREE.PositionalAudio.prototype = Object.create( THREE.Audio.prototype );\r\nTHREE.PositionalAudio.prototype.constructor = THREE.PositionalAudio;\r\n\r\nTHREE.PositionalAudio.prototype.getOutput = function () {\r\n\r\n\treturn this.panner;\r\n\r\n};\r\n\r\nTHREE.PositionalAudio.prototype.setRefDistance = function ( value ) {\r\n\r\n\tthis.panner.refDistance = value;\r\n\r\n};\r\n\r\nTHREE.PositionalAudio.prototype.getRefDistance = function () {\r\n\r\n\treturn this.panner.refDistance;\r\n\r\n};\r\n\r\nTHREE.PositionalAudio.prototype.setRolloffFactor = function ( value ) {\r\n\r\n\tthis.panner.rolloffFactor = value;\r\n\r\n};\r\n\r\nTHREE.PositionalAudio.prototype.getRolloffFactor = function () {\r\n\r\n\treturn this.panner.rolloffFactor;\r\n\r\n};\r\n\r\nTHREE.PositionalAudio.prototype.setDistanceModel = function ( value ) {\r\n\r\n\tthis.panner.distanceModel = value;\r\n\r\n};\r\n\r\nTHREE.PositionalAudio.prototype.getDistanceModel = function () {\r\n\r\n\treturn this.panner.distanceModel;\r\n\r\n};\r\n\r\nTHREE.PositionalAudio.prototype.setMaxDistance = function ( value ) {\r\n\r\n\tthis.panner.maxDistance = value;\r\n\r\n};\r\n\r\nTHREE.PositionalAudio.prototype.getMaxDistance = function () {\r\n\r\n\treturn this.panner.maxDistance;\r\n\r\n};\r\n\r\nTHREE.PositionalAudio.prototype.updateMatrixWorld = ( function () {\r\n\r\n\tvar position = new THREE.Vector3();\r\n\r\n\treturn function updateMatrixWorld( force ) {\r\n\r\n\t\tTHREE.Object3D.prototype.updateMatrixWorld.call( this, force );\r\n\r\n\t\tposition.setFromMatrixPosition( this.matrixWorld );\r\n\r\n\t\tthis.panner.setPosition( position.x, position.y, position.z );\r\n\r\n\t};\r\n\r\n} )();\r\n\r\n// File:src/audio/AudioListener.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.AudioListener = function () {\r\n\r\n\tTHREE.Object3D.call( this );\r\n\r\n\tthis.type = 'AudioListener';\r\n\r\n\tthis.context = THREE.AudioContext;\r\n\r\n\tthis.gain = this.context.createGain();\r\n\tthis.gain.connect( this.context.destination );\r\n\r\n\tthis.filter = null;\r\n\r\n};\r\n\r\nTHREE.AudioListener.prototype = Object.create( THREE.Object3D.prototype );\r\nTHREE.AudioListener.prototype.constructor = THREE.AudioListener;\r\n\r\nTHREE.AudioListener.prototype.getInput = function () {\r\n\r\n\treturn this.gain;\r\n\r\n};\r\n\r\nTHREE.AudioListener.prototype.removeFilter = function ( ) {\r\n\r\n\tif ( this.filter !== null ) {\r\n\r\n\t\tthis.gain.disconnect( this.filter );\r\n\t\tthis.filter.disconnect( this.context.destination );\r\n\t\tthis.gain.connect( this.context.destination );\r\n\t\tthis.filter = null;\r\n\r\n\t}\r\n\r\n};\r\n\r\nTHREE.AudioListener.prototype.setFilter = function ( value ) {\r\n\r\n\tif ( this.filter !== null ) {\r\n\r\n\t\tthis.gain.disconnect( this.filter );\r\n\t\tthis.filter.disconnect( this.context.destination );\r\n\r\n\t} else {\r\n\r\n\t\tthis.gain.disconnect( this.context.destination );\r\n\r\n\t}\r\n\r\n\tthis.filter = value;\r\n\tthis.gain.connect( this.filter );\r\n\tthis.filter.connect( this.context.destination );\r\n\r\n};\r\n\r\nTHREE.AudioListener.prototype.getFilter = function () {\r\n\r\n\treturn this.filter;\r\n\r\n};\r\n\r\nTHREE.AudioListener.prototype.setMasterVolume = function ( value ) {\r\n\r\n\tthis.gain.gain.value = value;\r\n\r\n};\r\n\r\nTHREE.AudioListener.prototype.getMasterVolume = function () {\r\n\r\n\treturn this.gain.gain.value;\r\n\r\n};\r\n\r\n\r\nTHREE.AudioListener.prototype.updateMatrixWorld = ( function () {\r\n\r\n\tvar position = new THREE.Vector3();\r\n\tvar quaternion = new THREE.Quaternion();\r\n\tvar scale = new THREE.Vector3();\r\n\r\n\tvar orientation = new THREE.Vector3();\r\n\r\n\treturn function updateMatrixWorld( force ) {\r\n\r\n\t\tTHREE.Object3D.prototype.updateMatrixWorld.call( this, force );\r\n\r\n\t\tvar listener = this.context.listener;\r\n\t\tvar up = this.up;\r\n\r\n\t\tthis.matrixWorld.decompose( position, quaternion, scale );\r\n\r\n\t\torientation.set( 0, 0, - 1 ).applyQuaternion( quaternion );\r\n\r\n\t\tlistener.setPosition( position.x, position.y, position.z );\r\n\t\tlistener.setOrientation( orientation.x, orientation.y, orientation.z, up.x, up.y, up.z );\r\n\r\n\t};\r\n\r\n} )();\r\n\r\n// File:src/cameras/Camera.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author mikael emtinger / http://gomo.se/\r\n * @author WestLangley / http://github.com/WestLangley\r\n*/\r\n\r\nTHREE.Camera = function () {\r\n\r\n\tTHREE.Object3D.call( this );\r\n\r\n\tthis.type = 'Camera';\r\n\r\n\tthis.matrixWorldInverse = new THREE.Matrix4();\r\n\tthis.projectionMatrix = new THREE.Matrix4();\r\n\r\n};\r\n\r\nTHREE.Camera.prototype = Object.create( THREE.Object3D.prototype );\r\nTHREE.Camera.prototype.constructor = THREE.Camera;\r\n\r\nTHREE.Camera.prototype.getWorldDirection = function () {\r\n\r\n\tvar quaternion = new THREE.Quaternion();\r\n\r\n\treturn function ( optionalTarget ) {\r\n\r\n\t\tvar result = optionalTarget || new THREE.Vector3();\r\n\r\n\t\tthis.getWorldQuaternion( quaternion );\r\n\r\n\t\treturn result.set( 0, 0, - 1 ).applyQuaternion( quaternion );\r\n\r\n\t};\r\n\r\n}();\r\n\r\nTHREE.Camera.prototype.lookAt = function () {\r\n\r\n\t// This routine does not support cameras with rotated and/or translated parent(s)\r\n\r\n\tvar m1 = new THREE.Matrix4();\r\n\r\n\treturn function ( vector ) {\r\n\r\n\t\tm1.lookAt( this.position, vector, this.up );\r\n\r\n\t\tthis.quaternion.setFromRotationMatrix( m1 );\r\n\r\n\t};\r\n\r\n}();\r\n\r\nTHREE.Camera.prototype.clone = function () {\r\n\r\n\treturn new this.constructor().copy( this );\r\n\r\n};\r\n\r\nTHREE.Camera.prototype.copy = function ( source ) {\r\n\r\n\tTHREE.Object3D.prototype.copy.call( this, source );\r\n\r\n\tthis.matrixWorldInverse.copy( source.matrixWorldInverse );\r\n\tthis.projectionMatrix.copy( source.projectionMatrix );\r\n\r\n\treturn this;\r\n\r\n};\r\n\r\n// File:src/cameras/CubeCamera.js\r\n\r\n/**\r\n * Camera for rendering cube maps\r\n *\t- renders scene into axis-aligned cube\r\n *\r\n * @author alteredq / http://alteredqualia.com/\r\n */\r\n\r\nTHREE.CubeCamera = function ( near, far, cubeResolution ) {\r\n\r\n\tTHREE.Object3D.call( this );\r\n\r\n\tthis.type = 'CubeCamera';\r\n\r\n\tvar fov = 90, aspect = 1;\r\n\r\n\tvar cameraPX = new THREE.PerspectiveCamera( fov, aspect, near, far );\r\n\tcameraPX.up.set( 0, - 1, 0 );\r\n\tcameraPX.lookAt( new THREE.Vector3( 1, 0, 0 ) );\r\n\tthis.add( cameraPX );\r\n\r\n\tvar cameraNX = new THREE.PerspectiveCamera( fov, aspect, near, far );\r\n\tcameraNX.up.set( 0, - 1, 0 );\r\n\tcameraNX.lookAt( new THREE.Vector3( - 1, 0, 0 ) );\r\n\tthis.add( cameraNX );\r\n\r\n\tvar cameraPY = new THREE.PerspectiveCamera( fov, aspect, near, far );\r\n\tcameraPY.up.set( 0, 0, 1 );\r\n\tcameraPY.lookAt( new THREE.Vector3( 0, 1, 0 ) );\r\n\tthis.add( cameraPY );\r\n\r\n\tvar cameraNY = new THREE.PerspectiveCamera( fov, aspect, near, far );\r\n\tcameraNY.up.set( 0, 0, - 1 );\r\n\tcameraNY.lookAt( new THREE.Vector3( 0, - 1, 0 ) );\r\n\tthis.add( cameraNY );\r\n\r\n\tvar cameraPZ = new THREE.PerspectiveCamera( fov, aspect, near, far );\r\n\tcameraPZ.up.set( 0, - 1, 0 );\r\n\tcameraPZ.lookAt( new THREE.Vector3( 0, 0, 1 ) );\r\n\tthis.add( cameraPZ );\r\n\r\n\tvar cameraNZ = new THREE.PerspectiveCamera( fov, aspect, near, far );\r\n\tcameraNZ.up.set( 0, - 1, 0 );\r\n\tcameraNZ.lookAt( new THREE.Vector3( 0, 0, - 1 ) );\r\n\tthis.add( cameraNZ );\r\n\r\n\tvar options = { format: THREE.RGBFormat, magFilter: THREE.LinearFilter, minFilter: THREE.LinearFilter };\r\n\r\n\tthis.renderTarget = new THREE.WebGLRenderTargetCube( cubeResolution, cubeResolution, options );\r\n\r\n\tthis.updateCubeMap = function ( renderer, scene ) {\r\n\r\n\t\tif ( this.parent === null ) this.updateMatrixWorld();\r\n\r\n\t\tvar renderTarget = this.renderTarget;\r\n\t\tvar generateMipmaps = renderTarget.texture.generateMipmaps;\r\n\r\n\t\trenderTarget.texture.generateMipmaps = false;\r\n\r\n\t\trenderTarget.activeCubeFace = 0;\r\n\t\trenderer.render( scene, cameraPX, renderTarget );\r\n\r\n\t\trenderTarget.activeCubeFace = 1;\r\n\t\trenderer.render( scene, cameraNX, renderTarget );\r\n\r\n\t\trenderTarget.activeCubeFace = 2;\r\n\t\trenderer.render( scene, cameraPY, renderTarget );\r\n\r\n\t\trenderTarget.activeCubeFace = 3;\r\n\t\trenderer.render( scene, cameraNY, renderTarget );\r\n\r\n\t\trenderTarget.activeCubeFace = 4;\r\n\t\trenderer.render( scene, cameraPZ, renderTarget );\r\n\r\n\t\trenderTarget.texture.generateMipmaps = generateMipmaps;\r\n\r\n\t\trenderTarget.activeCubeFace = 5;\r\n\t\trenderer.render( scene, cameraNZ, renderTarget );\r\n\r\n\t\trenderer.setRenderTarget( null );\r\n\r\n\t};\r\n\r\n};\r\n\r\nTHREE.CubeCamera.prototype = Object.create( THREE.Object3D.prototype );\r\nTHREE.CubeCamera.prototype.constructor = THREE.CubeCamera;\r\n\r\n// File:src/cameras/OrthographicCamera.js\r\n\r\n/**\r\n * @author alteredq / http://alteredqualia.com/\r\n */\r\n\r\nTHREE.OrthographicCamera = function ( left, right, top, bottom, near, far ) {\r\n\r\n\tTHREE.Camera.call( this );\r\n\r\n\tthis.type = 'OrthographicCamera';\r\n\r\n\tthis.zoom = 1;\r\n\r\n\tthis.left = left;\r\n\tthis.right = right;\r\n\tthis.top = top;\r\n\tthis.bottom = bottom;\r\n\r\n\tthis.near = ( near !== undefined ) ? near : 0.1;\r\n\tthis.far = ( far !== undefined ) ? far : 2000;\r\n\r\n\tthis.updateProjectionMatrix();\r\n\r\n};\r\n\r\nTHREE.OrthographicCamera.prototype = Object.create( THREE.Camera.prototype );\r\nTHREE.OrthographicCamera.prototype.constructor = THREE.OrthographicCamera;\r\n\r\nTHREE.OrthographicCamera.prototype.updateProjectionMatrix = function () {\r\n\r\n\tvar dx = ( this.right - this.left ) / ( 2 * this.zoom );\r\n\tvar dy = ( this.top - this.bottom ) / ( 2 * this.zoom );\r\n\tvar cx = ( this.right + this.left ) / 2;\r\n\tvar cy = ( this.top + this.bottom ) / 2;\r\n\r\n\tthis.projectionMatrix.makeOrthographic( cx - dx, cx + dx, cy + dy, cy - dy, this.near, this.far );\r\n\r\n};\r\n\r\nTHREE.OrthographicCamera.prototype.copy = function ( source ) {\r\n\r\n\tTHREE.Camera.prototype.copy.call( this, source );\r\n\r\n\tthis.left = source.left;\r\n\tthis.right = source.right;\r\n\tthis.top = source.top;\r\n\tthis.bottom = source.bottom;\r\n\tthis.near = source.near;\r\n\tthis.far = source.far;\r\n\r\n\tthis.zoom = source.zoom;\r\n\r\n\treturn this;\r\n\r\n};\r\n\r\nTHREE.OrthographicCamera.prototype.toJSON = function ( meta ) {\r\n\r\n\tvar data = THREE.Object3D.prototype.toJSON.call( this, meta );\r\n\r\n\tdata.object.zoom = this.zoom;\r\n\tdata.object.left = this.left;\r\n\tdata.object.right = this.right;\r\n\tdata.object.top = this.top;\r\n\tdata.object.bottom = this.bottom;\r\n\tdata.object.near = this.near;\r\n\tdata.object.far = this.far;\r\n\r\n\treturn data;\r\n\r\n};\r\n\r\n// File:src/cameras/PerspectiveCamera.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author greggman / http://games.greggman.com/\r\n * @author zz85 / http://www.lab4games.net/zz85/blog\r\n * @author tschw\r\n */\r\n\r\nTHREE.PerspectiveCamera = function( fov, aspect, near, far ) {\r\n\r\n\tTHREE.Camera.call( this );\r\n\r\n\tthis.type = 'PerspectiveCamera';\r\n\r\n\tthis.fov = fov !== undefined ? fov : 50;\r\n\tthis.zoom = 1;\r\n\r\n\tthis.near = near !== undefined ? near : 0.1;\r\n\tthis.far = far !== undefined ? far : 2000;\r\n\tthis.focus = 10;\r\n\r\n\tthis.aspect = aspect !== undefined ? aspect : 1;\r\n\tthis.view = null;\r\n\r\n\tthis.filmGauge = 35;\t// width of the film (default in millimeters)\r\n\tthis.filmOffset = 0;\t// horizontal film offset (same unit as gauge)\r\n\r\n\tthis.updateProjectionMatrix();\r\n\r\n};\r\n\r\nTHREE.PerspectiveCamera.prototype = Object.create( THREE.Camera.prototype );\r\nTHREE.PerspectiveCamera.prototype.constructor = THREE.PerspectiveCamera;\r\n\r\n\r\n/**\r\n * Sets the FOV by focal length (DEPRECATED).\r\n *\r\n * Optionally also sets .filmGauge, otherwise uses it. See .setFocalLength.\r\n */\r\nTHREE.PerspectiveCamera.prototype.setLens = function( focalLength, filmGauge ) {\r\n\r\n\tconsole.warn( \"THREE.PerspectiveCamera.setLens is deprecated. \" +\r\n\t\t\t\"Use .setFocalLength and .filmGauge for a photographic setup.\" );\r\n\r\n\tif ( filmGauge !== undefined ) this.filmGauge = filmGauge;\r\n\tthis.setFocalLength( focalLength );\r\n\r\n};\r\n\r\n/**\r\n * Sets the FOV by focal length in respect to the current .filmGauge.\r\n *\r\n * The default film gauge is 35, so that the focal length can be specified for\r\n * a 35mm (full frame) camera.\r\n *\r\n * Values for focal length and film gauge must have the same unit.\r\n */\r\nTHREE.PerspectiveCamera.prototype.setFocalLength = function( focalLength ) {\r\n\r\n\t// see http://www.bobatkins.com/photography/technical/field_of_view.html\r\n\tvar vExtentSlope = 0.5 * this.getFilmHeight() / focalLength;\r\n\r\n\tthis.fov = THREE.Math.RAD2DEG * 2 * Math.atan( vExtentSlope );\r\n\tthis.updateProjectionMatrix();\r\n\r\n};\r\n\r\n\r\n/**\r\n * Calculates the focal length from the current .fov and .filmGauge.\r\n */\r\nTHREE.PerspectiveCamera.prototype.getFocalLength = function() {\r\n\r\n\tvar vExtentSlope = Math.tan( THREE.Math.DEG2RAD * 0.5 * this.fov );\r\n\r\n\treturn 0.5 * this.getFilmHeight() / vExtentSlope;\r\n\r\n};\r\n\r\nTHREE.PerspectiveCamera.prototype.getEffectiveFOV = function() {\r\n\r\n\treturn THREE.Math.RAD2DEG * 2 * Math.atan(\r\n\t\t\tMath.tan( THREE.Math.DEG2RAD * 0.5 * this.fov ) / this.zoom );\r\n\r\n};\r\n\r\nTHREE.PerspectiveCamera.prototype.getFilmWidth = function() {\r\n\r\n\t// film not completely covered in portrait format (aspect < 1)\r\n\treturn this.filmGauge * Math.min( this.aspect, 1 );\r\n\r\n};\r\n\r\nTHREE.PerspectiveCamera.prototype.getFilmHeight = function() {\r\n\r\n\t// film not completely covered in landscape format (aspect > 1)\r\n\treturn this.filmGauge / Math.max( this.aspect, 1 );\r\n\r\n};\r\n\r\n\r\n\r\n/**\r\n * Sets an offset in a larger frustum. This is useful for multi-window or\r\n * multi-monitor/multi-machine setups.\r\n *\r\n * For example, if you have 3x2 monitors and each monitor is 1920x1080 and\r\n * the monitors are in grid like this\r\n *\r\n *   +---+---+---+\r\n *   | A | B | C |\r\n *   +---+---+---+\r\n *   | D | E | F |\r\n *   +---+---+---+\r\n *\r\n * then for each monitor you would call it like this\r\n *\r\n *   var w = 1920;\r\n *   var h = 1080;\r\n *   var fullWidth = w * 3;\r\n *   var fullHeight = h * 2;\r\n *\r\n *   --A--\r\n *   camera.setOffset( fullWidth, fullHeight, w * 0, h * 0, w, h );\r\n *   --B--\r\n *   camera.setOffset( fullWidth, fullHeight, w * 1, h * 0, w, h );\r\n *   --C--\r\n *   camera.setOffset( fullWidth, fullHeight, w * 2, h * 0, w, h );\r\n *   --D--\r\n *   camera.setOffset( fullWidth, fullHeight, w * 0, h * 1, w, h );\r\n *   --E--\r\n *   camera.setOffset( fullWidth, fullHeight, w * 1, h * 1, w, h );\r\n *   --F--\r\n *   camera.setOffset( fullWidth, fullHeight, w * 2, h * 1, w, h );\r\n *\r\n *   Note there is no reason monitors have to be the same size or in a grid.\r\n */\r\nTHREE.PerspectiveCamera.prototype.setViewOffset = function( fullWidth, fullHeight, x, y, width, height ) {\r\n\r\n\tthis.aspect = fullWidth / fullHeight;\r\n\r\n\tthis.view = {\r\n\t\tfullWidth: fullWidth,\r\n\t\tfullHeight: fullHeight,\r\n\t\toffsetX: x,\r\n\t\toffsetY: y,\r\n\t\twidth: width,\r\n\t\theight: height\r\n\t};\r\n\r\n\tthis.updateProjectionMatrix();\r\n\r\n};\r\n\r\nTHREE.PerspectiveCamera.prototype.updateProjectionMatrix = function() {\r\n\r\n\tvar near = this.near,\r\n\t\ttop = near * Math.tan(\r\n\t\t\t\tTHREE.Math.DEG2RAD * 0.5 * this.fov ) / this.zoom,\r\n\t\theight = 2 * top,\r\n\t\twidth = this.aspect * height,\r\n\t\tleft = - 0.5 * width,\r\n\t\tview = this.view;\r\n\r\n\tif ( view !== null ) {\r\n\r\n\t\tvar fullWidth = view.fullWidth,\r\n\t\t\tfullHeight = view.fullHeight;\r\n\r\n\t\tleft += view.offsetX * width / fullWidth;\r\n\t\ttop -= view.offsetY * height / fullHeight;\r\n\t\twidth *= view.width / fullWidth;\r\n\t\theight *= view.height / fullHeight;\r\n\r\n\t}\r\n\r\n\tvar skew = this.filmOffset;\r\n\tif ( skew !== 0 ) left += near * skew / this.getFilmWidth();\r\n\r\n\tthis.projectionMatrix.makeFrustum(\r\n\t\t\tleft, left + width, top - height, top, near, this.far );\r\n\r\n};\r\n\r\nTHREE.PerspectiveCamera.prototype.copy = function( source ) {\r\n\r\n\tTHREE.Camera.prototype.copy.call( this, source );\r\n\r\n\tthis.fov = source.fov;\r\n\tthis.zoom = source.zoom;\r\n\r\n\tthis.near = source.near;\r\n\tthis.far = source.far;\r\n\tthis.focus = source.focus;\r\n\r\n\tthis.aspect = source.aspect;\r\n\tthis.view = source.view === null ? null : Object.assign( {}, source.view );\r\n\r\n\tthis.filmGauge = source.filmGauge;\r\n\tthis.filmOffset = source.filmOffset;\r\n\r\n\treturn this;\r\n\r\n};\r\n\r\nTHREE.PerspectiveCamera.prototype.toJSON = function( meta ) {\r\n\r\n\tvar data = THREE.Object3D.prototype.toJSON.call( this, meta );\r\n\r\n\tdata.object.fov = this.fov;\r\n\tdata.object.zoom = this.zoom;\r\n\r\n\tdata.object.near = this.near;\r\n\tdata.object.far = this.far;\r\n\tdata.object.focus = this.focus;\r\n\r\n\tdata.object.aspect = this.aspect;\r\n\r\n\tif ( this.view !== null ) data.object.view = Object.assign( {}, this.view );\r\n\r\n\tdata.object.filmGauge = this.filmGauge;\r\n\tdata.object.filmOffset = this.filmOffset;\r\n\r\n\treturn data;\r\n\r\n};\r\n\r\n// File:src/cameras/StereoCamera.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.StereoCamera = function () {\r\n\r\n\tthis.type = 'StereoCamera';\r\n\r\n\tthis.aspect = 1;\r\n\r\n\tthis.cameraL = new THREE.PerspectiveCamera();\r\n\tthis.cameraL.layers.enable( 1 );\r\n\tthis.cameraL.matrixAutoUpdate = false;\r\n\r\n\tthis.cameraR = new THREE.PerspectiveCamera();\r\n\tthis.cameraR.layers.enable( 2 );\r\n\tthis.cameraR.matrixAutoUpdate = false;\r\n\r\n};\r\n\r\nTHREE.StereoCamera.prototype = {\r\n\r\n\tconstructor: THREE.StereoCamera,\r\n\r\n\tupdate: ( function () {\r\n\r\n\t\tvar focus, fov, aspect, near, far;\r\n\r\n\t\tvar eyeRight = new THREE.Matrix4();\r\n\t\tvar eyeLeft = new THREE.Matrix4();\r\n\r\n\t\treturn function update ( camera ) {\r\n\r\n\t\t\tvar needsUpdate = focus !== camera.focus || fov !== camera.fov ||\r\n\t\t\t\t\t\t\t\t\t\t\t\taspect !== camera.aspect * this.aspect || near !== camera.near ||\r\n\t\t\t\t\t\t\t\t\t\t\t\tfar !== camera.far;\r\n\r\n\t\t\tif ( needsUpdate ) {\r\n\r\n\t\t\t\tfocus = camera.focus;\r\n\t\t\t\tfov = camera.fov;\r\n\t\t\t\taspect = camera.aspect * this.aspect;\r\n\t\t\t\tnear = camera.near;\r\n\t\t\t\tfar = camera.far;\r\n\r\n\t\t\t\t// Off-axis stereoscopic effect based on\r\n\t\t\t\t// http://paulbourke.net/stereographics/stereorender/\r\n\r\n\t\t\t\tvar projectionMatrix = camera.projectionMatrix.clone();\r\n\t\t\t\tvar eyeSep = 0.064 / 2;\r\n\t\t\t\tvar eyeSepOnProjection = eyeSep * near / focus;\r\n\t\t\t\tvar ymax = near * Math.tan( THREE.Math.DEG2RAD * fov * 0.5 );\r\n\t\t\t\tvar xmin, xmax;\r\n\r\n\t\t\t\t// translate xOffset\r\n\r\n\t\t\t\teyeLeft.elements[ 12 ] = - eyeSep;\r\n\t\t\t\teyeRight.elements[ 12 ] = eyeSep;\r\n\r\n\t\t\t\t// for left eye\r\n\r\n\t\t\t\txmin = - ymax * aspect + eyeSepOnProjection;\r\n\t\t\t\txmax = ymax * aspect + eyeSepOnProjection;\r\n\r\n\t\t\t\tprojectionMatrix.elements[ 0 ] = 2 * near / ( xmax - xmin );\r\n\t\t\t\tprojectionMatrix.elements[ 8 ] = ( xmax + xmin ) / ( xmax - xmin );\r\n\r\n\t\t\t\tthis.cameraL.projectionMatrix.copy( projectionMatrix );\r\n\r\n\t\t\t\t// for right eye\r\n\r\n\t\t\t\txmin = - ymax * aspect - eyeSepOnProjection;\r\n\t\t\t\txmax = ymax * aspect - eyeSepOnProjection;\r\n\r\n\t\t\t\tprojectionMatrix.elements[ 0 ] = 2 * near / ( xmax - xmin );\r\n\t\t\t\tprojectionMatrix.elements[ 8 ] = ( xmax + xmin ) / ( xmax - xmin );\r\n\r\n\t\t\t\tthis.cameraR.projectionMatrix.copy( projectionMatrix );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tthis.cameraL.matrixWorld.copy( camera.matrixWorld ).multiply( eyeLeft );\r\n\t\t\tthis.cameraR.matrixWorld.copy( camera.matrixWorld ).multiply( eyeRight );\r\n\r\n\t\t};\r\n\r\n\t} )()\r\n\r\n};\r\n\r\n// File:src/lights/Light.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author alteredq / http://alteredqualia.com/\r\n */\r\n\r\nTHREE.Light = function ( color, intensity ) {\r\n\r\n\tTHREE.Object3D.call( this );\r\n\r\n\tthis.type = 'Light';\r\n\r\n\tthis.color = new THREE.Color( color );\r\n\tthis.intensity = intensity !== undefined ? intensity : 1;\r\n\r\n\tthis.receiveShadow = undefined;\r\n\r\n};\r\n\r\nTHREE.Light.prototype = Object.create( THREE.Object3D.prototype );\r\nTHREE.Light.prototype.constructor = THREE.Light;\r\n\r\nTHREE.Light.prototype.copy = function ( source ) {\r\n\r\n\tTHREE.Object3D.prototype.copy.call( this, source );\r\n\r\n\tthis.color.copy( source.color );\r\n\tthis.intensity = source.intensity;\r\n\r\n\treturn this;\r\n\r\n};\r\n\r\nTHREE.Light.prototype.toJSON = function ( meta ) {\r\n\r\n\tvar data = THREE.Object3D.prototype.toJSON.call( this, meta );\r\n\r\n\tdata.object.color = this.color.getHex();\r\n\tdata.object.intensity = this.intensity;\r\n\r\n\tif ( this.groundColor !== undefined ) data.object.groundColor = this.groundColor.getHex();\r\n\r\n\tif ( this.distance !== undefined ) data.object.distance = this.distance;\r\n\tif ( this.angle !== undefined ) data.object.angle = this.angle;\r\n\tif ( this.decay !== undefined ) data.object.decay = this.decay;\r\n\tif ( this.penumbra !== undefined ) data.object.penumbra = this.penumbra;\r\n\r\n\treturn data;\r\n\r\n};\r\n\r\n// File:src/lights/LightShadow.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.LightShadow = function ( camera ) {\r\n\r\n\tthis.camera = camera;\r\n\r\n\tthis.bias = 0;\r\n\tthis.radius = 1;\r\n\r\n\tthis.mapSize = new THREE.Vector2( 512, 512 );\r\n\r\n\tthis.map = null;\r\n\tthis.matrix = new THREE.Matrix4();\r\n\r\n};\r\n\r\nTHREE.LightShadow.prototype = {\r\n\r\n\tconstructor: THREE.LightShadow,\r\n\r\n\tcopy: function ( source ) {\r\n\r\n\t\tthis.camera = source.camera.clone();\r\n\r\n\t\tthis.bias = source.bias;\r\n\t\tthis.radius = source.radius;\r\n\r\n\t\tthis.mapSize.copy( source.mapSize );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tclone: function () {\r\n\r\n\t\treturn new this.constructor().copy( this );\r\n\r\n\t}\r\n\r\n};\r\n\r\n// File:src/lights/AmbientLight.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.AmbientLight = function ( color, intensity ) {\r\n\r\n\tTHREE.Light.call( this, color, intensity );\r\n\r\n\tthis.type = 'AmbientLight';\r\n\r\n\tthis.castShadow = undefined;\r\n\r\n};\r\n\r\nTHREE.AmbientLight.prototype = Object.create( THREE.Light.prototype );\r\nTHREE.AmbientLight.prototype.constructor = THREE.AmbientLight;\r\n\r\n// File:src/lights/DirectionalLight.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author alteredq / http://alteredqualia.com/\r\n */\r\n\r\nTHREE.DirectionalLight = function ( color, intensity ) {\r\n\r\n\tTHREE.Light.call( this, color, intensity );\r\n\r\n\tthis.type = 'DirectionalLight';\r\n\r\n\tthis.position.set( 0, 1, 0 );\r\n\tthis.updateMatrix();\r\n\r\n\tthis.target = new THREE.Object3D();\r\n\r\n\tthis.shadow = new THREE.DirectionalLightShadow();\r\n\r\n};\r\n\r\nTHREE.DirectionalLight.prototype = Object.create( THREE.Light.prototype );\r\nTHREE.DirectionalLight.prototype.constructor = THREE.DirectionalLight;\r\n\r\nTHREE.DirectionalLight.prototype.copy = function ( source ) {\r\n\r\n\tTHREE.Light.prototype.copy.call( this, source );\r\n\r\n\tthis.target = source.target.clone();\r\n\r\n\tthis.shadow = source.shadow.clone();\r\n\r\n\treturn this;\r\n\r\n};\r\n\r\n// File:src/lights/DirectionalLightShadow.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.DirectionalLightShadow = function ( light ) {\r\n\r\n\tTHREE.LightShadow.call( this, new THREE.OrthographicCamera( - 5, 5, 5, - 5, 0.5, 500 ) );\r\n\r\n};\r\n\r\nTHREE.DirectionalLightShadow.prototype = Object.create( THREE.LightShadow.prototype );\r\nTHREE.DirectionalLightShadow.prototype.constructor = THREE.DirectionalLightShadow;\r\n\r\n// File:src/lights/HemisphereLight.js\r\n\r\n/**\r\n * @author alteredq / http://alteredqualia.com/\r\n */\r\n\r\nTHREE.HemisphereLight = function ( skyColor, groundColor, intensity ) {\r\n\r\n\tTHREE.Light.call( this, skyColor, intensity );\r\n\r\n\tthis.type = 'HemisphereLight';\r\n\r\n\tthis.castShadow = undefined;\r\n\r\n\tthis.position.set( 0, 1, 0 );\r\n\tthis.updateMatrix();\r\n\r\n\tthis.groundColor = new THREE.Color( groundColor );\r\n\r\n};\r\n\r\nTHREE.HemisphereLight.prototype = Object.create( THREE.Light.prototype );\r\nTHREE.HemisphereLight.prototype.constructor = THREE.HemisphereLight;\r\n\r\nTHREE.HemisphereLight.prototype.copy = function ( source ) {\r\n\r\n\tTHREE.Light.prototype.copy.call( this, source );\r\n\r\n\tthis.groundColor.copy( source.groundColor );\r\n\r\n\treturn this;\r\n\r\n};\r\n\r\n// File:src/lights/PointLight.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\n\r\nTHREE.PointLight = function ( color, intensity, distance, decay ) {\r\n\r\n\tTHREE.Light.call( this, color, intensity );\r\n\r\n\tthis.type = 'PointLight';\r\n\r\n\tthis.distance = ( distance !== undefined ) ? distance : 0;\r\n\tthis.decay = ( decay !== undefined ) ? decay : 1;\t// for physically correct lights, should be 2.\r\n\r\n\tthis.shadow = new THREE.LightShadow( new THREE.PerspectiveCamera( 90, 1, 0.5, 500 ) );\r\n\r\n};\r\n\r\nTHREE.PointLight.prototype = Object.create( THREE.Light.prototype );\r\nTHREE.PointLight.prototype.constructor = THREE.PointLight;\r\n\r\nObject.defineProperty( THREE.PointLight.prototype, \"power\", {\r\n\r\n\tget: function () {\r\n\r\n\t\t// intensity = power per solid angle.\r\n\t\t// ref: equation (15) from http://www.frostbite.com/wp-content/uploads/2014/11/course_notes_moving_frostbite_to_pbr.pdf\r\n\t\treturn this.intensity * 4 * Math.PI;\r\n\r\n\t},\r\n\r\n\tset: function ( power ) {\r\n\r\n\t\t// intensity = power per solid angle.\r\n\t\t// ref: equation (15) from http://www.frostbite.com/wp-content/uploads/2014/11/course_notes_moving_frostbite_to_pbr.pdf\r\n\t\tthis.intensity = power / ( 4 * Math.PI );\r\n\r\n\t}\r\n\r\n} );\r\n\r\nTHREE.PointLight.prototype.copy = function ( source ) {\r\n\r\n\tTHREE.Light.prototype.copy.call( this, source );\r\n\r\n\tthis.distance = source.distance;\r\n\tthis.decay = source.decay;\r\n\r\n\tthis.shadow = source.shadow.clone();\r\n\r\n\treturn this;\r\n\r\n};\r\n\r\n// File:src/lights/SpotLight.js\r\n\r\n/**\r\n * @author alteredq / http://alteredqualia.com/\r\n */\r\n\r\nTHREE.SpotLight = function ( color, intensity, distance, angle, penumbra, decay ) {\r\n\r\n\tTHREE.Light.call( this, color, intensity );\r\n\r\n\tthis.type = 'SpotLight';\r\n\r\n\tthis.position.set( 0, 1, 0 );\r\n\tthis.updateMatrix();\r\n\r\n\tthis.target = new THREE.Object3D();\r\n\r\n\tthis.distance = ( distance !== undefined ) ? distance : 0;\r\n\tthis.angle = ( angle !== undefined ) ? angle : Math.PI / 3;\r\n\tthis.penumbra = ( penumbra !== undefined ) ? penumbra : 0;\r\n\tthis.decay = ( decay !== undefined ) ? decay : 1;\t// for physically correct lights, should be 2.\r\n\r\n\tthis.shadow = new THREE.SpotLightShadow();\r\n\r\n};\r\n\r\nTHREE.SpotLight.prototype = Object.create( THREE.Light.prototype );\r\nTHREE.SpotLight.prototype.constructor = THREE.SpotLight;\r\n\r\nObject.defineProperty( THREE.SpotLight.prototype, \"power\", {\r\n\r\n\tget: function () {\r\n\r\n\t\t// intensity = power per solid angle.\r\n\t\t// ref: equation (17) from http://www.frostbite.com/wp-content/uploads/2014/11/course_notes_moving_frostbite_to_pbr.pdf\r\n\t\treturn this.intensity * Math.PI;\r\n\r\n\t},\r\n\r\n\tset: function ( power ) {\r\n\r\n\t\t// intensity = power per solid angle.\r\n\t\t// ref: equation (17) from http://www.frostbite.com/wp-content/uploads/2014/11/course_notes_moving_frostbite_to_pbr.pdf\r\n\t\tthis.intensity = power / Math.PI;\r\n\r\n\t}\r\n\r\n} );\r\n\r\nTHREE.SpotLight.prototype.copy = function ( source ) {\r\n\r\n\tTHREE.Light.prototype.copy.call( this, source );\r\n\r\n\tthis.distance = source.distance;\r\n\tthis.angle = source.angle;\r\n\tthis.penumbra = source.penumbra;\r\n\tthis.decay = source.decay;\r\n\r\n\tthis.target = source.target.clone();\r\n\r\n\tthis.shadow = source.shadow.clone();\r\n\r\n\treturn this;\r\n\r\n};\r\n\r\n// File:src/lights/SpotLightShadow.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.SpotLightShadow = function () {\r\n\r\n\tTHREE.LightShadow.call( this, new THREE.PerspectiveCamera( 50, 1, 0.5, 500 ) );\r\n\r\n};\r\n\r\nTHREE.SpotLightShadow.prototype = Object.create( THREE.LightShadow.prototype );\r\nTHREE.SpotLightShadow.prototype.constructor = THREE.SpotLightShadow;\r\n\r\nTHREE.SpotLightShadow.prototype.update = function ( light ) {\r\n\r\n\tvar fov = THREE.Math.RAD2DEG * 2 * light.angle;\r\n\tvar aspect = this.mapSize.width / this.mapSize.height;\r\n\tvar far = light.distance || 500;\r\n\r\n\tvar camera = this.camera;\r\n\r\n\tif ( fov !== camera.fov || aspect !== camera.aspect || far !== camera.far ) {\r\n\r\n\t\tcamera.fov = fov;\r\n\t\tcamera.aspect = aspect;\r\n\t\tcamera.far = far;\r\n\t\tcamera.updateProjectionMatrix();\r\n\r\n\t}\r\n\r\n};\r\n\r\n// File:src/loaders/AudioLoader.js\r\n\r\n/**\r\n * @author Reece Aaron Lecrivain / http://reecenotes.com/\r\n */\r\n\r\nTHREE.AudioLoader = function ( manager ) {\r\n\r\n\tthis.manager = ( manager !== undefined ) ? manager : THREE.DefaultLoadingManager;\r\n\r\n};\r\n\r\nTHREE.AudioLoader.prototype = {\r\n\r\n\tconstructor: THREE.AudioLoader,\r\n\r\n\tload: function ( url, onLoad, onProgress, onError ) {\r\n\r\n\t\tvar loader = new THREE.XHRLoader( this.manager );\r\n\t\tloader.setResponseType( 'arraybuffer' );\r\n\t\tloader.load( url, function ( buffer ) {\r\n\r\n\t\t\tvar context = THREE.AudioContext;\r\n\r\n\t\t\tcontext.decodeAudioData( buffer, function ( audioBuffer ) {\r\n\r\n\t\t\t\tonLoad( audioBuffer );\r\n\r\n\t\t\t} );\r\n\r\n\t\t}, onProgress, onError );\r\n\r\n\t}\r\n\r\n};\r\n\r\n// File:src/loaders/Cache.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.Cache = {\r\n\r\n\tenabled: false,\r\n\r\n\tfiles: {},\r\n\r\n\tadd: function ( key, file ) {\r\n\r\n\t\tif ( this.enabled === false ) return;\r\n\r\n\t\t// console.log( 'THREE.Cache', 'Adding key:', key );\r\n\r\n\t\tthis.files[ key ] = file;\r\n\r\n\t},\r\n\r\n\tget: function ( key ) {\r\n\r\n\t\tif ( this.enabled === false ) return;\r\n\r\n\t\t// console.log( 'THREE.Cache', 'Checking key:', key );\r\n\r\n\t\treturn this.files[ key ];\r\n\r\n\t},\r\n\r\n\tremove: function ( key ) {\r\n\r\n\t\tdelete this.files[ key ];\r\n\r\n\t},\r\n\r\n\tclear: function () {\r\n\r\n\t\tthis.files = {};\r\n\r\n\t}\r\n\r\n};\r\n\r\n// File:src/loaders/Loader.js\r\n\r\n/**\r\n * @author alteredq / http://alteredqualia.com/\r\n */\r\n\r\nTHREE.Loader = function () {\r\n\r\n\tthis.onLoadStart = function () {};\r\n\tthis.onLoadProgress = function () {};\r\n\tthis.onLoadComplete = function () {};\r\n\r\n};\r\n\r\nTHREE.Loader.prototype = {\r\n\r\n\tconstructor: THREE.Loader,\r\n\r\n\tcrossOrigin: undefined,\r\n\r\n\textractUrlBase: function ( url ) {\r\n\r\n\t\tvar parts = url.split( '/' );\r\n\r\n\t\tif ( parts.length === 1 ) return './';\r\n\r\n\t\tparts.pop();\r\n\r\n\t\treturn parts.join( '/' ) + '/';\r\n\r\n\t},\r\n\r\n\tinitMaterials: function ( materials, texturePath, crossOrigin ) {\r\n\r\n\t\tvar array = [];\r\n\r\n\t\tfor ( var i = 0; i < materials.length; ++ i ) {\r\n\r\n\t\t\tarray[ i ] = this.createMaterial( materials[ i ], texturePath, crossOrigin );\r\n\r\n\t\t}\r\n\r\n\t\treturn array;\r\n\r\n\t},\r\n\r\n\tcreateMaterial: ( function () {\r\n\r\n\t\tvar color, textureLoader, materialLoader;\r\n\r\n\t\treturn function ( m, texturePath, crossOrigin ) {\r\n\r\n\t\t\tif ( color === undefined ) color = new THREE.Color();\r\n\t\t\tif ( textureLoader === undefined ) textureLoader = new THREE.TextureLoader();\r\n\t\t\tif ( materialLoader === undefined ) materialLoader = new THREE.MaterialLoader();\r\n\r\n\t\t\t// convert from old material format\r\n\r\n\t\t\tvar textures = {};\r\n\r\n\t\t\tfunction loadTexture( path, repeat, offset, wrap, anisotropy ) {\r\n\r\n\t\t\t\tvar fullPath = texturePath + path;\r\n\t\t\t\tvar loader = THREE.Loader.Handlers.get( fullPath );\r\n\r\n\t\t\t\tvar texture;\r\n\r\n\t\t\t\tif ( loader !== null ) {\r\n\r\n\t\t\t\t\ttexture = loader.load( fullPath );\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\ttextureLoader.setCrossOrigin( crossOrigin );\r\n\t\t\t\t\ttexture = textureLoader.load( fullPath );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( repeat !== undefined ) {\r\n\r\n\t\t\t\t\ttexture.repeat.fromArray( repeat );\r\n\r\n\t\t\t\t\tif ( repeat[ 0 ] !== 1 ) texture.wrapS = THREE.RepeatWrapping;\r\n\t\t\t\t\tif ( repeat[ 1 ] !== 1 ) texture.wrapT = THREE.RepeatWrapping;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( offset !== undefined ) {\r\n\r\n\t\t\t\t\ttexture.offset.fromArray( offset );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( wrap !== undefined ) {\r\n\r\n\t\t\t\t\tif ( wrap[ 0 ] === 'repeat' ) texture.wrapS = THREE.RepeatWrapping;\r\n\t\t\t\t\tif ( wrap[ 0 ] === 'mirror' ) texture.wrapS = THREE.MirroredRepeatWrapping;\r\n\r\n\t\t\t\t\tif ( wrap[ 1 ] === 'repeat' ) texture.wrapT = THREE.RepeatWrapping;\r\n\t\t\t\t\tif ( wrap[ 1 ] === 'mirror' ) texture.wrapT = THREE.MirroredRepeatWrapping;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( anisotropy !== undefined ) {\r\n\r\n\t\t\t\t\ttexture.anisotropy = anisotropy;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tvar uuid = THREE.Math.generateUUID();\r\n\r\n\t\t\t\ttextures[ uuid ] = texture;\r\n\r\n\t\t\t\treturn uuid;\r\n\r\n\t\t\t}\r\n\r\n\t\t\t//\r\n\r\n\t\t\tvar json = {\r\n\t\t\t\tuuid: THREE.Math.generateUUID(),\r\n\t\t\t\ttype: 'MeshLambertMaterial'\r\n\t\t\t};\r\n\r\n\t\t\tfor ( var name in m ) {\r\n\r\n\t\t\t\tvar value = m[ name ];\r\n\r\n\t\t\t\tswitch ( name ) {\r\n\t\t\t\t\tcase 'DbgColor':\r\n\t\t\t\t\tcase 'DbgIndex':\r\n\t\t\t\t\tcase 'opticalDensity':\r\n\t\t\t\t\tcase 'illumination':\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'DbgName':\r\n\t\t\t\t\t\tjson.name = value;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'blending':\r\n\t\t\t\t\t\tjson.blending = THREE[ value ];\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'colorAmbient':\r\n\t\t\t\t\tcase 'mapAmbient':\r\n\t\t\t\t\t\tconsole.warn( 'THREE.Loader.createMaterial:', name, 'is no longer supported.' );\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'colorDiffuse':\r\n\t\t\t\t\t\tjson.color = color.fromArray( value ).getHex();\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'colorSpecular':\r\n\t\t\t\t\t\tjson.specular = color.fromArray( value ).getHex();\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'colorEmissive':\r\n\t\t\t\t\t\tjson.emissive = color.fromArray( value ).getHex();\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'specularCoef':\r\n\t\t\t\t\t\tjson.shininess = value;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'shading':\r\n\t\t\t\t\t\tif ( value.toLowerCase() === 'basic' ) json.type = 'MeshBasicMaterial';\r\n\t\t\t\t\t\tif ( value.toLowerCase() === 'phong' ) json.type = 'MeshPhongMaterial';\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'mapDiffuse':\r\n\t\t\t\t\t\tjson.map = loadTexture( value, m.mapDiffuseRepeat, m.mapDiffuseOffset, m.mapDiffuseWrap, m.mapDiffuseAnisotropy );\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'mapDiffuseRepeat':\r\n\t\t\t\t\tcase 'mapDiffuseOffset':\r\n\t\t\t\t\tcase 'mapDiffuseWrap':\r\n\t\t\t\t\tcase 'mapDiffuseAnisotropy':\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'mapLight':\r\n\t\t\t\t\t\tjson.lightMap = loadTexture( value, m.mapLightRepeat, m.mapLightOffset, m.mapLightWrap, m.mapLightAnisotropy );\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'mapLightRepeat':\r\n\t\t\t\t\tcase 'mapLightOffset':\r\n\t\t\t\t\tcase 'mapLightWrap':\r\n\t\t\t\t\tcase 'mapLightAnisotropy':\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'mapAO':\r\n\t\t\t\t\t\tjson.aoMap = loadTexture( value, m.mapAORepeat, m.mapAOOffset, m.mapAOWrap, m.mapAOAnisotropy );\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'mapAORepeat':\r\n\t\t\t\t\tcase 'mapAOOffset':\r\n\t\t\t\t\tcase 'mapAOWrap':\r\n\t\t\t\t\tcase 'mapAOAnisotropy':\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'mapBump':\r\n\t\t\t\t\t\tjson.bumpMap = loadTexture( value, m.mapBumpRepeat, m.mapBumpOffset, m.mapBumpWrap, m.mapBumpAnisotropy );\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'mapBumpScale':\r\n\t\t\t\t\t\tjson.bumpScale = value;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'mapBumpRepeat':\r\n\t\t\t\t\tcase 'mapBumpOffset':\r\n\t\t\t\t\tcase 'mapBumpWrap':\r\n\t\t\t\t\tcase 'mapBumpAnisotropy':\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'mapNormal':\r\n\t\t\t\t\t\tjson.normalMap = loadTexture( value, m.mapNormalRepeat, m.mapNormalOffset, m.mapNormalWrap, m.mapNormalAnisotropy );\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'mapNormalFactor':\r\n\t\t\t\t\t\tjson.normalScale = [ value, value ];\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'mapNormalRepeat':\r\n\t\t\t\t\tcase 'mapNormalOffset':\r\n\t\t\t\t\tcase 'mapNormalWrap':\r\n\t\t\t\t\tcase 'mapNormalAnisotropy':\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'mapSpecular':\r\n\t\t\t\t\t\tjson.specularMap = loadTexture( value, m.mapSpecularRepeat, m.mapSpecularOffset, m.mapSpecularWrap, m.mapSpecularAnisotropy );\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'mapSpecularRepeat':\r\n\t\t\t\t\tcase 'mapSpecularOffset':\r\n\t\t\t\t\tcase 'mapSpecularWrap':\r\n\t\t\t\t\tcase 'mapSpecularAnisotropy':\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'mapAlpha':\r\n\t\t\t\t\t\tjson.alphaMap = loadTexture( value, m.mapAlphaRepeat, m.mapAlphaOffset, m.mapAlphaWrap, m.mapAlphaAnisotropy );\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'mapAlphaRepeat':\r\n\t\t\t\t\tcase 'mapAlphaOffset':\r\n\t\t\t\t\tcase 'mapAlphaWrap':\r\n\t\t\t\t\tcase 'mapAlphaAnisotropy':\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'flipSided':\r\n\t\t\t\t\t\tjson.side = THREE.BackSide;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'doubleSided':\r\n\t\t\t\t\t\tjson.side = THREE.DoubleSide;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'transparency':\r\n\t\t\t\t\t\tconsole.warn( 'THREE.Loader.createMaterial: transparency has been renamed to opacity' );\r\n\t\t\t\t\t\tjson.opacity = value;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'depthTest':\r\n\t\t\t\t\tcase 'depthWrite':\r\n\t\t\t\t\tcase 'colorWrite':\r\n\t\t\t\t\tcase 'opacity':\r\n\t\t\t\t\tcase 'reflectivity':\r\n\t\t\t\t\tcase 'transparent':\r\n\t\t\t\t\tcase 'visible':\r\n\t\t\t\t\tcase 'wireframe':\r\n\t\t\t\t\t\tjson[ name ] = value;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'vertexColors':\r\n\t\t\t\t\t\tif ( value === true ) json.vertexColors = THREE.VertexColors;\r\n\t\t\t\t\t\tif ( value === 'face' ) json.vertexColors = THREE.FaceColors;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tdefault:\r\n\t\t\t\t\t\tconsole.error( 'THREE.Loader.createMaterial: Unsupported', name, value );\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( json.type === 'MeshBasicMaterial' ) delete json.emissive;\r\n\t\t\tif ( json.type !== 'MeshPhongMaterial' ) delete json.specular;\r\n\r\n\t\t\tif ( json.opacity < 1 ) json.transparent = true;\r\n\r\n\t\t\tmaterialLoader.setTextures( textures );\r\n\r\n\t\t\treturn materialLoader.parse( json );\r\n\r\n\t\t};\r\n\r\n\t} )()\r\n\r\n};\r\n\r\nTHREE.Loader.Handlers = {\r\n\r\n\thandlers: [],\r\n\r\n\tadd: function ( regex, loader ) {\r\n\r\n\t\tthis.handlers.push( regex, loader );\r\n\r\n\t},\r\n\r\n\tget: function ( file ) {\r\n\r\n\t\tvar handlers = this.handlers;\r\n\r\n\t\tfor ( var i = 0, l = handlers.length; i < l; i += 2 ) {\r\n\r\n\t\t\tvar regex = handlers[ i ];\r\n\t\t\tvar loader  = handlers[ i + 1 ];\r\n\r\n\t\t\tif ( regex.test( file ) ) {\r\n\r\n\t\t\t\treturn loader;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\treturn null;\r\n\r\n\t}\r\n\r\n};\r\n\r\n// File:src/loaders/XHRLoader.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.XHRLoader = function ( manager ) {\r\n\r\n\tthis.manager = ( manager !== undefined ) ? manager : THREE.DefaultLoadingManager;\r\n\r\n};\r\n\r\nTHREE.XHRLoader.prototype = {\r\n\r\n\tconstructor: THREE.XHRLoader,\r\n\r\n\tload: function ( url, onLoad, onProgress, onError ) {\r\n\r\n\t\tif ( this.path !== undefined ) url = this.path + url;\r\n\r\n\t\tvar scope = this;\r\n\r\n\t\tvar cached = THREE.Cache.get( url );\r\n\r\n\t\tif ( cached !== undefined ) {\r\n\r\n\t\t\tif ( onLoad ) {\r\n\r\n\t\t\t\tsetTimeout( function () {\r\n\r\n\t\t\t\t\tonLoad( cached );\r\n\r\n\t\t\t\t}, 0 );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn cached;\r\n\r\n\t\t}\r\n\r\n\t\tvar request = new XMLHttpRequest();\r\n\t\trequest.overrideMimeType( 'text/plain' );\r\n\t\trequest.open( 'GET', url, true );\r\n\r\n\t\trequest.addEventListener( 'load', function ( event ) {\r\n\r\n\t\t\tvar response = event.target.response;\r\n\r\n\t\t\tTHREE.Cache.add( url, response );\r\n\r\n\t\t\tif ( this.status === 200 ) {\r\n\r\n\t\t\t\tif ( onLoad ) onLoad( response );\r\n\r\n\t\t\t\tscope.manager.itemEnd( url );\r\n\r\n\t\t\t} else if ( this.status === 0 ) {\r\n\r\n\t\t\t\t// Some browsers return HTTP Status 0 when using non-http protocol\r\n\t\t\t\t// e.g. 'file://' or 'data://'. Handle as success.\r\n\r\n\t\t\t\tconsole.warn( 'THREE.XHRLoader: HTTP Status 0 received.' );\r\n\r\n\t\t\t\tif ( onLoad ) onLoad( response );\r\n\r\n\t\t\t\tscope.manager.itemEnd( url );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tif ( onError ) onError( event );\r\n\r\n\t\t\t\tscope.manager.itemError( url );\r\n\r\n\t\t\t}\r\n\r\n\t\t}, false );\r\n\r\n\t\tif ( onProgress !== undefined ) {\r\n\r\n\t\t\trequest.addEventListener( 'progress', function ( event ) {\r\n\r\n\t\t\t\tonProgress( event );\r\n\r\n\t\t\t}, false );\r\n\r\n\t\t}\r\n\r\n\t\trequest.addEventListener( 'error', function ( event ) {\r\n\r\n\t\t\tif ( onError ) onError( event );\r\n\r\n\t\t\tscope.manager.itemError( url );\r\n\r\n\t\t}, false );\r\n\r\n\t\tif ( this.responseType !== undefined ) request.responseType = this.responseType;\r\n\t\tif ( this.withCredentials !== undefined ) request.withCredentials = this.withCredentials;\r\n\r\n\t\trequest.send( null );\r\n\r\n\t\tscope.manager.itemStart( url );\r\n\r\n\t\treturn request;\r\n\r\n\t},\r\n\r\n\tsetPath: function ( value ) {\r\n\r\n\t\tthis.path = value;\r\n\r\n\t},\r\n\r\n\tsetResponseType: function ( value ) {\r\n\r\n\t\tthis.responseType = value;\r\n\r\n\t},\r\n\r\n\tsetWithCredentials: function ( value ) {\r\n\r\n\t\tthis.withCredentials = value;\r\n\r\n\t}\r\n\r\n};\r\n\r\n// File:src/loaders/FontLoader.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.FontLoader = function ( manager ) {\r\n\r\n\tthis.manager = ( manager !== undefined ) ? manager : THREE.DefaultLoadingManager;\r\n\r\n};\r\n\r\nTHREE.FontLoader.prototype = {\r\n\r\n\tconstructor: THREE.FontLoader,\r\n\r\n\tload: function ( url, onLoad, onProgress, onError ) {\r\n\r\n\t\tvar loader = new THREE.XHRLoader( this.manager );\r\n\t\tloader.load( url, function ( text ) {\r\n\r\n\t\t\tonLoad( new THREE.Font( JSON.parse( text.substring( 65, text.length - 2 ) ) ) );\r\n\r\n\t\t}, onProgress, onError );\r\n\r\n\t}\r\n\r\n};\r\n\r\n// File:src/loaders/ImageLoader.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.ImageLoader = function ( manager ) {\r\n\r\n\tthis.manager = ( manager !== undefined ) ? manager : THREE.DefaultLoadingManager;\r\n\r\n};\r\n\r\nTHREE.ImageLoader.prototype = {\r\n\r\n\tconstructor: THREE.ImageLoader,\r\n\r\n\tload: function ( url, onLoad, onProgress, onError ) {\r\n\r\n\t\tif ( this.path !== undefined ) url = this.path + url;\r\n\r\n\t\tvar scope = this;\r\n\r\n\t\tvar cached = THREE.Cache.get( url );\r\n\r\n\t\tif ( cached !== undefined ) {\r\n\r\n\t\t\tscope.manager.itemStart( url );\r\n\r\n\t\t\tif ( onLoad ) {\r\n\r\n\t\t\t\tsetTimeout( function () {\r\n\r\n\t\t\t\t\tonLoad( cached );\r\n\r\n\t\t\t\t\tscope.manager.itemEnd( url );\r\n\r\n\t\t\t\t}, 0 );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tscope.manager.itemEnd( url );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn cached;\r\n\r\n\t\t}\r\n\r\n\t\tvar image = document.createElement( 'img' );\r\n\r\n\t\timage.addEventListener( 'load', function ( event ) {\r\n\r\n\t\t\tTHREE.Cache.add( url, this );\r\n\r\n\t\t\tif ( onLoad ) onLoad( this );\r\n\r\n\t\t\tscope.manager.itemEnd( url );\r\n\r\n\t\t}, false );\r\n\r\n\t\tif ( onProgress !== undefined ) {\r\n\r\n\t\t\timage.addEventListener( 'progress', function ( event ) {\r\n\r\n\t\t\t\tonProgress( event );\r\n\r\n\t\t\t}, false );\r\n\r\n\t\t}\r\n\r\n\t\timage.addEventListener( 'error', function ( event ) {\r\n\r\n\t\t\tif ( onError ) onError( event );\r\n\r\n\t\t\tscope.manager.itemError( url );\r\n\r\n\t\t}, false );\r\n\r\n\t\tif ( this.crossOrigin !== undefined ) image.crossOrigin = this.crossOrigin;\r\n\r\n\t\tscope.manager.itemStart( url );\r\n\r\n\t\timage.src = url;\r\n\r\n\t\treturn image;\r\n\r\n\t},\r\n\r\n\tsetCrossOrigin: function ( value ) {\r\n\r\n\t\tthis.crossOrigin = value;\r\n\r\n\t},\r\n\r\n\tsetPath: function ( value ) {\r\n\r\n\t\tthis.path = value;\r\n\r\n\t}\r\n\r\n};\r\n\r\n// File:src/loaders/JSONLoader.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author alteredq / http://alteredqualia.com/\r\n */\r\n\r\nTHREE.JSONLoader = function ( manager ) {\r\n\r\n\tif ( typeof manager === 'boolean' ) {\r\n\r\n\t\tconsole.warn( 'THREE.JSONLoader: showStatus parameter has been removed from constructor.' );\r\n\t\tmanager = undefined;\r\n\r\n\t}\r\n\r\n\tthis.manager = ( manager !== undefined ) ? manager : THREE.DefaultLoadingManager;\r\n\r\n\tthis.withCredentials = false;\r\n\r\n};\r\n\r\nTHREE.JSONLoader.prototype = {\r\n\r\n\tconstructor: THREE.JSONLoader,\r\n\r\n\t// Deprecated\r\n\r\n\tget statusDomElement () {\r\n\r\n\t\tif ( this._statusDomElement === undefined ) {\r\n\r\n\t\t\tthis._statusDomElement = document.createElement( 'div' );\r\n\r\n\t\t}\r\n\r\n\t\tconsole.warn( 'THREE.JSONLoader: .statusDomElement has been removed.' );\r\n\t\treturn this._statusDomElement;\r\n\r\n\t},\r\n\r\n\tload: function( url, onLoad, onProgress, onError ) {\r\n\r\n\t\tvar scope = this;\r\n\r\n\t\tvar texturePath = this.texturePath && ( typeof this.texturePath === \"string\" ) ? this.texturePath : THREE.Loader.prototype.extractUrlBase( url );\r\n\r\n\t\tvar loader = new THREE.XHRLoader( this.manager );\r\n\t\tloader.setWithCredentials( this.withCredentials );\r\n\t\tloader.load( url, function ( text ) {\r\n\r\n\t\t\tvar json = JSON.parse( text );\r\n\t\t\tvar metadata = json.metadata;\r\n\r\n\t\t\tif ( metadata !== undefined ) {\r\n\r\n\t\t\t\tvar type = metadata.type;\r\n\r\n\t\t\t\tif ( type !== undefined ) {\r\n\r\n\t\t\t\t\tif ( type.toLowerCase() === 'object' ) {\r\n\r\n\t\t\t\t\t\tconsole.error( 'THREE.JSONLoader: ' + url + ' should be loaded with THREE.ObjectLoader instead.' );\r\n\t\t\t\t\t\treturn;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif ( type.toLowerCase() === 'scene' ) {\r\n\r\n\t\t\t\t\t\tconsole.error( 'THREE.JSONLoader: ' + url + ' should be loaded with THREE.SceneLoader instead.' );\r\n\t\t\t\t\t\treturn;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar object = scope.parse( json, texturePath );\r\n\t\t\tonLoad( object.geometry, object.materials );\r\n\r\n\t\t}, onProgress, onError );\r\n\r\n\t},\r\n\r\n\tsetTexturePath: function ( value ) {\r\n\r\n\t\tthis.texturePath = value;\r\n\r\n\t},\r\n\r\n\tparse: function ( json, texturePath ) {\r\n\r\n\t\tvar geometry = new THREE.Geometry(),\r\n\t\tscale = ( json.scale !== undefined ) ? 1.0 / json.scale : 1.0;\r\n\r\n\t\tparseModel( scale );\r\n\r\n\t\tparseSkin();\r\n\t\tparseMorphing( scale );\r\n\t\tparseAnimations();\r\n\r\n\t\tgeometry.computeFaceNormals();\r\n\t\tgeometry.computeBoundingSphere();\r\n\r\n\t\tfunction parseModel( scale ) {\r\n\r\n\t\t\tfunction isBitSet( value, position ) {\r\n\r\n\t\t\t\treturn value & ( 1 << position );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar i, j, fi,\r\n\r\n\t\t\toffset, zLength,\r\n\r\n\t\tcolorIndex, normalIndex, uvIndex, materialIndex,\r\n\r\n\t\t\ttype,\r\n\t\t\tisQuad,\r\n\t\t\thasMaterial,\r\n\t\t\thasFaceVertexUv,\r\n\t\t\thasFaceNormal, hasFaceVertexNormal,\r\n\t\t\thasFaceColor, hasFaceVertexColor,\r\n\r\n\t\tvertex, face, faceA, faceB, hex, normal,\r\n\r\n\t\t\tuvLayer, uv, u, v,\r\n\r\n\t\t\tfaces = json.faces,\r\n\t\t\tvertices = json.vertices,\r\n\t\t\tnormals = json.normals,\r\n\t\t\tcolors = json.colors,\r\n\r\n\t\t\tnUvLayers = 0;\r\n\r\n\t\t\tif ( json.uvs !== undefined ) {\r\n\r\n\t\t\t\t// disregard empty arrays\r\n\r\n\t\t\t\tfor ( i = 0; i < json.uvs.length; i ++ ) {\r\n\r\n\t\t\t\t\tif ( json.uvs[ i ].length ) nUvLayers ++;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tfor ( i = 0; i < nUvLayers; i ++ ) {\r\n\r\n\t\t\t\t\tgeometry.faceVertexUvs[ i ] = [];\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\toffset = 0;\r\n\t\t\tzLength = vertices.length;\r\n\r\n\t\t\twhile ( offset < zLength ) {\r\n\r\n\t\t\t\tvertex = new THREE.Vector3();\r\n\r\n\t\t\t\tvertex.x = vertices[ offset ++ ] * scale;\r\n\t\t\t\tvertex.y = vertices[ offset ++ ] * scale;\r\n\t\t\t\tvertex.z = vertices[ offset ++ ] * scale;\r\n\r\n\t\t\t\tgeometry.vertices.push( vertex );\r\n\r\n\t\t\t}\r\n\r\n\t\t\toffset = 0;\r\n\t\t\tzLength = faces.length;\r\n\r\n\t\t\twhile ( offset < zLength ) {\r\n\r\n\t\t\t\ttype = faces[ offset ++ ];\r\n\r\n\r\n\t\t\t\tisQuad              = isBitSet( type, 0 );\r\n\t\t\t\thasMaterial         = isBitSet( type, 1 );\r\n\t\t\t\thasFaceVertexUv     = isBitSet( type, 3 );\r\n\t\t\t\thasFaceNormal       = isBitSet( type, 4 );\r\n\t\t\t\thasFaceVertexNormal = isBitSet( type, 5 );\r\n\t\t\t\thasFaceColor\t     = isBitSet( type, 6 );\r\n\t\t\t\thasFaceVertexColor  = isBitSet( type, 7 );\r\n\r\n\t\t\t\t// console.log(\"type\", type, \"bits\", isQuad, hasMaterial, hasFaceVertexUv, hasFaceNormal, hasFaceVertexNormal, hasFaceColor, hasFaceVertexColor);\r\n\r\n\t\t\t\tif ( isQuad ) {\r\n\r\n\t\t\t\t\tfaceA = new THREE.Face3();\r\n\t\t\t\t\tfaceA.a = faces[ offset ];\r\n\t\t\t\t\tfaceA.b = faces[ offset + 1 ];\r\n\t\t\t\t\tfaceA.c = faces[ offset + 3 ];\r\n\r\n\t\t\t\t\tfaceB = new THREE.Face3();\r\n\t\t\t\t\tfaceB.a = faces[ offset + 1 ];\r\n\t\t\t\t\tfaceB.b = faces[ offset + 2 ];\r\n\t\t\t\t\tfaceB.c = faces[ offset + 3 ];\r\n\r\n\t\t\t\t\toffset += 4;\r\n\r\n\t\t\t\t\tif ( hasMaterial ) {\r\n\r\n\t\t\t\t\t\tmaterialIndex = faces[ offset ++ ];\r\n\t\t\t\t\t\tfaceA.materialIndex = materialIndex;\r\n\t\t\t\t\t\tfaceB.materialIndex = materialIndex;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t// to get face <=> uv index correspondence\r\n\r\n\t\t\t\t\tfi = geometry.faces.length;\r\n\r\n\t\t\t\t\tif ( hasFaceVertexUv ) {\r\n\r\n\t\t\t\t\t\tfor ( i = 0; i < nUvLayers; i ++ ) {\r\n\r\n\t\t\t\t\t\t\tuvLayer = json.uvs[ i ];\r\n\r\n\t\t\t\t\t\t\tgeometry.faceVertexUvs[ i ][ fi ] = [];\r\n\t\t\t\t\t\t\tgeometry.faceVertexUvs[ i ][ fi + 1 ] = [];\r\n\r\n\t\t\t\t\t\t\tfor ( j = 0; j < 4; j ++ ) {\r\n\r\n\t\t\t\t\t\t\t\tuvIndex = faces[ offset ++ ];\r\n\r\n\t\t\t\t\t\t\t\tu = uvLayer[ uvIndex * 2 ];\r\n\t\t\t\t\t\t\t\tv = uvLayer[ uvIndex * 2 + 1 ];\r\n\r\n\t\t\t\t\t\t\t\tuv = new THREE.Vector2( u, v );\r\n\r\n\t\t\t\t\t\t\t\tif ( j !== 2 ) geometry.faceVertexUvs[ i ][ fi ].push( uv );\r\n\t\t\t\t\t\t\t\tif ( j !== 0 ) geometry.faceVertexUvs[ i ][ fi + 1 ].push( uv );\r\n\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif ( hasFaceNormal ) {\r\n\r\n\t\t\t\t\t\tnormalIndex = faces[ offset ++ ] * 3;\r\n\r\n\t\t\t\t\t\tfaceA.normal.set(\r\n\t\t\t\t\t\t\tnormals[ normalIndex ++ ],\r\n\t\t\t\t\t\t\tnormals[ normalIndex ++ ],\r\n\t\t\t\t\t\t\tnormals[ normalIndex ]\r\n\t\t\t\t\t\t);\r\n\r\n\t\t\t\t\t\tfaceB.normal.copy( faceA.normal );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif ( hasFaceVertexNormal ) {\r\n\r\n\t\t\t\t\t\tfor ( i = 0; i < 4; i ++ ) {\r\n\r\n\t\t\t\t\t\t\tnormalIndex = faces[ offset ++ ] * 3;\r\n\r\n\t\t\t\t\t\t\tnormal = new THREE.Vector3(\r\n\t\t\t\t\t\t\t\tnormals[ normalIndex ++ ],\r\n\t\t\t\t\t\t\t\tnormals[ normalIndex ++ ],\r\n\t\t\t\t\t\t\t\tnormals[ normalIndex ]\r\n\t\t\t\t\t\t\t);\r\n\r\n\r\n\t\t\t\t\t\t\tif ( i !== 2 ) faceA.vertexNormals.push( normal );\r\n\t\t\t\t\t\t\tif ( i !== 0 ) faceB.vertexNormals.push( normal );\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\r\n\r\n\t\t\t\t\tif ( hasFaceColor ) {\r\n\r\n\t\t\t\t\t\tcolorIndex = faces[ offset ++ ];\r\n\t\t\t\t\t\thex = colors[ colorIndex ];\r\n\r\n\t\t\t\t\t\tfaceA.color.setHex( hex );\r\n\t\t\t\t\t\tfaceB.color.setHex( hex );\r\n\r\n\t\t\t\t\t}\r\n\r\n\r\n\t\t\t\t\tif ( hasFaceVertexColor ) {\r\n\r\n\t\t\t\t\t\tfor ( i = 0; i < 4; i ++ ) {\r\n\r\n\t\t\t\t\t\t\tcolorIndex = faces[ offset ++ ];\r\n\t\t\t\t\t\t\thex = colors[ colorIndex ];\r\n\r\n\t\t\t\t\t\t\tif ( i !== 2 ) faceA.vertexColors.push( new THREE.Color( hex ) );\r\n\t\t\t\t\t\t\tif ( i !== 0 ) faceB.vertexColors.push( new THREE.Color( hex ) );\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tgeometry.faces.push( faceA );\r\n\t\t\t\t\tgeometry.faces.push( faceB );\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tface = new THREE.Face3();\r\n\t\t\t\t\tface.a = faces[ offset ++ ];\r\n\t\t\t\t\tface.b = faces[ offset ++ ];\r\n\t\t\t\t\tface.c = faces[ offset ++ ];\r\n\r\n\t\t\t\t\tif ( hasMaterial ) {\r\n\r\n\t\t\t\t\t\tmaterialIndex = faces[ offset ++ ];\r\n\t\t\t\t\t\tface.materialIndex = materialIndex;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t// to get face <=> uv index correspondence\r\n\r\n\t\t\t\t\tfi = geometry.faces.length;\r\n\r\n\t\t\t\t\tif ( hasFaceVertexUv ) {\r\n\r\n\t\t\t\t\t\tfor ( i = 0; i < nUvLayers; i ++ ) {\r\n\r\n\t\t\t\t\t\t\tuvLayer = json.uvs[ i ];\r\n\r\n\t\t\t\t\t\t\tgeometry.faceVertexUvs[ i ][ fi ] = [];\r\n\r\n\t\t\t\t\t\t\tfor ( j = 0; j < 3; j ++ ) {\r\n\r\n\t\t\t\t\t\t\t\tuvIndex = faces[ offset ++ ];\r\n\r\n\t\t\t\t\t\t\t\tu = uvLayer[ uvIndex * 2 ];\r\n\t\t\t\t\t\t\t\tv = uvLayer[ uvIndex * 2 + 1 ];\r\n\r\n\t\t\t\t\t\t\t\tuv = new THREE.Vector2( u, v );\r\n\r\n\t\t\t\t\t\t\t\tgeometry.faceVertexUvs[ i ][ fi ].push( uv );\r\n\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif ( hasFaceNormal ) {\r\n\r\n\t\t\t\t\t\tnormalIndex = faces[ offset ++ ] * 3;\r\n\r\n\t\t\t\t\t\tface.normal.set(\r\n\t\t\t\t\t\t\tnormals[ normalIndex ++ ],\r\n\t\t\t\t\t\t\tnormals[ normalIndex ++ ],\r\n\t\t\t\t\t\t\tnormals[ normalIndex ]\r\n\t\t\t\t\t\t);\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif ( hasFaceVertexNormal ) {\r\n\r\n\t\t\t\t\t\tfor ( i = 0; i < 3; i ++ ) {\r\n\r\n\t\t\t\t\t\t\tnormalIndex = faces[ offset ++ ] * 3;\r\n\r\n\t\t\t\t\t\t\tnormal = new THREE.Vector3(\r\n\t\t\t\t\t\t\t\tnormals[ normalIndex ++ ],\r\n\t\t\t\t\t\t\t\tnormals[ normalIndex ++ ],\r\n\t\t\t\t\t\t\t\tnormals[ normalIndex ]\r\n\t\t\t\t\t\t\t);\r\n\r\n\t\t\t\t\t\t\tface.vertexNormals.push( normal );\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\r\n\r\n\t\t\t\t\tif ( hasFaceColor ) {\r\n\r\n\t\t\t\t\t\tcolorIndex = faces[ offset ++ ];\r\n\t\t\t\t\t\tface.color.setHex( colors[ colorIndex ] );\r\n\r\n\t\t\t\t\t}\r\n\r\n\r\n\t\t\t\t\tif ( hasFaceVertexColor ) {\r\n\r\n\t\t\t\t\t\tfor ( i = 0; i < 3; i ++ ) {\r\n\r\n\t\t\t\t\t\t\tcolorIndex = faces[ offset ++ ];\r\n\t\t\t\t\t\t\tface.vertexColors.push( new THREE.Color( colors[ colorIndex ] ) );\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tgeometry.faces.push( face );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t};\r\n\r\n\t\tfunction parseSkin() {\r\n\r\n\t\t\tvar influencesPerVertex = ( json.influencesPerVertex !== undefined ) ? json.influencesPerVertex : 2;\r\n\r\n\t\t\tif ( json.skinWeights ) {\r\n\r\n\t\t\t\tfor ( var i = 0, l = json.skinWeights.length; i < l; i += influencesPerVertex ) {\r\n\r\n\t\t\t\t\tvar x =                               json.skinWeights[ i ];\r\n\t\t\t\t\tvar y = ( influencesPerVertex > 1 ) ? json.skinWeights[ i + 1 ] : 0;\r\n\t\t\t\t\tvar z = ( influencesPerVertex > 2 ) ? json.skinWeights[ i + 2 ] : 0;\r\n\t\t\t\t\tvar w = ( influencesPerVertex > 3 ) ? json.skinWeights[ i + 3 ] : 0;\r\n\r\n\t\t\t\t\tgeometry.skinWeights.push( new THREE.Vector4( x, y, z, w ) );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( json.skinIndices ) {\r\n\r\n\t\t\t\tfor ( var i = 0, l = json.skinIndices.length; i < l; i += influencesPerVertex ) {\r\n\r\n\t\t\t\t\tvar a =                               json.skinIndices[ i ];\r\n\t\t\t\t\tvar b = ( influencesPerVertex > 1 ) ? json.skinIndices[ i + 1 ] : 0;\r\n\t\t\t\t\tvar c = ( influencesPerVertex > 2 ) ? json.skinIndices[ i + 2 ] : 0;\r\n\t\t\t\t\tvar d = ( influencesPerVertex > 3 ) ? json.skinIndices[ i + 3 ] : 0;\r\n\r\n\t\t\t\t\tgeometry.skinIndices.push( new THREE.Vector4( a, b, c, d ) );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tgeometry.bones = json.bones;\r\n\r\n\t\t\tif ( geometry.bones && geometry.bones.length > 0 && ( geometry.skinWeights.length !== geometry.skinIndices.length || geometry.skinIndices.length !== geometry.vertices.length ) ) {\r\n\r\n\t\t\t\tconsole.warn( 'When skinning, number of vertices (' + geometry.vertices.length + '), skinIndices (' +\r\n\t\t\t\t\tgeometry.skinIndices.length + '), and skinWeights (' + geometry.skinWeights.length + ') should match.' );\r\n\r\n\t\t\t}\r\n\r\n\t\t};\r\n\r\n\t\tfunction parseMorphing( scale ) {\r\n\r\n\t\t\tif ( json.morphTargets !== undefined ) {\r\n\r\n\t\t\t\tfor ( var i = 0, l = json.morphTargets.length; i < l; i ++ ) {\r\n\r\n\t\t\t\t\tgeometry.morphTargets[ i ] = {};\r\n\t\t\t\t\tgeometry.morphTargets[ i ].name = json.morphTargets[ i ].name;\r\n\t\t\t\t\tgeometry.morphTargets[ i ].vertices = [];\r\n\r\n\t\t\t\t\tvar dstVertices = geometry.morphTargets[ i ].vertices;\r\n\t\t\t\t\tvar srcVertices = json.morphTargets[ i ].vertices;\r\n\r\n\t\t\t\t\tfor ( var v = 0, vl = srcVertices.length; v < vl; v += 3 ) {\r\n\r\n\t\t\t\t\t\tvar vertex = new THREE.Vector3();\r\n\t\t\t\t\t\tvertex.x = srcVertices[ v ] * scale;\r\n\t\t\t\t\t\tvertex.y = srcVertices[ v + 1 ] * scale;\r\n\t\t\t\t\t\tvertex.z = srcVertices[ v + 2 ] * scale;\r\n\r\n\t\t\t\t\t\tdstVertices.push( vertex );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( json.morphColors !== undefined && json.morphColors.length > 0 ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.JSONLoader: \"morphColors\" no longer supported. Using them as face colors.' );\r\n\r\n\t\t\t\tvar faces = geometry.faces;\r\n\t\t\t\tvar morphColors = json.morphColors[ 0 ].colors;\r\n\r\n\t\t\t\tfor ( var i = 0, l = faces.length; i < l; i ++ ) {\r\n\r\n\t\t\t\t\tfaces[ i ].color.fromArray( morphColors, i * 3 );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tfunction parseAnimations() {\r\n\r\n\t\t\tvar outputAnimations = [];\r\n\r\n\t\t\t// parse old style Bone/Hierarchy animations\r\n\t\t\tvar animations = [];\r\n\r\n\t\t\tif ( json.animation !== undefined ) {\r\n\r\n\t\t\t\tanimations.push( json.animation );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( json.animations !== undefined ) {\r\n\r\n\t\t\t\tif ( json.animations.length ) {\r\n\r\n\t\t\t\t\tanimations = animations.concat( json.animations );\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tanimations.push( json.animations );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tfor ( var i = 0; i < animations.length; i ++ ) {\r\n\r\n\t\t\t\tvar clip = THREE.AnimationClip.parseAnimation( animations[ i ], geometry.bones );\r\n\t\t\t\tif ( clip ) outputAnimations.push( clip );\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// parse implicit morph animations\r\n\t\t\tif ( geometry.morphTargets ) {\r\n\r\n\t\t\t\t// TODO: Figure out what an appropraite FPS is for morph target animations -- defaulting to 10, but really it is completely arbitrary.\r\n\t\t\t\tvar morphAnimationClips = THREE.AnimationClip.CreateClipsFromMorphTargetSequences( geometry.morphTargets, 10 );\r\n\t\t\t\toutputAnimations = outputAnimations.concat( morphAnimationClips );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( outputAnimations.length > 0 ) geometry.animations = outputAnimations;\r\n\r\n\t\t};\r\n\r\n\t\tif ( json.materials === undefined || json.materials.length === 0 ) {\r\n\r\n\t\t\treturn { geometry: geometry };\r\n\r\n\t\t} else {\r\n\r\n\t\t\tvar materials = THREE.Loader.prototype.initMaterials( json.materials, texturePath, this.crossOrigin );\r\n\r\n\t\t\treturn { geometry: geometry, materials: materials };\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n};\r\n\r\n// File:src/loaders/LoadingManager.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.LoadingManager = function ( onLoad, onProgress, onError ) {\r\n\r\n\tvar scope = this;\r\n\r\n\tvar isLoading = false, itemsLoaded = 0, itemsTotal = 0;\r\n\r\n\tthis.onStart = undefined;\r\n\tthis.onLoad = onLoad;\r\n\tthis.onProgress = onProgress;\r\n\tthis.onError = onError;\r\n\r\n\tthis.itemStart = function ( url ) {\r\n\r\n\t\titemsTotal ++;\r\n\r\n\t\tif ( isLoading === false ) {\r\n\r\n\t\t\tif ( scope.onStart !== undefined ) {\r\n\r\n\t\t\t\tscope.onStart( url, itemsLoaded, itemsTotal );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tisLoading = true;\r\n\r\n\t};\r\n\r\n\tthis.itemEnd = function ( url ) {\r\n\r\n\t\titemsLoaded ++;\r\n\r\n\t\tif ( scope.onProgress !== undefined ) {\r\n\r\n\t\t\tscope.onProgress( url, itemsLoaded, itemsTotal );\r\n\r\n\t\t}\r\n\r\n\t\tif ( itemsLoaded === itemsTotal ) {\r\n\r\n\t\t\tisLoading = false;\r\n\r\n\t\t\tif ( scope.onLoad !== undefined ) {\r\n\r\n\t\t\t\tscope.onLoad();\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n\tthis.itemError = function ( url ) {\r\n\r\n\t\tif ( scope.onError !== undefined ) {\r\n\r\n\t\t\tscope.onError( url );\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n};\r\n\r\nTHREE.DefaultLoadingManager = new THREE.LoadingManager();\r\n\r\n// File:src/loaders/BufferGeometryLoader.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.BufferGeometryLoader = function ( manager ) {\r\n\r\n\tthis.manager = ( manager !== undefined ) ? manager : THREE.DefaultLoadingManager;\r\n\r\n};\r\n\r\nTHREE.BufferGeometryLoader.prototype = {\r\n\r\n\tconstructor: THREE.BufferGeometryLoader,\r\n\r\n\tload: function ( url, onLoad, onProgress, onError ) {\r\n\r\n\t\tvar scope = this;\r\n\r\n\t\tvar loader = new THREE.XHRLoader( scope.manager );\r\n\t\tloader.load( url, function ( text ) {\r\n\r\n\t\t\tonLoad( scope.parse( JSON.parse( text ) ) );\r\n\r\n\t\t}, onProgress, onError );\r\n\r\n\t},\r\n\r\n\tparse: function ( json ) {\r\n\r\n\t\tvar geometry = new THREE.BufferGeometry();\r\n\r\n\t\tvar index = json.data.index;\r\n\r\n\t\tvar TYPED_ARRAYS = {\r\n\t\t\t'Int8Array': Int8Array,\r\n\t\t\t'Uint8Array': Uint8Array,\r\n\t\t\t'Uint8ClampedArray': Uint8ClampedArray,\r\n\t\t\t'Int16Array': Int16Array,\r\n\t\t\t'Uint16Array': Uint16Array,\r\n\t\t\t'Int32Array': Int32Array,\r\n\t\t\t'Uint32Array': Uint32Array,\r\n\t\t\t'Float32Array': Float32Array,\r\n\t\t\t'Float64Array': Float64Array\r\n\t\t};\r\n\r\n\t\tif ( index !== undefined ) {\r\n\r\n\t\t\tvar typedArray = new TYPED_ARRAYS[ index.type ]( index.array );\r\n\t\t\tgeometry.setIndex( new THREE.BufferAttribute( typedArray, 1 ) );\r\n\r\n\t\t}\r\n\r\n\t\tvar attributes = json.data.attributes;\r\n\r\n\t\tfor ( var key in attributes ) {\r\n\r\n\t\t\tvar attribute = attributes[ key ];\r\n\t\t\tvar typedArray = new TYPED_ARRAYS[ attribute.type ]( attribute.array );\r\n\r\n\t\t\tgeometry.addAttribute( key, new THREE.BufferAttribute( typedArray, attribute.itemSize, attribute.normalized ) );\r\n\r\n\t\t}\r\n\r\n\t\tvar groups = json.data.groups || json.data.drawcalls || json.data.offsets;\r\n\r\n\t\tif ( groups !== undefined ) {\r\n\r\n\t\t\tfor ( var i = 0, n = groups.length; i !== n; ++ i ) {\r\n\r\n\t\t\t\tvar group = groups[ i ];\r\n\r\n\t\t\t\tgeometry.addGroup( group.start, group.count, group.materialIndex );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tvar boundingSphere = json.data.boundingSphere;\r\n\r\n\t\tif ( boundingSphere !== undefined ) {\r\n\r\n\t\t\tvar center = new THREE.Vector3();\r\n\r\n\t\t\tif ( boundingSphere.center !== undefined ) {\r\n\r\n\t\t\t\tcenter.fromArray( boundingSphere.center );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tgeometry.boundingSphere = new THREE.Sphere( center, boundingSphere.radius );\r\n\r\n\t\t}\r\n\r\n\t\treturn geometry;\r\n\r\n\t}\r\n\r\n};\r\n\r\n// File:src/loaders/MaterialLoader.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.MaterialLoader = function ( manager ) {\r\n\r\n\tthis.manager = ( manager !== undefined ) ? manager : THREE.DefaultLoadingManager;\r\n\tthis.textures = {};\r\n\r\n};\r\n\r\nTHREE.MaterialLoader.prototype = {\r\n\r\n\tconstructor: THREE.MaterialLoader,\r\n\r\n\tload: function ( url, onLoad, onProgress, onError ) {\r\n\r\n\t\tvar scope = this;\r\n\r\n\t\tvar loader = new THREE.XHRLoader( scope.manager );\r\n\t\tloader.load( url, function ( text ) {\r\n\r\n\t\t\tonLoad( scope.parse( JSON.parse( text ) ) );\r\n\r\n\t\t}, onProgress, onError );\r\n\r\n\t},\r\n\r\n\tsetTextures: function ( value ) {\r\n\r\n\t\tthis.textures = value;\r\n\r\n\t},\r\n\r\n\tgetTexture: function ( name ) {\r\n\r\n\t\tvar textures = this.textures;\r\n\r\n\t\tif ( textures[ name ] === undefined ) {\r\n\r\n\t\t\tconsole.warn( 'THREE.MaterialLoader: Undefined texture', name );\r\n\r\n\t\t}\r\n\r\n\t\treturn textures[ name ];\r\n\r\n\t},\r\n\r\n\tparse: function ( json ) {\r\n\r\n\t\tvar material = new THREE[ json.type ];\r\n\r\n\t\tif ( json.uuid !== undefined ) material.uuid = json.uuid;\r\n\t\tif ( json.name !== undefined ) material.name = json.name;\r\n\t\tif ( json.color !== undefined ) material.color.setHex( json.color );\r\n\t\tif ( json.roughness !== undefined ) material.roughness = json.roughness;\r\n\t\tif ( json.metalness !== undefined ) material.metalness = json.metalness;\r\n\t\tif ( json.emissive !== undefined ) material.emissive.setHex( json.emissive );\r\n\t\tif ( json.specular !== undefined ) material.specular.setHex( json.specular );\r\n\t\tif ( json.shininess !== undefined ) material.shininess = json.shininess;\r\n\t\tif ( json.uniforms !== undefined ) material.uniforms = json.uniforms;\r\n\t\tif ( json.vertexShader !== undefined ) material.vertexShader = json.vertexShader;\r\n\t\tif ( json.fragmentShader !== undefined ) material.fragmentShader = json.fragmentShader;\r\n\t\tif ( json.vertexColors !== undefined ) material.vertexColors = json.vertexColors;\r\n\t\tif ( json.shading !== undefined ) material.shading = json.shading;\r\n\t\tif ( json.blending !== undefined ) material.blending = json.blending;\r\n\t\tif ( json.side !== undefined ) material.side = json.side;\r\n\t\tif ( json.opacity !== undefined ) material.opacity = json.opacity;\r\n\t\tif ( json.transparent !== undefined ) material.transparent = json.transparent;\r\n\t\tif ( json.alphaTest !== undefined ) material.alphaTest = json.alphaTest;\r\n\t\tif ( json.depthTest !== undefined ) material.depthTest = json.depthTest;\r\n\t\tif ( json.depthWrite !== undefined ) material.depthWrite = json.depthWrite;\r\n\t\tif ( json.colorWrite !== undefined ) material.colorWrite = json.colorWrite;\r\n\t\tif ( json.wireframe !== undefined ) material.wireframe = json.wireframe;\r\n\t\tif ( json.wireframeLinewidth !== undefined ) material.wireframeLinewidth = json.wireframeLinewidth;\r\n\r\n\t\t// for PointsMaterial\r\n\t\tif ( json.size !== undefined ) material.size = json.size;\r\n\t\tif ( json.sizeAttenuation !== undefined ) material.sizeAttenuation = json.sizeAttenuation;\r\n\r\n\t\t// maps\r\n\r\n\t\tif ( json.map !== undefined ) material.map = this.getTexture( json.map );\r\n\r\n\t\tif ( json.alphaMap !== undefined ) {\r\n\r\n\t\t\tmaterial.alphaMap = this.getTexture( json.alphaMap );\r\n\t\t\tmaterial.transparent = true;\r\n\r\n\t\t}\r\n\r\n\t\tif ( json.bumpMap !== undefined ) material.bumpMap = this.getTexture( json.bumpMap );\r\n\t\tif ( json.bumpScale !== undefined ) material.bumpScale = json.bumpScale;\r\n\r\n\t\tif ( json.normalMap !== undefined ) material.normalMap = this.getTexture( json.normalMap );\r\n\t\tif ( json.normalScale !== undefined ) {\r\n\r\n\t\t\tvar normalScale = json.normalScale;\r\n\r\n\t\t\tif ( Array.isArray( normalScale ) === false ) {\r\n\r\n\t\t\t\t// Blender exporter used to export a scalar. See #7459\r\n\r\n\t\t\t\tnormalScale = [ normalScale, normalScale ];\r\n\r\n\t\t\t}\r\n\r\n\t\t\tmaterial.normalScale = new THREE.Vector2().fromArray( normalScale );\r\n\r\n\t\t}\r\n\r\n\t\tif ( json.displacementMap !== undefined ) material.displacementMap = this.getTexture( json.displacementMap );\r\n\t\tif ( json.displacementScale !== undefined ) material.displacementScale = json.displacementScale;\r\n\t\tif ( json.displacementBias !== undefined ) material.displacementBias = json.displacementBias;\r\n\r\n\t\tif ( json.roughnessMap !== undefined ) material.roughnessMap = this.getTexture( json.roughnessMap );\r\n\t\tif ( json.metalnessMap !== undefined ) material.metalnessMap = this.getTexture( json.metalnessMap );\r\n\r\n\t\tif ( json.emissiveMap !== undefined ) material.emissiveMap = this.getTexture( json.emissiveMap );\r\n\t\tif ( json.emissiveIntensity !== undefined ) material.emissiveIntensity = json.emissiveIntensity;\r\n\r\n\t\tif ( json.specularMap !== undefined ) material.specularMap = this.getTexture( json.specularMap );\r\n\r\n\t\tif ( json.envMap !== undefined ) {\r\n\r\n\t\t\tmaterial.envMap = this.getTexture( json.envMap );\r\n\t\t\tmaterial.combine = THREE.MultiplyOperation;\r\n\r\n\t\t}\r\n\r\n\t\tif ( json.reflectivity ) material.reflectivity = json.reflectivity;\r\n\r\n\t\tif ( json.lightMap !== undefined ) material.lightMap = this.getTexture( json.lightMap );\r\n\t\tif ( json.lightMapIntensity !== undefined ) material.lightMapIntensity = json.lightMapIntensity;\r\n\r\n\t\tif ( json.aoMap !== undefined ) material.aoMap = this.getTexture( json.aoMap );\r\n\t\tif ( json.aoMapIntensity !== undefined ) material.aoMapIntensity = json.aoMapIntensity;\r\n\r\n\t\t// MultiMaterial\r\n\r\n\t\tif ( json.materials !== undefined ) {\r\n\r\n\t\t\tfor ( var i = 0, l = json.materials.length; i < l; i ++ ) {\r\n\r\n\t\t\t\tmaterial.materials.push( this.parse( json.materials[ i ] ) );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\treturn material;\r\n\r\n\t}\r\n\r\n};\r\n\r\n// File:src/loaders/ObjectLoader.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.ObjectLoader = function ( manager ) {\r\n\r\n\tthis.manager = ( manager !== undefined ) ? manager : THREE.DefaultLoadingManager;\r\n\tthis.texturePath = '';\r\n\r\n};\r\n\r\nTHREE.ObjectLoader.prototype = {\r\n\r\n\tconstructor: THREE.ObjectLoader,\r\n\r\n\tload: function ( url, onLoad, onProgress, onError ) {\r\n\r\n\t\tif ( this.texturePath === '' ) {\r\n\r\n\t\t\tthis.texturePath = url.substring( 0, url.lastIndexOf( '/' ) + 1 );\r\n\r\n\t\t}\r\n\r\n\t\tvar scope = this;\r\n\r\n\t\tvar loader = new THREE.XHRLoader( scope.manager );\r\n\t\tloader.load( url, function ( text ) {\r\n\r\n\t\t\tscope.parse( JSON.parse( text ), onLoad );\r\n\r\n\t\t}, onProgress, onError );\r\n\r\n\t},\r\n\r\n\tsetTexturePath: function ( value ) {\r\n\r\n\t\tthis.texturePath = value;\r\n\r\n\t},\r\n\r\n\tsetCrossOrigin: function ( value ) {\r\n\r\n\t\tthis.crossOrigin = value;\r\n\r\n\t},\r\n\r\n\tparse: function ( json, onLoad ) {\r\n\r\n\t\tvar geometries = this.parseGeometries( json.geometries );\r\n\r\n\t\tvar images = this.parseImages( json.images, function () {\r\n\r\n\t\t\tif ( onLoad !== undefined ) onLoad( object );\r\n\r\n\t\t} );\r\n\r\n\t\tvar textures  = this.parseTextures( json.textures, images );\r\n\t\tvar materials = this.parseMaterials( json.materials, textures );\r\n\r\n\t\tvar object = this.parseObject( json.object, geometries, materials );\r\n\r\n\t\tif ( json.animations ) {\r\n\r\n\t\t\tobject.animations = this.parseAnimations( json.animations );\r\n\r\n\t\t}\r\n\r\n\t\tif ( json.images === undefined || json.images.length === 0 ) {\r\n\r\n\t\t\tif ( onLoad !== undefined ) onLoad( object );\r\n\r\n\t\t}\r\n\r\n\t\treturn object;\r\n\r\n\t},\r\n\r\n\tparseGeometries: function ( json ) {\r\n\r\n\t\tvar geometries = {};\r\n\r\n\t\tif ( json !== undefined ) {\r\n\r\n\t\t\tvar geometryLoader = new THREE.JSONLoader();\r\n\t\t\tvar bufferGeometryLoader = new THREE.BufferGeometryLoader();\r\n\r\n\t\t\tfor ( var i = 0, l = json.length; i < l; i ++ ) {\r\n\r\n\t\t\t\tvar geometry;\r\n\t\t\t\tvar data = json[ i ];\r\n\r\n\t\t\t\tswitch ( data.type ) {\r\n\r\n\t\t\t\t\tcase 'PlaneGeometry':\r\n\t\t\t\t\tcase 'PlaneBufferGeometry':\r\n\r\n\t\t\t\t\t\tgeometry = new THREE[ data.type ](\r\n\t\t\t\t\t\t\tdata.width,\r\n\t\t\t\t\t\t\tdata.height,\r\n\t\t\t\t\t\t\tdata.widthSegments,\r\n\t\t\t\t\t\t\tdata.heightSegments\r\n\t\t\t\t\t\t);\r\n\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase 'BoxGeometry':\r\n\t\t\t\t\tcase 'BoxBufferGeometry':\r\n\t\t\t\t\tcase 'CubeGeometry': // backwards compatible\r\n\r\n\t\t\t\t\t\tgeometry = new THREE[ data.type ](\r\n\t\t\t\t\t\t\tdata.width,\r\n\t\t\t\t\t\t\tdata.height,\r\n\t\t\t\t\t\t\tdata.depth,\r\n\t\t\t\t\t\t\tdata.widthSegments,\r\n\t\t\t\t\t\t\tdata.heightSegments,\r\n\t\t\t\t\t\t\tdata.depthSegments\r\n\t\t\t\t\t\t);\r\n\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase 'CircleGeometry':\r\n\t\t\t\t\tcase 'CircleBufferGeometry':\r\n\r\n\t\t\t\t\t\tgeometry = new THREE[ data.type ](\r\n\t\t\t\t\t\t\tdata.radius,\r\n\t\t\t\t\t\t\tdata.segments,\r\n\t\t\t\t\t\t\tdata.thetaStart,\r\n\t\t\t\t\t\t\tdata.thetaLength\r\n\t\t\t\t\t\t);\r\n\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase 'CylinderGeometry':\r\n\t\t\t\t\tcase 'CylinderBufferGeometry':\r\n\r\n\t\t\t\t\t\tgeometry = new THREE[ data.type ](\r\n\t\t\t\t\t\t\tdata.radiusTop,\r\n\t\t\t\t\t\t\tdata.radiusBottom,\r\n\t\t\t\t\t\t\tdata.height,\r\n\t\t\t\t\t\t\tdata.radialSegments,\r\n\t\t\t\t\t\t\tdata.heightSegments,\r\n\t\t\t\t\t\t\tdata.openEnded,\r\n\t\t\t\t\t\t\tdata.thetaStart,\r\n\t\t\t\t\t\t\tdata.thetaLength\r\n\t\t\t\t\t\t);\r\n\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase 'SphereGeometry':\r\n\t\t\t\t\tcase 'SphereBufferGeometry':\r\n\r\n\t\t\t\t\t\tgeometry = new THREE[ data.type ](\r\n\t\t\t\t\t\t\tdata.radius,\r\n\t\t\t\t\t\t\tdata.widthSegments,\r\n\t\t\t\t\t\t\tdata.heightSegments,\r\n\t\t\t\t\t\t\tdata.phiStart,\r\n\t\t\t\t\t\t\tdata.phiLength,\r\n\t\t\t\t\t\t\tdata.thetaStart,\r\n\t\t\t\t\t\t\tdata.thetaLength\r\n\t\t\t\t\t\t);\r\n\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase 'DodecahedronGeometry':\r\n\r\n\t\t\t\t\t\tgeometry = new THREE.DodecahedronGeometry(\r\n\t\t\t\t\t\t\tdata.radius,\r\n\t\t\t\t\t\t\tdata.detail\r\n\t\t\t\t\t\t);\r\n\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase 'IcosahedronGeometry':\r\n\r\n\t\t\t\t\t\tgeometry = new THREE.IcosahedronGeometry(\r\n\t\t\t\t\t\t\tdata.radius,\r\n\t\t\t\t\t\t\tdata.detail\r\n\t\t\t\t\t\t);\r\n\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase 'OctahedronGeometry':\r\n\r\n\t\t\t\t\t\tgeometry = new THREE.OctahedronGeometry(\r\n\t\t\t\t\t\t\tdata.radius,\r\n\t\t\t\t\t\t\tdata.detail\r\n\t\t\t\t\t\t);\r\n\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase 'TetrahedronGeometry':\r\n\r\n\t\t\t\t\t\tgeometry = new THREE.TetrahedronGeometry(\r\n\t\t\t\t\t\t\tdata.radius,\r\n\t\t\t\t\t\t\tdata.detail\r\n\t\t\t\t\t\t);\r\n\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase 'RingGeometry':\r\n\t\t\t\t\tcase 'RingBufferGeometry':\r\n\r\n\t\t\t\t\t\tgeometry = new THREE[ data.type ](\r\n\t\t\t\t\t\t\tdata.innerRadius,\r\n\t\t\t\t\t\t\tdata.outerRadius,\r\n\t\t\t\t\t\t\tdata.thetaSegments,\r\n\t\t\t\t\t\t\tdata.phiSegments,\r\n\t\t\t\t\t\t\tdata.thetaStart,\r\n\t\t\t\t\t\t\tdata.thetaLength\r\n\t\t\t\t\t\t);\r\n\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase 'TorusGeometry':\r\n\t\t\t\t\tcase 'TorusBufferGeometry':\r\n\r\n\t\t\t\t\t\tgeometry = new THREE[ data.type ](\r\n\t\t\t\t\t\t\tdata.radius,\r\n\t\t\t\t\t\t\tdata.tube,\r\n\t\t\t\t\t\t\tdata.radialSegments,\r\n\t\t\t\t\t\t\tdata.tubularSegments,\r\n\t\t\t\t\t\t\tdata.arc\r\n\t\t\t\t\t\t);\r\n\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase 'TorusKnotGeometry':\r\n\t\t\t\t\tcase 'TorusKnotBufferGeometry':\r\n\r\n\t\t\t\t\t\tgeometry = new THREE[ data.type ](\r\n\t\t\t\t\t\t\tdata.radius,\r\n\t\t\t\t\t\t\tdata.tube,\r\n\t\t\t\t\t\t\tdata.tubularSegments,\r\n\t\t\t\t\t\t\tdata.radialSegments,\r\n\t\t\t\t\t\t\tdata.p,\r\n\t\t\t\t\t\t\tdata.q\r\n\t\t\t\t\t\t);\r\n\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase 'LatheGeometry':\r\n\t\t\t\t\tcase 'LatheBufferGeometry':\r\n\r\n\t\t\t\t\t\tgeometry = new THREE[ data.type ](\r\n\t\t\t\t\t\t\tdata.points,\r\n\t\t\t\t\t\t\tdata.segments,\r\n\t\t\t\t\t\t\tdata.phiStart,\r\n\t\t\t\t\t\t\tdata.phiLength\r\n\t\t\t\t\t\t);\r\n\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase 'BufferGeometry':\r\n\r\n\t\t\t\t\t\tgeometry = bufferGeometryLoader.parse( data );\r\n\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase 'Geometry':\r\n\r\n\t\t\t\t\t\tgeometry = geometryLoader.parse( data.data, this.texturePath ).geometry;\r\n\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tdefault:\r\n\r\n\t\t\t\t\t\tconsole.warn( 'THREE.ObjectLoader: Unsupported geometry type \"' + data.type + '\"' );\r\n\r\n\t\t\t\t\t\tcontinue;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tgeometry.uuid = data.uuid;\r\n\r\n\t\t\t\tif ( data.name !== undefined ) geometry.name = data.name;\r\n\r\n\t\t\t\tgeometries[ data.uuid ] = geometry;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\treturn geometries;\r\n\r\n\t},\r\n\r\n\tparseMaterials: function ( json, textures ) {\r\n\r\n\t\tvar materials = {};\r\n\r\n\t\tif ( json !== undefined ) {\r\n\r\n\t\t\tvar loader = new THREE.MaterialLoader();\r\n\t\t\tloader.setTextures( textures );\r\n\r\n\t\t\tfor ( var i = 0, l = json.length; i < l; i ++ ) {\r\n\r\n\t\t\t\tvar material = loader.parse( json[ i ] );\r\n\t\t\t\tmaterials[ material.uuid ] = material;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\treturn materials;\r\n\r\n\t},\r\n\r\n\tparseAnimations: function ( json ) {\r\n\r\n\t\tvar animations = [];\r\n\r\n\t\tfor ( var i = 0; i < json.length; i ++ ) {\r\n\r\n\t\t\tvar clip = THREE.AnimationClip.parse( json[ i ] );\r\n\r\n\t\t\tanimations.push( clip );\r\n\r\n\t\t}\r\n\r\n\t\treturn animations;\r\n\r\n\t},\r\n\r\n\tparseImages: function ( json, onLoad ) {\r\n\r\n\t\tvar scope = this;\r\n\t\tvar images = {};\r\n\r\n\t\tfunction loadImage( url ) {\r\n\r\n\t\t\tscope.manager.itemStart( url );\r\n\r\n\t\t\treturn loader.load( url, function () {\r\n\r\n\t\t\t\tscope.manager.itemEnd( url );\r\n\r\n\t\t\t} );\r\n\r\n\t\t}\r\n\r\n\t\tif ( json !== undefined && json.length > 0 ) {\r\n\r\n\t\t\tvar manager = new THREE.LoadingManager( onLoad );\r\n\r\n\t\t\tvar loader = new THREE.ImageLoader( manager );\r\n\t\t\tloader.setCrossOrigin( this.crossOrigin );\r\n\r\n\t\t\tfor ( var i = 0, l = json.length; i < l; i ++ ) {\r\n\r\n\t\t\t\tvar image = json[ i ];\r\n\t\t\t\tvar path = /^(\\/\\/)|([a-z]+:(\\/\\/)?)/i.test( image.url ) ? image.url : scope.texturePath + image.url;\r\n\r\n\t\t\t\timages[ image.uuid ] = loadImage( path );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\treturn images;\r\n\r\n\t},\r\n\r\n\tparseTextures: function ( json, images ) {\r\n\r\n\t\tfunction parseConstant( value ) {\r\n\r\n\t\t\tif ( typeof( value ) === 'number' ) return value;\r\n\r\n\t\t\tconsole.warn( 'THREE.ObjectLoader.parseTexture: Constant should be in numeric form.', value );\r\n\r\n\t\t\treturn THREE[ value ];\r\n\r\n\t\t}\r\n\r\n\t\tvar textures = {};\r\n\r\n\t\tif ( json !== undefined ) {\r\n\r\n\t\t\tfor ( var i = 0, l = json.length; i < l; i ++ ) {\r\n\r\n\t\t\t\tvar data = json[ i ];\r\n\r\n\t\t\t\tif ( data.image === undefined ) {\r\n\r\n\t\t\t\t\tconsole.warn( 'THREE.ObjectLoader: No \"image\" specified for', data.uuid );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( images[ data.image ] === undefined ) {\r\n\r\n\t\t\t\t\tconsole.warn( 'THREE.ObjectLoader: Undefined image', data.image );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tvar texture = new THREE.Texture( images[ data.image ] );\r\n\t\t\t\ttexture.needsUpdate = true;\r\n\r\n\t\t\t\ttexture.uuid = data.uuid;\r\n\r\n\t\t\t\tif ( data.name !== undefined ) texture.name = data.name;\r\n\t\t\t\tif ( data.mapping !== undefined ) texture.mapping = parseConstant( data.mapping );\r\n\t\t\t\tif ( data.offset !== undefined ) texture.offset = new THREE.Vector2( data.offset[ 0 ], data.offset[ 1 ] );\r\n\t\t\t\tif ( data.repeat !== undefined ) texture.repeat = new THREE.Vector2( data.repeat[ 0 ], data.repeat[ 1 ] );\r\n\t\t\t\tif ( data.minFilter !== undefined ) texture.minFilter = parseConstant( data.minFilter );\r\n\t\t\t\tif ( data.magFilter !== undefined ) texture.magFilter = parseConstant( data.magFilter );\r\n\t\t\t\tif ( data.anisotropy !== undefined ) texture.anisotropy = data.anisotropy;\r\n\t\t\t\tif ( Array.isArray( data.wrap ) ) {\r\n\r\n\t\t\t\t\ttexture.wrapS = parseConstant( data.wrap[ 0 ] );\r\n\t\t\t\t\ttexture.wrapT = parseConstant( data.wrap[ 1 ] );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\ttextures[ data.uuid ] = texture;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\treturn textures;\r\n\r\n\t},\r\n\r\n\tparseObject: function () {\r\n\r\n\t\tvar matrix = new THREE.Matrix4();\r\n\r\n\t\treturn function ( data, geometries, materials ) {\r\n\r\n\t\t\tvar object;\r\n\r\n\t\t\tfunction getGeometry( name ) {\r\n\r\n\t\t\t\tif ( geometries[ name ] === undefined ) {\r\n\r\n\t\t\t\t\tconsole.warn( 'THREE.ObjectLoader: Undefined geometry', name );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn geometries[ name ];\r\n\r\n\t\t\t}\r\n\r\n\t\t\tfunction getMaterial( name ) {\r\n\r\n\t\t\t\tif ( name === undefined ) return undefined;\r\n\r\n\t\t\t\tif ( materials[ name ] === undefined ) {\r\n\r\n\t\t\t\t\tconsole.warn( 'THREE.ObjectLoader: Undefined material', name );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn materials[ name ];\r\n\r\n\t\t\t}\r\n\r\n\t\t\tswitch ( data.type ) {\r\n\r\n\t\t\t\tcase 'Scene':\r\n\r\n\t\t\t\t\tobject = new THREE.Scene();\r\n\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'PerspectiveCamera':\r\n\r\n\t\t\t\t\tobject = new THREE.PerspectiveCamera(\r\n\t\t\t\t\t\t\tdata.fov, data.aspect, data.near, data.far );\r\n\r\n\t\t\t\t\tif ( data.focus !== undefined ) object.focus = data.focus;\r\n\t\t\t\t\tif ( data.zoom !== undefined ) object.zoom = data.zoom;\r\n\t\t\t\t\tif ( data.filmGauge !== undefined ) object.filmGauge = data.filmGauge;\r\n\t\t\t\t\tif ( data.filmOffset !== undefined ) object.filmOffset = data.filmOffset;\r\n\t\t\t\t\tif ( data.view !== undefined ) object.view = Object.assign( {}, data.view );\r\n\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'OrthographicCamera':\r\n\r\n\t\t\t\t\tobject = new THREE.OrthographicCamera( data.left, data.right, data.top, data.bottom, data.near, data.far );\r\n\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'AmbientLight':\r\n\r\n\t\t\t\t\tobject = new THREE.AmbientLight( data.color, data.intensity );\r\n\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'DirectionalLight':\r\n\r\n\t\t\t\t\tobject = new THREE.DirectionalLight( data.color, data.intensity );\r\n\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'PointLight':\r\n\r\n\t\t\t\t\tobject = new THREE.PointLight( data.color, data.intensity, data.distance, data.decay );\r\n\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'SpotLight':\r\n\r\n\t\t\t\t\tobject = new THREE.SpotLight( data.color, data.intensity, data.distance, data.angle, data.penumbra, data.decay );\r\n\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'HemisphereLight':\r\n\r\n\t\t\t\t\tobject = new THREE.HemisphereLight( data.color, data.groundColor, data.intensity );\r\n\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'Mesh':\r\n\r\n\t\t\t\t\tvar geometry = getGeometry( data.geometry );\r\n\t\t\t\t\tvar material = getMaterial( data.material );\r\n\r\n\t\t\t\t\tif ( geometry.bones && geometry.bones.length > 0 ) {\r\n\r\n\t\t\t\t\t\tobject = new THREE.SkinnedMesh( geometry, material );\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\tobject = new THREE.Mesh( geometry, material );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'LOD':\r\n\r\n\t\t\t\t\tobject = new THREE.LOD();\r\n\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'Line':\r\n\r\n\t\t\t\t\tobject = new THREE.Line( getGeometry( data.geometry ), getMaterial( data.material ), data.mode );\r\n\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'PointCloud':\r\n\t\t\t\tcase 'Points':\r\n\r\n\t\t\t\t\tobject = new THREE.Points( getGeometry( data.geometry ), getMaterial( data.material ) );\r\n\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'Sprite':\r\n\r\n\t\t\t\t\tobject = new THREE.Sprite( getMaterial( data.material ) );\r\n\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'Group':\r\n\r\n\t\t\t\t\tobject = new THREE.Group();\r\n\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tdefault:\r\n\r\n\t\t\t\t\tobject = new THREE.Object3D();\r\n\r\n\t\t\t}\r\n\r\n\t\t\tobject.uuid = data.uuid;\r\n\r\n\t\t\tif ( data.name !== undefined ) object.name = data.name;\r\n\t\t\tif ( data.matrix !== undefined ) {\r\n\r\n\t\t\t\tmatrix.fromArray( data.matrix );\r\n\t\t\t\tmatrix.decompose( object.position, object.quaternion, object.scale );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tif ( data.position !== undefined ) object.position.fromArray( data.position );\r\n\t\t\t\tif ( data.rotation !== undefined ) object.rotation.fromArray( data.rotation );\r\n\t\t\t\tif ( data.scale !== undefined ) object.scale.fromArray( data.scale );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( data.castShadow !== undefined ) object.castShadow = data.castShadow;\r\n\t\t\tif ( data.receiveShadow !== undefined ) object.receiveShadow = data.receiveShadow;\r\n\r\n\t\t\tif ( data.visible !== undefined ) object.visible = data.visible;\r\n\t\t\tif ( data.userData !== undefined ) object.userData = data.userData;\r\n\r\n\t\t\tif ( data.children !== undefined ) {\r\n\r\n\t\t\t\tfor ( var child in data.children ) {\r\n\r\n\t\t\t\t\tobject.add( this.parseObject( data.children[ child ], geometries, materials ) );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( data.type === 'LOD' ) {\r\n\r\n\t\t\t\tvar levels = data.levels;\r\n\r\n\t\t\t\tfor ( var l = 0; l < levels.length; l ++ ) {\r\n\r\n\t\t\t\t\tvar level = levels[ l ];\r\n\t\t\t\t\tvar child = object.getObjectByProperty( 'uuid', level.object );\r\n\r\n\t\t\t\t\tif ( child !== undefined ) {\r\n\r\n\t\t\t\t\t\tobject.addLevel( child, level.distance );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn object;\r\n\r\n\t\t};\r\n\r\n\t}()\r\n\r\n};\r\n\r\n// File:src/loaders/TextureLoader.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.TextureLoader = function ( manager ) {\r\n\r\n\tthis.manager = ( manager !== undefined ) ? manager : THREE.DefaultLoadingManager;\r\n\r\n};\r\n\r\nTHREE.TextureLoader.prototype = {\r\n\r\n\tconstructor: THREE.TextureLoader,\r\n\r\n\tload: function ( url, onLoad, onProgress, onError ) {\r\n\r\n\t\tvar texture = new THREE.Texture();\r\n\r\n\t\tvar loader = new THREE.ImageLoader( this.manager );\r\n\t\tloader.setCrossOrigin( this.crossOrigin );\r\n\t\tloader.setPath( this.path );\r\n\t\tloader.load( url, function ( image ) {\r\n\r\n\t\t\ttexture.image = image;\r\n\t\t\ttexture.needsUpdate = true;\r\n\r\n\t\t\tif ( onLoad !== undefined ) {\r\n\r\n\t\t\t\tonLoad( texture );\r\n\r\n\t\t\t}\r\n\r\n\t\t}, onProgress, onError );\r\n\r\n\t\treturn texture;\r\n\r\n\t},\r\n\r\n\tsetCrossOrigin: function ( value ) {\r\n\r\n\t\tthis.crossOrigin = value;\r\n\r\n\t},\r\n\r\n\tsetPath: function ( value ) {\r\n\r\n\t\tthis.path = value;\r\n\r\n\t}\r\n\r\n};\r\n\r\n// File:src/loaders/CubeTextureLoader.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.CubeTextureLoader = function ( manager ) {\r\n\r\n\tthis.manager = ( manager !== undefined ) ? manager : THREE.DefaultLoadingManager;\r\n\r\n};\r\n\r\nTHREE.CubeTextureLoader.prototype = {\r\n\r\n\tconstructor: THREE.CubeTextureLoader,\r\n\r\n\tload: function ( urls, onLoad, onProgress, onError ) {\r\n\r\n\t\tvar texture = new THREE.CubeTexture();\r\n\r\n\t\tvar loader = new THREE.ImageLoader( this.manager );\r\n\t\tloader.setCrossOrigin( this.crossOrigin );\r\n\t\tloader.setPath( this.path );\r\n\r\n\t\tvar loaded = 0;\r\n\r\n\t\tfunction loadTexture( i ) {\r\n\r\n\t\t\tloader.load( urls[ i ], function ( image ) {\r\n\r\n\t\t\t\ttexture.images[ i ] = image;\r\n\r\n\t\t\t\tloaded ++;\r\n\r\n\t\t\t\tif ( loaded === 6 ) {\r\n\r\n\t\t\t\t\ttexture.needsUpdate = true;\r\n\r\n\t\t\t\t\tif ( onLoad ) onLoad( texture );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}, undefined, onError );\r\n\r\n\t\t}\r\n\r\n\t\tfor ( var i = 0; i < urls.length; ++ i ) {\r\n\r\n\t\t\tloadTexture( i );\r\n\r\n\t\t}\r\n\r\n\t\treturn texture;\r\n\r\n\t},\r\n\r\n\tsetCrossOrigin: function ( value ) {\r\n\r\n\t\tthis.crossOrigin = value;\r\n\r\n\t},\r\n\r\n\tsetPath: function ( value ) {\r\n\r\n\t\tthis.path = value;\r\n\r\n\t}\r\n\r\n};\r\n\r\n// File:src/loaders/BinaryTextureLoader.js\r\n\r\n/**\r\n * @author Nikos M. / https://github.com/foo123/\r\n *\r\n * Abstract Base class to load generic binary textures formats (rgbe, hdr, ...)\r\n */\r\n\r\nTHREE.DataTextureLoader = THREE.BinaryTextureLoader = function ( manager ) {\r\n\r\n\tthis.manager = ( manager !== undefined ) ? manager : THREE.DefaultLoadingManager;\r\n\r\n\t// override in sub classes\r\n\tthis._parser = null;\r\n\r\n};\r\n\r\nTHREE.BinaryTextureLoader.prototype = {\r\n\r\n\tconstructor: THREE.BinaryTextureLoader,\r\n\r\n\tload: function ( url, onLoad, onProgress, onError ) {\r\n\r\n\t\tvar scope = this;\r\n\r\n\t\tvar texture = new THREE.DataTexture();\r\n\r\n\t\tvar loader = new THREE.XHRLoader( this.manager );\r\n\t\tloader.setResponseType( 'arraybuffer' );\r\n\r\n\t\tloader.load( url, function ( buffer ) {\r\n\r\n\t\t\tvar texData = scope._parser( buffer );\r\n\r\n\t\t\tif ( ! texData ) return;\r\n\r\n\t\t\tif ( undefined !== texData.image ) {\r\n\r\n\t\t\t\ttexture.image = texData.image;\r\n\r\n\t\t\t} else if ( undefined !== texData.data ) {\r\n\r\n\t\t\t\ttexture.image.width = texData.width;\r\n\t\t\t\ttexture.image.height = texData.height;\r\n\t\t\t\ttexture.image.data = texData.data;\r\n\r\n\t\t\t}\r\n\r\n\t\t\ttexture.wrapS = undefined !== texData.wrapS ? texData.wrapS : THREE.ClampToEdgeWrapping;\r\n\t\t\ttexture.wrapT = undefined !== texData.wrapT ? texData.wrapT : THREE.ClampToEdgeWrapping;\r\n\r\n\t\t\ttexture.magFilter = undefined !== texData.magFilter ? texData.magFilter : THREE.LinearFilter;\r\n\t\t\ttexture.minFilter = undefined !== texData.minFilter ? texData.minFilter : THREE.LinearMipMapLinearFilter;\r\n\r\n\t\t\ttexture.anisotropy = undefined !== texData.anisotropy ? texData.anisotropy : 1;\r\n\r\n\t\t\tif ( undefined !== texData.format ) {\r\n\r\n\t\t\t\ttexture.format = texData.format;\r\n\r\n\t\t\t}\r\n\t\t\tif ( undefined !== texData.type ) {\r\n\r\n\t\t\t\ttexture.type = texData.type;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( undefined !== texData.mipmaps ) {\r\n\r\n\t\t\t\ttexture.mipmaps = texData.mipmaps;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( 1 === texData.mipmapCount ) {\r\n\r\n\t\t\t\ttexture.minFilter = THREE.LinearFilter;\r\n\r\n\t\t\t}\r\n\r\n\t\t\ttexture.needsUpdate = true;\r\n\r\n\t\t\tif ( onLoad ) onLoad( texture, texData );\r\n\r\n\t\t}, onProgress, onError );\r\n\r\n\r\n\t\treturn texture;\r\n\r\n\t}\r\n\r\n};\r\n\r\n// File:src/loaders/CompressedTextureLoader.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n *\r\n * Abstract Base class to block based textures loader (dds, pvr, ...)\r\n */\r\n\r\nTHREE.CompressedTextureLoader = function ( manager ) {\r\n\r\n\tthis.manager = ( manager !== undefined ) ? manager : THREE.DefaultLoadingManager;\r\n\r\n\t// override in sub classes\r\n\tthis._parser = null;\r\n\r\n};\r\n\r\n\r\nTHREE.CompressedTextureLoader.prototype = {\r\n\r\n\tconstructor: THREE.CompressedTextureLoader,\r\n\r\n\tload: function ( url, onLoad, onProgress, onError ) {\r\n\r\n\t\tvar scope = this;\r\n\r\n\t\tvar images = [];\r\n\r\n\t\tvar texture = new THREE.CompressedTexture();\r\n\t\ttexture.image = images;\r\n\r\n\t\tvar loader = new THREE.XHRLoader( this.manager );\r\n\t\tloader.setPath( this.path );\r\n\t\tloader.setResponseType( 'arraybuffer' );\r\n\r\n\t\tfunction loadTexture( i ) {\r\n\r\n\t\t\tloader.load( url[ i ], function ( buffer ) {\r\n\r\n\t\t\t\tvar texDatas = scope._parser( buffer, true );\r\n\r\n\t\t\t\timages[ i ] = {\r\n\t\t\t\t\twidth: texDatas.width,\r\n\t\t\t\t\theight: texDatas.height,\r\n\t\t\t\t\tformat: texDatas.format,\r\n\t\t\t\t\tmipmaps: texDatas.mipmaps\r\n\t\t\t\t};\r\n\r\n\t\t\t\tloaded += 1;\r\n\r\n\t\t\t\tif ( loaded === 6 ) {\r\n\r\n\t\t\t\t\tif ( texDatas.mipmapCount === 1 )\r\n\t\t\t\t\t\ttexture.minFilter = THREE.LinearFilter;\r\n\r\n\t\t\t\t\ttexture.format = texDatas.format;\r\n\t\t\t\t\ttexture.needsUpdate = true;\r\n\r\n\t\t\t\t\tif ( onLoad ) onLoad( texture );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}, onProgress, onError );\r\n\r\n\t\t}\r\n\r\n\t\tif ( Array.isArray( url ) ) {\r\n\r\n\t\t\tvar loaded = 0;\r\n\r\n\t\t\tfor ( var i = 0, il = url.length; i < il; ++ i ) {\r\n\r\n\t\t\t\tloadTexture( i );\r\n\r\n\t\t\t}\r\n\r\n\t\t} else {\r\n\r\n\t\t\t// compressed cubemap texture stored in a single DDS file\r\n\r\n\t\t\tloader.load( url, function ( buffer ) {\r\n\r\n\t\t\t\tvar texDatas = scope._parser( buffer, true );\r\n\r\n\t\t\t\tif ( texDatas.isCubemap ) {\r\n\r\n\t\t\t\t\tvar faces = texDatas.mipmaps.length / texDatas.mipmapCount;\r\n\r\n\t\t\t\t\tfor ( var f = 0; f < faces; f ++ ) {\r\n\r\n\t\t\t\t\t\timages[ f ] = { mipmaps : [] };\r\n\r\n\t\t\t\t\t\tfor ( var i = 0; i < texDatas.mipmapCount; i ++ ) {\r\n\r\n\t\t\t\t\t\t\timages[ f ].mipmaps.push( texDatas.mipmaps[ f * texDatas.mipmapCount + i ] );\r\n\t\t\t\t\t\t\timages[ f ].format = texDatas.format;\r\n\t\t\t\t\t\t\timages[ f ].width = texDatas.width;\r\n\t\t\t\t\t\t\timages[ f ].height = texDatas.height;\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\ttexture.image.width = texDatas.width;\r\n\t\t\t\t\ttexture.image.height = texDatas.height;\r\n\t\t\t\t\ttexture.mipmaps = texDatas.mipmaps;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( texDatas.mipmapCount === 1 ) {\r\n\r\n\t\t\t\t\ttexture.minFilter = THREE.LinearFilter;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\ttexture.format = texDatas.format;\r\n\t\t\t\ttexture.needsUpdate = true;\r\n\r\n\t\t\t\tif ( onLoad ) onLoad( texture );\r\n\r\n\t\t\t}, onProgress, onError );\r\n\r\n\t\t}\r\n\r\n\t\treturn texture;\r\n\r\n\t},\r\n\r\n\tsetPath: function ( value ) {\r\n\r\n\t\tthis.path = value;\r\n\r\n\t}\r\n\r\n};\r\n\r\n// File:src/materials/Material.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author alteredq / http://alteredqualia.com/\r\n */\r\n\r\nTHREE.Material = function () {\r\n\r\n\tObject.defineProperty( this, 'id', { value: THREE.MaterialIdCount ++ } );\r\n\r\n\tthis.uuid = THREE.Math.generateUUID();\r\n\r\n\tthis.name = '';\r\n\tthis.type = 'Material';\r\n\r\n\tthis.side = THREE.FrontSide;\r\n\r\n\tthis.opacity = 1;\r\n\tthis.transparent = false;\r\n\r\n\tthis.blending = THREE.NormalBlending;\r\n\r\n\tthis.blendSrc = THREE.SrcAlphaFactor;\r\n\tthis.blendDst = THREE.OneMinusSrcAlphaFactor;\r\n\tthis.blendEquation = THREE.AddEquation;\r\n\tthis.blendSrcAlpha = null;\r\n\tthis.blendDstAlpha = null;\r\n\tthis.blendEquationAlpha = null;\r\n\r\n\tthis.depthFunc = THREE.LessEqualDepth;\r\n\tthis.depthTest = true;\r\n\tthis.depthWrite = true;\r\n\r\n\tthis.clippingPlanes = null;\r\n\tthis.clipShadows = false;\r\n\r\n\tthis.colorWrite = true;\r\n\r\n\tthis.precision = null; // override the renderer's default precision for this material\r\n\r\n\tthis.polygonOffset = false;\r\n\tthis.polygonOffsetFactor = 0;\r\n\tthis.polygonOffsetUnits = 0;\r\n\r\n\tthis.alphaTest = 0;\r\n\tthis.premultipliedAlpha = false;\r\n\r\n\tthis.overdraw = 0; // Overdrawn pixels (typically between 0 and 1) for fixing antialiasing gaps in CanvasRenderer\r\n\r\n\tthis.visible = true;\r\n\r\n\tthis._needsUpdate = true;\r\n\r\n};\r\n\r\nTHREE.Material.prototype = {\r\n\r\n\tconstructor: THREE.Material,\r\n\r\n\tget needsUpdate () {\r\n\r\n\t\treturn this._needsUpdate;\r\n\r\n\t},\r\n\r\n\tset needsUpdate ( value ) {\r\n\r\n\t\tif ( value === true ) this.update();\r\n\r\n\t\tthis._needsUpdate = value;\r\n\r\n\t},\r\n\r\n\tsetValues: function ( values ) {\r\n\r\n\t\tif ( values === undefined ) return;\r\n\r\n\t\tfor ( var key in values ) {\r\n\r\n\t\t\tvar newValue = values[ key ];\r\n\r\n\t\t\tif ( newValue === undefined ) {\r\n\r\n\t\t\t\tconsole.warn( \"THREE.Material: '\" + key + \"' parameter is undefined.\" );\r\n\t\t\t\tcontinue;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar currentValue = this[ key ];\r\n\r\n\t\t\tif ( currentValue === undefined ) {\r\n\r\n\t\t\t\tconsole.warn( \"THREE.\" + this.type + \": '\" + key + \"' is not a property of this material.\" );\r\n\t\t\t\tcontinue;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( currentValue instanceof THREE.Color ) {\r\n\r\n\t\t\t\tcurrentValue.set( newValue );\r\n\r\n\t\t\t} else if ( currentValue instanceof THREE.Vector3 && newValue instanceof THREE.Vector3 ) {\r\n\r\n\t\t\t\tcurrentValue.copy( newValue );\r\n\r\n\t\t\t} else if ( key === 'overdraw' ) {\r\n\r\n\t\t\t\t// ensure overdraw is backwards-compatible with legacy boolean type\r\n\t\t\t\tthis[ key ] = Number( newValue );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tthis[ key ] = newValue;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t},\r\n\r\n\ttoJSON: function ( meta ) {\r\n\r\n\t\tvar isRoot = meta === undefined;\r\n\r\n\t\tif ( isRoot ) {\r\n\r\n\t\t\tmeta = {\r\n\t\t\t\ttextures: {},\r\n\t\t\t\timages: {}\r\n\t\t\t};\r\n\r\n\t\t}\r\n\r\n\t\tvar data = {\r\n\t\t\tmetadata: {\r\n\t\t\t\tversion: 4.4,\r\n\t\t\t\ttype: 'Material',\r\n\t\t\t\tgenerator: 'Material.toJSON'\r\n\t\t\t}\r\n\t\t};\r\n\r\n\t\t// standard Material serialization\r\n\t\tdata.uuid = this.uuid;\r\n\t\tdata.type = this.type;\r\n\t\tif ( this.name !== '' ) data.name = this.name;\r\n\r\n\t\tif ( this.color instanceof THREE.Color ) data.color = this.color.getHex();\r\n\r\n\t\tif ( this.roughness !== 0.5 ) data.roughness = this.roughness;\r\n\t\tif ( this.metalness !== 0.5 ) data.metalness = this.metalness;\r\n\r\n\t\tif ( this.emissive instanceof THREE.Color ) data.emissive = this.emissive.getHex();\r\n\t\tif ( this.specular instanceof THREE.Color ) data.specular = this.specular.getHex();\r\n\t\tif ( this.shininess !== undefined ) data.shininess = this.shininess;\r\n\r\n\t\tif ( this.map instanceof THREE.Texture ) data.map = this.map.toJSON( meta ).uuid;\r\n\t\tif ( this.alphaMap instanceof THREE.Texture ) data.alphaMap = this.alphaMap.toJSON( meta ).uuid;\r\n\t\tif ( this.lightMap instanceof THREE.Texture ) data.lightMap = this.lightMap.toJSON( meta ).uuid;\r\n\t\tif ( this.bumpMap instanceof THREE.Texture ) {\r\n\r\n\t\t\tdata.bumpMap = this.bumpMap.toJSON( meta ).uuid;\r\n\t\t\tdata.bumpScale = this.bumpScale;\r\n\r\n\t\t}\r\n\t\tif ( this.normalMap instanceof THREE.Texture ) {\r\n\r\n\t\t\tdata.normalMap = this.normalMap.toJSON( meta ).uuid;\r\n\t\t\tdata.normalScale = this.normalScale.toArray();\r\n\r\n\t\t}\r\n\t\tif ( this.displacementMap instanceof THREE.Texture ) {\r\n\r\n\t\t\tdata.displacementMap = this.displacementMap.toJSON( meta ).uuid;\r\n\t\t\tdata.displacementScale = this.displacementScale;\r\n\t\t\tdata.displacementBias = this.displacementBias;\r\n\r\n\t\t}\r\n\t\tif ( this.roughnessMap instanceof THREE.Texture ) data.roughnessMap = this.roughnessMap.toJSON( meta ).uuid;\r\n\t\tif ( this.metalnessMap instanceof THREE.Texture ) data.metalnessMap = this.metalnessMap.toJSON( meta ).uuid;\r\n\r\n\t\tif ( this.emissiveMap instanceof THREE.Texture ) data.emissiveMap = this.emissiveMap.toJSON( meta ).uuid;\r\n\t\tif ( this.specularMap instanceof THREE.Texture ) data.specularMap = this.specularMap.toJSON( meta ).uuid;\r\n\r\n\t\tif ( this.envMap instanceof THREE.Texture ) {\r\n\r\n\t\t\tdata.envMap = this.envMap.toJSON( meta ).uuid;\r\n\t\t\tdata.reflectivity = this.reflectivity; // Scale behind envMap\r\n\r\n\t\t}\r\n\r\n\t\tif ( this.size !== undefined ) data.size = this.size;\r\n\t\tif ( this.sizeAttenuation !== undefined ) data.sizeAttenuation = this.sizeAttenuation;\r\n\r\n\t\tif ( this.vertexColors !== undefined && this.vertexColors !== THREE.NoColors ) data.vertexColors = this.vertexColors;\r\n\t\tif ( this.shading !== undefined && this.shading !== THREE.SmoothShading ) data.shading = this.shading;\r\n\t\tif ( this.blending !== undefined && this.blending !== THREE.NormalBlending ) data.blending = this.blending;\r\n\t\tif ( this.side !== undefined && this.side !== THREE.FrontSide ) data.side = this.side;\r\n\r\n\t\tif ( this.opacity < 1 ) data.opacity = this.opacity;\r\n\t\tif ( this.transparent === true ) data.transparent = this.transparent;\r\n\t\tif ( this.alphaTest > 0 ) data.alphaTest = this.alphaTest;\r\n\t\tif ( this.premultipliedAlpha === true ) data.premultipliedAlpha = this.premultipliedAlpha;\r\n\t\tif ( this.wireframe === true ) data.wireframe = this.wireframe;\r\n\t\tif ( this.wireframeLinewidth > 1 ) data.wireframeLinewidth = this.wireframeLinewidth;\r\n\r\n\t\t// TODO: Copied from Object3D.toJSON\r\n\r\n\t\tfunction extractFromCache ( cache ) {\r\n\r\n\t\t\tvar values = [];\r\n\r\n\t\t\tfor ( var key in cache ) {\r\n\r\n\t\t\t\tvar data = cache[ key ];\r\n\t\t\t\tdelete data.metadata;\r\n\t\t\t\tvalues.push( data );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn values;\r\n\r\n\t\t}\r\n\r\n\t\tif ( isRoot ) {\r\n\r\n\t\t\tvar textures = extractFromCache( meta.textures );\r\n\t\t\tvar images = extractFromCache( meta.images );\r\n\r\n\t\t\tif ( textures.length > 0 ) data.textures = textures;\r\n\t\t\tif ( images.length > 0 ) data.images = images;\r\n\r\n\t\t}\r\n\r\n\t\treturn data;\r\n\r\n\t},\r\n\r\n\tclone: function () {\r\n\r\n\t\treturn new this.constructor().copy( this );\r\n\r\n\t},\r\n\r\n\tcopy: function ( source ) {\r\n\r\n\t\tthis.name = source.name;\r\n\r\n\t\tthis.side = source.side;\r\n\r\n\t\tthis.opacity = source.opacity;\r\n\t\tthis.transparent = source.transparent;\r\n\r\n\t\tthis.blending = source.blending;\r\n\r\n\t\tthis.blendSrc = source.blendSrc;\r\n\t\tthis.blendDst = source.blendDst;\r\n\t\tthis.blendEquation = source.blendEquation;\r\n\t\tthis.blendSrcAlpha = source.blendSrcAlpha;\r\n\t\tthis.blendDstAlpha = source.blendDstAlpha;\r\n\t\tthis.blendEquationAlpha = source.blendEquationAlpha;\r\n\r\n\t\tthis.depthFunc = source.depthFunc;\r\n\t\tthis.depthTest = source.depthTest;\r\n\t\tthis.depthWrite = source.depthWrite;\r\n\r\n\t\tthis.colorWrite = source.colorWrite;\r\n\r\n\t\tthis.precision = source.precision;\r\n\r\n\t\tthis.polygonOffset = source.polygonOffset;\r\n\t\tthis.polygonOffsetFactor = source.polygonOffsetFactor;\r\n\t\tthis.polygonOffsetUnits = source.polygonOffsetUnits;\r\n\r\n\t\tthis.alphaTest = source.alphaTest;\r\n\r\n\t\tthis.premultipliedAlpha = source.premultipliedAlpha;\r\n\r\n\t\tthis.overdraw = source.overdraw;\r\n\r\n\t\tthis.visible = source.visible;\r\n\t\tthis.clipShadows = source.clipShadows;\r\n\r\n\t\tvar srcPlanes = source.clippingPlanes,\r\n\t\t\tdstPlanes = null;\r\n\r\n\t\tif ( srcPlanes !== null ) {\r\n\r\n\t\t\tvar n = srcPlanes.length;\r\n\t\t\tdstPlanes = new Array( n );\r\n\r\n\t\t\tfor ( var i = 0; i !== n; ++ i )\r\n\t\t\t\tdstPlanes[ i ] = srcPlanes[ i ].clone();\r\n\r\n\t\t}\r\n\r\n\t\tthis.clippingPlanes = dstPlanes;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tupdate: function () {\r\n\r\n\t\tthis.dispatchEvent( { type: 'update' } );\r\n\r\n\t},\r\n\r\n\tdispose: function () {\r\n\r\n\t\tthis.dispatchEvent( { type: 'dispose' } );\r\n\r\n\t}\r\n\r\n};\r\n\r\nTHREE.EventDispatcher.prototype.apply( THREE.Material.prototype );\r\n\r\nTHREE.MaterialIdCount = 0;\r\n\r\n// File:src/materials/LineBasicMaterial.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author alteredq / http://alteredqualia.com/\r\n *\r\n * parameters = {\r\n *  color: <hex>,\r\n *  opacity: <float>,\r\n *\r\n *  linewidth: <float>,\r\n *  linecap: \"round\",\r\n *  linejoin: \"round\",\r\n *\r\n *  blending: THREE.NormalBlending,\r\n *  depthTest: <bool>,\r\n *  depthWrite: <bool>,\r\n *\r\n *  vertexColors: <bool>\r\n *\r\n *  fog: <bool>\r\n * }\r\n */\r\n\r\nTHREE.LineBasicMaterial = function ( parameters ) {\r\n\r\n\tTHREE.Material.call( this );\r\n\r\n\tthis.type = 'LineBasicMaterial';\r\n\r\n\tthis.color = new THREE.Color( 0xffffff );\r\n\r\n\tthis.linewidth = 1;\r\n\tthis.linecap = 'round';\r\n\tthis.linejoin = 'round';\r\n\r\n\tthis.blending = THREE.NormalBlending;\r\n\r\n\tthis.vertexColors = THREE.NoColors;\r\n\r\n\tthis.fog = true;\r\n\r\n\tthis.setValues( parameters );\r\n\r\n};\r\n\r\nTHREE.LineBasicMaterial.prototype = Object.create( THREE.Material.prototype );\r\nTHREE.LineBasicMaterial.prototype.constructor = THREE.LineBasicMaterial;\r\n\r\nTHREE.LineBasicMaterial.prototype.copy = function ( source ) {\r\n\r\n\tTHREE.Material.prototype.copy.call( this, source );\r\n\r\n\tthis.color.copy( source.color );\r\n\r\n\tthis.linewidth = source.linewidth;\r\n\tthis.linecap = source.linecap;\r\n\tthis.linejoin = source.linejoin;\r\n\r\n\tthis.vertexColors = source.vertexColors;\r\n\r\n\tthis.fog = source.fog;\r\n\r\n\treturn this;\r\n\r\n};\r\n\r\n// File:src/materials/LineDashedMaterial.js\r\n\r\n/**\r\n * @author alteredq / http://alteredqualia.com/\r\n *\r\n * parameters = {\r\n *  color: <hex>,\r\n *  opacity: <float>,\r\n *\r\n *  linewidth: <float>,\r\n *\r\n *  scale: <float>,\r\n *  dashSize: <float>,\r\n *  gapSize: <float>,\r\n *\r\n *  blending: THREE.NormalBlending,\r\n *  depthTest: <bool>,\r\n *  depthWrite: <bool>,\r\n *\r\n *  vertexColors: THREE.NoColors / THREE.FaceColors / THREE.VertexColors\r\n *\r\n *  fog: <bool>\r\n * }\r\n */\r\n\r\nTHREE.LineDashedMaterial = function ( parameters ) {\r\n\r\n\tTHREE.Material.call( this );\r\n\r\n\tthis.type = 'LineDashedMaterial';\r\n\r\n\tthis.color = new THREE.Color( 0xffffff );\r\n\r\n\tthis.linewidth = 1;\r\n\r\n\tthis.scale = 1;\r\n\tthis.dashSize = 3;\r\n\tthis.gapSize = 1;\r\n\r\n\tthis.blending = THREE.NormalBlending;\r\n\r\n\tthis.vertexColors = THREE.NoColors;\r\n\r\n\tthis.fog = true;\r\n\r\n\tthis.setValues( parameters );\r\n\r\n};\r\n\r\nTHREE.LineDashedMaterial.prototype = Object.create( THREE.Material.prototype );\r\nTHREE.LineDashedMaterial.prototype.constructor = THREE.LineDashedMaterial;\r\n\r\nTHREE.LineDashedMaterial.prototype.copy = function ( source ) {\r\n\r\n\tTHREE.Material.prototype.copy.call( this, source );\r\n\r\n\tthis.color.copy( source.color );\r\n\r\n\tthis.linewidth = source.linewidth;\r\n\r\n\tthis.scale = source.scale;\r\n\tthis.dashSize = source.dashSize;\r\n\tthis.gapSize = source.gapSize;\r\n\r\n\tthis.vertexColors = source.vertexColors;\r\n\r\n\tthis.fog = source.fog;\r\n\r\n\treturn this;\r\n\r\n};\r\n\r\n// File:src/materials/MeshBasicMaterial.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author alteredq / http://alteredqualia.com/\r\n *\r\n * parameters = {\r\n *  color: <hex>,\r\n *  opacity: <float>,\r\n *  map: new THREE.Texture( <Image> ),\r\n *\r\n *  aoMap: new THREE.Texture( <Image> ),\r\n *  aoMapIntensity: <float>\r\n *\r\n *  specularMap: new THREE.Texture( <Image> ),\r\n *\r\n *  alphaMap: new THREE.Texture( <Image> ),\r\n *\r\n *  envMap: new THREE.TextureCube( [posx, negx, posy, negy, posz, negz] ),\r\n *  combine: THREE.Multiply,\r\n *  reflectivity: <float>,\r\n *  refractionRatio: <float>,\r\n *\r\n *  shading: THREE.SmoothShading,\r\n *  blending: THREE.NormalBlending,\r\n *  depthTest: <bool>,\r\n *  depthWrite: <bool>,\r\n *\r\n *  wireframe: <boolean>,\r\n *  wireframeLinewidth: <float>,\r\n *\r\n *  vertexColors: THREE.NoColors / THREE.VertexColors / THREE.FaceColors,\r\n *\r\n *  skinning: <bool>,\r\n *  morphTargets: <bool>,\r\n *\r\n *  fog: <bool>\r\n * }\r\n */\r\n\r\nTHREE.MeshBasicMaterial = function ( parameters ) {\r\n\r\n\tTHREE.Material.call( this );\r\n\r\n\tthis.type = 'MeshBasicMaterial';\r\n\r\n\tthis.color = new THREE.Color( 0xffffff ); // emissive\r\n\r\n\tthis.map = null;\r\n\r\n\tthis.aoMap = null;\r\n\tthis.aoMapIntensity = 1.0;\r\n\r\n\tthis.specularMap = null;\r\n\r\n\tthis.alphaMap = null;\r\n\r\n\tthis.envMap = null;\r\n\tthis.combine = THREE.MultiplyOperation;\r\n\tthis.reflectivity = 1;\r\n\tthis.refractionRatio = 0.98;\r\n\r\n\tthis.fog = true;\r\n\r\n\tthis.shading = THREE.SmoothShading;\r\n\tthis.blending = THREE.NormalBlending;\r\n\r\n\tthis.wireframe = false;\r\n\tthis.wireframeLinewidth = 1;\r\n\tthis.wireframeLinecap = 'round';\r\n\tthis.wireframeLinejoin = 'round';\r\n\r\n\tthis.vertexColors = THREE.NoColors;\r\n\r\n\tthis.skinning = false;\r\n\tthis.morphTargets = false;\r\n\r\n\tthis.setValues( parameters );\r\n\r\n};\r\n\r\nTHREE.MeshBasicMaterial.prototype = Object.create( THREE.Material.prototype );\r\nTHREE.MeshBasicMaterial.prototype.constructor = THREE.MeshBasicMaterial;\r\n\r\nTHREE.MeshBasicMaterial.prototype.copy = function ( source ) {\r\n\r\n\tTHREE.Material.prototype.copy.call( this, source );\r\n\r\n\tthis.color.copy( source.color );\r\n\r\n\tthis.map = source.map;\r\n\r\n\tthis.aoMap = source.aoMap;\r\n\tthis.aoMapIntensity = source.aoMapIntensity;\r\n\r\n\tthis.specularMap = source.specularMap;\r\n\r\n\tthis.alphaMap = source.alphaMap;\r\n\r\n\tthis.envMap = source.envMap;\r\n\tthis.combine = source.combine;\r\n\tthis.reflectivity = source.reflectivity;\r\n\tthis.refractionRatio = source.refractionRatio;\r\n\r\n\tthis.fog = source.fog;\r\n\r\n\tthis.shading = source.shading;\r\n\r\n\tthis.wireframe = source.wireframe;\r\n\tthis.wireframeLinewidth = source.wireframeLinewidth;\r\n\tthis.wireframeLinecap = source.wireframeLinecap;\r\n\tthis.wireframeLinejoin = source.wireframeLinejoin;\r\n\r\n\tthis.vertexColors = source.vertexColors;\r\n\r\n\tthis.skinning = source.skinning;\r\n\tthis.morphTargets = source.morphTargets;\r\n\r\n\treturn this;\r\n\r\n};\r\n\r\n// File:src/materials/MeshDepthMaterial.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author alteredq / http://alteredqualia.com/\r\n * @author bhouston / https://clara.io\r\n * @author WestLangley / http://github.com/WestLangley\r\n *\r\n * parameters = {\r\n *\r\n *  opacity: <float>,\r\n *\r\n *  map: new THREE.Texture( <Image> ),\r\n *\r\n *  alphaMap: new THREE.Texture( <Image> ),\r\n *\r\n *  displacementMap: new THREE.Texture( <Image> ),\r\n *  displacementScale: <float>,\r\n *  displacementBias: <float>,\r\n *\r\n *  wireframe: <boolean>,\r\n *  wireframeLinewidth: <float>\r\n * }\r\n */\r\n\r\nTHREE.MeshDepthMaterial = function ( parameters ) {\r\n\r\n\tTHREE.Material.call( this );\r\n\r\n\tthis.type = 'MeshDepthMaterial';\r\n\r\n\tthis.depthPacking = THREE.BasicDepthPacking;\r\n\r\n\tthis.skinning = false;\r\n\tthis.morphTargets = false;\r\n\r\n\tthis.map = null;\r\n\r\n\tthis.alphaMap = null;\r\n\r\n\tthis.displacementMap = null;\r\n\tthis.displacementScale = 1;\r\n\tthis.displacementBias = 0;\r\n\r\n\tthis.wireframe = false;\r\n\tthis.wireframeLinewidth = 1;\r\n\r\n\tthis.setValues( parameters );\r\n\r\n};\r\n\r\nTHREE.MeshDepthMaterial.prototype = Object.create( THREE.Material.prototype );\r\nTHREE.MeshDepthMaterial.prototype.constructor = THREE.MeshDepthMaterial;\r\n\r\nTHREE.MeshDepthMaterial.prototype.copy = function ( source ) {\r\n\r\n\tTHREE.Material.prototype.copy.call( this, source );\r\n\r\n\tthis.depthPacking = source.depthPacking;\r\n\r\n\tthis.skinning = source.skinning;\r\n\tthis.morphTargets = source.morphTargets;\r\n\r\n\tthis.map = source.map;\r\n\r\n\tthis.alphaMap = source.alphaMap;\r\n\r\n\tthis.displacementMap = source.displacementMap;\r\n\tthis.displacementScale = source.displacementScale;\r\n\tthis.displacementBias = source.displacementBias;\r\n\r\n\tthis.wireframe = source.wireframe;\r\n\tthis.wireframeLinewidth = source.wireframeLinewidth;\r\n\r\n\treturn this;\r\n\r\n};\r\n\r\n// File:src/materials/MeshLambertMaterial.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author alteredq / http://alteredqualia.com/\r\n *\r\n * parameters = {\r\n *  color: <hex>,\r\n *  opacity: <float>,\r\n *\r\n *  map: new THREE.Texture( <Image> ),\r\n *\r\n *  lightMap: new THREE.Texture( <Image> ),\r\n *  lightMapIntensity: <float>\r\n *\r\n *  aoMap: new THREE.Texture( <Image> ),\r\n *  aoMapIntensity: <float>\r\n *\r\n *  emissive: <hex>,\r\n *  emissiveIntensity: <float>\r\n *  emissiveMap: new THREE.Texture( <Image> ),\r\n *\r\n *  specularMap: new THREE.Texture( <Image> ),\r\n *\r\n *  alphaMap: new THREE.Texture( <Image> ),\r\n *\r\n *  envMap: new THREE.TextureCube( [posx, negx, posy, negy, posz, negz] ),\r\n *  combine: THREE.Multiply,\r\n *  reflectivity: <float>,\r\n *  refractionRatio: <float>,\r\n *\r\n *  blending: THREE.NormalBlending,\r\n *  depthTest: <bool>,\r\n *  depthWrite: <bool>,\r\n *\r\n *  wireframe: <boolean>,\r\n *  wireframeLinewidth: <float>,\r\n *\r\n *  vertexColors: THREE.NoColors / THREE.VertexColors / THREE.FaceColors,\r\n *\r\n *  skinning: <bool>,\r\n *  morphTargets: <bool>,\r\n *  morphNormals: <bool>,\r\n *\r\n *\tfog: <bool>\r\n * }\r\n */\r\n\r\nTHREE.MeshLambertMaterial = function ( parameters ) {\r\n\r\n\tTHREE.Material.call( this );\r\n\r\n\tthis.type = 'MeshLambertMaterial';\r\n\r\n\tthis.color = new THREE.Color( 0xffffff ); // diffuse\r\n\r\n\tthis.map = null;\r\n\r\n\tthis.lightMap = null;\r\n\tthis.lightMapIntensity = 1.0;\r\n\r\n\tthis.aoMap = null;\r\n\tthis.aoMapIntensity = 1.0;\r\n\r\n\tthis.emissive = new THREE.Color( 0x000000 );\r\n\tthis.emissiveIntensity = 1.0;\r\n\tthis.emissiveMap = null;\r\n\r\n\tthis.specularMap = null;\r\n\r\n\tthis.alphaMap = null;\r\n\r\n\tthis.envMap = null;\r\n\tthis.combine = THREE.MultiplyOperation;\r\n\tthis.reflectivity = 1;\r\n\tthis.refractionRatio = 0.98;\r\n\r\n\tthis.fog = true;\r\n\r\n\tthis.blending = THREE.NormalBlending;\r\n\r\n\tthis.wireframe = false;\r\n\tthis.wireframeLinewidth = 1;\r\n\tthis.wireframeLinecap = 'round';\r\n\tthis.wireframeLinejoin = 'round';\r\n\r\n\tthis.vertexColors = THREE.NoColors;\r\n\r\n\tthis.skinning = false;\r\n\tthis.morphTargets = false;\r\n\tthis.morphNormals = false;\r\n\r\n\tthis.setValues( parameters );\r\n\r\n};\r\n\r\nTHREE.MeshLambertMaterial.prototype = Object.create( THREE.Material.prototype );\r\nTHREE.MeshLambertMaterial.prototype.constructor = THREE.MeshLambertMaterial;\r\n\r\nTHREE.MeshLambertMaterial.prototype.copy = function ( source ) {\r\n\r\n\tTHREE.Material.prototype.copy.call( this, source );\r\n\r\n\tthis.color.copy( source.color );\r\n\r\n\tthis.map = source.map;\r\n\r\n\tthis.lightMap = source.lightMap;\r\n\tthis.lightMapIntensity = source.lightMapIntensity;\r\n\r\n\tthis.aoMap = source.aoMap;\r\n\tthis.aoMapIntensity = source.aoMapIntensity;\r\n\r\n\tthis.emissive.copy( source.emissive );\r\n\tthis.emissiveMap = source.emissiveMap;\r\n\tthis.emissiveIntensity = source.emissiveIntensity;\r\n\r\n\tthis.specularMap = source.specularMap;\r\n\r\n\tthis.alphaMap = source.alphaMap;\r\n\r\n\tthis.envMap = source.envMap;\r\n\tthis.combine = source.combine;\r\n\tthis.reflectivity = source.reflectivity;\r\n\tthis.refractionRatio = source.refractionRatio;\r\n\r\n\tthis.fog = source.fog;\r\n\r\n\tthis.wireframe = source.wireframe;\r\n\tthis.wireframeLinewidth = source.wireframeLinewidth;\r\n\tthis.wireframeLinecap = source.wireframeLinecap;\r\n\tthis.wireframeLinejoin = source.wireframeLinejoin;\r\n\r\n\tthis.vertexColors = source.vertexColors;\r\n\r\n\tthis.skinning = source.skinning;\r\n\tthis.morphTargets = source.morphTargets;\r\n\tthis.morphNormals = source.morphNormals;\r\n\r\n\treturn this;\r\n\r\n};\r\n\r\n// File:src/materials/MeshNormalMaterial.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n *\r\n * parameters = {\r\n *  opacity: <float>,\r\n *\r\n *  wireframe: <boolean>,\r\n *  wireframeLinewidth: <float>\r\n * }\r\n */\r\n\r\nTHREE.MeshNormalMaterial = function ( parameters ) {\r\n\r\n\tTHREE.Material.call( this, parameters );\r\n\r\n\tthis.type = 'MeshNormalMaterial';\r\n\r\n\tthis.wireframe = false;\r\n\tthis.wireframeLinewidth = 1;\r\n\r\n\tthis.morphTargets = false;\r\n\r\n\tthis.setValues( parameters );\r\n\r\n};\r\n\r\nTHREE.MeshNormalMaterial.prototype = Object.create( THREE.Material.prototype );\r\nTHREE.MeshNormalMaterial.prototype.constructor = THREE.MeshNormalMaterial;\r\n\r\nTHREE.MeshNormalMaterial.prototype.copy = function ( source ) {\r\n\r\n\tTHREE.Material.prototype.copy.call( this, source );\r\n\r\n\tthis.wireframe = source.wireframe;\r\n\tthis.wireframeLinewidth = source.wireframeLinewidth;\r\n\r\n\treturn this;\r\n\r\n};\r\n\r\n// File:src/materials/MeshPhongMaterial.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author alteredq / http://alteredqualia.com/\r\n *\r\n * parameters = {\r\n *  color: <hex>,\r\n *  specular: <hex>,\r\n *  shininess: <float>,\r\n *  opacity: <float>,\r\n *\r\n *  map: new THREE.Texture( <Image> ),\r\n *\r\n *  lightMap: new THREE.Texture( <Image> ),\r\n *  lightMapIntensity: <float>\r\n *\r\n *  aoMap: new THREE.Texture( <Image> ),\r\n *  aoMapIntensity: <float>\r\n *\r\n *  emissive: <hex>,\r\n *  emissiveIntensity: <float>\r\n *  emissiveMap: new THREE.Texture( <Image> ),\r\n *\r\n *  bumpMap: new THREE.Texture( <Image> ),\r\n *  bumpScale: <float>,\r\n *\r\n *  normalMap: new THREE.Texture( <Image> ),\r\n *  normalScale: <Vector2>,\r\n *\r\n *  displacementMap: new THREE.Texture( <Image> ),\r\n *  displacementScale: <float>,\r\n *  displacementBias: <float>,\r\n *\r\n *  specularMap: new THREE.Texture( <Image> ),\r\n *\r\n *  alphaMap: new THREE.Texture( <Image> ),\r\n *\r\n *  envMap: new THREE.TextureCube( [posx, negx, posy, negy, posz, negz] ),\r\n *  combine: THREE.Multiply,\r\n *  reflectivity: <float>,\r\n *  refractionRatio: <float>,\r\n *\r\n *  shading: THREE.SmoothShading,\r\n *  blending: THREE.NormalBlending,\r\n *  depthTest: <bool>,\r\n *  depthWrite: <bool>,\r\n *\r\n *  wireframe: <boolean>,\r\n *  wireframeLinewidth: <float>,\r\n *\r\n *  vertexColors: THREE.NoColors / THREE.VertexColors / THREE.FaceColors,\r\n *\r\n *  skinning: <bool>,\r\n *  morphTargets: <bool>,\r\n *  morphNormals: <bool>,\r\n *\r\n *\tfog: <bool>\r\n * }\r\n */\r\n\r\nTHREE.MeshPhongMaterial = function ( parameters ) {\r\n\r\n\tTHREE.Material.call( this );\r\n\r\n\tthis.type = 'MeshPhongMaterial';\r\n\r\n\tthis.color = new THREE.Color( 0xffffff ); // diffuse\r\n\tthis.specular = new THREE.Color( 0x111111 );\r\n\tthis.shininess = 30;\r\n\r\n\tthis.map = null;\r\n\r\n\tthis.lightMap = null;\r\n\tthis.lightMapIntensity = 1.0;\r\n\r\n\tthis.aoMap = null;\r\n\tthis.aoMapIntensity = 1.0;\r\n\r\n\tthis.emissive = new THREE.Color( 0x000000 );\r\n\tthis.emissiveIntensity = 1.0;\r\n\tthis.emissiveMap = null;\r\n\r\n\tthis.bumpMap = null;\r\n\tthis.bumpScale = 1;\r\n\r\n\tthis.normalMap = null;\r\n\tthis.normalScale = new THREE.Vector2( 1, 1 );\r\n\r\n\tthis.displacementMap = null;\r\n\tthis.displacementScale = 1;\r\n\tthis.displacementBias = 0;\r\n\r\n\tthis.specularMap = null;\r\n\r\n\tthis.alphaMap = null;\r\n\r\n\tthis.envMap = null;\r\n\tthis.combine = THREE.MultiplyOperation;\r\n\tthis.reflectivity = 1;\r\n\tthis.refractionRatio = 0.98;\r\n\r\n\tthis.fog = true;\r\n\r\n\tthis.shading = THREE.SmoothShading;\r\n\tthis.blending = THREE.NormalBlending;\r\n\r\n\tthis.wireframe = false;\r\n\tthis.wireframeLinewidth = 1;\r\n\tthis.wireframeLinecap = 'round';\r\n\tthis.wireframeLinejoin = 'round';\r\n\r\n\tthis.vertexColors = THREE.NoColors;\r\n\r\n\tthis.skinning = false;\r\n\tthis.morphTargets = false;\r\n\tthis.morphNormals = false;\r\n\r\n\tthis.setValues( parameters );\r\n\r\n};\r\n\r\nTHREE.MeshPhongMaterial.prototype = Object.create( THREE.Material.prototype );\r\nTHREE.MeshPhongMaterial.prototype.constructor = THREE.MeshPhongMaterial;\r\n\r\nTHREE.MeshPhongMaterial.prototype.copy = function ( source ) {\r\n\r\n\tTHREE.Material.prototype.copy.call( this, source );\r\n\r\n\tthis.color.copy( source.color );\r\n\tthis.specular.copy( source.specular );\r\n\tthis.shininess = source.shininess;\r\n\r\n\tthis.map = source.map;\r\n\r\n\tthis.lightMap = source.lightMap;\r\n\tthis.lightMapIntensity = source.lightMapIntensity;\r\n\r\n\tthis.aoMap = source.aoMap;\r\n\tthis.aoMapIntensity = source.aoMapIntensity;\r\n\r\n\tthis.emissive.copy( source.emissive );\r\n\tthis.emissiveMap = source.emissiveMap;\r\n\tthis.emissiveIntensity = source.emissiveIntensity;\r\n\r\n\tthis.bumpMap = source.bumpMap;\r\n\tthis.bumpScale = source.bumpScale;\r\n\r\n\tthis.normalMap = source.normalMap;\r\n\tthis.normalScale.copy( source.normalScale );\r\n\r\n\tthis.displacementMap = source.displacementMap;\r\n\tthis.displacementScale = source.displacementScale;\r\n\tthis.displacementBias = source.displacementBias;\r\n\r\n\tthis.specularMap = source.specularMap;\r\n\r\n\tthis.alphaMap = source.alphaMap;\r\n\r\n\tthis.envMap = source.envMap;\r\n\tthis.combine = source.combine;\r\n\tthis.reflectivity = source.reflectivity;\r\n\tthis.refractionRatio = source.refractionRatio;\r\n\r\n\tthis.fog = source.fog;\r\n\r\n\tthis.shading = source.shading;\r\n\r\n\tthis.wireframe = source.wireframe;\r\n\tthis.wireframeLinewidth = source.wireframeLinewidth;\r\n\tthis.wireframeLinecap = source.wireframeLinecap;\r\n\tthis.wireframeLinejoin = source.wireframeLinejoin;\r\n\r\n\tthis.vertexColors = source.vertexColors;\r\n\r\n\tthis.skinning = source.skinning;\r\n\tthis.morphTargets = source.morphTargets;\r\n\tthis.morphNormals = source.morphNormals;\r\n\r\n\treturn this;\r\n\r\n};\r\n\r\n// File:src/materials/MeshStandardMaterial.js\r\n\r\n/**\r\n * @author WestLangley / http://github.com/WestLangley\r\n *\r\n * parameters = {\r\n *  color: <hex>,\r\n *  roughness: <float>,\r\n *  metalness: <float>,\r\n *  opacity: <float>,\r\n *\r\n *  map: new THREE.Texture( <Image> ),\r\n *\r\n *  lightMap: new THREE.Texture( <Image> ),\r\n *  lightMapIntensity: <float>\r\n *\r\n *  aoMap: new THREE.Texture( <Image> ),\r\n *  aoMapIntensity: <float>\r\n *\r\n *  emissive: <hex>,\r\n *  emissiveIntensity: <float>\r\n *  emissiveMap: new THREE.Texture( <Image> ),\r\n *\r\n *  bumpMap: new THREE.Texture( <Image> ),\r\n *  bumpScale: <float>,\r\n *\r\n *  normalMap: new THREE.Texture( <Image> ),\r\n *  normalScale: <Vector2>,\r\n *\r\n *  displacementMap: new THREE.Texture( <Image> ),\r\n *  displacementScale: <float>,\r\n *  displacementBias: <float>,\r\n *\r\n *  roughnessMap: new THREE.Texture( <Image> ),\r\n *\r\n *  metalnessMap: new THREE.Texture( <Image> ),\r\n *\r\n *  alphaMap: new THREE.Texture( <Image> ),\r\n *\r\n *  envMap: new THREE.CubeTexture( [posx, negx, posy, negy, posz, negz] ),\r\n *  envMapIntensity: <float>\r\n *\r\n *  refractionRatio: <float>,\r\n *\r\n *  shading: THREE.SmoothShading,\r\n *  blending: THREE.NormalBlending,\r\n *  depthTest: <bool>,\r\n *  depthWrite: <bool>,\r\n *\r\n *  wireframe: <boolean>,\r\n *  wireframeLinewidth: <float>,\r\n *\r\n *  vertexColors: THREE.NoColors / THREE.VertexColors / THREE.FaceColors,\r\n *\r\n *  skinning: <bool>,\r\n *  morphTargets: <bool>,\r\n *  morphNormals: <bool>,\r\n *\r\n *\tfog: <bool>\r\n * }\r\n */\r\n\r\nTHREE.MeshStandardMaterial = function ( parameters ) {\r\n\r\n\tTHREE.Material.call( this );\r\n\r\n\tthis.defines = { 'STANDARD': '' };\r\n\r\n\tthis.type = 'MeshStandardMaterial';\r\n\r\n\tthis.color = new THREE.Color( 0xffffff ); // diffuse\r\n\tthis.roughness = 0.5;\r\n\tthis.metalness = 0.5;\r\n\r\n\tthis.map = null;\r\n\r\n\tthis.lightMap = null;\r\n\tthis.lightMapIntensity = 1.0;\r\n\r\n\tthis.aoMap = null;\r\n\tthis.aoMapIntensity = 1.0;\r\n\r\n\tthis.emissive = new THREE.Color( 0x000000 );\r\n\tthis.emissiveIntensity = 1.0;\r\n\tthis.emissiveMap = null;\r\n\r\n\tthis.bumpMap = null;\r\n\tthis.bumpScale = 1;\r\n\r\n\tthis.normalMap = null;\r\n\tthis.normalScale = new THREE.Vector2( 1, 1 );\r\n\r\n\tthis.displacementMap = null;\r\n\tthis.displacementScale = 1;\r\n\tthis.displacementBias = 0;\r\n\r\n\tthis.roughnessMap = null;\r\n\r\n\tthis.metalnessMap = null;\r\n\r\n\tthis.alphaMap = null;\r\n\r\n\tthis.envMap = null;\r\n\tthis.envMapIntensity = 1.0;\r\n\r\n\tthis.refractionRatio = 0.98;\r\n\r\n\tthis.fog = true;\r\n\r\n\tthis.shading = THREE.SmoothShading;\r\n\tthis.blending = THREE.NormalBlending;\r\n\r\n\tthis.wireframe = false;\r\n\tthis.wireframeLinewidth = 1;\r\n\tthis.wireframeLinecap = 'round';\r\n\tthis.wireframeLinejoin = 'round';\r\n\r\n\tthis.vertexColors = THREE.NoColors;\r\n\r\n\tthis.skinning = false;\r\n\tthis.morphTargets = false;\r\n\tthis.morphNormals = false;\r\n\r\n\tthis.setValues( parameters );\r\n\r\n};\r\n\r\nTHREE.MeshStandardMaterial.prototype = Object.create( THREE.Material.prototype );\r\nTHREE.MeshStandardMaterial.prototype.constructor = THREE.MeshStandardMaterial;\r\n\r\nTHREE.MeshStandardMaterial.prototype.copy = function ( source ) {\r\n\r\n\tTHREE.Material.prototype.copy.call( this, source );\r\n\r\n\tthis.defines = { 'STANDARD': '' };\r\n\r\n\tthis.color.copy( source.color );\r\n\tthis.roughness = source.roughness;\r\n\tthis.metalness = source.metalness;\r\n\r\n\tthis.map = source.map;\r\n\r\n\tthis.lightMap = source.lightMap;\r\n\tthis.lightMapIntensity = source.lightMapIntensity;\r\n\r\n\tthis.aoMap = source.aoMap;\r\n\tthis.aoMapIntensity = source.aoMapIntensity;\r\n\r\n\tthis.emissive.copy( source.emissive );\r\n\tthis.emissiveMap = source.emissiveMap;\r\n\tthis.emissiveIntensity = source.emissiveIntensity;\r\n\r\n\tthis.bumpMap = source.bumpMap;\r\n\tthis.bumpScale = source.bumpScale;\r\n\r\n\tthis.normalMap = source.normalMap;\r\n\tthis.normalScale.copy( source.normalScale );\r\n\r\n\tthis.displacementMap = source.displacementMap;\r\n\tthis.displacementScale = source.displacementScale;\r\n\tthis.displacementBias = source.displacementBias;\r\n\r\n\tthis.roughnessMap = source.roughnessMap;\r\n\r\n\tthis.metalnessMap = source.metalnessMap;\r\n\r\n\tthis.alphaMap = source.alphaMap;\r\n\r\n\tthis.envMap = source.envMap;\r\n\tthis.envMapIntensity = source.envMapIntensity;\r\n\r\n\tthis.refractionRatio = source.refractionRatio;\r\n\r\n\tthis.fog = source.fog;\r\n\r\n\tthis.shading = source.shading;\r\n\r\n\tthis.wireframe = source.wireframe;\r\n\tthis.wireframeLinewidth = source.wireframeLinewidth;\r\n\tthis.wireframeLinecap = source.wireframeLinecap;\r\n\tthis.wireframeLinejoin = source.wireframeLinejoin;\r\n\r\n\tthis.vertexColors = source.vertexColors;\r\n\r\n\tthis.skinning = source.skinning;\r\n\tthis.morphTargets = source.morphTargets;\r\n\tthis.morphNormals = source.morphNormals;\r\n\r\n\treturn this;\r\n\r\n};\r\n\r\n// File:src/materials/MeshPhysicalMaterial.js\r\n\r\n/**\r\n * @author WestLangley / http://github.com/WestLangley\r\n *\r\n * parameters = {\r\n *  reflectivity: <float>\r\n * }\r\n */\r\n\r\nTHREE.MeshPhysicalMaterial = function ( parameters ) {\r\n\r\n\tTHREE.MeshStandardMaterial.call( this );\r\n\r\n\tthis.defines = { 'PHYSICAL': '' };\r\n\r\n\tthis.type = 'MeshPhysicalMaterial';\r\n\r\n\tthis.reflectivity = 0.5; // maps to F0 = 0.04\r\n\r\n\tthis.setValues( parameters );\r\n\r\n};\r\n\r\nTHREE.MeshPhysicalMaterial.prototype = Object.create( THREE.MeshStandardMaterial.prototype );\r\nTHREE.MeshPhysicalMaterial.prototype.constructor = THREE.MeshPhysicalMaterial;\r\n\r\nTHREE.MeshPhysicalMaterial.prototype.copy = function ( source ) {\r\n\r\n\tTHREE.MeshStandardMaterial.prototype.copy.call( this, source );\r\n\r\n\tthis.defines = { 'PHYSICAL': '' };\r\n\r\n\tthis.reflectivity = source.reflectivity;\r\n\r\n\treturn this;\r\n\r\n};\r\n\r\n// File:src/materials/MultiMaterial.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.MultiMaterial = function ( materials ) {\r\n\r\n\tthis.uuid = THREE.Math.generateUUID();\r\n\r\n\tthis.type = 'MultiMaterial';\r\n\r\n\tthis.materials = materials instanceof Array ? materials : [];\r\n\r\n\tthis.visible = true;\r\n\r\n};\r\n\r\nTHREE.MultiMaterial.prototype = {\r\n\r\n\tconstructor: THREE.MultiMaterial,\r\n\r\n\ttoJSON: function ( meta ) {\r\n\r\n\t\tvar output = {\r\n\t\t\tmetadata: {\r\n\t\t\t\tversion: 4.2,\r\n\t\t\t\ttype: 'material',\r\n\t\t\t\tgenerator: 'MaterialExporter'\r\n\t\t\t},\r\n\t\t\tuuid: this.uuid,\r\n\t\t\ttype: this.type,\r\n\t\t\tmaterials: []\r\n\t\t};\r\n\r\n\t\tvar materials = this.materials;\r\n\r\n\t\tfor ( var i = 0, l = materials.length; i < l; i ++ ) {\r\n\r\n\t\t\tvar material = materials[ i ].toJSON( meta );\r\n\t\t\tdelete material.metadata;\r\n\r\n\t\t\toutput.materials.push( material );\r\n\r\n\t\t}\r\n\r\n\t\toutput.visible = this.visible;\r\n\r\n\t\treturn output;\r\n\r\n\t},\r\n\r\n\tclone: function () {\r\n\r\n\t\tvar material = new this.constructor();\r\n\r\n\t\tfor ( var i = 0; i < this.materials.length; i ++ ) {\r\n\r\n\t\t\tmaterial.materials.push( this.materials[ i ].clone() );\r\n\r\n\t\t}\r\n\r\n\t\tmaterial.visible = this.visible;\r\n\r\n\t\treturn material;\r\n\r\n\t}\r\n\r\n};\r\n\r\n// File:src/materials/PointsMaterial.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author alteredq / http://alteredqualia.com/\r\n *\r\n * parameters = {\r\n *  color: <hex>,\r\n *  opacity: <float>,\r\n *  map: new THREE.Texture( <Image> ),\r\n *\r\n *  size: <float>,\r\n *  sizeAttenuation: <bool>,\r\n *\r\n *  blending: THREE.NormalBlending,\r\n *  depthTest: <bool>,\r\n *  depthWrite: <bool>,\r\n *\r\n *  vertexColors: <bool>,\r\n *\r\n *  fog: <bool>\r\n * }\r\n */\r\n\r\nTHREE.PointsMaterial = function ( parameters ) {\r\n\r\n\tTHREE.Material.call( this );\r\n\r\n\tthis.type = 'PointsMaterial';\r\n\r\n\tthis.color = new THREE.Color( 0xffffff );\r\n\r\n\tthis.map = null;\r\n\r\n\tthis.size = 1;\r\n\tthis.sizeAttenuation = true;\r\n\r\n\tthis.blending = THREE.NormalBlending;\r\n\r\n\tthis.vertexColors = THREE.NoColors;\r\n\r\n\tthis.fog = true;\r\n\r\n\tthis.setValues( parameters );\r\n\r\n};\r\n\r\nTHREE.PointsMaterial.prototype = Object.create( THREE.Material.prototype );\r\nTHREE.PointsMaterial.prototype.constructor = THREE.PointsMaterial;\r\n\r\nTHREE.PointsMaterial.prototype.copy = function ( source ) {\r\n\r\n\tTHREE.Material.prototype.copy.call( this, source );\r\n\r\n\tthis.color.copy( source.color );\r\n\r\n\tthis.map = source.map;\r\n\r\n\tthis.size = source.size;\r\n\tthis.sizeAttenuation = source.sizeAttenuation;\r\n\r\n\tthis.vertexColors = source.vertexColors;\r\n\r\n\tthis.fog = source.fog;\r\n\r\n\treturn this;\r\n\r\n};\r\n\r\n// File:src/materials/ShaderMaterial.js\r\n\r\n/**\r\n * @author alteredq / http://alteredqualia.com/\r\n *\r\n * parameters = {\r\n *  defines: { \"label\" : \"value\" },\r\n *  uniforms: { \"parameter1\": { type: \"1f\", value: 1.0 }, \"parameter2\": { type: \"1i\" value2: 2 } },\r\n *\r\n *  fragmentShader: <string>,\r\n *  vertexShader: <string>,\r\n *\r\n *  shading: THREE.SmoothShading,\r\n *\r\n *  wireframe: <boolean>,\r\n *  wireframeLinewidth: <float>,\r\n *\r\n *  lights: <bool>,\r\n *\r\n *  vertexColors: THREE.NoColors / THREE.VertexColors / THREE.FaceColors,\r\n *\r\n *  skinning: <bool>,\r\n *  morphTargets: <bool>,\r\n *  morphNormals: <bool>,\r\n *\r\n *\tfog: <bool>\r\n * }\r\n */\r\n\r\nTHREE.ShaderMaterial = function ( parameters ) {\r\n\r\n\tTHREE.Material.call( this );\r\n\r\n\tthis.type = 'ShaderMaterial';\r\n\r\n\tthis.defines = {};\r\n\tthis.uniforms = {};\r\n\r\n\tthis.vertexShader = 'void main() {\\n\\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\\n}';\r\n\tthis.fragmentShader = 'void main() {\\n\\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\\n}';\r\n\r\n\tthis.shading = THREE.SmoothShading;\r\n\r\n\tthis.linewidth = 1;\r\n\r\n\tthis.wireframe = false;\r\n\tthis.wireframeLinewidth = 1;\r\n\r\n\tthis.fog = false; // set to use scene fog\r\n\r\n\tthis.lights = false; // set to use scene lights\r\n\tthis.clipping = false; // set to use user-defined clipping planes\r\n\r\n\tthis.vertexColors = THREE.NoColors; // set to use \"color\" attribute stream\r\n\r\n\tthis.skinning = false; // set to use skinning attribute streams\r\n\r\n\tthis.morphTargets = false; // set to use morph targets\r\n\tthis.morphNormals = false; // set to use morph normals\r\n\r\n\tthis.extensions = {\r\n\t\tderivatives: false, // set to use derivatives\r\n\t\tfragDepth: false, // set to use fragment depth values\r\n\t\tdrawBuffers: false, // set to use draw buffers\r\n\t\tshaderTextureLOD: false // set to use shader texture LOD\r\n\t};\r\n\r\n\t// When rendered geometry doesn't include these attributes but the material does,\r\n\t// use these default values in WebGL. This avoids errors when buffer data is missing.\r\n\tthis.defaultAttributeValues = {\r\n\t\t'color': [ 1, 1, 1 ],\r\n\t\t'uv': [ 0, 0 ],\r\n\t\t'uv2': [ 0, 0 ]\r\n\t};\r\n\r\n\tthis.index0AttributeName = undefined;\r\n\r\n\tif ( parameters !== undefined ) {\r\n\r\n\t\tif ( parameters.attributes !== undefined ) {\r\n\r\n\t\t\tconsole.error( 'THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead.' );\r\n\r\n\t\t}\r\n\r\n\t\tthis.setValues( parameters );\r\n\r\n\t}\r\n\r\n};\r\n\r\nTHREE.ShaderMaterial.prototype = Object.create( THREE.Material.prototype );\r\nTHREE.ShaderMaterial.prototype.constructor = THREE.ShaderMaterial;\r\n\r\nTHREE.ShaderMaterial.prototype.copy = function ( source ) {\r\n\r\n\tTHREE.Material.prototype.copy.call( this, source );\r\n\r\n\tthis.fragmentShader = source.fragmentShader;\r\n\tthis.vertexShader = source.vertexShader;\r\n\r\n\tthis.uniforms = THREE.UniformsUtils.clone( source.uniforms );\r\n\r\n\tthis.defines = source.defines;\r\n\r\n\tthis.shading = source.shading;\r\n\r\n\tthis.wireframe = source.wireframe;\r\n\tthis.wireframeLinewidth = source.wireframeLinewidth;\r\n\r\n\tthis.fog = source.fog;\r\n\r\n\tthis.lights = source.lights;\r\n\tthis.clipping = source.clipping;\r\n\r\n\tthis.vertexColors = source.vertexColors;\r\n\r\n\tthis.skinning = source.skinning;\r\n\r\n\tthis.morphTargets = source.morphTargets;\r\n\tthis.morphNormals = source.morphNormals;\r\n\r\n\tthis.extensions = source.extensions;\r\n\r\n\treturn this;\r\n\r\n};\r\n\r\nTHREE.ShaderMaterial.prototype.toJSON = function ( meta ) {\r\n\r\n\tvar data = THREE.Material.prototype.toJSON.call( this, meta );\r\n\r\n\tdata.uniforms = this.uniforms;\r\n\tdata.vertexShader = this.vertexShader;\r\n\tdata.fragmentShader = this.fragmentShader;\r\n\r\n\treturn data;\r\n\r\n};\r\n\r\n// File:src/materials/RawShaderMaterial.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.RawShaderMaterial = function ( parameters ) {\r\n\r\n\tTHREE.ShaderMaterial.call( this, parameters );\r\n\r\n\tthis.type = 'RawShaderMaterial';\r\n\r\n};\r\n\r\nTHREE.RawShaderMaterial.prototype = Object.create( THREE.ShaderMaterial.prototype );\r\nTHREE.RawShaderMaterial.prototype.constructor = THREE.RawShaderMaterial;\r\n\r\n// File:src/materials/SpriteMaterial.js\r\n\r\n/**\r\n * @author alteredq / http://alteredqualia.com/\r\n *\r\n * parameters = {\r\n *  color: <hex>,\r\n *  opacity: <float>,\r\n *  map: new THREE.Texture( <Image> ),\r\n *\r\n *\tuvOffset: new THREE.Vector2(),\r\n *\tuvScale: new THREE.Vector2(),\r\n *\r\n *  fog: <bool>\r\n * }\r\n */\r\n\r\nTHREE.SpriteMaterial = function ( parameters ) {\r\n\r\n\tTHREE.Material.call( this );\r\n\r\n\tthis.type = 'SpriteMaterial';\r\n\r\n\tthis.color = new THREE.Color( 0xffffff );\r\n\tthis.map = null;\r\n\r\n\tthis.rotation = 0;\r\n\r\n\tthis.fog = false;\r\n\r\n\t// set parameters\r\n\r\n\tthis.setValues( parameters );\r\n\r\n};\r\n\r\nTHREE.SpriteMaterial.prototype = Object.create( THREE.Material.prototype );\r\nTHREE.SpriteMaterial.prototype.constructor = THREE.SpriteMaterial;\r\n\r\nTHREE.SpriteMaterial.prototype.copy = function ( source ) {\r\n\r\n\tTHREE.Material.prototype.copy.call( this, source );\r\n\r\n\tthis.color.copy( source.color );\r\n\tthis.map = source.map;\r\n\r\n\tthis.rotation = source.rotation;\r\n\r\n\tthis.fog = source.fog;\r\n\r\n\treturn this;\r\n\r\n};\r\n\r\n// File:src/textures/Texture.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author alteredq / http://alteredqualia.com/\r\n * @author szimek / https://github.com/szimek/\r\n */\r\n\r\nTHREE.Texture = function ( image, mapping, wrapS, wrapT, magFilter, minFilter, format, type, anisotropy, encoding ) {\r\n\r\n\tObject.defineProperty( this, 'id', { value: THREE.TextureIdCount ++ } );\r\n\r\n\tthis.uuid = THREE.Math.generateUUID();\r\n\r\n\tthis.name = '';\r\n\tthis.sourceFile = '';\r\n\r\n\tthis.image = image !== undefined ? image : THREE.Texture.DEFAULT_IMAGE;\r\n\tthis.mipmaps = [];\r\n\r\n\tthis.mapping = mapping !== undefined ? mapping : THREE.Texture.DEFAULT_MAPPING;\r\n\r\n\tthis.wrapS = wrapS !== undefined ? wrapS : THREE.ClampToEdgeWrapping;\r\n\tthis.wrapT = wrapT !== undefined ? wrapT : THREE.ClampToEdgeWrapping;\r\n\r\n\tthis.magFilter = magFilter !== undefined ? magFilter : THREE.LinearFilter;\r\n\tthis.minFilter = minFilter !== undefined ? minFilter : THREE.LinearMipMapLinearFilter;\r\n\r\n\tthis.anisotropy = anisotropy !== undefined ? anisotropy : 1;\r\n\r\n\tthis.format = format !== undefined ? format : THREE.RGBAFormat;\r\n\tthis.type = type !== undefined ? type : THREE.UnsignedByteType;\r\n\r\n\tthis.offset = new THREE.Vector2( 0, 0 );\r\n\tthis.repeat = new THREE.Vector2( 1, 1 );\r\n\r\n\tthis.generateMipmaps = true;\r\n\tthis.premultiplyAlpha = false;\r\n\tthis.flipY = true;\r\n\tthis.unpackAlignment = 4;\t// valid values: 1, 2, 4, 8 (see http://www.khronos.org/opengles/sdk/docs/man/xhtml/glPixelStorei.xml)\r\n\r\n\r\n\t// Values of encoding !== THREE.LinearEncoding only supported on map, envMap and emissiveMap.\r\n\t//\r\n\t// Also changing the encoding after already used by a Material will not automatically make the Material\r\n\t// update.  You need to explicitly call Material.needsUpdate to trigger it to recompile.\r\n\tthis.encoding = encoding !== undefined ? encoding :  THREE.LinearEncoding;\r\n\r\n\tthis.version = 0;\r\n\tthis.onUpdate = null;\r\n\r\n};\r\n\r\nTHREE.Texture.DEFAULT_IMAGE = undefined;\r\nTHREE.Texture.DEFAULT_MAPPING = THREE.UVMapping;\r\n\r\nTHREE.Texture.prototype = {\r\n\r\n\tconstructor: THREE.Texture,\r\n\r\n\tset needsUpdate ( value ) {\r\n\r\n\t\tif ( value === true ) this.version ++;\r\n\r\n\t},\r\n\r\n\tclone: function () {\r\n\r\n\t\treturn new this.constructor().copy( this );\r\n\r\n\t},\r\n\r\n\tcopy: function ( source ) {\r\n\r\n\t\tthis.image = source.image;\r\n\t\tthis.mipmaps = source.mipmaps.slice( 0 );\r\n\r\n\t\tthis.mapping = source.mapping;\r\n\r\n\t\tthis.wrapS = source.wrapS;\r\n\t\tthis.wrapT = source.wrapT;\r\n\r\n\t\tthis.magFilter = source.magFilter;\r\n\t\tthis.minFilter = source.minFilter;\r\n\r\n\t\tthis.anisotropy = source.anisotropy;\r\n\r\n\t\tthis.format = source.format;\r\n\t\tthis.type = source.type;\r\n\r\n\t\tthis.offset.copy( source.offset );\r\n\t\tthis.repeat.copy( source.repeat );\r\n\r\n\t\tthis.generateMipmaps = source.generateMipmaps;\r\n\t\tthis.premultiplyAlpha = source.premultiplyAlpha;\r\n\t\tthis.flipY = source.flipY;\r\n\t\tthis.unpackAlignment = source.unpackAlignment;\r\n\t\tthis.encoding = source.encoding;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\ttoJSON: function ( meta ) {\r\n\r\n\t\tif ( meta.textures[ this.uuid ] !== undefined ) {\r\n\r\n\t\t\treturn meta.textures[ this.uuid ];\r\n\r\n\t\t}\r\n\r\n\t\tfunction getDataURL( image ) {\r\n\r\n\t\t\tvar canvas;\r\n\r\n\t\t\tif ( image.toDataURL !== undefined ) {\r\n\r\n\t\t\t\tcanvas = image;\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tcanvas = document.createElement( 'canvas' );\r\n\t\t\t\tcanvas.width = image.width;\r\n\t\t\t\tcanvas.height = image.height;\r\n\r\n\t\t\t\tcanvas.getContext( '2d' ).drawImage( image, 0, 0, image.width, image.height );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( canvas.width > 2048 || canvas.height > 2048 ) {\r\n\r\n\t\t\t\treturn canvas.toDataURL( 'image/jpeg', 0.6 );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\treturn canvas.toDataURL( 'image/png' );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tvar output = {\r\n\t\t\tmetadata: {\r\n\t\t\t\tversion: 4.4,\r\n\t\t\t\ttype: 'Texture',\r\n\t\t\t\tgenerator: 'Texture.toJSON'\r\n\t\t\t},\r\n\r\n\t\t\tuuid: this.uuid,\r\n\t\t\tname: this.name,\r\n\r\n\t\t\tmapping: this.mapping,\r\n\r\n\t\t\trepeat: [ this.repeat.x, this.repeat.y ],\r\n\t\t\toffset: [ this.offset.x, this.offset.y ],\r\n\t\t\twrap: [ this.wrapS, this.wrapT ],\r\n\r\n\t\t\tminFilter: this.minFilter,\r\n\t\t\tmagFilter: this.magFilter,\r\n\t\t\tanisotropy: this.anisotropy\r\n\t\t};\r\n\r\n\t\tif ( this.image !== undefined ) {\r\n\r\n\t\t\t// TODO: Move to THREE.Image\r\n\r\n\t\t\tvar image = this.image;\r\n\r\n\t\t\tif ( image.uuid === undefined ) {\r\n\r\n\t\t\t\timage.uuid = THREE.Math.generateUUID(); // UGH\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( meta.images[ image.uuid ] === undefined ) {\r\n\r\n\t\t\t\tmeta.images[ image.uuid ] = {\r\n\t\t\t\t\tuuid: image.uuid,\r\n\t\t\t\t\turl: getDataURL( image )\r\n\t\t\t\t};\r\n\r\n\t\t\t}\r\n\r\n\t\t\toutput.image = image.uuid;\r\n\r\n\t\t}\r\n\r\n\t\tmeta.textures[ this.uuid ] = output;\r\n\r\n\t\treturn output;\r\n\r\n\t},\r\n\r\n\tdispose: function () {\r\n\r\n\t\tthis.dispatchEvent( { type: 'dispose' } );\r\n\r\n\t},\r\n\r\n\ttransformUv: function ( uv ) {\r\n\r\n\t\tif ( this.mapping !== THREE.UVMapping )  return;\r\n\r\n\t\tuv.multiply( this.repeat );\r\n\t\tuv.add( this.offset );\r\n\r\n\t\tif ( uv.x < 0 || uv.x > 1 ) {\r\n\r\n\t\t\tswitch ( this.wrapS ) {\r\n\r\n\t\t\t\tcase THREE.RepeatWrapping:\r\n\r\n\t\t\t\t\tuv.x = uv.x - Math.floor( uv.x );\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase THREE.ClampToEdgeWrapping:\r\n\r\n\t\t\t\t\tuv.x = uv.x < 0 ? 0 : 1;\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase THREE.MirroredRepeatWrapping:\r\n\r\n\t\t\t\t\tif ( Math.abs( Math.floor( uv.x ) % 2 ) === 1 ) {\r\n\r\n\t\t\t\t\t\tuv.x = Math.ceil( uv.x ) - uv.x;\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\tuv.x = uv.x - Math.floor( uv.x );\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tif ( uv.y < 0 || uv.y > 1 ) {\r\n\r\n\t\t\tswitch ( this.wrapT ) {\r\n\r\n\t\t\t\tcase THREE.RepeatWrapping:\r\n\r\n\t\t\t\t\tuv.y = uv.y - Math.floor( uv.y );\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase THREE.ClampToEdgeWrapping:\r\n\r\n\t\t\t\t\tuv.y = uv.y < 0 ? 0 : 1;\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase THREE.MirroredRepeatWrapping:\r\n\r\n\t\t\t\t\tif ( Math.abs( Math.floor( uv.y ) % 2 ) === 1 ) {\r\n\r\n\t\t\t\t\t\tuv.y = Math.ceil( uv.y ) - uv.y;\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\tuv.y = uv.y - Math.floor( uv.y );\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tif ( this.flipY ) {\r\n\r\n\t\t\tuv.y = 1 - uv.y;\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n};\r\n\r\nTHREE.EventDispatcher.prototype.apply( THREE.Texture.prototype );\r\n\r\nTHREE.TextureIdCount = 0;\r\n\r\n// File:src/textures/DepthTexture.js\r\n\r\n/**\r\n * @author Matt DesLauriers / @mattdesl\r\n */\r\n\r\nTHREE.DepthTexture = function ( width, height, type, mapping, wrapS, wrapT, magFilter, minFilter, anisotropy ) {\r\n\r\n  THREE.Texture.call( this, null, mapping, wrapS, wrapT, magFilter, minFilter, THREE.DepthFormat, type, anisotropy );\r\n\r\n  this.image = { width: width, height: height };\r\n\r\n  this.type = type !== undefined ? type : THREE.UnsignedShortType;\r\n\r\n  this.magFilter = magFilter !== undefined ? magFilter : THREE.NearestFilter;\r\n  this.minFilter = minFilter !== undefined ? minFilter : THREE.NearestFilter;\r\n\r\n  this.flipY = false;\r\n  this.generateMipmaps  = false;\r\n\r\n};\r\n\r\nTHREE.DepthTexture.prototype = Object.create( THREE.Texture.prototype );\r\nTHREE.DepthTexture.prototype.constructor = THREE.DepthTexture;\r\n\r\n// File:src/textures/CanvasTexture.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.CanvasTexture = function ( canvas, mapping, wrapS, wrapT, magFilter, minFilter, format, type, anisotropy ) {\r\n\r\n\tTHREE.Texture.call( this, canvas, mapping, wrapS, wrapT, magFilter, minFilter, format, type, anisotropy );\r\n\r\n\tthis.needsUpdate = true;\r\n\r\n};\r\n\r\nTHREE.CanvasTexture.prototype = Object.create( THREE.Texture.prototype );\r\nTHREE.CanvasTexture.prototype.constructor = THREE.CanvasTexture;\r\n\r\n// File:src/textures/CubeTexture.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.CubeTexture = function ( images, mapping, wrapS, wrapT, magFilter, minFilter, format, type, anisotropy, encoding ) {\r\n\r\n\timages = images !== undefined ? images : [];\r\n\tmapping = mapping !== undefined ? mapping : THREE.CubeReflectionMapping;\r\n\r\n\tTHREE.Texture.call( this, images, mapping, wrapS, wrapT, magFilter, minFilter, format, type, anisotropy, encoding );\r\n\r\n\tthis.flipY = false;\r\n\r\n};\r\n\r\nTHREE.CubeTexture.prototype = Object.create( THREE.Texture.prototype );\r\nTHREE.CubeTexture.prototype.constructor = THREE.CubeTexture;\r\n\r\nObject.defineProperty( THREE.CubeTexture.prototype, 'images', {\r\n\r\n\tget: function () {\r\n\r\n\t\treturn this.image;\r\n\r\n\t},\r\n\r\n\tset: function ( value ) {\r\n\r\n\t\tthis.image = value;\r\n\r\n\t}\r\n\r\n} );\r\n\r\n// File:src/textures/CompressedTexture.js\r\n\r\n/**\r\n * @author alteredq / http://alteredqualia.com/\r\n */\r\n\r\nTHREE.CompressedTexture = function ( mipmaps, width, height, format, type, mapping, wrapS, wrapT, magFilter, minFilter, anisotropy, encoding ) {\r\n\r\n\tTHREE.Texture.call( this, null, mapping, wrapS, wrapT, magFilter, minFilter, format, type, anisotropy, encoding );\r\n\r\n\tthis.image = { width: width, height: height };\r\n\tthis.mipmaps = mipmaps;\r\n\r\n\t// no flipping for cube textures\r\n\t// (also flipping doesn't work for compressed textures )\r\n\r\n\tthis.flipY = false;\r\n\r\n\t// can't generate mipmaps for compressed textures\r\n\t// mips must be embedded in DDS files\r\n\r\n\tthis.generateMipmaps = false;\r\n\r\n};\r\n\r\nTHREE.CompressedTexture.prototype = Object.create( THREE.Texture.prototype );\r\nTHREE.CompressedTexture.prototype.constructor = THREE.CompressedTexture;\r\n\r\n// File:src/textures/DataTexture.js\r\n\r\n/**\r\n * @author alteredq / http://alteredqualia.com/\r\n */\r\n\r\nTHREE.DataTexture = function ( data, width, height, format, type, mapping, wrapS, wrapT, magFilter, minFilter, anisotropy, encoding ) {\r\n\r\n\tTHREE.Texture.call( this, null, mapping, wrapS, wrapT, magFilter, minFilter, format, type, anisotropy, encoding );\r\n\r\n\tthis.image = { data: data, width: width, height: height };\r\n\r\n\tthis.magFilter = magFilter !== undefined ? magFilter : THREE.NearestFilter;\r\n\tthis.minFilter = minFilter !== undefined ? minFilter : THREE.NearestFilter;\r\n\r\n\tthis.flipY = false;\r\n\tthis.generateMipmaps  = false;\r\n\r\n};\r\n\r\nTHREE.DataTexture.prototype = Object.create( THREE.Texture.prototype );\r\nTHREE.DataTexture.prototype.constructor = THREE.DataTexture;\r\n\r\n// File:src/textures/VideoTexture.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.VideoTexture = function ( video, mapping, wrapS, wrapT, magFilter, minFilter, format, type, anisotropy ) {\r\n\r\n\tTHREE.Texture.call( this, video, mapping, wrapS, wrapT, magFilter, minFilter, format, type, anisotropy );\r\n\r\n\tthis.generateMipmaps = false;\r\n\r\n\tvar scope = this;\r\n\r\n\tfunction update() {\r\n\r\n\t\trequestAnimationFrame( update );\r\n\r\n\t\tif ( video.readyState >= video.HAVE_CURRENT_DATA ) {\r\n\r\n\t\t\tscope.needsUpdate = true;\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tupdate();\r\n\r\n};\r\n\r\nTHREE.VideoTexture.prototype = Object.create( THREE.Texture.prototype );\r\nTHREE.VideoTexture.prototype.constructor = THREE.VideoTexture;\r\n\r\n// File:src/objects/Group.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.Group = function () {\r\n\r\n\tTHREE.Object3D.call( this );\r\n\r\n\tthis.type = 'Group';\r\n\r\n};\r\n\r\nTHREE.Group.prototype = Object.create( THREE.Object3D.prototype );\r\nTHREE.Group.prototype.constructor = THREE.Group;\r\n\r\n// File:src/objects/Points.js\r\n\r\n/**\r\n * @author alteredq / http://alteredqualia.com/\r\n */\r\n\r\nTHREE.Points = function ( geometry, material ) {\r\n\r\n\tTHREE.Object3D.call( this );\r\n\r\n\tthis.type = 'Points';\r\n\r\n\tthis.geometry = geometry !== undefined ? geometry : new THREE.Geometry();\r\n\tthis.material = material !== undefined ? material : new THREE.PointsMaterial( { color: Math.random() * 0xffffff } );\r\n\r\n};\r\n\r\nTHREE.Points.prototype = Object.create( THREE.Object3D.prototype );\r\nTHREE.Points.prototype.constructor = THREE.Points;\r\n\r\nTHREE.Points.prototype.raycast = ( function () {\r\n\r\n\tvar inverseMatrix = new THREE.Matrix4();\r\n\tvar ray = new THREE.Ray();\r\n\tvar sphere = new THREE.Sphere();\r\n\r\n\treturn function raycast( raycaster, intersects ) {\r\n\r\n\t\tvar object = this;\r\n\t\tvar geometry = this.geometry;\r\n\t\tvar matrixWorld = this.matrixWorld;\r\n\t\tvar threshold = raycaster.params.Points.threshold;\r\n\r\n\t\t// Checking boundingSphere distance to ray\r\n\r\n\t\tif ( geometry.boundingSphere === null ) geometry.computeBoundingSphere();\r\n\r\n\t\tsphere.copy( geometry.boundingSphere );\r\n\t\tsphere.applyMatrix4( matrixWorld );\r\n\r\n\t\tif ( raycaster.ray.intersectsSphere( sphere ) === false ) return;\r\n\r\n\t\t//\r\n\r\n\t\tinverseMatrix.getInverse( matrixWorld );\r\n\t\tray.copy( raycaster.ray ).applyMatrix4( inverseMatrix );\r\n\r\n\t\tvar localThreshold = threshold / ( ( this.scale.x + this.scale.y + this.scale.z ) / 3 );\r\n\t\tvar localThresholdSq = localThreshold * localThreshold;\r\n\t\tvar position = new THREE.Vector3();\r\n\r\n\t\tfunction testPoint( point, index ) {\r\n\r\n\t\t\tvar rayPointDistanceSq = ray.distanceSqToPoint( point );\r\n\r\n\t\t\tif ( rayPointDistanceSq < localThresholdSq ) {\r\n\r\n\t\t\t\tvar intersectPoint = ray.closestPointToPoint( point );\r\n\t\t\t\tintersectPoint.applyMatrix4( matrixWorld );\r\n\r\n\t\t\t\tvar distance = raycaster.ray.origin.distanceTo( intersectPoint );\r\n\r\n\t\t\t\tif ( distance < raycaster.near || distance > raycaster.far ) return;\r\n\r\n\t\t\t\tintersects.push( {\r\n\r\n\t\t\t\t\tdistance: distance,\r\n\t\t\t\t\tdistanceToRay: Math.sqrt( rayPointDistanceSq ),\r\n\t\t\t\t\tpoint: intersectPoint.clone(),\r\n\t\t\t\t\tindex: index,\r\n\t\t\t\t\tface: null,\r\n\t\t\t\t\tobject: object\r\n\r\n\t\t\t\t} );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tif ( geometry instanceof THREE.BufferGeometry ) {\r\n\r\n\t\t\tvar index = geometry.index;\r\n\t\t\tvar attributes = geometry.attributes;\r\n\t\t\tvar positions = attributes.position.array;\r\n\r\n\t\t\tif ( index !== null ) {\r\n\r\n\t\t\t\tvar indices = index.array;\r\n\r\n\t\t\t\tfor ( var i = 0, il = indices.length; i < il; i ++ ) {\r\n\r\n\t\t\t\t\tvar a = indices[ i ];\r\n\r\n\t\t\t\t\tposition.fromArray( positions, a * 3 );\r\n\r\n\t\t\t\t\ttestPoint( position, a );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tfor ( var i = 0, l = positions.length / 3; i < l; i ++ ) {\r\n\r\n\t\t\t\t\tposition.fromArray( positions, i * 3 );\r\n\r\n\t\t\t\t\ttestPoint( position, i );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t} else {\r\n\r\n\t\t\tvar vertices = geometry.vertices;\r\n\r\n\t\t\tfor ( var i = 0, l = vertices.length; i < l; i ++ ) {\r\n\r\n\t\t\t\ttestPoint( vertices[ i ], i );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n}() );\r\n\r\nTHREE.Points.prototype.clone = function () {\r\n\r\n\treturn new this.constructor( this.geometry, this.material ).copy( this );\r\n\r\n};\r\n\r\n// File:src/objects/Line.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.Line = function ( geometry, material, mode ) {\r\n\r\n\tif ( mode === 1 ) {\r\n\r\n\t\tconsole.warn( 'THREE.Line: parameter THREE.LinePieces no longer supported. Created THREE.LineSegments instead.' );\r\n\t\treturn new THREE.LineSegments( geometry, material );\r\n\r\n\t}\r\n\r\n\tTHREE.Object3D.call( this );\r\n\r\n\tthis.type = 'Line';\r\n\r\n\tthis.geometry = geometry !== undefined ? geometry : new THREE.Geometry();\r\n\tthis.material = material !== undefined ? material : new THREE.LineBasicMaterial( { color: Math.random() * 0xffffff } );\r\n\r\n};\r\n\r\nTHREE.Line.prototype = Object.create( THREE.Object3D.prototype );\r\nTHREE.Line.prototype.constructor = THREE.Line;\r\n\r\nTHREE.Line.prototype.raycast = ( function () {\r\n\r\n\tvar inverseMatrix = new THREE.Matrix4();\r\n\tvar ray = new THREE.Ray();\r\n\tvar sphere = new THREE.Sphere();\r\n\r\n\treturn function raycast( raycaster, intersects ) {\r\n\r\n\t\tvar precision = raycaster.linePrecision;\r\n\t\tvar precisionSq = precision * precision;\r\n\r\n\t\tvar geometry = this.geometry;\r\n\t\tvar matrixWorld = this.matrixWorld;\r\n\r\n\t\t// Checking boundingSphere distance to ray\r\n\r\n\t\tif ( geometry.boundingSphere === null ) geometry.computeBoundingSphere();\r\n\r\n\t\tsphere.copy( geometry.boundingSphere );\r\n\t\tsphere.applyMatrix4( matrixWorld );\r\n\r\n\t\tif ( raycaster.ray.intersectsSphere( sphere ) === false ) return;\r\n\r\n\t\t//\r\n\r\n\t\tinverseMatrix.getInverse( matrixWorld );\r\n\t\tray.copy( raycaster.ray ).applyMatrix4( inverseMatrix );\r\n\r\n\t\tvar vStart = new THREE.Vector3();\r\n\t\tvar vEnd = new THREE.Vector3();\r\n\t\tvar interSegment = new THREE.Vector3();\r\n\t\tvar interRay = new THREE.Vector3();\r\n\t\tvar step = this instanceof THREE.LineSegments ? 2 : 1;\r\n\r\n\t\tif ( geometry instanceof THREE.BufferGeometry ) {\r\n\r\n\t\t\tvar index = geometry.index;\r\n\t\t\tvar attributes = geometry.attributes;\r\n\t\t\tvar positions = attributes.position.array;\r\n\r\n\t\t\tif ( index !== null ) {\r\n\r\n\t\t\t\tvar indices = index.array;\r\n\r\n\t\t\t\tfor ( var i = 0, l = indices.length - 1; i < l; i += step ) {\r\n\r\n\t\t\t\t\tvar a = indices[ i ];\r\n\t\t\t\t\tvar b = indices[ i + 1 ];\r\n\r\n\t\t\t\t\tvStart.fromArray( positions, a * 3 );\r\n\t\t\t\t\tvEnd.fromArray( positions, b * 3 );\r\n\r\n\t\t\t\t\tvar distSq = ray.distanceSqToSegment( vStart, vEnd, interRay, interSegment );\r\n\r\n\t\t\t\t\tif ( distSq > precisionSq ) continue;\r\n\r\n\t\t\t\t\tinterRay.applyMatrix4( this.matrixWorld ); //Move back to world space for distance calculation\r\n\r\n\t\t\t\t\tvar distance = raycaster.ray.origin.distanceTo( interRay );\r\n\r\n\t\t\t\t\tif ( distance < raycaster.near || distance > raycaster.far ) continue;\r\n\r\n\t\t\t\t\tintersects.push( {\r\n\r\n\t\t\t\t\t\tdistance: distance,\r\n\t\t\t\t\t\t// What do we want? intersection point on the ray or on the segment??\r\n\t\t\t\t\t\t// point: raycaster.ray.at( distance ),\r\n\t\t\t\t\t\tpoint: interSegment.clone().applyMatrix4( this.matrixWorld ),\r\n\t\t\t\t\t\tindex: i,\r\n\t\t\t\t\t\tface: null,\r\n\t\t\t\t\t\tfaceIndex: null,\r\n\t\t\t\t\t\tobject: this\r\n\r\n\t\t\t\t\t} );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tfor ( var i = 0, l = positions.length / 3 - 1; i < l; i += step ) {\r\n\r\n\t\t\t\t\tvStart.fromArray( positions, 3 * i );\r\n\t\t\t\t\tvEnd.fromArray( positions, 3 * i + 3 );\r\n\r\n\t\t\t\t\tvar distSq = ray.distanceSqToSegment( vStart, vEnd, interRay, interSegment );\r\n\r\n\t\t\t\t\tif ( distSq > precisionSq ) continue;\r\n\r\n\t\t\t\t\tinterRay.applyMatrix4( this.matrixWorld ); //Move back to world space for distance calculation\r\n\r\n\t\t\t\t\tvar distance = raycaster.ray.origin.distanceTo( interRay );\r\n\r\n\t\t\t\t\tif ( distance < raycaster.near || distance > raycaster.far ) continue;\r\n\r\n\t\t\t\t\tintersects.push( {\r\n\r\n\t\t\t\t\t\tdistance: distance,\r\n\t\t\t\t\t\t// What do we want? intersection point on the ray or on the segment??\r\n\t\t\t\t\t\t// point: raycaster.ray.at( distance ),\r\n\t\t\t\t\t\tpoint: interSegment.clone().applyMatrix4( this.matrixWorld ),\r\n\t\t\t\t\t\tindex: i,\r\n\t\t\t\t\t\tface: null,\r\n\t\t\t\t\t\tfaceIndex: null,\r\n\t\t\t\t\t\tobject: this\r\n\r\n\t\t\t\t\t} );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t} else if ( geometry instanceof THREE.Geometry ) {\r\n\r\n\t\t\tvar vertices = geometry.vertices;\r\n\t\t\tvar nbVertices = vertices.length;\r\n\r\n\t\t\tfor ( var i = 0; i < nbVertices - 1; i += step ) {\r\n\r\n\t\t\t\tvar distSq = ray.distanceSqToSegment( vertices[ i ], vertices[ i + 1 ], interRay, interSegment );\r\n\r\n\t\t\t\tif ( distSq > precisionSq ) continue;\r\n\r\n\t\t\t\tinterRay.applyMatrix4( this.matrixWorld ); //Move back to world space for distance calculation\r\n\r\n\t\t\t\tvar distance = raycaster.ray.origin.distanceTo( interRay );\r\n\r\n\t\t\t\tif ( distance < raycaster.near || distance > raycaster.far ) continue;\r\n\r\n\t\t\t\tintersects.push( {\r\n\r\n\t\t\t\t\tdistance: distance,\r\n\t\t\t\t\t// What do we want? intersection point on the ray or on the segment??\r\n\t\t\t\t\t// point: raycaster.ray.at( distance ),\r\n\t\t\t\t\tpoint: interSegment.clone().applyMatrix4( this.matrixWorld ),\r\n\t\t\t\t\tindex: i,\r\n\t\t\t\t\tface: null,\r\n\t\t\t\t\tfaceIndex: null,\r\n\t\t\t\t\tobject: this\r\n\r\n\t\t\t\t} );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n}() );\r\n\r\nTHREE.Line.prototype.clone = function () {\r\n\r\n\treturn new this.constructor( this.geometry, this.material ).copy( this );\r\n\r\n};\r\n\r\n// DEPRECATED\r\n\r\nTHREE.LineStrip = 0;\r\nTHREE.LinePieces = 1;\r\n\r\n// File:src/objects/LineSegments.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.LineSegments = function ( geometry, material ) {\r\n\r\n\tTHREE.Line.call( this, geometry, material );\r\n\r\n\tthis.type = 'LineSegments';\r\n\r\n};\r\n\r\nTHREE.LineSegments.prototype = Object.create( THREE.Line.prototype );\r\nTHREE.LineSegments.prototype.constructor = THREE.LineSegments;\r\n\r\n// File:src/objects/Mesh.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author alteredq / http://alteredqualia.com/\r\n * @author mikael emtinger / http://gomo.se/\r\n * @author jonobr1 / http://jonobr1.com/\r\n */\r\n\r\nTHREE.Mesh = function ( geometry, material ) {\r\n\r\n\tTHREE.Object3D.call( this );\r\n\r\n\tthis.type = 'Mesh';\r\n\r\n\tthis.geometry = geometry !== undefined ? geometry : new THREE.Geometry();\r\n\tthis.material = material !== undefined ? material : new THREE.MeshBasicMaterial( { color: Math.random() * 0xffffff } );\r\n\r\n\tthis.drawMode = THREE.TrianglesDrawMode;\r\n\r\n\tthis.updateMorphTargets();\r\n\r\n};\r\n\r\nTHREE.Mesh.prototype = Object.create( THREE.Object3D.prototype );\r\nTHREE.Mesh.prototype.constructor = THREE.Mesh;\r\n\r\nTHREE.Mesh.prototype.setDrawMode = function ( value ) {\r\n\r\n\tthis.drawMode = value;\r\n\r\n};\r\n\r\nTHREE.Mesh.prototype.updateMorphTargets = function () {\r\n\r\n\tif ( this.geometry.morphTargets !== undefined && this.geometry.morphTargets.length > 0 ) {\r\n\r\n\t\tthis.morphTargetBase = - 1;\r\n\t\tthis.morphTargetInfluences = [];\r\n\t\tthis.morphTargetDictionary = {};\r\n\r\n\t\tfor ( var m = 0, ml = this.geometry.morphTargets.length; m < ml; m ++ ) {\r\n\r\n\t\t\tthis.morphTargetInfluences.push( 0 );\r\n\t\t\tthis.morphTargetDictionary[ this.geometry.morphTargets[ m ].name ] = m;\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n};\r\n\r\nTHREE.Mesh.prototype.getMorphTargetIndexByName = function ( name ) {\r\n\r\n\tif ( this.morphTargetDictionary[ name ] !== undefined ) {\r\n\r\n\t\treturn this.morphTargetDictionary[ name ];\r\n\r\n\t}\r\n\r\n\tconsole.warn( 'THREE.Mesh.getMorphTargetIndexByName: morph target ' + name + ' does not exist. Returning 0.' );\r\n\r\n\treturn 0;\r\n\r\n};\r\n\r\n\r\nTHREE.Mesh.prototype.raycast = ( function () {\r\n\r\n\tvar inverseMatrix = new THREE.Matrix4();\r\n\tvar ray = new THREE.Ray();\r\n\tvar sphere = new THREE.Sphere();\r\n\r\n\tvar vA = new THREE.Vector3();\r\n\tvar vB = new THREE.Vector3();\r\n\tvar vC = new THREE.Vector3();\r\n\r\n\tvar tempA = new THREE.Vector3();\r\n\tvar tempB = new THREE.Vector3();\r\n\tvar tempC = new THREE.Vector3();\r\n\r\n\tvar uvA = new THREE.Vector2();\r\n\tvar uvB = new THREE.Vector2();\r\n\tvar uvC = new THREE.Vector2();\r\n\r\n\tvar barycoord = new THREE.Vector3();\r\n\r\n\tvar intersectionPoint = new THREE.Vector3();\r\n\tvar intersectionPointWorld = new THREE.Vector3();\r\n\r\n\tfunction uvIntersection( point, p1, p2, p3, uv1, uv2, uv3 ) {\r\n\r\n\t\tTHREE.Triangle.barycoordFromPoint( point, p1, p2, p3, barycoord );\r\n\r\n\t\tuv1.multiplyScalar( barycoord.x );\r\n\t\tuv2.multiplyScalar( barycoord.y );\r\n\t\tuv3.multiplyScalar( barycoord.z );\r\n\r\n\t\tuv1.add( uv2 ).add( uv3 );\r\n\r\n\t\treturn uv1.clone();\r\n\r\n\t}\r\n\r\n\tfunction checkIntersection( object, raycaster, ray, pA, pB, pC, point ) {\r\n\r\n\t\tvar intersect;\r\n\t\tvar material = object.material;\r\n\r\n\t\tif ( material.side === THREE.BackSide ) {\r\n\r\n\t\t\tintersect = ray.intersectTriangle( pC, pB, pA, true, point );\r\n\r\n\t\t} else {\r\n\r\n\t\t\tintersect = ray.intersectTriangle( pA, pB, pC, material.side !== THREE.DoubleSide, point );\r\n\r\n\t\t}\r\n\r\n\t\tif ( intersect === null ) return null;\r\n\r\n\t\tintersectionPointWorld.copy( point );\r\n\t\tintersectionPointWorld.applyMatrix4( object.matrixWorld );\r\n\r\n\t\tvar distance = raycaster.ray.origin.distanceTo( intersectionPointWorld );\r\n\r\n\t\tif ( distance < raycaster.near || distance > raycaster.far ) return null;\r\n\r\n\t\treturn {\r\n\t\t\tdistance: distance,\r\n\t\t\tpoint: intersectionPointWorld.clone(),\r\n\t\t\tobject: object\r\n\t\t};\r\n\r\n\t}\r\n\r\n\tfunction checkBufferGeometryIntersection( object, raycaster, ray, positions, uvs, a, b, c ) {\r\n\r\n\t\tvA.fromArray( positions, a * 3 );\r\n\t\tvB.fromArray( positions, b * 3 );\r\n\t\tvC.fromArray( positions, c * 3 );\r\n\r\n\t\tvar intersection = checkIntersection( object, raycaster, ray, vA, vB, vC, intersectionPoint );\r\n\r\n\t\tif ( intersection ) {\r\n\r\n\t\t\tif ( uvs ) {\r\n\r\n\t\t\t\tuvA.fromArray( uvs, a * 2 );\r\n\t\t\t\tuvB.fromArray( uvs, b * 2 );\r\n\t\t\t\tuvC.fromArray( uvs, c * 2 );\r\n\r\n\t\t\t\tintersection.uv = uvIntersection( intersectionPoint,  vA, vB, vC,  uvA, uvB, uvC );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tintersection.face = new THREE.Face3( a, b, c, THREE.Triangle.normal( vA, vB, vC ) );\r\n\t\t\tintersection.faceIndex = a;\r\n\r\n\t\t}\r\n\r\n\t\treturn intersection;\r\n\r\n\t}\r\n\r\n\treturn function raycast( raycaster, intersects ) {\r\n\r\n\t\tvar geometry = this.geometry;\r\n\t\tvar material = this.material;\r\n\t\tvar matrixWorld = this.matrixWorld;\r\n\r\n\t\tif ( material === undefined ) return;\r\n\r\n\t\t// Checking boundingSphere distance to ray\r\n\r\n\t\tif ( geometry.boundingSphere === null ) geometry.computeBoundingSphere();\r\n\r\n\t\tsphere.copy( geometry.boundingSphere );\r\n\t\tsphere.applyMatrix4( matrixWorld );\r\n\r\n\t\tif ( raycaster.ray.intersectsSphere( sphere ) === false ) return;\r\n\r\n\t\t//\r\n\r\n\t\tinverseMatrix.getInverse( matrixWorld );\r\n\t\tray.copy( raycaster.ray ).applyMatrix4( inverseMatrix );\r\n\r\n\t\t// Check boundingBox before continuing\r\n\r\n\t\tif ( geometry.boundingBox !== null ) {\r\n\r\n\t\t\tif ( ray.intersectsBox( geometry.boundingBox ) === false ) return;\r\n\r\n\t\t}\r\n\r\n\t\tvar uvs, intersection;\r\n\r\n\t\tif ( geometry instanceof THREE.BufferGeometry ) {\r\n\r\n\t\t\tvar a, b, c;\r\n\t\t\tvar index = geometry.index;\r\n\t\t\tvar attributes = geometry.attributes;\r\n\t\t\tvar positions = attributes.position.array;\r\n\r\n\t\t\tif ( attributes.uv !== undefined ) {\r\n\r\n\t\t\t\tuvs = attributes.uv.array;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( index !== null ) {\r\n\r\n\t\t\t\tvar indices = index.array;\r\n\r\n\t\t\t\tfor ( var i = 0, l = indices.length; i < l; i += 3 ) {\r\n\r\n\t\t\t\t\ta = indices[ i ];\r\n\t\t\t\t\tb = indices[ i + 1 ];\r\n\t\t\t\t\tc = indices[ i + 2 ];\r\n\r\n\t\t\t\t\tintersection = checkBufferGeometryIntersection( this, raycaster, ray, positions, uvs, a, b, c );\r\n\r\n\t\t\t\t\tif ( intersection ) {\r\n\r\n\t\t\t\t\t\tintersection.faceIndex = Math.floor( i / 3 ); // triangle number in indices buffer semantics\r\n\t\t\t\t\t\tintersects.push( intersection );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t} else {\r\n\r\n\r\n\t\t\t\tfor ( var i = 0, l = positions.length; i < l; i += 9 ) {\r\n\r\n\t\t\t\t\ta = i / 3;\r\n\t\t\t\t\tb = a + 1;\r\n\t\t\t\t\tc = a + 2;\r\n\r\n\t\t\t\t\tintersection = checkBufferGeometryIntersection( this, raycaster, ray, positions, uvs, a, b, c );\r\n\r\n\t\t\t\t\tif ( intersection ) {\r\n\r\n\t\t\t\t\t\tintersection.index = a; // triangle number in positions buffer semantics\r\n\t\t\t\t\t\tintersects.push( intersection );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t} else if ( geometry instanceof THREE.Geometry ) {\r\n\r\n\t\t\tvar fvA, fvB, fvC;\r\n\t\t\tvar isFaceMaterial = material instanceof THREE.MultiMaterial;\r\n\t\t\tvar materials = isFaceMaterial === true ? material.materials : null;\r\n\r\n\t\t\tvar vertices = geometry.vertices;\r\n\t\t\tvar faces = geometry.faces;\r\n\t\t\tvar faceVertexUvs = geometry.faceVertexUvs[ 0 ];\r\n\t\t\tif ( faceVertexUvs.length > 0 ) uvs = faceVertexUvs;\r\n\r\n\t\t\tfor ( var f = 0, fl = faces.length; f < fl; f ++ ) {\r\n\r\n\t\t\t\tvar face = faces[ f ];\r\n\t\t\t\tvar faceMaterial = isFaceMaterial === true ? materials[ face.materialIndex ] : material;\r\n\r\n\t\t\t\tif ( faceMaterial === undefined ) continue;\r\n\r\n\t\t\t\tfvA = vertices[ face.a ];\r\n\t\t\t\tfvB = vertices[ face.b ];\r\n\t\t\t\tfvC = vertices[ face.c ];\r\n\r\n\t\t\t\tif ( faceMaterial.morphTargets === true ) {\r\n\r\n\t\t\t\t\tvar morphTargets = geometry.morphTargets;\r\n\t\t\t\t\tvar morphInfluences = this.morphTargetInfluences;\r\n\r\n\t\t\t\t\tvA.set( 0, 0, 0 );\r\n\t\t\t\t\tvB.set( 0, 0, 0 );\r\n\t\t\t\t\tvC.set( 0, 0, 0 );\r\n\r\n\t\t\t\t\tfor ( var t = 0, tl = morphTargets.length; t < tl; t ++ ) {\r\n\r\n\t\t\t\t\t\tvar influence = morphInfluences[ t ];\r\n\r\n\t\t\t\t\t\tif ( influence === 0 ) continue;\r\n\r\n\t\t\t\t\t\tvar targets = morphTargets[ t ].vertices;\r\n\r\n\t\t\t\t\t\tvA.addScaledVector( tempA.subVectors( targets[ face.a ], fvA ), influence );\r\n\t\t\t\t\t\tvB.addScaledVector( tempB.subVectors( targets[ face.b ], fvB ), influence );\r\n\t\t\t\t\t\tvC.addScaledVector( tempC.subVectors( targets[ face.c ], fvC ), influence );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tvA.add( fvA );\r\n\t\t\t\t\tvB.add( fvB );\r\n\t\t\t\t\tvC.add( fvC );\r\n\r\n\t\t\t\t\tfvA = vA;\r\n\t\t\t\t\tfvB = vB;\r\n\t\t\t\t\tfvC = vC;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tintersection = checkIntersection( this, raycaster, ray, fvA, fvB, fvC, intersectionPoint );\r\n\r\n\t\t\t\tif ( intersection ) {\r\n\r\n\t\t\t\t\tif ( uvs ) {\r\n\r\n\t\t\t\t\t\tvar uvs_f = uvs[ f ];\r\n\t\t\t\t\t\tuvA.copy( uvs_f[ 0 ] );\r\n\t\t\t\t\t\tuvB.copy( uvs_f[ 1 ] );\r\n\t\t\t\t\t\tuvC.copy( uvs_f[ 2 ] );\r\n\r\n\t\t\t\t\t\tintersection.uv = uvIntersection( intersectionPoint, fvA, fvB, fvC, uvA, uvB, uvC );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tintersection.face = face;\r\n\t\t\t\t\tintersection.faceIndex = f;\r\n\t\t\t\t\tintersects.push( intersection );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n}() );\r\n\r\nTHREE.Mesh.prototype.clone = function () {\r\n\r\n\treturn new this.constructor( this.geometry, this.material ).copy( this );\r\n\r\n};\r\n\r\n// File:src/objects/Bone.js\r\n\r\n/**\r\n * @author mikael emtinger / http://gomo.se/\r\n * @author alteredq / http://alteredqualia.com/\r\n * @author ikerr / http://verold.com\r\n */\r\n\r\nTHREE.Bone = function ( skin ) {\r\n\r\n\tTHREE.Object3D.call( this );\r\n\r\n\tthis.type = 'Bone';\r\n\r\n\tthis.skin = skin;\r\n\r\n};\r\n\r\nTHREE.Bone.prototype = Object.create( THREE.Object3D.prototype );\r\nTHREE.Bone.prototype.constructor = THREE.Bone;\r\n\r\nTHREE.Bone.prototype.copy = function ( source ) {\r\n\r\n\tTHREE.Object3D.prototype.copy.call( this, source );\r\n\r\n\tthis.skin = source.skin;\r\n\r\n\treturn this;\r\n\r\n};\r\n\r\n// File:src/objects/Skeleton.js\r\n\r\n/**\r\n * @author mikael emtinger / http://gomo.se/\r\n * @author alteredq / http://alteredqualia.com/\r\n * @author michael guerrero / http://realitymeltdown.com\r\n * @author ikerr / http://verold.com\r\n */\r\n\r\nTHREE.Skeleton = function ( bones, boneInverses, useVertexTexture ) {\r\n\r\n\tthis.useVertexTexture = useVertexTexture !== undefined ? useVertexTexture : true;\r\n\r\n\tthis.identityMatrix = new THREE.Matrix4();\r\n\r\n\t// copy the bone array\r\n\r\n\tbones = bones || [];\r\n\r\n\tthis.bones = bones.slice( 0 );\r\n\r\n\t// create a bone texture or an array of floats\r\n\r\n\tif ( this.useVertexTexture ) {\r\n\r\n\t\t// layout (1 matrix = 4 pixels)\r\n\t\t//      RGBA RGBA RGBA RGBA (=> column1, column2, column3, column4)\r\n\t\t//  with  8x8  pixel texture max   16 bones * 4 pixels =  (8 * 8)\r\n\t\t//       16x16 pixel texture max   64 bones * 4 pixels = (16 * 16)\r\n\t\t//       32x32 pixel texture max  256 bones * 4 pixels = (32 * 32)\r\n\t\t//       64x64 pixel texture max 1024 bones * 4 pixels = (64 * 64)\r\n\r\n\t\t\r\n\t\tvar size = Math.sqrt( this.bones.length * 4 ); // 4 pixels needed for 1 matrix\r\n\t\tsize = THREE.Math.nextPowerOfTwo( Math.ceil( size ) );\r\n\t\tsize = Math.max( size, 4 );\r\n\r\n\t\tthis.boneTextureWidth = size;\r\n\t\tthis.boneTextureHeight = size;\r\n\r\n\t\tthis.boneMatrices = new Float32Array( this.boneTextureWidth * this.boneTextureHeight * 4 ); // 4 floats per RGBA pixel\r\n\t\tthis.boneTexture = new THREE.DataTexture( this.boneMatrices, this.boneTextureWidth, this.boneTextureHeight, THREE.RGBAFormat, THREE.FloatType );\r\n\r\n\t} else {\r\n\r\n\t\tthis.boneMatrices = new Float32Array( 16 * this.bones.length );\r\n\r\n\t}\r\n\r\n\t// use the supplied bone inverses or calculate the inverses\r\n\r\n\tif ( boneInverses === undefined ) {\r\n\r\n\t\tthis.calculateInverses();\r\n\r\n\t} else {\r\n\r\n\t\tif ( this.bones.length === boneInverses.length ) {\r\n\r\n\t\t\tthis.boneInverses = boneInverses.slice( 0 );\r\n\r\n\t\t} else {\r\n\r\n\t\t\tconsole.warn( 'THREE.Skeleton bonInverses is the wrong length.' );\r\n\r\n\t\t\tthis.boneInverses = [];\r\n\r\n\t\t\tfor ( var b = 0, bl = this.bones.length; b < bl; b ++ ) {\r\n\r\n\t\t\t\tthis.boneInverses.push( new THREE.Matrix4() );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n};\r\n\r\nTHREE.Skeleton.prototype.calculateInverses = function () {\r\n\r\n\tthis.boneInverses = [];\r\n\r\n\tfor ( var b = 0, bl = this.bones.length; b < bl; b ++ ) {\r\n\r\n\t\tvar inverse = new THREE.Matrix4();\r\n\r\n\t\tif ( this.bones[ b ] ) {\r\n\r\n\t\t\tinverse.getInverse( this.bones[ b ].matrixWorld );\r\n\r\n\t\t}\r\n\r\n\t\tthis.boneInverses.push( inverse );\r\n\r\n\t}\r\n\r\n};\r\n\r\nTHREE.Skeleton.prototype.pose = function () {\r\n\r\n\tvar bone;\r\n\r\n\t// recover the bind-time world matrices\r\n\r\n\tfor ( var b = 0, bl = this.bones.length; b < bl; b ++ ) {\r\n\r\n\t\tbone = this.bones[ b ];\r\n\r\n\t\tif ( bone ) {\r\n\r\n\t\t\tbone.matrixWorld.getInverse( this.boneInverses[ b ] );\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t// compute the local matrices, positions, rotations and scales\r\n\r\n\tfor ( var b = 0, bl = this.bones.length; b < bl; b ++ ) {\r\n\r\n\t\tbone = this.bones[ b ];\r\n\r\n\t\tif ( bone ) {\r\n\r\n\t\t\tif ( bone.parent ) {\r\n\r\n\t\t\t\tbone.matrix.getInverse( bone.parent.matrixWorld );\r\n\t\t\t\tbone.matrix.multiply( bone.matrixWorld );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tbone.matrix.copy( bone.matrixWorld );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tbone.matrix.decompose( bone.position, bone.quaternion, bone.scale );\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n};\r\n\r\nTHREE.Skeleton.prototype.update = ( function () {\r\n\r\n\tvar offsetMatrix = new THREE.Matrix4();\r\n\r\n\treturn function update() {\r\n\r\n\t\t// flatten bone matrices to array\r\n\r\n\t\tfor ( var b = 0, bl = this.bones.length; b < bl; b ++ ) {\r\n\r\n\t\t\t// compute the offset between the current and the original transform\r\n\r\n\t\t\tvar matrix = this.bones[ b ] ? this.bones[ b ].matrixWorld : this.identityMatrix;\r\n\r\n\t\t\toffsetMatrix.multiplyMatrices( matrix, this.boneInverses[ b ] );\r\n\t\t\toffsetMatrix.toArray( this.boneMatrices, b * 16 );\r\n\r\n\t\t}\r\n\r\n\t\tif ( this.useVertexTexture ) {\r\n\r\n\t\t\tthis.boneTexture.needsUpdate = true;\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n} )();\r\n\r\nTHREE.Skeleton.prototype.clone = function () {\r\n\r\n\treturn new THREE.Skeleton( this.bones, this.boneInverses, this.useVertexTexture );\r\n\r\n};\r\n\r\n// File:src/objects/SkinnedMesh.js\r\n\r\n/**\r\n * @author mikael emtinger / http://gomo.se/\r\n * @author alteredq / http://alteredqualia.com/\r\n * @author ikerr / http://verold.com\r\n */\r\n\r\nTHREE.SkinnedMesh = function ( geometry, material, useVertexTexture ) {\r\n\r\n\tTHREE.Mesh.call( this, geometry, material );\r\n\r\n\tthis.type = 'SkinnedMesh';\r\n\r\n\tthis.bindMode = \"attached\";\r\n\tthis.bindMatrix = new THREE.Matrix4();\r\n\tthis.bindMatrixInverse = new THREE.Matrix4();\r\n\r\n\t// init bones\r\n\r\n\t// TODO: remove bone creation as there is no reason (other than\r\n\t// convenience) for THREE.SkinnedMesh to do this.\r\n\r\n\tvar bones = [];\r\n\r\n\tif ( this.geometry && this.geometry.bones !== undefined ) {\r\n\r\n\t\tvar bone, gbone;\r\n\r\n\t\tfor ( var b = 0, bl = this.geometry.bones.length; b < bl; ++ b ) {\r\n\r\n\t\t\tgbone = this.geometry.bones[ b ];\r\n\r\n\t\t\tbone = new THREE.Bone( this );\r\n\t\t\tbones.push( bone );\r\n\r\n\t\t\tbone.name = gbone.name;\r\n\t\t\tbone.position.fromArray( gbone.pos );\r\n\t\t\tbone.quaternion.fromArray( gbone.rotq );\r\n\t\t\tif ( gbone.scl !== undefined ) bone.scale.fromArray( gbone.scl );\r\n\r\n\t\t}\r\n\r\n\t\tfor ( var b = 0, bl = this.geometry.bones.length; b < bl; ++ b ) {\r\n\r\n\t\t\tgbone = this.geometry.bones[ b ];\r\n\r\n\t\t\tif ( gbone.parent !== - 1 && gbone.parent !== null &&\r\n\t\t\t\t\tbones[ gbone.parent ] !== undefined ) {\r\n\r\n\t\t\t\tbones[ gbone.parent ].add( bones[ b ] );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tthis.add( bones[ b ] );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tthis.normalizeSkinWeights();\r\n\r\n\tthis.updateMatrixWorld( true );\r\n\tthis.bind( new THREE.Skeleton( bones, undefined, useVertexTexture ), this.matrixWorld );\r\n\r\n};\r\n\r\n\r\nTHREE.SkinnedMesh.prototype = Object.create( THREE.Mesh.prototype );\r\nTHREE.SkinnedMesh.prototype.constructor = THREE.SkinnedMesh;\r\n\r\nTHREE.SkinnedMesh.prototype.bind = function( skeleton, bindMatrix ) {\r\n\r\n\tthis.skeleton = skeleton;\r\n\r\n\tif ( bindMatrix === undefined ) {\r\n\r\n\t\tthis.updateMatrixWorld( true );\r\n\r\n\t\tthis.skeleton.calculateInverses();\r\n\r\n\t\tbindMatrix = this.matrixWorld;\r\n\r\n\t}\r\n\r\n\tthis.bindMatrix.copy( bindMatrix );\r\n\tthis.bindMatrixInverse.getInverse( bindMatrix );\r\n\r\n};\r\n\r\nTHREE.SkinnedMesh.prototype.pose = function () {\r\n\r\n\tthis.skeleton.pose();\r\n\r\n};\r\n\r\nTHREE.SkinnedMesh.prototype.normalizeSkinWeights = function () {\r\n\r\n\tif ( this.geometry instanceof THREE.Geometry ) {\r\n\r\n\t\tfor ( var i = 0; i < this.geometry.skinWeights.length; i ++ ) {\r\n\r\n\t\t\tvar sw = this.geometry.skinWeights[ i ];\r\n\r\n\t\t\tvar scale = 1.0 / sw.lengthManhattan();\r\n\r\n\t\t\tif ( scale !== Infinity ) {\r\n\r\n\t\t\t\tsw.multiplyScalar( scale );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tsw.set( 1, 0, 0, 0 ); // do something reasonable\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t} else if ( this.geometry instanceof THREE.BufferGeometry ) {\r\n\r\n\t\tvar vec = new THREE.Vector4();\r\n\r\n\t\tvar skinWeight = this.geometry.attributes.skinWeight;\r\n\r\n\t\tfor ( var i = 0; i < skinWeight.count; i ++ ) {\r\n\r\n\t\t\tvec.x = skinWeight.getX( i );\r\n\t\t\tvec.y = skinWeight.getY( i );\r\n\t\t\tvec.z = skinWeight.getZ( i );\r\n\t\t\tvec.w = skinWeight.getW( i );\r\n\r\n\t\t\tvar scale = 1.0 / vec.lengthManhattan();\r\n\r\n\t\t\tif ( scale !== Infinity ) {\r\n\r\n\t\t\t\tvec.multiplyScalar( scale );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tvec.set( 1, 0, 0, 0 ); // do something reasonable\r\n\r\n\t\t\t}\r\n\r\n\t\t\tskinWeight.setXYZW( i, vec.x, vec.y, vec.z, vec.w );\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n};\r\n\r\nTHREE.SkinnedMesh.prototype.updateMatrixWorld = function( force ) {\r\n\r\n\tTHREE.Mesh.prototype.updateMatrixWorld.call( this, true );\r\n\r\n\tif ( this.bindMode === \"attached\" ) {\r\n\r\n\t\tthis.bindMatrixInverse.getInverse( this.matrixWorld );\r\n\r\n\t} else if ( this.bindMode === \"detached\" ) {\r\n\r\n\t\tthis.bindMatrixInverse.getInverse( this.bindMatrix );\r\n\r\n\t} else {\r\n\r\n\t\tconsole.warn( 'THREE.SkinnedMesh unrecognized bindMode: ' + this.bindMode );\r\n\r\n\t}\r\n\r\n};\r\n\r\nTHREE.SkinnedMesh.prototype.clone = function() {\r\n\r\n\treturn new this.constructor( this.geometry, this.material, this.useVertexTexture ).copy( this );\r\n\r\n};\r\n\r\n// File:src/objects/LOD.js\r\n\r\n/**\r\n * @author mikael emtinger / http://gomo.se/\r\n * @author alteredq / http://alteredqualia.com/\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.LOD = function () {\r\n\r\n\tTHREE.Object3D.call( this );\r\n\r\n\tthis.type = 'LOD';\r\n\r\n\tObject.defineProperties( this, {\r\n\t\tlevels: {\r\n\t\t\tenumerable: true,\r\n\t\t\tvalue: []\r\n\t\t}\r\n\t} );\r\n\r\n};\r\n\r\n\r\nTHREE.LOD.prototype = Object.create( THREE.Object3D.prototype );\r\nTHREE.LOD.prototype.constructor = THREE.LOD;\r\n\r\nTHREE.LOD.prototype.addLevel = function ( object, distance ) {\r\n\r\n\tif ( distance === undefined ) distance = 0;\r\n\r\n\tdistance = Math.abs( distance );\r\n\r\n\tvar levels = this.levels;\r\n\r\n\tfor ( var l = 0; l < levels.length; l ++ ) {\r\n\r\n\t\tif ( distance < levels[ l ].distance ) {\r\n\r\n\t\t\tbreak;\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tlevels.splice( l, 0, { distance: distance, object: object } );\r\n\r\n\tthis.add( object );\r\n\r\n};\r\n\r\nTHREE.LOD.prototype.getObjectForDistance = function ( distance ) {\r\n\r\n\tvar levels = this.levels;\r\n\r\n\tfor ( var i = 1, l = levels.length; i < l; i ++ ) {\r\n\r\n\t\tif ( distance < levels[ i ].distance ) {\r\n\r\n\t\t\tbreak;\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\treturn levels[ i - 1 ].object;\r\n\r\n};\r\n\r\nTHREE.LOD.prototype.raycast = ( function () {\r\n\r\n\tvar matrixPosition = new THREE.Vector3();\r\n\r\n\treturn function raycast( raycaster, intersects ) {\r\n\r\n\t\tmatrixPosition.setFromMatrixPosition( this.matrixWorld );\r\n\r\n\t\tvar distance = raycaster.ray.origin.distanceTo( matrixPosition );\r\n\r\n\t\tthis.getObjectForDistance( distance ).raycast( raycaster, intersects );\r\n\r\n\t};\r\n\r\n}() );\r\n\r\nTHREE.LOD.prototype.update = function () {\r\n\r\n\tvar v1 = new THREE.Vector3();\r\n\tvar v2 = new THREE.Vector3();\r\n\r\n\treturn function update( camera ) {\r\n\r\n\t\tvar levels = this.levels;\r\n\r\n\t\tif ( levels.length > 1 ) {\r\n\r\n\t\t\tv1.setFromMatrixPosition( camera.matrixWorld );\r\n\t\t\tv2.setFromMatrixPosition( this.matrixWorld );\r\n\r\n\t\t\tvar distance = v1.distanceTo( v2 );\r\n\r\n\t\t\tlevels[ 0 ].object.visible = true;\r\n\r\n\t\t\tfor ( var i = 1, l = levels.length; i < l; i ++ ) {\r\n\r\n\t\t\t\tif ( distance >= levels[ i ].distance ) {\r\n\r\n\t\t\t\t\tlevels[ i - 1 ].object.visible = false;\r\n\t\t\t\t\tlevels[ i ].object.visible = true;\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tfor ( ; i < l; i ++ ) {\r\n\r\n\t\t\t\tlevels[ i ].object.visible = false;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n}();\r\n\r\nTHREE.LOD.prototype.copy = function ( source ) {\r\n\r\n\tTHREE.Object3D.prototype.copy.call( this, source, false );\r\n\r\n\tvar levels = source.levels;\r\n\r\n\tfor ( var i = 0, l = levels.length; i < l; i ++ ) {\r\n\r\n\t\tvar level = levels[ i ];\r\n\r\n\t\tthis.addLevel( level.object.clone(), level.distance );\r\n\r\n\t}\r\n\r\n\treturn this;\r\n\r\n};\r\n\r\nTHREE.LOD.prototype.toJSON = function ( meta ) {\r\n\r\n\tvar data = THREE.Object3D.prototype.toJSON.call( this, meta );\r\n\r\n\tdata.object.levels = [];\r\n\r\n\tvar levels = this.levels;\r\n\r\n\tfor ( var i = 0, l = levels.length; i < l; i ++ ) {\r\n\r\n\t\tvar level = levels[ i ];\r\n\r\n\t\tdata.object.levels.push( {\r\n\t\t\tobject: level.object.uuid,\r\n\t\t\tdistance: level.distance\r\n\t\t} );\r\n\r\n\t}\r\n\r\n\treturn data;\r\n\r\n};\r\n\r\n// File:src/objects/Sprite.js\r\n\r\n/**\r\n * @author mikael emtinger / http://gomo.se/\r\n * @author alteredq / http://alteredqualia.com/\r\n */\r\n\r\nTHREE.Sprite = ( function () {\r\n\r\n\tvar indices = new Uint16Array( [ 0, 1, 2,  0, 2, 3 ] );\r\n\tvar vertices = new Float32Array( [ - 0.5, - 0.5, 0,   0.5, - 0.5, 0,   0.5, 0.5, 0,   - 0.5, 0.5, 0 ] );\r\n\tvar uvs = new Float32Array( [ 0, 0,   1, 0,   1, 1,   0, 1 ] );\r\n\r\n\tvar geometry = new THREE.BufferGeometry();\r\n\tgeometry.setIndex( new THREE.BufferAttribute( indices, 1 ) );\r\n\tgeometry.addAttribute( 'position', new THREE.BufferAttribute( vertices, 3 ) );\r\n\tgeometry.addAttribute( 'uv', new THREE.BufferAttribute( uvs, 2 ) );\r\n\r\n\treturn function Sprite( material ) {\r\n\r\n\t\tTHREE.Object3D.call( this );\r\n\r\n\t\tthis.type = 'Sprite';\r\n\r\n\t\tthis.geometry = geometry;\r\n\t\tthis.material = ( material !== undefined ) ? material : new THREE.SpriteMaterial();\r\n\r\n\t};\r\n\r\n} )();\r\n\r\nTHREE.Sprite.prototype = Object.create( THREE.Object3D.prototype );\r\nTHREE.Sprite.prototype.constructor = THREE.Sprite;\r\n\r\nTHREE.Sprite.prototype.raycast = ( function () {\r\n\r\n\tvar matrixPosition = new THREE.Vector3();\r\n\r\n\treturn function raycast( raycaster, intersects ) {\r\n\r\n\t\tmatrixPosition.setFromMatrixPosition( this.matrixWorld );\r\n\r\n\t\tvar distanceSq = raycaster.ray.distanceSqToPoint( matrixPosition );\r\n\t\tvar guessSizeSq = this.scale.x * this.scale.y / 4;\r\n\r\n\t\tif ( distanceSq > guessSizeSq ) {\r\n\r\n\t\t\treturn;\r\n\r\n\t\t}\r\n\r\n\t\tintersects.push( {\r\n\r\n\t\t\tdistance: Math.sqrt( distanceSq ),\r\n\t\t\tpoint: this.position,\r\n\t\t\tface: null,\r\n\t\t\tobject: this\r\n\r\n\t\t} );\r\n\r\n\t};\r\n\r\n}() );\r\n\r\nTHREE.Sprite.prototype.clone = function () {\r\n\r\n\treturn new this.constructor( this.material ).copy( this );\r\n\r\n};\r\n\r\n// Backwards compatibility\r\n\r\nTHREE.Particle = THREE.Sprite;\r\n\r\n// File:src/objects/LensFlare.js\r\n\r\n/**\r\n * @author mikael emtinger / http://gomo.se/\r\n * @author alteredq / http://alteredqualia.com/\r\n */\r\n\r\nTHREE.LensFlare = function ( texture, size, distance, blending, color ) {\r\n\r\n\tTHREE.Object3D.call( this );\r\n\r\n\tthis.lensFlares = [];\r\n\r\n\tthis.positionScreen = new THREE.Vector3();\r\n\tthis.customUpdateCallback = undefined;\r\n\r\n\tif ( texture !== undefined ) {\r\n\r\n\t\tthis.add( texture, size, distance, blending, color );\r\n\r\n\t}\r\n\r\n};\r\n\r\nTHREE.LensFlare.prototype = Object.create( THREE.Object3D.prototype );\r\nTHREE.LensFlare.prototype.constructor = THREE.LensFlare;\r\n\r\n\r\n/*\r\n * Add: adds another flare\r\n */\r\n\r\nTHREE.LensFlare.prototype.add = function ( texture, size, distance, blending, color, opacity ) {\r\n\r\n\tif ( size === undefined ) size = - 1;\r\n\tif ( distance === undefined ) distance = 0;\r\n\tif ( opacity === undefined ) opacity = 1;\r\n\tif ( color === undefined ) color = new THREE.Color( 0xffffff );\r\n\tif ( blending === undefined ) blending = THREE.NormalBlending;\r\n\r\n\tdistance = Math.min( distance, Math.max( 0, distance ) );\r\n\r\n\tthis.lensFlares.push( {\r\n\t\ttexture: texture,\t// THREE.Texture\r\n\t\tsize: size, \t\t// size in pixels (-1 = use texture.width)\r\n\t\tdistance: distance, \t// distance (0-1) from light source (0=at light source)\r\n\t\tx: 0, y: 0, z: 0,\t// screen position (-1 => 1) z = 0 is in front z = 1 is back\r\n\t\tscale: 1, \t\t// scale\r\n\t\trotation: 0, \t\t// rotation\r\n\t\topacity: opacity,\t// opacity\r\n\t\tcolor: color,\t\t// color\r\n\t\tblending: blending\t// blending\r\n\t} );\r\n\r\n};\r\n\r\n/*\r\n * Update lens flares update positions on all flares based on the screen position\r\n * Set myLensFlare.customUpdateCallback to alter the flares in your project specific way.\r\n */\r\n\r\nTHREE.LensFlare.prototype.updateLensFlares = function () {\r\n\r\n\tvar f, fl = this.lensFlares.length;\r\n\tvar flare;\r\n\tvar vecX = - this.positionScreen.x * 2;\r\n\tvar vecY = - this.positionScreen.y * 2;\r\n\r\n\tfor ( f = 0; f < fl; f ++ ) {\r\n\r\n\t\tflare = this.lensFlares[ f ];\r\n\r\n\t\tflare.x = this.positionScreen.x + vecX * flare.distance;\r\n\t\tflare.y = this.positionScreen.y + vecY * flare.distance;\r\n\r\n\t\tflare.wantedRotation = flare.x * Math.PI * 0.25;\r\n\t\tflare.rotation += ( flare.wantedRotation - flare.rotation ) * 0.25;\r\n\r\n\t}\r\n\r\n};\r\n\r\nTHREE.LensFlare.prototype.copy = function ( source ) {\r\n\r\n\tTHREE.Object3D.prototype.copy.call( this, source );\r\n\r\n\tthis.positionScreen.copy( source.positionScreen );\r\n\tthis.customUpdateCallback = source.customUpdateCallback;\r\n\r\n\tfor ( var i = 0, l = source.lensFlares.length; i < l; i ++ ) {\r\n\r\n\t\tthis.lensFlares.push( source.lensFlares[ i ] );\r\n\r\n\t}\r\n\r\n\treturn this;\r\n\r\n};\r\n\r\n// File:src/scenes/Scene.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.Scene = function () {\r\n\r\n\tTHREE.Object3D.call( this );\r\n\r\n\tthis.type = 'Scene';\r\n\r\n\tthis.fog = null;\r\n\tthis.overrideMaterial = null;\r\n\r\n\tthis.autoUpdate = true; // checked by the renderer\r\n\r\n};\r\n\r\nTHREE.Scene.prototype = Object.create( THREE.Object3D.prototype );\r\nTHREE.Scene.prototype.constructor = THREE.Scene;\r\n\r\nTHREE.Scene.prototype.copy = function ( source, recursive ) {\r\n\r\n\tTHREE.Object3D.prototype.copy.call( this, source, recursive );\r\n\r\n\tif ( source.fog !== null ) this.fog = source.fog.clone();\r\n\tif ( source.overrideMaterial !== null ) this.overrideMaterial = source.overrideMaterial.clone();\r\n\r\n\tthis.autoUpdate = source.autoUpdate;\r\n\tthis.matrixAutoUpdate = source.matrixAutoUpdate;\r\n\r\n\treturn this;\r\n\r\n};\r\n\r\n// File:src/scenes/Fog.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author alteredq / http://alteredqualia.com/\r\n */\r\n\r\nTHREE.Fog = function ( color, near, far ) {\r\n\r\n\tthis.name = '';\r\n\r\n\tthis.color = new THREE.Color( color );\r\n\r\n\tthis.near = ( near !== undefined ) ? near : 1;\r\n\tthis.far = ( far !== undefined ) ? far : 1000;\r\n\r\n};\r\n\r\nTHREE.Fog.prototype.clone = function () {\r\n\r\n\treturn new THREE.Fog( this.color.getHex(), this.near, this.far );\r\n\r\n};\r\n\r\n// File:src/scenes/FogExp2.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author alteredq / http://alteredqualia.com/\r\n */\r\n\r\nTHREE.FogExp2 = function ( color, density ) {\r\n\r\n\tthis.name = '';\r\n\r\n\tthis.color = new THREE.Color( color );\r\n\tthis.density = ( density !== undefined ) ? density : 0.00025;\r\n\r\n};\r\n\r\nTHREE.FogExp2.prototype.clone = function () {\r\n\r\n\treturn new THREE.FogExp2( this.color.getHex(), this.density );\r\n\r\n};\r\n\r\n// File:src/renderers/shaders/ShaderChunk.js\r\n\r\nTHREE.ShaderChunk = {};\r\n\r\n// File:src/renderers/shaders/ShaderChunk/alphamap_fragment.glsl\r\n\r\nTHREE.ShaderChunk[ 'alphamap_fragment' ] = \"#ifdef USE_ALPHAMAP\\n\tdiffuseColor.a *= texture2D( alphaMap, vUv ).g;\\n#endif\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/alphamap_pars_fragment.glsl\r\n\r\nTHREE.ShaderChunk[ 'alphamap_pars_fragment' ] = \"#ifdef USE_ALPHAMAP\\n\tuniform sampler2D alphaMap;\\n#endif\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/alphatest_fragment.glsl\r\n\r\nTHREE.ShaderChunk[ 'alphatest_fragment' ] = \"#ifdef ALPHATEST\\n\tif ( diffuseColor.a < ALPHATEST ) discard;\\n#endif\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/aomap_fragment.glsl\r\n\r\nTHREE.ShaderChunk[ 'aomap_fragment' ] = \"#ifdef USE_AOMAP\\n\tfloat ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;\\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\\n\t#if defined( USE_ENVMAP ) && defined( PHYSICAL )\\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.specularRoughness );\\n\t#endif\\n#endif\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/aomap_pars_fragment.glsl\r\n\r\nTHREE.ShaderChunk[ 'aomap_pars_fragment' ] = \"#ifdef USE_AOMAP\\n\tuniform sampler2D aoMap;\\n\tuniform float aoMapIntensity;\\n#endif\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/begin_vertex.glsl\r\n\r\nTHREE.ShaderChunk[ 'begin_vertex' ] = \"\\nvec3 transformed = vec3( position );\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/beginnormal_vertex.glsl\r\n\r\nTHREE.ShaderChunk[ 'beginnormal_vertex' ] = \"\\nvec3 objectNormal = vec3( normal );\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/bsdfs.glsl\r\n\r\nTHREE.ShaderChunk[ 'bsdfs' ] = \"bool testLightInRange( const in float lightDistance, const in float cutoffDistance ) {\\n\treturn any( bvec2( cutoffDistance == 0.0, lightDistance < cutoffDistance ) );\\n}\\nfloat punctualLightIntensityToIrradianceFactor( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\\n\t\tif( decayExponent > 0.0 ) {\\n#if defined ( PHYSICALLY_CORRECT_LIGHTS )\\n\t\t\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\\n\t\t\tfloat maxDistanceCutoffFactor = pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\\n\t\t\treturn distanceFalloff * maxDistanceCutoffFactor;\\n#else\\n\t\t\treturn pow( saturate( -lightDistance / cutoffDistance + 1.0 ), decayExponent );\\n#endif\\n\t\t}\\n\t\treturn 1.0;\\n}\\nvec3 BRDF_Diffuse_Lambert( const in vec3 diffuseColor ) {\\n\treturn RECIPROCAL_PI * diffuseColor;\\n}\\nvec3 F_Schlick( const in vec3 specularColor, const in float dotLH ) {\\n\tfloat fresnel = exp2( ( -5.55473 * dotLH - 6.98316 ) * dotLH );\\n\treturn ( 1.0 - specularColor ) * fresnel + specularColor;\\n}\\nfloat G_GGX_Smith( const in float alpha, const in float dotNL, const in float dotNV ) {\\n\tfloat a2 = pow2( alpha );\\n\tfloat gl = dotNL + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\\n\tfloat gv = dotNV + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\\n\treturn 1.0 / ( gl * gv );\\n}\\nfloat G_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\\n\tfloat a2 = pow2( alpha );\\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\\n\treturn 0.5 / max( gv + gl, EPSILON );\\n}\\nfloat D_GGX( const in float alpha, const in float dotNH ) {\\n\tfloat a2 = pow2( alpha );\\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\\n}\\nvec3 BRDF_Specular_GGX( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float roughness ) {\\n\tfloat alpha = pow2( roughness );\\n\tvec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );\\n\tfloat dotNL = saturate( dot( geometry.normal, incidentLight.direction ) );\\n\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\\n\tfloat dotNH = saturate( dot( geometry.normal, halfDir ) );\\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\\n\tvec3 F = F_Schlick( specularColor, dotLH );\\n\tfloat G = G_GGX_SmithCorrelated( alpha, dotNL, dotNV );\\n\tfloat D = D_GGX( alpha, dotNH );\\n\treturn F * ( G * D );\\n}\\nvec3 BRDF_Specular_GGX_Environment( const in GeometricContext geometry, const in vec3 specularColor, const in float roughness ) {\\n\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\\n\tvec4 r = roughness * c0 + c1;\\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\\n\tvec2 AB = vec2( -1.04, 1.04 ) * a004 + r.zw;\\n\treturn specularColor * AB.x + AB.y;\\n}\\nfloat G_BlinnPhong_Implicit( ) {\\n\treturn 0.25;\\n}\\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\\n}\\nvec3 BRDF_Specular_BlinnPhong( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float shininess ) {\\n\tvec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );\\n\tfloat dotNH = saturate( dot( geometry.normal, halfDir ) );\\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\\n\tvec3 F = F_Schlick( specularColor, dotLH );\\n\tfloat G = G_BlinnPhong_Implicit( );\\n\tfloat D = D_BlinnPhong( shininess, dotNH );\\n\treturn F * ( G * D );\\n}\\nfloat GGXRoughnessToBlinnExponent( const in float ggxRoughness ) {\\n\treturn ( 2.0 / pow2( ggxRoughness + 0.0001 ) - 2.0 );\\n}\\nfloat BlinnExponentToGGXRoughness( const in float blinnExponent ) {\\n\treturn sqrt( 2.0 / ( blinnExponent + 2.0 ) );\\n}\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/bumpmap_pars_fragment.glsl\r\n\r\nTHREE.ShaderChunk[ 'bumpmap_pars_fragment' ] = \"#ifdef USE_BUMPMAP\\n\tuniform sampler2D bumpMap;\\n\tuniform float bumpScale;\\n\tvec2 dHdxy_fwd() {\\n\t\tvec2 dSTdx = dFdx( vUv );\\n\t\tvec2 dSTdy = dFdy( vUv );\\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;\\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\\n\t\treturn vec2( dBx, dBy );\\n\t}\\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy ) {\\n\t\tvec3 vSigmaX = dFdx( surf_pos );\\n\t\tvec3 vSigmaY = dFdy( surf_pos );\\n\t\tvec3 vN = surf_norm;\\n\t\tvec3 R1 = cross( vSigmaY, vN );\\n\t\tvec3 R2 = cross( vN, vSigmaX );\\n\t\tfloat fDet = dot( vSigmaX, R1 );\\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\\n\t}\\n#endif\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/clipping_planes_fragment.glsl\r\n\r\nTHREE.ShaderChunk[ 'clipping_planes_fragment' ] = \"#if NUM_CLIPPING_PLANES > 0\\n\tfor ( int i = 0; i < NUM_CLIPPING_PLANES; ++ i ) {\\n\t\tvec4 plane = clippingPlanes[ i ];\\n\t\tif ( dot( vViewPosition, plane.xyz ) > plane.w ) discard;\\n\t}\\n#endif\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/clipping_planes_pars_fragment.glsl\r\n\r\nTHREE.ShaderChunk[ 'clipping_planes_pars_fragment' ] = \"#if NUM_CLIPPING_PLANES > 0\\n\t#if ! defined( PHYSICAL ) && ! defined( PHONG )\\n\t\tvarying vec3 vViewPosition;\\n\t#endif\\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\\n#endif\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/clipping_planes_pars_vertex.glsl\r\n\r\nTHREE.ShaderChunk[ 'clipping_planes_pars_vertex' ] = \"#if NUM_CLIPPING_PLANES > 0 && ! defined( PHYSICAL ) && ! defined( PHONG )\\n\tvarying vec3 vViewPosition;\\n#endif\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/clipping_planes_vertex.glsl\r\n\r\nTHREE.ShaderChunk[ 'clipping_planes_vertex' ] = \"#if NUM_CLIPPING_PLANES > 0 && ! defined( PHYSICAL ) && ! defined( PHONG )\\n\tvViewPosition = - mvPosition.xyz;\\n#endif\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/color_fragment.glsl\r\n\r\nTHREE.ShaderChunk[ 'color_fragment' ] = \"#ifdef USE_COLOR\\n\tdiffuseColor.rgb *= vColor;\\n#endif\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/color_pars_fragment.glsl\r\n\r\nTHREE.ShaderChunk[ 'color_pars_fragment' ] = \"#ifdef USE_COLOR\\n\tvarying vec3 vColor;\\n#endif\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/color_pars_vertex.glsl\r\n\r\nTHREE.ShaderChunk[ 'color_pars_vertex' ] = \"#ifdef USE_COLOR\\n\tvarying vec3 vColor;\\n#endif\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/color_vertex.glsl\r\n\r\nTHREE.ShaderChunk[ 'color_vertex' ] = \"#ifdef USE_COLOR\\n\tvColor.xyz = color.xyz;\\n#endif\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/common.glsl\r\n\r\nTHREE.ShaderChunk[ 'common' ] = \"#define PI 3.14159265359\\n#define PI2 6.28318530718\\n#define RECIPROCAL_PI 0.31830988618\\n#define RECIPROCAL_PI2 0.15915494\\n#define LOG2 1.442695\\n#define EPSILON 1e-6\\n#define saturate(a) clamp( a, 0.0, 1.0 )\\n#define whiteCompliment(a) ( 1.0 - saturate( a ) )\\nfloat pow2( const in float x ) { return x*x; }\\nfloat pow3( const in float x ) { return x*x*x; }\\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\\nfloat average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }\\nhighp float rand( const in vec2 uv ) {\\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\\n\treturn fract(sin(sn) * c);\\n}\\nstruct IncidentLight {\\n\tvec3 color;\\n\tvec3 direction;\\n\tbool visible;\\n};\\nstruct ReflectedLight {\\n\tvec3 directDiffuse;\\n\tvec3 directSpecular;\\n\tvec3 indirectDiffuse;\\n\tvec3 indirectSpecular;\\n};\\nstruct GeometricContext {\\n\tvec3 position;\\n\tvec3 normal;\\n\tvec3 viewDir;\\n};\\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\\n}\\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\\n}\\nvec3 projectOnPlane(in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\\n\tfloat distance = dot( planeNormal, point - pointOnPlane );\\n\treturn - distance * planeNormal + point;\\n}\\nfloat sideOfPlane( in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\\n\treturn sign( dot( point - pointOnPlane, planeNormal ) );\\n}\\nvec3 linePlaneIntersect( in vec3 pointOnLine, in vec3 lineDirection, in vec3 pointOnPlane, in vec3 planeNormal ) {\\n\treturn lineDirection * ( dot( planeNormal, pointOnPlane - pointOnLine ) / dot( planeNormal, lineDirection ) ) + pointOnLine;\\n}\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/cube_uv_reflection_fragment.glsl\r\n\r\nTHREE.ShaderChunk[ 'cube_uv_reflection_fragment' ] = \"#ifdef ENVMAP_TYPE_CUBE_UV\\nconst float cubeUV_textureSize = 1024.0;\\nint getFaceFromDirection(vec3 direction) {\\n\tvec3 absDirection = abs(direction);\\n\tint face = -1;\\n\tif( absDirection.x > absDirection.z ) {\\n\t\tif(absDirection.x > absDirection.y )\\n\t\t\tface = direction.x > 0.0 ? 0 : 3;\\n\t\telse\\n\t\t\tface = direction.y > 0.0 ? 1 : 4;\\n\t}\\n\telse {\\n\t\tif(absDirection.z > absDirection.y )\\n\t\t\tface = direction.z > 0.0 ? 2 : 5;\\n\t\telse\\n\t\t\tface = direction.y > 0.0 ? 1 : 4;\\n\t}\\n\treturn face;\\n}\\nfloat cubeUV_maxLods1 = log2(cubeUV_textureSize*0.25) - 1.0;\\nfloat cubeUV_rangeClamp = exp2((6.0 - 1.0) * 2.0);\\nvec2 MipLevelInfo( vec3 vec, float roughnessLevel, float roughness ) {\\n\tfloat scale = exp2(cubeUV_maxLods1 - roughnessLevel);\\n\tfloat dxRoughness = dFdx(roughness);\\n\tfloat dyRoughness = dFdy(roughness);\\n\tvec3 dx = dFdx( vec * scale * dxRoughness );\\n\tvec3 dy = dFdy( vec * scale * dyRoughness );\\n\tfloat d = max( dot( dx, dx ), dot( dy, dy ) );\\n\td = clamp(d, 1.0, cubeUV_rangeClamp);\\n\tfloat mipLevel = 0.5 * log2(d);\\n\treturn vec2(floor(mipLevel), fract(mipLevel));\\n}\\nfloat cubeUV_maxLods2 = log2(cubeUV_textureSize*0.25) - 2.0;\\nconst float cubeUV_rcpTextureSize = 1.0 / cubeUV_textureSize;\\nvec2 getCubeUV(vec3 direction, float roughnessLevel, float mipLevel) {\\n\tmipLevel = roughnessLevel > cubeUV_maxLods2 - 3.0 ? 0.0 : mipLevel;\\n\tfloat a = 16.0 * cubeUV_rcpTextureSize;\\n\tvec2 exp2_packed = exp2( vec2( roughnessLevel, mipLevel ) );\\n\tvec2 rcp_exp2_packed = vec2( 1.0 ) / exp2_packed;\\n\tfloat powScale = exp2_packed.x * exp2_packed.y;\\n\tfloat scale = rcp_exp2_packed.x * rcp_exp2_packed.y * 0.25;\\n\tfloat mipOffset = 0.75*(1.0 - rcp_exp2_packed.y) * rcp_exp2_packed.x;\\n\tbool bRes = mipLevel == 0.0;\\n\tscale =  bRes && (scale < a) ? a : scale;\\n\tvec3 r;\\n\tvec2 offset;\\n\tint face = getFaceFromDirection(direction);\\n\tfloat rcpPowScale = 1.0 / powScale;\\n\tif( face == 0) {\\n\t\tr = vec3(direction.x, -direction.z, direction.y);\\n\t\toffset = vec2(0.0+mipOffset,0.75 * rcpPowScale);\\n\t\toffset.y = bRes && (offset.y < 2.0*a) ?  a : offset.y;\\n\t}\\n\telse if( face == 1) {\\n\t\tr = vec3(direction.y, direction.x, direction.z);\\n\t\toffset = vec2(scale+mipOffset, 0.75 * rcpPowScale);\\n\t\toffset.y = bRes && (offset.y < 2.0*a) ?  a : offset.y;\\n\t}\\n\telse if( face == 2) {\\n\t\tr = vec3(direction.z, direction.x, direction.y);\\n\t\toffset = vec2(2.0*scale+mipOffset, 0.75 * rcpPowScale);\\n\t\toffset.y = bRes && (offset.y < 2.0*a) ?  a : offset.y;\\n\t}\\n\telse if( face == 3) {\\n\t\tr = vec3(direction.x, direction.z, direction.y);\\n\t\toffset = vec2(0.0+mipOffset,0.5 * rcpPowScale);\\n\t\toffset.y = bRes && (offset.y < 2.0*a) ?  0.0 : offset.y;\\n\t}\\n\telse if( face == 4) {\\n\t\tr = vec3(direction.y, direction.x, -direction.z);\\n\t\toffset = vec2(scale+mipOffset, 0.5 * rcpPowScale);\\n\t\toffset.y = bRes && (offset.y < 2.0*a) ?  0.0 : offset.y;\\n\t}\\n\telse {\\n\t\tr = vec3(direction.z, -direction.x, direction.y);\\n\t\toffset = vec2(2.0*scale+mipOffset, 0.5 * rcpPowScale);\\n\t\toffset.y = bRes && (offset.y < 2.0*a) ?  0.0 : offset.y;\\n\t}\\n\tr = normalize(r);\\n\tfloat texelOffset = 0.5 * cubeUV_rcpTextureSize;\\n\tvec2 s = ( r.yz / abs( r.x ) + vec2( 1.0 ) ) * 0.5;\\n\tvec2 base = offset + vec2( texelOffset );\\n\treturn base + s * ( scale - 2.0 * texelOffset );\\n}\\nfloat cubeUV_maxLods3 = log2(cubeUV_textureSize*0.25) - 3.0;\\nvec4 textureCubeUV(vec3 reflectedDirection, float roughness ) {\\n\tfloat roughnessVal = roughness* cubeUV_maxLods3;\\n\tfloat r1 = floor(roughnessVal);\\n\tfloat r2 = r1 + 1.0;\\n\tfloat t = fract(roughnessVal);\\n\tvec2 mipInfo = MipLevelInfo(reflectedDirection, r1, roughness);\\n\tfloat s = mipInfo.y;\\n\tfloat level0 = mipInfo.x;\\n\tfloat level1 = level0 + 1.0;\\n\tlevel1 = level1 > 5.0 ? 5.0 : level1;\\n\tlevel0 += min( floor( s + 0.5 ), 5.0 );\\n\tvec2 uv_10 = getCubeUV(reflectedDirection, r1, level0);\\n\tvec4 color10 = envMapTexelToLinear(texture2D(envMap, uv_10));\\n\tvec2 uv_20 = getCubeUV(reflectedDirection, r2, level0);\\n\tvec4 color20 = envMapTexelToLinear(texture2D(envMap, uv_20));\\n\tvec4 result = mix(color10, color20, t);\\n\treturn vec4(result.rgb, 1.0);\\n}\\n#endif\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/defaultnormal_vertex.glsl\r\n\r\nTHREE.ShaderChunk[ 'defaultnormal_vertex' ] = \"#ifdef FLIP_SIDED\\n\tobjectNormal = -objectNormal;\\n#endif\\nvec3 transformedNormal = normalMatrix * objectNormal;\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/displacementmap_vertex.glsl\r\n\r\nTHREE.ShaderChunk[ 'displacementmap_vertex' ] = \"#ifdef USE_DISPLACEMENTMAP\\n\ttransformed += normal * ( texture2D( displacementMap, uv ).x * displacementScale + displacementBias );\\n#endif\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/displacementmap_pars_vertex.glsl\r\n\r\nTHREE.ShaderChunk[ 'displacementmap_pars_vertex' ] = \"#ifdef USE_DISPLACEMENTMAP\\n\tuniform sampler2D displacementMap;\\n\tuniform float displacementScale;\\n\tuniform float displacementBias;\\n#endif\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/emissivemap_fragment.glsl\r\n\r\nTHREE.ShaderChunk[ 'emissivemap_fragment' ] = \"#ifdef USE_EMISSIVEMAP\\n\tvec4 emissiveColor = texture2D( emissiveMap, vUv );\\n\temissiveColor.rgb = emissiveMapTexelToLinear( emissiveColor ).rgb;\\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\\n#endif\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/emissivemap_pars_fragment.glsl\r\n\r\nTHREE.ShaderChunk[ 'emissivemap_pars_fragment' ] = \"#ifdef USE_EMISSIVEMAP\\n\tuniform sampler2D emissiveMap;\\n#endif\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/encodings_pars_fragment.glsl\r\n\r\nTHREE.ShaderChunk[ 'encodings_pars_fragment' ] = \"\\nvec4 LinearToLinear( in vec4 value ) {\\n  return value;\\n}\\nvec4 GammaToLinear( in vec4 value, in float gammaFactor ) {\\n  return vec4( pow( value.xyz, vec3( gammaFactor ) ), value.w );\\n}\\nvec4 LinearToGamma( in vec4 value, in float gammaFactor ) {\\n  return vec4( pow( value.xyz, vec3( 1.0 / gammaFactor ) ), value.w );\\n}\\nvec4 sRGBToLinear( in vec4 value ) {\\n  return vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.w );\\n}\\nvec4 LinearTosRGB( in vec4 value ) {\\n  return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.w );\\n}\\nvec4 RGBEToLinear( in vec4 value ) {\\n  return vec4( value.rgb * exp2( value.a * 255.0 - 128.0 ), 1.0 );\\n}\\nvec4 LinearToRGBE( in vec4 value ) {\\n  float maxComponent = max( max( value.r, value.g ), value.b );\\n  float fExp = clamp( ceil( log2( maxComponent ) ), -128.0, 127.0 );\\n  return vec4( value.rgb / exp2( fExp ), ( fExp + 128.0 ) / 255.0 );\\n}\\nvec4 RGBMToLinear( in vec4 value, in float maxRange ) {\\n  return vec4( value.xyz * value.w * maxRange, 1.0 );\\n}\\nvec4 LinearToRGBM( in vec4 value, in float maxRange ) {\\n  float maxRGB = max( value.x, max( value.g, value.b ) );\\n  float M      = clamp( maxRGB / maxRange, 0.0, 1.0 );\\n  M            = ceil( M * 255.0 ) / 255.0;\\n  return vec4( value.rgb / ( M * maxRange ), M );\\n}\\nvec4 RGBDToLinear( in vec4 value, in float maxRange ) {\\n    return vec4( value.rgb * ( ( maxRange / 255.0 ) / value.a ), 1.0 );\\n}\\nvec4 LinearToRGBD( in vec4 value, in float maxRange ) {\\n    float maxRGB = max( value.x, max( value.g, value.b ) );\\n    float D      = max( maxRange / maxRGB, 1.0 );\\n    D            = min( floor( D ) / 255.0, 1.0 );\\n    return vec4( value.rgb * ( D * ( 255.0 / maxRange ) ), D );\\n}\\nconst mat3 cLogLuvM = mat3( 0.2209, 0.3390, 0.4184, 0.1138, 0.6780, 0.7319, 0.0102, 0.1130, 0.2969 );\\nvec4 LinearToLogLuv( in vec4 value )  {\\n  vec3 Xp_Y_XYZp = value.rgb * cLogLuvM;\\n  Xp_Y_XYZp = max(Xp_Y_XYZp, vec3(1e-6, 1e-6, 1e-6));\\n  vec4 vResult;\\n  vResult.xy = Xp_Y_XYZp.xy / Xp_Y_XYZp.z;\\n  float Le = 2.0 * log2(Xp_Y_XYZp.y) + 127.0;\\n  vResult.w = fract(Le);\\n  vResult.z = (Le - (floor(vResult.w*255.0))/255.0)/255.0;\\n  return vResult;\\n}\\nconst mat3 cLogLuvInverseM = mat3( 6.0014, -2.7008, -1.7996, -1.3320, 3.1029, -5.7721, 0.3008, -1.0882, 5.6268 );\\nvec4 LogLuvToLinear( in vec4 value ) {\\n  float Le = value.z * 255.0 + value.w;\\n  vec3 Xp_Y_XYZp;\\n  Xp_Y_XYZp.y = exp2((Le - 127.0) / 2.0);\\n  Xp_Y_XYZp.z = Xp_Y_XYZp.y / value.y;\\n  Xp_Y_XYZp.x = value.x * Xp_Y_XYZp.z;\\n  vec3 vRGB = Xp_Y_XYZp.rgb * cLogLuvInverseM;\\n  return vec4( max(vRGB, 0.0), 1.0 );\\n}\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/encodings_fragment.glsl\r\n\r\nTHREE.ShaderChunk[ 'encodings_fragment' ] = \"  gl_FragColor = linearToOutputTexel( gl_FragColor );\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/envmap_fragment.glsl\r\n\r\nTHREE.ShaderChunk[ 'envmap_fragment' ] = \"#ifdef USE_ENVMAP\\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\\n\t\tvec3 cameraToVertex = normalize( vWorldPosition - cameraPosition );\\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\\n\t\t#ifdef ENVMAP_MODE_REFLECTION\\n\t\t\tvec3 reflectVec = reflect( cameraToVertex, worldNormal );\\n\t\t#else\\n\t\t\tvec3 reflectVec = refract( cameraToVertex, worldNormal, refractionRatio );\\n\t\t#endif\\n\t#else\\n\t\tvec3 reflectVec = vReflect;\\n\t#endif\\n\t#ifdef DOUBLE_SIDED\\n\t\tfloat flipNormal = ( float( gl_FrontFacing ) * 2.0 - 1.0 );\\n\t#else\\n\t\tfloat flipNormal = 1.0;\\n\t#endif\\n\t#ifdef ENVMAP_TYPE_CUBE\\n\t\tvec4 envColor = textureCube( envMap, flipNormal * vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\\n\t#elif defined( ENVMAP_TYPE_EQUIREC )\\n\t\tvec2 sampleUV;\\n\t\tsampleUV.y = saturate( flipNormal * reflectVec.y * 0.5 + 0.5 );\\n\t\tsampleUV.x = atan( flipNormal * reflectVec.z, flipNormal * reflectVec.x ) * RECIPROCAL_PI2 + 0.5;\\n\t\tvec4 envColor = texture2D( envMap, sampleUV );\\n\t#elif defined( ENVMAP_TYPE_SPHERE )\\n\t\tvec3 reflectView = flipNormal * normalize((viewMatrix * vec4( reflectVec, 0.0 )).xyz + vec3(0.0,0.0,1.0));\\n\t\tvec4 envColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5 );\\n\t#endif\\n\tenvColor = envMapTexelToLinear( envColor );\\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\\n\t#elif defined( ENVMAP_BLENDING_MIX )\\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\\n\t#elif defined( ENVMAP_BLENDING_ADD )\\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\\n\t#endif\\n#endif\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/envmap_pars_fragment.glsl\r\n\r\nTHREE.ShaderChunk[ 'envmap_pars_fragment' ] = \"#if defined( USE_ENVMAP ) || defined( PHYSICAL )\\n\tuniform float reflectivity;\\n\tuniform float envMapIntenstiy;\\n#endif\\n#ifdef USE_ENVMAP\\n\t#if ! defined( PHYSICAL ) && ( defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) )\\n\t\tvarying vec3 vWorldPosition;\\n\t#endif\\n\t#ifdef ENVMAP_TYPE_CUBE\\n\t\tuniform samplerCube envMap;\\n\t#else\\n\t\tuniform sampler2D envMap;\\n\t#endif\\n\tuniform float flipEnvMap;\\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( PHYSICAL )\\n\t\tuniform float refractionRatio;\\n\t#else\\n\t\tvarying vec3 vReflect;\\n\t#endif\\n#endif\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/envmap_pars_vertex.glsl\r\n\r\nTHREE.ShaderChunk[ 'envmap_pars_vertex' ] = \"#ifdef USE_ENVMAP\\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\\n\t\tvarying vec3 vWorldPosition;\\n\t#else\\n\t\tvarying vec3 vReflect;\\n\t\tuniform float refractionRatio;\\n\t#endif\\n#endif\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/envmap_vertex.glsl\r\n\r\nTHREE.ShaderChunk[ 'envmap_vertex' ] = \"#ifdef USE_ENVMAP\\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\\n\t\tvWorldPosition = worldPosition.xyz;\\n\t#else\\n\t\tvec3 cameraToVertex = normalize( worldPosition.xyz - cameraPosition );\\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\\n\t\t#ifdef ENVMAP_MODE_REFLECTION\\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\\n\t\t#else\\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\\n\t\t#endif\\n\t#endif\\n#endif\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/fog_fragment.glsl\r\n\r\nTHREE.ShaderChunk[ 'fog_fragment' ] = \"#ifdef USE_FOG\\n\t#ifdef USE_LOGDEPTHBUF_EXT\\n\t\tfloat depth = gl_FragDepthEXT / gl_FragCoord.w;\\n\t#else\\n\t\tfloat depth = gl_FragCoord.z / gl_FragCoord.w;\\n\t#endif\\n\t#ifdef FOG_EXP2\\n\t\tfloat fogFactor = whiteCompliment( exp2( - fogDensity * fogDensity * depth * depth * LOG2 ) );\\n\t#else\\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, depth );\\n\t#endif\\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\\n#endif\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/fog_pars_fragment.glsl\r\n\r\nTHREE.ShaderChunk[ 'fog_pars_fragment' ] = \"#ifdef USE_FOG\\n\tuniform vec3 fogColor;\\n\t#ifdef FOG_EXP2\\n\t\tuniform float fogDensity;\\n\t#else\\n\t\tuniform float fogNear;\\n\t\tuniform float fogFar;\\n\t#endif\\n#endif\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/lightmap_fragment.glsl\r\n\r\nTHREE.ShaderChunk[ 'lightmap_fragment' ] = \"#ifdef USE_LIGHTMAP\\n\treflectedLight.indirectDiffuse += PI * texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\\n#endif\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/lightmap_pars_fragment.glsl\r\n\r\nTHREE.ShaderChunk[ 'lightmap_pars_fragment' ] = \"#ifdef USE_LIGHTMAP\\n\tuniform sampler2D lightMap;\\n\tuniform float lightMapIntensity;\\n#endif\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/lights_lambert_vertex.glsl\r\n\r\nTHREE.ShaderChunk[ 'lights_lambert_vertex' ] = \"vec3 diffuse = vec3( 1.0 );\\nGeometricContext geometry;\\ngeometry.position = mvPosition.xyz;\\ngeometry.normal = normalize( transformedNormal );\\ngeometry.viewDir = normalize( -mvPosition.xyz );\\nGeometricContext backGeometry;\\nbackGeometry.position = geometry.position;\\nbackGeometry.normal = -geometry.normal;\\nbackGeometry.viewDir = geometry.viewDir;\\nvLightFront = vec3( 0.0 );\\n#ifdef DOUBLE_SIDED\\n\tvLightBack = vec3( 0.0 );\\n#endif\\nIncidentLight directLight;\\nfloat dotNL;\\nvec3 directLightColor_Diffuse;\\n#if NUM_POINT_LIGHTS > 0\\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\\n\t\tgetPointDirectLightIrradiance( pointLights[ i ], geometry, directLight );\\n\t\tdotNL = dot( geometry.normal, directLight.direction );\\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\\n\t\t#ifdef DOUBLE_SIDED\\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\\n\t\t#endif\\n\t}\\n#endif\\n#if NUM_SPOT_LIGHTS > 0\\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\\n\t\tgetSpotDirectLightIrradiance( spotLights[ i ], geometry, directLight );\\n\t\tdotNL = dot( geometry.normal, directLight.direction );\\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\\n\t\t#ifdef DOUBLE_SIDED\\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\\n\t\t#endif\\n\t}\\n#endif\\n#if NUM_DIR_LIGHTS > 0\\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\\n\t\tgetDirectionalDirectLightIrradiance( directionalLights[ i ], geometry, directLight );\\n\t\tdotNL = dot( geometry.normal, directLight.direction );\\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\\n\t\t#ifdef DOUBLE_SIDED\\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\\n\t\t#endif\\n\t}\\n#endif\\n#if NUM_HEMI_LIGHTS > 0\\n\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\\n\t\tvLightFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\\n\t\t#ifdef DOUBLE_SIDED\\n\t\t\tvLightBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry );\\n\t\t#endif\\n\t}\\n#endif\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/lights_pars.glsl\r\n\r\nTHREE.ShaderChunk[ 'lights_pars' ] = \"uniform vec3 ambientLightColor;\\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\\n\tvec3 irradiance = ambientLightColor;\\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\\n\t\tirradiance *= PI;\\n\t#endif\\n\treturn irradiance;\\n}\\n#if NUM_DIR_LIGHTS > 0\\n\tstruct DirectionalLight {\\n\t\tvec3 direction;\\n\t\tvec3 color;\\n\t\tint shadow;\\n\t\tfloat shadowBias;\\n\t\tfloat shadowRadius;\\n\t\tvec2 shadowMapSize;\\n\t};\\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\\n\tvoid getDirectionalDirectLightIrradiance( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight directLight ) {\\n\t\tdirectLight.color = directionalLight.color;\\n\t\tdirectLight.direction = directionalLight.direction;\\n\t\tdirectLight.visible = true;\\n\t}\\n#endif\\n#if NUM_POINT_LIGHTS > 0\\n\tstruct PointLight {\\n\t\tvec3 position;\\n\t\tvec3 color;\\n\t\tfloat distance;\\n\t\tfloat decay;\\n\t\tint shadow;\\n\t\tfloat shadowBias;\\n\t\tfloat shadowRadius;\\n\t\tvec2 shadowMapSize;\\n\t};\\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\\n\tvoid getPointDirectLightIrradiance( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight directLight ) {\\n\t\tvec3 lVector = pointLight.position - geometry.position;\\n\t\tdirectLight.direction = normalize( lVector );\\n\t\tfloat lightDistance = length( lVector );\\n\t\tif ( testLightInRange( lightDistance, pointLight.distance ) ) {\\n\t\t\tdirectLight.color = pointLight.color;\\n\t\t\tdirectLight.color *= punctualLightIntensityToIrradianceFactor( lightDistance, pointLight.distance, pointLight.decay );\\n\t\t\tdirectLight.visible = true;\\n\t\t} else {\\n\t\t\tdirectLight.color = vec3( 0.0 );\\n\t\t\tdirectLight.visible = false;\\n\t\t}\\n\t}\\n#endif\\n#if NUM_SPOT_LIGHTS > 0\\n\tstruct SpotLight {\\n\t\tvec3 position;\\n\t\tvec3 direction;\\n\t\tvec3 color;\\n\t\tfloat distance;\\n\t\tfloat decay;\\n\t\tfloat coneCos;\\n\t\tfloat penumbraCos;\\n\t\tint shadow;\\n\t\tfloat shadowBias;\\n\t\tfloat shadowRadius;\\n\t\tvec2 shadowMapSize;\\n\t};\\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\\n\tvoid getSpotDirectLightIrradiance( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight directLight  ) {\\n\t\tvec3 lVector = spotLight.position - geometry.position;\\n\t\tdirectLight.direction = normalize( lVector );\\n\t\tfloat lightDistance = length( lVector );\\n\t\tfloat angleCos = dot( directLight.direction, spotLight.direction );\\n\t\tif ( all( bvec2( angleCos > spotLight.coneCos, testLightInRange( lightDistance, spotLight.distance ) ) ) ) {\\n\t\t\tfloat spotEffect = smoothstep( spotLight.coneCos, spotLight.penumbraCos, angleCos );\\n\t\t\tdirectLight.color = spotLight.color;\\n\t\t\tdirectLight.color *= spotEffect * punctualLightIntensityToIrradianceFactor( lightDistance, spotLight.distance, spotLight.decay );\\n\t\t\tdirectLight.visible = true;\\n\t\t} else {\\n\t\t\tdirectLight.color = vec3( 0.0 );\\n\t\t\tdirectLight.visible = false;\\n\t\t}\\n\t}\\n#endif\\n#if NUM_HEMI_LIGHTS > 0\\n\tstruct HemisphereLight {\\n\t\tvec3 direction;\\n\t\tvec3 skyColor;\\n\t\tvec3 groundColor;\\n\t};\\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in GeometricContext geometry ) {\\n\t\tfloat dotNL = dot( geometry.normal, hemiLight.direction );\\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\\n\t\t\tirradiance *= PI;\\n\t\t#endif\\n\t\treturn irradiance;\\n\t}\\n#endif\\n#if defined( USE_ENVMAP ) && defined( PHYSICAL )\\n\tvec3 getLightProbeIndirectIrradiance( const in GeometricContext geometry, const in int maxMIPLevel ) {\\n\t\t#ifdef DOUBLE_SIDED\\n\t\t\tfloat flipNormal = ( float( gl_FrontFacing ) * 2.0 - 1.0 );\\n\t\t#else\\n\t\t\tfloat flipNormal = 1.0;\\n\t\t#endif\\n\t\tvec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );\\n\t\t#ifdef ENVMAP_TYPE_CUBE\\n\t\t\tvec3 queryVec = flipNormal * vec3( flipEnvMap * worldNormal.x, worldNormal.yz );\\n\t\t\t#ifdef TEXTURE_LOD_EXT\\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryVec, float( maxMIPLevel ) );\\n\t\t\t#else\\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryVec, float( maxMIPLevel ) );\\n\t\t\t#endif\\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\\n\t\t\tvec3 queryVec = flipNormal * vec3( flipEnvMap * worldNormal.x, worldNormal.yz );\\n\t\t\tvec4 envMapColor = textureCubeUV( queryVec, 1.0 );\\n\t\t#else\\n\t\t\tvec4 envMapColor = vec4( 0.0 );\\n\t\t#endif\\n\t\treturn PI * envMapColor.rgb * envMapIntensity;\\n\t}\\n\tfloat getSpecularMIPLevel( const in float blinnShininessExponent, const in int maxMIPLevel ) {\\n\t\tfloat maxMIPLevelScalar = float( maxMIPLevel );\\n\t\tfloat desiredMIPLevel = maxMIPLevelScalar - 0.79248 - 0.5 * log2( pow2( blinnShininessExponent ) + 1.0 );\\n\t\treturn clamp( desiredMIPLevel, 0.0, maxMIPLevelScalar );\\n\t}\\n\tvec3 getLightProbeIndirectRadiance( const in GeometricContext geometry, const in float blinnShininessExponent, const in int maxMIPLevel ) {\\n\t\t#ifdef ENVMAP_MODE_REFLECTION\\n\t\t\tvec3 reflectVec = reflect( -geometry.viewDir, geometry.normal );\\n\t\t#else\\n\t\t\tvec3 reflectVec = refract( -geometry.viewDir, geometry.normal, refractionRatio );\\n\t\t#endif\\n\t\t#ifdef DOUBLE_SIDED\\n\t\t\tfloat flipNormal = ( float( gl_FrontFacing ) * 2.0 - 1.0 );\\n\t\t#else\\n\t\t\tfloat flipNormal = 1.0;\\n\t\t#endif\\n\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\\n\t\tfloat specularMIPLevel = getSpecularMIPLevel( blinnShininessExponent, maxMIPLevel );\\n\t\t#ifdef ENVMAP_TYPE_CUBE\\n\t\t\tvec3 queryReflectVec = flipNormal * vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\\n\t\t\t#ifdef TEXTURE_LOD_EXT\\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryReflectVec, specularMIPLevel );\\n\t\t\t#else\\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryReflectVec, specularMIPLevel );\\n\t\t\t#endif\\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\\n\t\t\tvec3 queryReflectVec = flipNormal * vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\\n\t\t\tvec4 envMapColor = textureCubeUV(queryReflectVec, BlinnExponentToGGXRoughness(blinnShininessExponent));\\n\t\t#elif defined( ENVMAP_TYPE_EQUIREC )\\n\t\t\tvec2 sampleUV;\\n\t\t\tsampleUV.y = saturate( flipNormal * reflectVec.y * 0.5 + 0.5 );\\n\t\t\tsampleUV.x = atan( flipNormal * reflectVec.z, flipNormal * reflectVec.x ) * RECIPROCAL_PI2 + 0.5;\\n\t\t\t#ifdef TEXTURE_LOD_EXT\\n\t\t\t\tvec4 envMapColor = texture2DLodEXT( envMap, sampleUV, specularMIPLevel );\\n\t\t\t#else\\n\t\t\t\tvec4 envMapColor = texture2D( envMap, sampleUV, specularMIPLevel );\\n\t\t\t#endif\\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\\n\t\t#elif defined( ENVMAP_TYPE_SPHERE )\\n\t\t\tvec3 reflectView = flipNormal * normalize((viewMatrix * vec4( reflectVec, 0.0 )).xyz + vec3(0.0,0.0,1.0));\\n\t\t\t#ifdef TEXTURE_LOD_EXT\\n\t\t\t\tvec4 envMapColor = texture2DLodEXT( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );\\n\t\t\t#else\\n\t\t\t\tvec4 envMapColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );\\n\t\t\t#endif\\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\\n\t\t#endif\\n\t\treturn envMapColor.rgb * envMapIntensity;\\n\t}\\n#endif\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/lights_phong_fragment.glsl\r\n\r\nTHREE.ShaderChunk[ 'lights_phong_fragment' ] = \"BlinnPhongMaterial material;\\nmaterial.diffuseColor = diffuseColor.rgb;\\nmaterial.specularColor = specular;\\nmaterial.specularShininess = shininess;\\nmaterial.specularStrength = specularStrength;\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/lights_phong_pars_fragment.glsl\r\n\r\nTHREE.ShaderChunk[ 'lights_phong_pars_fragment' ] = \"varying vec3 vViewPosition;\\n#ifndef FLAT_SHADED\\n\tvarying vec3 vNormal;\\n#endif\\nstruct BlinnPhongMaterial {\\n\tvec3\tdiffuseColor;\\n\tvec3\tspecularColor;\\n\tfloat\tspecularShininess;\\n\tfloat\tspecularStrength;\\n};\\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\\n\tvec3 irradiance = dotNL * directLight.color;\\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\\n\t\tirradiance *= PI;\\n\t#endif\\n\treflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\\n\treflectedLight.directSpecular += irradiance * BRDF_Specular_BlinnPhong( directLight, geometry, material.specularColor, material.specularShininess ) * material.specularStrength;\\n}\\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\\n}\\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong\\n#define Material_LightProbeLOD( material )\t(0)\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/lights_physical_fragment.glsl\r\n\r\nTHREE.ShaderChunk[ 'lights_physical_fragment' ] = \"PhysicalMaterial material;\\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\\nmaterial.specularRoughness = clamp( roughnessFactor, 0.04, 1.0 );\\n#ifdef STANDARD\\n\tmaterial.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );\\n#else\\n\tmaterial.specularColor = mix( vec3( 0.16 * pow2( reflectivity ) ), diffuseColor.rgb, metalnessFactor );\\n#endif\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/lights_physical_pars_fragment.glsl\r\n\r\nTHREE.ShaderChunk[ 'lights_physical_pars_fragment' ] = \"struct PhysicalMaterial {\\n\tvec3\tdiffuseColor;\\n\tfloat\tspecularRoughness;\\n\tvec3\tspecularColor;\\n\t#ifndef STANDARD\\n\t#endif\\n};\\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\\n\tvec3 irradiance = dotNL * directLight.color;\\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\\n\t\tirradiance *= PI;\\n\t#endif\\n\treflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\\n\treflectedLight.directSpecular += irradiance * BRDF_Specular_GGX( directLight, geometry, material.specularColor, material.specularRoughness );\\n}\\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\\n}\\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\\n\treflectedLight.indirectSpecular += radiance * BRDF_Specular_GGX_Environment( geometry, material.specularColor, material.specularRoughness );\\n}\\n#define RE_Direct\t\t\t\tRE_Direct_Physical\\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\\n#define Material_BlinnShininessExponent( material )   GGXRoughnessToBlinnExponent( material.specularRoughness )\\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\\n}\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/lights_template.glsl\r\n\r\nTHREE.ShaderChunk[ 'lights_template' ] = \"\\nGeometricContext geometry;\\ngeometry.position = - vViewPosition;\\ngeometry.normal = normal;\\ngeometry.viewDir = normalize( vViewPosition );\\nIncidentLight directLight;\\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\\n\tPointLight pointLight;\\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\\n\t\tpointLight = pointLights[ i ];\\n\t\tgetPointDirectLightIrradiance( pointLight, geometry, directLight );\\n\t\t#ifdef USE_SHADOWMAP\\n\t\tdirectLight.color *= all( bvec2( pointLight.shadow, directLight.visible ) ) ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ] ) : 1.0;\\n\t\t#endif\\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\\n\t}\\n#endif\\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\\n\tSpotLight spotLight;\\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\\n\t\tspotLight = spotLights[ i ];\\n\t\tgetSpotDirectLightIrradiance( spotLight, geometry, directLight );\\n\t\t#ifdef USE_SHADOWMAP\\n\t\tdirectLight.color *= all( bvec2( spotLight.shadow, directLight.visible ) ) ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\\n\t\t#endif\\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\\n\t}\\n#endif\\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\\n\tDirectionalLight directionalLight;\\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\\n\t\tdirectionalLight = directionalLights[ i ];\\n\t\tgetDirectionalDirectLightIrradiance( directionalLight, geometry, directLight );\\n\t\t#ifdef USE_SHADOWMAP\\n\t\tdirectLight.color *= all( bvec2( directionalLight.shadow, directLight.visible ) ) ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\\n\t\t#endif\\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\\n\t}\\n#endif\\n#if defined( RE_IndirectDiffuse )\\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\\n\t#ifdef USE_LIGHTMAP\\n\t\tvec3 lightMapIrradiance = texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\\n\t\t\tlightMapIrradiance *= PI;\\n\t\t#endif\\n\t\tirradiance += lightMapIrradiance;\\n\t#endif\\n\t#if ( NUM_HEMI_LIGHTS > 0 )\\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\\n\t\t}\\n\t#endif\\n\t#if defined( USE_ENVMAP ) && defined( PHYSICAL ) && defined( ENVMAP_TYPE_CUBE_UV )\\n\t \tirradiance += getLightProbeIndirectIrradiance( geometry, 8 );\\n\t#endif\\n\tRE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );\\n#endif\\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\\n\tvec3 radiance = getLightProbeIndirectRadiance( geometry, Material_BlinnShininessExponent( material ), 8 );\\n\tRE_IndirectSpecular( radiance, geometry, material, reflectedLight );\\n#endif\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/logdepthbuf_fragment.glsl\r\n\r\nTHREE.ShaderChunk[ 'logdepthbuf_fragment' ] = \"#if defined(USE_LOGDEPTHBUF) && defined(USE_LOGDEPTHBUF_EXT)\\n\tgl_FragDepthEXT = log2(vFragDepth) * logDepthBufFC * 0.5;\\n#endif\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/logdepthbuf_pars_fragment.glsl\r\n\r\nTHREE.ShaderChunk[ 'logdepthbuf_pars_fragment' ] = \"#ifdef USE_LOGDEPTHBUF\\n\tuniform float logDepthBufFC;\\n\t#ifdef USE_LOGDEPTHBUF_EXT\\n\t\tvarying float vFragDepth;\\n\t#endif\\n#endif\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/logdepthbuf_pars_vertex.glsl\r\n\r\nTHREE.ShaderChunk[ 'logdepthbuf_pars_vertex' ] = \"#ifdef USE_LOGDEPTHBUF\\n\t#ifdef USE_LOGDEPTHBUF_EXT\\n\t\tvarying float vFragDepth;\\n\t#endif\\n\tuniform float logDepthBufFC;\\n#endif\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/logdepthbuf_vertex.glsl\r\n\r\nTHREE.ShaderChunk[ 'logdepthbuf_vertex' ] = \"#ifdef USE_LOGDEPTHBUF\\n\tgl_Position.z = log2(max( EPSILON, gl_Position.w + 1.0 )) * logDepthBufFC;\\n\t#ifdef USE_LOGDEPTHBUF_EXT\\n\t\tvFragDepth = 1.0 + gl_Position.w;\\n\t#else\\n\t\tgl_Position.z = (gl_Position.z - 1.0) * gl_Position.w;\\n\t#endif\\n#endif\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/map_fragment.glsl\r\n\r\nTHREE.ShaderChunk[ 'map_fragment' ] = \"#ifdef USE_MAP\\n\tvec4 texelColor = texture2D( map, vUv );\\n\ttexelColor = mapTexelToLinear( texelColor );\\n\tdiffuseColor *= texelColor;\\n#endif\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/map_pars_fragment.glsl\r\n\r\nTHREE.ShaderChunk[ 'map_pars_fragment' ] = \"#ifdef USE_MAP\\n\tuniform sampler2D map;\\n#endif\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/map_particle_fragment.glsl\r\n\r\nTHREE.ShaderChunk[ 'map_particle_fragment' ] = \"#ifdef USE_MAP\\n\tvec4 mapTexel = texture2D( map, vec2( gl_PointCoord.x, 1.0 - gl_PointCoord.y ) * offsetRepeat.zw + offsetRepeat.xy );\\n\tdiffuseColor *= mapTexelToLinear( mapTexel );\\n#endif\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/map_particle_pars_fragment.glsl\r\n\r\nTHREE.ShaderChunk[ 'map_particle_pars_fragment' ] = \"#ifdef USE_MAP\\n\tuniform vec4 offsetRepeat;\\n\tuniform sampler2D map;\\n#endif\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/metalnessmap_fragment.glsl\r\n\r\nTHREE.ShaderChunk[ 'metalnessmap_fragment' ] = \"float metalnessFactor = metalness;\\n#ifdef USE_METALNESSMAP\\n\tvec4 texelMetalness = texture2D( metalnessMap, vUv );\\n\tmetalnessFactor *= texelMetalness.r;\\n#endif\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/metalnessmap_pars_fragment.glsl\r\n\r\nTHREE.ShaderChunk[ 'metalnessmap_pars_fragment' ] = \"#ifdef USE_METALNESSMAP\\n\tuniform sampler2D metalnessMap;\\n#endif\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/morphnormal_vertex.glsl\r\n\r\nTHREE.ShaderChunk[ 'morphnormal_vertex' ] = \"#ifdef USE_MORPHNORMALS\\n\tobjectNormal += ( morphNormal0 - normal ) * morphTargetInfluences[ 0 ];\\n\tobjectNormal += ( morphNormal1 - normal ) * morphTargetInfluences[ 1 ];\\n\tobjectNormal += ( morphNormal2 - normal ) * morphTargetInfluences[ 2 ];\\n\tobjectNormal += ( morphNormal3 - normal ) * morphTargetInfluences[ 3 ];\\n#endif\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/morphtarget_pars_vertex.glsl\r\n\r\nTHREE.ShaderChunk[ 'morphtarget_pars_vertex' ] = \"#ifdef USE_MORPHTARGETS\\n\t#ifndef USE_MORPHNORMALS\\n\tuniform float morphTargetInfluences[ 8 ];\\n\t#else\\n\tuniform float morphTargetInfluences[ 4 ];\\n\t#endif\\n#endif\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/morphtarget_vertex.glsl\r\n\r\nTHREE.ShaderChunk[ 'morphtarget_vertex' ] = \"#ifdef USE_MORPHTARGETS\\n\ttransformed += ( morphTarget0 - position ) * morphTargetInfluences[ 0 ];\\n\ttransformed += ( morphTarget1 - position ) * morphTargetInfluences[ 1 ];\\n\ttransformed += ( morphTarget2 - position ) * morphTargetInfluences[ 2 ];\\n\ttransformed += ( morphTarget3 - position ) * morphTargetInfluences[ 3 ];\\n\t#ifndef USE_MORPHNORMALS\\n\ttransformed += ( morphTarget4 - position ) * morphTargetInfluences[ 4 ];\\n\ttransformed += ( morphTarget5 - position ) * morphTargetInfluences[ 5 ];\\n\ttransformed += ( morphTarget6 - position ) * morphTargetInfluences[ 6 ];\\n\ttransformed += ( morphTarget7 - position ) * morphTargetInfluences[ 7 ];\\n\t#endif\\n#endif\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/normal_fragment.glsl\r\n\r\nTHREE.ShaderChunk[ 'normal_fragment' ] = \"#ifdef FLAT_SHADED\\n\tvec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );\\n\tvec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );\\n\tvec3 normal = normalize( cross( fdx, fdy ) );\\n#else\\n\tvec3 normal = normalize( vNormal );\\n\t#ifdef DOUBLE_SIDED\\n\t\tnormal = normal * ( -1.0 + 2.0 * float( gl_FrontFacing ) );\\n\t#endif\\n#endif\\n#ifdef USE_NORMALMAP\\n\tnormal = perturbNormal2Arb( -vViewPosition, normal );\\n#elif defined( USE_BUMPMAP )\\n\tnormal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd() );\\n#endif\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/normalmap_pars_fragment.glsl\r\n\r\nTHREE.ShaderChunk[ 'normalmap_pars_fragment' ] = \"#ifdef USE_NORMALMAP\\n\tuniform sampler2D normalMap;\\n\tuniform vec2 normalScale;\\n\tvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm ) {\\n\t\tvec3 q0 = dFdx( eye_pos.xyz );\\n\t\tvec3 q1 = dFdy( eye_pos.xyz );\\n\t\tvec2 st0 = dFdx( vUv.st );\\n\t\tvec2 st1 = dFdy( vUv.st );\\n\t\tvec3 S = normalize( q0 * st1.t - q1 * st0.t );\\n\t\tvec3 T = normalize( -q0 * st1.s + q1 * st0.s );\\n\t\tvec3 N = normalize( surf_norm );\\n\t\tvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\\n\t\tmapN.xy = normalScale * mapN.xy;\\n\t\tmat3 tsn = mat3( S, T, N );\\n\t\treturn normalize( tsn * mapN );\\n\t}\\n#endif\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/packing.glsl\r\n\r\nTHREE.ShaderChunk[ 'packing' ] = \"vec3 packNormalToRGB( const in vec3 normal ) {\\n  return normalize( normal ) * 0.5 + 0.5;\\n}\\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\\n  return 1.0 - 2.0 * rgb.xyz;\\n}\\nvec4 packDepthToRGBA( const in float value ) {\\n\tconst vec4 bit_shift = vec4( 256.0 * 256.0 * 256.0, 256.0 * 256.0, 256.0, 1.0 );\\n\tconst vec4 bit_mask = vec4( 0.0, 1.0 / 256.0, 1.0 / 256.0, 1.0 / 256.0 );\\n\tvec4 res = mod( value * bit_shift * vec4( 255 ), vec4( 256 ) ) / vec4( 255 );\\n\tres -= res.xxyz * bit_mask;\\n\treturn res;\\n}\\nfloat unpackRGBAToDepth( const in vec4 rgba ) {\\n\tconst vec4 bitSh = vec4( 1.0 / ( 256.0 * 256.0 * 256.0 ), 1.0 / ( 256.0 * 256.0 ), 1.0 / 256.0, 1.0 );\\n\treturn dot( rgba, bitSh );\\n}\\nfloat viewZToOrthoDepth( const in float viewZ, const in float near, const in float far ) {\\n  return ( viewZ + near ) / ( near - far );\\n}\\nfloat OrthoDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {\\n  return linearClipZ * ( near - far ) - near;\\n}\\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\\n  return (( near + viewZ ) * far ) / (( far - near ) * viewZ );\\n}\\nfloat perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {\\n  return ( near * far ) / ( ( far - near ) * invClipZ - far );\\n}\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/premultiplied_alpha_fragment.glsl\r\n\r\nTHREE.ShaderChunk[ 'premultiplied_alpha_fragment' ] = \"#ifdef PREMULTIPLIED_ALPHA\\n\tgl_FragColor.rgb *= gl_FragColor.a;\\n#endif\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/project_vertex.glsl\r\n\r\nTHREE.ShaderChunk[ 'project_vertex' ] = \"#ifdef USE_SKINNING\\n\tvec4 mvPosition = modelViewMatrix * skinned;\\n#else\\n\tvec4 mvPosition = modelViewMatrix * vec4( transformed, 1.0 );\\n#endif\\ngl_Position = projectionMatrix * mvPosition;\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/roughnessmap_fragment.glsl\r\n\r\nTHREE.ShaderChunk[ 'roughnessmap_fragment' ] = \"float roughnessFactor = roughness;\\n#ifdef USE_ROUGHNESSMAP\\n\tvec4 texelRoughness = texture2D( roughnessMap, vUv );\\n\troughnessFactor *= texelRoughness.r;\\n#endif\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/roughnessmap_pars_fragment.glsl\r\n\r\nTHREE.ShaderChunk[ 'roughnessmap_pars_fragment' ] = \"#ifdef USE_ROUGHNESSMAP\\n\tuniform sampler2D roughnessMap;\\n#endif\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/shadowmap_pars_fragment.glsl\r\n\r\nTHREE.ShaderChunk[ 'shadowmap_pars_fragment' ] = \"#ifdef USE_SHADOWMAP\\n\t#if NUM_DIR_LIGHTS > 0\\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHTS ];\\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHTS ];\\n\t#endif\\n\t#if NUM_SPOT_LIGHTS > 0\\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHTS ];\\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHTS ];\\n\t#endif\\n\t#if NUM_POINT_LIGHTS > 0\\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHTS ];\\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHTS ];\\n\t#endif\\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\\n\t}\\n\tfloat texture2DShadowLerp( sampler2D depths, vec2 size, vec2 uv, float compare ) {\\n\t\tconst vec2 offset = vec2( 0.0, 1.0 );\\n\t\tvec2 texelSize = vec2( 1.0 ) / size;\\n\t\tvec2 centroidUV = floor( uv * size + 0.5 ) / size;\\n\t\tfloat lb = texture2DCompare( depths, centroidUV + texelSize * offset.xx, compare );\\n\t\tfloat lt = texture2DCompare( depths, centroidUV + texelSize * offset.xy, compare );\\n\t\tfloat rb = texture2DCompare( depths, centroidUV + texelSize * offset.yx, compare );\\n\t\tfloat rt = texture2DCompare( depths, centroidUV + texelSize * offset.yy, compare );\\n\t\tvec2 f = fract( uv * size + 0.5 );\\n\t\tfloat a = mix( lb, lt, f.y );\\n\t\tfloat b = mix( rb, rt, f.y );\\n\t\tfloat c = mix( a, b, f.x );\\n\t\treturn c;\\n\t}\\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\\n\t\tshadowCoord.xyz /= shadowCoord.w;\\n\t\tshadowCoord.z += shadowBias;\\n\t\tbvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\\n\t\tbool inFrustum = all( inFrustumVec );\\n\t\tbvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\\n\t\tbool frustumTest = all( frustumTestVec );\\n\t\tif ( frustumTest ) {\\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\\n\t\t\treturn (\\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\\n\t\t\t) * ( 1.0 / 9.0 );\\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\\n\t\t\treturn (\\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy, shadowCoord.z ) +\\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\\n\t\t\t) * ( 1.0 / 9.0 );\\n\t\t#else\\n\t\t\treturn texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\\n\t\t#endif\\n\t\t}\\n\t\treturn 1.0;\\n\t}\\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\\n\t\tvec3 absV = abs( v );\\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\\n\t\tabsV *= scaleToCube;\\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\\n\t\tvec2 planar = v.xy;\\n\t\tfloat almostATexel = 1.5 * texelSizeY;\\n\t\tfloat almostOne = 1.0 - almostATexel;\\n\t\tif ( absV.z >= almostOne ) {\\n\t\t\tif ( v.z > 0.0 )\\n\t\t\t\tplanar.x = 4.0 - v.x;\\n\t\t} else if ( absV.x >= almostOne ) {\\n\t\t\tfloat signX = sign( v.x );\\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\\n\t\t} else if ( absV.y >= almostOne ) {\\n\t\t\tfloat signY = sign( v.y );\\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\\n\t\t\tplanar.y = v.z * signY - 2.0;\\n\t\t}\\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\\n\t}\\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\\n\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\\n\t\tvec3 lightToPosition = shadowCoord.xyz;\\n\t\tvec3 bd3D = normalize( lightToPosition );\\n\t\tfloat dp = ( length( lightToPosition ) - shadowBias ) / 1000.0;\\n\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT )\\n\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\\n\t\t\treturn (\\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\\n\t\t\t) * ( 1.0 / 9.0 );\\n\t\t#else\\n\t\t\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\\n\t\t#endif\\n\t}\\n#endif\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/shadowmap_pars_vertex.glsl\r\n\r\nTHREE.ShaderChunk[ 'shadowmap_pars_vertex' ] = \"#ifdef USE_SHADOWMAP\\n\t#if NUM_DIR_LIGHTS > 0\\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHTS ];\\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHTS ];\\n\t#endif\\n\t#if NUM_SPOT_LIGHTS > 0\\n\t\tuniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHTS ];\\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHTS ];\\n\t#endif\\n\t#if NUM_POINT_LIGHTS > 0\\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHTS ];\\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHTS ];\\n\t#endif\\n#endif\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/shadowmap_vertex.glsl\r\n\r\nTHREE.ShaderChunk[ 'shadowmap_vertex' ] = \"#ifdef USE_SHADOWMAP\\n\t#if NUM_DIR_LIGHTS > 0\\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\\n\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * worldPosition;\\n\t}\\n\t#endif\\n\t#if NUM_SPOT_LIGHTS > 0\\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\\n\t\tvSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * worldPosition;\\n\t}\\n\t#endif\\n\t#if NUM_POINT_LIGHTS > 0\\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\\n\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * worldPosition;\\n\t}\\n\t#endif\\n#endif\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/shadowmask_pars_fragment.glsl\r\n\r\nTHREE.ShaderChunk[ 'shadowmask_pars_fragment' ] = \"float getShadowMask() {\\n\tfloat shadow = 1.0;\\n\t#ifdef USE_SHADOWMAP\\n\t#if NUM_DIR_LIGHTS > 0\\n\tDirectionalLight directionalLight;\\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\\n\t\tdirectionalLight = directionalLights[ i ];\\n\t\tshadow *= bool( directionalLight.shadow ) ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\\n\t}\\n\t#endif\\n\t#if NUM_SPOT_LIGHTS > 0\\n\tSpotLight spotLight;\\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\\n\t\tspotLight = spotLights[ i ];\\n\t\tshadow *= bool( spotLight.shadow ) ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\\n\t}\\n\t#endif\\n\t#if NUM_POINT_LIGHTS > 0\\n\tPointLight pointLight;\\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\\n\t\tpointLight = pointLights[ i ];\\n\t\tshadow *= bool( pointLight.shadow ) ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ] ) : 1.0;\\n\t}\\n\t#endif\\n\t#endif\\n\treturn shadow;\\n}\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/skinbase_vertex.glsl\r\n\r\nTHREE.ShaderChunk[ 'skinbase_vertex' ] = \"#ifdef USE_SKINNING\\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\\n#endif\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/skinning_pars_vertex.glsl\r\n\r\nTHREE.ShaderChunk[ 'skinning_pars_vertex' ] = \"#ifdef USE_SKINNING\\n\tuniform mat4 bindMatrix;\\n\tuniform mat4 bindMatrixInverse;\\n\t#ifdef BONE_TEXTURE\\n\t\tuniform sampler2D boneTexture;\\n\t\tuniform int boneTextureWidth;\\n\t\tuniform int boneTextureHeight;\\n\t\tmat4 getBoneMatrix( const in float i ) {\\n\t\t\tfloat j = i * 4.0;\\n\t\t\tfloat x = mod( j, float( boneTextureWidth ) );\\n\t\t\tfloat y = floor( j / float( boneTextureWidth ) );\\n\t\t\tfloat dx = 1.0 / float( boneTextureWidth );\\n\t\t\tfloat dy = 1.0 / float( boneTextureHeight );\\n\t\t\ty = dy * ( y + 0.5 );\\n\t\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\\n\t\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\\n\t\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\\n\t\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\\n\t\t\tmat4 bone = mat4( v1, v2, v3, v4 );\\n\t\t\treturn bone;\\n\t\t}\\n\t#else\\n\t\tuniform mat4 boneMatrices[ MAX_BONES ];\\n\t\tmat4 getBoneMatrix( const in float i ) {\\n\t\t\tmat4 bone = boneMatrices[ int(i) ];\\n\t\t\treturn bone;\\n\t\t}\\n\t#endif\\n#endif\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/skinning_vertex.glsl\r\n\r\nTHREE.ShaderChunk[ 'skinning_vertex' ] = \"#ifdef USE_SKINNING\\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\\n\tvec4 skinned = vec4( 0.0 );\\n\tskinned += boneMatX * skinVertex * skinWeight.x;\\n\tskinned += boneMatY * skinVertex * skinWeight.y;\\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\\n\tskinned += boneMatW * skinVertex * skinWeight.w;\\n\tskinned  = bindMatrixInverse * skinned;\\n#endif\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/skinnormal_vertex.glsl\r\n\r\nTHREE.ShaderChunk[ 'skinnormal_vertex' ] = \"#ifdef USE_SKINNING\\n\tmat4 skinMatrix = mat4( 0.0 );\\n\tskinMatrix += skinWeight.x * boneMatX;\\n\tskinMatrix += skinWeight.y * boneMatY;\\n\tskinMatrix += skinWeight.z * boneMatZ;\\n\tskinMatrix += skinWeight.w * boneMatW;\\n\tskinMatrix  = bindMatrixInverse * skinMatrix * bindMatrix;\\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\\n#endif\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/specularmap_fragment.glsl\r\n\r\nTHREE.ShaderChunk[ 'specularmap_fragment' ] = \"float specularStrength;\\n#ifdef USE_SPECULARMAP\\n\tvec4 texelSpecular = texture2D( specularMap, vUv );\\n\tspecularStrength = texelSpecular.r;\\n#else\\n\tspecularStrength = 1.0;\\n#endif\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/specularmap_pars_fragment.glsl\r\n\r\nTHREE.ShaderChunk[ 'specularmap_pars_fragment' ] = \"#ifdef USE_SPECULARMAP\\n\tuniform sampler2D specularMap;\\n#endif\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/tonemapping_fragment.glsl\r\n\r\nTHREE.ShaderChunk[ 'tonemapping_fragment' ] = \"#if defined( TONE_MAPPING )\\n  gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\\n#endif\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/tonemapping_pars_fragment.glsl\r\n\r\nTHREE.ShaderChunk[ 'tonemapping_pars_fragment' ] = \"#define saturate(a) clamp( a, 0.0, 1.0 )\\nuniform float toneMappingExposure;\\nuniform float toneMappingWhitePoint;\\nvec3 LinearToneMapping( vec3 color ) {\\n  return toneMappingExposure * color;\\n}\\nvec3 ReinhardToneMapping( vec3 color ) {\\n  color *= toneMappingExposure;\\n  return saturate( color / ( vec3( 1.0 ) + color ) );\\n}\\n#define Uncharted2Helper( x ) max( ( ( x * ( 0.15 * x + 0.10 * 0.50 ) + 0.20 * 0.02 ) / ( x * ( 0.15 * x + 0.50 ) + 0.20 * 0.30 ) ) - 0.02 / 0.30, vec3( 0.0 ) )\\nvec3 Uncharted2ToneMapping( vec3 color ) {\\n  color *= toneMappingExposure;\\n  return saturate( Uncharted2Helper( color ) / Uncharted2Helper( vec3( toneMappingWhitePoint ) ) );\\n}\\nvec3 OptimizedCineonToneMapping( vec3 color ) {\\n  color *= toneMappingExposure;\\n  color = max( vec3( 0.0 ), color - 0.004 );\\n  return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\\n}\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/uv2_pars_fragment.glsl\r\n\r\nTHREE.ShaderChunk[ 'uv2_pars_fragment' ] = \"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\\n\tvarying vec2 vUv2;\\n#endif\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/uv2_pars_vertex.glsl\r\n\r\nTHREE.ShaderChunk[ 'uv2_pars_vertex' ] = \"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\\n\tattribute vec2 uv2;\\n\tvarying vec2 vUv2;\\n#endif\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/uv2_vertex.glsl\r\n\r\nTHREE.ShaderChunk[ 'uv2_vertex' ] = \"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\\n\tvUv2 = uv2;\\n#endif\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/uv_pars_fragment.glsl\r\n\r\nTHREE.ShaderChunk[ 'uv_pars_fragment' ] = \"#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\\n\tvarying vec2 vUv;\\n#endif\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/uv_pars_vertex.glsl\r\n\r\nTHREE.ShaderChunk[ 'uv_pars_vertex' ] = \"#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\\n\tvarying vec2 vUv;\\n\tuniform vec4 offsetRepeat;\\n#endif\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/uv_vertex.glsl\r\n\r\nTHREE.ShaderChunk[ 'uv_vertex' ] = \"#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\\n\tvUv = uv * offsetRepeat.zw + offsetRepeat.xy;\\n#endif\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/worldpos_vertex.glsl\r\n\r\nTHREE.ShaderChunk[ 'worldpos_vertex' ] = \"#if defined( USE_ENVMAP ) || defined( PHONG ) || defined( PHYSICAL ) || defined( LAMBERT ) || defined ( USE_SHADOWMAP )\\n\t#ifdef USE_SKINNING\\n\t\tvec4 worldPosition = modelMatrix * skinned;\\n\t#else\\n\t\tvec4 worldPosition = modelMatrix * vec4( transformed, 1.0 );\\n\t#endif\\n#endif\\n\";\r\n\r\n// File:src/renderers/shaders/UniformsUtils.js\r\n\r\n/**\r\n * Uniform Utilities\r\n */\r\n\r\nTHREE.UniformsUtils = {\r\n\r\n\tmerge: function ( uniforms ) {\r\n\r\n\t\tvar merged = {};\r\n\r\n\t\tfor ( var u = 0; u < uniforms.length; u ++ ) {\r\n\r\n\t\t\tvar tmp = this.clone( uniforms[ u ] );\r\n\r\n\t\t\tfor ( var p in tmp ) {\r\n\r\n\t\t\t\tmerged[ p ] = tmp[ p ];\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\treturn merged;\r\n\r\n\t},\r\n\r\n\tclone: function ( uniforms_src ) {\r\n\r\n\t\tvar uniforms_dst = {};\r\n\r\n\t\tfor ( var u in uniforms_src ) {\r\n\r\n\t\t\tuniforms_dst[ u ] = {};\r\n\r\n\t\t\tfor ( var p in uniforms_src[ u ] ) {\r\n\r\n\t\t\t\tvar parameter_src = uniforms_src[ u ][ p ];\r\n\r\n\t\t\t\tif ( parameter_src instanceof THREE.Color ||\r\n\t\t\t\t\t parameter_src instanceof THREE.Vector2 ||\r\n\t\t\t\t\t parameter_src instanceof THREE.Vector3 ||\r\n\t\t\t\t\t parameter_src instanceof THREE.Vector4 ||\r\n\t\t\t\t\t parameter_src instanceof THREE.Matrix3 ||\r\n\t\t\t\t\t parameter_src instanceof THREE.Matrix4 ||\r\n\t\t\t\t\t parameter_src instanceof THREE.Texture ) {\r\n\r\n\t\t\t\t\tuniforms_dst[ u ][ p ] = parameter_src.clone();\r\n\r\n\t\t\t\t} else if ( Array.isArray( parameter_src ) ) {\r\n\r\n\t\t\t\t\tuniforms_dst[ u ][ p ] = parameter_src.slice();\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tuniforms_dst[ u ][ p ] = parameter_src;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\treturn uniforms_dst;\r\n\r\n\t}\r\n\r\n};\r\n\r\n// File:src/renderers/shaders/UniformsLib.js\r\n\r\n/**\r\n * Uniforms library for shared webgl shaders\r\n */\r\n\r\nTHREE.UniformsLib = {\r\n\r\n\tcommon: {\r\n\r\n\t\t\"diffuse\": { type: \"c\", value: new THREE.Color( 0xeeeeee ) },\r\n\t\t\"opacity\": { type: \"1f\", value: 1.0 },\r\n\r\n\t\t\"map\": { type: \"t\", value: null },\r\n\t\t\"offsetRepeat\": { type: \"v4\", value: new THREE.Vector4( 0, 0, 1, 1 ) },\r\n\r\n\t\t\"specularMap\": { type: \"t\", value: null },\r\n\t\t\"alphaMap\": { type: \"t\", value: null },\r\n\r\n\t\t\"envMap\": { type: \"t\", value: null },\r\n\t\t\"flipEnvMap\": { type: \"1f\", value: - 1 },\r\n\t\t\"reflectivity\": { type: \"1f\", value: 1.0 },\r\n\t\t\"refractionRatio\": { type: \"1f\", value: 0.98 }\r\n\r\n\t},\r\n\r\n\taomap: {\r\n\r\n\t\t\"aoMap\": { type: \"t\", value: null },\r\n\t\t\"aoMapIntensity\": { type: \"1f\", value: 1 }\r\n\r\n\t},\r\n\r\n\tlightmap: {\r\n\r\n\t\t\"lightMap\": { type: \"t\", value: null },\r\n\t\t\"lightMapIntensity\": { type: \"1f\", value: 1 }\r\n\r\n\t},\r\n\r\n\temissivemap: {\r\n\r\n\t\t\"emissiveMap\": { type: \"t\", value: null }\r\n\r\n\t},\r\n\r\n\tbumpmap: {\r\n\r\n\t\t\"bumpMap\": { type: \"t\", value: null },\r\n\t\t\"bumpScale\": { type: \"1f\", value: 1 }\r\n\r\n\t},\r\n\r\n\tnormalmap: {\r\n\r\n\t\t\"normalMap\": { type: \"t\", value: null },\r\n\t\t\"normalScale\": { type: \"v2\", value: new THREE.Vector2( 1, 1 ) }\r\n\r\n\t},\r\n\r\n\tdisplacementmap: {\r\n\r\n\t\t\"displacementMap\": { type: \"t\", value: null },\r\n\t\t\"displacementScale\": { type: \"1f\", value: 1 },\r\n\t\t\"displacementBias\": { type: \"1f\", value: 0 }\r\n\r\n\t},\r\n\r\n\troughnessmap: {\r\n\r\n\t\t\"roughnessMap\": { type: \"t\", value: null }\r\n\r\n\t},\r\n\r\n\tmetalnessmap: {\r\n\r\n\t\t\"metalnessMap\": { type: \"t\", value: null }\r\n\r\n\t},\r\n\r\n\tfog: {\r\n\r\n\t\t\"fogDensity\": { type: \"1f\", value: 0.00025 },\r\n\t\t\"fogNear\": { type: \"1f\", value: 1 },\r\n\t\t\"fogFar\": { type: \"1f\", value: 2000 },\r\n\t\t\"fogColor\": { type: \"c\", value: new THREE.Color( 0xffffff ) }\r\n\r\n\t},\r\n\r\n\tlights: {\r\n\r\n\t\t\"ambientLightColor\": { type: \"3fv\", value: [] },\r\n\r\n\t\t\"directionalLights\": { type: \"sa\", value: [], properties: {\r\n\t\t\t\"direction\": { type: \"v3\" },\r\n\t\t\t\"color\": { type: \"c\" },\r\n\r\n\t\t\t\"shadow\": { type: \"1i\" },\r\n\t\t\t\"shadowBias\": { type: \"1f\" },\r\n\t\t\t\"shadowRadius\": { type: \"1f\" },\r\n\t\t\t\"shadowMapSize\": { type: \"v2\" }\r\n\t\t} },\r\n\r\n\t\t\"directionalShadowMap\": { type: \"tv\", value: [] },\r\n\t\t\"directionalShadowMatrix\": { type: \"m4v\", value: [] },\r\n\r\n\t\t\"spotLights\": { type: \"sa\", value: [], properties: {\r\n\t\t\t\"color\": { type: \"c\" },\r\n\t\t\t\"position\": { type: \"v3\" },\r\n\t\t\t\"direction\": { type: \"v3\" },\r\n\t\t\t\"distance\": { type: \"1f\" },\r\n\t\t\t\"coneCos\": { type: \"1f\" },\r\n\t\t\t\"penumbraCos\": { type: \"1f\" },\r\n\t\t\t\"decay\": { type: \"1f\" },\r\n\r\n\t\t\t\"shadow\": { type: \"1i\" },\r\n\t\t\t\"shadowBias\": { type: \"1f\" },\r\n\t\t\t\"shadowRadius\": { type: \"1f\" },\r\n\t\t\t\"shadowMapSize\": { type: \"v2\" }\r\n\t\t} },\r\n\r\n\t\t\"spotShadowMap\": { type: \"tv\", value: [] },\r\n\t\t\"spotShadowMatrix\": { type: \"m4v\", value: [] },\r\n\r\n\t\t\"pointLights\": { type: \"sa\", value: [], properties: {\r\n\t\t\t\"color\": { type: \"c\" },\r\n\t\t\t\"position\": { type: \"v3\" },\r\n\t\t\t\"decay\": { type: \"1f\" },\r\n\t\t\t\"distance\": { type: \"1f\" },\r\n\r\n\t\t\t\"shadow\": { type: \"1i\" },\r\n\t\t\t\"shadowBias\": { type: \"1f\" },\r\n\t\t\t\"shadowRadius\": { type: \"1f\" },\r\n\t\t\t\"shadowMapSize\": { type: \"v2\" }\r\n\t\t} },\r\n\r\n\t\t\"pointShadowMap\": { type: \"tv\", value: [] },\r\n\t\t\"pointShadowMatrix\": { type: \"m4v\", value: [] },\r\n\r\n\t\t\"hemisphereLights\": { type: \"sa\", value: [], properties: {\r\n\t\t\t\"direction\": { type: \"v3\" },\r\n\t\t\t\"skyColor\": { type: \"c\" },\r\n\t\t\t\"groundColor\": { type: \"c\" }\r\n\t\t} }\r\n\r\n\t},\r\n\r\n\tpoints: {\r\n\r\n\t\t\"diffuse\": { type: \"c\", value: new THREE.Color( 0xeeeeee ) },\r\n\t\t\"opacity\": { type: \"1f\", value: 1.0 },\r\n\t\t\"size\": { type: \"1f\", value: 1.0 },\r\n\t\t\"scale\": { type: \"1f\", value: 1.0 },\r\n\t\t\"map\": { type: \"t\", value: null },\r\n\t\t\"offsetRepeat\": { type: \"v4\", value: new THREE.Vector4( 0, 0, 1, 1 ) }\r\n\r\n\t}\r\n\r\n};\r\n\r\n// File:src/renderers/shaders/ShaderLib/cube_frag.glsl\r\n\r\nTHREE.ShaderChunk[ 'cube_frag' ] = \"uniform samplerCube tCube;\\nuniform float tFlip;\\nvarying vec3 vWorldPosition;\\n#include <common>\\n#include <logdepthbuf_pars_fragment>\\n#include <clipping_planes_pars_fragment>\\nvoid main() {\\n\t#include <clipping_planes_fragment>\\n\tgl_FragColor = textureCube( tCube, vec3( tFlip * vWorldPosition.x, vWorldPosition.yz ) );\\n\t#include <logdepthbuf_fragment>\\n}\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderLib/cube_vert.glsl\r\n\r\nTHREE.ShaderChunk[ 'cube_vert' ] = \"varying vec3 vWorldPosition;\\n#include <common>\\n#include <logdepthbuf_pars_vertex>\\n#include <clipping_planes_pars_vertex>\\nvoid main() {\\n\tvWorldPosition = transformDirection( position, modelMatrix );\\n\t#include <begin_vertex>\\n\t#include <project_vertex>\\n\t#include <logdepthbuf_vertex>\\n\t#include <clipping_planes_vertex>\\n}\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderLib/depth_frag.glsl\r\n\r\nTHREE.ShaderChunk[ 'depth_frag' ] = \"#if DEPTH_PACKING == 3200\\n\tuniform float opacity;\\n#endif\\n#include <common>\\n#include <packing>\\n#include <uv_pars_fragment>\\n#include <map_pars_fragment>\\n#include <alphamap_pars_fragment>\\n#include <logdepthbuf_pars_fragment>\\n#include <clipping_planes_pars_fragment>\\nvoid main() {\\n\t#include <clipping_planes_fragment>\\n\tvec4 diffuseColor = vec4( 1.0 );\\n\t#if DEPTH_PACKING == 3200\\n\t\tdiffuseColor.a = opacity;\\n\t#endif\\n\t#include <map_fragment>\\n\t#include <alphamap_fragment>\\n\t#include <alphatest_fragment>\\n\t#include <logdepthbuf_fragment>\\n\t#if DEPTH_PACKING == 3200\\n\t\tgl_FragColor = vec4( vec3( gl_FragCoord.z ), opacity );\\n\t#elif DEPTH_PACKING == 3201\\n\t\tgl_FragColor = packDepthToRGBA( gl_FragCoord.z );\\n\t#endif\\n}\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderLib/depth_vert.glsl\r\n\r\nTHREE.ShaderChunk[ 'depth_vert' ] = \"#include <common>\\n#include <uv_pars_vertex>\\n#include <displacementmap_pars_vertex>\\n#include <morphtarget_pars_vertex>\\n#include <skinning_pars_vertex>\\n#include <logdepthbuf_pars_vertex>\\n#include <clipping_planes_pars_vertex>\\nvoid main() {\\n\t#include <uv_vertex>\\n\t#include <skinbase_vertex>\\n\t#include <begin_vertex>\\n\t#include <displacementmap_vertex>\\n\t#include <morphtarget_vertex>\\n\t#include <skinning_vertex>\\n\t#include <project_vertex>\\n\t#include <logdepthbuf_vertex>\\n\t#include <clipping_planes_vertex>\\n}\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderLib/distanceRGBA_frag.glsl\r\n\r\nTHREE.ShaderChunk[ 'distanceRGBA_frag' ] = \"uniform vec3 lightPos;\\nvarying vec4 vWorldPosition;\\n#include <common>\\n#include <packing>\\n#include <clipping_planes_pars_fragment>\\nvoid main () {\\n\t#include <clipping_planes_fragment>\\n\tgl_FragColor = packDepthToRGBA( length( vWorldPosition.xyz - lightPos.xyz ) / 1000.0 );\\n}\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderLib/distanceRGBA_vert.glsl\r\n\r\nTHREE.ShaderChunk[ 'distanceRGBA_vert' ] = \"varying vec4 vWorldPosition;\\n#include <common>\\n#include <morphtarget_pars_vertex>\\n#include <skinning_pars_vertex>\\n#include <clipping_planes_pars_vertex>\\nvoid main() {\\n\t#include <skinbase_vertex>\\n\t#include <begin_vertex>\\n\t#include <morphtarget_vertex>\\n\t#include <skinning_vertex>\\n\t#include <project_vertex>\\n\t#include <worldpos_vertex>\\n\t#include <clipping_planes_vertex>\\n\tvWorldPosition = worldPosition;\\n}\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderLib/equirect_frag.glsl\r\n\r\nTHREE.ShaderChunk[ 'equirect_frag' ] = \"uniform sampler2D tEquirect;\\nuniform float tFlip;\\nvarying vec3 vWorldPosition;\\n#include <common>\\n#include <logdepthbuf_pars_fragment>\\n#include <clipping_planes_pars_fragment>\\nvoid main() {\\n\t#include <clipping_planes_fragment>\\n\tvec3 direction = normalize( vWorldPosition );\\n\tvec2 sampleUV;\\n\tsampleUV.y = saturate( tFlip * direction.y * -0.5 + 0.5 );\\n\tsampleUV.x = atan( direction.z, direction.x ) * RECIPROCAL_PI2 + 0.5;\\n\tgl_FragColor = texture2D( tEquirect, sampleUV );\\n\t#include <logdepthbuf_fragment>\\n}\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderLib/equirect_vert.glsl\r\n\r\nTHREE.ShaderChunk[ 'equirect_vert' ] = \"varying vec3 vWorldPosition;\\n#include <common>\\n#include <logdepthbuf_pars_vertex>\\n#include <clipping_planes_pars_vertex>\\nvoid main() {\\n\tvWorldPosition = transformDirection( position, modelMatrix );\\n\t#include <begin_vertex>\\n\t#include <project_vertex>\\n\t#include <logdepthbuf_vertex>\\n\t#include <clipping_planes_vertex>\\n}\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderLib/linedashed_frag.glsl\r\n\r\nTHREE.ShaderChunk[ 'linedashed_frag' ] = \"uniform vec3 diffuse;\\nuniform float opacity;\\nuniform float dashSize;\\nuniform float totalSize;\\nvarying float vLineDistance;\\n#include <common>\\n#include <color_pars_fragment>\\n#include <fog_pars_fragment>\\n#include <logdepthbuf_pars_fragment>\\n#include <clipping_planes_pars_fragment>\\nvoid main() {\\n\t#include <clipping_planes_fragment>\\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\\n\t\tdiscard;\\n\t}\\n\tvec3 outgoingLight = vec3( 0.0 );\\n\tvec4 diffuseColor = vec4( diffuse, opacity );\\n\t#include <logdepthbuf_fragment>\\n\t#include <color_fragment>\\n\toutgoingLight = diffuseColor.rgb;\\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\\n\t#include <premultiplied_alpha_fragment>\\n\t#include <tonemapping_fragment>\\n\t#include <encodings_fragment>\\n\t#include <fog_fragment>\\n}\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderLib/linedashed_vert.glsl\r\n\r\nTHREE.ShaderChunk[ 'linedashed_vert' ] = \"uniform float scale;\\nattribute float lineDistance;\\nvarying float vLineDistance;\\n#include <common>\\n#include <color_pars_vertex>\\n#include <logdepthbuf_pars_vertex>\\n#include <clipping_planes_pars_vertex>\\nvoid main() {\\n\t#include <color_vertex>\\n\tvLineDistance = scale * lineDistance;\\n\tvec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\\n\tgl_Position = projectionMatrix * mvPosition;\\n\t#include <logdepthbuf_vertex>\\n\t#include <clipping_planes_vertex>\\n}\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderLib/meshbasic_frag.glsl\r\n\r\nTHREE.ShaderChunk[ 'meshbasic_frag' ] = \"uniform vec3 diffuse;\\nuniform float opacity;\\n#ifndef FLAT_SHADED\\n\tvarying vec3 vNormal;\\n#endif\\n#include <common>\\n#include <color_pars_fragment>\\n#include <uv_pars_fragment>\\n#include <uv2_pars_fragment>\\n#include <map_pars_fragment>\\n#include <alphamap_pars_fragment>\\n#include <aomap_pars_fragment>\\n#include <envmap_pars_fragment>\\n#include <fog_pars_fragment>\\n#include <specularmap_pars_fragment>\\n#include <logdepthbuf_pars_fragment>\\n#include <clipping_planes_pars_fragment>\\nvoid main() {\\n\t#include <clipping_planes_fragment>\\n\tvec4 diffuseColor = vec4( diffuse, opacity );\\n\t#include <logdepthbuf_fragment>\\n\t#include <map_fragment>\\n\t#include <color_fragment>\\n\t#include <alphamap_fragment>\\n\t#include <alphatest_fragment>\\n\t#include <specularmap_fragment>\\n\tReflectedLight reflectedLight;\\n\treflectedLight.directDiffuse = vec3( 0.0 );\\n\treflectedLight.directSpecular = vec3( 0.0 );\\n\treflectedLight.indirectDiffuse = diffuseColor.rgb;\\n\treflectedLight.indirectSpecular = vec3( 0.0 );\\n\t#include <aomap_fragment>\\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\\n\t#include <envmap_fragment>\\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\\n\t#include <premultiplied_alpha_fragment>\\n\t#include <tonemapping_fragment>\\n\t#include <encodings_fragment>\\n\t#include <fog_fragment>\\n}\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderLib/meshbasic_vert.glsl\r\n\r\nTHREE.ShaderChunk[ 'meshbasic_vert' ] = \"#include <common>\\n#include <uv_pars_vertex>\\n#include <uv2_pars_vertex>\\n#include <envmap_pars_vertex>\\n#include <color_pars_vertex>\\n#include <morphtarget_pars_vertex>\\n#include <skinning_pars_vertex>\\n#include <logdepthbuf_pars_vertex>\\n#include <clipping_planes_pars_vertex>\\nvoid main() {\\n\t#include <uv_vertex>\\n\t#include <uv2_vertex>\\n\t#include <color_vertex>\\n\t#include <skinbase_vertex>\\n\t#ifdef USE_ENVMAP\\n\t#include <beginnormal_vertex>\\n\t#include <morphnormal_vertex>\\n\t#include <skinnormal_vertex>\\n\t#include <defaultnormal_vertex>\\n\t#endif\\n\t#include <begin_vertex>\\n\t#include <morphtarget_vertex>\\n\t#include <skinning_vertex>\\n\t#include <project_vertex>\\n\t#include <logdepthbuf_vertex>\\n\t#include <worldpos_vertex>\\n\t#include <clipping_planes_vertex>\\n\t#include <envmap_vertex>\\n}\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderLib/meshlambert_frag.glsl\r\n\r\nTHREE.ShaderChunk[ 'meshlambert_frag' ] = \"uniform vec3 diffuse;\\nuniform vec3 emissive;\\nuniform float opacity;\\nvarying vec3 vLightFront;\\n#ifdef DOUBLE_SIDED\\n\tvarying vec3 vLightBack;\\n#endif\\n#include <common>\\n#include <packing>\\n#include <color_pars_fragment>\\n#include <uv_pars_fragment>\\n#include <uv2_pars_fragment>\\n#include <map_pars_fragment>\\n#include <alphamap_pars_fragment>\\n#include <aomap_pars_fragment>\\n#include <lightmap_pars_fragment>\\n#include <emissivemap_pars_fragment>\\n#include <envmap_pars_fragment>\\n#include <bsdfs>\\n#include <lights_pars>\\n#include <fog_pars_fragment>\\n#include <shadowmap_pars_fragment>\\n#include <shadowmask_pars_fragment>\\n#include <specularmap_pars_fragment>\\n#include <logdepthbuf_pars_fragment>\\n#include <clipping_planes_pars_fragment>\\nvoid main() {\\n\t#include <clipping_planes_fragment>\\n\tvec4 diffuseColor = vec4( diffuse, opacity );\\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\\n\tvec3 totalEmissiveRadiance = emissive;\\n\t#include <logdepthbuf_fragment>\\n\t#include <map_fragment>\\n\t#include <color_fragment>\\n\t#include <alphamap_fragment>\\n\t#include <alphatest_fragment>\\n\t#include <specularmap_fragment>\\n\t#include <emissivemap_fragment>\\n\treflectedLight.indirectDiffuse = getAmbientLightIrradiance( ambientLightColor );\\n\t#include <lightmap_fragment>\\n\treflectedLight.indirectDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb );\\n\t#ifdef DOUBLE_SIDED\\n\t\treflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;\\n\t#else\\n\t\treflectedLight.directDiffuse = vLightFront;\\n\t#endif\\n\treflectedLight.directDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb ) * getShadowMask();\\n\t#include <aomap_fragment>\\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\\n\t#include <envmap_fragment>\\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\\n\t#include <premultiplied_alpha_fragment>\\n\t#include <tonemapping_fragment>\\n\t#include <encodings_fragment>\\n\t#include <fog_fragment>\\n}\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderLib/meshlambert_vert.glsl\r\n\r\nTHREE.ShaderChunk[ 'meshlambert_vert' ] = \"#define LAMBERT\\nvarying vec3 vLightFront;\\n#ifdef DOUBLE_SIDED\\n\tvarying vec3 vLightBack;\\n#endif\\n#include <common>\\n#include <uv_pars_vertex>\\n#include <uv2_pars_vertex>\\n#include <envmap_pars_vertex>\\n#include <bsdfs>\\n#include <lights_pars>\\n#include <color_pars_vertex>\\n#include <morphtarget_pars_vertex>\\n#include <skinning_pars_vertex>\\n#include <shadowmap_pars_vertex>\\n#include <logdepthbuf_pars_vertex>\\n#include <clipping_planes_pars_vertex>\\nvoid main() {\\n\t#include <uv_vertex>\\n\t#include <uv2_vertex>\\n\t#include <color_vertex>\\n\t#include <beginnormal_vertex>\\n\t#include <morphnormal_vertex>\\n\t#include <skinbase_vertex>\\n\t#include <skinnormal_vertex>\\n\t#include <defaultnormal_vertex>\\n\t#include <begin_vertex>\\n\t#include <morphtarget_vertex>\\n\t#include <skinning_vertex>\\n\t#include <project_vertex>\\n\t#include <logdepthbuf_vertex>\\n\t#include <clipping_planes_vertex>\\n\t#include <worldpos_vertex>\\n\t#include <envmap_vertex>\\n\t#include <lights_lambert_vertex>\\n\t#include <shadowmap_vertex>\\n}\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderLib/meshphong_frag.glsl\r\n\r\nTHREE.ShaderChunk[ 'meshphong_frag' ] = \"#define PHONG\\nuniform vec3 diffuse;\\nuniform vec3 emissive;\\nuniform vec3 specular;\\nuniform float shininess;\\nuniform float opacity;\\n#include <common>\\n#include <packing>\\n#include <color_pars_fragment>\\n#include <uv_pars_fragment>\\n#include <uv2_pars_fragment>\\n#include <map_pars_fragment>\\n#include <alphamap_pars_fragment>\\n#include <aomap_pars_fragment>\\n#include <lightmap_pars_fragment>\\n#include <emissivemap_pars_fragment>\\n#include <envmap_pars_fragment>\\n#include <fog_pars_fragment>\\n#include <bsdfs>\\n#include <lights_pars>\\n#include <lights_phong_pars_fragment>\\n#include <shadowmap_pars_fragment>\\n#include <bumpmap_pars_fragment>\\n#include <normalmap_pars_fragment>\\n#include <specularmap_pars_fragment>\\n#include <logdepthbuf_pars_fragment>\\n#include <clipping_planes_pars_fragment>\\nvoid main() {\\n\t#include <clipping_planes_fragment>\\n\tvec4 diffuseColor = vec4( diffuse, opacity );\\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\\n\tvec3 totalEmissiveRadiance = emissive;\\n\t#include <logdepthbuf_fragment>\\n\t#include <map_fragment>\\n\t#include <color_fragment>\\n\t#include <alphamap_fragment>\\n\t#include <alphatest_fragment>\\n\t#include <specularmap_fragment>\\n\t#include <normal_fragment>\\n\t#include <emissivemap_fragment>\\n\t#include <lights_phong_fragment>\\n\t#include <lights_template>\\n\t#include <aomap_fragment>\\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\\n\t#include <envmap_fragment>\\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\\n\t#include <premultiplied_alpha_fragment>\\n\t#include <tonemapping_fragment>\\n\t#include <encodings_fragment>\\n\t#include <fog_fragment>\\n}\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderLib/meshphong_vert.glsl\r\n\r\nTHREE.ShaderChunk[ 'meshphong_vert' ] = \"#define PHONG\\nvarying vec3 vViewPosition;\\n#ifndef FLAT_SHADED\\n\tvarying vec3 vNormal;\\n#endif\\n#include <common>\\n#include <uv_pars_vertex>\\n#include <uv2_pars_vertex>\\n#include <displacementmap_pars_vertex>\\n#include <envmap_pars_vertex>\\n#include <color_pars_vertex>\\n#include <morphtarget_pars_vertex>\\n#include <skinning_pars_vertex>\\n#include <shadowmap_pars_vertex>\\n#include <logdepthbuf_pars_vertex>\\n#include <clipping_planes_pars_vertex>\\nvoid main() {\\n\t#include <uv_vertex>\\n\t#include <uv2_vertex>\\n\t#include <color_vertex>\\n\t#include <beginnormal_vertex>\\n\t#include <morphnormal_vertex>\\n\t#include <skinbase_vertex>\\n\t#include <skinnormal_vertex>\\n\t#include <defaultnormal_vertex>\\n#ifndef FLAT_SHADED\\n\tvNormal = normalize( transformedNormal );\\n#endif\\n\t#include <begin_vertex>\\n\t#include <displacementmap_vertex>\\n\t#include <morphtarget_vertex>\\n\t#include <skinning_vertex>\\n\t#include <project_vertex>\\n\t#include <logdepthbuf_vertex>\\n\t#include <clipping_planes_vertex>\\n\tvViewPosition = - mvPosition.xyz;\\n\t#include <worldpos_vertex>\\n\t#include <envmap_vertex>\\n\t#include <shadowmap_vertex>\\n}\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderLib/meshphysical_frag.glsl\r\n\r\nTHREE.ShaderChunk[ 'meshphysical_frag' ] = \"#define PHYSICAL\\nuniform vec3 diffuse;\\nuniform vec3 emissive;\\nuniform float roughness;\\nuniform float metalness;\\nuniform float opacity;\\nuniform float envMapIntensity;\\nvarying vec3 vViewPosition;\\n#ifndef FLAT_SHADED\\n\tvarying vec3 vNormal;\\n#endif\\n#include <common>\\n#include <packing>\\n#include <color_pars_fragment>\\n#include <uv_pars_fragment>\\n#include <uv2_pars_fragment>\\n#include <map_pars_fragment>\\n#include <alphamap_pars_fragment>\\n#include <aomap_pars_fragment>\\n#include <lightmap_pars_fragment>\\n#include <emissivemap_pars_fragment>\\n#include <envmap_pars_fragment>\\n#include <fog_pars_fragment>\\n#include <bsdfs>\\n#include <cube_uv_reflection_fragment>\\n#include <lights_pars>\\n#include <lights_physical_pars_fragment>\\n#include <shadowmap_pars_fragment>\\n#include <bumpmap_pars_fragment>\\n#include <normalmap_pars_fragment>\\n#include <roughnessmap_pars_fragment>\\n#include <metalnessmap_pars_fragment>\\n#include <logdepthbuf_pars_fragment>\\n#include <clipping_planes_pars_fragment>\\nvoid main() {\\n\t#include <clipping_planes_fragment>\\n\tvec4 diffuseColor = vec4( diffuse, opacity );\\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\\n\tvec3 totalEmissiveRadiance = emissive;\\n\t#include <logdepthbuf_fragment>\\n\t#include <map_fragment>\\n\t#include <color_fragment>\\n\t#include <alphamap_fragment>\\n\t#include <alphatest_fragment>\\n\t#include <specularmap_fragment>\\n\t#include <roughnessmap_fragment>\\n\t#include <metalnessmap_fragment>\\n\t#include <normal_fragment>\\n\t#include <emissivemap_fragment>\\n\t#include <lights_physical_fragment>\\n\t#include <lights_template>\\n\t#include <aomap_fragment>\\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\\n\t#include <premultiplied_alpha_fragment>\\n\t#include <tonemapping_fragment>\\n\t#include <encodings_fragment>\\n\t#include <fog_fragment>\\n}\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderLib/meshphysical_vert.glsl\r\n\r\nTHREE.ShaderChunk[ 'meshphysical_vert' ] = \"#define PHYSICAL\\nvarying vec3 vViewPosition;\\n#ifndef FLAT_SHADED\\n\tvarying vec3 vNormal;\\n#endif\\n#include <common>\\n#include <uv_pars_vertex>\\n#include <uv2_pars_vertex>\\n#include <displacementmap_pars_vertex>\\n#include <color_pars_vertex>\\n#include <morphtarget_pars_vertex>\\n#include <skinning_pars_vertex>\\n#include <shadowmap_pars_vertex>\\n#include <specularmap_pars_fragment>\\n#include <logdepthbuf_pars_vertex>\\n#include <clipping_planes_pars_vertex>\\nvoid main() {\\n\t#include <uv_vertex>\\n\t#include <uv2_vertex>\\n\t#include <color_vertex>\\n\t#include <beginnormal_vertex>\\n\t#include <morphnormal_vertex>\\n\t#include <skinbase_vertex>\\n\t#include <skinnormal_vertex>\\n\t#include <defaultnormal_vertex>\\n#ifndef FLAT_SHADED\\n\tvNormal = normalize( transformedNormal );\\n#endif\\n\t#include <begin_vertex>\\n\t#include <displacementmap_vertex>\\n\t#include <morphtarget_vertex>\\n\t#include <skinning_vertex>\\n\t#include <project_vertex>\\n\t#include <logdepthbuf_vertex>\\n\t#include <clipping_planes_vertex>\\n\tvViewPosition = - mvPosition.xyz;\\n\t#include <worldpos_vertex>\\n\t#include <shadowmap_vertex>\\n}\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderLib/normal_frag.glsl\r\n\r\nTHREE.ShaderChunk[ 'normal_frag' ] = \"uniform float opacity;\\nvarying vec3 vNormal;\\n#include <common>\\n#include <packing>\\n#include <logdepthbuf_pars_fragment>\\n#include <clipping_planes_pars_fragment>\\nvoid main() {\\n\t#include <clipping_planes_fragment>\\n\tgl_FragColor = vec4( packNormalToRGB( vNormal ), opacity );\\n\t#include <logdepthbuf_fragment>\\n}\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderLib/normal_vert.glsl\r\n\r\nTHREE.ShaderChunk[ 'normal_vert' ] = \"varying vec3 vNormal;\\n#include <common>\\n#include <morphtarget_pars_vertex>\\n#include <logdepthbuf_pars_vertex>\\n#include <clipping_planes_pars_vertex>\\nvoid main() {\\n\tvNormal = normalize( normalMatrix * normal );\\n\t#include <begin_vertex>\\n\t#include <morphtarget_vertex>\\n\t#include <project_vertex>\\n\t#include <logdepthbuf_vertex>\\n\t#include <clipping_planes_vertex>\\n}\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderLib/points_frag.glsl\r\n\r\nTHREE.ShaderChunk[ 'points_frag' ] = \"uniform vec3 diffuse;\\nuniform float opacity;\\n#include <common>\\n#include <color_pars_fragment>\\n#include <map_particle_pars_fragment>\\n#include <fog_pars_fragment>\\n#include <shadowmap_pars_fragment>\\n#include <logdepthbuf_pars_fragment>\\n#include <clipping_planes_pars_fragment>\\nvoid main() {\\n\t#include <clipping_planes_fragment>\\n\tvec3 outgoingLight = vec3( 0.0 );\\n\tvec4 diffuseColor = vec4( diffuse, opacity );\\n\t#include <logdepthbuf_fragment>\\n\t#include <map_particle_fragment>\\n\t#include <color_fragment>\\n\t#include <alphatest_fragment>\\n\toutgoingLight = diffuseColor.rgb;\\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\\n\t#include <premultiplied_alpha_fragment>\\n\t#include <tonemapping_fragment>\\n\t#include <encodings_fragment>\\n\t#include <fog_fragment>\\n}\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderLib/points_vert.glsl\r\n\r\nTHREE.ShaderChunk[ 'points_vert' ] = \"uniform float size;\\nuniform float scale;\\n#include <common>\\n#include <color_pars_vertex>\\n#include <shadowmap_pars_vertex>\\n#include <logdepthbuf_pars_vertex>\\n#include <clipping_planes_pars_vertex>\\nvoid main() {\\n\t#include <color_vertex>\\n\t#include <begin_vertex>\\n\t#include <project_vertex>\\n\t#ifdef USE_SIZEATTENUATION\\n\t\tgl_PointSize = size * ( scale / - mvPosition.z );\\n\t#else\\n\t\tgl_PointSize = size;\\n\t#endif\\n\t#include <logdepthbuf_vertex>\\n\t#include <clipping_planes_vertex>\\n\t#include <worldpos_vertex>\\n\t#include <shadowmap_vertex>\\n}\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderLib.js\r\n\r\n/**\r\n * Webgl Shader Library for three.js\r\n *\r\n * @author alteredq / http://alteredqualia.com/\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author mikael emtinger / http://gomo.se/\r\n */\r\n\r\n\r\nTHREE.ShaderLib = {\r\n\r\n\t'basic': {\r\n\r\n\t\tuniforms: THREE.UniformsUtils.merge( [\r\n\r\n\t\t\tTHREE.UniformsLib[ 'common' ],\r\n\t\t\tTHREE.UniformsLib[ 'aomap' ],\r\n\t\t\tTHREE.UniformsLib[ 'fog' ]\r\n\r\n\t\t] ),\r\n\r\n\t\tvertexShader: THREE.ShaderChunk[ 'meshbasic_vert' ],\r\n\t\tfragmentShader: THREE.ShaderChunk[ 'meshbasic_frag' ]\r\n\r\n\t},\r\n\r\n\t'lambert': {\r\n\r\n\t\tuniforms: THREE.UniformsUtils.merge( [\r\n\r\n\t\t\tTHREE.UniformsLib[ 'common' ],\r\n\t\t\tTHREE.UniformsLib[ 'aomap' ],\r\n\t\t\tTHREE.UniformsLib[ 'lightmap' ],\r\n\t\t\tTHREE.UniformsLib[ 'emissivemap' ],\r\n\t\t\tTHREE.UniformsLib[ 'fog' ],\r\n\t\t\tTHREE.UniformsLib[ 'lights' ],\r\n\r\n\t\t\t{\r\n\t\t\t\t\"emissive\" : { type: \"c\", value: new THREE.Color( 0x000000 ) }\r\n\t\t\t}\r\n\r\n\t\t] ),\r\n\r\n\t\tvertexShader: THREE.ShaderChunk[ 'meshlambert_vert' ],\r\n\t\tfragmentShader: THREE.ShaderChunk[ 'meshlambert_frag' ]\r\n\r\n\t},\r\n\r\n\t'phong': {\r\n\r\n\t\tuniforms: THREE.UniformsUtils.merge( [\r\n\r\n\t\t\tTHREE.UniformsLib[ 'common' ],\r\n\t\t\tTHREE.UniformsLib[ 'aomap' ],\r\n\t\t\tTHREE.UniformsLib[ 'lightmap' ],\r\n\t\t\tTHREE.UniformsLib[ 'emissivemap' ],\r\n\t\t\tTHREE.UniformsLib[ 'bumpmap' ],\r\n\t\t\tTHREE.UniformsLib[ 'normalmap' ],\r\n\t\t\tTHREE.UniformsLib[ 'displacementmap' ],\r\n\t\t\tTHREE.UniformsLib[ 'fog' ],\r\n\t\t\tTHREE.UniformsLib[ 'lights' ],\r\n\r\n\t\t\t{\r\n\t\t\t\t\"emissive\" : { type: \"c\", value: new THREE.Color( 0x000000 ) },\r\n\t\t\t\t\"specular\" : { type: \"c\", value: new THREE.Color( 0x111111 ) },\r\n\t\t\t\t\"shininess\": { type: \"1f\", value: 30 }\r\n\t\t\t}\r\n\r\n\t\t] ),\r\n\r\n\t\tvertexShader: THREE.ShaderChunk[ 'meshphong_vert' ],\r\n\t\tfragmentShader: THREE.ShaderChunk[ 'meshphong_frag' ]\r\n\r\n\t},\r\n\r\n\t'standard': {\r\n\r\n\t\tuniforms: THREE.UniformsUtils.merge( [\r\n\r\n\t\t\tTHREE.UniformsLib[ 'common' ],\r\n\t\t\tTHREE.UniformsLib[ 'aomap' ],\r\n\t\t\tTHREE.UniformsLib[ 'lightmap' ],\r\n\t\t\tTHREE.UniformsLib[ 'emissivemap' ],\r\n\t\t\tTHREE.UniformsLib[ 'bumpmap' ],\r\n\t\t\tTHREE.UniformsLib[ 'normalmap' ],\r\n\t\t\tTHREE.UniformsLib[ 'displacementmap' ],\r\n\t\t\tTHREE.UniformsLib[ 'roughnessmap' ],\r\n\t\t\tTHREE.UniformsLib[ 'metalnessmap' ],\r\n\t\t\tTHREE.UniformsLib[ 'fog' ],\r\n\t\t\tTHREE.UniformsLib[ 'lights' ],\r\n\r\n\t\t\t{\r\n\t\t\t\t\"emissive\" : { type: \"c\", value: new THREE.Color( 0x000000 ) },\r\n\t\t\t\t\"roughness\": { type: \"1f\", value: 0.5 },\r\n\t\t\t\t\"metalness\": { type: \"1f\", value: 0 },\r\n\t\t\t\t\"envMapIntensity\" : { type: \"1f\", value: 1 } // temporary\r\n\t\t\t}\r\n\r\n\t\t] ),\r\n\r\n\t\tvertexShader: THREE.ShaderChunk[ 'meshphysical_vert' ],\r\n\t\tfragmentShader: THREE.ShaderChunk[ 'meshphysical_frag' ]\r\n\r\n\t},\r\n\r\n\t'points': {\r\n\r\n\t\tuniforms: THREE.UniformsUtils.merge( [\r\n\r\n\t\t\tTHREE.UniformsLib[ 'points' ],\r\n\t\t\tTHREE.UniformsLib[ 'fog' ]\r\n\r\n\t\t] ),\r\n\r\n\t\tvertexShader: THREE.ShaderChunk[ 'points_vert' ],\r\n\t\tfragmentShader: THREE.ShaderChunk[ 'points_frag' ]\r\n\r\n\t},\r\n\r\n\t'dashed': {\r\n\r\n\t\tuniforms: THREE.UniformsUtils.merge( [\r\n\r\n\t\t\tTHREE.UniformsLib[ 'common' ],\r\n\t\t\tTHREE.UniformsLib[ 'fog' ],\r\n\r\n\t\t\t{\r\n\t\t\t\t\"scale\"    : { type: \"1f\", value: 1 },\r\n\t\t\t\t\"dashSize\" : { type: \"1f\", value: 1 },\r\n\t\t\t\t\"totalSize\": { type: \"1f\", value: 2 }\r\n\t\t\t}\r\n\r\n\t\t] ),\r\n\r\n\t\tvertexShader: THREE.ShaderChunk[ 'linedashed_vert' ],\r\n\t\tfragmentShader: THREE.ShaderChunk[ 'linedashed_frag' ]\r\n\r\n\t},\r\n\r\n\t'depth': {\r\n\r\n\t\tuniforms: THREE.UniformsUtils.merge( [\r\n\r\n\t\t\tTHREE.UniformsLib[ 'common' ],\r\n\t\t\tTHREE.UniformsLib[ 'displacementmap' ]\r\n\r\n\t\t] ),\r\n\r\n\t\tvertexShader: THREE.ShaderChunk[ 'depth_vert' ],\r\n\t\tfragmentShader: THREE.ShaderChunk[ 'depth_frag' ]\r\n\r\n\t},\r\n\r\n\t'normal': {\r\n\r\n\t\tuniforms: {\r\n\r\n\t\t\t\"opacity\" : { type: \"1f\", value: 1.0 }\r\n\r\n\t\t},\r\n\r\n\t\tvertexShader: THREE.ShaderChunk[ 'normal_vert' ],\r\n\t\tfragmentShader: THREE.ShaderChunk[ 'normal_frag' ]\r\n\r\n\t},\r\n\r\n\t/* -------------------------------------------------------------------------\r\n\t//\tCube map shader\r\n\t ------------------------------------------------------------------------- */\r\n\r\n\t'cube': {\r\n\r\n\t\tuniforms: {\r\n\t\t\t\"tCube\": { type: \"t\", value: null },\r\n\t\t\t\"tFlip\": { type: \"1f\", value: - 1 }\r\n\t\t},\r\n\r\n\t\tvertexShader: THREE.ShaderChunk[ 'cube_vert' ],\r\n\t\tfragmentShader: THREE.ShaderChunk[ 'cube_frag' ]\r\n\r\n\t},\r\n\r\n\t/* -------------------------------------------------------------------------\r\n\t//\tCube map shader\r\n\t ------------------------------------------------------------------------- */\r\n\r\n\t'equirect': {\r\n\r\n\t\tuniforms: {\r\n\t\t\t\"tEquirect\": { type: \"t\", value: null },\r\n\t\t\t\"tFlip\": { type: \"1f\", value: - 1 }\r\n\t\t},\r\n\r\n\t\tvertexShader: THREE.ShaderChunk[ 'equirect_vert' ],\r\n\t\tfragmentShader: THREE.ShaderChunk[ 'equirect_frag' ]\r\n\r\n\t},\r\n\r\n\t'distanceRGBA': {\r\n\r\n\t\tuniforms: {\r\n\r\n\t\t\t\"lightPos\": { type: \"v3\", value: new THREE.Vector3() }\r\n\r\n\t\t},\r\n\r\n\t\tvertexShader: THREE.ShaderChunk[ 'distanceRGBA_vert' ],\r\n\t\tfragmentShader: THREE.ShaderChunk[ 'distanceRGBA_frag' ]\r\n\r\n\t}\r\n\r\n};\r\n\r\nTHREE.ShaderLib[ 'physical' ] = {\r\n\r\n\tuniforms: THREE.UniformsUtils.merge( [\r\n\r\n\t\tTHREE.ShaderLib[ 'standard' ].uniforms,\r\n\r\n\t\t{\r\n\t\t\t// future\r\n\t\t}\r\n\r\n\t] ),\r\n\r\n\tvertexShader: THREE.ShaderChunk[ 'meshphysical_vert' ],\r\n\tfragmentShader: THREE.ShaderChunk[ 'meshphysical_frag' ]\r\n\r\n};\r\n\r\n\r\n// File:src/renderers/WebGLRenderer.js\r\n\r\n/**\r\n * @author supereggbert / http://www.paulbrunt.co.uk/\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author alteredq / http://alteredqualia.com/\r\n * @author szimek / https://github.com/szimek/\r\n * @author tschw\r\n */\r\n\r\nTHREE.WebGLRenderer = function ( parameters ) {\r\n\r\n\tconsole.log( 'THREE.WebGLRenderer', THREE.REVISION );\r\n\r\n\tparameters = parameters || {};\r\n\r\n\tvar _canvas = parameters.canvas !== undefined ? parameters.canvas : document.createElement( 'canvas' ),\r\n\t_context = parameters.context !== undefined ? parameters.context : null,\r\n\r\n\t_alpha = parameters.alpha !== undefined ? parameters.alpha : false,\r\n\t_depth = parameters.depth !== undefined ? parameters.depth : true,\r\n\t_stencil = parameters.stencil !== undefined ? parameters.stencil : true,\r\n\t_antialias = parameters.antialias !== undefined ? parameters.antialias : false,\r\n\t_premultipliedAlpha = parameters.premultipliedAlpha !== undefined ? parameters.premultipliedAlpha : true,\r\n\t_preserveDrawingBuffer = parameters.preserveDrawingBuffer !== undefined ? parameters.preserveDrawingBuffer : false;\r\n\r\n\tvar lights = [];\r\n\r\n\tvar opaqueObjects = [];\r\n\tvar opaqueObjectsLastIndex = - 1;\r\n\tvar transparentObjects = [];\r\n\tvar transparentObjectsLastIndex = - 1;\r\n\r\n\tvar morphInfluences = new Float32Array( 8 );\r\n\r\n\tvar sprites = [];\r\n\tvar lensFlares = [];\r\n\r\n\t// public properties\r\n\r\n\tthis.domElement = _canvas;\r\n\tthis.context = null;\r\n\r\n\t// clearing\r\n\r\n\tthis.autoClear = true;\r\n\tthis.autoClearColor = true;\r\n\tthis.autoClearDepth = true;\r\n\tthis.autoClearStencil = true;\r\n\r\n\t// scene graph\r\n\r\n\tthis.sortObjects = true;\r\n\r\n\t// user-defined clipping\r\n\r\n\tthis.clippingPlanes = [];\r\n\tthis.localClippingEnabled = false;\r\n\r\n\t// physically based shading\r\n\r\n\tthis.gammaFactor = 2.0;\t// for backwards compatibility\r\n\tthis.gammaInput = false;\r\n\tthis.gammaOutput = false;\r\n\r\n\t// physical lights\r\n\r\n\tthis.physicallyCorrectLights = false;\r\n\r\n\t// tone mapping\r\n\r\n\tthis.toneMapping = THREE.LinearToneMapping;\r\n\tthis.toneMappingExposure = 1.0;\r\n\tthis.toneMappingWhitePoint = 1.0;\r\n\r\n\t// morphs\r\n\r\n\tthis.maxMorphTargets = 8;\r\n\tthis.maxMorphNormals = 4;\r\n\r\n\t// flags\r\n\r\n\tthis.autoScaleCubemaps = true;\r\n\r\n\t// internal properties\r\n\r\n\tvar _this = this,\r\n\r\n\t// internal state cache\r\n\r\n\t_currentProgram = null,\r\n\t_currentRenderTarget = null,\r\n\t_currentFramebuffer = null,\r\n\t_currentMaterialId = - 1,\r\n\t_currentGeometryProgram = '',\r\n\t_currentCamera = null,\r\n\r\n\t_currentScissor = new THREE.Vector4(),\r\n\t_currentScissorTest = null,\r\n\r\n\t_currentViewport = new THREE.Vector4(),\r\n\r\n\t//\r\n\r\n\t_usedTextureUnits = 0,\r\n\r\n\t//\r\n\r\n\t_clearColor = new THREE.Color( 0x000000 ),\r\n\t_clearAlpha = 0,\r\n\r\n\t_width = _canvas.width,\r\n\t_height = _canvas.height,\r\n\r\n\t_pixelRatio = 1,\r\n\r\n\t_scissor = new THREE.Vector4( 0, 0, _width, _height ),\r\n\t_scissorTest = false,\r\n\r\n\t_viewport = new THREE.Vector4( 0, 0, _width, _height ),\r\n\r\n\t// frustum\r\n\r\n\t_frustum = new THREE.Frustum(),\r\n\r\n\t// clipping\r\n\r\n\t_clippingEnabled = false,\r\n\t_localClippingEnabled = false,\r\n\t_clipRenderingShadows = false,\r\n\r\n\t_numClippingPlanes = 0,\r\n\t_clippingPlanesUniform = {\r\n\t\t\ttype: '4fv', value: null, needsUpdate: false },\r\n\r\n\t_globalClippingState = null,\r\n\t_numGlobalClippingPlanes = 0,\r\n\r\n\t_matrix3 = new THREE.Matrix3(),\r\n\t_sphere = new THREE.Sphere(),\r\n\t_plane = new THREE.Plane(),\r\n\r\n\r\n\t// camera matrices cache\r\n\r\n\t_projScreenMatrix = new THREE.Matrix4(),\r\n\r\n\t_vector3 = new THREE.Vector3(),\r\n\r\n\t// light arrays cache\r\n\r\n\t_lights = {\r\n\r\n\t\thash: '',\r\n\r\n\t\tambient: [ 0, 0, 0 ],\r\n\t\tdirectional: [],\r\n\t\tdirectionalShadowMap: [],\r\n\t\tdirectionalShadowMatrix: [],\r\n\t\tspot: [],\r\n\t\tspotShadowMap: [],\r\n\t\tspotShadowMatrix: [],\r\n\t\tpoint: [],\r\n\t\tpointShadowMap: [],\r\n\t\tpointShadowMatrix: [],\r\n\t\themi: [],\r\n\r\n\t\tshadows: []\r\n\r\n\t},\r\n\r\n\t// info\r\n\r\n\t_infoMemory = {\r\n\r\n\t\tgeometries: 0,\r\n\t\ttextures: 0\r\n\r\n\t},\r\n\r\n\t_infoRender = {\r\n\r\n\t\tcalls: 0,\r\n\t\tvertices: 0,\r\n\t\tfaces: 0,\r\n\t\tpoints: 0\r\n\r\n\t};\r\n\r\n\tthis.info = {\r\n\r\n\t\trender: _infoRender,\r\n\t\tmemory: _infoMemory,\r\n\t\tprograms: null\r\n\r\n\t};\r\n\r\n\r\n\t// initialize\r\n\r\n\tvar _gl;\r\n\r\n\ttry {\r\n\r\n\t\tvar attributes = {\r\n\t\t\talpha: _alpha,\r\n\t\t\tdepth: _depth,\r\n\t\t\tstencil: _stencil,\r\n\t\t\tantialias: _antialias,\r\n\t\t\tpremultipliedAlpha: _premultipliedAlpha,\r\n\t\t\tpreserveDrawingBuffer: _preserveDrawingBuffer\r\n\t\t};\r\n\r\n\t\t_gl = _context || _canvas.getContext( 'webgl', attributes ) || _canvas.getContext( 'experimental-webgl', attributes );\r\n\r\n\t\tif ( _gl === null ) {\r\n\r\n\t\t\tif ( _canvas.getContext( 'webgl' ) !== null ) {\r\n\r\n\t\t\t\tthrow 'Error creating WebGL context with your selected attributes.';\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tthrow 'Error creating WebGL context.';\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\t// Some experimental-webgl implementations do not have getShaderPrecisionFormat\r\n\r\n\t\tif ( _gl.getShaderPrecisionFormat === undefined ) {\r\n\r\n\t\t\t_gl.getShaderPrecisionFormat = function () {\r\n\r\n\t\t\t\treturn { 'rangeMin': 1, 'rangeMax': 1, 'precision': 1 };\r\n\r\n\t\t\t};\r\n\r\n\t\t}\r\n\r\n\t\t_canvas.addEventListener( 'webglcontextlost', onContextLost, false );\r\n\r\n\t} catch ( error ) {\r\n\r\n\t\tconsole.error( 'THREE.WebGLRenderer: ' + error );\r\n\r\n\t}\r\n\r\n\tvar _isWebGL2 = (typeof WebGL2RenderingContext !== 'undefined' && _gl instanceof WebGL2RenderingContext);\r\n\tvar extensions = new THREE.WebGLExtensions( _gl );\r\n\r\n\textensions.get( 'WEBGL_depth_texture' );\r\n\textensions.get( 'OES_texture_float' );\r\n\textensions.get( 'OES_texture_float_linear' );\r\n\textensions.get( 'OES_texture_half_float' );\r\n\textensions.get( 'OES_texture_half_float_linear' );\r\n\textensions.get( 'OES_standard_derivatives' );\r\n\textensions.get( 'ANGLE_instanced_arrays' );\r\n\r\n\tif ( extensions.get( 'OES_element_index_uint' ) ) {\r\n\r\n\t\tTHREE.BufferGeometry.MaxIndex = 4294967296;\r\n\r\n\t}\r\n\r\n\tvar capabilities = new THREE.WebGLCapabilities( _gl, extensions, parameters );\r\n\r\n\tvar state = new THREE.WebGLState( _gl, extensions, paramThreeToGL );\r\n\tvar properties = new THREE.WebGLProperties();\r\n\tvar objects = new THREE.WebGLObjects( _gl, properties, this.info );\r\n\tvar programCache = new THREE.WebGLPrograms( this, capabilities );\r\n\tvar lightCache = new THREE.WebGLLights();\r\n\r\n\tthis.info.programs = programCache.programs;\r\n\r\n\tvar bufferRenderer = new THREE.WebGLBufferRenderer( _gl, extensions, _infoRender );\r\n\tvar indexedBufferRenderer = new THREE.WebGLIndexedBufferRenderer( _gl, extensions, _infoRender );\r\n\r\n\t//\r\n\r\n\tfunction getTargetPixelRatio() {\r\n\r\n\t\treturn _currentRenderTarget === null ? _pixelRatio : 1;\r\n\r\n\t}\r\n\r\n\tfunction glClearColor( r, g, b, a ) {\r\n\r\n\t\tif ( _premultipliedAlpha === true ) {\r\n\r\n\t\t\tr *= a; g *= a; b *= a;\r\n\r\n\t\t}\r\n\r\n\t\tstate.clearColor( r, g, b, a );\r\n\r\n\t}\r\n\r\n\tfunction setDefaultGLState() {\r\n\r\n\t\tstate.init();\r\n\r\n\t\tstate.scissor( _currentScissor.copy( _scissor ).multiplyScalar( _pixelRatio ) );\r\n\t\tstate.viewport( _currentViewport.copy( _viewport ).multiplyScalar( _pixelRatio ) );\r\n\r\n\t\tglClearColor( _clearColor.r, _clearColor.g, _clearColor.b, _clearAlpha );\r\n\r\n\t}\r\n\r\n\tfunction resetGLState() {\r\n\r\n\t\t_currentProgram = null;\r\n\t\t_currentCamera = null;\r\n\r\n\t\t_currentGeometryProgram = '';\r\n\t\t_currentMaterialId = - 1;\r\n\r\n\t\tstate.reset();\r\n\r\n\t}\r\n\r\n\tsetDefaultGLState();\r\n\r\n\tthis.context = _gl;\r\n\tthis.capabilities = capabilities;\r\n\tthis.extensions = extensions;\r\n\tthis.properties = properties;\r\n\tthis.state = state;\r\n\r\n\t// shadow map\r\n\r\n\tvar shadowMap = new THREE.WebGLShadowMap( this, _lights, objects );\r\n\r\n\tthis.shadowMap = shadowMap;\r\n\r\n\r\n\t// Plugins\r\n\r\n\tvar spritePlugin = new THREE.SpritePlugin( this, sprites );\r\n\tvar lensFlarePlugin = new THREE.LensFlarePlugin( this, lensFlares );\r\n\r\n\t// API\r\n\r\n\tthis.getContext = function () {\r\n\r\n\t\treturn _gl;\r\n\r\n\t};\r\n\r\n\tthis.getContextAttributes = function () {\r\n\r\n\t\treturn _gl.getContextAttributes();\r\n\r\n\t};\r\n\r\n\tthis.forceContextLoss = function () {\r\n\r\n\t\textensions.get( 'WEBGL_lose_context' ).loseContext();\r\n\r\n\t};\r\n\r\n\tthis.getMaxAnisotropy = ( function () {\r\n\r\n\t\tvar value;\r\n\r\n\t\treturn function getMaxAnisotropy() {\r\n\r\n\t\t\tif ( value !== undefined ) return value;\r\n\r\n\t\t\tvar extension = extensions.get( 'EXT_texture_filter_anisotropic' );\r\n\r\n\t\t\tif ( extension !== null ) {\r\n\r\n\t\t\t\tvalue = _gl.getParameter( extension.MAX_TEXTURE_MAX_ANISOTROPY_EXT );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tvalue = 0;\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn value;\r\n\r\n\t\t};\r\n\r\n\t} )();\r\n\r\n\tthis.getPrecision = function () {\r\n\r\n\t\treturn capabilities.precision;\r\n\r\n\t};\r\n\r\n\tthis.getPixelRatio = function () {\r\n\r\n\t\treturn _pixelRatio;\r\n\r\n\t};\r\n\r\n\tthis.setPixelRatio = function ( value ) {\r\n\r\n\t\tif ( value === undefined ) return;\r\n\r\n\t\t_pixelRatio = value;\r\n\r\n\t\tthis.setSize( _viewport.z, _viewport.w, false );\r\n\r\n\t};\r\n\r\n\tthis.getSize = function () {\r\n\r\n\t\treturn {\r\n\t\t\twidth: _width,\r\n\t\t\theight: _height\r\n\t\t};\r\n\r\n\t};\r\n\r\n\tthis.setSize = function ( width, height, updateStyle ) {\r\n\r\n\t\t_width = width;\r\n\t\t_height = height;\r\n\r\n\t\t_canvas.width = width * _pixelRatio;\r\n\t\t_canvas.height = height * _pixelRatio;\r\n\r\n\t\tif ( updateStyle !== false ) {\r\n\r\n\t\t\t_canvas.style.width = width + 'px';\r\n\t\t\t_canvas.style.height = height + 'px';\r\n\r\n\t\t}\r\n\r\n\t\tthis.setViewport( 0, 0, width, height );\r\n\r\n\t};\r\n\r\n\tthis.setViewport = function ( x, y, width, height ) {\r\n\r\n\t\tstate.viewport( _viewport.set( x, y, width, height ) );\r\n\r\n\t};\r\n\r\n\tthis.setScissor = function ( x, y, width, height ) {\r\n\r\n\t\tstate.scissor( _scissor.set( x, y, width, height ) );\r\n\r\n\t};\r\n\r\n\tthis.setScissorTest = function ( boolean ) {\r\n\r\n\t\tstate.setScissorTest( _scissorTest = boolean );\r\n\r\n\t};\r\n\r\n\t// Clearing\r\n\r\n\tthis.getClearColor = function () {\r\n\r\n\t\treturn _clearColor;\r\n\r\n\t};\r\n\r\n\tthis.setClearColor = function ( color, alpha ) {\r\n\r\n\t\t_clearColor.set( color );\r\n\r\n\t\t_clearAlpha = alpha !== undefined ? alpha : 1;\r\n\r\n\t\tglClearColor( _clearColor.r, _clearColor.g, _clearColor.b, _clearAlpha );\r\n\r\n\t};\r\n\r\n\tthis.getClearAlpha = function () {\r\n\r\n\t\treturn _clearAlpha;\r\n\r\n\t};\r\n\r\n\tthis.setClearAlpha = function ( alpha ) {\r\n\r\n\t\t_clearAlpha = alpha;\r\n\r\n\t\tglClearColor( _clearColor.r, _clearColor.g, _clearColor.b, _clearAlpha );\r\n\r\n\t};\r\n\r\n\tthis.clear = function ( color, depth, stencil ) {\r\n\r\n\t\tvar bits = 0;\r\n\r\n\t\tif ( color === undefined || color ) bits |= _gl.COLOR_BUFFER_BIT;\r\n\t\tif ( depth === undefined || depth ) bits |= _gl.DEPTH_BUFFER_BIT;\r\n\t\tif ( stencil === undefined || stencil ) bits |= _gl.STENCIL_BUFFER_BIT;\r\n\r\n\t\t_gl.clear( bits );\r\n\r\n\t};\r\n\r\n\tthis.clearColor = function () {\r\n\r\n\t\tthis.clear( true, false, false );\r\n\r\n\t};\r\n\r\n\tthis.clearDepth = function () {\r\n\r\n\t\tthis.clear( false, true, false );\r\n\r\n\t};\r\n\r\n\tthis.clearStencil = function () {\r\n\r\n\t\tthis.clear( false, false, true );\r\n\r\n\t};\r\n\r\n\tthis.clearTarget = function ( renderTarget, color, depth, stencil ) {\r\n\r\n\t\tthis.setRenderTarget( renderTarget );\r\n\t\tthis.clear( color, depth, stencil );\r\n\r\n\t};\r\n\r\n\t// Reset\r\n\r\n\tthis.resetGLState = resetGLState;\r\n\r\n\tthis.dispose = function() {\r\n\r\n\t\t_canvas.removeEventListener( 'webglcontextlost', onContextLost, false );\r\n\r\n\t};\r\n\r\n\t// Events\r\n\r\n\tfunction onContextLost( event ) {\r\n\r\n\t\tevent.preventDefault();\r\n\r\n\t\tresetGLState();\r\n\t\tsetDefaultGLState();\r\n\r\n\t\tproperties.clear();\r\n\r\n\t}\r\n\r\n\tfunction onTextureDispose( event ) {\r\n\r\n\t\tvar texture = event.target;\r\n\r\n\t\ttexture.removeEventListener( 'dispose', onTextureDispose );\r\n\r\n\t\tdeallocateTexture( texture );\r\n\r\n\t\t_infoMemory.textures --;\r\n\r\n\r\n\t}\r\n\r\n\tfunction onRenderTargetDispose( event ) {\r\n\r\n\t\tvar renderTarget = event.target;\r\n\r\n\t\trenderTarget.removeEventListener( 'dispose', onRenderTargetDispose );\r\n\r\n\t\tdeallocateRenderTarget( renderTarget );\r\n\r\n\t\t_infoMemory.textures --;\r\n\r\n\t}\r\n\r\n\tfunction onMaterialDispose( event ) {\r\n\r\n\t\tvar material = event.target;\r\n\r\n\t\tmaterial.removeEventListener( 'dispose', onMaterialDispose );\r\n\r\n\t\tdeallocateMaterial( material );\r\n\r\n\t}\r\n\r\n\t// Buffer deallocation\r\n\r\n\tfunction deallocateTexture( texture ) {\r\n\r\n\t\tvar textureProperties = properties.get( texture );\r\n\r\n\t\tif ( texture.image && textureProperties.__image__webglTextureCube ) {\r\n\r\n\t\t\t// cube texture\r\n\r\n\t\t\t_gl.deleteTexture( textureProperties.__image__webglTextureCube );\r\n\r\n\t\t} else {\r\n\r\n\t\t\t// 2D texture\r\n\r\n\t\t\tif ( textureProperties.__webglInit === undefined ) return;\r\n\r\n\t\t\t_gl.deleteTexture( textureProperties.__webglTexture );\r\n\r\n\t\t}\r\n\r\n\t\t// remove all webgl properties\r\n\t\tproperties.delete( texture );\r\n\r\n\t}\r\n\r\n\tfunction deallocateRenderTarget( renderTarget ) {\r\n\r\n\t\tvar renderTargetProperties = properties.get( renderTarget );\r\n\t\tvar textureProperties = properties.get( renderTarget.texture );\r\n\r\n\t\tif ( ! renderTarget ) return;\r\n\r\n\t\tif ( textureProperties.__webglTexture !== undefined ) {\r\n\r\n\t\t\t_gl.deleteTexture( textureProperties.__webglTexture );\r\n\r\n\t\t}\r\n\r\n\t\tif ( renderTarget.depthTexture ) {\r\n\r\n\t\t\trenderTarget.depthTexture.dispose();\r\n\r\n\t\t}\r\n\r\n\t\tif ( renderTarget instanceof THREE.WebGLRenderTargetCube ) {\r\n\r\n\t\t\tfor ( var i = 0; i < 6; i ++ ) {\r\n\r\n\t\t\t\t_gl.deleteFramebuffer( renderTargetProperties.__webglFramebuffer[ i ] );\r\n\t\t\t\tif ( renderTargetProperties.__webglDepthbuffer ) _gl.deleteRenderbuffer( renderTargetProperties.__webglDepthbuffer[ i ] );\r\n\r\n\t\t\t}\r\n\r\n\t\t} else {\r\n\r\n\t\t\t_gl.deleteFramebuffer( renderTargetProperties.__webglFramebuffer );\r\n\t\t\tif ( renderTargetProperties.__webglDepthbuffer ) _gl.deleteRenderbuffer( renderTargetProperties.__webglDepthbuffer );\r\n\r\n\t\t}\r\n\r\n\t\tproperties.delete( renderTarget.texture );\r\n\t\tproperties.delete( renderTarget );\r\n\r\n\t}\r\n\r\n\tfunction deallocateMaterial( material ) {\r\n\r\n\t\treleaseMaterialProgramReference( material );\r\n\r\n\t\tproperties.delete( material );\r\n\r\n\t}\r\n\r\n\r\n\tfunction releaseMaterialProgramReference( material ) {\r\n\r\n\t\tvar programInfo = properties.get( material ).program;\r\n\r\n\t\tmaterial.program = undefined;\r\n\r\n\t\tif ( programInfo !== undefined ) {\r\n\r\n\t\t\tprogramCache.releaseProgram( programInfo );\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t// Buffer rendering\r\n\r\n\tthis.renderBufferImmediate = function ( object, program, material ) {\r\n\r\n\t\tstate.initAttributes();\r\n\r\n\t\tvar buffers = properties.get( object );\r\n\r\n\t\tif ( object.hasPositions && ! buffers.position ) buffers.position = _gl.createBuffer();\r\n\t\tif ( object.hasNormals && ! buffers.normal ) buffers.normal = _gl.createBuffer();\r\n\t\tif ( object.hasUvs && ! buffers.uv ) buffers.uv = _gl.createBuffer();\r\n\t\tif ( object.hasColors && ! buffers.color ) buffers.color = _gl.createBuffer();\r\n\r\n\t\tvar attributes = program.getAttributes();\r\n\r\n\t\tif ( object.hasPositions ) {\r\n\r\n\t\t\t_gl.bindBuffer( _gl.ARRAY_BUFFER, buffers.position );\r\n\t\t\t_gl.bufferData( _gl.ARRAY_BUFFER, object.positionArray, _gl.DYNAMIC_DRAW );\r\n\r\n\t\t\tstate.enableAttribute( attributes.position );\r\n\t\t\t_gl.vertexAttribPointer( attributes.position, 3, _gl.FLOAT, false, 0, 0 );\r\n\r\n\t\t}\r\n\r\n\t\tif ( object.hasNormals ) {\r\n\r\n\t\t\t_gl.bindBuffer( _gl.ARRAY_BUFFER, buffers.normal );\r\n\r\n\t\t\tif ( material.type !== 'MeshPhongMaterial' && material.type !== 'MeshStandardMaterial' && material.type !== 'MeshPhysicalMaterial' && material.shading === THREE.FlatShading ) {\r\n\r\n\t\t\t\tfor ( var i = 0, l = object.count * 3; i < l; i += 9 ) {\r\n\r\n\t\t\t\t\tvar array = object.normalArray;\r\n\r\n\t\t\t\t\tvar nx = ( array[ i + 0 ] + array[ i + 3 ] + array[ i + 6 ] ) / 3;\r\n\t\t\t\t\tvar ny = ( array[ i + 1 ] + array[ i + 4 ] + array[ i + 7 ] ) / 3;\r\n\t\t\t\t\tvar nz = ( array[ i + 2 ] + array[ i + 5 ] + array[ i + 8 ] ) / 3;\r\n\r\n\t\t\t\t\tarray[ i + 0 ] = nx;\r\n\t\t\t\t\tarray[ i + 1 ] = ny;\r\n\t\t\t\t\tarray[ i + 2 ] = nz;\r\n\r\n\t\t\t\t\tarray[ i + 3 ] = nx;\r\n\t\t\t\t\tarray[ i + 4 ] = ny;\r\n\t\t\t\t\tarray[ i + 5 ] = nz;\r\n\r\n\t\t\t\t\tarray[ i + 6 ] = nx;\r\n\t\t\t\t\tarray[ i + 7 ] = ny;\r\n\t\t\t\t\tarray[ i + 8 ] = nz;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\t_gl.bufferData( _gl.ARRAY_BUFFER, object.normalArray, _gl.DYNAMIC_DRAW );\r\n\r\n\t\t\tstate.enableAttribute( attributes.normal );\r\n\r\n\t\t\t_gl.vertexAttribPointer( attributes.normal, 3, _gl.FLOAT, false, 0, 0 );\r\n\r\n\t\t}\r\n\r\n\t\tif ( object.hasUvs && material.map ) {\r\n\r\n\t\t\t_gl.bindBuffer( _gl.ARRAY_BUFFER, buffers.uv );\r\n\t\t\t_gl.bufferData( _gl.ARRAY_BUFFER, object.uvArray, _gl.DYNAMIC_DRAW );\r\n\r\n\t\t\tstate.enableAttribute( attributes.uv );\r\n\r\n\t\t\t_gl.vertexAttribPointer( attributes.uv, 2, _gl.FLOAT, false, 0, 0 );\r\n\r\n\t\t}\r\n\r\n\t\tif ( object.hasColors && material.vertexColors !== THREE.NoColors ) {\r\n\r\n\t\t\t_gl.bindBuffer( _gl.ARRAY_BUFFER, buffers.color );\r\n\t\t\t_gl.bufferData( _gl.ARRAY_BUFFER, object.colorArray, _gl.DYNAMIC_DRAW );\r\n\r\n\t\t\tstate.enableAttribute( attributes.color );\r\n\r\n\t\t\t_gl.vertexAttribPointer( attributes.color, 3, _gl.FLOAT, false, 0, 0 );\r\n\r\n\t\t}\r\n\r\n\t\tstate.disableUnusedAttributes();\r\n\r\n\t\t_gl.drawArrays( _gl.TRIANGLES, 0, object.count );\r\n\r\n\t\tobject.count = 0;\r\n\r\n\t};\r\n\r\n\tthis.renderBufferDirect = function ( camera, fog, geometry, material, object, group ) {\r\n\r\n\t\tsetMaterial( material );\r\n\r\n\t\tvar program = setProgram( camera, fog, material, object );\r\n\r\n\t\tvar updateBuffers = false;\r\n\t\tvar geometryProgram = geometry.id + '_' + program.id + '_' + material.wireframe;\r\n\r\n\t\tif ( geometryProgram !== _currentGeometryProgram ) {\r\n\r\n\t\t\t_currentGeometryProgram = geometryProgram;\r\n\t\t\tupdateBuffers = true;\r\n\r\n\t\t}\r\n\r\n\t\t// morph targets\r\n\r\n\t\tvar morphTargetInfluences = object.morphTargetInfluences;\r\n\r\n\t\tif ( morphTargetInfluences !== undefined ) {\r\n\r\n\t\t\tvar activeInfluences = [];\r\n\r\n\t\t\tfor ( var i = 0, l = morphTargetInfluences.length; i < l; i ++ ) {\r\n\r\n\t\t\t\tvar influence = morphTargetInfluences[ i ];\r\n\t\t\t\tactiveInfluences.push( [ influence, i ] );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tactiveInfluences.sort( absNumericalSort );\r\n\r\n\t\t\tif ( activeInfluences.length > 8 ) {\r\n\r\n\t\t\t\tactiveInfluences.length = 8;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar morphAttributes = geometry.morphAttributes;\r\n\r\n\t\t\tfor ( var i = 0, l = activeInfluences.length; i < l; i ++ ) {\r\n\r\n\t\t\t\tvar influence = activeInfluences[ i ];\r\n\t\t\t\tmorphInfluences[ i ] = influence[ 0 ];\r\n\r\n\t\t\t\tif ( influence[ 0 ] !== 0 ) {\r\n\r\n\t\t\t\t\tvar index = influence[ 1 ];\r\n\r\n\t\t\t\t\tif ( material.morphTargets === true && morphAttributes.position ) geometry.addAttribute( 'morphTarget' + i, morphAttributes.position[ index ] );\r\n\t\t\t\t\tif ( material.morphNormals === true && morphAttributes.normal ) geometry.addAttribute( 'morphNormal' + i, morphAttributes.normal[ index ] );\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tif ( material.morphTargets === true ) geometry.removeAttribute( 'morphTarget' + i );\r\n\t\t\t\t\tif ( material.morphNormals === true ) geometry.removeAttribute( 'morphNormal' + i );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tprogram.getUniforms().setValue(\r\n\t\t\t\t\t_gl, 'morphTargetInfluences', morphInfluences );\r\n\r\n\t\t\tupdateBuffers = true;\r\n\r\n\t\t}\r\n\r\n\t\t//\r\n\r\n\t\tvar index = geometry.index;\r\n\t\tvar position = geometry.attributes.position;\r\n\r\n\t\tif ( material.wireframe === true ) {\r\n\r\n\t\t\tindex = objects.getWireframeAttribute( geometry );\r\n\r\n\t\t}\r\n\r\n\t\tvar renderer;\r\n\r\n\t\tif ( index !== null ) {\r\n\r\n\t\t\trenderer = indexedBufferRenderer;\r\n\t\t\trenderer.setIndex( index );\r\n\r\n\t\t} else {\r\n\r\n\t\t\trenderer = bufferRenderer;\r\n\r\n\t\t}\r\n\r\n\t\tif ( updateBuffers ) {\r\n\r\n\t\t\tsetupVertexAttributes( material, program, geometry );\r\n\r\n\t\t\tif ( index !== null ) {\r\n\r\n\t\t\t\t_gl.bindBuffer( _gl.ELEMENT_ARRAY_BUFFER, objects.getAttributeBuffer( index ) );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\t//\r\n\r\n\t\tvar dataStart = 0;\r\n\t\tvar dataCount = Infinity;\r\n\r\n\t\tif ( index !== null ) {\r\n\r\n\t\t\tdataCount = index.count;\r\n\r\n\t\t} else if ( position !== undefined ) {\r\n\r\n\t\t\tdataCount = position.count;\r\n\r\n\t\t}\r\n\r\n\t\tvar rangeStart = geometry.drawRange.start;\r\n\t\tvar rangeCount = geometry.drawRange.count;\r\n\r\n\t\tvar groupStart = group !== null ? group.start : 0;\r\n\t\tvar groupCount = group !== null ? group.count : Infinity;\r\n\r\n\t\tvar drawStart = Math.max( dataStart, rangeStart, groupStart );\r\n\t\tvar drawEnd = Math.min( dataStart + dataCount, rangeStart + rangeCount, groupStart + groupCount ) - 1;\r\n\r\n\t\tvar drawCount = Math.max( 0, drawEnd - drawStart + 1 );\r\n\r\n\t\t//\r\n\r\n\t\tif ( object instanceof THREE.Mesh ) {\r\n\r\n\t\t\tif ( material.wireframe === true ) {\r\n\r\n\t\t\t\tstate.setLineWidth( material.wireframeLinewidth * getTargetPixelRatio() );\r\n\t\t\t\trenderer.setMode( _gl.LINES );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tswitch ( object.drawMode ) {\r\n\r\n\t\t\t\t\tcase THREE.TrianglesDrawMode:\r\n\t\t\t\t\t\trenderer.setMode( _gl.TRIANGLES );\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase THREE.TriangleStripDrawMode:\r\n\t\t\t\t\t\trenderer.setMode( _gl.TRIANGLE_STRIP );\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase THREE.TriangleFanDrawMode:\r\n\t\t\t\t\t\trenderer.setMode( _gl.TRIANGLE_FAN );\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\r\n\t\t} else if ( object instanceof THREE.Line ) {\r\n\r\n\t\t\tvar lineWidth = material.linewidth;\r\n\r\n\t\t\tif ( lineWidth === undefined ) lineWidth = 1; // Not using Line*Material\r\n\r\n\t\t\tstate.setLineWidth( lineWidth * getTargetPixelRatio() );\r\n\r\n\t\t\tif ( object instanceof THREE.LineSegments ) {\r\n\r\n\t\t\t\trenderer.setMode( _gl.LINES );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\trenderer.setMode( _gl.LINE_STRIP );\r\n\r\n\t\t\t}\r\n\r\n\t\t} else if ( object instanceof THREE.Points ) {\r\n\r\n\t\t\trenderer.setMode( _gl.POINTS );\r\n\r\n\t\t}\r\n\r\n\t\tif ( geometry instanceof THREE.InstancedBufferGeometry ) {\r\n\r\n\t\t\tif ( geometry.maxInstancedCount > 0 ) {\r\n\r\n\t\t\t\trenderer.renderInstances( geometry, drawStart, drawCount );\r\n\r\n\t\t\t}\r\n\r\n\t\t} else {\r\n\r\n\t\t\trenderer.render( drawStart, drawCount );\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n\tfunction setupVertexAttributes( material, program, geometry, startIndex ) {\r\n\r\n\t\tvar extension;\r\n\r\n\t\tif ( geometry instanceof THREE.InstancedBufferGeometry ) {\r\n\r\n\t\t\textension = extensions.get( 'ANGLE_instanced_arrays' );\r\n\r\n\t\t\tif ( extension === null ) {\r\n\r\n\t\t\t\tconsole.error( 'THREE.WebGLRenderer.setupVertexAttributes: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.' );\r\n\t\t\t\treturn;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tif ( startIndex === undefined ) startIndex = 0;\r\n\r\n\t\tstate.initAttributes();\r\n\r\n\t\tvar geometryAttributes = geometry.attributes;\r\n\r\n\t\tvar programAttributes = program.getAttributes();\r\n\r\n\t\tvar materialDefaultAttributeValues = material.defaultAttributeValues;\r\n\r\n\t\tfor ( var name in programAttributes ) {\r\n\r\n\t\t\tvar programAttribute = programAttributes[ name ];\r\n\r\n\t\t\tif ( programAttribute >= 0 ) {\r\n\r\n\t\t\t\tvar geometryAttribute = geometryAttributes[ name ];\r\n\r\n\t\t\t\tif ( geometryAttribute !== undefined ) {\r\n\r\n\t\t\t\t\tvar type = _gl.FLOAT;\r\n\t\t\t\t\tvar array = geometryAttribute.array;\r\n\t\t\t\t\tvar normalized = geometryAttribute.normalized;\r\n\r\n\t\t\t\t\tif ( array instanceof Float32Array ) {\r\n\r\n\t\t\t\t\t\ttype = _gl.FLOAT;\r\n\r\n\t\t\t\t\t} else if ( array instanceof Float64Array ) {\r\n\r\n\t\t\t\t\t\tconsole.warn(\"Unsupported data buffer format: Float64Array\");\r\n\r\n\t\t\t\t\t} else if ( array instanceof Uint16Array ) {\r\n\r\n\t\t\t\t\t\ttype = _gl.UNSIGNED_SHORT;\r\n\r\n\t\t\t\t\t} else if ( array instanceof Int16Array ) {\r\n\r\n\t\t\t\t\t\ttype = _gl.SHORT;\r\n\r\n\t\t\t\t\t} else if ( array instanceof Uint32Array ) {\r\n\r\n\t\t\t\t\t\ttype = _gl.UNSIGNED_INT;\r\n\r\n\t\t\t\t\t} else if ( array instanceof Int32Array ) {\r\n\r\n\t\t\t\t\t\ttype = _gl.INT;\r\n\r\n\t\t\t\t\t} else if ( array instanceof Int8Array ) {\r\n\r\n\t\t\t\t\t\ttype = _gl.BYTE;\r\n\r\n\t\t\t\t\t} else if ( array instanceof Uint8Array ) {\r\n\r\n\t\t\t\t\t\ttype = _gl.UNSIGNED_BYTE;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tvar size = geometryAttribute.itemSize;\r\n\t\t\t\t\tvar buffer = objects.getAttributeBuffer( geometryAttribute );\r\n\r\n\t\t\t\t\tif ( geometryAttribute instanceof THREE.InterleavedBufferAttribute ) {\r\n\r\n\t\t\t\t\t\tvar data = geometryAttribute.data;\r\n\t\t\t\t\t\tvar stride = data.stride;\r\n\t\t\t\t\t\tvar offset = geometryAttribute.offset;\r\n\r\n\t\t\t\t\t\tif ( data instanceof THREE.InstancedInterleavedBuffer ) {\r\n\r\n\t\t\t\t\t\t\tstate.enableAttributeAndDivisor( programAttribute, data.meshPerAttribute, extension );\r\n\r\n\t\t\t\t\t\t\tif ( geometry.maxInstancedCount === undefined ) {\r\n\r\n\t\t\t\t\t\t\t\tgeometry.maxInstancedCount = data.meshPerAttribute * data.count;\r\n\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\t\tstate.enableAttribute( programAttribute );\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t_gl.bindBuffer( _gl.ARRAY_BUFFER, buffer );\r\n\t\t\t\t\t\t_gl.vertexAttribPointer( programAttribute, size, type, normalized, stride * data.array.BYTES_PER_ELEMENT, ( startIndex * stride + offset ) * data.array.BYTES_PER_ELEMENT );\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\tif ( geometryAttribute instanceof THREE.InstancedBufferAttribute ) {\r\n\r\n\t\t\t\t\t\t\tstate.enableAttributeAndDivisor( programAttribute, geometryAttribute.meshPerAttribute, extension );\r\n\r\n\t\t\t\t\t\t\tif ( geometry.maxInstancedCount === undefined ) {\r\n\r\n\t\t\t\t\t\t\t\tgeometry.maxInstancedCount = geometryAttribute.meshPerAttribute * geometryAttribute.count;\r\n\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\t\tstate.enableAttribute( programAttribute );\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t_gl.bindBuffer( _gl.ARRAY_BUFFER, buffer );\r\n\t\t\t\t\t\t_gl.vertexAttribPointer( programAttribute, size, type, normalized, 0, startIndex * size * geometryAttribute.array.BYTES_PER_ELEMENT );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t} else if ( materialDefaultAttributeValues !== undefined ) {\r\n\r\n\t\t\t\t\tvar value = materialDefaultAttributeValues[ name ];\r\n\r\n\t\t\t\t\tif ( value !== undefined ) {\r\n\r\n\t\t\t\t\t\tswitch ( value.length ) {\r\n\r\n\t\t\t\t\t\t\tcase 2:\r\n\t\t\t\t\t\t\t\t_gl.vertexAttrib2fv( programAttribute, value );\r\n\t\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\t\tcase 3:\r\n\t\t\t\t\t\t\t\t_gl.vertexAttrib3fv( programAttribute, value );\r\n\t\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\t\tcase 4:\r\n\t\t\t\t\t\t\t\t_gl.vertexAttrib4fv( programAttribute, value );\r\n\t\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\t\tdefault:\r\n\t\t\t\t\t\t\t\t_gl.vertexAttrib1fv( programAttribute, value );\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tstate.disableUnusedAttributes();\r\n\r\n\t}\r\n\r\n\t// Sorting\r\n\r\n\tfunction absNumericalSort( a, b ) {\r\n\r\n\t\treturn Math.abs( b[ 0 ] ) - Math.abs( a[ 0 ] );\r\n\r\n\t}\r\n\r\n\tfunction painterSortStable ( a, b ) {\r\n\r\n\t\tif ( a.object.renderOrder !== b.object.renderOrder ) {\r\n\r\n\t\t\treturn a.object.renderOrder - b.object.renderOrder;\r\n\r\n\t\t} else if ( a.material.id !== b.material.id ) {\r\n\r\n\t\t\treturn a.material.id - b.material.id;\r\n\r\n\t\t} else if ( a.z !== b.z ) {\r\n\r\n\t\t\treturn a.z - b.z;\r\n\r\n\t\t} else {\r\n\r\n\t\t\treturn a.id - b.id;\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tfunction reversePainterSortStable ( a, b ) {\r\n\r\n\t\tif ( a.object.renderOrder !== b.object.renderOrder ) {\r\n\r\n\t\t\treturn a.object.renderOrder - b.object.renderOrder;\r\n\r\n\t\t} if ( a.z !== b.z ) {\r\n\r\n\t\t\treturn b.z - a.z;\r\n\r\n\t\t} else {\r\n\r\n\t\t\treturn a.id - b.id;\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t// Rendering\r\n\r\n\tthis.render = function ( scene, camera, renderTarget, forceClear ) {\r\n\r\n\t\tif ( camera instanceof THREE.Camera === false ) {\r\n\r\n\t\t\tconsole.error( 'THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.' );\r\n\t\t\treturn;\r\n\r\n\t\t}\r\n\r\n\t\tvar fog = scene.fog;\r\n\r\n\t\t// reset caching for this frame\r\n\r\n\t\t_currentGeometryProgram = '';\r\n\t\t_currentMaterialId = - 1;\r\n\t\t_currentCamera = null;\r\n\r\n\t\t// update scene graph\r\n\r\n\t\tif ( scene.autoUpdate === true ) scene.updateMatrixWorld();\r\n\r\n\t\t// update camera matrices and frustum\r\n\r\n\t\tif ( camera.parent === null ) camera.updateMatrixWorld();\r\n\r\n\t\tcamera.matrixWorldInverse.getInverse( camera.matrixWorld );\r\n\r\n\t\t_projScreenMatrix.multiplyMatrices( camera.projectionMatrix, camera.matrixWorldInverse );\r\n\t\t_frustum.setFromMatrix( _projScreenMatrix );\r\n\r\n\t\tlights.length = 0;\r\n\r\n\t\topaqueObjectsLastIndex = - 1;\r\n\t\ttransparentObjectsLastIndex = - 1;\r\n\r\n\t\tsprites.length = 0;\r\n\t\tlensFlares.length = 0;\r\n\r\n\t\tsetupGlobalClippingPlanes( this.clippingPlanes, camera );\r\n\r\n\t\tprojectObject( scene, camera );\r\n\r\n\r\n\t\topaqueObjects.length = opaqueObjectsLastIndex + 1;\r\n\t\ttransparentObjects.length = transparentObjectsLastIndex + 1;\r\n\r\n\t\tif ( _this.sortObjects === true ) {\r\n\r\n\t\t\topaqueObjects.sort( painterSortStable );\r\n\t\t\ttransparentObjects.sort( reversePainterSortStable );\r\n\r\n\t\t}\r\n\r\n\t\t//\r\n\r\n\t\tif ( _clippingEnabled ) {\r\n\r\n\t\t\t_clipRenderingShadows = true;\r\n\t\t\tsetupClippingPlanes( null );\r\n\r\n\t\t}\r\n\r\n\t\tsetupShadows( lights );\r\n\r\n\t\tshadowMap.render( scene, camera );\r\n\r\n\t\tsetupLights( lights, camera );\r\n\r\n\t\tif ( _clippingEnabled ) {\r\n\r\n\t\t\t_clipRenderingShadows = false;\r\n\t\t\tresetGlobalClippingState();\r\n\r\n\t\t}\r\n\r\n\t\t//\r\n\r\n\t\t_infoRender.calls = 0;\r\n\t\t_infoRender.vertices = 0;\r\n\t\t_infoRender.faces = 0;\r\n\t\t_infoRender.points = 0;\r\n\r\n\t\tif ( renderTarget === undefined ) {\r\n\r\n\t\t\trenderTarget = null;\r\n\r\n\t\t}\r\n\r\n\t\tthis.setRenderTarget( renderTarget );\r\n\r\n\t\tif ( this.autoClear || forceClear ) {\r\n\r\n\t\t\tthis.clear( this.autoClearColor, this.autoClearDepth, this.autoClearStencil );\r\n\r\n\t\t}\r\n\r\n\t\t//\r\n\r\n\t\tif ( scene.overrideMaterial ) {\r\n\r\n\t\t\tvar overrideMaterial = scene.overrideMaterial;\r\n\r\n\t\t\trenderObjects( opaqueObjects, camera, fog, overrideMaterial );\r\n\t\t\trenderObjects( transparentObjects, camera, fog, overrideMaterial );\r\n\r\n\t\t} else {\r\n\r\n\t\t\t// opaque pass (front-to-back order)\r\n\r\n\t\t\tstate.setBlending( THREE.NoBlending );\r\n\t\t\trenderObjects( opaqueObjects, camera, fog );\r\n\r\n\t\t\t// transparent pass (back-to-front order)\r\n\r\n\t\t\trenderObjects( transparentObjects, camera, fog );\r\n\r\n\t\t}\r\n\r\n\t\t// custom render plugins (post pass)\r\n\r\n\t\tspritePlugin.render( scene, camera );\r\n\t\tlensFlarePlugin.render( scene, camera, _currentViewport );\r\n\r\n\t\t// Generate mipmap if we're using any kind of mipmap filtering\r\n\r\n\t\tif ( renderTarget ) {\r\n\r\n\t\t\tvar texture = renderTarget.texture;\r\n\r\n\t\t\tif ( texture.generateMipmaps && isPowerOfTwo( renderTarget ) &&\r\n\t\t\t\t\ttexture.minFilter !== THREE.NearestFilter &&\r\n\t\t\t\t\ttexture.minFilter !== THREE.LinearFilter ) {\r\n\r\n\t\t\t\tupdateRenderTargetMipmap( renderTarget );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\t// Ensure depth buffer writing is enabled so it can be cleared on next render\r\n\r\n\t\tstate.setDepthTest( true );\r\n\t\tstate.setDepthWrite( true );\r\n\t\tstate.setColorWrite( true );\r\n\r\n\t\t// _gl.finish();\r\n\r\n\t};\r\n\r\n\tfunction pushRenderItem( object, geometry, material, z, group ) {\r\n\r\n\t\tvar array, index;\r\n\r\n\t\t// allocate the next position in the appropriate array\r\n\r\n\t\tif ( material.transparent ) {\r\n\r\n\t\t\tarray = transparentObjects;\r\n\t\t\tindex = ++ transparentObjectsLastIndex;\r\n\r\n\t\t} else {\r\n\r\n\t\t\tarray = opaqueObjects;\r\n\t\t\tindex = ++ opaqueObjectsLastIndex;\r\n\r\n\t\t}\r\n\r\n\t\t// recycle existing render item or grow the array\r\n\r\n\t\tvar renderItem = array[ index ];\r\n\r\n\t\tif ( renderItem !== undefined ) {\r\n\r\n\t\t\trenderItem.id = object.id;\r\n\t\t\trenderItem.object = object;\r\n\t\t\trenderItem.geometry = geometry;\r\n\t\t\trenderItem.material = material;\r\n\t\t\trenderItem.z = _vector3.z;\r\n\t\t\trenderItem.group = group;\r\n\r\n\t\t} else {\r\n\r\n\t\t\trenderItem = {\r\n\t\t\t\tid: object.id,\r\n\t\t\t\tobject: object,\r\n\t\t\t\tgeometry: geometry,\r\n\t\t\t\tmaterial: material,\r\n\t\t\t\tz: _vector3.z,\r\n\t\t\t\tgroup: group\r\n\t\t\t};\r\n\r\n\t\t\t// assert( index === array.length );\r\n\t\t\tarray.push( renderItem );\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tfunction isObjectViewable( object ) {\r\n\r\n\t\tvar geometry = object.geometry;\r\n\r\n\t\tif ( geometry.boundingSphere === null )\r\n\t\t\tgeometry.computeBoundingSphere();\r\n\r\n\t\tvar sphere = _sphere.\r\n\t\t\t\tcopy( geometry.boundingSphere ).\r\n\t\t\t\tapplyMatrix4( object.matrixWorld );\r\n\r\n\t\tif ( ! _frustum.intersectsSphere( sphere ) ) return false;\r\n\t\tif ( _numClippingPlanes === 0 ) return true;\r\n\r\n\t\tvar planes = _this.clippingPlanes,\r\n\r\n\t\t\tcenter = sphere.center,\r\n\t\t\tnegRad = - sphere.radius,\r\n\t\t\ti = 0;\r\n\r\n\t\tdo {\r\n\r\n\t\t\t// out when deeper than radius in the negative halfspace\r\n\t\t\tif ( planes[ i ].distanceToPoint( center ) < negRad ) return false;\r\n\r\n\t\t} while ( ++ i !== _numClippingPlanes );\r\n\r\n\t\treturn true;\r\n\r\n\t}\r\n\r\n\tfunction projectObject( object, camera ) {\r\n\r\n\t\tif ( object.visible === false ) return;\r\n\r\n\t\tif ( object.layers.test( camera.layers ) ) {\r\n\r\n\t\t\tif ( object instanceof THREE.Light ) {\r\n\r\n\t\t\t\tlights.push( object );\r\n\r\n\t\t\t} else if ( object instanceof THREE.Sprite ) {\r\n\r\n\t\t\t\tif ( object.frustumCulled === false || isObjectViewable( object ) === true ) {\r\n\r\n\t\t\t\t\tsprites.push( object );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t} else if ( object instanceof THREE.LensFlare ) {\r\n\r\n\t\t\t\tlensFlares.push( object );\r\n\r\n\t\t\t} else if ( object instanceof THREE.ImmediateRenderObject ) {\r\n\r\n\t\t\t\tif ( _this.sortObjects === true ) {\r\n\r\n\t\t\t\t\t_vector3.setFromMatrixPosition( object.matrixWorld );\r\n\t\t\t\t\t_vector3.applyProjection( _projScreenMatrix );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tpushRenderItem( object, null, object.material, _vector3.z, null );\r\n\r\n\t\t\t} else if ( object instanceof THREE.Mesh || object instanceof THREE.Line || object instanceof THREE.Points ) {\r\n\r\n\t\t\t\tif ( object instanceof THREE.SkinnedMesh ) {\r\n\r\n\t\t\t\t\tobject.skeleton.update();\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( object.frustumCulled === false || isObjectViewable( object ) === true ) {\r\n\r\n\t\t\t\t\tvar material = object.material;\r\n\r\n\t\t\t\t\tif ( material.visible === true ) {\r\n\r\n\t\t\t\t\t\tif ( _this.sortObjects === true ) {\r\n\r\n\t\t\t\t\t\t\t_vector3.setFromMatrixPosition( object.matrixWorld );\r\n\t\t\t\t\t\t\t_vector3.applyProjection( _projScreenMatrix );\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tvar geometry = objects.update( object );\r\n\r\n\t\t\t\t\t\tif ( material instanceof THREE.MultiMaterial ) {\r\n\r\n\t\t\t\t\t\t\tvar groups = geometry.groups;\r\n\t\t\t\t\t\t\tvar materials = material.materials;\r\n\r\n\t\t\t\t\t\t\tfor ( var i = 0, l = groups.length; i < l; i ++ ) {\r\n\r\n\t\t\t\t\t\t\t\tvar group = groups[ i ];\r\n\t\t\t\t\t\t\t\tvar groupMaterial = materials[ group.materialIndex ];\r\n\r\n\t\t\t\t\t\t\t\tif ( groupMaterial.visible === true ) {\r\n\r\n\t\t\t\t\t\t\t\t\tpushRenderItem( object, geometry, groupMaterial, _vector3.z, group );\r\n\r\n\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\t\tpushRenderItem( object, geometry, material, _vector3.z, null );\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tvar children = object.children;\r\n\r\n\t\tfor ( var i = 0, l = children.length; i < l; i ++ ) {\r\n\r\n\t\t\tprojectObject( children[ i ], camera );\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tfunction renderObjects( renderList, camera, fog, overrideMaterial ) {\r\n\r\n\t\tfor ( var i = 0, l = renderList.length; i < l; i ++ ) {\r\n\r\n\t\t\tvar renderItem = renderList[ i ];\r\n\r\n\t\t\tvar object = renderItem.object;\r\n\t\t\tvar geometry = renderItem.geometry;\r\n\t\t\tvar material = overrideMaterial === undefined ? renderItem.material : overrideMaterial;\r\n\t\t\tvar group = renderItem.group;\r\n\r\n\t\t\tobject.modelViewMatrix.multiplyMatrices( camera.matrixWorldInverse, object.matrixWorld );\r\n\t\t\tobject.normalMatrix.getNormalMatrix( object.modelViewMatrix );\r\n\r\n\t\t\tif ( object instanceof THREE.ImmediateRenderObject ) {\r\n\r\n\t\t\t\tsetMaterial( material );\r\n\r\n\t\t\t\tvar program = setProgram( camera, fog, material, object );\r\n\r\n\t\t\t\t_currentGeometryProgram = '';\r\n\r\n\t\t\t\tobject.render( function ( object ) {\r\n\r\n\t\t\t\t\t_this.renderBufferImmediate( object, program, material );\r\n\r\n\t\t\t\t} );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\t_this.renderBufferDirect( camera, fog, geometry, material, object, group );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tfunction initMaterial( material, fog, object ) {\r\n\r\n\t\tvar materialProperties = properties.get( material );\r\n\r\n\t\tvar parameters = programCache.getParameters(\r\n\t\t\t\tmaterial, _lights, fog, _numClippingPlanes, object );\r\n\r\n\t\tvar code = programCache.getProgramCode( material, parameters );\r\n\r\n\t\tvar program = materialProperties.program;\r\n\t\tvar programChange = true;\r\n\r\n\t\tif ( program === undefined ) {\r\n\r\n\t\t\t// new material\r\n\t\t\tmaterial.addEventListener( 'dispose', onMaterialDispose );\r\n\r\n\t\t} else if ( program.code !== code ) {\r\n\r\n\t\t\t// changed glsl or parameters\r\n\t\t\treleaseMaterialProgramReference( material );\r\n\r\n\t\t} else if ( parameters.shaderID !== undefined ) {\r\n\r\n\t\t\t// same glsl and uniform list\r\n\t\t\treturn;\r\n\r\n\t\t} else {\r\n\r\n\t\t\t// only rebuild uniform list\r\n\t\t\tprogramChange = false;\r\n\r\n\t\t}\r\n\r\n\t\tif ( programChange ) {\r\n\r\n\t\t\tif ( parameters.shaderID ) {\r\n\r\n\t\t\t\tvar shader = THREE.ShaderLib[ parameters.shaderID ];\r\n\r\n\t\t\t\tmaterialProperties.__webglShader = {\r\n\t\t\t\t\tname: material.type,\r\n\t\t\t\t\tuniforms: THREE.UniformsUtils.clone( shader.uniforms ),\r\n\t\t\t\t\tvertexShader: shader.vertexShader,\r\n\t\t\t\t\tfragmentShader: shader.fragmentShader\r\n\t\t\t\t};\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tmaterialProperties.__webglShader = {\r\n\t\t\t\t\tname: material.type,\r\n\t\t\t\t\tuniforms: material.uniforms,\r\n\t\t\t\t\tvertexShader: material.vertexShader,\r\n\t\t\t\t\tfragmentShader: material.fragmentShader\r\n\t\t\t\t};\r\n\r\n\t\t\t}\r\n\r\n\t\t\tmaterial.__webglShader = materialProperties.__webglShader;\r\n\r\n\t\t\tprogram = programCache.acquireProgram( material, parameters, code );\r\n\r\n\t\t\tmaterialProperties.program = program;\r\n\t\t\tmaterial.program = program;\r\n\r\n\t\t}\r\n\r\n\t\tvar attributes = program.getAttributes();\r\n\r\n\t\tif ( material.morphTargets ) {\r\n\r\n\t\t\tmaterial.numSupportedMorphTargets = 0;\r\n\r\n\t\t\tfor ( var i = 0; i < _this.maxMorphTargets; i ++ ) {\r\n\r\n\t\t\t\tif ( attributes[ 'morphTarget' + i ] >= 0 ) {\r\n\r\n\t\t\t\t\tmaterial.numSupportedMorphTargets ++;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tif ( material.morphNormals ) {\r\n\r\n\t\t\tmaterial.numSupportedMorphNormals = 0;\r\n\r\n\t\t\tfor ( var i = 0; i < _this.maxMorphNormals; i ++ ) {\r\n\r\n\t\t\t\tif ( attributes[ 'morphNormal' + i ] >= 0 ) {\r\n\r\n\t\t\t\t\tmaterial.numSupportedMorphNormals ++;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tvar uniforms = materialProperties.__webglShader.uniforms;\r\n\r\n\t\tif ( ! ( material instanceof THREE.ShaderMaterial ) &&\r\n\t\t\t\t! ( material instanceof THREE.RawShaderMaterial ) ||\r\n\t\t\t\tmaterial.clipping === true ) {\r\n\r\n\t\t\tmaterialProperties.numClippingPlanes = _numClippingPlanes;\r\n\t\t\tuniforms.clippingPlanes = _clippingPlanesUniform;\r\n\r\n\t\t}\r\n\r\n\t\tif ( material instanceof THREE.MeshPhongMaterial ||\r\n\t\t\t\tmaterial instanceof THREE.MeshLambertMaterial ||\r\n\t\t\t\tmaterial instanceof THREE.MeshStandardMaterial ||\r\n\t\t\t\tmaterial.lights ) {\r\n\r\n\t\t\t// store the light setup it was created for\r\n\r\n\t\t\tmaterialProperties.lightsHash = _lights.hash;\r\n\r\n\t\t\t// wire up the material to this renderer's lighting state\r\n\r\n\t\t\tuniforms.ambientLightColor.value = _lights.ambient;\r\n\t\t\tuniforms.directionalLights.value = _lights.directional;\r\n\t\t\tuniforms.spotLights.value = _lights.spot;\r\n\t\t\tuniforms.pointLights.value = _lights.point;\r\n\t\t\tuniforms.hemisphereLights.value = _lights.hemi;\r\n\r\n\t\t\tuniforms.directionalShadowMap.value = _lights.directionalShadowMap;\r\n\t\t\tuniforms.directionalShadowMatrix.value = _lights.directionalShadowMatrix;\r\n\t\t\tuniforms.spotShadowMap.value = _lights.spotShadowMap;\r\n\t\t\tuniforms.spotShadowMatrix.value = _lights.spotShadowMatrix;\r\n\t\t\tuniforms.pointShadowMap.value = _lights.pointShadowMap;\r\n\t\t\tuniforms.pointShadowMatrix.value = _lights.pointShadowMatrix;\r\n\r\n\t\t}\r\n\r\n\t\tvar progUniforms = materialProperties.program.getUniforms(),\r\n\t\t\tuniformsList =\r\n\t\t\t\t\tTHREE.WebGLUniforms.seqWithValue( progUniforms.seq, uniforms );\r\n\r\n\t\tmaterialProperties.uniformsList = uniformsList;\r\n\t\tmaterialProperties.dynamicUniforms =\r\n\t\t\t\tTHREE.WebGLUniforms.splitDynamic( uniformsList, uniforms );\r\n\r\n\t}\r\n\r\n\tfunction setMaterial( material ) {\r\n\r\n\t\tsetMaterialFaces( material );\r\n\r\n\t\tif ( material.transparent === true ) {\r\n\r\n\t\t\tstate.setBlending( material.blending, material.blendEquation, material.blendSrc, material.blendDst, material.blendEquationAlpha, material.blendSrcAlpha, material.blendDstAlpha, material.premultipliedAlpha );\r\n\r\n\t\t} else {\r\n\r\n\t\t\tstate.setBlending( THREE.NoBlending );\r\n\r\n\t\t}\r\n\r\n\t\tstate.setDepthFunc( material.depthFunc );\r\n\t\tstate.setDepthTest( material.depthTest );\r\n\t\tstate.setDepthWrite( material.depthWrite );\r\n\t\tstate.setColorWrite( material.colorWrite );\r\n\t\tstate.setPolygonOffset( material.polygonOffset, material.polygonOffsetFactor, material.polygonOffsetUnits );\r\n\r\n\t}\r\n\r\n\tfunction setMaterialFaces( material ) {\r\n\r\n\t\tmaterial.side !== THREE.DoubleSide ? state.enable( _gl.CULL_FACE ) : state.disable( _gl.CULL_FACE );\r\n\t\tstate.setFlipSided( material.side === THREE.BackSide );\r\n\r\n\t}\r\n\r\n\tfunction setProgram( camera, fog, material, object ) {\r\n\r\n\t\t_usedTextureUnits = 0;\r\n\r\n\t\tvar materialProperties = properties.get( material );\r\n\r\n\t\tif ( _clippingEnabled ) {\r\n\r\n\t\t\tif ( _localClippingEnabled || camera !== _currentCamera ) {\r\n\r\n\t\t\t\tvar useCache =\r\n\t\t\t\t\t\tcamera === _currentCamera &&\r\n\t\t\t\t\t\tmaterial.id === _currentMaterialId;\r\n\r\n\t\t\t\t// we might want to call this function with some ClippingGroup\r\n\t\t\t\t// object instead of the material, once it becomes feasible\r\n\t\t\t\t// (#8465, #8379)\r\n\t\t\t\tsetClippingState(\r\n\t\t\t\t\t\tmaterial.clippingPlanes, material.clipShadows,\r\n\t\t\t\t\t\tcamera, materialProperties, useCache );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( materialProperties.numClippingPlanes !== undefined &&\r\n\t\t\t\tmaterialProperties.numClippingPlanes !== _numClippingPlanes ) {\r\n\r\n\t\t\t\tmaterial.needsUpdate = true;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tif ( materialProperties.program === undefined ) {\r\n\r\n\t\t\tmaterial.needsUpdate = true;\r\n\r\n\t\t}\r\n\r\n\t\tif ( materialProperties.lightsHash !== undefined &&\r\n\t\t\tmaterialProperties.lightsHash !== _lights.hash ) {\r\n\r\n\t\t\tmaterial.needsUpdate = true;\r\n\r\n\t\t}\r\n\r\n\t\tif ( material.needsUpdate ) {\r\n\r\n\t\t\tinitMaterial( material, fog, object );\r\n\t\t\tmaterial.needsUpdate = false;\r\n\r\n\t\t}\r\n\r\n\t\tvar refreshProgram = false;\r\n\t\tvar refreshMaterial = false;\r\n\t\tvar refreshLights = false;\r\n\r\n\t\tvar program = materialProperties.program,\r\n\t\t\tp_uniforms = program.getUniforms(),\r\n\t\t\tm_uniforms = materialProperties.__webglShader.uniforms;\r\n\r\n\t\tif ( program.id !== _currentProgram ) {\r\n\r\n\t\t\t_gl.useProgram( program.program );\r\n\t\t\t_currentProgram = program.id;\r\n\r\n\t\t\trefreshProgram = true;\r\n\t\t\trefreshMaterial = true;\r\n\t\t\trefreshLights = true;\r\n\r\n\t\t}\r\n\r\n\t\tif ( material.id !== _currentMaterialId ) {\r\n\r\n\t\t\t_currentMaterialId = material.id;\r\n\r\n\t\t\trefreshMaterial = true;\r\n\r\n\t\t}\r\n\r\n\t\tif ( refreshProgram || camera !== _currentCamera ) {\r\n\r\n\t\t\tp_uniforms.set( _gl, camera, 'projectionMatrix' );\r\n\r\n\t\t\tif ( capabilities.logarithmicDepthBuffer ) {\r\n\r\n\t\t\t\tp_uniforms.setValue( _gl, 'logDepthBufFC',\r\n\t\t\t\t\t\t2.0 / ( Math.log( camera.far + 1.0 ) / Math.LN2 ) );\r\n\r\n\t\t\t}\r\n\r\n\r\n\t\t\tif ( camera !== _currentCamera ) {\r\n\r\n\t\t\t\t_currentCamera = camera;\r\n\r\n\t\t\t\t// lighting uniforms depend on the camera so enforce an update\r\n\t\t\t\t// now, in case this material supports lights - or later, when\r\n\t\t\t\t// the next material that does gets activated:\r\n\r\n\t\t\t\trefreshMaterial = true;\t\t// set to true on material change\r\n\t\t\t\trefreshLights = true;\t\t// remains set until update done\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// load material specific uniforms\r\n\t\t\t// (shader material also gets them for the sake of genericity)\r\n\r\n\t\t\tif ( material instanceof THREE.ShaderMaterial ||\r\n\t\t\t\t material instanceof THREE.MeshPhongMaterial ||\r\n\t\t\t\t material instanceof THREE.MeshStandardMaterial ||\r\n\t\t\t\t material.envMap ) {\r\n\r\n\t\t\t\tvar uCamPos = p_uniforms.map.cameraPosition;\r\n\r\n\t\t\t\tif ( uCamPos !== undefined ) {\r\n\r\n\t\t\t\t\tuCamPos.setValue( _gl,\r\n\t\t\t\t\t\t\t_vector3.setFromMatrixPosition( camera.matrixWorld ) );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( material instanceof THREE.MeshPhongMaterial ||\r\n\t\t\t\t material instanceof THREE.MeshLambertMaterial ||\r\n\t\t\t\t material instanceof THREE.MeshBasicMaterial ||\r\n\t\t\t\t material instanceof THREE.MeshStandardMaterial ||\r\n\t\t\t\t material instanceof THREE.ShaderMaterial ||\r\n\t\t\t\t material.skinning ) {\r\n\r\n\t\t\t\tp_uniforms.setValue( _gl, 'viewMatrix', camera.matrixWorldInverse );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tp_uniforms.set( _gl, _this, 'toneMappingExposure' );\r\n\t\t\tp_uniforms.set( _gl, _this, 'toneMappingWhitePoint' );\r\n\r\n\t\t}\r\n\r\n\t\t// skinning uniforms must be set even if material didn't change\r\n\t\t// auto-setting of texture unit for bone texture must go before other textures\r\n\t\t// not sure why, but otherwise weird things happen\r\n\r\n\t\tif ( material.skinning ) {\r\n\r\n\t\t\tp_uniforms.setOptional( _gl, object, 'bindMatrix' );\r\n\t\t\tp_uniforms.setOptional( _gl, object, 'bindMatrixInverse' );\r\n\r\n\t\t\tvar skeleton = object.skeleton;\r\n\r\n\t\t\tif ( skeleton ) {\r\n\r\n\t\t\t\tif ( capabilities.floatVertexTextures && skeleton.useVertexTexture ) {\r\n\r\n\t\t\t\t\tp_uniforms.set( _gl, skeleton, 'boneTexture' );\r\n\t\t\t\t\tp_uniforms.set( _gl, skeleton, 'boneTextureWidth' );\r\n\t\t\t\t\tp_uniforms.set( _gl, skeleton, 'boneTextureHeight' );\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tp_uniforms.setOptional( _gl, skeleton, 'boneMatrices' );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tif ( refreshMaterial ) {\r\n\r\n\t\t\tif ( material instanceof THREE.MeshPhongMaterial ||\r\n\t\t\t\t material instanceof THREE.MeshLambertMaterial ||\r\n\t\t\t\t material instanceof THREE.MeshStandardMaterial ||\r\n\t\t\t\t material.lights ) {\r\n\r\n\t\t\t\t// the current material requires lighting info\r\n\r\n\t\t\t\t// note: all lighting uniforms are always set correctly\r\n\t\t\t\t// they simply reference the renderer's state for their\r\n\t\t\t\t// values\r\n\t\t\t\t//\r\n\t\t\t\t// use the current material's .needsUpdate flags to set\r\n\t\t\t\t// the GL state when required\r\n\r\n\t\t\t\tmarkUniformsLightsNeedsUpdate( m_uniforms, refreshLights );\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// refresh uniforms common to several materials\r\n\r\n\t\t\tif ( fog && material.fog ) {\r\n\r\n\t\t\t\trefreshUniformsFog( m_uniforms, fog );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( material instanceof THREE.MeshBasicMaterial ||\r\n\t\t\t\t material instanceof THREE.MeshLambertMaterial ||\r\n\t\t\t\t material instanceof THREE.MeshPhongMaterial ||\r\n\t\t\t\t material instanceof THREE.MeshStandardMaterial ||\r\n\t\t\t\t material instanceof THREE.MeshDepthMaterial ) {\r\n\r\n\t\t\t\trefreshUniformsCommon( m_uniforms, material );\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// refresh single material specific uniforms\r\n\r\n\t\t\tif ( material instanceof THREE.LineBasicMaterial ) {\r\n\r\n\t\t\t\trefreshUniformsLine( m_uniforms, material );\r\n\r\n\t\t\t} else if ( material instanceof THREE.LineDashedMaterial ) {\r\n\r\n\t\t\t\trefreshUniformsLine( m_uniforms, material );\r\n\t\t\t\trefreshUniformsDash( m_uniforms, material );\r\n\r\n\t\t\t} else if ( material instanceof THREE.PointsMaterial ) {\r\n\r\n\t\t\t\trefreshUniformsPoints( m_uniforms, material );\r\n\r\n\t\t\t} else if ( material instanceof THREE.MeshLambertMaterial ) {\r\n\r\n\t\t\t\trefreshUniformsLambert( m_uniforms, material );\r\n\r\n\t\t\t} else if ( material instanceof THREE.MeshPhongMaterial ) {\r\n\r\n\t\t\t\trefreshUniformsPhong( m_uniforms, material );\r\n\r\n\t\t\t} else if ( material instanceof THREE.MeshPhysicalMaterial ) {\r\n\r\n\t\t\t\trefreshUniformsPhysical( m_uniforms, material );\r\n\r\n\t\t\t} else if ( material instanceof THREE.MeshStandardMaterial ) {\r\n\r\n\t\t\t\trefreshUniformsStandard( m_uniforms, material );\r\n\r\n\t\t\t} else if ( material instanceof THREE.MeshDepthMaterial ) {\r\n\r\n\t\t\t\tif ( material.displacementMap ) {\r\n\r\n\t\t\t\t\tm_uniforms.displacementMap.value = material.displacementMap;\r\n\t\t\t\t\tm_uniforms.displacementScale.value = material.displacementScale;\r\n\t\t\t\t\tm_uniforms.displacementBias.value = material.displacementBias;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t} else if ( material instanceof THREE.MeshNormalMaterial ) {\r\n\r\n\t\t\t\tm_uniforms.opacity.value = material.opacity;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tTHREE.WebGLUniforms.upload(\r\n\t\t\t\t\t_gl, materialProperties.uniformsList, m_uniforms, _this );\r\n\r\n\t\t}\r\n\r\n\r\n\t\t// common matrices\r\n\r\n\t\tp_uniforms.set( _gl, object, 'modelViewMatrix' );\r\n\t\tp_uniforms.set( _gl, object, 'normalMatrix' );\r\n\t\tp_uniforms.setValue( _gl, 'modelMatrix', object.matrixWorld );\r\n\r\n\r\n\t\t// dynamic uniforms\r\n\r\n\t\tvar dynUniforms = materialProperties.dynamicUniforms;\r\n\r\n\t\tif ( dynUniforms !== null ) {\r\n\r\n\t\t\tTHREE.WebGLUniforms.evalDynamic(\r\n\t\t\t\t\tdynUniforms, m_uniforms, object, camera );\r\n\r\n\t\t\tTHREE.WebGLUniforms.upload( _gl, dynUniforms, m_uniforms, _this );\r\n\r\n\t\t}\r\n\r\n\t\treturn program;\r\n\r\n\t}\r\n\r\n\t// Uniforms (refresh uniforms objects)\r\n\r\n\tfunction refreshUniformsCommon ( uniforms, material ) {\r\n\r\n\t\tuniforms.opacity.value = material.opacity;\r\n\r\n\t\tuniforms.diffuse.value = material.color;\r\n\r\n\t\tif ( material.emissive ) {\r\n\r\n\t\t\tuniforms.emissive.value.copy( material.emissive ).multiplyScalar( material.emissiveIntensity );\r\n\r\n\t\t}\r\n\r\n\t\tuniforms.map.value = material.map;\r\n\t\tuniforms.specularMap.value = material.specularMap;\r\n\t\tuniforms.alphaMap.value = material.alphaMap;\r\n\r\n\t\tif ( material.aoMap ) {\r\n\r\n\t\t\tuniforms.aoMap.value = material.aoMap;\r\n\t\t\tuniforms.aoMapIntensity.value = material.aoMapIntensity;\r\n\r\n\t\t}\r\n\r\n\t\t// uv repeat and offset setting priorities\r\n\t\t// 1. color map\r\n\t\t// 2. specular map\r\n\t\t// 3. normal map\r\n\t\t// 4. bump map\r\n\t\t// 5. alpha map\r\n\t\t// 6. emissive map\r\n\r\n\t\tvar uvScaleMap;\r\n\r\n\t\tif ( material.map ) {\r\n\r\n\t\t\tuvScaleMap = material.map;\r\n\r\n\t\t} else if ( material.specularMap ) {\r\n\r\n\t\t\tuvScaleMap = material.specularMap;\r\n\r\n\t\t} else if ( material.displacementMap ) {\r\n\r\n\t\t\tuvScaleMap = material.displacementMap;\r\n\r\n\t\t} else if ( material.normalMap ) {\r\n\r\n\t\t\tuvScaleMap = material.normalMap;\r\n\r\n\t\t} else if ( material.bumpMap ) {\r\n\r\n\t\t\tuvScaleMap = material.bumpMap;\r\n\r\n\t\t} else if ( material.roughnessMap ) {\r\n\r\n\t\t\tuvScaleMap = material.roughnessMap;\r\n\r\n\t\t} else if ( material.metalnessMap ) {\r\n\r\n\t\t\tuvScaleMap = material.metalnessMap;\r\n\r\n\t\t} else if ( material.alphaMap ) {\r\n\r\n\t\t\tuvScaleMap = material.alphaMap;\r\n\r\n\t\t} else if ( material.emissiveMap ) {\r\n\r\n\t\t\tuvScaleMap = material.emissiveMap;\r\n\r\n\t\t}\r\n\r\n\t\tif ( uvScaleMap !== undefined ) {\r\n\r\n\t\t\tif ( uvScaleMap instanceof THREE.WebGLRenderTarget ) {\r\n\r\n\t\t\t\tuvScaleMap = uvScaleMap.texture;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar offset = uvScaleMap.offset;\r\n\t\t\tvar repeat = uvScaleMap.repeat;\r\n\r\n\t\t\tuniforms.offsetRepeat.value.set( offset.x, offset.y, repeat.x, repeat.y );\r\n\r\n\t\t}\r\n\r\n\t\tuniforms.envMap.value = material.envMap;\r\n\t\tuniforms.flipEnvMap.value = ( material.envMap instanceof THREE.WebGLRenderTargetCube ) ? 1 : - 1;\r\n\r\n\t\tuniforms.reflectivity.value = material.reflectivity;\r\n\t\tuniforms.refractionRatio.value = material.refractionRatio;\r\n\r\n\t}\r\n\r\n\tfunction refreshUniformsLine ( uniforms, material ) {\r\n\r\n\t\tuniforms.diffuse.value = material.color;\r\n\t\tuniforms.opacity.value = material.opacity;\r\n\r\n\t}\r\n\r\n\tfunction refreshUniformsDash ( uniforms, material ) {\r\n\r\n\t\tuniforms.dashSize.value = material.dashSize;\r\n\t\tuniforms.totalSize.value = material.dashSize + material.gapSize;\r\n\t\tuniforms.scale.value = material.scale;\r\n\r\n\t}\r\n\r\n\tfunction refreshUniformsPoints ( uniforms, material ) {\r\n\r\n\t\tuniforms.diffuse.value = material.color;\r\n\t\tuniforms.opacity.value = material.opacity;\r\n\t\tuniforms.size.value = material.size * _pixelRatio;\r\n\t\tuniforms.scale.value = _canvas.clientHeight * 0.5;\r\n\r\n\t\tuniforms.map.value = material.map;\r\n\r\n\t\tif ( material.map !== null ) {\r\n\r\n\t\t\tvar offset = material.map.offset;\r\n\t\t\tvar repeat = material.map.repeat;\r\n\r\n\t\t\tuniforms.offsetRepeat.value.set( offset.x, offset.y, repeat.x, repeat.y );\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tfunction refreshUniformsFog ( uniforms, fog ) {\r\n\r\n\t\tuniforms.fogColor.value = fog.color;\r\n\r\n\t\tif ( fog instanceof THREE.Fog ) {\r\n\r\n\t\t\tuniforms.fogNear.value = fog.near;\r\n\t\t\tuniforms.fogFar.value = fog.far;\r\n\r\n\t\t} else if ( fog instanceof THREE.FogExp2 ) {\r\n\r\n\t\t\tuniforms.fogDensity.value = fog.density;\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tfunction refreshUniformsLambert ( uniforms, material ) {\r\n\r\n\t\tif ( material.lightMap ) {\r\n\r\n\t\t\tuniforms.lightMap.value = material.lightMap;\r\n\t\t\tuniforms.lightMapIntensity.value = material.lightMapIntensity;\r\n\r\n\t\t}\r\n\r\n\t\tif ( material.emissiveMap ) {\r\n\r\n\t\t\tuniforms.emissiveMap.value = material.emissiveMap;\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tfunction refreshUniformsPhong ( uniforms, material ) {\r\n\r\n\t\tuniforms.specular.value = material.specular;\r\n\t\tuniforms.shininess.value = Math.max( material.shininess, 1e-4 ); // to prevent pow( 0.0, 0.0 )\r\n\r\n\t\tif ( material.lightMap ) {\r\n\r\n\t\t\tuniforms.lightMap.value = material.lightMap;\r\n\t\t\tuniforms.lightMapIntensity.value = material.lightMapIntensity;\r\n\r\n\t\t}\r\n\r\n\t\tif ( material.emissiveMap ) {\r\n\r\n\t\t\tuniforms.emissiveMap.value = material.emissiveMap;\r\n\r\n\t\t}\r\n\r\n\t\tif ( material.bumpMap ) {\r\n\r\n\t\t\tuniforms.bumpMap.value = material.bumpMap;\r\n\t\t\tuniforms.bumpScale.value = material.bumpScale;\r\n\r\n\t\t}\r\n\r\n\t\tif ( material.normalMap ) {\r\n\r\n\t\t\tuniforms.normalMap.value = material.normalMap;\r\n\t\t\tuniforms.normalScale.value.copy( material.normalScale );\r\n\r\n\t\t}\r\n\r\n\t\tif ( material.displacementMap ) {\r\n\r\n\t\t\tuniforms.displacementMap.value = material.displacementMap;\r\n\t\t\tuniforms.displacementScale.value = material.displacementScale;\r\n\t\t\tuniforms.displacementBias.value = material.displacementBias;\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tfunction refreshUniformsStandard ( uniforms, material ) {\r\n\r\n\t\tuniforms.roughness.value = material.roughness;\r\n\t\tuniforms.metalness.value = material.metalness;\r\n\r\n\t\tif ( material.roughnessMap ) {\r\n\r\n\t\t\tuniforms.roughnessMap.value = material.roughnessMap;\r\n\r\n\t\t}\r\n\r\n\t\tif ( material.metalnessMap ) {\r\n\r\n\t\t\tuniforms.metalnessMap.value = material.metalnessMap;\r\n\r\n\t\t}\r\n\r\n\t\tif ( material.lightMap ) {\r\n\r\n\t\t\tuniforms.lightMap.value = material.lightMap;\r\n\t\t\tuniforms.lightMapIntensity.value = material.lightMapIntensity;\r\n\r\n\t\t}\r\n\r\n\t\tif ( material.emissiveMap ) {\r\n\r\n\t\t\tuniforms.emissiveMap.value = material.emissiveMap;\r\n\r\n\t\t}\r\n\r\n\t\tif ( material.bumpMap ) {\r\n\r\n\t\t\tuniforms.bumpMap.value = material.bumpMap;\r\n\t\t\tuniforms.bumpScale.value = material.bumpScale;\r\n\r\n\t\t}\r\n\r\n\t\tif ( material.normalMap ) {\r\n\r\n\t\t\tuniforms.normalMap.value = material.normalMap;\r\n\t\t\tuniforms.normalScale.value.copy( material.normalScale );\r\n\r\n\t\t}\r\n\r\n\t\tif ( material.displacementMap ) {\r\n\r\n\t\t\tuniforms.displacementMap.value = material.displacementMap;\r\n\t\t\tuniforms.displacementScale.value = material.displacementScale;\r\n\t\t\tuniforms.displacementBias.value = material.displacementBias;\r\n\r\n\t\t}\r\n\r\n\t\tif ( material.envMap ) {\r\n\r\n\t\t\t//uniforms.envMap.value = material.envMap; // part of uniforms common\r\n\t\t\tuniforms.envMapIntensity.value = material.envMapIntensity;\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tfunction refreshUniformsPhysical ( uniforms, material ) {\r\n\r\n\t\trefreshUniformsStandard( uniforms, material );\r\n\r\n\t}\r\n\r\n\t// If uniforms are marked as clean, they don't need to be loaded to the GPU.\r\n\r\n\tfunction markUniformsLightsNeedsUpdate ( uniforms, value ) {\r\n\r\n\t\tuniforms.ambientLightColor.needsUpdate = value;\r\n\r\n\t\tuniforms.directionalLights.needsUpdate = value;\r\n\t\tuniforms.pointLights.needsUpdate = value;\r\n\t\tuniforms.spotLights.needsUpdate = value;\r\n\t\tuniforms.hemisphereLights.needsUpdate = value;\r\n\r\n\t}\r\n\r\n\t// Lighting\r\n\r\n\tfunction setupShadows ( lights ) {\r\n\r\n\t\tvar lightShadowsLength = 0;\r\n\r\n\t\tfor ( var i = 0, l = lights.length; i < l; i ++ ) {\r\n\r\n\t\t\tvar light = lights[ i ];\r\n\r\n\t\t\tif ( light.castShadow ) {\r\n\r\n\t\t\t\t_lights.shadows[ lightShadowsLength ++ ] = light;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\t_lights.shadows.length = lightShadowsLength;\r\n\r\n\t}\r\n\r\n\tfunction setupLights ( lights, camera ) {\r\n\r\n\t\tvar l, ll, light,\r\n\t\tr = 0, g = 0, b = 0,\r\n\t\tcolor,\r\n\t\tintensity,\r\n\t\tdistance,\r\n\r\n\t\tviewMatrix = camera.matrixWorldInverse,\r\n\r\n\t\tdirectionalLength = 0,\r\n\t\tpointLength = 0,\r\n\t\tspotLength = 0,\r\n\t\themiLength = 0;\r\n\r\n\t\tfor ( l = 0, ll = lights.length; l < ll; l ++ ) {\r\n\r\n\t\t\tlight = lights[ l ];\r\n\r\n\t\t\tcolor = light.color;\r\n\t\t\tintensity = light.intensity;\r\n\t\t\tdistance = light.distance;\r\n\r\n\t\t\tif ( light instanceof THREE.AmbientLight ) {\r\n\r\n\t\t\t\tr += color.r * intensity;\r\n\t\t\t\tg += color.g * intensity;\r\n\t\t\t\tb += color.b * intensity;\r\n\r\n\t\t\t} else if ( light instanceof THREE.DirectionalLight ) {\r\n\r\n\t\t\t\tvar uniforms = lightCache.get( light );\r\n\r\n\t\t\t\tuniforms.color.copy( light.color ).multiplyScalar( light.intensity );\r\n\t\t\t\tuniforms.direction.setFromMatrixPosition( light.matrixWorld );\r\n\t\t\t\t_vector3.setFromMatrixPosition( light.target.matrixWorld );\r\n\t\t\t\tuniforms.direction.sub( _vector3 );\r\n\t\t\t\tuniforms.direction.transformDirection( viewMatrix );\r\n\r\n\t\t\t\tuniforms.shadow = light.castShadow;\r\n\r\n\t\t\t\tif ( light.castShadow ) {\r\n\r\n\t\t\t\t\tuniforms.shadowBias = light.shadow.bias;\r\n\t\t\t\t\tuniforms.shadowRadius = light.shadow.radius;\r\n\t\t\t\t\tuniforms.shadowMapSize = light.shadow.mapSize;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\t_lights.directionalShadowMap[ directionalLength ] = light.shadow.map;\r\n\t\t\t\t_lights.directionalShadowMatrix[ directionalLength ] = light.shadow.matrix;\r\n\t\t\t\t_lights.directional[ directionalLength ++ ] = uniforms;\r\n\r\n\t\t\t} else if ( light instanceof THREE.SpotLight ) {\r\n\r\n\t\t\t\tvar uniforms = lightCache.get( light );\r\n\r\n\t\t\t\tuniforms.position.setFromMatrixPosition( light.matrixWorld );\r\n\t\t\t\tuniforms.position.applyMatrix4( viewMatrix );\r\n\r\n\t\t\t\tuniforms.color.copy( color ).multiplyScalar( intensity );\r\n\t\t\t\tuniforms.distance = distance;\r\n\r\n\t\t\t\tuniforms.direction.setFromMatrixPosition( light.matrixWorld );\r\n\t\t\t\t_vector3.setFromMatrixPosition( light.target.matrixWorld );\r\n\t\t\t\tuniforms.direction.sub( _vector3 );\r\n\t\t\t\tuniforms.direction.transformDirection( viewMatrix );\r\n\r\n\t\t\t\tuniforms.coneCos = Math.cos( light.angle );\r\n\t\t\t\tuniforms.penumbraCos = Math.cos( light.angle * ( 1 - light.penumbra ) );\r\n\t\t\t\tuniforms.decay = ( light.distance === 0 ) ? 0.0 : light.decay;\r\n\r\n\t\t\t\tuniforms.shadow = light.castShadow;\r\n\r\n\t\t\t\tif ( light.castShadow ) {\r\n\r\n\t\t\t\t\tuniforms.shadowBias = light.shadow.bias;\r\n\t\t\t\t\tuniforms.shadowRadius = light.shadow.radius;\r\n\t\t\t\t\tuniforms.shadowMapSize = light.shadow.mapSize;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\t_lights.spotShadowMap[ spotLength ] = light.shadow.map;\r\n\t\t\t\t_lights.spotShadowMatrix[ spotLength ] = light.shadow.matrix;\r\n\t\t\t\t_lights.spot[ spotLength ++ ] = uniforms;\r\n\r\n\t\t\t} else if ( light instanceof THREE.PointLight ) {\r\n\r\n\t\t\t\tvar uniforms = lightCache.get( light );\r\n\r\n\t\t\t\tuniforms.position.setFromMatrixPosition( light.matrixWorld );\r\n\t\t\t\tuniforms.position.applyMatrix4( viewMatrix );\r\n\r\n\t\t\t\tuniforms.color.copy( light.color ).multiplyScalar( light.intensity );\r\n\t\t\t\tuniforms.distance = light.distance;\r\n\t\t\t\tuniforms.decay = ( light.distance === 0 ) ? 0.0 : light.decay;\r\n\r\n\t\t\t\tuniforms.shadow = light.castShadow;\r\n\r\n\t\t\t\tif ( light.castShadow ) {\r\n\r\n\t\t\t\t\tuniforms.shadowBias = light.shadow.bias;\r\n\t\t\t\t\tuniforms.shadowRadius = light.shadow.radius;\r\n\t\t\t\t\tuniforms.shadowMapSize = light.shadow.mapSize;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\t_lights.pointShadowMap[ pointLength ] = light.shadow.map;\r\n\r\n\t\t\t\tif ( _lights.pointShadowMatrix[ pointLength ] === undefined ) {\r\n\r\n\t\t\t\t\t_lights.pointShadowMatrix[ pointLength ] = new THREE.Matrix4();\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// for point lights we set the shadow matrix to be a translation-only matrix\r\n\t\t\t\t// equal to inverse of the light's position\r\n\t\t\t\t_vector3.setFromMatrixPosition( light.matrixWorld ).negate();\r\n\t\t\t\t_lights.pointShadowMatrix[ pointLength ].identity().setPosition( _vector3 );\r\n\r\n\t\t\t\t_lights.point[ pointLength ++ ] = uniforms;\r\n\r\n\t\t\t} else if ( light instanceof THREE.HemisphereLight ) {\r\n\r\n\t\t\t\tvar uniforms = lightCache.get( light );\r\n\r\n\t\t\t\tuniforms.direction.setFromMatrixPosition( light.matrixWorld );\r\n\t\t\t\tuniforms.direction.transformDirection( viewMatrix );\r\n\t\t\t\tuniforms.direction.normalize();\r\n\r\n\t\t\t\tuniforms.skyColor.copy( light.color ).multiplyScalar( intensity );\r\n\t\t\t\tuniforms.groundColor.copy( light.groundColor ).multiplyScalar( intensity );\r\n\r\n\t\t\t\t_lights.hemi[ hemiLength ++ ] = uniforms;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\t_lights.ambient[ 0 ] = r;\r\n\t\t_lights.ambient[ 1 ] = g;\r\n\t\t_lights.ambient[ 2 ] = b;\r\n\r\n\t\t_lights.directional.length = directionalLength;\r\n\t\t_lights.spot.length = spotLength;\r\n\t\t_lights.point.length = pointLength;\r\n\t\t_lights.hemi.length = hemiLength;\r\n\r\n\t\t_lights.hash = directionalLength + ',' + pointLength + ',' + spotLength + ',' + hemiLength + ',' + _lights.shadows.length;\r\n\r\n\t}\r\n\r\n\t// Clipping\r\n\r\n\tfunction setupGlobalClippingPlanes( planes, camera ) {\r\n\r\n\t\t_clippingEnabled =\r\n\t\t\t\t_this.clippingPlanes.length !== 0 ||\r\n\t\t\t\t_this.localClippingEnabled ||\r\n\t\t\t\t// enable state of previous frame - the clipping code has to\r\n\t\t\t\t// run another frame in order to reset the state:\r\n\t\t\t\t_numGlobalClippingPlanes !== 0 ||\r\n\t\t\t\t_localClippingEnabled;\r\n\r\n\t\t_localClippingEnabled = _this.localClippingEnabled;\r\n\r\n\t\t_globalClippingState = setupClippingPlanes( planes, camera, 0 );\r\n\t\t_numGlobalClippingPlanes = planes !== null ? planes.length : 0;\r\n\r\n\t}\r\n\r\n\tfunction setupClippingPlanes( planes, camera, dstOffset, skipTransform ) {\r\n\r\n\t\tvar nPlanes = planes !== null ? planes.length : 0,\r\n\t\t\tdstArray = null;\r\n\r\n\t\tif ( nPlanes !== 0 ) {\r\n\r\n\t\t\tdstArray = _clippingPlanesUniform.value;\r\n\r\n\t\t\tif ( skipTransform !== true || dstArray === null ) {\r\n\r\n\t\t\t\tvar flatSize = dstOffset + nPlanes * 4,\r\n\t\t\t\t\tviewMatrix = camera.matrixWorldInverse,\r\n\t\t\t\t\tviewNormalMatrix = _matrix3.getNormalMatrix( viewMatrix );\r\n\r\n\t\t\t\tif ( dstArray === null || dstArray.length < flatSize ) {\r\n\r\n\t\t\t\t\tdstArray = new Float32Array( flatSize );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tfor ( var i = 0, i4 = dstOffset; i !== nPlanes; ++ i, i4 += 4 ) {\r\n\r\n\t\t\t\t\tvar plane = _plane.copy( planes[ i ] ).\r\n\t\t\t\t\t\t\tapplyMatrix4( viewMatrix, viewNormalMatrix );\r\n\r\n\t\t\t\t\tplane.normal.toArray( dstArray, i4 );\r\n\t\t\t\t\tdstArray[ i4 + 3 ] = plane.constant;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\t_clippingPlanesUniform.value = dstArray;\r\n\t\t\t_clippingPlanesUniform.needsUpdate = true;\r\n\r\n\t\t}\r\n\r\n\t\t_numClippingPlanes = nPlanes;\r\n\t\treturn dstArray;\r\n\r\n\t}\r\n\r\n\tfunction resetGlobalClippingState() {\r\n\r\n\t\tif ( _clippingPlanesUniform.value !== _globalClippingState ) {\r\n\r\n\t\t\t_clippingPlanesUniform.value = _globalClippingState;\r\n\t\t\t_clippingPlanesUniform.needsUpdate = _numGlobalClippingPlanes > 0;\r\n\r\n\t\t}\r\n\r\n\t\t_numClippingPlanes = _numGlobalClippingPlanes;\r\n\r\n\t}\r\n\r\n\tfunction setClippingState( planes, clipShadows, camera, cache, fromCache ) {\r\n\r\n\t\tif ( ! _localClippingEnabled ||\r\n\t\t\t\tplanes === null || planes.length === 0 ||\r\n\t\t\t\t_clipRenderingShadows && ! clipShadows ) {\r\n\t\t\t// there's no local clipping\r\n\r\n\t\t\tif ( _clipRenderingShadows ) {\r\n\t\t\t\t// there's no global clipping\r\n\r\n\t\t\t\tsetupClippingPlanes( null );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tresetGlobalClippingState();\r\n\t\t\t}\r\n\r\n\t\t} else {\r\n\r\n\t\t\tvar nGlobal = _clipRenderingShadows ? 0 : _numGlobalClippingPlanes,\r\n\t\t\t\tlGlobal = nGlobal * 4,\r\n\r\n\t\t\t\tdstArray = cache.clippingState || null;\r\n\r\n\t\t\t_clippingPlanesUniform.value = dstArray; // ensure unique state\r\n\r\n\t\t\tdstArray = setupClippingPlanes(\r\n\t\t\t\t\tplanes, camera, lGlobal, fromCache );\r\n\r\n\t\t\tfor ( var i = 0; i !== lGlobal; ++ i ) {\r\n\r\n\t\t\t\tdstArray[ i ] = _globalClippingState[ i ];\r\n\r\n\t\t\t}\r\n\r\n\t\t\tcache.clippingState = dstArray;\r\n\t\t\t_numClippingPlanes += nGlobal;\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\r\n\t// GL state setting\r\n\r\n\tthis.setFaceCulling = function ( cullFace, frontFaceDirection ) {\r\n\r\n\t\tif ( cullFace === THREE.CullFaceNone ) {\r\n\r\n\t\t\tstate.disable( _gl.CULL_FACE );\r\n\r\n\t\t} else {\r\n\r\n\t\t\tif ( frontFaceDirection === THREE.FrontFaceDirectionCW ) {\r\n\r\n\t\t\t\t_gl.frontFace( _gl.CW );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\t_gl.frontFace( _gl.CCW );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( cullFace === THREE.CullFaceBack ) {\r\n\r\n\t\t\t\t_gl.cullFace( _gl.BACK );\r\n\r\n\t\t\t} else if ( cullFace === THREE.CullFaceFront ) {\r\n\r\n\t\t\t\t_gl.cullFace( _gl.FRONT );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\t_gl.cullFace( _gl.FRONT_AND_BACK );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tstate.enable( _gl.CULL_FACE );\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n\t// Textures\r\n\r\n\tfunction allocTextureUnit() {\r\n\r\n\t\tvar textureUnit = _usedTextureUnits;\r\n\r\n\t\tif ( textureUnit >= capabilities.maxTextures ) {\r\n\r\n\t\t\tconsole.warn( 'WebGLRenderer: trying to use ' + textureUnit + ' texture units while this GPU supports only ' + capabilities.maxTextures );\r\n\r\n\t\t}\r\n\r\n\t\t_usedTextureUnits += 1;\r\n\r\n\t\treturn textureUnit;\r\n\r\n\t}\r\n\r\n\tfunction setTextureParameters ( textureType, texture, isPowerOfTwoImage ) {\r\n\r\n\t\tvar extension;\r\n\r\n\t\tif ( isPowerOfTwoImage ) {\r\n\r\n\t\t\t_gl.texParameteri( textureType, _gl.TEXTURE_WRAP_S, paramThreeToGL( texture.wrapS ) );\r\n\t\t\t_gl.texParameteri( textureType, _gl.TEXTURE_WRAP_T, paramThreeToGL( texture.wrapT ) );\r\n\r\n\t\t\t_gl.texParameteri( textureType, _gl.TEXTURE_MAG_FILTER, paramThreeToGL( texture.magFilter ) );\r\n\t\t\t_gl.texParameteri( textureType, _gl.TEXTURE_MIN_FILTER, paramThreeToGL( texture.minFilter ) );\r\n\r\n\t\t} else {\r\n\r\n\t\t\t_gl.texParameteri( textureType, _gl.TEXTURE_WRAP_S, _gl.CLAMP_TO_EDGE );\r\n\t\t\t_gl.texParameteri( textureType, _gl.TEXTURE_WRAP_T, _gl.CLAMP_TO_EDGE );\r\n\r\n\t\t\tif ( texture.wrapS !== THREE.ClampToEdgeWrapping || texture.wrapT !== THREE.ClampToEdgeWrapping ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping.', texture );\r\n\r\n\t\t\t}\r\n\r\n\t\t\t_gl.texParameteri( textureType, _gl.TEXTURE_MAG_FILTER, filterFallback( texture.magFilter ) );\r\n\t\t\t_gl.texParameteri( textureType, _gl.TEXTURE_MIN_FILTER, filterFallback( texture.minFilter ) );\r\n\r\n\t\t\tif ( texture.minFilter !== THREE.NearestFilter && texture.minFilter !== THREE.LinearFilter ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.', texture );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\textension = extensions.get( 'EXT_texture_filter_anisotropic' );\r\n\r\n\t\tif ( extension ) {\r\n\r\n\t\t\tif ( texture.type === THREE.FloatType && extensions.get( 'OES_texture_float_linear' ) === null ) return;\r\n\t\t\tif ( texture.type === THREE.HalfFloatType && extensions.get( 'OES_texture_half_float_linear' ) === null ) return;\r\n\r\n\t\t\tif ( texture.anisotropy > 1 || properties.get( texture ).__currentAnisotropy ) {\r\n\r\n\t\t\t\t_gl.texParameterf( textureType, extension.TEXTURE_MAX_ANISOTROPY_EXT, Math.min( texture.anisotropy, _this.getMaxAnisotropy() ) );\r\n\t\t\t\tproperties.get( texture ).__currentAnisotropy = texture.anisotropy;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tfunction uploadTexture( textureProperties, texture, slot ) {\r\n\r\n\t\tif ( textureProperties.__webglInit === undefined ) {\r\n\r\n\t\t\ttextureProperties.__webglInit = true;\r\n\r\n\t\t\ttexture.addEventListener( 'dispose', onTextureDispose );\r\n\r\n\t\t\ttextureProperties.__webglTexture = _gl.createTexture();\r\n\r\n\t\t\t_infoMemory.textures ++;\r\n\r\n\t\t}\r\n\r\n\t\tstate.activeTexture( _gl.TEXTURE0 + slot );\r\n\t\tstate.bindTexture( _gl.TEXTURE_2D, textureProperties.__webglTexture );\r\n\r\n\t\t_gl.pixelStorei( _gl.UNPACK_FLIP_Y_WEBGL, texture.flipY );\r\n\t\t_gl.pixelStorei( _gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL, texture.premultiplyAlpha );\r\n\t\t_gl.pixelStorei( _gl.UNPACK_ALIGNMENT, texture.unpackAlignment );\r\n\r\n\t\tvar image = clampToMaxSize( texture.image, capabilities.maxTextureSize );\r\n\r\n\t\tif ( textureNeedsPowerOfTwo( texture ) && isPowerOfTwo( image ) === false ) {\r\n\r\n\t\t\timage = makePowerOfTwo( image );\r\n\r\n\t\t}\r\n\r\n\t\tvar isPowerOfTwoImage = isPowerOfTwo( image ),\r\n\t\tglFormat = paramThreeToGL( texture.format ),\r\n\t\tglType = paramThreeToGL( texture.type );\r\n\r\n\t\tsetTextureParameters( _gl.TEXTURE_2D, texture, isPowerOfTwoImage );\r\n\r\n\t\tvar mipmap, mipmaps = texture.mipmaps;\r\n\r\n\t\tif ( texture instanceof THREE.DepthTexture ) {\r\n\r\n\t\t\t// populate depth texture with dummy data\r\n\r\n\t\t\tvar internalFormat = _gl.DEPTH_COMPONENT;\r\n\r\n\t\t\tif ( texture.type === THREE.FloatType ) {\r\n\r\n\t\t\t\tif ( !_isWebGL2 ) throw new Error('Float Depth Texture only supported in WebGL2.0');\r\n\t\t\t\tinternalFormat = _gl.DEPTH_COMPONENT32F;\r\n\r\n\t\t\t} else if ( _isWebGL2 ) {\r\n\r\n\t\t\t\t// WebGL 2.0 requires signed internalformat for glTexImage2D\r\n\t\t\t\tinternalFormat = _gl.DEPTH_COMPONENT16;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tstate.texImage2D( _gl.TEXTURE_2D, 0, internalFormat, image.width, image.height, 0, glFormat, glType, null );\r\n\r\n\t\t} else if ( texture instanceof THREE.DataTexture ) {\r\n\r\n\t\t\t// use manually created mipmaps if available\r\n\t\t\t// if there are no manual mipmaps\r\n\t\t\t// set 0 level mipmap and then use GL to generate other mipmap levels\r\n\r\n\t\t\tif ( mipmaps.length > 0 && isPowerOfTwoImage ) {\r\n\r\n\t\t\t\tfor ( var i = 0, il = mipmaps.length; i < il; i ++ ) {\r\n\r\n\t\t\t\t\tmipmap = mipmaps[ i ];\r\n\t\t\t\t\tstate.texImage2D( _gl.TEXTURE_2D, i, glFormat, mipmap.width, mipmap.height, 0, glFormat, glType, mipmap.data );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\ttexture.generateMipmaps = false;\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tstate.texImage2D( _gl.TEXTURE_2D, 0, glFormat, image.width, image.height, 0, glFormat, glType, image.data );\r\n\r\n\t\t\t}\r\n\r\n\t\t} else if ( texture instanceof THREE.CompressedTexture ) {\r\n\r\n\t\t\tfor ( var i = 0, il = mipmaps.length; i < il; i ++ ) {\r\n\r\n\t\t\t\tmipmap = mipmaps[ i ];\r\n\r\n\t\t\t\tif ( texture.format !== THREE.RGBAFormat && texture.format !== THREE.RGBFormat ) {\r\n\r\n\t\t\t\t\tif ( state.getCompressedTextureFormats().indexOf( glFormat ) > - 1 ) {\r\n\r\n\t\t\t\t\t\tstate.compressedTexImage2D( _gl.TEXTURE_2D, i, glFormat, mipmap.width, mipmap.height, 0, mipmap.data );\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\tconsole.warn( \"THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()\" );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tstate.texImage2D( _gl.TEXTURE_2D, i, glFormat, mipmap.width, mipmap.height, 0, glFormat, glType, mipmap.data );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t} else {\r\n\r\n\t\t\t// regular Texture (image, video, canvas)\r\n\r\n\t\t\t// use manually created mipmaps if available\r\n\t\t\t// if there are no manual mipmaps\r\n\t\t\t// set 0 level mipmap and then use GL to generate other mipmap levels\r\n\r\n\t\t\tif ( mipmaps.length > 0 && isPowerOfTwoImage ) {\r\n\r\n\t\t\t\tfor ( var i = 0, il = mipmaps.length; i < il; i ++ ) {\r\n\r\n\t\t\t\t\tmipmap = mipmaps[ i ];\r\n\t\t\t\t\tstate.texImage2D( _gl.TEXTURE_2D, i, glFormat, glFormat, glType, mipmap );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\ttexture.generateMipmaps = false;\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tstate.texImage2D( _gl.TEXTURE_2D, 0, glFormat, glFormat, glType, image );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tif ( texture.generateMipmaps && isPowerOfTwoImage ) _gl.generateMipmap( _gl.TEXTURE_2D );\r\n\r\n\t\ttextureProperties.__version = texture.version;\r\n\r\n\t\tif ( texture.onUpdate ) texture.onUpdate( texture );\r\n\r\n\t}\r\n\r\n\tfunction setTexture2D( texture, slot ) {\r\n\r\n\t\tif ( texture instanceof THREE.WebGLRenderTarget ) texture = texture.texture;\r\n\r\n\t\tvar textureProperties = properties.get( texture );\r\n\r\n\t\tif ( texture.version > 0 && textureProperties.__version !== texture.version ) {\r\n\r\n\t\t\tvar image = texture.image;\r\n\r\n\t\t\tif ( image === undefined ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.WebGLRenderer: Texture marked for update but image is undefined', texture );\r\n\t\t\t\treturn;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( image.complete === false ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.WebGLRenderer: Texture marked for update but image is incomplete', texture );\r\n\t\t\t\treturn;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tuploadTexture( textureProperties, texture, slot );\r\n\r\n\t\t\treturn;\r\n\r\n\t\t}\r\n\r\n\t\tstate.activeTexture( _gl.TEXTURE0 + slot );\r\n\t\tstate.bindTexture( _gl.TEXTURE_2D, textureProperties.__webglTexture );\r\n\r\n\t}\r\n\r\n\tfunction clampToMaxSize ( image, maxSize ) {\r\n\r\n\t\tif ( image.width > maxSize || image.height > maxSize ) {\r\n\r\n\t\t\t// Warning: Scaling through the canvas will only work with images that use\r\n\t\t\t// premultiplied alpha.\r\n\r\n\t\t\tvar scale = maxSize / Math.max( image.width, image.height );\r\n\r\n\t\t\tvar canvas = document.createElement( 'canvas' );\r\n\t\t\tcanvas.width = Math.floor( image.width * scale );\r\n\t\t\tcanvas.height = Math.floor( image.height * scale );\r\n\r\n\t\t\tvar context = canvas.getContext( '2d' );\r\n\t\t\tcontext.drawImage( image, 0, 0, image.width, image.height, 0, 0, canvas.width, canvas.height );\r\n\r\n\t\t\tconsole.warn( 'THREE.WebGLRenderer: image is too big (' + image.width + 'x' + image.height + '). Resized to ' + canvas.width + 'x' + canvas.height, image );\r\n\r\n\t\t\treturn canvas;\r\n\r\n\t\t}\r\n\r\n\t\treturn image;\r\n\r\n\t}\r\n\r\n\tfunction isPowerOfTwo( image ) {\r\n\r\n\t\treturn THREE.Math.isPowerOfTwo( image.width ) && THREE.Math.isPowerOfTwo( image.height );\r\n\r\n\t}\r\n\r\n\tfunction textureNeedsPowerOfTwo( texture ) {\r\n\r\n\t\tif ( texture.wrapS !== THREE.ClampToEdgeWrapping || texture.wrapT !== THREE.ClampToEdgeWrapping ) return true;\r\n\t\tif ( texture.minFilter !== THREE.NearestFilter && texture.minFilter !== THREE.LinearFilter ) return true;\r\n\r\n\t\treturn false;\r\n\r\n\t}\r\n\r\n\tfunction makePowerOfTwo( image ) {\r\n\r\n\t\tif ( image instanceof HTMLImageElement || image instanceof HTMLCanvasElement ) {\r\n\r\n\t\t\tvar canvas = document.createElement( 'canvas' );\r\n\t\t\tcanvas.width = THREE.Math.nearestPowerOfTwo( image.width );\r\n\t\t\tcanvas.height = THREE.Math.nearestPowerOfTwo( image.height );\r\n\r\n\t\t\tvar context = canvas.getContext( '2d' );\r\n\t\t\tcontext.drawImage( image, 0, 0, canvas.width, canvas.height );\r\n\r\n\t\t\tconsole.warn( 'THREE.WebGLRenderer: image is not power of two (' + image.width + 'x' + image.height + '). Resized to ' + canvas.width + 'x' + canvas.height, image );\r\n\r\n\t\t\treturn canvas;\r\n\r\n\t\t}\r\n\r\n\t\treturn image;\r\n\r\n\t}\r\n\r\n\tfunction setCubeTexture ( texture, slot ) {\r\n\r\n\t\tvar textureProperties = properties.get( texture );\r\n\r\n\t\tif ( texture.image.length === 6 ) {\r\n\r\n\t\t\tif ( texture.version > 0 && textureProperties.__version !== texture.version ) {\r\n\r\n\t\t\t\tif ( ! textureProperties.__image__webglTextureCube ) {\r\n\r\n\t\t\t\t\ttexture.addEventListener( 'dispose', onTextureDispose );\r\n\r\n\t\t\t\t\ttextureProperties.__image__webglTextureCube = _gl.createTexture();\r\n\r\n\t\t\t\t\t_infoMemory.textures ++;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tstate.activeTexture( _gl.TEXTURE0 + slot );\r\n\t\t\t\tstate.bindTexture( _gl.TEXTURE_CUBE_MAP, textureProperties.__image__webglTextureCube );\r\n\r\n\t\t\t\t_gl.pixelStorei( _gl.UNPACK_FLIP_Y_WEBGL, texture.flipY );\r\n\r\n\t\t\t\tvar isCompressed = texture instanceof THREE.CompressedTexture;\r\n\t\t\t\tvar isDataTexture = texture.image[ 0 ] instanceof THREE.DataTexture;\r\n\r\n\t\t\t\tvar cubeImage = [];\r\n\r\n\t\t\t\tfor ( var i = 0; i < 6; i ++ ) {\r\n\r\n\t\t\t\t\tif ( _this.autoScaleCubemaps && ! isCompressed && ! isDataTexture ) {\r\n\r\n\t\t\t\t\t\tcubeImage[ i ] = clampToMaxSize( texture.image[ i ], capabilities.maxCubemapSize );\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\tcubeImage[ i ] = isDataTexture ? texture.image[ i ].image : texture.image[ i ];\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tvar image = cubeImage[ 0 ],\r\n\t\t\t\tisPowerOfTwoImage = isPowerOfTwo( image ),\r\n\t\t\t\tglFormat = paramThreeToGL( texture.format ),\r\n\t\t\t\tglType = paramThreeToGL( texture.type );\r\n\r\n\t\t\t\tsetTextureParameters( _gl.TEXTURE_CUBE_MAP, texture, isPowerOfTwoImage );\r\n\r\n\t\t\t\tfor ( var i = 0; i < 6; i ++ ) {\r\n\r\n\t\t\t\t\tif ( ! isCompressed ) {\r\n\r\n\t\t\t\t\t\tif ( isDataTexture ) {\r\n\r\n\t\t\t\t\t\t\tstate.texImage2D( _gl.TEXTURE_CUBE_MAP_POSITIVE_X + i, 0, glFormat, cubeImage[ i ].width, cubeImage[ i ].height, 0, glFormat, glType, cubeImage[ i ].data );\r\n\r\n\t\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\t\tstate.texImage2D( _gl.TEXTURE_CUBE_MAP_POSITIVE_X + i, 0, glFormat, glFormat, glType, cubeImage[ i ] );\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\tvar mipmap, mipmaps = cubeImage[ i ].mipmaps;\r\n\r\n\t\t\t\t\t\tfor ( var j = 0, jl = mipmaps.length; j < jl; j ++ ) {\r\n\r\n\t\t\t\t\t\t\tmipmap = mipmaps[ j ];\r\n\r\n\t\t\t\t\t\t\tif ( texture.format !== THREE.RGBAFormat && texture.format !== THREE.RGBFormat ) {\r\n\r\n\t\t\t\t\t\t\t\tif ( state.getCompressedTextureFormats().indexOf( glFormat ) > - 1 ) {\r\n\r\n\t\t\t\t\t\t\t\t\tstate.compressedTexImage2D( _gl.TEXTURE_CUBE_MAP_POSITIVE_X + i, j, glFormat, mipmap.width, mipmap.height, 0, mipmap.data );\r\n\r\n\t\t\t\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\t\t\t\tconsole.warn( \"THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setCubeTexture()\" );\r\n\r\n\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\t\t\tstate.texImage2D( _gl.TEXTURE_CUBE_MAP_POSITIVE_X + i, j, glFormat, mipmap.width, mipmap.height, 0, glFormat, glType, mipmap.data );\r\n\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( texture.generateMipmaps && isPowerOfTwoImage ) {\r\n\r\n\t\t\t\t\t_gl.generateMipmap( _gl.TEXTURE_CUBE_MAP );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\ttextureProperties.__version = texture.version;\r\n\r\n\t\t\t\tif ( texture.onUpdate ) texture.onUpdate( texture );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tstate.activeTexture( _gl.TEXTURE0 + slot );\r\n\t\t\t\tstate.bindTexture( _gl.TEXTURE_CUBE_MAP, textureProperties.__image__webglTextureCube );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tfunction setCubeTextureDynamic ( texture, slot ) {\r\n\r\n\t\tstate.activeTexture( _gl.TEXTURE0 + slot );\r\n\t\tstate.bindTexture( _gl.TEXTURE_CUBE_MAP, properties.get( texture ).__webglTexture );\r\n\r\n\t}\r\n\r\n\tvar setTextureWarned = false;\r\n\tthis.setTexture = function( texture, slot ) {\r\n\r\n\t\tif ( ! setTextureWarned ) {\r\n\r\n\t\t\tconsole.warn( \"THREE.WebGLRenderer: .setTexture is deprecated, \" +\r\n\t\t\t\t\"use setTexture2D instead.\" );\r\n\t\t\tsetTextureWarned = true;\r\n\r\n\t\t}\r\n\r\n\t\tsetTexture2D( texture, slot );\r\n\r\n\t};\r\n\r\n\tthis.allocTextureUnit = allocTextureUnit;\r\n\tthis.setTexture2D = setTexture2D;\r\n\tthis.setTextureCube = function( texture, slot ) {\r\n\r\n\t\tif ( texture instanceof THREE.CubeTexture ||\r\n\t\t\t ( Array.isArray( texture.image ) && texture.image.length === 6 ) ) {\r\n\r\n\t\t\t// CompressedTexture can have Array in image :/\r\n\r\n\t\t\tsetCubeTexture( texture, slot );\r\n\r\n\t\t} else {\r\n\t\t\t// assumed: texture instanceof THREE.WebGLRenderTargetCube\r\n\r\n\t\t\tsetCubeTextureDynamic( texture.texture, slot );\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n\t// Render targets\r\n\r\n\t// Setup storage for target texture and bind it to correct framebuffer\r\n\tfunction setupFrameBufferTexture ( framebuffer, renderTarget, attachment, textureTarget ) {\r\n\r\n\t\tvar glFormat = paramThreeToGL( renderTarget.texture.format );\r\n\t\tvar glType = paramThreeToGL( renderTarget.texture.type );\r\n\t\tstate.texImage2D( textureTarget, 0, glFormat, renderTarget.width, renderTarget.height, 0, glFormat, glType, null );\r\n\t\t_gl.bindFramebuffer( _gl.FRAMEBUFFER, framebuffer );\r\n\t\t_gl.framebufferTexture2D( _gl.FRAMEBUFFER, attachment, textureTarget, properties.get( renderTarget.texture ).__webglTexture, 0 );\r\n\t\t_gl.bindFramebuffer( _gl.FRAMEBUFFER, null );\r\n\r\n\t}\r\n\r\n\t// Setup storage for internal depth/stencil buffers and bind to correct framebuffer\r\n\tfunction setupRenderBufferStorage ( renderbuffer, renderTarget ) {\r\n\r\n\t\t_gl.bindRenderbuffer( _gl.RENDERBUFFER, renderbuffer );\r\n\r\n\t\tif ( renderTarget.depthBuffer && ! renderTarget.stencilBuffer ) {\r\n\r\n\t\t\t_gl.renderbufferStorage( _gl.RENDERBUFFER, _gl.DEPTH_COMPONENT16, renderTarget.width, renderTarget.height );\r\n\t\t\t_gl.framebufferRenderbuffer( _gl.FRAMEBUFFER, _gl.DEPTH_ATTACHMENT, _gl.RENDERBUFFER, renderbuffer );\r\n\r\n\t\t} else if ( renderTarget.depthBuffer && renderTarget.stencilBuffer ) {\r\n\r\n\t\t\t_gl.renderbufferStorage( _gl.RENDERBUFFER, _gl.DEPTH_STENCIL, renderTarget.width, renderTarget.height );\r\n\t\t\t_gl.framebufferRenderbuffer( _gl.FRAMEBUFFER, _gl.DEPTH_STENCIL_ATTACHMENT, _gl.RENDERBUFFER, renderbuffer );\r\n\r\n\t\t} else {\r\n\r\n\t\t\t// FIXME: We don't support !depth !stencil\r\n\t\t\t_gl.renderbufferStorage( _gl.RENDERBUFFER, _gl.RGBA4, renderTarget.width, renderTarget.height );\r\n\r\n\t\t}\r\n\r\n\t\t_gl.bindRenderbuffer( _gl.RENDERBUFFER, null );\r\n\r\n\t}\r\n\r\n\t// Setup resources for a Depth Texture for a FBO (needs an extension)\r\n\tfunction setupDepthTexture ( framebuffer, renderTarget ) {\r\n\r\n\t\tvar isCube = ( renderTarget instanceof THREE.WebGLRenderTargetCube );\r\n\t\tif ( isCube ) throw new Error('Depth Texture with cube render targets is not supported!');\r\n\r\n\t\t_gl.bindFramebuffer( _gl.FRAMEBUFFER, framebuffer );\r\n\r\n\t\tif ( !( renderTarget.depthTexture instanceof THREE.DepthTexture ) ) {\r\n\r\n\t\t\tthrow new Error('renderTarget.depthTexture must be an instance of THREE.DepthTexture');\r\n\r\n\t\t}\r\n\r\n\t\t// upload an empty depth texture with framebuffer size\r\n\t\tif ( !properties.get( renderTarget.depthTexture ).__webglTexture ||\r\n\t\t\t\trenderTarget.depthTexture.image.width !== renderTarget.width ||\r\n\t\t\t\trenderTarget.depthTexture.image.height !== renderTarget.height ) {\r\n\t\t\trenderTarget.depthTexture.image.width = renderTarget.width;\r\n\t\t\trenderTarget.depthTexture.image.height = renderTarget.height;\r\n\t\t\trenderTarget.depthTexture.needsUpdate = true;\r\n\t\t}\r\n\r\n\t\t_this.setTexture( renderTarget.depthTexture, 0 );\r\n\r\n\t\tvar webglDepthTexture = properties.get( renderTarget.depthTexture ).__webglTexture;\r\n\t\t_gl.framebufferTexture2D( _gl.FRAMEBUFFER, _gl.DEPTH_ATTACHMENT, _gl.TEXTURE_2D, webglDepthTexture, 0 );\r\n\r\n\t}\r\n\r\n\t// Setup GL resources for a non-texture depth buffer\r\n\tfunction setupDepthRenderbuffer( renderTarget ) {\r\n\r\n\t\tvar renderTargetProperties = properties.get( renderTarget );\r\n\r\n\t\tvar isCube = ( renderTarget instanceof THREE.WebGLRenderTargetCube );\r\n\r\n\t\tif ( renderTarget.depthTexture ) {\r\n\r\n\t\t\tif ( isCube ) throw new Error('target.depthTexture not supported in Cube render targets');\r\n\r\n\t\t\tsetupDepthTexture( renderTargetProperties.__webglFramebuffer, renderTarget );\r\n\r\n\t\t} else {\r\n\r\n\t\t\tif ( isCube ) {\r\n\r\n\t\t\t\trenderTargetProperties.__webglDepthbuffer = [];\r\n\r\n\t\t\t\tfor ( var i = 0; i < 6; i ++ ) {\r\n\r\n\t\t\t\t\t_gl.bindFramebuffer( _gl.FRAMEBUFFER, renderTargetProperties.__webglFramebuffer[ i ] );\r\n\t\t\t\t\trenderTargetProperties.__webglDepthbuffer[ i ] = _gl.createRenderbuffer();\r\n\t\t\t\t\tsetupRenderBufferStorage( renderTargetProperties.__webglDepthbuffer[ i ], renderTarget );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\t_gl.bindFramebuffer( _gl.FRAMEBUFFER, renderTargetProperties.__webglFramebuffer );\r\n\t\t\t\trenderTargetProperties.__webglDepthbuffer = _gl.createRenderbuffer();\r\n\t\t\t\tsetupRenderBufferStorage( renderTargetProperties.__webglDepthbuffer, renderTarget );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\t_gl.bindFramebuffer( _gl.FRAMEBUFFER, null );\r\n\r\n\t}\r\n\r\n\t// Set up GL resources for the render target\r\n\tfunction setupRenderTarget( renderTarget ) {\r\n\r\n\t\tvar renderTargetProperties = properties.get( renderTarget );\r\n\t\tvar textureProperties = properties.get( renderTarget.texture );\r\n\r\n\t\trenderTarget.addEventListener( 'dispose', onRenderTargetDispose );\r\n\r\n\t\ttextureProperties.__webglTexture = _gl.createTexture();\r\n\r\n\t\t_infoMemory.textures ++;\r\n\r\n\t\tvar isCube = ( renderTarget instanceof THREE.WebGLRenderTargetCube );\r\n\t\tvar isTargetPowerOfTwo = THREE.Math.isPowerOfTwo( renderTarget.width ) && THREE.Math.isPowerOfTwo( renderTarget.height );\r\n\r\n\t\t// Setup framebuffer\r\n\r\n\t\tif ( isCube ) {\r\n\r\n\t\t\trenderTargetProperties.__webglFramebuffer = [];\r\n\r\n\t\t\tfor ( var i = 0; i < 6; i ++ ) {\r\n\r\n\t\t\t\trenderTargetProperties.__webglFramebuffer[ i ] = _gl.createFramebuffer();\r\n\r\n\t\t\t}\r\n\r\n\t\t} else {\r\n\r\n\t\t\trenderTargetProperties.__webglFramebuffer = _gl.createFramebuffer();\r\n\r\n\t\t}\r\n\r\n\t\t// Setup color buffer\r\n\r\n\t\tif ( isCube ) {\r\n\r\n\t\t\tstate.bindTexture( _gl.TEXTURE_CUBE_MAP, textureProperties.__webglTexture );\r\n\t\t\tsetTextureParameters( _gl.TEXTURE_CUBE_MAP, renderTarget.texture, isTargetPowerOfTwo );\r\n\r\n\t\t\tfor ( var i = 0; i < 6; i ++ ) {\r\n\r\n\t\t\t\tsetupFrameBufferTexture( renderTargetProperties.__webglFramebuffer[ i ], renderTarget, _gl.COLOR_ATTACHMENT0, _gl.TEXTURE_CUBE_MAP_POSITIVE_X + i );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( renderTarget.texture.generateMipmaps && isTargetPowerOfTwo ) _gl.generateMipmap( _gl.TEXTURE_CUBE_MAP );\r\n\t\t\tstate.bindTexture( _gl.TEXTURE_CUBE_MAP, null );\r\n\r\n\t\t} else {\r\n\r\n\t\t\tstate.bindTexture( _gl.TEXTURE_2D, textureProperties.__webglTexture );\r\n\t\t\tsetTextureParameters( _gl.TEXTURE_2D, renderTarget.texture, isTargetPowerOfTwo );\r\n\t\t\tsetupFrameBufferTexture( renderTargetProperties.__webglFramebuffer, renderTarget, _gl.COLOR_ATTACHMENT0, _gl.TEXTURE_2D );\r\n\r\n\t\t\tif ( renderTarget.texture.generateMipmaps && isTargetPowerOfTwo ) _gl.generateMipmap( _gl.TEXTURE_2D );\r\n\t\t\tstate.bindTexture( _gl.TEXTURE_2D, null );\r\n\r\n\t\t}\r\n\r\n\t\t// Setup depth and stencil buffers\r\n\r\n\t\tif ( renderTarget.depthBuffer ) {\r\n\r\n\t\t\tsetupDepthRenderbuffer( renderTarget );\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tthis.getCurrentRenderTarget = function() {\r\n\r\n\t\treturn _currentRenderTarget;\r\n\r\n\t};\r\n\r\n\tthis.setRenderTarget = function ( renderTarget ) {\r\n\r\n\t\t_currentRenderTarget = renderTarget;\r\n\r\n\t\tif ( renderTarget && properties.get( renderTarget ).__webglFramebuffer === undefined ) {\r\n\r\n\t\t\tsetupRenderTarget( renderTarget );\r\n\r\n\t\t}\r\n\r\n\t\tvar isCube = ( renderTarget instanceof THREE.WebGLRenderTargetCube );\r\n\t\tvar framebuffer;\r\n\r\n\t\tif ( renderTarget ) {\r\n\r\n\t\t\tvar renderTargetProperties = properties.get( renderTarget );\r\n\r\n\t\t\tif ( isCube ) {\r\n\r\n\t\t\t\tframebuffer = renderTargetProperties.__webglFramebuffer[ renderTarget.activeCubeFace ];\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tframebuffer = renderTargetProperties.__webglFramebuffer;\r\n\r\n\t\t\t}\r\n\r\n\t\t\t_currentScissor.copy( renderTarget.scissor );\r\n\t\t\t_currentScissorTest = renderTarget.scissorTest;\r\n\r\n\t\t\t_currentViewport.copy( renderTarget.viewport );\r\n\r\n\t\t} else {\r\n\r\n\t\t\tframebuffer = null;\r\n\r\n\t\t\t_currentScissor.copy( _scissor ).multiplyScalar( _pixelRatio );\r\n\t\t\t_currentScissorTest = _scissorTest;\r\n\r\n\t\t\t_currentViewport.copy( _viewport ).multiplyScalar( _pixelRatio );\r\n\r\n\t\t}\r\n\r\n\t\tif ( _currentFramebuffer !== framebuffer ) {\r\n\r\n\t\t\t_gl.bindFramebuffer( _gl.FRAMEBUFFER, framebuffer );\r\n\t\t\t_currentFramebuffer = framebuffer;\r\n\r\n\t\t}\r\n\r\n\t\tstate.scissor( _currentScissor );\r\n\t\tstate.setScissorTest( _currentScissorTest );\r\n\r\n\t\tstate.viewport( _currentViewport );\r\n\r\n\t\tif ( isCube ) {\r\n\r\n\t\t\tvar textureProperties = properties.get( renderTarget.texture );\r\n\t\t\t_gl.framebufferTexture2D( _gl.FRAMEBUFFER, _gl.COLOR_ATTACHMENT0, _gl.TEXTURE_CUBE_MAP_POSITIVE_X + renderTarget.activeCubeFace, textureProperties.__webglTexture, renderTarget.activeMipMapLevel );\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n\tthis.readRenderTargetPixels = function ( renderTarget, x, y, width, height, buffer ) {\r\n\r\n\t\tif ( renderTarget instanceof THREE.WebGLRenderTarget === false ) {\r\n\r\n\t\t\tconsole.error( 'THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.' );\r\n\t\t\treturn;\r\n\r\n\t\t}\r\n\r\n\t\tvar framebuffer = properties.get( renderTarget ).__webglFramebuffer;\r\n\r\n\t\tif ( framebuffer ) {\r\n\r\n\t\t\tvar restore = false;\r\n\r\n\t\t\tif ( framebuffer !== _currentFramebuffer ) {\r\n\r\n\t\t\t\t_gl.bindFramebuffer( _gl.FRAMEBUFFER, framebuffer );\r\n\r\n\t\t\t\trestore = true;\r\n\r\n\t\t\t}\r\n\r\n\t\t\ttry {\r\n\r\n\t\t\t\tvar texture = renderTarget.texture;\r\n\r\n\t\t\t\tif ( texture.format !== THREE.RGBAFormat && paramThreeToGL( texture.format ) !== _gl.getParameter( _gl.IMPLEMENTATION_COLOR_READ_FORMAT ) ) {\r\n\r\n\t\t\t\t\tconsole.error( 'THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.' );\r\n\t\t\t\t\treturn;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( texture.type !== THREE.UnsignedByteType &&\r\n\t\t\t\t     paramThreeToGL( texture.type ) !== _gl.getParameter( _gl.IMPLEMENTATION_COLOR_READ_TYPE ) &&\r\n\t\t\t\t     ! ( texture.type === THREE.FloatType && extensions.get( 'WEBGL_color_buffer_float' ) ) &&\r\n\t\t\t\t     ! ( texture.type === THREE.HalfFloatType && extensions.get( 'EXT_color_buffer_half_float' ) ) ) {\r\n\r\n\t\t\t\t\tconsole.error( 'THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.' );\r\n\t\t\t\t\treturn;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( _gl.checkFramebufferStatus( _gl.FRAMEBUFFER ) === _gl.FRAMEBUFFER_COMPLETE ) {\r\n\r\n\t\t\t\t\t// the following if statement ensures valid read requests (no out-of-bounds pixels, see #8604)\r\n\r\n\t\t\t\t\tif ( ( x > 0 && x <= ( renderTarget.width - width ) ) && ( y > 0 && y <= ( renderTarget.height - height ) ) ) {\r\n\r\n\t\t\t\t\t\t_gl.readPixels( x, y, width, height, paramThreeToGL( texture.format ), paramThreeToGL( texture.type ), buffer );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tconsole.error( 'THREE.WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete.' );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t} finally {\r\n\r\n\t\t\t\tif ( restore ) {\r\n\r\n\t\t\t\t\t_gl.bindFramebuffer( _gl.FRAMEBUFFER, _currentFramebuffer );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n\tfunction updateRenderTargetMipmap( renderTarget ) {\r\n\r\n\t\tvar target = renderTarget instanceof THREE.WebGLRenderTargetCube ? _gl.TEXTURE_CUBE_MAP : _gl.TEXTURE_2D;\r\n\t\tvar texture = properties.get( renderTarget.texture ).__webglTexture;\r\n\r\n\t\tstate.bindTexture( target, texture );\r\n\t\t_gl.generateMipmap( target );\r\n\t\tstate.bindTexture( target, null );\r\n\r\n\t}\r\n\r\n\t// Fallback filters for non-power-of-2 textures\r\n\r\n\tfunction filterFallback ( f ) {\r\n\r\n\t\tif ( f === THREE.NearestFilter || f === THREE.NearestMipMapNearestFilter || f === THREE.NearestMipMapLinearFilter ) {\r\n\r\n\t\t\treturn _gl.NEAREST;\r\n\r\n\t\t}\r\n\r\n\t\treturn _gl.LINEAR;\r\n\r\n\t}\r\n\r\n\t// Map three.js constants to WebGL constants\r\n\r\n\tfunction paramThreeToGL ( p ) {\r\n\r\n\t\tvar extension;\r\n\r\n\t\tif ( p === THREE.RepeatWrapping ) return _gl.REPEAT;\r\n\t\tif ( p === THREE.ClampToEdgeWrapping ) return _gl.CLAMP_TO_EDGE;\r\n\t\tif ( p === THREE.MirroredRepeatWrapping ) return _gl.MIRRORED_REPEAT;\r\n\r\n\t\tif ( p === THREE.NearestFilter ) return _gl.NEAREST;\r\n\t\tif ( p === THREE.NearestMipMapNearestFilter ) return _gl.NEAREST_MIPMAP_NEAREST;\r\n\t\tif ( p === THREE.NearestMipMapLinearFilter ) return _gl.NEAREST_MIPMAP_LINEAR;\r\n\r\n\t\tif ( p === THREE.LinearFilter ) return _gl.LINEAR;\r\n\t\tif ( p === THREE.LinearMipMapNearestFilter ) return _gl.LINEAR_MIPMAP_NEAREST;\r\n\t\tif ( p === THREE.LinearMipMapLinearFilter ) return _gl.LINEAR_MIPMAP_LINEAR;\r\n\r\n\t\tif ( p === THREE.UnsignedByteType ) return _gl.UNSIGNED_BYTE;\r\n\t\tif ( p === THREE.UnsignedShort4444Type ) return _gl.UNSIGNED_SHORT_4_4_4_4;\r\n\t\tif ( p === THREE.UnsignedShort5551Type ) return _gl.UNSIGNED_SHORT_5_5_5_1;\r\n\t\tif ( p === THREE.UnsignedShort565Type ) return _gl.UNSIGNED_SHORT_5_6_5;\r\n\r\n\t\tif ( p === THREE.ByteType ) return _gl.BYTE;\r\n\t\tif ( p === THREE.ShortType ) return _gl.SHORT;\r\n\t\tif ( p === THREE.UnsignedShortType ) return _gl.UNSIGNED_SHORT;\r\n\t\tif ( p === THREE.IntType ) return _gl.INT;\r\n\t\tif ( p === THREE.UnsignedIntType ) return _gl.UNSIGNED_INT;\r\n\t\tif ( p === THREE.FloatType ) return _gl.FLOAT;\r\n\r\n\t\textension = extensions.get( 'OES_texture_half_float' );\r\n\r\n\t\tif ( extension !== null ) {\r\n\r\n\t\t\tif ( p === THREE.HalfFloatType ) return extension.HALF_FLOAT_OES;\r\n\r\n\t\t}\r\n\r\n\t\tif ( p === THREE.AlphaFormat ) return _gl.ALPHA;\r\n\t\tif ( p === THREE.RGBFormat ) return _gl.RGB;\r\n\t\tif ( p === THREE.RGBAFormat ) return _gl.RGBA;\r\n\t\tif ( p === THREE.LuminanceFormat ) return _gl.LUMINANCE;\r\n\t\tif ( p === THREE.LuminanceAlphaFormat ) return _gl.LUMINANCE_ALPHA;\r\n\t\tif ( p === THREE.DepthFormat ) return _gl.DEPTH_COMPONENT;\r\n\r\n\t\tif ( p === THREE.AddEquation ) return _gl.FUNC_ADD;\r\n\t\tif ( p === THREE.SubtractEquation ) return _gl.FUNC_SUBTRACT;\r\n\t\tif ( p === THREE.ReverseSubtractEquation ) return _gl.FUNC_REVERSE_SUBTRACT;\r\n\r\n\t\tif ( p === THREE.ZeroFactor ) return _gl.ZERO;\r\n\t\tif ( p === THREE.OneFactor ) return _gl.ONE;\r\n\t\tif ( p === THREE.SrcColorFactor ) return _gl.SRC_COLOR;\r\n\t\tif ( p === THREE.OneMinusSrcColorFactor ) return _gl.ONE_MINUS_SRC_COLOR;\r\n\t\tif ( p === THREE.SrcAlphaFactor ) return _gl.SRC_ALPHA;\r\n\t\tif ( p === THREE.OneMinusSrcAlphaFactor ) return _gl.ONE_MINUS_SRC_ALPHA;\r\n\t\tif ( p === THREE.DstAlphaFactor ) return _gl.DST_ALPHA;\r\n\t\tif ( p === THREE.OneMinusDstAlphaFactor ) return _gl.ONE_MINUS_DST_ALPHA;\r\n\r\n\t\tif ( p === THREE.DstColorFactor ) return _gl.DST_COLOR;\r\n\t\tif ( p === THREE.OneMinusDstColorFactor ) return _gl.ONE_MINUS_DST_COLOR;\r\n\t\tif ( p === THREE.SrcAlphaSaturateFactor ) return _gl.SRC_ALPHA_SATURATE;\r\n\r\n\t\textension = extensions.get( 'WEBGL_compressed_texture_s3tc' );\r\n\r\n\t\tif ( extension !== null ) {\r\n\r\n\t\t\tif ( p === THREE.RGB_S3TC_DXT1_Format ) return extension.COMPRESSED_RGB_S3TC_DXT1_EXT;\r\n\t\t\tif ( p === THREE.RGBA_S3TC_DXT1_Format ) return extension.COMPRESSED_RGBA_S3TC_DXT1_EXT;\r\n\t\t\tif ( p === THREE.RGBA_S3TC_DXT3_Format ) return extension.COMPRESSED_RGBA_S3TC_DXT3_EXT;\r\n\t\t\tif ( p === THREE.RGBA_S3TC_DXT5_Format ) return extension.COMPRESSED_RGBA_S3TC_DXT5_EXT;\r\n\r\n\t\t}\r\n\r\n\t\textension = extensions.get( 'WEBGL_compressed_texture_pvrtc' );\r\n\r\n\t\tif ( extension !== null ) {\r\n\r\n\t\t\tif ( p === THREE.RGB_PVRTC_4BPPV1_Format ) return extension.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;\r\n\t\t\tif ( p === THREE.RGB_PVRTC_2BPPV1_Format ) return extension.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;\r\n\t\t\tif ( p === THREE.RGBA_PVRTC_4BPPV1_Format ) return extension.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;\r\n\t\t\tif ( p === THREE.RGBA_PVRTC_2BPPV1_Format ) return extension.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG;\r\n\r\n\t\t}\r\n\r\n\t\textension = extensions.get( 'WEBGL_compressed_texture_etc1' );\r\n\r\n\t\tif ( extension !== null ) {\r\n\r\n\t\t\tif ( p === THREE.RGB_ETC1_Format ) return extension.COMPRESSED_RGB_ETC1_WEBGL;\r\n\r\n\t\t}\r\n\r\n\t\textension = extensions.get( 'EXT_blend_minmax' );\r\n\r\n\t\tif ( extension !== null ) {\r\n\r\n\t\t\tif ( p === THREE.MinEquation ) return extension.MIN_EXT;\r\n\t\t\tif ( p === THREE.MaxEquation ) return extension.MAX_EXT;\r\n\r\n\t\t}\r\n\r\n\t\treturn 0;\r\n\r\n\t}\r\n\r\n};\r\n\r\n// File:src/renderers/WebGLRenderTarget.js\r\n\r\n/**\r\n * @author szimek / https://github.com/szimek/\r\n * @author alteredq / http://alteredqualia.com/\r\n * @author Marius Kintel / https://github.com/kintel\r\n */\r\n\r\n/*\r\n In options, we can specify:\r\n * Texture parameters for an auto-generated target texture\r\n * depthBuffer/stencilBuffer: Booleans to indicate if we should generate these buffers\r\n*/\r\nTHREE.WebGLRenderTarget = function ( width, height, options ) {\r\n\r\n\tthis.uuid = THREE.Math.generateUUID();\r\n\r\n\tthis.width = width;\r\n\tthis.height = height;\r\n\r\n\tthis.scissor = new THREE.Vector4( 0, 0, width, height );\r\n\tthis.scissorTest = false;\r\n\r\n\tthis.viewport = new THREE.Vector4( 0, 0, width, height );\r\n\r\n\toptions = options || {};\r\n\r\n\tif ( options.minFilter === undefined ) options.minFilter = THREE.LinearFilter;\r\n\r\n\tthis.texture = new THREE.Texture( undefined, undefined, options.wrapS, options.wrapT, options.magFilter, options.minFilter, options.format, options.type, options.anisotropy, options.encoding );\r\n\r\n\tthis.depthBuffer = options.depthBuffer !== undefined ? options.depthBuffer : true;\r\n\tthis.stencilBuffer = options.stencilBuffer !== undefined ? options.stencilBuffer : true;\r\n\tthis.depthTexture = null;\r\n\r\n};\r\n\r\nTHREE.WebGLRenderTarget.prototype = {\r\n\r\n\tconstructor: THREE.WebGLRenderTarget,\r\n\r\n\tsetSize: function ( width, height ) {\r\n\r\n\t\tif ( this.width !== width || this.height !== height ) {\r\n\r\n\t\t\tthis.width = width;\r\n\t\t\tthis.height = height;\r\n\r\n\t\t\tthis.dispose();\r\n\r\n\t\t}\r\n\r\n\t\tthis.viewport.set( 0, 0, width, height );\r\n\t\tthis.scissor.set( 0, 0, width, height );\r\n\r\n\t},\r\n\r\n\tclone: function () {\r\n\r\n\t\treturn new this.constructor().copy( this );\r\n\r\n\t},\r\n\r\n\tcopy: function ( source ) {\r\n\r\n\t\tthis.width = source.width;\r\n\t\tthis.height = source.height;\r\n\r\n\t\tthis.viewport.copy( source.viewport );\r\n\r\n\t\tthis.texture = source.texture.clone();\r\n\r\n\t\tthis.depthBuffer = source.depthBuffer;\r\n\t\tthis.stencilBuffer = source.stencilBuffer;\r\n\t\tthis.depthTexture = source.depthTexture;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tdispose: function () {\r\n\r\n\t\tthis.dispatchEvent( { type: 'dispose' } );\r\n\r\n\t}\r\n\r\n};\r\n\r\nTHREE.EventDispatcher.prototype.apply( THREE.WebGLRenderTarget.prototype );\r\n\r\n// File:src/renderers/WebGLRenderTargetCube.js\r\n\r\n/**\r\n * @author alteredq / http://alteredqualia.com\r\n */\r\n\r\nTHREE.WebGLRenderTargetCube = function ( width, height, options ) {\r\n\r\n\tTHREE.WebGLRenderTarget.call( this, width, height, options );\r\n\r\n\tthis.activeCubeFace = 0; // PX 0, NX 1, PY 2, NY 3, PZ 4, NZ 5\r\n\tthis.activeMipMapLevel = 0;\r\n\r\n};\r\n\r\nTHREE.WebGLRenderTargetCube.prototype = Object.create( THREE.WebGLRenderTarget.prototype );\r\nTHREE.WebGLRenderTargetCube.prototype.constructor = THREE.WebGLRenderTargetCube;\r\n\r\n// File:src/renderers/webgl/WebGLBufferRenderer.js\r\n\r\n/**\r\n* @author mrdoob / http://mrdoob.com/\r\n*/\r\n\r\nTHREE.WebGLBufferRenderer = function ( _gl, extensions, _infoRender ) {\r\n\r\n\tvar mode;\r\n\r\n\tfunction setMode( value ) {\r\n\r\n\t\tmode = value;\r\n\r\n\t}\r\n\r\n\tfunction render( start, count ) {\r\n\r\n\t\t_gl.drawArrays( mode, start, count );\r\n\r\n\t\t_infoRender.calls ++;\r\n\t\t_infoRender.vertices += count;\r\n\t\tif ( mode === _gl.TRIANGLES ) _infoRender.faces += count / 3;\r\n\r\n\t}\r\n\r\n\tfunction renderInstances( geometry ) {\r\n\r\n\t\tvar extension = extensions.get( 'ANGLE_instanced_arrays' );\r\n\r\n\t\tif ( extension === null ) {\r\n\r\n\t\t\tconsole.error( 'THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.' );\r\n\t\t\treturn;\r\n\r\n\t\t}\r\n\r\n\t\tvar position = geometry.attributes.position;\r\n\r\n\t\tvar count = 0;\r\n\r\n\t\tif ( position instanceof THREE.InterleavedBufferAttribute ) {\r\n\r\n\t\t\tcount = position.data.count;\r\n\r\n\t\t\textension.drawArraysInstancedANGLE( mode, 0, count, geometry.maxInstancedCount );\r\n\r\n\t\t} else {\r\n\r\n\t\t\tcount = position.count;\r\n\r\n\t\t\textension.drawArraysInstancedANGLE( mode, 0, count, geometry.maxInstancedCount );\r\n\r\n\t\t}\r\n\r\n\t\t_infoRender.calls ++;\r\n\t\t_infoRender.vertices += count * geometry.maxInstancedCount;\r\n\t\tif ( mode === _gl.TRIANGLES ) _infoRender.faces += geometry.maxInstancedCount * count / 3;\r\n\r\n\t}\r\n\r\n\tthis.setMode = setMode;\r\n\tthis.render = render;\r\n\tthis.renderInstances = renderInstances;\r\n\r\n};\r\n\r\n// File:src/renderers/webgl/WebGLIndexedBufferRenderer.js\r\n\r\n/**\r\n* @author mrdoob / http://mrdoob.com/\r\n*/\r\n\r\nTHREE.WebGLIndexedBufferRenderer = function ( _gl, extensions, _infoRender ) {\r\n\r\n\tvar mode;\r\n\r\n\tfunction setMode( value ) {\r\n\r\n\t\tmode = value;\r\n\r\n\t}\r\n\r\n\tvar type, size;\r\n\r\n\tfunction setIndex( index ) {\r\n\r\n\t\tif ( index.array instanceof Uint32Array && extensions.get( 'OES_element_index_uint' ) ) {\r\n\r\n\t\t\ttype = _gl.UNSIGNED_INT;\r\n\t\t\tsize = 4;\r\n\r\n\t\t} else {\r\n\r\n\t\t\ttype = _gl.UNSIGNED_SHORT;\r\n\t\t\tsize = 2;\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tfunction render( start, count ) {\r\n\r\n\t\t_gl.drawElements( mode, count, type, start * size );\r\n\r\n\t\t_infoRender.calls ++;\r\n\t\t_infoRender.vertices += count;\r\n\t\tif ( mode === _gl.TRIANGLES ) _infoRender.faces += count / 3;\r\n\r\n\t}\r\n\r\n\tfunction renderInstances( geometry, start, count ) {\r\n\r\n\t\tvar extension = extensions.get( 'ANGLE_instanced_arrays' );\r\n\r\n\t\tif ( extension === null ) {\r\n\r\n\t\t\tconsole.error( 'THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.' );\r\n\t\t\treturn;\r\n\r\n\t\t}\r\n\r\n\t\textension.drawElementsInstancedANGLE( mode, count, type, start * size, geometry.maxInstancedCount );\r\n\r\n\t\t_infoRender.calls ++;\r\n\t\t_infoRender.vertices += count * geometry.maxInstancedCount;\r\n\t\tif ( mode === _gl.TRIANGLES ) _infoRender.faces += geometry.maxInstancedCount * count / 3;\r\n\t}\r\n\r\n\tthis.setMode = setMode;\r\n\tthis.setIndex = setIndex;\r\n\tthis.render = render;\r\n\tthis.renderInstances = renderInstances;\r\n\r\n};\r\n\r\n// File:src/renderers/webgl/WebGLExtensions.js\r\n\r\n/**\r\n* @author mrdoob / http://mrdoob.com/\r\n*/\r\n\r\nTHREE.WebGLExtensions = function ( gl ) {\r\n\r\n\tvar extensions = {};\r\n\r\n\tthis.get = function ( name ) {\r\n\r\n\t\tif ( extensions[ name ] !== undefined ) {\r\n\r\n\t\t\treturn extensions[ name ];\r\n\r\n\t\t}\r\n\r\n\t\tvar extension;\r\n\r\n\t\tswitch ( name ) {\r\n\r\n\t\t\tcase 'WEBGL_depth_texture':\r\n\t\t\t\textension = gl.getExtension( 'WEBGL_depth_texture' ) || gl.getExtension( 'MOZ_WEBGL_depth_texture' ) || gl.getExtension( 'WEBKIT_WEBGL_depth_texture' );\r\n\r\n\t\t\tcase 'EXT_texture_filter_anisotropic':\r\n\t\t\t\textension = gl.getExtension( 'EXT_texture_filter_anisotropic' ) || gl.getExtension( 'MOZ_EXT_texture_filter_anisotropic' ) || gl.getExtension( 'WEBKIT_EXT_texture_filter_anisotropic' );\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tcase 'WEBGL_compressed_texture_s3tc':\r\n\t\t\t\textension = gl.getExtension( 'WEBGL_compressed_texture_s3tc' ) || gl.getExtension( 'MOZ_WEBGL_compressed_texture_s3tc' ) || gl.getExtension( 'WEBKIT_WEBGL_compressed_texture_s3tc' );\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tcase 'WEBGL_compressed_texture_pvrtc':\r\n\t\t\t\textension = gl.getExtension( 'WEBGL_compressed_texture_pvrtc' ) || gl.getExtension( 'WEBKIT_WEBGL_compressed_texture_pvrtc' );\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tcase 'WEBGL_compressed_texture_etc1':\r\n\t\t\t\textension = gl.getExtension( 'WEBGL_compressed_texture_etc1' );\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tdefault:\r\n\t\t\t\textension = gl.getExtension( name );\r\n\r\n\t\t}\r\n\r\n\t\tif ( extension === null ) {\r\n\r\n\t\t\tconsole.warn( 'THREE.WebGLRenderer: ' + name + ' extension not supported.' );\r\n\r\n\t\t}\r\n\r\n\t\textensions[ name ] = extension;\r\n\r\n\t\treturn extension;\r\n\r\n\t};\r\n\r\n};\r\n\r\n// File:src/renderers/webgl/WebGLCapabilities.js\r\n\r\nTHREE.WebGLCapabilities = function ( gl, extensions, parameters ) {\r\n\r\n\tfunction getMaxPrecision( precision ) {\r\n\r\n\t\tif ( precision === 'highp' ) {\r\n\r\n\t\t\tif ( gl.getShaderPrecisionFormat( gl.VERTEX_SHADER, gl.HIGH_FLOAT ).precision > 0 &&\r\n\t\t\t     gl.getShaderPrecisionFormat( gl.FRAGMENT_SHADER, gl.HIGH_FLOAT ).precision > 0 ) {\r\n\r\n\t\t\t\treturn 'highp';\r\n\r\n\t\t\t}\r\n\r\n\t\t\tprecision = 'mediump';\r\n\r\n\t\t}\r\n\r\n\t\tif ( precision === 'mediump' ) {\r\n\r\n\t\t\tif ( gl.getShaderPrecisionFormat( gl.VERTEX_SHADER, gl.MEDIUM_FLOAT ).precision > 0 &&\r\n\t\t\t     gl.getShaderPrecisionFormat( gl.FRAGMENT_SHADER, gl.MEDIUM_FLOAT ).precision > 0 ) {\r\n\r\n\t\t\t\treturn 'mediump';\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\treturn 'lowp';\r\n\r\n\t}\r\n\r\n\tthis.getMaxPrecision = getMaxPrecision;\r\n\r\n\tthis.precision = parameters.precision !== undefined ? parameters.precision : 'highp',\r\n\tthis.logarithmicDepthBuffer = parameters.logarithmicDepthBuffer !== undefined ? parameters.logarithmicDepthBuffer : false;\r\n\r\n\tthis.maxTextures = gl.getParameter( gl.MAX_TEXTURE_IMAGE_UNITS );\r\n\tthis.maxVertexTextures = gl.getParameter( gl.MAX_VERTEX_TEXTURE_IMAGE_UNITS );\r\n\tthis.maxTextureSize = gl.getParameter( gl.MAX_TEXTURE_SIZE );\r\n\tthis.maxCubemapSize = gl.getParameter( gl.MAX_CUBE_MAP_TEXTURE_SIZE );\r\n\r\n\tthis.maxAttributes = gl.getParameter( gl.MAX_VERTEX_ATTRIBS );\r\n\tthis.maxVertexUniforms = gl.getParameter( gl.MAX_VERTEX_UNIFORM_VECTORS );\r\n\tthis.maxVaryings = gl.getParameter( gl.MAX_VARYING_VECTORS );\r\n\tthis.maxFragmentUniforms = gl.getParameter( gl.MAX_FRAGMENT_UNIFORM_VECTORS );\r\n\r\n\tthis.vertexTextures = this.maxVertexTextures > 0;\r\n\tthis.floatFragmentTextures = !! extensions.get( 'OES_texture_float' );\r\n\tthis.floatVertexTextures = this.vertexTextures && this.floatFragmentTextures;\r\n\r\n\tvar _maxPrecision = getMaxPrecision( this.precision );\r\n\r\n\tif ( _maxPrecision !== this.precision ) {\r\n\r\n\t\tconsole.warn( 'THREE.WebGLRenderer:', this.precision, 'not supported, using', _maxPrecision, 'instead.' );\r\n\t\tthis.precision = _maxPrecision;\r\n\r\n\t}\r\n\r\n\tif ( this.logarithmicDepthBuffer ) {\r\n\r\n\t\tthis.logarithmicDepthBuffer = !! extensions.get( 'EXT_frag_depth' );\r\n\r\n\t}\r\n\r\n};\r\n\r\n// File:src/renderers/webgl/WebGLGeometries.js\r\n\r\n/**\r\n* @author mrdoob / http://mrdoob.com/\r\n*/\r\n\r\nTHREE.WebGLGeometries = function ( gl, properties, info ) {\r\n\r\n\tvar geometries = {};\r\n\r\n\tfunction get( object ) {\r\n\r\n\t\tvar geometry = object.geometry;\r\n\r\n\t\tif ( geometries[ geometry.id ] !== undefined ) {\r\n\r\n\t\t\treturn geometries[ geometry.id ];\r\n\r\n\t\t}\r\n\r\n\t\tgeometry.addEventListener( 'dispose', onGeometryDispose );\r\n\r\n\t\tvar buffergeometry;\r\n\r\n\t\tif ( geometry instanceof THREE.BufferGeometry ) {\r\n\r\n\t\t\tbuffergeometry = geometry;\r\n\r\n\t\t} else if ( geometry instanceof THREE.Geometry ) {\r\n\r\n\t\t\tif ( geometry._bufferGeometry === undefined ) {\r\n\r\n\t\t\t\tgeometry._bufferGeometry = new THREE.BufferGeometry().setFromObject( object );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tbuffergeometry = geometry._bufferGeometry;\r\n\r\n\t\t}\r\n\r\n\t\tgeometries[ geometry.id ] = buffergeometry;\r\n\r\n\t\tinfo.memory.geometries ++;\r\n\r\n\t\treturn buffergeometry;\r\n\r\n\t}\r\n\r\n\tfunction onGeometryDispose( event ) {\r\n\r\n\t\tvar geometry = event.target;\r\n\t\tvar buffergeometry = geometries[ geometry.id ];\r\n\r\n\t\tif ( buffergeometry.index !== null ) {\r\n\r\n\t\t\tdeleteAttribute( buffergeometry.index );\r\n\r\n\t\t}\r\n\r\n\t\tdeleteAttributes( buffergeometry.attributes );\r\n\r\n\t\tgeometry.removeEventListener( 'dispose', onGeometryDispose );\r\n\r\n\t\tdelete geometries[ geometry.id ];\r\n\r\n\t\t// TODO\r\n\r\n\t\tvar property = properties.get( geometry );\r\n\r\n\t\tif ( property.wireframe ) {\r\n\r\n\t\t\tdeleteAttribute( property.wireframe );\r\n\r\n\t\t}\r\n\r\n\t\tproperties.delete( geometry );\r\n\r\n\t\tvar bufferproperty = properties.get( buffergeometry );\r\n\r\n\t\tif ( bufferproperty.wireframe ) {\r\n\r\n\t\t\tdeleteAttribute( bufferproperty.wireframe );\r\n\r\n\t\t}\r\n\r\n\t\tproperties.delete( buffergeometry );\r\n\r\n\t\t//\r\n\r\n\t\tinfo.memory.geometries --;\r\n\r\n\t}\r\n\r\n\tfunction getAttributeBuffer( attribute ) {\r\n\r\n\t\tif ( attribute instanceof THREE.InterleavedBufferAttribute ) {\r\n\r\n\t\t\treturn properties.get( attribute.data ).__webglBuffer;\r\n\r\n\t\t}\r\n\r\n\t\treturn properties.get( attribute ).__webglBuffer;\r\n\r\n\t}\r\n\r\n\tfunction deleteAttribute( attribute ) {\r\n\r\n\t\tvar buffer = getAttributeBuffer( attribute );\r\n\r\n\t\tif ( buffer !== undefined ) {\r\n\r\n\t\t\tgl.deleteBuffer( buffer );\r\n\t\t\tremoveAttributeBuffer( attribute );\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tfunction deleteAttributes( attributes ) {\r\n\r\n\t\tfor ( var name in attributes ) {\r\n\r\n\t\t\tdeleteAttribute( attributes[ name ] );\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tfunction removeAttributeBuffer( attribute ) {\r\n\r\n\t\tif ( attribute instanceof THREE.InterleavedBufferAttribute ) {\r\n\r\n\t\t\tproperties.delete( attribute.data );\r\n\r\n\t\t} else {\r\n\r\n\t\t\tproperties.delete( attribute );\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tthis.get = get;\r\n\r\n};\r\n\r\n// File:src/renderers/webgl/WebGLLights.js\r\n\r\n/**\r\n* @author mrdoob / http://mrdoob.com/\r\n*/\r\n\r\nTHREE.WebGLLights = function () {\r\n\r\n\tvar lights = {};\r\n\r\n\tthis.get = function ( light ) {\r\n\r\n\t\tif ( lights[ light.id ] !== undefined ) {\r\n\r\n\t\t\treturn lights[ light.id ];\r\n\r\n\t\t}\r\n\r\n\t\tvar uniforms;\r\n\r\n\t\tswitch ( light.type ) {\r\n\r\n\t\t\tcase 'DirectionalLight':\r\n\t\t\t\tuniforms = {\r\n\t\t\t\t\tdirection: new THREE.Vector3(),\r\n\t\t\t\t\tcolor: new THREE.Color(),\r\n\r\n\t\t\t\t\tshadow: false,\r\n\t\t\t\t\tshadowBias: 0,\r\n\t\t\t\t\tshadowRadius: 1,\r\n\t\t\t\t\tshadowMapSize: new THREE.Vector2()\r\n\t\t\t\t};\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tcase 'SpotLight':\r\n\t\t\t\tuniforms = {\r\n\t\t\t\t\tposition: new THREE.Vector3(),\r\n\t\t\t\t\tdirection: new THREE.Vector3(),\r\n\t\t\t\t\tcolor: new THREE.Color(),\r\n\t\t\t\t\tdistance: 0,\r\n\t\t\t\t\tconeCos: 0,\r\n\t\t\t\t\tpenumbraCos: 0,\r\n\t\t\t\t\tdecay: 0,\r\n\r\n\t\t\t\t\tshadow: false,\r\n\t\t\t\t\tshadowBias: 0,\r\n\t\t\t\t\tshadowRadius: 1,\r\n\t\t\t\t\tshadowMapSize: new THREE.Vector2()\r\n\t\t\t\t};\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tcase 'PointLight':\r\n\t\t\t\tuniforms = {\r\n\t\t\t\t\tposition: new THREE.Vector3(),\r\n\t\t\t\t\tcolor: new THREE.Color(),\r\n\t\t\t\t\tdistance: 0,\r\n\t\t\t\t\tdecay: 0,\r\n\r\n\t\t\t\t\tshadow: false,\r\n\t\t\t\t\tshadowBias: 0,\r\n\t\t\t\t\tshadowRadius: 1,\r\n\t\t\t\t\tshadowMapSize: new THREE.Vector2()\r\n\t\t\t\t};\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tcase 'HemisphereLight':\r\n\t\t\t\tuniforms = {\r\n\t\t\t\t\tdirection: new THREE.Vector3(),\r\n\t\t\t\t\tskyColor: new THREE.Color(),\r\n\t\t\t\t\tgroundColor: new THREE.Color()\r\n\t\t\t\t};\r\n\t\t\t\tbreak;\r\n\r\n\t\t}\r\n\r\n\t\tlights[ light.id ] = uniforms;\r\n\r\n\t\treturn uniforms;\r\n\r\n\t};\r\n\r\n};\r\n\r\n// File:src/renderers/webgl/WebGLObjects.js\r\n\r\n/**\r\n* @author mrdoob / http://mrdoob.com/\r\n*/\r\n\r\nTHREE.WebGLObjects = function ( gl, properties, info ) {\r\n\r\n\tvar geometries = new THREE.WebGLGeometries( gl, properties, info );\r\n\r\n\t//\r\n\r\n\tfunction update( object ) {\r\n\r\n\t\t// TODO: Avoid updating twice (when using shadowMap). Maybe add frame counter.\r\n\r\n\t\tvar geometry = geometries.get( object );\r\n\r\n\t\tif ( object.geometry instanceof THREE.Geometry ) {\r\n\r\n\t\t\tgeometry.updateFromObject( object );\r\n\r\n\t\t}\r\n\r\n\t\tvar index = geometry.index;\r\n\t\tvar attributes = geometry.attributes;\r\n\r\n\t\tif ( index !== null ) {\r\n\r\n\t\t\tupdateAttribute( index, gl.ELEMENT_ARRAY_BUFFER );\r\n\r\n\t\t}\r\n\r\n\t\tfor ( var name in attributes ) {\r\n\r\n\t\t\tupdateAttribute( attributes[ name ], gl.ARRAY_BUFFER );\r\n\r\n\t\t}\r\n\r\n\t\t// morph targets\r\n\r\n\t\tvar morphAttributes = geometry.morphAttributes;\r\n\r\n\t\tfor ( var name in morphAttributes ) {\r\n\r\n\t\t\tvar array = morphAttributes[ name ];\r\n\r\n\t\t\tfor ( var i = 0, l = array.length; i < l; i ++ ) {\r\n\r\n\t\t\t\tupdateAttribute( array[ i ], gl.ARRAY_BUFFER );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\treturn geometry;\r\n\r\n\t}\r\n\r\n\tfunction updateAttribute( attribute, bufferType ) {\r\n\r\n\t\tvar data = ( attribute instanceof THREE.InterleavedBufferAttribute ) ? attribute.data : attribute;\r\n\r\n\t\tvar attributeProperties = properties.get( data );\r\n\r\n\t\tif ( attributeProperties.__webglBuffer === undefined ) {\r\n\r\n\t\t\tcreateBuffer( attributeProperties, data, bufferType );\r\n\r\n\t\t} else if ( attributeProperties.version !== data.version ) {\r\n\r\n\t\t\tupdateBuffer( attributeProperties, data, bufferType );\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tfunction createBuffer( attributeProperties, data, bufferType ) {\r\n\r\n\t\tattributeProperties.__webglBuffer = gl.createBuffer();\r\n\t\tgl.bindBuffer( bufferType, attributeProperties.__webglBuffer );\r\n\r\n\t\tvar usage = data.dynamic ? gl.DYNAMIC_DRAW : gl.STATIC_DRAW;\r\n\r\n\t\tgl.bufferData( bufferType, data.array, usage );\r\n\r\n\t\tattributeProperties.version = data.version;\r\n\r\n\t}\r\n\r\n\tfunction updateBuffer( attributeProperties, data, bufferType ) {\r\n\r\n\t\tgl.bindBuffer( bufferType, attributeProperties.__webglBuffer );\r\n\r\n\t\tif ( data.dynamic === false || data.updateRange.count === - 1 ) {\r\n\r\n\t\t\t// Not using update ranges\r\n\r\n\t\t\tgl.bufferSubData( bufferType, 0, data.array );\r\n\r\n\t\t} else if ( data.updateRange.count === 0 ) {\r\n\r\n\t\t\tconsole.error( 'THREE.WebGLObjects.updateBuffer: dynamic THREE.BufferAttribute marked as needsUpdate but updateRange.count is 0, ensure you are using set methods or updating manually.' );\r\n\r\n\t\t} else {\r\n\r\n\t\t\tgl.bufferSubData( bufferType, data.updateRange.offset * data.array.BYTES_PER_ELEMENT,\r\n\t\t\t\t\t\t\t  data.array.subarray( data.updateRange.offset, data.updateRange.offset + data.updateRange.count ) );\r\n\r\n\t\t\tdata.updateRange.count = 0; // reset range\r\n\r\n\t\t}\r\n\r\n\t\tattributeProperties.version = data.version;\r\n\r\n\t}\r\n\r\n\tfunction getAttributeBuffer( attribute ) {\r\n\r\n\t\tif ( attribute instanceof THREE.InterleavedBufferAttribute ) {\r\n\r\n\t\t\treturn properties.get( attribute.data ).__webglBuffer;\r\n\r\n\t\t}\r\n\r\n\t\treturn properties.get( attribute ).__webglBuffer;\r\n\r\n\t}\r\n\r\n\tfunction getWireframeAttribute( geometry ) {\r\n\r\n\t\tvar property = properties.get( geometry );\r\n\r\n\t\tif ( property.wireframe !== undefined ) {\r\n\r\n\t\t\treturn property.wireframe;\r\n\r\n\t\t}\r\n\r\n\t\tvar indices = [];\r\n\r\n\t\tvar index = geometry.index;\r\n\t\tvar attributes = geometry.attributes;\r\n\t\tvar position = attributes.position;\r\n\r\n\t\t// console.time( 'wireframe' );\r\n\r\n\t\tif ( index !== null ) {\r\n\r\n\t\t\tvar edges = {};\r\n\t\t\tvar array = index.array;\r\n\r\n\t\t\tfor ( var i = 0, l = array.length; i < l; i += 3 ) {\r\n\r\n\t\t\t\tvar a = array[ i + 0 ];\r\n\t\t\t\tvar b = array[ i + 1 ];\r\n\t\t\t\tvar c = array[ i + 2 ];\r\n\r\n\t\t\t\tif ( checkEdge( edges, a, b ) ) indices.push( a, b );\r\n\t\t\t\tif ( checkEdge( edges, b, c ) ) indices.push( b, c );\r\n\t\t\t\tif ( checkEdge( edges, c, a ) ) indices.push( c, a );\r\n\r\n\t\t\t}\r\n\r\n\t\t} else {\r\n\r\n\t\t\tvar array = attributes.position.array;\r\n\r\n\t\t\tfor ( var i = 0, l = ( array.length / 3 ) - 1; i < l; i += 3 ) {\r\n\r\n\t\t\t\tvar a = i + 0;\r\n\t\t\t\tvar b = i + 1;\r\n\t\t\t\tvar c = i + 2;\r\n\r\n\t\t\t\tindices.push( a, b, b, c, c, a );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\t// console.timeEnd( 'wireframe' );\r\n\r\n\t\tvar TypeArray = position.count > 65535 ? Uint32Array : Uint16Array;\r\n\t\tvar attribute = new THREE.BufferAttribute( new TypeArray( indices ), 1 );\r\n\r\n\t\tupdateAttribute( attribute, gl.ELEMENT_ARRAY_BUFFER );\r\n\r\n\t\tproperty.wireframe = attribute;\r\n\r\n\t\treturn attribute;\r\n\r\n\t}\r\n\r\n\tfunction checkEdge( edges, a, b ) {\r\n\r\n\t\tif ( a > b ) {\r\n\r\n\t\t\tvar tmp = a;\r\n\t\t\ta = b;\r\n\t\t\tb = tmp;\r\n\r\n\t\t}\r\n\r\n\t\tvar list = edges[ a ];\r\n\r\n\t\tif ( list === undefined ) {\r\n\r\n\t\t\tedges[ a ] = [ b ];\r\n\t\t\treturn true;\r\n\r\n\t\t} else if ( list.indexOf( b ) === -1 ) {\r\n\r\n\t\t\tlist.push( b );\r\n\t\t\treturn true;\r\n\r\n\t\t}\r\n\r\n\t\treturn false;\r\n\r\n\t}\r\n\r\n\tthis.getAttributeBuffer = getAttributeBuffer;\r\n\tthis.getWireframeAttribute = getWireframeAttribute;\r\n\r\n\tthis.update = update;\r\n\r\n};\r\n\r\n// File:src/renderers/webgl/WebGLProgram.js\r\n\r\nTHREE.WebGLProgram = ( function () {\r\n\r\n\tvar programIdCount = 0;\r\n\r\n\tfunction getEncodingComponents( encoding ) {\r\n\r\n\t\tswitch ( encoding ) {\r\n\r\n\t\t\tcase THREE.LinearEncoding:\r\n\t\t\t\treturn [ 'Linear','( value )' ];\r\n\t\t\tcase THREE.sRGBEncoding:\r\n\t\t\t\treturn [ 'sRGB','( value )' ];\r\n\t\t\tcase THREE.RGBEEncoding:\r\n\t\t\t\treturn [ 'RGBE','( value )' ];\r\n\t\t\tcase THREE.RGBM7Encoding:\r\n\t\t\t\treturn [ 'RGBM','( value, 7.0 )' ];\r\n\t\t\tcase THREE.RGBM16Encoding:\r\n\t\t\t\treturn [ 'RGBM','( value, 16.0 )' ];\r\n\t\t\tcase THREE.RGBDEncoding:\r\n\t\t\t\treturn [ 'RGBD','( value, 256.0 )' ];\r\n\t\t\tcase THREE.GammaEncoding:\r\n\t\t\t\treturn [ 'Gamma','( value, float( GAMMA_FACTOR ) )' ];\r\n\t\t\tdefault:\r\n\t\t\t\tthrow new Error( 'unsupported encoding: ' + encoding );\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tfunction getTexelDecodingFunction( functionName, encoding ) {\r\n\r\n\t\tvar components = getEncodingComponents( encoding );\r\n\t\treturn \"vec4 \" + functionName + \"( vec4 value ) { return \" + components[ 0 ] + \"ToLinear\" + components[ 1 ] + \"; }\";\r\n\r\n\t}\r\n\r\n\tfunction getTexelEncodingFunction( functionName, encoding ) {\r\n\r\n\t\tvar components = getEncodingComponents( encoding );\r\n\t\treturn \"vec4 \" + functionName + \"( vec4 value ) { return LinearTo\" + components[ 0 ] + components[ 1 ] + \"; }\";\r\n\r\n\t}\r\n\r\n\tfunction getToneMappingFunction( functionName, toneMapping ) {\r\n\r\n\t\tvar toneMappingName;\r\n\r\n\t\tswitch ( toneMapping ) {\r\n\r\n\t\t\tcase THREE.LinearToneMapping:\r\n\t\t\t\ttoneMappingName = \"Linear\";\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tcase THREE.ReinhardToneMapping:\r\n\t\t\t\ttoneMappingName = \"Reinhard\";\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tcase THREE.Uncharted2ToneMapping:\r\n\t\t\t\ttoneMappingName = \"Uncharted2\";\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tcase THREE.CineonToneMapping:\r\n\t\t\t\ttoneMappingName = \"OptimizedCineon\";\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tdefault:\r\n\t\t\t\tthrow new Error( 'unsupported toneMapping: ' + toneMapping );\r\n\r\n\t\t}\r\n\r\n\t\treturn \"vec3 \" + functionName + \"( vec3 color ) { return \" + toneMappingName + \"ToneMapping( color ); }\";\r\n\r\n\t}\r\n\r\n\tfunction generateExtensions( extensions, parameters, rendererExtensions ) {\r\n\r\n\t\textensions = extensions || {};\r\n\r\n\t\tvar chunks = [\r\n\t\t\t( extensions.derivatives || parameters.envMapCubeUV || parameters.bumpMap || parameters.normalMap || parameters.flatShading ) ? '#extension GL_OES_standard_derivatives : enable' : '',\r\n\t\t\t( extensions.fragDepth || parameters.logarithmicDepthBuffer ) && rendererExtensions.get( 'EXT_frag_depth' ) ? '#extension GL_EXT_frag_depth : enable' : '',\r\n\t\t\t( extensions.drawBuffers ) && rendererExtensions.get( 'WEBGL_draw_buffers' ) ? '#extension GL_EXT_draw_buffers : require' : '',\r\n\t\t\t( extensions.shaderTextureLOD || parameters.envMap ) && rendererExtensions.get( 'EXT_shader_texture_lod' ) ? '#extension GL_EXT_shader_texture_lod : enable' : '',\r\n\t\t];\r\n\r\n\t\treturn chunks.filter( filterEmptyLine ).join( '\\n' );\r\n\r\n\t}\r\n\r\n\tfunction generateDefines( defines ) {\r\n\r\n\t\tvar chunks = [];\r\n\r\n\t\tfor ( var name in defines ) {\r\n\r\n\t\t\tvar value = defines[ name ];\r\n\r\n\t\t\tif ( value === false ) continue;\r\n\r\n\t\t\tchunks.push( '#define ' + name + ' ' + value );\r\n\r\n\t\t}\r\n\r\n\t\treturn chunks.join( '\\n' );\r\n\r\n\t}\r\n\r\n\tfunction fetchAttributeLocations( gl, program, identifiers ) {\r\n\r\n\t\tvar attributes = {};\r\n\r\n\t\tvar n = gl.getProgramParameter( program, gl.ACTIVE_ATTRIBUTES );\r\n\r\n\t\tfor ( var i = 0; i < n; i ++ ) {\r\n\r\n\t\t\tvar info = gl.getActiveAttrib( program, i );\r\n\t\t\tvar name = info.name;\r\n\r\n\t\t\t// console.log(\"THREE.WebGLProgram: ACTIVE VERTEX ATTRIBUTE:\", name, i );\r\n\r\n\t\t\tattributes[ name ] = gl.getAttribLocation( program, name );\r\n\r\n\t\t}\r\n\r\n\t\treturn attributes;\r\n\r\n\t}\r\n\r\n\tfunction filterEmptyLine( string ) {\r\n\r\n\t\treturn string !== '';\r\n\r\n\t}\r\n\r\n\tfunction replaceLightNums( string, parameters ) {\r\n\r\n\t\treturn string\r\n\t\t\t.replace( /NUM_DIR_LIGHTS/g, parameters.numDirLights )\r\n\t\t\t.replace( /NUM_SPOT_LIGHTS/g, parameters.numSpotLights )\r\n\t\t\t.replace( /NUM_POINT_LIGHTS/g, parameters.numPointLights )\r\n\t\t\t.replace( /NUM_HEMI_LIGHTS/g, parameters.numHemiLights );\r\n\r\n\t}\r\n\r\n\tfunction parseIncludes( string ) {\r\n\r\n\t\tvar pattern = /#include +<([\\w\\d.]+)>/g;\r\n\r\n\t\tfunction replace( match, include ) {\r\n\r\n\t\t\tvar replace = THREE.ShaderChunk[ include ];\r\n\r\n\t\t\tif ( replace === undefined ) {\r\n\r\n\t\t\t\tthrow new Error( 'Can not resolve #include <' + include + '>' );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn parseIncludes( replace );\r\n\r\n\t\t}\r\n\r\n\t\treturn string.replace( pattern, replace );\r\n\r\n\t}\r\n\r\n\tfunction unrollLoops( string ) {\r\n\r\n\t\tvar pattern = /for \\( int i \\= (\\d+)\\; i < (\\d+)\\; i \\+\\+ \\) \\{([\\s\\S]+?)(?=\\})\\}/g;\r\n\r\n\t\tfunction replace( match, start, end, snippet ) {\r\n\r\n\t\t\tvar unroll = '';\r\n\r\n\t\t\tfor ( var i = parseInt( start ); i < parseInt( end ); i ++ ) {\r\n\r\n\t\t\t\tunroll += snippet.replace( /\\[ i \\]/g, '[ ' + i + ' ]' );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn unroll;\r\n\r\n\t\t}\r\n\r\n\t\treturn string.replace( pattern, replace );\r\n\r\n\t}\r\n\r\n\treturn function WebGLProgram( renderer, code, material, parameters ) {\r\n\r\n\t\tvar gl = renderer.context;\r\n\r\n\t\tvar extensions = material.extensions;\r\n\t\tvar defines = material.defines;\r\n\r\n\t\tvar vertexShader = material.__webglShader.vertexShader;\r\n\t\tvar fragmentShader = material.__webglShader.fragmentShader;\r\n\r\n\t\tvar shadowMapTypeDefine = 'SHADOWMAP_TYPE_BASIC';\r\n\r\n\t\tif ( parameters.shadowMapType === THREE.PCFShadowMap ) {\r\n\r\n\t\t\tshadowMapTypeDefine = 'SHADOWMAP_TYPE_PCF';\r\n\r\n\t\t} else if ( parameters.shadowMapType === THREE.PCFSoftShadowMap ) {\r\n\r\n\t\t\tshadowMapTypeDefine = 'SHADOWMAP_TYPE_PCF_SOFT';\r\n\r\n\t\t}\r\n\r\n\t\tvar envMapTypeDefine = 'ENVMAP_TYPE_CUBE';\r\n\t\tvar envMapModeDefine = 'ENVMAP_MODE_REFLECTION';\r\n\t\tvar envMapBlendingDefine = 'ENVMAP_BLENDING_MULTIPLY';\r\n\r\n\t\tif ( parameters.envMap ) {\r\n\r\n\t\t\tswitch ( material.envMap.mapping ) {\r\n\r\n\t\t\t\tcase THREE.CubeReflectionMapping:\r\n\t\t\t\tcase THREE.CubeRefractionMapping:\r\n\t\t\t\t\tenvMapTypeDefine = 'ENVMAP_TYPE_CUBE';\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase THREE.CubeUVReflectionMapping:\r\n\t\t\t\tcase THREE.CubeUVRefractionMapping:\r\n\t\t\t\t\tenvMapTypeDefine = 'ENVMAP_TYPE_CUBE_UV';\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase THREE.EquirectangularReflectionMapping:\r\n\t\t\t\tcase THREE.EquirectangularRefractionMapping:\r\n\t\t\t\t\tenvMapTypeDefine = 'ENVMAP_TYPE_EQUIREC';\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase THREE.SphericalReflectionMapping:\r\n\t\t\t\t\tenvMapTypeDefine = 'ENVMAP_TYPE_SPHERE';\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tswitch ( material.envMap.mapping ) {\r\n\r\n\t\t\t\tcase THREE.CubeRefractionMapping:\r\n\t\t\t\tcase THREE.EquirectangularRefractionMapping:\r\n\t\t\t\t\tenvMapModeDefine = 'ENVMAP_MODE_REFRACTION';\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tswitch ( material.combine ) {\r\n\r\n\t\t\t\tcase THREE.MultiplyOperation:\r\n\t\t\t\t\tenvMapBlendingDefine = 'ENVMAP_BLENDING_MULTIPLY';\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase THREE.MixOperation:\r\n\t\t\t\t\tenvMapBlendingDefine = 'ENVMAP_BLENDING_MIX';\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase THREE.AddOperation:\r\n\t\t\t\t\tenvMapBlendingDefine = 'ENVMAP_BLENDING_ADD';\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tvar gammaFactorDefine = ( renderer.gammaFactor > 0 ) ? renderer.gammaFactor : 1.0;\r\n\r\n\t\t// console.log( 'building new program ' );\r\n\r\n\t\t//\r\n\r\n\t\tvar customExtensions = generateExtensions( extensions, parameters, renderer.extensions );\r\n\r\n\t\tvar customDefines = generateDefines( defines );\r\n\r\n\t\t//\r\n\r\n\t\tvar program = gl.createProgram();\r\n\r\n\t\tvar prefixVertex, prefixFragment;\r\n\r\n\t\tif ( material instanceof THREE.RawShaderMaterial ) {\r\n\r\n\t\t\tprefixVertex = '';\r\n\t\t\tprefixFragment = '';\r\n\r\n\t\t} else {\r\n\r\n\t\t\tprefixVertex = [\r\n\r\n\t\t\t\t'precision ' + parameters.precision + ' float;',\r\n\t\t\t\t'precision ' + parameters.precision + ' int;',\r\n\r\n\t\t\t\t'#define SHADER_NAME ' + material.__webglShader.name,\r\n\r\n\t\t\t\tcustomDefines,\r\n\r\n\t\t\t\tparameters.supportsVertexTextures ? '#define VERTEX_TEXTURES' : '',\r\n\r\n\t\t\t\t'#define GAMMA_FACTOR ' + gammaFactorDefine,\r\n\r\n\t\t\t\t'#define MAX_BONES ' + parameters.maxBones,\r\n\r\n\t\t\t\tparameters.map ? '#define USE_MAP' : '',\r\n\t\t\t\tparameters.envMap ? '#define USE_ENVMAP' : '',\r\n\t\t\t\tparameters.envMap ? '#define ' + envMapModeDefine : '',\r\n\t\t\t\tparameters.lightMap ? '#define USE_LIGHTMAP' : '',\r\n\t\t\t\tparameters.aoMap ? '#define USE_AOMAP' : '',\r\n\t\t\t\tparameters.emissiveMap ? '#define USE_EMISSIVEMAP' : '',\r\n\t\t\t\tparameters.bumpMap ? '#define USE_BUMPMAP' : '',\r\n\t\t\t\tparameters.normalMap ? '#define USE_NORMALMAP' : '',\r\n\t\t\t\tparameters.displacementMap && parameters.supportsVertexTextures ? '#define USE_DISPLACEMENTMAP' : '',\r\n\t\t\t\tparameters.specularMap ? '#define USE_SPECULARMAP' : '',\r\n\t\t\t\tparameters.roughnessMap ? '#define USE_ROUGHNESSMAP' : '',\r\n\t\t\t\tparameters.metalnessMap ? '#define USE_METALNESSMAP' : '',\r\n\t\t\t\tparameters.alphaMap ? '#define USE_ALPHAMAP' : '',\r\n\t\t\t\tparameters.vertexColors ? '#define USE_COLOR' : '',\r\n\r\n\t\t\t\tparameters.flatShading ? '#define FLAT_SHADED' : '',\r\n\r\n\t\t\t\tparameters.skinning ? '#define USE_SKINNING' : '',\r\n\t\t\t\tparameters.useVertexTexture ? '#define BONE_TEXTURE' : '',\r\n\r\n\t\t\t\tparameters.morphTargets ? '#define USE_MORPHTARGETS' : '',\r\n\t\t\t\tparameters.morphNormals && parameters.flatShading === false ? '#define USE_MORPHNORMALS' : '',\r\n\t\t\t\tparameters.doubleSided ? '#define DOUBLE_SIDED' : '',\r\n\t\t\t\tparameters.flipSided ? '#define FLIP_SIDED' : '',\r\n\r\n\t\t\t\t'#define NUM_CLIPPING_PLANES ' + parameters.numClippingPlanes,\r\n\r\n\t\t\t\tparameters.shadowMapEnabled ? '#define USE_SHADOWMAP' : '',\r\n\t\t\t\tparameters.shadowMapEnabled ? '#define ' + shadowMapTypeDefine : '',\r\n\r\n\t\t\t\tparameters.sizeAttenuation ? '#define USE_SIZEATTENUATION' : '',\r\n\r\n\t\t\t\tparameters.logarithmicDepthBuffer ? '#define USE_LOGDEPTHBUF' : '',\r\n\t\t\t\tparameters.logarithmicDepthBuffer && renderer.extensions.get( 'EXT_frag_depth' ) ? '#define USE_LOGDEPTHBUF_EXT' : '',\r\n\r\n\t\t\t\t'uniform mat4 modelMatrix;',\r\n\t\t\t\t'uniform mat4 modelViewMatrix;',\r\n\t\t\t\t'uniform mat4 projectionMatrix;',\r\n\t\t\t\t'uniform mat4 viewMatrix;',\r\n\t\t\t\t'uniform mat3 normalMatrix;',\r\n\t\t\t\t'uniform vec3 cameraPosition;',\r\n\r\n\t\t\t\t'attribute vec3 position;',\r\n\t\t\t\t'attribute vec3 normal;',\r\n\t\t\t\t'attribute vec2 uv;',\r\n\r\n\t\t\t\t'#ifdef USE_COLOR',\r\n\r\n\t\t\t\t'\tattribute vec3 color;',\r\n\r\n\t\t\t\t'#endif',\r\n\r\n\t\t\t\t'#ifdef USE_MORPHTARGETS',\r\n\r\n\t\t\t\t'\tattribute vec3 morphTarget0;',\r\n\t\t\t\t'\tattribute vec3 morphTarget1;',\r\n\t\t\t\t'\tattribute vec3 morphTarget2;',\r\n\t\t\t\t'\tattribute vec3 morphTarget3;',\r\n\r\n\t\t\t\t'\t#ifdef USE_MORPHNORMALS',\r\n\r\n\t\t\t\t'\t\tattribute vec3 morphNormal0;',\r\n\t\t\t\t'\t\tattribute vec3 morphNormal1;',\r\n\t\t\t\t'\t\tattribute vec3 morphNormal2;',\r\n\t\t\t\t'\t\tattribute vec3 morphNormal3;',\r\n\r\n\t\t\t\t'\t#else',\r\n\r\n\t\t\t\t'\t\tattribute vec3 morphTarget4;',\r\n\t\t\t\t'\t\tattribute vec3 morphTarget5;',\r\n\t\t\t\t'\t\tattribute vec3 morphTarget6;',\r\n\t\t\t\t'\t\tattribute vec3 morphTarget7;',\r\n\r\n\t\t\t\t'\t#endif',\r\n\r\n\t\t\t\t'#endif',\r\n\r\n\t\t\t\t'#ifdef USE_SKINNING',\r\n\r\n\t\t\t\t'\tattribute vec4 skinIndex;',\r\n\t\t\t\t'\tattribute vec4 skinWeight;',\r\n\r\n\t\t\t\t'#endif',\r\n\r\n\t\t\t\t'\\n'\r\n\r\n\t\t\t].filter( filterEmptyLine ).join( '\\n' );\r\n\r\n\t\t\tprefixFragment = [\r\n\r\n\t\t\t\tcustomExtensions,\r\n\r\n\t\t\t\t'precision ' + parameters.precision + ' float;',\r\n\t\t\t\t'precision ' + parameters.precision + ' int;',\r\n\r\n\t\t\t\t'#define SHADER_NAME ' + material.__webglShader.name,\r\n\r\n\t\t\t\tcustomDefines,\r\n\r\n\t\t\t\tparameters.alphaTest ? '#define ALPHATEST ' + parameters.alphaTest : '',\r\n\r\n\t\t\t\t'#define GAMMA_FACTOR ' + gammaFactorDefine,\r\n\r\n\t\t\t\t( parameters.useFog && parameters.fog ) ? '#define USE_FOG' : '',\r\n\t\t\t\t( parameters.useFog && parameters.fogExp ) ? '#define FOG_EXP2' : '',\r\n\r\n\t\t\t\tparameters.map ? '#define USE_MAP' : '',\r\n\t\t\t\tparameters.envMap ? '#define USE_ENVMAP' : '',\r\n\t\t\t\tparameters.envMap ? '#define ' + envMapTypeDefine : '',\r\n\t\t\t\tparameters.envMap ? '#define ' + envMapModeDefine : '',\r\n\t\t\t\tparameters.envMap ? '#define ' + envMapBlendingDefine : '',\r\n\t\t\t\tparameters.lightMap ? '#define USE_LIGHTMAP' : '',\r\n\t\t\t\tparameters.aoMap ? '#define USE_AOMAP' : '',\r\n\t\t\t\tparameters.emissiveMap ? '#define USE_EMISSIVEMAP' : '',\r\n\t\t\t\tparameters.bumpMap ? '#define USE_BUMPMAP' : '',\r\n\t\t\t\tparameters.normalMap ? '#define USE_NORMALMAP' : '',\r\n\t\t\t\tparameters.specularMap ? '#define USE_SPECULARMAP' : '',\r\n\t\t\t\tparameters.roughnessMap ? '#define USE_ROUGHNESSMAP' : '',\r\n\t\t\t\tparameters.metalnessMap ? '#define USE_METALNESSMAP' : '',\r\n\t\t\t\tparameters.alphaMap ? '#define USE_ALPHAMAP' : '',\r\n\t\t\t\tparameters.vertexColors ? '#define USE_COLOR' : '',\r\n\r\n\t\t\t\tparameters.flatShading ? '#define FLAT_SHADED' : '',\r\n\r\n\t\t\t\tparameters.doubleSided ? '#define DOUBLE_SIDED' : '',\r\n\t\t\t\tparameters.flipSided ? '#define FLIP_SIDED' : '',\r\n\r\n\t\t\t\t'#define NUM_CLIPPING_PLANES ' + parameters.numClippingPlanes,\r\n\r\n\t\t\t\tparameters.shadowMapEnabled ? '#define USE_SHADOWMAP' : '',\r\n\t\t\t\tparameters.shadowMapEnabled ? '#define ' + shadowMapTypeDefine : '',\r\n\r\n\t\t\t\tparameters.premultipliedAlpha ? \"#define PREMULTIPLIED_ALPHA\" : '',\r\n\r\n\t\t\t\tparameters.physicallyCorrectLights ? \"#define PHYSICALLY_CORRECT_LIGHTS\" : '',\r\n\r\n\t\t\t\tparameters.logarithmicDepthBuffer ? '#define USE_LOGDEPTHBUF' : '',\r\n\t\t\t\tparameters.logarithmicDepthBuffer && renderer.extensions.get( 'EXT_frag_depth' ) ? '#define USE_LOGDEPTHBUF_EXT' : '',\r\n\r\n\t\t\t\tparameters.envMap && renderer.extensions.get( 'EXT_shader_texture_lod' ) ? '#define TEXTURE_LOD_EXT' : '',\r\n\r\n\t\t\t\t'uniform mat4 viewMatrix;',\r\n\t\t\t\t'uniform vec3 cameraPosition;',\r\n\r\n\t\t\t\t( parameters.toneMapping !== THREE.NoToneMapping ) ? \"#define TONE_MAPPING\" : '',\r\n\t\t\t\t( parameters.toneMapping !== THREE.NoToneMapping ) ? THREE.ShaderChunk[ 'tonemapping_pars_fragment' ] : '',  // this code is required here because it is used by the toneMapping() function defined below\r\n\t\t\t\t( parameters.toneMapping !== THREE.NoToneMapping ) ? getToneMappingFunction( \"toneMapping\", parameters.toneMapping ) : '',\r\n\r\n\t\t\t\t( parameters.outputEncoding || parameters.mapEncoding || parameters.envMapEncoding || parameters.emissiveMapEncoding ) ? THREE.ShaderChunk[ 'encodings_pars_fragment' ] : '', // this code is required here because it is used by the various encoding/decoding function defined below\r\n\t\t\t\tparameters.mapEncoding ? getTexelDecodingFunction( 'mapTexelToLinear', parameters.mapEncoding ) : '',\r\n\t\t\t\tparameters.envMapEncoding ? getTexelDecodingFunction( 'envMapTexelToLinear', parameters.envMapEncoding ) : '',\r\n\t\t\t\tparameters.emissiveMapEncoding ? getTexelDecodingFunction( 'emissiveMapTexelToLinear', parameters.emissiveMapEncoding ) : '',\r\n\t\t\t\tparameters.outputEncoding ? getTexelEncodingFunction( \"linearToOutputTexel\", parameters.outputEncoding ) : '',\r\n\r\n\t\t\t\tparameters.depthPacking ? \"#define DEPTH_PACKING \" + material.depthPacking : '',\r\n\r\n\t\t\t\t'\\n'\r\n\r\n\t\t\t].filter( filterEmptyLine ).join( '\\n' );\r\n\r\n\t\t}\r\n\r\n\t\tvertexShader = parseIncludes( vertexShader, parameters );\r\n\t\tvertexShader = replaceLightNums( vertexShader, parameters );\r\n\r\n\t\tfragmentShader = parseIncludes( fragmentShader, parameters );\r\n\t\tfragmentShader = replaceLightNums( fragmentShader, parameters );\r\n\r\n\t\tif ( material instanceof THREE.ShaderMaterial === false ) {\r\n\r\n\t\t\tvertexShader = unrollLoops( vertexShader );\r\n\t\t\tfragmentShader = unrollLoops( fragmentShader );\r\n\r\n\t\t}\r\n\r\n\t\tvar vertexGlsl = prefixVertex + vertexShader;\r\n\t\tvar fragmentGlsl = prefixFragment + fragmentShader;\r\n\r\n\t\t// console.log( '*VERTEX*', vertexGlsl );\r\n\t\t// console.log( '*FRAGMENT*', fragmentGlsl );\r\n\r\n\t\tvar glVertexShader = THREE.WebGLShader( gl, gl.VERTEX_SHADER, vertexGlsl );\r\n\t\tvar glFragmentShader = THREE.WebGLShader( gl, gl.FRAGMENT_SHADER, fragmentGlsl );\r\n\r\n\t\tgl.attachShader( program, glVertexShader );\r\n\t\tgl.attachShader( program, glFragmentShader );\r\n\r\n\t\t// Force a particular attribute to index 0.\r\n\r\n\t\tif ( material.index0AttributeName !== undefined ) {\r\n\r\n\t\t\tgl.bindAttribLocation( program, 0, material.index0AttributeName );\r\n\r\n\t\t} else if ( parameters.morphTargets === true ) {\r\n\r\n\t\t\t// programs with morphTargets displace position out of attribute 0\r\n\t\t\tgl.bindAttribLocation( program, 0, 'position' );\r\n\r\n\t\t}\r\n\r\n\t\tgl.linkProgram( program );\r\n\r\n\t\tvar programLog = gl.getProgramInfoLog( program );\r\n\t\tvar vertexLog = gl.getShaderInfoLog( glVertexShader );\r\n\t\tvar fragmentLog = gl.getShaderInfoLog( glFragmentShader );\r\n\r\n\t\tvar runnable = true;\r\n\t\tvar haveDiagnostics = true;\r\n\r\n\t\t// console.log( '**VERTEX**', gl.getExtension( 'WEBGL_debug_shaders' ).getTranslatedShaderSource( glVertexShader ) );\r\n\t\t// console.log( '**FRAGMENT**', gl.getExtension( 'WEBGL_debug_shaders' ).getTranslatedShaderSource( glFragmentShader ) );\r\n\r\n\t\tif ( gl.getProgramParameter( program, gl.LINK_STATUS ) === false ) {\r\n\r\n\t\t\trunnable = false;\r\n\r\n\t\t\tconsole.error( 'THREE.WebGLProgram: shader error: ', gl.getError(), 'gl.VALIDATE_STATUS', gl.getProgramParameter( program, gl.VALIDATE_STATUS ), 'gl.getProgramInfoLog', programLog, vertexLog, fragmentLog );\r\n\r\n\t\t} else if ( programLog !== '' ) {\r\n\r\n\t\t\tconsole.warn( 'THREE.WebGLProgram: gl.getProgramInfoLog()', programLog );\r\n\r\n\t\t} else if ( vertexLog === '' || fragmentLog === '' ) {\r\n\r\n\t\t\thaveDiagnostics = false;\r\n\r\n\t\t}\r\n\r\n\t\tif ( haveDiagnostics ) {\r\n\r\n\t\t\tthis.diagnostics = {\r\n\r\n\t\t\t\trunnable: runnable,\r\n\t\t\t\tmaterial: material,\r\n\r\n\t\t\t\tprogramLog: programLog,\r\n\r\n\t\t\t\tvertexShader: {\r\n\r\n\t\t\t\t\tlog: vertexLog,\r\n\t\t\t\t\tprefix: prefixVertex\r\n\r\n\t\t\t\t},\r\n\r\n\t\t\t\tfragmentShader: {\r\n\r\n\t\t\t\t\tlog: fragmentLog,\r\n\t\t\t\t\tprefix: prefixFragment\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t};\r\n\r\n\t\t}\r\n\r\n\t\t// clean up\r\n\r\n\t\tgl.deleteShader( glVertexShader );\r\n\t\tgl.deleteShader( glFragmentShader );\r\n\r\n\t\t// set up caching for uniform locations\r\n\r\n\t\tvar cachedUniforms;\r\n\r\n\t\tthis.getUniforms = function() {\r\n\r\n\t\t\tif ( cachedUniforms === undefined ) {\r\n\r\n\t\t\t\tcachedUniforms =\r\n\t\t\t\t\t\tnew THREE.WebGLUniforms( gl, program, renderer );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn cachedUniforms;\r\n\r\n\t\t};\r\n\r\n\t\t// set up caching for attribute locations\r\n\r\n\t\tvar cachedAttributes;\r\n\r\n\t\tthis.getAttributes = function() {\r\n\r\n\t\t\tif ( cachedAttributes === undefined ) {\r\n\r\n\t\t\t\tcachedAttributes = fetchAttributeLocations( gl, program );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn cachedAttributes;\r\n\r\n\t\t};\r\n\r\n\t\t// free resource\r\n\r\n\t\tthis.destroy = function() {\r\n\r\n\t\t\tgl.deleteProgram( program );\r\n\t\t\tthis.program = undefined;\r\n\r\n\t\t};\r\n\r\n\t\t// DEPRECATED\r\n\r\n\t\tObject.defineProperties( this, {\r\n\r\n\t\t\tuniforms: {\r\n\t\t\t\tget: function() {\r\n\r\n\t\t\t\t\tconsole.warn( 'THREE.WebGLProgram: .uniforms is now .getUniforms().' );\r\n\t\t\t\t\treturn this.getUniforms();\r\n\r\n\t\t\t\t}\r\n\t\t\t},\r\n\r\n\t\t\tattributes: {\r\n\t\t\t\tget: function() {\r\n\r\n\t\t\t\t\tconsole.warn( 'THREE.WebGLProgram: .attributes is now .getAttributes().' );\r\n\t\t\t\t\treturn this.getAttributes();\r\n\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t} );\r\n\r\n\r\n\t\t//\r\n\r\n\t\tthis.id = programIdCount ++;\r\n\t\tthis.code = code;\r\n\t\tthis.usedTimes = 1;\r\n\t\tthis.program = program;\r\n\t\tthis.vertexShader = glVertexShader;\r\n\t\tthis.fragmentShader = glFragmentShader;\r\n\r\n\t\treturn this;\r\n\r\n\t};\r\n\r\n} )();\r\n\r\n// File:src/renderers/webgl/WebGLPrograms.js\r\n\r\nTHREE.WebGLPrograms = function ( renderer, capabilities ) {\r\n\r\n\tvar programs = [];\r\n\r\n\tvar shaderIDs = {\r\n\t\tMeshDepthMaterial: 'depth',\r\n\t\tMeshNormalMaterial: 'normal',\r\n\t\tMeshBasicMaterial: 'basic',\r\n\t\tMeshLambertMaterial: 'lambert',\r\n\t\tMeshPhongMaterial: 'phong',\r\n\t\tMeshStandardMaterial: 'physical',\r\n\t\tMeshPhysicalMaterial: 'physical',\r\n\t\tLineBasicMaterial: 'basic',\r\n\t\tLineDashedMaterial: 'dashed',\r\n\t\tPointsMaterial: 'points'\r\n\t};\r\n\r\n\tvar parameterNames = [\r\n\t\t\"precision\", \"supportsVertexTextures\", \"map\", \"mapEncoding\", \"envMap\", \"envMapMode\", \"envMapEncoding\",\r\n\t\t\"lightMap\", \"aoMap\", \"emissiveMap\", \"emissiveMapEncoding\", \"bumpMap\", \"normalMap\", \"displacementMap\", \"specularMap\",\r\n\t\t\"roughnessMap\", \"metalnessMap\",\r\n\t\t\"alphaMap\", \"combine\", \"vertexColors\", \"fog\", \"useFog\", \"fogExp\",\r\n\t\t\"flatShading\", \"sizeAttenuation\", \"logarithmicDepthBuffer\", \"skinning\",\r\n\t\t\"maxBones\", \"useVertexTexture\", \"morphTargets\", \"morphNormals\",\r\n\t\t\"maxMorphTargets\", \"maxMorphNormals\", \"premultipliedAlpha\",\r\n\t\t\"numDirLights\", \"numPointLights\", \"numSpotLights\", \"numHemiLights\",\r\n\t\t\"shadowMapEnabled\", \"shadowMapType\", \"toneMapping\", 'physicallyCorrectLights',\r\n\t\t\"alphaTest\", \"doubleSided\", \"flipSided\", \"numClippingPlanes\", \"depthPacking\"\r\n\t];\r\n\r\n\r\n\tfunction allocateBones ( object ) {\r\n\r\n\t\tif ( capabilities.floatVertexTextures && object && object.skeleton && object.skeleton.useVertexTexture ) {\r\n\r\n\t\t\treturn 1024;\r\n\r\n\t\t} else {\r\n\r\n\t\t\t// default for when object is not specified\r\n\t\t\t// ( for example when prebuilding shader to be used with multiple objects )\r\n\t\t\t//\r\n\t\t\t//  - leave some extra space for other uniforms\r\n\t\t\t//  - limit here is ANGLE's 254 max uniform vectors\r\n\t\t\t//    (up to 54 should be safe)\r\n\r\n\t\t\tvar nVertexUniforms = capabilities.maxVertexUniforms;\r\n\t\t\tvar nVertexMatrices = Math.floor( ( nVertexUniforms - 20 ) / 4 );\r\n\r\n\t\t\tvar maxBones = nVertexMatrices;\r\n\r\n\t\t\tif ( object !== undefined && object instanceof THREE.SkinnedMesh ) {\r\n\r\n\t\t\t\tmaxBones = Math.min( object.skeleton.bones.length, maxBones );\r\n\r\n\t\t\t\tif ( maxBones < object.skeleton.bones.length ) {\r\n\r\n\t\t\t\t\tconsole.warn( 'WebGLRenderer: too many bones - ' + object.skeleton.bones.length + ', this GPU supports just ' + maxBones + ' (try OpenGL instead of ANGLE)' );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn maxBones;\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tfunction getTextureEncodingFromMap( map, gammaOverrideLinear ) {\r\n\r\n\t\tvar encoding;\r\n\r\n\t\tif ( ! map ) {\r\n\r\n\t\t\tencoding = THREE.LinearEncoding;\r\n\r\n\t\t} else if ( map instanceof THREE.Texture ) {\r\n\r\n\t\t\tencoding = map.encoding;\r\n\r\n\t\t} else if ( map instanceof THREE.WebGLRenderTarget ) {\r\n\r\n\t\t\tencoding = map.texture.encoding;\r\n\r\n\t\t}\r\n\r\n\t\t// add backwards compatibility for WebGLRenderer.gammaInput/gammaOutput parameter, should probably be removed at some point.\r\n\t\tif ( encoding === THREE.LinearEncoding && gammaOverrideLinear ) {\r\n\r\n\t\t\tencoding = THREE.GammaEncoding;\r\n\r\n\t\t}\r\n\r\n\t\treturn encoding;\r\n\r\n\t}\r\n\r\n\tthis.getParameters = function ( material, lights, fog, nClipPlanes, object ) {\r\n\r\n\t\tvar shaderID = shaderIDs[ material.type ];\r\n\r\n\t\t// heuristics to create shader parameters according to lights in the scene\r\n\t\t// (not to blow over maxLights budget)\r\n\r\n\t\tvar maxBones = allocateBones( object );\r\n\t\tvar precision = renderer.getPrecision();\r\n\r\n\t\tif ( material.precision !== null ) {\r\n\r\n\t\t\tprecision = capabilities.getMaxPrecision( material.precision );\r\n\r\n\t\t\tif ( precision !== material.precision ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.WebGLProgram.getParameters:', material.precision, 'not supported, using', precision, 'instead.' );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tvar parameters = {\r\n\r\n\t\t\tshaderID: shaderID,\r\n\r\n\t\t\tprecision: precision,\r\n\t\t\tsupportsVertexTextures: capabilities.vertexTextures,\r\n\t\t\toutputEncoding: getTextureEncodingFromMap( renderer.getCurrentRenderTarget(), renderer.gammaOutput ),\r\n\t\t\tmap: !! material.map,\r\n\t\t\tmapEncoding: getTextureEncodingFromMap( material.map, renderer.gammaInput ),\r\n\t\t\tenvMap: !! material.envMap,\r\n\t\t\tenvMapMode: material.envMap && material.envMap.mapping,\r\n\t\t\tenvMapEncoding: getTextureEncodingFromMap( material.envMap, renderer.gammaInput ),\r\n\t\t\tenvMapCubeUV: ( !! material.envMap ) && ( ( material.envMap.mapping === THREE.CubeUVReflectionMapping ) || ( material.envMap.mapping === THREE.CubeUVRefractionMapping ) ),\r\n\t\t\tlightMap: !! material.lightMap,\r\n\t\t\taoMap: !! material.aoMap,\r\n\t\t\temissiveMap: !! material.emissiveMap,\r\n\t\t\temissiveMapEncoding: getTextureEncodingFromMap( material.emissiveMap, renderer.gammaInput ),\r\n\t\t\tbumpMap: !! material.bumpMap,\r\n\t\t\tnormalMap: !! material.normalMap,\r\n\t\t\tdisplacementMap: !! material.displacementMap,\r\n\t\t\troughnessMap: !! material.roughnessMap,\r\n\t\t\tmetalnessMap: !! material.metalnessMap,\r\n\t\t\tspecularMap: !! material.specularMap,\r\n\t\t\talphaMap: !! material.alphaMap,\r\n\r\n\t\t\tcombine: material.combine,\r\n\r\n\t\t\tvertexColors: material.vertexColors,\r\n\r\n\t\t\tfog: fog,\r\n\t\t\tuseFog: material.fog,\r\n\t\t\tfogExp: fog instanceof THREE.FogExp2,\r\n\r\n\t\t\tflatShading: material.shading === THREE.FlatShading,\r\n\r\n\t\t\tsizeAttenuation: material.sizeAttenuation,\r\n\t\t\tlogarithmicDepthBuffer: capabilities.logarithmicDepthBuffer,\r\n\r\n\t\t\tskinning: material.skinning,\r\n\t\t\tmaxBones: maxBones,\r\n\t\t\tuseVertexTexture: capabilities.floatVertexTextures && object && object.skeleton && object.skeleton.useVertexTexture,\r\n\r\n\t\t\tmorphTargets: material.morphTargets,\r\n\t\t\tmorphNormals: material.morphNormals,\r\n\t\t\tmaxMorphTargets: renderer.maxMorphTargets,\r\n\t\t\tmaxMorphNormals: renderer.maxMorphNormals,\r\n\r\n\t\t\tnumDirLights: lights.directional.length,\r\n\t\t\tnumPointLights: lights.point.length,\r\n\t\t\tnumSpotLights: lights.spot.length,\r\n\t\t\tnumHemiLights: lights.hemi.length,\r\n\r\n\t\t\tnumClippingPlanes: nClipPlanes,\r\n\r\n\t\t\tshadowMapEnabled: renderer.shadowMap.enabled && object.receiveShadow && lights.shadows.length > 0,\r\n\t\t\tshadowMapType: renderer.shadowMap.type,\r\n\r\n\t\t\ttoneMapping: renderer.toneMapping,\r\n\t\t\tphysicallyCorrectLights: renderer.physicallyCorrectLights,\r\n\r\n\t\t\tpremultipliedAlpha: material.premultipliedAlpha,\r\n\r\n\t\t\talphaTest: material.alphaTest,\r\n\t\t\tdoubleSided: material.side === THREE.DoubleSide,\r\n\t\t\tflipSided: material.side === THREE.BackSide,\r\n\r\n\t\t\tdepthPacking: ( material.depthPacking !== undefined ) ? material.depthPacking : false\r\n\r\n\t\t};\r\n\r\n\t\treturn parameters;\r\n\r\n\t};\r\n\r\n\tthis.getProgramCode = function ( material, parameters ) {\r\n\r\n\t\tvar array = [];\r\n\r\n\t\tif ( parameters.shaderID ) {\r\n\r\n\t\t\tarray.push( parameters.shaderID );\r\n\r\n\t\t} else {\r\n\r\n\t\t\tarray.push( material.fragmentShader );\r\n\t\t\tarray.push( material.vertexShader );\r\n\r\n\t\t}\r\n\r\n\t\tif ( material.defines !== undefined ) {\r\n\r\n\t\t\tfor ( var name in material.defines ) {\r\n\r\n\t\t\t\tarray.push( name );\r\n\t\t\t\tarray.push( material.defines[ name ] );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tfor ( var i = 0; i < parameterNames.length; i ++ ) {\r\n\r\n\t\t\tarray.push( parameters[ parameterNames[ i ] ] );\r\n\r\n\t\t}\r\n\r\n\t\treturn array.join();\r\n\r\n\t};\r\n\r\n\tthis.acquireProgram = function ( material, parameters, code ) {\r\n\r\n\t\tvar program;\r\n\r\n\t\t// Check if code has been already compiled\r\n\t\tfor ( var p = 0, pl = programs.length; p < pl; p ++ ) {\r\n\r\n\t\t\tvar programInfo = programs[ p ];\r\n\r\n\t\t\tif ( programInfo.code === code ) {\r\n\r\n\t\t\t\tprogram = programInfo;\r\n\t\t\t\t++ program.usedTimes;\r\n\r\n\t\t\t\tbreak;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tif ( program === undefined ) {\r\n\r\n\t\t\tprogram = new THREE.WebGLProgram( renderer, code, material, parameters );\r\n\t\t\tprograms.push( program );\r\n\r\n\t\t}\r\n\r\n\t\treturn program;\r\n\r\n\t};\r\n\r\n\tthis.releaseProgram = function( program ) {\r\n\r\n\t\tif ( -- program.usedTimes === 0 ) {\r\n\r\n\t\t\t// Remove from unordered set\r\n\t\t\tvar i = programs.indexOf( program );\r\n\t\t\tprograms[ i ] = programs[ programs.length - 1 ];\r\n\t\t\tprograms.pop();\r\n\r\n\t\t\t// Free WebGL resources\r\n\t\t\tprogram.destroy();\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n\t// Exposed for resource monitoring & error feedback via renderer.info:\r\n\tthis.programs = programs;\r\n\r\n};\r\n\r\n// File:src/renderers/webgl/WebGLProperties.js\r\n\r\n/**\r\n* @author fordacious / fordacious.github.io\r\n*/\r\n\r\nTHREE.WebGLProperties = function () {\r\n\r\n\tvar properties = {};\r\n\r\n\tthis.get = function ( object ) {\r\n\r\n\t\tvar uuid = object.uuid;\r\n\t\tvar map = properties[ uuid ];\r\n\r\n\t\tif ( map === undefined ) {\r\n\r\n\t\t\tmap = {};\r\n\t\t\tproperties[ uuid ] = map;\r\n\r\n\t\t}\r\n\r\n\t\treturn map;\r\n\r\n\t};\r\n\r\n\tthis.delete = function ( object ) {\r\n\r\n\t\tdelete properties[ object.uuid ];\r\n\r\n\t};\r\n\r\n\tthis.clear = function () {\r\n\r\n\t\tproperties = {};\r\n\r\n\t};\r\n\r\n};\r\n\r\n// File:src/renderers/webgl/WebGLShader.js\r\n\r\nTHREE.WebGLShader = ( function () {\r\n\r\n\tfunction addLineNumbers( string ) {\r\n\r\n\t\tvar lines = string.split( '\\n' );\r\n\r\n\t\tfor ( var i = 0; i < lines.length; i ++ ) {\r\n\r\n\t\t\tlines[ i ] = ( i + 1 ) + ': ' + lines[ i ];\r\n\r\n\t\t}\r\n\r\n\t\treturn lines.join( '\\n' );\r\n\r\n\t}\r\n\r\n\treturn function WebGLShader( gl, type, string ) {\r\n\r\n\t\tvar shader = gl.createShader( type );\r\n\r\n\t\tgl.shaderSource( shader, string );\r\n\t\tgl.compileShader( shader );\r\n\r\n\t\tif ( gl.getShaderParameter( shader, gl.COMPILE_STATUS ) === false ) {\r\n\r\n\t\t\tconsole.error( 'THREE.WebGLShader: Shader couldn\\'t compile.' );\r\n\r\n\t\t}\r\n\r\n\t\tif ( gl.getShaderInfoLog( shader ) !== '' ) {\r\n\r\n\t\t\tconsole.warn( 'THREE.WebGLShader: gl.getShaderInfoLog()', type === gl.VERTEX_SHADER ? 'vertex' : 'fragment', gl.getShaderInfoLog( shader ), addLineNumbers( string ) );\r\n\r\n\t\t}\r\n\r\n\t\t// --enable-privileged-webgl-extension\r\n\t\t// console.log( type, gl.getExtension( 'WEBGL_debug_shaders' ).getTranslatedShaderSource( shader ) );\r\n\r\n\t\treturn shader;\r\n\r\n\t};\r\n\r\n} )();\r\n\r\n// File:src/renderers/webgl/WebGLShadowMap.js\r\n\r\n/**\r\n * @author alteredq / http://alteredqualia.com/\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.WebGLShadowMap = function ( _renderer, _lights, _objects ) {\r\n\r\n\tvar _gl = _renderer.context,\r\n\t_state = _renderer.state,\r\n\t_frustum = new THREE.Frustum(),\r\n\t_projScreenMatrix = new THREE.Matrix4(),\r\n\r\n\t_lightShadows = _lights.shadows,\r\n\r\n\t_shadowMapSize = new THREE.Vector2(),\r\n\r\n\t_lookTarget = new THREE.Vector3(),\r\n\t_lightPositionWorld = new THREE.Vector3(),\r\n\r\n\t_renderList = [],\r\n\r\n\t_MorphingFlag = 1,\r\n\t_SkinningFlag = 2,\r\n\r\n\t_NumberOfMaterialVariants = ( _MorphingFlag | _SkinningFlag ) + 1,\r\n\r\n\t_depthMaterials = new Array( _NumberOfMaterialVariants ),\r\n\t_distanceMaterials = new Array( _NumberOfMaterialVariants ),\r\n\r\n\t_materialCache = {};\r\n\r\n\tvar cubeDirections = [\r\n\t\tnew THREE.Vector3( 1, 0, 0 ), new THREE.Vector3( - 1, 0, 0 ), new THREE.Vector3( 0, 0, 1 ),\r\n\t\tnew THREE.Vector3( 0, 0, - 1 ), new THREE.Vector3( 0, 1, 0 ), new THREE.Vector3( 0, - 1, 0 )\r\n\t];\r\n\r\n\tvar cubeUps = [\r\n\t\tnew THREE.Vector3( 0, 1, 0 ), new THREE.Vector3( 0, 1, 0 ), new THREE.Vector3( 0, 1, 0 ),\r\n\t\tnew THREE.Vector3( 0, 1, 0 ), new THREE.Vector3( 0, 0, 1 ),\tnew THREE.Vector3( 0, 0, - 1 )\r\n\t];\r\n\r\n\tvar cube2DViewPorts = [\r\n\t\tnew THREE.Vector4(), new THREE.Vector4(), new THREE.Vector4(),\r\n\t\tnew THREE.Vector4(), new THREE.Vector4(), new THREE.Vector4()\r\n\t];\r\n\r\n\t// init\r\n\r\n\tvar depthMaterialTemplate = new THREE.MeshDepthMaterial();\r\n\tdepthMaterialTemplate.depthPacking = THREE.RGBADepthPacking;\r\n\tdepthMaterialTemplate.clipping = true;\r\n\r\n\tvar distanceShader = THREE.ShaderLib[ \"distanceRGBA\" ];\r\n\tvar distanceUniforms = THREE.UniformsUtils.clone( distanceShader.uniforms );\r\n\r\n\tfor ( var i = 0; i !== _NumberOfMaterialVariants; ++ i ) {\r\n\r\n\t\tvar useMorphing = ( i & _MorphingFlag ) !== 0;\r\n\t\tvar useSkinning = ( i & _SkinningFlag ) !== 0;\r\n\r\n\t\tvar depthMaterial = depthMaterialTemplate.clone();\r\n\t\tdepthMaterial.morphTargets = useMorphing;\r\n\t\tdepthMaterial.skinning = useSkinning;\r\n\r\n\t\t_depthMaterials[ i ] = depthMaterial;\r\n\r\n\t\tvar distanceMaterial = new THREE.ShaderMaterial( {\r\n\t\t\tdefines: {\r\n\t\t\t\t'USE_SHADOWMAP': ''\r\n\t\t\t},\r\n\t\t\tuniforms: distanceUniforms,\r\n\t\t\tvertexShader: distanceShader.vertexShader,\r\n\t\t\tfragmentShader: distanceShader.fragmentShader,\r\n\t\t\tmorphTargets: useMorphing,\r\n\t\t\tskinning: useSkinning,\r\n\t\t\tclipping: true\r\n\t\t} );\r\n\r\n\t\t_distanceMaterials[ i ] = distanceMaterial;\r\n\r\n\t}\r\n\r\n\t//\r\n\r\n\tvar scope = this;\r\n\r\n\tthis.enabled = false;\r\n\r\n\tthis.autoUpdate = true;\r\n\tthis.needsUpdate = false;\r\n\r\n\tthis.type = THREE.PCFShadowMap;\r\n\tthis.cullFace = THREE.CullFaceFront;\r\n\r\n\tthis.render = function ( scene, camera ) {\r\n\r\n\t\tif ( scope.enabled === false ) return;\r\n\t\tif ( scope.autoUpdate === false && scope.needsUpdate === false ) return;\r\n\r\n\t\tif ( _lightShadows.length === 0 ) return;\r\n\r\n\t\t// Set GL state for depth map.\r\n\t\t_state.clearColor( 1, 1, 1, 1 );\r\n\t\t_state.disable( _gl.BLEND );\r\n\t\t_state.enable( _gl.CULL_FACE );\r\n\t\t_gl.frontFace( _gl.CCW );\r\n\t\t_gl.cullFace( scope.cullFace === THREE.CullFaceFront ? _gl.FRONT : _gl.BACK );\r\n\t\t_state.setDepthTest( true );\r\n\t\t_state.setScissorTest( false );\r\n\r\n\t\t// render depth map\r\n\r\n\t\tvar faceCount, isPointLight;\r\n\r\n\t\tfor ( var i = 0, il = _lightShadows.length; i < il; i ++ ) {\r\n\r\n\t\t\tvar light = _lightShadows[ i ];\r\n\r\n\t\t\tvar shadow = light.shadow;\r\n\t\t\tvar shadowCamera = shadow.camera;\r\n\r\n\t\t\t_shadowMapSize.copy( shadow.mapSize );\r\n\r\n\t\t\tif ( light instanceof THREE.PointLight ) {\r\n\r\n\t\t\t\tfaceCount = 6;\r\n\t\t\t\tisPointLight = true;\r\n\r\n\t\t\t\tvar vpWidth = _shadowMapSize.x;\r\n\t\t\t\tvar vpHeight = _shadowMapSize.y;\r\n\r\n\t\t\t\t// These viewports map a cube-map onto a 2D texture with the\r\n\t\t\t\t// following orientation:\r\n\t\t\t\t//\r\n\t\t\t\t//  xzXZ\r\n\t\t\t\t//   y Y\r\n\t\t\t\t//\r\n\t\t\t\t// X - Positive x direction\r\n\t\t\t\t// x - Negative x direction\r\n\t\t\t\t// Y - Positive y direction\r\n\t\t\t\t// y - Negative y direction\r\n\t\t\t\t// Z - Positive z direction\r\n\t\t\t\t// z - Negative z direction\r\n\r\n\t\t\t\t// positive X\r\n\t\t\t\tcube2DViewPorts[ 0 ].set( vpWidth * 2, vpHeight, vpWidth, vpHeight );\r\n\t\t\t\t// negative X\r\n\t\t\t\tcube2DViewPorts[ 1 ].set( 0, vpHeight, vpWidth, vpHeight );\r\n\t\t\t\t// positive Z\r\n\t\t\t\tcube2DViewPorts[ 2 ].set( vpWidth * 3, vpHeight, vpWidth, vpHeight );\r\n\t\t\t\t// negative Z\r\n\t\t\t\tcube2DViewPorts[ 3 ].set( vpWidth, vpHeight, vpWidth, vpHeight );\r\n\t\t\t\t// positive Y\r\n\t\t\t\tcube2DViewPorts[ 4 ].set( vpWidth * 3, 0, vpWidth, vpHeight );\r\n\t\t\t\t// negative Y\r\n\t\t\t\tcube2DViewPorts[ 5 ].set( vpWidth, 0, vpWidth, vpHeight );\r\n\r\n\t\t\t\t_shadowMapSize.x *= 4.0;\r\n\t\t\t\t_shadowMapSize.y *= 2.0;\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tfaceCount = 1;\r\n\t\t\t\tisPointLight = false;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( shadow.map === null ) {\r\n\r\n\t\t\t\tvar pars = { minFilter: THREE.NearestFilter, magFilter: THREE.NearestFilter, format: THREE.RGBAFormat };\r\n\r\n\t\t\t\tshadow.map = new THREE.WebGLRenderTarget( _shadowMapSize.x, _shadowMapSize.y, pars );\r\n\r\n\t\t\t\tshadowCamera.updateProjectionMatrix();\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( shadow instanceof THREE.SpotLightShadow ) {\r\n\r\n\t\t\t\tshadow.update( light );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar shadowMap = shadow.map;\r\n\t\t\tvar shadowMatrix = shadow.matrix;\r\n\r\n\t\t\t_lightPositionWorld.setFromMatrixPosition( light.matrixWorld );\r\n\t\t\tshadowCamera.position.copy( _lightPositionWorld );\r\n\r\n\t\t\t_renderer.setRenderTarget( shadowMap );\r\n\t\t\t_renderer.clear();\r\n\r\n\t\t\t// render shadow map for each cube face (if omni-directional) or\r\n\t\t\t// run a single pass if not\r\n\r\n\t\t\tfor ( var face = 0; face < faceCount; face ++ ) {\r\n\r\n\t\t\t\tif ( isPointLight ) {\r\n\r\n\t\t\t\t\t_lookTarget.copy( shadowCamera.position );\r\n\t\t\t\t\t_lookTarget.add( cubeDirections[ face ] );\r\n\t\t\t\t\tshadowCamera.up.copy( cubeUps[ face ] );\r\n\t\t\t\t\tshadowCamera.lookAt( _lookTarget );\r\n\r\n\t\t\t\t\tvar vpDimensions = cube2DViewPorts[ face ];\r\n\t\t\t\t\t_state.viewport( vpDimensions );\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\t_lookTarget.setFromMatrixPosition( light.target.matrixWorld );\r\n\t\t\t\t\tshadowCamera.lookAt( _lookTarget );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tshadowCamera.updateMatrixWorld();\r\n\t\t\t\tshadowCamera.matrixWorldInverse.getInverse( shadowCamera.matrixWorld );\r\n\r\n\t\t\t\t// compute shadow matrix\r\n\r\n\t\t\t\tshadowMatrix.set(\r\n\t\t\t\t\t0.5, 0.0, 0.0, 0.5,\r\n\t\t\t\t\t0.0, 0.5, 0.0, 0.5,\r\n\t\t\t\t\t0.0, 0.0, 0.5, 0.5,\r\n\t\t\t\t\t0.0, 0.0, 0.0, 1.0\r\n\t\t\t\t);\r\n\r\n\t\t\t\tshadowMatrix.multiply( shadowCamera.projectionMatrix );\r\n\t\t\t\tshadowMatrix.multiply( shadowCamera.matrixWorldInverse );\r\n\r\n\t\t\t\t// update camera matrices and frustum\r\n\r\n\t\t\t\t_projScreenMatrix.multiplyMatrices( shadowCamera.projectionMatrix, shadowCamera.matrixWorldInverse );\r\n\t\t\t\t_frustum.setFromMatrix( _projScreenMatrix );\r\n\r\n\t\t\t\t// set object matrices & frustum culling\r\n\r\n\t\t\t\t_renderList.length = 0;\r\n\r\n\t\t\t\tprojectObject( scene, camera, shadowCamera );\r\n\r\n\t\t\t\t// render shadow map\r\n\t\t\t\t// render regular objects\r\n\r\n\t\t\t\tfor ( var j = 0, jl = _renderList.length; j < jl; j ++ ) {\r\n\r\n\t\t\t\t\tvar object = _renderList[ j ];\r\n\t\t\t\t\tvar geometry = _objects.update( object );\r\n\t\t\t\t\tvar material = object.material;\r\n\r\n\t\t\t\t\tif ( material instanceof THREE.MultiMaterial ) {\r\n\r\n\t\t\t\t\t\tvar groups = geometry.groups;\r\n\t\t\t\t\t\tvar materials = material.materials;\r\n\r\n\t\t\t\t\t\tfor ( var k = 0, kl = groups.length; k < kl; k ++ ) {\r\n\r\n\t\t\t\t\t\t\tvar group = groups[ k ];\r\n\t\t\t\t\t\t\tvar groupMaterial = materials[ group.materialIndex ];\r\n\r\n\t\t\t\t\t\t\tif ( groupMaterial.visible === true ) {\r\n\r\n\t\t\t\t\t\t\t\tvar depthMaterial = getDepthMaterial( object, groupMaterial, isPointLight, _lightPositionWorld );\r\n\t\t\t\t\t\t\t\t_renderer.renderBufferDirect( shadowCamera, null, geometry, depthMaterial, object, group );\r\n\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\tvar depthMaterial = getDepthMaterial( object, material, isPointLight, _lightPositionWorld );\r\n\t\t\t\t\t\t_renderer.renderBufferDirect( shadowCamera, null, geometry, depthMaterial, object, null );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\t// Restore GL state.\r\n\t\tvar clearColor = _renderer.getClearColor(),\r\n\t\tclearAlpha = _renderer.getClearAlpha();\r\n\t\t_renderer.setClearColor( clearColor, clearAlpha );\r\n\r\n\t\t_state.enable( _gl.BLEND );\r\n\r\n\t\tif ( scope.cullFace === THREE.CullFaceFront ) {\r\n\r\n\t\t\t_gl.cullFace( _gl.BACK );\r\n\r\n\t\t}\r\n\r\n\t\tscope.needsUpdate = false;\r\n\r\n\t};\r\n\r\n\tfunction getDepthMaterial( object, material, isPointLight, lightPositionWorld ) {\r\n\r\n\t\tvar geometry = object.geometry;\r\n\r\n\t\tvar result = null;\r\n\r\n\t\tvar materialVariants = _depthMaterials;\r\n\t\tvar customMaterial = object.customDepthMaterial;\r\n\r\n\t\tif ( isPointLight ) {\r\n\r\n\t\t\tmaterialVariants = _distanceMaterials;\r\n\t\t\tcustomMaterial = object.customDistanceMaterial;\r\n\r\n\t\t}\r\n\r\n\t\tif ( ! customMaterial ) {\r\n\r\n\t\t\tvar useMorphing = geometry.morphTargets !== undefined &&\r\n\t\t\t\t\tgeometry.morphTargets.length > 0 && material.morphTargets;\r\n\r\n\t\t\tvar useSkinning = object instanceof THREE.SkinnedMesh && material.skinning;\r\n\r\n\t\t\tvar variantIndex = 0;\r\n\r\n\t\t\tif ( useMorphing ) variantIndex |= _MorphingFlag;\r\n\t\t\tif ( useSkinning ) variantIndex |= _SkinningFlag;\r\n\r\n\t\t\tresult = materialVariants[ variantIndex ];\r\n\r\n\t\t} else {\r\n\r\n\t\t\tresult = customMaterial;\r\n\r\n\t\t}\r\n\r\n\t\tif ( _renderer.localClippingEnabled &&\r\n\t\t\t material.clipShadows === true &&\r\n\t\t\t\tmaterial.clippingPlanes.length !== 0 ) {\r\n\r\n\t\t\t// in this case we need a unique material instance reflecting the\r\n\t\t\t// appropriate state\r\n\r\n\t\t\tvar keyA = result.uuid, keyB = material.uuid;\r\n\r\n\t\t\tvar materialsForVariant = _materialCache[ keyA ];\r\n\r\n\t\t\tif ( materialsForVariant === undefined ) {\r\n\r\n\t\t\t\tmaterialsForVariant = {};\r\n\t\t\t\t_materialCache[ keyA ] = materialsForVariant;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar cachedMaterial = materialsForVariant[ keyB ];\r\n\r\n\t\t\tif ( cachedMaterial === undefined ) {\r\n\r\n\t\t\t\tcachedMaterial = result.clone();\r\n\t\t\t\tmaterialsForVariant[ keyB ] = cachedMaterial;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tresult = cachedMaterial;\r\n\r\n\t\t}\r\n\r\n\t\tresult.visible = material.visible;\r\n\t\tresult.wireframe = material.wireframe;\r\n\t\tresult.side = material.side;\r\n\t\tresult.clipShadows = material.clipShadows;\r\n\t\tresult.clippingPlanes = material.clippingPlanes;\r\n\t\tresult.wireframeLinewidth = material.wireframeLinewidth;\r\n\t\tresult.linewidth = material.linewidth;\r\n\r\n\t\tif ( isPointLight && result.uniforms.lightPos !== undefined ) {\r\n\r\n\t\t\tresult.uniforms.lightPos.value.copy( lightPositionWorld );\r\n\r\n\t\t}\r\n\r\n\t\treturn result;\r\n\r\n\t}\r\n\r\n\tfunction projectObject( object, camera, shadowCamera ) {\r\n\r\n\t\tif ( object.visible === false ) return;\r\n\r\n\t\tif ( object.layers.test( camera.layers ) && ( object instanceof THREE.Mesh || object instanceof THREE.Line || object instanceof THREE.Points ) ) {\r\n\r\n\t\t\tif ( object.castShadow && ( object.frustumCulled === false || _frustum.intersectsObject( object ) === true ) ) {\r\n\r\n\t\t\t\tvar material = object.material;\r\n\r\n\t\t\t\tif ( material.visible === true ) {\r\n\r\n\t\t\t\t\tobject.modelViewMatrix.multiplyMatrices( shadowCamera.matrixWorldInverse, object.matrixWorld );\r\n\t\t\t\t\t_renderList.push( object );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tvar children = object.children;\r\n\r\n\t\tfor ( var i = 0, l = children.length; i < l; i ++ ) {\r\n\r\n\t\t\tprojectObject( children[ i ], camera, shadowCamera );\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n};\r\n\r\n// File:src/renderers/webgl/WebGLState.js\r\n\r\n/**\r\n* @author mrdoob / http://mrdoob.com/\r\n*/\r\n\r\nTHREE.WebGLState = function ( gl, extensions, paramThreeToGL ) {\r\n\r\n\tvar _this = this;\r\n\r\n\tvar color = new THREE.Vector4();\r\n\r\n\tvar maxVertexAttributes = gl.getParameter( gl.MAX_VERTEX_ATTRIBS );\r\n\tvar newAttributes = new Uint8Array( maxVertexAttributes );\r\n\tvar enabledAttributes = new Uint8Array( maxVertexAttributes );\r\n\tvar attributeDivisors = new Uint8Array( maxVertexAttributes );\r\n\r\n\tvar capabilities = {};\r\n\r\n\tvar compressedTextureFormats = null;\r\n\r\n\tvar currentBlending = null;\r\n\tvar currentBlendEquation = null;\r\n\tvar currentBlendSrc = null;\r\n\tvar currentBlendDst = null;\r\n\tvar currentBlendEquationAlpha = null;\r\n\tvar currentBlendSrcAlpha = null;\r\n\tvar currentBlendDstAlpha = null;\r\n\tvar currentPremultipledAlpha = false;\r\n\r\n\tvar currentDepthFunc = null;\r\n\tvar currentDepthWrite = null;\r\n\r\n\tvar currentColorWrite = null;\r\n\r\n\tvar currentStencilWrite = null;\r\n\tvar currentStencilFunc = null;\r\n\tvar currentStencilRef = null;\r\n\tvar currentStencilMask = null;\r\n\tvar currentStencilFail  = null;\r\n\tvar currentStencilZFail = null;\r\n\tvar currentStencilZPass = null;\r\n\r\n\tvar currentFlipSided = null;\r\n\r\n\tvar currentLineWidth = null;\r\n\r\n\tvar currentPolygonOffsetFactor = null;\r\n\tvar currentPolygonOffsetUnits = null;\r\n\r\n\tvar currentScissorTest = null;\r\n\r\n\tvar maxTextures = gl.getParameter( gl.MAX_TEXTURE_IMAGE_UNITS );\r\n\r\n\tvar currentTextureSlot = undefined;\r\n\tvar currentBoundTextures = {};\r\n\r\n\tvar currentClearColor = new THREE.Vector4();\r\n\tvar currentClearDepth = null;\r\n\tvar currentClearStencil = null;\r\n\r\n\tvar currentScissor = new THREE.Vector4();\r\n\tvar currentViewport = new THREE.Vector4();\r\n\r\n\tthis.init = function () {\r\n\r\n\t\tthis.clearColor( 0, 0, 0, 1 );\r\n\t\tthis.clearDepth( 1 );\r\n\t\tthis.clearStencil( 0 );\r\n\r\n\t\tthis.enable( gl.DEPTH_TEST );\r\n\t\tgl.depthFunc( gl.LEQUAL );\r\n\r\n\t\tgl.frontFace( gl.CCW );\r\n\t\tgl.cullFace( gl.BACK );\r\n\t\tthis.enable( gl.CULL_FACE );\r\n\r\n\t\tthis.enable( gl.BLEND );\r\n\t\tgl.blendEquation( gl.FUNC_ADD );\r\n\t\tgl.blendFunc( gl.SRC_ALPHA, gl.ONE_MINUS_SRC_ALPHA );\r\n\r\n\t};\r\n\r\n\tthis.initAttributes = function () {\r\n\r\n\t\tfor ( var i = 0, l = newAttributes.length; i < l; i ++ ) {\r\n\r\n\t\t\tnewAttributes[ i ] = 0;\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n\tthis.enableAttribute = function ( attribute ) {\r\n\r\n\t\tnewAttributes[ attribute ] = 1;\r\n\r\n\t\tif ( enabledAttributes[ attribute ] === 0 ) {\r\n\r\n\t\t\tgl.enableVertexAttribArray( attribute );\r\n\t\t\tenabledAttributes[ attribute ] = 1;\r\n\r\n\t\t}\r\n\r\n\t\tif ( attributeDivisors[ attribute ] !== 0 ) {\r\n\r\n\t\t\tvar extension = extensions.get( 'ANGLE_instanced_arrays' );\r\n\r\n\t\t\textension.vertexAttribDivisorANGLE( attribute, 0 );\r\n\t\t\tattributeDivisors[ attribute ] = 0;\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n\tthis.enableAttributeAndDivisor = function ( attribute, meshPerAttribute, extension ) {\r\n\r\n\t\tnewAttributes[ attribute ] = 1;\r\n\r\n\t\tif ( enabledAttributes[ attribute ] === 0 ) {\r\n\r\n\t\t\tgl.enableVertexAttribArray( attribute );\r\n\t\t\tenabledAttributes[ attribute ] = 1;\r\n\r\n\t\t}\r\n\r\n\t\tif ( attributeDivisors[ attribute ] !== meshPerAttribute ) {\r\n\r\n\t\t\textension.vertexAttribDivisorANGLE( attribute, meshPerAttribute );\r\n\t\t\tattributeDivisors[ attribute ] = meshPerAttribute;\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n\tthis.disableUnusedAttributes = function () {\r\n\r\n\t\tfor ( var i = 0, l = enabledAttributes.length; i < l; i ++ ) {\r\n\r\n\t\t\tif ( enabledAttributes[ i ] !== newAttributes[ i ] ) {\r\n\r\n\t\t\t\tgl.disableVertexAttribArray( i );\r\n\t\t\t\tenabledAttributes[ i ] = 0;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n\tthis.enable = function ( id ) {\r\n\r\n\t\tif ( capabilities[ id ] !== true ) {\r\n\r\n\t\t\tgl.enable( id );\r\n\t\t\tcapabilities[ id ] = true;\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n\tthis.disable = function ( id ) {\r\n\r\n\t\tif ( capabilities[ id ] !== false ) {\r\n\r\n\t\t\tgl.disable( id );\r\n\t\t\tcapabilities[ id ] = false;\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n\tthis.getCompressedTextureFormats = function () {\r\n\r\n\t\tif ( compressedTextureFormats === null ) {\r\n\r\n\t\t\tcompressedTextureFormats = [];\r\n\r\n\t\t\tif ( extensions.get( 'WEBGL_compressed_texture_pvrtc' ) ||\r\n\t\t\t     extensions.get( 'WEBGL_compressed_texture_s3tc' ) ||\r\n\t\t\t     extensions.get( 'WEBGL_compressed_texture_etc1' ) ) {\r\n\r\n\t\t\t\tvar formats = gl.getParameter( gl.COMPRESSED_TEXTURE_FORMATS );\r\n\r\n\t\t\t\tfor ( var i = 0; i < formats.length; i ++ ) {\r\n\r\n\t\t\t\t\tcompressedTextureFormats.push( formats[ i ] );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\treturn compressedTextureFormats;\r\n\r\n\t};\r\n\r\n\tthis.setBlending = function ( blending, blendEquation, blendSrc, blendDst, blendEquationAlpha, blendSrcAlpha, blendDstAlpha, premultipliedAlpha ) {\r\n\r\n\t\tif ( blending === THREE.NoBlending ) {\r\n\r\n\t\t\tthis.disable( gl.BLEND );\r\n\r\n\t\t} else {\r\n\r\n\t\t\tthis.enable( gl.BLEND );\r\n\r\n\t\t}\r\n\r\n\t\tif ( blending !== currentBlending || premultipliedAlpha !== currentPremultipledAlpha ) {\r\n\r\n\t\t\tif ( blending === THREE.AdditiveBlending ) {\r\n\r\n\t\t\t\tif ( premultipliedAlpha ) {\r\n\r\n\t\t\t\t\tgl.blendEquationSeparate( gl.FUNC_ADD, gl.FUNC_ADD );\r\n\t\t\t\t\tgl.blendFuncSeparate( gl.ONE, gl.ONE, gl.ONE, gl.ONE );\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tgl.blendEquation( gl.FUNC_ADD );\r\n\t\t\t\t\tgl.blendFunc( gl.SRC_ALPHA, gl.ONE );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t} else if ( blending === THREE.SubtractiveBlending ) {\r\n\r\n\t\t\t\tif ( premultipliedAlpha ) {\r\n\r\n\t\t\t\t\tgl.blendEquationSeparate( gl.FUNC_ADD, gl.FUNC_ADD );\r\n\t\t\t\t\tgl.blendFuncSeparate( gl.ZERO, gl.ZERO, gl.ONE_MINUS_SRC_COLOR, gl.ONE_MINUS_SRC_ALPHA );\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tgl.blendEquation( gl.FUNC_ADD );\r\n\t\t\t\t\tgl.blendFunc( gl.ZERO, gl.ONE_MINUS_SRC_COLOR );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t} else if ( blending === THREE.MultiplyBlending ) {\r\n\r\n\t\t\t\tif ( premultipliedAlpha ) {\r\n\r\n\t\t\t\t\tgl.blendEquationSeparate( gl.FUNC_ADD, gl.FUNC_ADD );\r\n\t\t\t\t\tgl.blendFuncSeparate( gl.ZERO, gl.ZERO, gl.SRC_COLOR, gl.SRC_ALPHA );\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tgl.blendEquation( gl.FUNC_ADD );\r\n\t\t\t\t\tgl.blendFunc( gl.ZERO, gl.SRC_COLOR );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tif ( premultipliedAlpha ) {\r\n\r\n\t\t\t\t\tgl.blendEquationSeparate( gl.FUNC_ADD, gl.FUNC_ADD );\r\n\t\t\t\t\tgl.blendFuncSeparate( gl.ONE, gl.ONE_MINUS_SRC_ALPHA, gl.ONE, gl.ONE_MINUS_SRC_ALPHA );\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tgl.blendEquationSeparate( gl.FUNC_ADD, gl.FUNC_ADD );\r\n\t\t\t\t\tgl.blendFuncSeparate( gl.SRC_ALPHA, gl.ONE_MINUS_SRC_ALPHA, gl.ONE, gl.ONE_MINUS_SRC_ALPHA );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tcurrentBlending = blending;\r\n\t\t\tcurrentPremultipledAlpha = premultipliedAlpha;\r\n\r\n\t\t}\r\n\r\n\t\tif ( blending === THREE.CustomBlending ) {\r\n\r\n\t\t\tblendEquationAlpha = blendEquationAlpha || blendEquation;\r\n\t\t\tblendSrcAlpha = blendSrcAlpha || blendSrc;\r\n\t\t\tblendDstAlpha = blendDstAlpha || blendDst;\r\n\r\n\t\t\tif ( blendEquation !== currentBlendEquation || blendEquationAlpha !== currentBlendEquationAlpha ) {\r\n\r\n\t\t\t\tgl.blendEquationSeparate( paramThreeToGL( blendEquation ), paramThreeToGL( blendEquationAlpha ) );\r\n\r\n\t\t\t\tcurrentBlendEquation = blendEquation;\r\n\t\t\t\tcurrentBlendEquationAlpha = blendEquationAlpha;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( blendSrc !== currentBlendSrc || blendDst !== currentBlendDst || blendSrcAlpha !== currentBlendSrcAlpha || blendDstAlpha !== currentBlendDstAlpha ) {\r\n\r\n\t\t\t\tgl.blendFuncSeparate( paramThreeToGL( blendSrc ), paramThreeToGL( blendDst ), paramThreeToGL( blendSrcAlpha ), paramThreeToGL( blendDstAlpha ) );\r\n\r\n\t\t\t\tcurrentBlendSrc = blendSrc;\r\n\t\t\t\tcurrentBlendDst = blendDst;\r\n\t\t\t\tcurrentBlendSrcAlpha = blendSrcAlpha;\r\n\t\t\t\tcurrentBlendDstAlpha = blendDstAlpha;\r\n\r\n\t\t\t}\r\n\r\n\t\t} else {\r\n\r\n\t\t\tcurrentBlendEquation = null;\r\n\t\t\tcurrentBlendSrc = null;\r\n\t\t\tcurrentBlendDst = null;\r\n\t\t\tcurrentBlendEquationAlpha = null;\r\n\t\t\tcurrentBlendSrcAlpha = null;\r\n\t\t\tcurrentBlendDstAlpha = null;\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n\tthis.setDepthFunc = function ( depthFunc ) {\r\n\r\n\t\tif ( currentDepthFunc !== depthFunc ) {\r\n\r\n\t\t\tif ( depthFunc ) {\r\n\r\n\t\t\t\tswitch ( depthFunc ) {\r\n\r\n\t\t\t\t\tcase THREE.NeverDepth:\r\n\r\n\t\t\t\t\t\tgl.depthFunc( gl.NEVER );\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase THREE.AlwaysDepth:\r\n\r\n\t\t\t\t\t\tgl.depthFunc( gl.ALWAYS );\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase THREE.LessDepth:\r\n\r\n\t\t\t\t\t\tgl.depthFunc( gl.LESS );\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase THREE.LessEqualDepth:\r\n\r\n\t\t\t\t\t\tgl.depthFunc( gl.LEQUAL );\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase THREE.EqualDepth:\r\n\r\n\t\t\t\t\t\tgl.depthFunc( gl.EQUAL );\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase THREE.GreaterEqualDepth:\r\n\r\n\t\t\t\t\t\tgl.depthFunc( gl.GEQUAL );\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase THREE.GreaterDepth:\r\n\r\n\t\t\t\t\t\tgl.depthFunc( gl.GREATER );\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase THREE.NotEqualDepth:\r\n\r\n\t\t\t\t\t\tgl.depthFunc( gl.NOTEQUAL );\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tdefault:\r\n\r\n\t\t\t\t\t\tgl.depthFunc( gl.LEQUAL );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tgl.depthFunc( gl.LEQUAL );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tcurrentDepthFunc = depthFunc;\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n\tthis.setDepthTest = function ( depthTest ) {\r\n\r\n\t\tif ( depthTest ) {\r\n\r\n\t\t\tthis.enable( gl.DEPTH_TEST );\r\n\r\n\t\t} else {\r\n\r\n\t\t\tthis.disable( gl.DEPTH_TEST );\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n\tthis.setDepthWrite = function ( depthWrite ) {\r\n\r\n\t\t// TODO: Rename to setDepthMask\r\n\r\n\t\tif ( currentDepthWrite !== depthWrite ) {\r\n\r\n\t\t\tgl.depthMask( depthWrite );\r\n\t\t\tcurrentDepthWrite = depthWrite;\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n\tthis.setColorWrite = function ( colorWrite ) {\r\n\r\n\t\t// TODO: Rename to setColorMask\r\n\r\n\t\tif ( currentColorWrite !== colorWrite ) {\r\n\r\n\t\t\tgl.colorMask( colorWrite, colorWrite, colorWrite, colorWrite );\r\n\t\t\tcurrentColorWrite = colorWrite;\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n\tthis.setStencilFunc = function ( stencilFunc, stencilRef, stencilMask ) {\r\n\r\n\t\tif ( currentStencilFunc !== stencilFunc ||\r\n\t\t\t\t currentStencilRef \t!== stencilRef \t||\r\n\t\t\t\t currentStencilMask !== stencilMask ) {\r\n\r\n\t\t\tgl.stencilFunc( stencilFunc,  stencilRef, stencilMask );\r\n\r\n\t\t\tcurrentStencilFunc = stencilFunc;\r\n\t\t\tcurrentStencilRef  = stencilRef;\r\n\t\t\tcurrentStencilMask = stencilMask;\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n\tthis.setStencilOp = function ( stencilFail, stencilZFail, stencilZPass ) {\r\n\r\n\t\tif ( currentStencilFail\t !== stencilFail \t||\r\n\t\t\t\t currentStencilZFail !== stencilZFail ||\r\n\t\t\t\t currentStencilZPass !== stencilZPass ) {\r\n\r\n\t\t\tgl.stencilOp( stencilFail,  stencilZFail, stencilZPass );\r\n\r\n\t\t\tcurrentStencilFail  = stencilFail;\r\n\t\t\tcurrentStencilZFail = stencilZFail;\r\n\t\t\tcurrentStencilZPass = stencilZPass;\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n\tthis.setStencilTest = function ( stencilTest ) {\r\n\r\n\t\tif ( stencilTest ) {\r\n\r\n\t\t\tthis.enable( gl.STENCIL_TEST );\r\n\r\n\t\t} else {\r\n\r\n\t\t\tthis.disable( gl.STENCIL_TEST );\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n\tthis.setStencilWrite = function ( stencilWrite ) {\r\n\r\n\t\t// TODO: Rename to setStencilMask\r\n\r\n\t\tif ( currentStencilWrite !== stencilWrite ) {\r\n\r\n\t\t\tgl.stencilMask( stencilWrite );\r\n\t\t\tcurrentStencilWrite = stencilWrite;\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n\tthis.setFlipSided = function ( flipSided ) {\r\n\r\n\t\tif ( currentFlipSided !== flipSided ) {\r\n\r\n\t\t\tif ( flipSided ) {\r\n\r\n\t\t\t\tgl.frontFace( gl.CW );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tgl.frontFace( gl.CCW );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tcurrentFlipSided = flipSided;\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n\tthis.setLineWidth = function ( width ) {\r\n\r\n\t\tif ( width !== currentLineWidth ) {\r\n\r\n\t\t\tgl.lineWidth( width );\r\n\r\n\t\t\tcurrentLineWidth = width;\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n\tthis.setPolygonOffset = function ( polygonOffset, factor, units ) {\r\n\r\n\t\tif ( polygonOffset ) {\r\n\r\n\t\t\tthis.enable( gl.POLYGON_OFFSET_FILL );\r\n\r\n\t\t} else {\r\n\r\n\t\t\tthis.disable( gl.POLYGON_OFFSET_FILL );\r\n\r\n\t\t}\r\n\r\n\t\tif ( polygonOffset && ( currentPolygonOffsetFactor !== factor || currentPolygonOffsetUnits !== units ) ) {\r\n\r\n\t\t\tgl.polygonOffset( factor, units );\r\n\r\n\t\t\tcurrentPolygonOffsetFactor = factor;\r\n\t\t\tcurrentPolygonOffsetUnits = units;\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n\tthis.getScissorTest = function () {\r\n\r\n\t\treturn currentScissorTest;\r\n\r\n\t};\r\n\r\n\tthis.setScissorTest = function ( scissorTest ) {\r\n\r\n\t\tcurrentScissorTest = scissorTest;\r\n\r\n\t\tif ( scissorTest ) {\r\n\r\n\t\t\tthis.enable( gl.SCISSOR_TEST );\r\n\r\n\t\t} else {\r\n\r\n\t\t\tthis.disable( gl.SCISSOR_TEST );\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n\t// texture\r\n\r\n\tthis.activeTexture = function ( webglSlot ) {\r\n\r\n\t\tif ( webglSlot === undefined ) webglSlot = gl.TEXTURE0 + maxTextures - 1;\r\n\r\n\t\tif ( currentTextureSlot !== webglSlot ) {\r\n\r\n\t\t\tgl.activeTexture( webglSlot );\r\n\t\t\tcurrentTextureSlot = webglSlot;\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n\tthis.bindTexture = function ( webglType, webglTexture ) {\r\n\r\n\t\tif ( currentTextureSlot === undefined ) {\r\n\r\n\t\t\t_this.activeTexture();\r\n\r\n\t\t}\r\n\r\n\t\tvar boundTexture = currentBoundTextures[ currentTextureSlot ];\r\n\r\n\t\tif ( boundTexture === undefined ) {\r\n\r\n\t\t\tboundTexture = { type: undefined, texture: undefined };\r\n\t\t\tcurrentBoundTextures[ currentTextureSlot ] = boundTexture;\r\n\r\n\t\t}\r\n\r\n\t\tif ( boundTexture.type !== webglType || boundTexture.texture !== webglTexture ) {\r\n\r\n\t\t\tgl.bindTexture( webglType, webglTexture );\r\n\r\n\t\t\tboundTexture.type = webglType;\r\n\t\t\tboundTexture.texture = webglTexture;\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n\tthis.compressedTexImage2D = function () {\r\n\r\n\t\ttry {\r\n\r\n\t\t\tgl.compressedTexImage2D.apply( gl, arguments );\r\n\r\n\t\t} catch ( error ) {\r\n\r\n\t\t\tconsole.error( error );\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n\tthis.texImage2D = function () {\r\n\r\n\t\ttry {\r\n\r\n\t\t\tgl.texImage2D.apply( gl, arguments );\r\n\r\n\t\t} catch ( error ) {\r\n\r\n\t\t\tconsole.error( error );\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n\t// clear values\r\n\r\n\tthis.clearColor = function ( r, g, b, a ) {\r\n\r\n\t\tcolor.set( r, g, b, a );\r\n\r\n\t\tif ( currentClearColor.equals( color ) === false ) {\r\n\r\n\t\t\tgl.clearColor( r, g, b, a );\r\n\t\t\tcurrentClearColor.copy( color );\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n\tthis.clearDepth = function ( depth ) {\r\n\r\n\t\tif ( currentClearDepth !== depth ) {\r\n\r\n\t\t\tgl.clearDepth( depth );\r\n\t\t\tcurrentClearDepth = depth;\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n\tthis.clearStencil = function ( stencil ) {\r\n\r\n\t\tif ( currentClearStencil !== stencil ) {\r\n\r\n\t\t\tgl.clearStencil( stencil );\r\n\t\t\tcurrentClearStencil = stencil;\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n\t//\r\n\r\n\tthis.scissor = function ( scissor ) {\r\n\r\n\t\tif ( currentScissor.equals( scissor ) === false ) {\r\n\r\n\t\t\tgl.scissor( scissor.x, scissor.y, scissor.z, scissor.w );\r\n\t\t\tcurrentScissor.copy( scissor );\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n\tthis.viewport = function ( viewport ) {\r\n\r\n\t\tif ( currentViewport.equals( viewport ) === false ) {\r\n\r\n\t\t\tgl.viewport( viewport.x, viewport.y, viewport.z, viewport.w );\r\n\t\t\tcurrentViewport.copy( viewport );\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n\t//\r\n\r\n\tthis.reset = function () {\r\n\r\n\t\tfor ( var i = 0; i < enabledAttributes.length; i ++ ) {\r\n\r\n\t\t\tif ( enabledAttributes[ i ] === 1 ) {\r\n\r\n\t\t\t\tgl.disableVertexAttribArray( i );\r\n\t\t\t\tenabledAttributes[ i ] = 0;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tcapabilities = {};\r\n\r\n\t\tcompressedTextureFormats = null;\r\n\r\n\t\tcurrentTextureSlot = undefined;\r\n\t\tcurrentBoundTextures = {};\r\n\r\n\t\tcurrentBlending = null;\r\n\r\n\t\tcurrentColorWrite = null;\r\n\t\tcurrentDepthWrite = null;\r\n\t\tcurrentStencilWrite = null;\r\n\r\n\t\tcurrentFlipSided = null;\r\n\r\n\t};\r\n\r\n};\r\n\r\n// File:src/renderers/webgl/WebGLUniforms.js\r\n\r\n/**\r\n *\r\n * Uniforms of a program.\r\n * Those form a tree structure with a special top-level container for the root,\r\n * which you get by calling 'new WebGLUniforms( gl, program, renderer )'.\r\n *\r\n *\r\n * Properties of inner nodes including the top-level container:\r\n *\r\n * .seq - array of nested uniforms\r\n * .map - nested uniforms by name\r\n *\r\n *\r\n * Methods of all nodes except the top-level container:\r\n *\r\n * .setValue( gl, value, [renderer] )\r\n *\r\n * \t\tuploads a uniform value(s)\r\n *  \tthe 'renderer' parameter is needed for sampler uniforms\r\n *\r\n *\r\n * Static methods of the top-level container (renderer factorizations):\r\n *\r\n * .upload( gl, seq, values, renderer )\r\n *\r\n * \t\tsets uniforms in 'seq' to 'values[id].value'\r\n *\r\n * .seqWithValue( seq, values ) : filteredSeq\r\n *\r\n * \t\tfilters 'seq' entries with corresponding entry in values\r\n *\r\n * .splitDynamic( seq, values ) : filteredSeq\r\n *\r\n * \t\tfilters 'seq' entries with dynamic entry and removes them from 'seq'\r\n *\r\n *\r\n * Methods of the top-level container (renderer factorizations):\r\n *\r\n * .setValue( gl, name, value )\r\n *\r\n * \t\tsets uniform with  name 'name' to 'value'\r\n *\r\n * .set( gl, obj, prop )\r\n *\r\n * \t\tsets uniform from object and property with same name than uniform\r\n *\r\n * .setOptional( gl, obj, prop )\r\n *\r\n * \t\tlike .set for an optional property of the object\r\n *\r\n *\r\n * @author tschw\r\n *\r\n */\r\n\r\nTHREE.WebGLUniforms = ( function() { // scope\r\n\r\n\t// --- Base for inner nodes (including the root) ---\r\n\r\n\tvar UniformContainer = function() {\r\n\r\n\t\t\tthis.seq = [];\r\n\t\t\tthis.map = {};\r\n\r\n\t\t},\r\n\r\n\t// --- Utilities ---\r\n\r\n\t// Array Caches (provide typed arrays for temporary by size)\r\n\r\n\t\tarrayCacheF32 = [],\r\n\t\tarrayCacheI32 = [],\r\n\r\n\t\tuncacheTemporaryArrays = function() {\r\n\r\n\t\t\tarrayCacheF32.length = 0;\r\n\t\t\tarrayCacheI32.length = 0;\r\n\r\n\t\t},\r\n\r\n\t// Flattening for arrays of vectors and matrices\r\n\r\n\t\tflatten = function( array, nBlocks, blockSize ) {\r\n\r\n\t\t\tvar firstElem = array[ 0 ];\r\n\r\n\t\t\tif ( firstElem <= 0 || firstElem > 0 ) return array;\r\n\t\t\t// unoptimized: ! isNaN( firstElem )\r\n\t\t\t// see http://jacksondunstan.com/articles/983\r\n\r\n\t\t\tvar n = nBlocks * blockSize,\r\n\t\t\t\tr = arrayCacheF32[ n ];\r\n\r\n\t\t\tif ( r === undefined ) {\r\n\r\n\t\t\t\tr = new Float32Array( n );\r\n\t\t\t\tarrayCacheF32[ n ] = r;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( nBlocks !== 0 ) {\r\n\r\n\t\t\t\tfirstElem.toArray( r, 0 );\r\n\r\n\t\t\t\tfor ( var i = 1, offset = 0; i !== nBlocks; ++ i ) {\r\n\r\n\t\t\t\t\toffset += blockSize;\r\n\t\t\t\t\tarray[ i ].toArray( r, offset );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn r;\r\n\r\n\t\t},\r\n\r\n\t// Texture unit allocation\r\n\r\n\t\tallocTexUnits = function( renderer, n ) {\r\n\r\n\t\t\tvar r = arrayCacheI32[ n ];\r\n\r\n\t\t\tif ( r === undefined ) {\r\n\r\n\t\t\t\tr = new Int32Array( n );\r\n\t\t\t\tarrayCacheI32[ n ] = r;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tfor ( var i = 0; i !== n; ++ i )\r\n\t\t\t\tr[ i ] = renderer.allocTextureUnit();\r\n\r\n\t\t\treturn r;\r\n\r\n\t\t},\r\n\r\n\t// --- Setters ---\r\n\r\n\t// Note: Defining these methods externally, because they come in a bunch\r\n\t// and this way their names minify.\r\n\r\n\t\t// Single scalar\r\n\r\n\t\tsetValue1f = function( gl, v ) { gl.uniform1f( this.addr, v ); },\r\n\t\tsetValue1i = function( gl, v ) { gl.uniform1i( this.addr, v ); },\r\n\r\n\t\t// Single float vector (from flat array or THREE.VectorN)\r\n\r\n\t\tsetValue2fv = function( gl, v ) {\r\n\r\n\t\t\tif ( v.x === undefined ) gl.uniform2fv( this.addr, v );\r\n\t\t\telse gl.uniform2f( this.addr, v.x, v.y );\r\n\r\n\t\t},\r\n\r\n\t\tsetValue3fv = function( gl, v ) {\r\n\r\n\t\t\tif ( v.x !== undefined )\r\n\t\t\t\tgl.uniform3f( this.addr, v.x, v.y, v.z );\r\n\t\t\telse if ( v.r !== undefined )\r\n\t\t\t\tgl.uniform3f( this.addr, v.r, v.g, v.b );\r\n\t\t\telse\r\n\t\t\t\tgl.uniform3fv( this.addr, v );\r\n\r\n\t\t},\r\n\r\n\t\tsetValue4fv = function( gl, v ) {\r\n\r\n\t\t\tif ( v.x === undefined ) gl.uniform4fv( this.addr, v );\r\n\t\t\telse gl.uniform4f( this.addr, v.x, v.y, v.z, v.w );\r\n\r\n\t\t},\r\n\r\n\t\t// Single matrix (from flat array or MatrixN)\r\n\r\n\t\tsetValue2fm = function( gl, v ) {\r\n\r\n\t\t\tgl.uniformMatrix2fv( this.addr, false, v.elements || v );\r\n\r\n\t\t},\r\n\r\n\t\tsetValue3fm = function( gl, v ) {\r\n\r\n\t\t\tgl.uniformMatrix3fv( this.addr, false, v.elements || v );\r\n\r\n\t\t},\r\n\r\n\t\tsetValue4fm = function( gl, v ) {\r\n\r\n\t\t\tgl.uniformMatrix4fv( this.addr, false, v.elements || v );\r\n\r\n\t\t},\r\n\r\n\t\t// Single texture (2D / Cube)\r\n\r\n\t\tsetValueT1 = function( gl, v, renderer ) {\r\n\r\n\t\t\tvar unit = renderer.allocTextureUnit();\r\n\t\t\tgl.uniform1i( this.addr, unit );\r\n\t\t\tif ( v ) renderer.setTexture2D( v, unit );\r\n\r\n\t\t},\r\n\r\n\t\tsetValueT6 = function( gl, v, renderer ) {\r\n\r\n\t\t\tvar unit = renderer.allocTextureUnit();\r\n\t\t\tgl.uniform1i( this.addr, unit );\r\n\t\t\tif ( v ) renderer.setTextureCube( v, unit );\r\n\r\n\t\t},\r\n\r\n\t\t// Integer / Boolean vectors or arrays thereof (always flat arrays)\r\n\r\n\t\tsetValue2iv = function( gl, v ) { gl.uniform2iv( this.addr, v ); },\r\n\t\tsetValue3iv = function( gl, v ) { gl.uniform3iv( this.addr, v ); },\r\n\t\tsetValue4iv = function( gl, v ) { gl.uniform4iv( this.addr, v ); },\r\n\r\n\t\t// Helper to pick the right setter for the singular case\r\n\r\n\t\tgetSingularSetter = function( type ) {\r\n\r\n\t\t\tswitch ( type ) {\r\n\r\n\t\t\t\tcase 0x1406: return setValue1f; // FLOAT\r\n\t\t\t\tcase 0x8b50: return setValue2fv; // _VEC2\r\n\t\t\t\tcase 0x8b51: return setValue3fv; // _VEC3\r\n\t\t\t\tcase 0x8b52: return setValue4fv; // _VEC4\r\n\r\n\t\t\t\tcase 0x8b5a: return setValue2fm; // _MAT2\r\n\t\t\t\tcase 0x8b5b: return setValue3fm; // _MAT3\r\n\t\t\t\tcase 0x8b5c: return setValue4fm; // _MAT4\r\n\r\n\t\t\t\tcase 0x8b5e: return setValueT1; // SAMPLER_2D\r\n\t\t\t\tcase 0x8b60: return setValueT6; // SAMPLER_CUBE\r\n\r\n\t\t\t\tcase 0x1404: case 0x8b56: return setValue1i; // INT, BOOL\r\n\t\t\t\tcase 0x8b53: case 0x8b57: return setValue2iv; // _VEC2\r\n\t\t\t\tcase 0x8b54: case 0x8b58: return setValue3iv; // _VEC3\r\n\t\t\t\tcase 0x8b55: case 0x8b59: return setValue4iv; // _VEC4\r\n\r\n\t\t\t}\r\n\r\n\t\t},\r\n\r\n\t\t// Array of scalars\r\n\r\n\t\tsetValue1fv = function( gl, v ) { gl.uniform1fv( this.addr, v ); },\r\n\t\tsetValue1iv = function( gl, v ) { gl.uniform1iv( this.addr, v ); },\r\n\r\n\t\t// Array of vectors (flat or from THREE classes)\r\n\r\n\t\tsetValueV2a = function( gl, v ) {\r\n\r\n\t\t\tgl.uniform2fv( this.addr, flatten( v, this.size, 2 ) );\r\n\r\n\t\t},\r\n\r\n\t\tsetValueV3a = function( gl, v ) {\r\n\r\n\t\t\tgl.uniform3fv( this.addr, flatten( v, this.size, 3 ) );\r\n\r\n\t\t},\r\n\r\n\t\tsetValueV4a = function( gl, v ) {\r\n\r\n\t\t\tgl.uniform4fv( this.addr, flatten( v, this.size, 4 ) );\r\n\r\n\t\t},\r\n\r\n\t\t// Array of matrices (flat or from THREE clases)\r\n\r\n\t\tsetValueM2a = function( gl, v ) {\r\n\r\n\t\t\tgl.uniformMatrix2fv( this.addr, false, flatten( v, this.size, 4 ) );\r\n\r\n\t\t},\r\n\r\n\t\tsetValueM3a = function( gl, v ) {\r\n\r\n\t\t\tgl.uniformMatrix3fv( this.addr, false, flatten( v, this.size, 9 ) );\r\n\r\n\t\t},\r\n\r\n\t\tsetValueM4a = function( gl, v ) {\r\n\r\n\t\t\tgl.uniformMatrix4fv( this.addr, false, flatten( v, this.size, 16 ) );\r\n\r\n\t\t},\r\n\r\n\t\t// Array of textures (2D / Cube)\r\n\r\n\t\tsetValueT1a = function( gl, v, renderer ) {\r\n\r\n\t\t\tvar n = v.length,\r\n\t\t\t\tunits = allocTexUnits( renderer, n );\r\n\r\n\t\t\tgl.uniform1iv( this.addr, units );\r\n\r\n\t\t\tfor ( var i = 0; i !== n; ++ i ) {\r\n\r\n\t\t\t\tvar tex = v[ i ];\r\n\t\t\t\tif ( tex ) renderer.setTexture2D( tex, units[ i ] );\r\n\r\n\t\t\t}\r\n\r\n\t\t},\r\n\r\n\t\tsetValueT6a = function( gl, v, renderer ) {\r\n\r\n\t\t\tvar n = v.length,\r\n\t\t\t\tunits = allocTexUnits( renderer, n );\r\n\r\n\t\t\tgl.uniform1iv( this.addr, units );\r\n\r\n\t\t\tfor ( var i = 0; i !== n; ++ i ) {\r\n\r\n\t\t\t\tvar tex = v[ i ];\r\n\t\t\t\tif ( tex ) renderer.setTextureCube( tex, units[ i ] );\r\n\r\n\t\t\t}\r\n\r\n\t\t},\r\n\r\n\r\n\t\t// Helper to pick the right setter for a pure (bottom-level) array\r\n\r\n\t\tgetPureArraySetter = function( type ) {\r\n\r\n\t\t\tswitch ( type ) {\r\n\r\n\t\t\t\tcase 0x1406: return setValue1fv; // FLOAT\r\n\t\t\t\tcase 0x8b50: return setValueV2a; // _VEC2\r\n\t\t\t\tcase 0x8b51: return setValueV3a; // _VEC3\r\n\t\t\t\tcase 0x8b52: return setValueV4a; // _VEC4\r\n\r\n\t\t\t\tcase 0x8b5a: return setValueM2a; // _MAT2\r\n\t\t\t\tcase 0x8b5b: return setValueM3a; // _MAT3\r\n\t\t\t\tcase 0x8b5c: return setValueM4a; // _MAT4\r\n\r\n\t\t\t\tcase 0x8b5e: return setValueT1a; // SAMPLER_2D\r\n\t\t\t\tcase 0x8b60: return setValueT6a; // SAMPLER_CUBE\r\n\r\n\t\t\t\tcase 0x1404: case 0x8b56: return setValue1iv; // INT, BOOL\r\n\t\t\t\tcase 0x8b53: case 0x8b57: return setValue2iv; // _VEC2\r\n\t\t\t\tcase 0x8b54: case 0x8b58: return setValue3iv; // _VEC3\r\n\t\t\t\tcase 0x8b55: case 0x8b59: return setValue4iv; // _VEC4\r\n\r\n\t\t\t}\r\n\r\n\t\t},\r\n\r\n\t// --- Uniform Classes ---\r\n\r\n\t\tSingleUniform = function SingleUniform( id, activeInfo, addr ) {\r\n\r\n\t\t\tthis.id = id;\r\n\t\t\tthis.addr = addr;\r\n\t\t\tthis.setValue = getSingularSetter( activeInfo.type );\r\n\r\n\t\t\t// this.path = activeInfo.name; // DEBUG\r\n\r\n\t\t},\r\n\r\n\t\tPureArrayUniform = function( id, activeInfo, addr ) {\r\n\r\n\t\t\tthis.id = id;\r\n\t\t\tthis.addr = addr;\r\n\t\t\tthis.size = activeInfo.size;\r\n\t\t\tthis.setValue = getPureArraySetter( activeInfo.type );\r\n\r\n\t\t\t// this.path = activeInfo.name; // DEBUG\r\n\r\n\t\t},\r\n\r\n\t\tStructuredUniform = function( id ) {\r\n\r\n\t\t\tthis.id = id;\r\n\r\n\t\t\tUniformContainer.call( this ); // mix-in\r\n\r\n\t\t};\r\n\r\n\tStructuredUniform.prototype.setValue = function( gl, value ) {\r\n\r\n\t\t// Note: Don't need an extra 'renderer' parameter, since samplers\r\n\t\t// are not allowed in structured uniforms.\r\n\r\n\t\tvar seq = this.seq;\r\n\r\n\t\tfor ( var i = 0, n = seq.length; i !== n; ++ i ) {\r\n\r\n\t\t\tvar u = seq[ i ];\r\n\t\t\tu.setValue( gl, value[ u.id ] );\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n\t// --- Top-level ---\r\n\r\n\t// Parser - builds up the property tree from the path strings\r\n\r\n\tvar RePathPart = /([\\w\\d_]+)(\\])?(\\[|\\.)?/g,\r\n\t\t// extracts\r\n\t\t// \t- the identifier (member name or array index)\r\n\t\t//  - followed by an optional right bracket (found when array index)\r\n\t\t//  - followed by an optional left bracket or dot (type of subscript)\r\n\t\t//\r\n\t\t// Note: These portions can be read in a non-overlapping fashion and\r\n\t\t// allow straightforward parsing of the hierarchy that WebGL encodes\r\n\t\t// in the uniform names.\r\n\r\n\t\taddUniform = function( container, uniformObject ) {\r\n\r\n\t\t\tcontainer.seq.push( uniformObject );\r\n\t\t\tcontainer.map[ uniformObject.id ] = uniformObject;\r\n\r\n\t\t},\r\n\r\n\t\tparseUniform = function( activeInfo, addr, container ) {\r\n\r\n\t\t\tvar path = activeInfo.name,\r\n\t\t\t\tpathLength = path.length;\r\n\r\n\t\t\t// reset RegExp object, because of the early exit of a previous run\r\n\t\t\tRePathPart.lastIndex = 0;\r\n\r\n\t\t\tfor (; ;) {\r\n\r\n\t\t\t\tvar match = RePathPart.exec( path ),\r\n\t\t\t\t\tmatchEnd = RePathPart.lastIndex,\r\n\r\n\t\t\t\t\tid = match[ 1 ],\r\n\t\t\t\t\tidIsIndex = match[ 2 ] === ']',\r\n\t\t\t\t\tsubscript = match[ 3 ];\r\n\r\n\t\t\t\tif ( idIsIndex ) id = id | 0; // convert to integer\r\n\r\n\t\t\t\tif ( subscript === undefined ||\r\n\t\t\t\t\t\tsubscript === '[' && matchEnd + 2 === pathLength ) {\r\n\t\t\t\t\t// bare name or \"pure\" bottom-level array \"[0]\" suffix\r\n\r\n\t\t\t\t\taddUniform( container, subscript === undefined ?\r\n\t\t\t\t\t\t\tnew SingleUniform( id, activeInfo, addr ) :\r\n\t\t\t\t\t\t\tnew PureArrayUniform( id, activeInfo, addr ) );\r\n\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t} else {\r\n\t\t\t\t\t// step into inner node / create it in case it doesn't exist\r\n\r\n\t\t\t\t\tvar map = container.map,\r\n\t\t\t\t\t\tnext = map[ id ];\r\n\r\n\t\t\t\t\tif ( next === undefined ) {\r\n\r\n\t\t\t\t\t\tnext = new StructuredUniform( id );\r\n\t\t\t\t\t\taddUniform( container, next );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tcontainer = next;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t},\r\n\r\n\t// Root Container\r\n\r\n\t\tWebGLUniforms = function WebGLUniforms( gl, program, renderer ) {\r\n\r\n\t\t\tUniformContainer.call( this );\r\n\r\n\t\t\tthis.renderer = renderer;\r\n\r\n\t\t\tvar n = gl.getProgramParameter( program, gl.ACTIVE_UNIFORMS );\r\n\r\n\t\t\tfor ( var i = 0; i !== n; ++ i ) {\r\n\r\n\t\t\t\tvar info = gl.getActiveUniform( program, i ),\r\n\t\t\t\t\tpath = info.name,\r\n\t\t\t\t\taddr = gl.getUniformLocation( program, path );\r\n\r\n\t\t\t\tparseUniform( info, addr, this );\r\n\r\n\t\t\t}\r\n\r\n\t\t};\r\n\r\n\r\n\tWebGLUniforms.prototype.setValue = function( gl, name, value ) {\r\n\r\n\t\tvar u = this.map[ name ];\r\n\r\n\t\tif ( u !== undefined ) u.setValue( gl, value, this.renderer );\r\n\r\n\t};\r\n\r\n\tWebGLUniforms.prototype.set = function( gl, object, name ) {\r\n\r\n\t\tvar u = this.map[ name ];\r\n\r\n\t\tif ( u !== undefined ) u.setValue( gl, object[ name ], this.renderer );\r\n\r\n\t};\r\n\r\n\tWebGLUniforms.prototype.setOptional = function( gl, object, name ) {\r\n\r\n\t\tvar v = object[ name ];\r\n\r\n\t\tif ( v !== undefined ) this.setValue( gl, name, v );\r\n\r\n\t};\r\n\r\n\r\n\t// Static interface\r\n\r\n\tWebGLUniforms.upload = function( gl, seq, values, renderer ) {\r\n\r\n\t\tfor ( var i = 0, n = seq.length; i !== n; ++ i ) {\r\n\r\n\t\t\tvar u = seq[ i ],\r\n\t\t\t\tv = values[ u.id ];\r\n\r\n\t\t\tif ( v.needsUpdate !== false ) {\r\n\t\t\t\t// note: always updating when .needsUpdate is undefined\r\n\r\n\t\t\t\tu.setValue( gl, v.value, renderer );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n\tWebGLUniforms.seqWithValue = function( seq, values ) {\r\n\r\n\t\tvar r = [];\r\n\r\n\t\tfor ( var i = 0, n = seq.length; i !== n; ++ i ) {\r\n\r\n\t\t\tvar u = seq[ i ];\r\n\t\t\tif ( u.id in values ) r.push( u );\r\n\r\n\t\t}\r\n\r\n\t\treturn r;\r\n\r\n\t};\r\n\r\n\tWebGLUniforms.splitDynamic = function( seq, values ) {\r\n\r\n\t\tvar r = null,\r\n\t\t\tn = seq.length,\r\n\t\t\tw = 0;\r\n\r\n\t\tfor ( var i = 0; i !== n; ++ i ) {\r\n\r\n\t\t\tvar u = seq[ i ],\r\n\t\t\t\tv = values[ u.id ];\r\n\r\n\t\t\tif ( v && v.dynamic === true ) {\r\n\r\n\t\t\t\tif ( r === null ) r = [];\r\n\t\t\t\tr.push( u );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\t// in-place compact 'seq', removing the matches\r\n\t\t\t\tif ( w < i ) seq[ w ] = u;\r\n\t\t\t\t++ w;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tif ( w < n ) seq.length = w;\r\n\r\n\t\treturn r;\r\n\r\n\t};\r\n\r\n\tWebGLUniforms.evalDynamic = function( seq, values, object, camera ) {\r\n\r\n\t\tfor ( var i = 0, n = seq.length; i !== n; ++ i ) {\r\n\r\n\t\t\tvar v = values[ seq[ i ].id ],\r\n\t\t\t\tf = v.onUpdateCallback;\r\n\r\n\t\t\tif ( f !== undefined ) f.call( v, object, camera );\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n\treturn WebGLUniforms;\r\n\r\n} )();\r\n\r\n\r\n// File:src/renderers/webgl/plugins/LensFlarePlugin.js\r\n\r\n/**\r\n * @author mikael emtinger / http://gomo.se/\r\n * @author alteredq / http://alteredqualia.com/\r\n */\r\n\r\nTHREE.LensFlarePlugin = function ( renderer, flares ) {\r\n\r\n\tvar gl = renderer.context;\r\n\tvar state = renderer.state;\r\n\r\n\tvar vertexBuffer, elementBuffer;\r\n\tvar shader, program, attributes, uniforms;\r\n\r\n\tvar tempTexture, occlusionTexture;\r\n\r\n\tfunction init() {\r\n\r\n\t\tvar vertices = new Float32Array( [\r\n\t\t\t- 1, - 1,  0, 0,\r\n\t\t\t 1, - 1,  1, 0,\r\n\t\t\t 1,  1,  1, 1,\r\n\t\t\t- 1,  1,  0, 1\r\n\t\t] );\r\n\r\n\t\tvar faces = new Uint16Array( [\r\n\t\t\t0, 1, 2,\r\n\t\t\t0, 2, 3\r\n\t\t] );\r\n\r\n\t\t// buffers\r\n\r\n\t\tvertexBuffer     = gl.createBuffer();\r\n\t\telementBuffer    = gl.createBuffer();\r\n\r\n\t\tgl.bindBuffer( gl.ARRAY_BUFFER, vertexBuffer );\r\n\t\tgl.bufferData( gl.ARRAY_BUFFER, vertices, gl.STATIC_DRAW );\r\n\r\n\t\tgl.bindBuffer( gl.ELEMENT_ARRAY_BUFFER, elementBuffer );\r\n\t\tgl.bufferData( gl.ELEMENT_ARRAY_BUFFER, faces, gl.STATIC_DRAW );\r\n\r\n\t\t// textures\r\n\r\n\t\ttempTexture      = gl.createTexture();\r\n\t\tocclusionTexture = gl.createTexture();\r\n\r\n\t\tstate.bindTexture( gl.TEXTURE_2D, tempTexture );\r\n\t\tgl.texImage2D( gl.TEXTURE_2D, 0, gl.RGB, 16, 16, 0, gl.RGB, gl.UNSIGNED_BYTE, null );\r\n\t\tgl.texParameteri( gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE );\r\n\t\tgl.texParameteri( gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE );\r\n\t\tgl.texParameteri( gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.NEAREST );\r\n\t\tgl.texParameteri( gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.NEAREST );\r\n\r\n\t\tstate.bindTexture( gl.TEXTURE_2D, occlusionTexture );\r\n\t\tgl.texImage2D( gl.TEXTURE_2D, 0, gl.RGBA, 16, 16, 0, gl.RGBA, gl.UNSIGNED_BYTE, null );\r\n\t\tgl.texParameteri( gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE );\r\n\t\tgl.texParameteri( gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE );\r\n\t\tgl.texParameteri( gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.NEAREST );\r\n\t\tgl.texParameteri( gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.NEAREST );\r\n\r\n\t\tshader = {\r\n\r\n\t\t\tvertexShader: [\r\n\r\n\t\t\t\t\"uniform lowp int renderType;\",\r\n\r\n\t\t\t\t\"uniform vec3 screenPosition;\",\r\n\t\t\t\t\"uniform vec2 scale;\",\r\n\t\t\t\t\"uniform float rotation;\",\r\n\r\n\t\t\t\t\"uniform sampler2D occlusionMap;\",\r\n\r\n\t\t\t\t\"attribute vec2 position;\",\r\n\t\t\t\t\"attribute vec2 uv;\",\r\n\r\n\t\t\t\t\"varying vec2 vUV;\",\r\n\t\t\t\t\"varying float vVisibility;\",\r\n\r\n\t\t\t\t\"void main() {\",\r\n\r\n\t\t\t\t\t\"vUV = uv;\",\r\n\r\n\t\t\t\t\t\"vec2 pos = position;\",\r\n\r\n\t\t\t\t\t\"if ( renderType == 2 ) {\",\r\n\r\n\t\t\t\t\t\t\"vec4 visibility = texture2D( occlusionMap, vec2( 0.1, 0.1 ) );\",\r\n\t\t\t\t\t\t\"visibility += texture2D( occlusionMap, vec2( 0.5, 0.1 ) );\",\r\n\t\t\t\t\t\t\"visibility += texture2D( occlusionMap, vec2( 0.9, 0.1 ) );\",\r\n\t\t\t\t\t\t\"visibility += texture2D( occlusionMap, vec2( 0.9, 0.5 ) );\",\r\n\t\t\t\t\t\t\"visibility += texture2D( occlusionMap, vec2( 0.9, 0.9 ) );\",\r\n\t\t\t\t\t\t\"visibility += texture2D( occlusionMap, vec2( 0.5, 0.9 ) );\",\r\n\t\t\t\t\t\t\"visibility += texture2D( occlusionMap, vec2( 0.1, 0.9 ) );\",\r\n\t\t\t\t\t\t\"visibility += texture2D( occlusionMap, vec2( 0.1, 0.5 ) );\",\r\n\t\t\t\t\t\t\"visibility += texture2D( occlusionMap, vec2( 0.5, 0.5 ) );\",\r\n\r\n\t\t\t\t\t\t\"vVisibility =        visibility.r / 9.0;\",\r\n\t\t\t\t\t\t\"vVisibility *= 1.0 - visibility.g / 9.0;\",\r\n\t\t\t\t\t\t\"vVisibility *=       visibility.b / 9.0;\",\r\n\t\t\t\t\t\t\"vVisibility *= 1.0 - visibility.a / 9.0;\",\r\n\r\n\t\t\t\t\t\t\"pos.x = cos( rotation ) * position.x - sin( rotation ) * position.y;\",\r\n\t\t\t\t\t\t\"pos.y = sin( rotation ) * position.x + cos( rotation ) * position.y;\",\r\n\r\n\t\t\t\t\t\"}\",\r\n\r\n\t\t\t\t\t\"gl_Position = vec4( ( pos * scale + screenPosition.xy ).xy, screenPosition.z, 1.0 );\",\r\n\r\n\t\t\t\t\"}\"\r\n\r\n\t\t\t].join( \"\\n\" ),\r\n\r\n\t\t\tfragmentShader: [\r\n\r\n\t\t\t\t\"uniform lowp int renderType;\",\r\n\r\n\t\t\t\t\"uniform sampler2D map;\",\r\n\t\t\t\t\"uniform float opacity;\",\r\n\t\t\t\t\"uniform vec3 color;\",\r\n\r\n\t\t\t\t\"varying vec2 vUV;\",\r\n\t\t\t\t\"varying float vVisibility;\",\r\n\r\n\t\t\t\t\"void main() {\",\r\n\r\n\t\t\t\t\t// pink square\r\n\r\n\t\t\t\t\t\"if ( renderType == 0 ) {\",\r\n\r\n\t\t\t\t\t\t\"gl_FragColor = vec4( 1.0, 0.0, 1.0, 0.0 );\",\r\n\r\n\t\t\t\t\t// restore\r\n\r\n\t\t\t\t\t\"} else if ( renderType == 1 ) {\",\r\n\r\n\t\t\t\t\t\t\"gl_FragColor = texture2D( map, vUV );\",\r\n\r\n\t\t\t\t\t// flare\r\n\r\n\t\t\t\t\t\"} else {\",\r\n\r\n\t\t\t\t\t\t\"vec4 texture = texture2D( map, vUV );\",\r\n\t\t\t\t\t\t\"texture.a *= opacity * vVisibility;\",\r\n\t\t\t\t\t\t\"gl_FragColor = texture;\",\r\n\t\t\t\t\t\t\"gl_FragColor.rgb *= color;\",\r\n\r\n\t\t\t\t\t\"}\",\r\n\r\n\t\t\t\t\"}\"\r\n\r\n\t\t\t].join( \"\\n\" )\r\n\r\n\t\t};\r\n\r\n\t\tprogram = createProgram( shader );\r\n\r\n\t\tattributes = {\r\n\t\t\tvertex: gl.getAttribLocation ( program, \"position\" ),\r\n\t\t\tuv:     gl.getAttribLocation ( program, \"uv\" )\r\n\t\t};\r\n\r\n\t\tuniforms = {\r\n\t\t\trenderType:     gl.getUniformLocation( program, \"renderType\" ),\r\n\t\t\tmap:            gl.getUniformLocation( program, \"map\" ),\r\n\t\t\tocclusionMap:   gl.getUniformLocation( program, \"occlusionMap\" ),\r\n\t\t\topacity:        gl.getUniformLocation( program, \"opacity\" ),\r\n\t\t\tcolor:          gl.getUniformLocation( program, \"color\" ),\r\n\t\t\tscale:          gl.getUniformLocation( program, \"scale\" ),\r\n\t\t\trotation:       gl.getUniformLocation( program, \"rotation\" ),\r\n\t\t\tscreenPosition: gl.getUniformLocation( program, \"screenPosition\" )\r\n\t\t};\r\n\r\n\t}\r\n\r\n\t/*\r\n\t * Render lens flares\r\n\t * Method: renders 16x16 0xff00ff-colored points scattered over the light source area,\r\n\t *         reads these back and calculates occlusion.\r\n\t */\r\n\r\n\tthis.render = function ( scene, camera, viewport ) {\r\n\r\n\t\tif ( flares.length === 0 ) return;\r\n\r\n\t\tvar tempPosition = new THREE.Vector3();\r\n\r\n\t\tvar invAspect = viewport.w / viewport.z,\r\n\t\t\thalfViewportWidth = viewport.z * 0.5,\r\n\t\t\thalfViewportHeight = viewport.w * 0.5;\r\n\r\n\t\tvar size = 16 / viewport.w,\r\n\t\t\tscale = new THREE.Vector2( size * invAspect, size );\r\n\r\n\t\tvar screenPosition = new THREE.Vector3( 1, 1, 0 ),\r\n\t\t\tscreenPositionPixels = new THREE.Vector2( 1, 1 );\r\n\r\n\t\tvar validArea = new THREE.Box2();\r\n\r\n\t\tvalidArea.min.set( 0, 0 );\r\n\t\tvalidArea.max.set( viewport.z - 16, viewport.w - 16 );\r\n\r\n\t\tif ( program === undefined ) {\r\n\r\n\t\t\tinit();\r\n\r\n\t\t}\r\n\r\n\t\tgl.useProgram( program );\r\n\r\n\t\tstate.initAttributes();\r\n\t\tstate.enableAttribute( attributes.vertex );\r\n\t\tstate.enableAttribute( attributes.uv );\r\n\t\tstate.disableUnusedAttributes();\r\n\r\n\t\t// loop through all lens flares to update their occlusion and positions\r\n\t\t// setup gl and common used attribs/uniforms\r\n\r\n\t\tgl.uniform1i( uniforms.occlusionMap, 0 );\r\n\t\tgl.uniform1i( uniforms.map, 1 );\r\n\r\n\t\tgl.bindBuffer( gl.ARRAY_BUFFER, vertexBuffer );\r\n\t\tgl.vertexAttribPointer( attributes.vertex, 2, gl.FLOAT, false, 2 * 8, 0 );\r\n\t\tgl.vertexAttribPointer( attributes.uv, 2, gl.FLOAT, false, 2 * 8, 8 );\r\n\r\n\t\tgl.bindBuffer( gl.ELEMENT_ARRAY_BUFFER, elementBuffer );\r\n\r\n\t\tstate.disable( gl.CULL_FACE );\r\n\t\tstate.setDepthWrite( false );\r\n\r\n\t\tfor ( var i = 0, l = flares.length; i < l; i ++ ) {\r\n\r\n\t\t\tsize = 16 / viewport.w;\r\n\t\t\tscale.set( size * invAspect, size );\r\n\r\n\t\t\t// calc object screen position\r\n\r\n\t\t\tvar flare = flares[ i ];\r\n\r\n\t\t\ttempPosition.set( flare.matrixWorld.elements[ 12 ], flare.matrixWorld.elements[ 13 ], flare.matrixWorld.elements[ 14 ] );\r\n\r\n\t\t\ttempPosition.applyMatrix4( camera.matrixWorldInverse );\r\n\t\t\ttempPosition.applyProjection( camera.projectionMatrix );\r\n\r\n\t\t\t// setup arrays for gl programs\r\n\r\n\t\t\tscreenPosition.copy( tempPosition );\r\n\r\n\t\t\t// horizontal and vertical coordinate of the lower left corner of the pixels to copy\r\n\r\n\t\t\tscreenPositionPixels.x = viewport.x + ( screenPosition.x * halfViewportWidth ) + halfViewportWidth - 8;\r\n\t\t\tscreenPositionPixels.y = viewport.y + ( screenPosition.y * halfViewportHeight ) + halfViewportHeight - 8;\r\n\r\n\t\t\t// screen cull\r\n\r\n\t\t\tif ( validArea.containsPoint( screenPositionPixels ) === true ) {\r\n\r\n\t\t\t\t// save current RGB to temp texture\r\n\r\n\t\t\t\tstate.activeTexture( gl.TEXTURE0 );\r\n\t\t\t\tstate.bindTexture( gl.TEXTURE_2D, null );\r\n\t\t\t\tstate.activeTexture( gl.TEXTURE1 );\r\n\t\t\t\tstate.bindTexture( gl.TEXTURE_2D, tempTexture );\r\n\t\t\t\tgl.copyTexImage2D( gl.TEXTURE_2D, 0, gl.RGB, screenPositionPixels.x, screenPositionPixels.y, 16, 16, 0 );\r\n\r\n\r\n\t\t\t\t// render pink quad\r\n\r\n\t\t\t\tgl.uniform1i( uniforms.renderType, 0 );\r\n\t\t\t\tgl.uniform2f( uniforms.scale, scale.x, scale.y );\r\n\t\t\t\tgl.uniform3f( uniforms.screenPosition, screenPosition.x, screenPosition.y, screenPosition.z );\r\n\r\n\t\t\t\tstate.disable( gl.BLEND );\r\n\t\t\t\tstate.enable( gl.DEPTH_TEST );\r\n\r\n\t\t\t\tgl.drawElements( gl.TRIANGLES, 6, gl.UNSIGNED_SHORT, 0 );\r\n\r\n\r\n\t\t\t\t// copy result to occlusionMap\r\n\r\n\t\t\t\tstate.activeTexture( gl.TEXTURE0 );\r\n\t\t\t\tstate.bindTexture( gl.TEXTURE_2D, occlusionTexture );\r\n\t\t\t\tgl.copyTexImage2D( gl.TEXTURE_2D, 0, gl.RGBA, screenPositionPixels.x, screenPositionPixels.y, 16, 16, 0 );\r\n\r\n\r\n\t\t\t\t// restore graphics\r\n\r\n\t\t\t\tgl.uniform1i( uniforms.renderType, 1 );\r\n\t\t\t\tstate.disable( gl.DEPTH_TEST );\r\n\r\n\t\t\t\tstate.activeTexture( gl.TEXTURE1 );\r\n\t\t\t\tstate.bindTexture( gl.TEXTURE_2D, tempTexture );\r\n\t\t\t\tgl.drawElements( gl.TRIANGLES, 6, gl.UNSIGNED_SHORT, 0 );\r\n\r\n\r\n\t\t\t\t// update object positions\r\n\r\n\t\t\t\tflare.positionScreen.copy( screenPosition );\r\n\r\n\t\t\t\tif ( flare.customUpdateCallback ) {\r\n\r\n\t\t\t\t\tflare.customUpdateCallback( flare );\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tflare.updateLensFlares();\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// render flares\r\n\r\n\t\t\t\tgl.uniform1i( uniforms.renderType, 2 );\r\n\t\t\t\tstate.enable( gl.BLEND );\r\n\r\n\t\t\t\tfor ( var j = 0, jl = flare.lensFlares.length; j < jl; j ++ ) {\r\n\r\n\t\t\t\t\tvar sprite = flare.lensFlares[ j ];\r\n\r\n\t\t\t\t\tif ( sprite.opacity > 0.001 && sprite.scale > 0.001 ) {\r\n\r\n\t\t\t\t\t\tscreenPosition.x = sprite.x;\r\n\t\t\t\t\t\tscreenPosition.y = sprite.y;\r\n\t\t\t\t\t\tscreenPosition.z = sprite.z;\r\n\r\n\t\t\t\t\t\tsize = sprite.size * sprite.scale / viewport.w;\r\n\r\n\t\t\t\t\t\tscale.x = size * invAspect;\r\n\t\t\t\t\t\tscale.y = size;\r\n\r\n\t\t\t\t\t\tgl.uniform3f( uniforms.screenPosition, screenPosition.x, screenPosition.y, screenPosition.z );\r\n\t\t\t\t\t\tgl.uniform2f( uniforms.scale, scale.x, scale.y );\r\n\t\t\t\t\t\tgl.uniform1f( uniforms.rotation, sprite.rotation );\r\n\r\n\t\t\t\t\t\tgl.uniform1f( uniforms.opacity, sprite.opacity );\r\n\t\t\t\t\t\tgl.uniform3f( uniforms.color, sprite.color.r, sprite.color.g, sprite.color.b );\r\n\r\n\t\t\t\t\t\tstate.setBlending( sprite.blending, sprite.blendEquation, sprite.blendSrc, sprite.blendDst );\r\n\t\t\t\t\t\trenderer.setTexture2D( sprite.texture, 1 );\r\n\r\n\t\t\t\t\t\tgl.drawElements( gl.TRIANGLES, 6, gl.UNSIGNED_SHORT, 0 );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\t// restore gl\r\n\r\n\t\tstate.enable( gl.CULL_FACE );\r\n\t\tstate.enable( gl.DEPTH_TEST );\r\n\t\tstate.setDepthWrite( true );\r\n\r\n\t\trenderer.resetGLState();\r\n\r\n\t};\r\n\r\n\tfunction createProgram ( shader ) {\r\n\r\n\t\tvar program = gl.createProgram();\r\n\r\n\t\tvar fragmentShader = gl.createShader( gl.FRAGMENT_SHADER );\r\n\t\tvar vertexShader = gl.createShader( gl.VERTEX_SHADER );\r\n\r\n\t\tvar prefix = \"precision \" + renderer.getPrecision() + \" float;\\n\";\r\n\r\n\t\tgl.shaderSource( fragmentShader, prefix + shader.fragmentShader );\r\n\t\tgl.shaderSource( vertexShader, prefix + shader.vertexShader );\r\n\r\n\t\tgl.compileShader( fragmentShader );\r\n\t\tgl.compileShader( vertexShader );\r\n\r\n\t\tgl.attachShader( program, fragmentShader );\r\n\t\tgl.attachShader( program, vertexShader );\r\n\r\n\t\tgl.linkProgram( program );\r\n\r\n\t\treturn program;\r\n\r\n\t}\r\n\r\n};\r\n\r\n// File:src/renderers/webgl/plugins/SpritePlugin.js\r\n\r\n/**\r\n * @author mikael emtinger / http://gomo.se/\r\n * @author alteredq / http://alteredqualia.com/\r\n */\r\n\r\nTHREE.SpritePlugin = function ( renderer, sprites ) {\r\n\r\n\tvar gl = renderer.context;\r\n\tvar state = renderer.state;\r\n\r\n\tvar vertexBuffer, elementBuffer;\r\n\tvar program, attributes, uniforms;\r\n\r\n\tvar texture;\r\n\r\n\t// decompose matrixWorld\r\n\r\n\tvar spritePosition = new THREE.Vector3();\r\n\tvar spriteRotation = new THREE.Quaternion();\r\n\tvar spriteScale = new THREE.Vector3();\r\n\r\n\tfunction init() {\r\n\r\n\t\tvar vertices = new Float32Array( [\r\n\t\t\t- 0.5, - 0.5,  0, 0,\r\n\t\t\t  0.5, - 0.5,  1, 0,\r\n\t\t\t  0.5,   0.5,  1, 1,\r\n\t\t\t- 0.5,   0.5,  0, 1\r\n\t\t] );\r\n\r\n\t\tvar faces = new Uint16Array( [\r\n\t\t\t0, 1, 2,\r\n\t\t\t0, 2, 3\r\n\t\t] );\r\n\r\n\t\tvertexBuffer  = gl.createBuffer();\r\n\t\telementBuffer = gl.createBuffer();\r\n\r\n\t\tgl.bindBuffer( gl.ARRAY_BUFFER, vertexBuffer );\r\n\t\tgl.bufferData( gl.ARRAY_BUFFER, vertices, gl.STATIC_DRAW );\r\n\r\n\t\tgl.bindBuffer( gl.ELEMENT_ARRAY_BUFFER, elementBuffer );\r\n\t\tgl.bufferData( gl.ELEMENT_ARRAY_BUFFER, faces, gl.STATIC_DRAW );\r\n\r\n\t\tprogram = createProgram();\r\n\r\n\t\tattributes = {\r\n\t\t\tposition:\t\t\tgl.getAttribLocation ( program, 'position' ),\r\n\t\t\tuv:\t\t\t\t\tgl.getAttribLocation ( program, 'uv' )\r\n\t\t};\r\n\r\n\t\tuniforms = {\r\n\t\t\tuvOffset:\t\t\tgl.getUniformLocation( program, 'uvOffset' ),\r\n\t\t\tuvScale:\t\t\tgl.getUniformLocation( program, 'uvScale' ),\r\n\r\n\t\t\trotation:\t\t\tgl.getUniformLocation( program, 'rotation' ),\r\n\t\t\tscale:\t\t\t\tgl.getUniformLocation( program, 'scale' ),\r\n\r\n\t\t\tcolor:\t\t\t\tgl.getUniformLocation( program, 'color' ),\r\n\t\t\tmap:\t\t\t\tgl.getUniformLocation( program, 'map' ),\r\n\t\t\topacity:\t\t\tgl.getUniformLocation( program, 'opacity' ),\r\n\r\n\t\t\tmodelViewMatrix: \tgl.getUniformLocation( program, 'modelViewMatrix' ),\r\n\t\t\tprojectionMatrix:\tgl.getUniformLocation( program, 'projectionMatrix' ),\r\n\r\n\t\t\tfogType:\t\t\tgl.getUniformLocation( program, 'fogType' ),\r\n\t\t\tfogDensity:\t\t\tgl.getUniformLocation( program, 'fogDensity' ),\r\n\t\t\tfogNear:\t\t\tgl.getUniformLocation( program, 'fogNear' ),\r\n\t\t\tfogFar:\t\t\t\tgl.getUniformLocation( program, 'fogFar' ),\r\n\t\t\tfogColor:\t\t\tgl.getUniformLocation( program, 'fogColor' ),\r\n\r\n\t\t\talphaTest:\t\t\tgl.getUniformLocation( program, 'alphaTest' )\r\n\t\t};\r\n\r\n\t\tvar canvas = document.createElement( 'canvas' );\r\n\t\tcanvas.width = 8;\r\n\t\tcanvas.height = 8;\r\n\r\n\t\tvar context = canvas.getContext( '2d' );\r\n\t\tcontext.fillStyle = 'white';\r\n\t\tcontext.fillRect( 0, 0, 8, 8 );\r\n\r\n\t\ttexture = new THREE.Texture( canvas );\r\n\t\ttexture.needsUpdate = true;\r\n\r\n\t}\r\n\r\n\tthis.render = function ( scene, camera ) {\r\n\r\n\t\tif ( sprites.length === 0 ) return;\r\n\r\n\t\t// setup gl\r\n\r\n\t\tif ( program === undefined ) {\r\n\r\n\t\t\tinit();\r\n\r\n\t\t}\r\n\r\n\t\tgl.useProgram( program );\r\n\r\n\t\tstate.initAttributes();\r\n\t\tstate.enableAttribute( attributes.position );\r\n\t\tstate.enableAttribute( attributes.uv );\r\n\t\tstate.disableUnusedAttributes();\r\n\r\n\t\tstate.disable( gl.CULL_FACE );\r\n\t\tstate.enable( gl.BLEND );\r\n\r\n\t\tgl.bindBuffer( gl.ARRAY_BUFFER, vertexBuffer );\r\n\t\tgl.vertexAttribPointer( attributes.position, 2, gl.FLOAT, false, 2 * 8, 0 );\r\n\t\tgl.vertexAttribPointer( attributes.uv, 2, gl.FLOAT, false, 2 * 8, 8 );\r\n\r\n\t\tgl.bindBuffer( gl.ELEMENT_ARRAY_BUFFER, elementBuffer );\r\n\r\n\t\tgl.uniformMatrix4fv( uniforms.projectionMatrix, false, camera.projectionMatrix.elements );\r\n\r\n\t\tstate.activeTexture( gl.TEXTURE0 );\r\n\t\tgl.uniform1i( uniforms.map, 0 );\r\n\r\n\t\tvar oldFogType = 0;\r\n\t\tvar sceneFogType = 0;\r\n\t\tvar fog = scene.fog;\r\n\r\n\t\tif ( fog ) {\r\n\r\n\t\t\tgl.uniform3f( uniforms.fogColor, fog.color.r, fog.color.g, fog.color.b );\r\n\r\n\t\t\tif ( fog instanceof THREE.Fog ) {\r\n\r\n\t\t\t\tgl.uniform1f( uniforms.fogNear, fog.near );\r\n\t\t\t\tgl.uniform1f( uniforms.fogFar, fog.far );\r\n\r\n\t\t\t\tgl.uniform1i( uniforms.fogType, 1 );\r\n\t\t\t\toldFogType = 1;\r\n\t\t\t\tsceneFogType = 1;\r\n\r\n\t\t\t} else if ( fog instanceof THREE.FogExp2 ) {\r\n\r\n\t\t\t\tgl.uniform1f( uniforms.fogDensity, fog.density );\r\n\r\n\t\t\t\tgl.uniform1i( uniforms.fogType, 2 );\r\n\t\t\t\toldFogType = 2;\r\n\t\t\t\tsceneFogType = 2;\r\n\r\n\t\t\t}\r\n\r\n\t\t} else {\r\n\r\n\t\t\tgl.uniform1i( uniforms.fogType, 0 );\r\n\t\t\toldFogType = 0;\r\n\t\t\tsceneFogType = 0;\r\n\r\n\t\t}\r\n\r\n\r\n\t\t// update positions and sort\r\n\r\n\t\tfor ( var i = 0, l = sprites.length; i < l; i ++ ) {\r\n\r\n\t\t\tvar sprite = sprites[ i ];\r\n\r\n\t\t\tsprite.modelViewMatrix.multiplyMatrices( camera.matrixWorldInverse, sprite.matrixWorld );\r\n\t\t\tsprite.z = - sprite.modelViewMatrix.elements[ 14 ];\r\n\r\n\t\t}\r\n\r\n\t\tsprites.sort( painterSortStable );\r\n\r\n\t\t// render all sprites\r\n\r\n\t\tvar scale = [];\r\n\r\n\t\tfor ( var i = 0, l = sprites.length; i < l; i ++ ) {\r\n\r\n\t\t\tvar sprite = sprites[ i ];\r\n\t\t\tvar material = sprite.material;\r\n\r\n\t\t\tgl.uniform1f( uniforms.alphaTest, material.alphaTest );\r\n\t\t\tgl.uniformMatrix4fv( uniforms.modelViewMatrix, false, sprite.modelViewMatrix.elements );\r\n\r\n\t\t\tsprite.matrixWorld.decompose( spritePosition, spriteRotation, spriteScale );\r\n\r\n\t\t\tscale[ 0 ] = spriteScale.x;\r\n\t\t\tscale[ 1 ] = spriteScale.y;\r\n\r\n\t\t\tvar fogType = 0;\r\n\r\n\t\t\tif ( scene.fog && material.fog ) {\r\n\r\n\t\t\t\tfogType = sceneFogType;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( oldFogType !== fogType ) {\r\n\r\n\t\t\t\tgl.uniform1i( uniforms.fogType, fogType );\r\n\t\t\t\toldFogType = fogType;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( material.map !== null ) {\r\n\r\n\t\t\t\tgl.uniform2f( uniforms.uvOffset, material.map.offset.x, material.map.offset.y );\r\n\t\t\t\tgl.uniform2f( uniforms.uvScale, material.map.repeat.x, material.map.repeat.y );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tgl.uniform2f( uniforms.uvOffset, 0, 0 );\r\n\t\t\t\tgl.uniform2f( uniforms.uvScale, 1, 1 );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tgl.uniform1f( uniforms.opacity, material.opacity );\r\n\t\t\tgl.uniform3f( uniforms.color, material.color.r, material.color.g, material.color.b );\r\n\r\n\t\t\tgl.uniform1f( uniforms.rotation, material.rotation );\r\n\t\t\tgl.uniform2fv( uniforms.scale, scale );\r\n\r\n\t\t\tstate.setBlending( material.blending, material.blendEquation, material.blendSrc, material.blendDst );\r\n\t\t\tstate.setDepthTest( material.depthTest );\r\n\t\t\tstate.setDepthWrite( material.depthWrite );\r\n\r\n\t\t\tif ( material.map ) {\r\n\r\n\t\t\t\trenderer.setTexture2D( material.map, 0 );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\trenderer.setTexture2D( texture, 0 );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tgl.drawElements( gl.TRIANGLES, 6, gl.UNSIGNED_SHORT, 0 );\r\n\r\n\t\t}\r\n\r\n\t\t// restore gl\r\n\r\n\t\tstate.enable( gl.CULL_FACE );\r\n\r\n\t\trenderer.resetGLState();\r\n\r\n\t};\r\n\r\n\tfunction createProgram () {\r\n\r\n\t\tvar program = gl.createProgram();\r\n\r\n\t\tvar vertexShader = gl.createShader( gl.VERTEX_SHADER );\r\n\t\tvar fragmentShader = gl.createShader( gl.FRAGMENT_SHADER );\r\n\r\n\t\tgl.shaderSource( vertexShader, [\r\n\r\n\t\t\t'precision ' + renderer.getPrecision() + ' float;',\r\n\r\n\t\t\t'uniform mat4 modelViewMatrix;',\r\n\t\t\t'uniform mat4 projectionMatrix;',\r\n\t\t\t'uniform float rotation;',\r\n\t\t\t'uniform vec2 scale;',\r\n\t\t\t'uniform vec2 uvOffset;',\r\n\t\t\t'uniform vec2 uvScale;',\r\n\r\n\t\t\t'attribute vec2 position;',\r\n\t\t\t'attribute vec2 uv;',\r\n\r\n\t\t\t'varying vec2 vUV;',\r\n\r\n\t\t\t'void main() {',\r\n\r\n\t\t\t\t'vUV = uvOffset + uv * uvScale;',\r\n\r\n\t\t\t\t'vec2 alignedPosition = position * scale;',\r\n\r\n\t\t\t\t'vec2 rotatedPosition;',\r\n\t\t\t\t'rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;',\r\n\t\t\t\t'rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;',\r\n\r\n\t\t\t\t'vec4 finalPosition;',\r\n\r\n\t\t\t\t'finalPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );',\r\n\t\t\t\t'finalPosition.xy += rotatedPosition;',\r\n\t\t\t\t'finalPosition = projectionMatrix * finalPosition;',\r\n\r\n\t\t\t\t'gl_Position = finalPosition;',\r\n\r\n\t\t\t'}'\r\n\r\n\t\t].join( '\\n' ) );\r\n\r\n\t\tgl.shaderSource( fragmentShader, [\r\n\r\n\t\t\t'precision ' + renderer.getPrecision() + ' float;',\r\n\r\n\t\t\t'uniform vec3 color;',\r\n\t\t\t'uniform sampler2D map;',\r\n\t\t\t'uniform float opacity;',\r\n\r\n\t\t\t'uniform int fogType;',\r\n\t\t\t'uniform vec3 fogColor;',\r\n\t\t\t'uniform float fogDensity;',\r\n\t\t\t'uniform float fogNear;',\r\n\t\t\t'uniform float fogFar;',\r\n\t\t\t'uniform float alphaTest;',\r\n\r\n\t\t\t'varying vec2 vUV;',\r\n\r\n\t\t\t'void main() {',\r\n\r\n\t\t\t\t'vec4 texture = texture2D( map, vUV );',\r\n\r\n\t\t\t\t'if ( texture.a < alphaTest ) discard;',\r\n\r\n\t\t\t\t'gl_FragColor = vec4( color * texture.xyz, texture.a * opacity );',\r\n\r\n\t\t\t\t'if ( fogType > 0 ) {',\r\n\r\n\t\t\t\t\t'float depth = gl_FragCoord.z / gl_FragCoord.w;',\r\n\t\t\t\t\t'float fogFactor = 0.0;',\r\n\r\n\t\t\t\t\t'if ( fogType == 1 ) {',\r\n\r\n\t\t\t\t\t\t'fogFactor = smoothstep( fogNear, fogFar, depth );',\r\n\r\n\t\t\t\t\t'} else {',\r\n\r\n\t\t\t\t\t\t'const float LOG2 = 1.442695;',\r\n\t\t\t\t\t\t'fogFactor = exp2( - fogDensity * fogDensity * depth * depth * LOG2 );',\r\n\t\t\t\t\t\t'fogFactor = 1.0 - clamp( fogFactor, 0.0, 1.0 );',\r\n\r\n\t\t\t\t\t'}',\r\n\r\n\t\t\t\t\t'gl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );',\r\n\r\n\t\t\t\t'}',\r\n\r\n\t\t\t'}'\r\n\r\n\t\t].join( '\\n' ) );\r\n\r\n\t\tgl.compileShader( vertexShader );\r\n\t\tgl.compileShader( fragmentShader );\r\n\r\n\t\tgl.attachShader( program, vertexShader );\r\n\t\tgl.attachShader( program, fragmentShader );\r\n\r\n\t\tgl.linkProgram( program );\r\n\r\n\t\treturn program;\r\n\r\n\t}\r\n\r\n\tfunction painterSortStable ( a, b ) {\r\n\t\t\r\n\t\tif ( a.renderOrder !== b.renderOrder ) {\r\n\r\n\t\t\treturn a.renderOrder - b.renderOrder;\r\n\r\n\t\t} else if ( a.z !== b.z ) {\r\n\r\n\t\t\treturn b.z - a.z;\r\n\r\n\t\t} else {\r\n\r\n\t\t\treturn b.id - a.id;\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n};\r\n\r\n// File:src/Three.Legacy.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nObject.defineProperties( THREE.Box2.prototype, {\r\n\tempty: {\r\n\t\tvalue: function () {\r\n\t\t\tconsole.warn( 'THREE.Box2: .empty() has been renamed to .isEmpty().' );\r\n\t\t\treturn this.isEmpty();\r\n\t\t}\r\n\t},\r\n\tisIntersectionBox: {\r\n\t\tvalue: function ( box ) {\r\n\t\t\tconsole.warn( 'THREE.Box2: .isIntersectionBox() has been renamed to .intersectsBox().' );\r\n\t\t\treturn this.intersectsBox( box );\r\n\t\t}\r\n\t}\r\n} );\r\n\r\nObject.defineProperties( THREE.Box3.prototype, {\r\n\tempty: {\r\n\t\tvalue: function () {\r\n\t\t\tconsole.warn( 'THREE.Box3: .empty() has been renamed to .isEmpty().' );\r\n\t\t\treturn this.isEmpty();\r\n\t\t}\r\n\t},\r\n\tisIntersectionBox: {\r\n\t\tvalue: function ( box ) {\r\n\t\t\tconsole.warn( 'THREE.Box3: .isIntersectionBox() has been renamed to .intersectsBox().' );\r\n\t\t\treturn this.intersectsBox( box );\r\n\t\t}\r\n\t},\r\n\tisIntersectionSphere: {\r\n\t\tvalue: function ( sphere ) {\r\n\t\t\tconsole.warn( 'THREE.Box3: .isIntersectionSphere() has been renamed to .intersectsSphere().' );\r\n\t\t\treturn this.intersectsSphere( sphere );\r\n\t\t}\r\n\t}\r\n} );\r\n\r\nObject.defineProperties( THREE.Matrix3.prototype, {\r\n\tmultiplyVector3: {\r\n\t\tvalue: function ( vector ) {\r\n\t\t\tconsole.warn( 'THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead.' );\r\n\t\t\treturn vector.applyMatrix3( this );\r\n\t\t}\r\n\t},\r\n\tmultiplyVector3Array: {\r\n\t\tvalue: function ( a ) {\r\n\t\t\tconsole.warn( 'THREE.Matrix3: .multiplyVector3Array() has been renamed. Use matrix.applyToVector3Array( array ) instead.' );\r\n\t\t\treturn this.applyToVector3Array( a );\r\n\t\t}\r\n\t}\r\n} );\r\n\r\nObject.defineProperties( THREE.Matrix4.prototype, {\r\n\textractPosition: {\r\n\t\tvalue: function ( m ) {\r\n\t\t\tconsole.warn( 'THREE.Matrix4: .extractPosition() has been renamed to .copyPosition().' );\r\n\t\t\treturn this.copyPosition( m );\r\n\t\t}\r\n\t},\r\n\tsetRotationFromQuaternion: {\r\n\t\tvalue: function ( q ) {\r\n\t\t\tconsole.warn( 'THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion().' );\r\n\t\t\treturn this.makeRotationFromQuaternion( q );\r\n\t\t}\r\n\t},\r\n\tmultiplyVector3: {\r\n\t\tvalue: function ( vector ) {\r\n\t\t\tconsole.warn( 'THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) or vector.applyProjection( matrix ) instead.' );\r\n\t\t\treturn vector.applyProjection( this );\r\n\t\t}\r\n\t},\r\n\tmultiplyVector4: {\r\n\t\tvalue: function ( vector ) {\r\n\t\t\tconsole.warn( 'THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead.' );\r\n\t\t\treturn vector.applyMatrix4( this );\r\n\t\t}\r\n\t},\r\n\tmultiplyVector3Array: {\r\n\t\tvalue: function ( a ) {\r\n\t\t\tconsole.warn( 'THREE.Matrix4: .multiplyVector3Array() has been renamed. Use matrix.applyToVector3Array( array ) instead.' );\r\n\t\t\treturn this.applyToVector3Array( a );\r\n\t\t}\r\n\t},\r\n\trotateAxis: {\r\n\t\tvalue: function ( v ) {\r\n\t\t\tconsole.warn( 'THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead.' );\r\n\t\t\tv.transformDirection( this );\r\n\t\t}\r\n\t},\r\n\tcrossVector: {\r\n\t\tvalue: function ( vector ) {\r\n\t\t\tconsole.warn( 'THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead.' );\r\n\t\t\treturn vector.applyMatrix4( this );\r\n\t\t}\r\n\t},\r\n\ttranslate: {\r\n\t\tvalue: function ( v ) {\r\n\t\t\tconsole.error( 'THREE.Matrix4: .translate() has been removed.' );\r\n\t\t}\r\n\t},\r\n\trotateX: {\r\n\t\tvalue: function ( angle ) {\r\n\t\t\tconsole.error( 'THREE.Matrix4: .rotateX() has been removed.' );\r\n\t\t}\r\n\t},\r\n\trotateY: {\r\n\t\tvalue: function ( angle ) {\r\n\t\t\tconsole.error( 'THREE.Matrix4: .rotateY() has been removed.' );\r\n\t\t}\r\n\t},\r\n\trotateZ: {\r\n\t\tvalue: function ( angle ) {\r\n\t\t\tconsole.error( 'THREE.Matrix4: .rotateZ() has been removed.' );\r\n\t\t}\r\n\t},\r\n\trotateByAxis: {\r\n\t\tvalue: function ( axis, angle ) {\r\n\t\t\tconsole.error( 'THREE.Matrix4: .rotateByAxis() has been removed.' );\r\n\t\t}\r\n\t}\r\n} );\r\n\r\nObject.defineProperties( THREE.Plane.prototype, {\r\n\tisIntersectionLine: {\r\n\t\tvalue: function ( line ) {\r\n\t\t\tconsole.warn( 'THREE.Plane: .isIntersectionLine() has been renamed to .intersectsLine().' );\r\n\t\t\treturn this.intersectsLine( line );\r\n\t\t}\r\n\t}\r\n} );\r\n\r\nObject.defineProperties( THREE.Quaternion.prototype, {\r\n\tmultiplyVector3: {\r\n\t\tvalue: function ( vector ) {\r\n\t\t\tconsole.warn( 'THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead.' );\r\n\t\t\treturn vector.applyQuaternion( this );\r\n\t\t}\r\n\t}\r\n} );\r\n\r\nObject.defineProperties( THREE.Ray.prototype, {\r\n\tisIntersectionBox: {\r\n\t\tvalue: function ( box ) {\r\n\t\t\tconsole.warn( 'THREE.Ray: .isIntersectionBox() has been renamed to .intersectsBox().' );\r\n\t\t\treturn this.intersectsBox( box );\r\n\t\t}\r\n\t},\r\n\tisIntersectionPlane: {\r\n\t\tvalue: function ( plane ) {\r\n\t\t\tconsole.warn( 'THREE.Ray: .isIntersectionPlane() has been renamed to .intersectsPlane().' );\r\n\t\t\treturn this.intersectsPlane( plane );\r\n\t\t}\r\n\t},\r\n\tisIntersectionSphere: {\r\n\t\tvalue: function ( sphere ) {\r\n\t\t\tconsole.warn( 'THREE.Ray: .isIntersectionSphere() has been renamed to .intersectsSphere().' );\r\n\t\t\treturn this.intersectsSphere( sphere );\r\n\t\t}\r\n\t}\r\n} );\r\n\r\nObject.defineProperties( THREE.Vector3.prototype, {\r\n\tsetEulerFromRotationMatrix: {\r\n\t\tvalue: function () {\r\n\t\t\tconsole.error( 'THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.' );\r\n\t\t}\r\n\t},\r\n\tsetEulerFromQuaternion: {\r\n\t\tvalue: function () {\r\n\t\t\tconsole.error( 'THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.' );\r\n\t\t}\r\n\t},\r\n\tgetPositionFromMatrix: {\r\n\t\tvalue: function ( m ) {\r\n\t\t\tconsole.warn( 'THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition().' );\r\n\t\t\treturn this.setFromMatrixPosition( m );\r\n\t\t}\r\n\t},\r\n\tgetScaleFromMatrix: {\r\n\t\tvalue: function ( m ) {\r\n\t\t\tconsole.warn( 'THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale().' );\r\n\t\t\treturn this.setFromMatrixScale( m );\r\n\t\t}\r\n\t},\r\n\tgetColumnFromMatrix: {\r\n\t\tvalue: function ( index, matrix ) {\r\n\t\t\tconsole.warn( 'THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn().' );\r\n\t\t\treturn this.setFromMatrixColumn( index, matrix );\r\n\t\t}\r\n\t}\r\n} );\r\n\r\n//\r\n\r\nTHREE.Face4 = function ( a, b, c, d, normal, color, materialIndex ) {\r\n\r\n\tconsole.warn( 'THREE.Face4 has been removed. A THREE.Face3 will be created instead.' );\r\n\treturn new THREE.Face3( a, b, c, normal, color, materialIndex );\r\n\r\n};\r\n\r\nTHREE.Vertex = function ( x, y, z ) {\r\n\r\n\tconsole.warn( 'THREE.Vertex has been removed. Use THREE.Vector3 instead.' );\r\n\treturn new THREE.Vector3( x, y, z );\r\n\r\n};\r\n\r\n//\r\n\r\nObject.defineProperties( THREE.Object3D.prototype, {\r\n\teulerOrder: {\r\n\t\tget: function () {\r\n\t\t\tconsole.warn( 'THREE.Object3D: .eulerOrder is now .rotation.order.' );\r\n\t\t\treturn this.rotation.order;\r\n\t\t},\r\n\t\tset: function ( value ) {\r\n\t\t\tconsole.warn( 'THREE.Object3D: .eulerOrder is now .rotation.order.' );\r\n\t\t\tthis.rotation.order = value;\r\n\t\t}\r\n\t},\r\n\tgetChildByName: {\r\n\t\tvalue: function ( name ) {\r\n\t\t\tconsole.warn( 'THREE.Object3D: .getChildByName() has been renamed to .getObjectByName().' );\r\n\t\t\treturn this.getObjectByName( name );\r\n\t\t}\r\n\t},\r\n\trenderDepth: {\r\n\t\tset: function ( value ) {\r\n\t\t\tconsole.warn( 'THREE.Object3D: .renderDepth has been removed. Use .renderOrder, instead.' );\r\n\t\t}\r\n\t},\r\n\ttranslate: {\r\n\t\tvalue: function ( distance, axis ) {\r\n\t\t\tconsole.warn( 'THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead.' );\r\n\t\t\treturn this.translateOnAxis( axis, distance );\r\n\t\t}\r\n\t},\r\n\tuseQuaternion: {\r\n\t\tget: function () {\r\n\t\t\tconsole.warn( 'THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.' );\r\n\t\t},\r\n\t\tset: function ( value ) {\r\n\t\t\tconsole.warn( 'THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.' );\r\n\t\t}\r\n\t}\r\n} );\r\n\r\n//\r\n\r\nObject.defineProperties( THREE, {\r\n\tPointCloud: {\r\n\t\tvalue: function ( geometry, material ) {\r\n\t\t\tconsole.warn( 'THREE.PointCloud has been renamed to THREE.Points.' );\r\n\t\t\treturn new THREE.Points( geometry, material );\r\n\t\t}\r\n\t},\r\n\tParticleSystem: {\r\n\t\tvalue: function ( geometry, material ) {\r\n\t\t\tconsole.warn( 'THREE.ParticleSystem has been renamed to THREE.Points.' );\r\n\t\t\treturn new THREE.Points( geometry, material );\r\n\t\t}\r\n\t}\r\n} );\r\n\r\n//\r\n\r\nObject.defineProperties( THREE.Light.prototype, {\r\n\tonlyShadow: {\r\n\t\tset: function ( value ) {\r\n\t\t\tconsole.warn( 'THREE.Light: .onlyShadow has been removed.' );\r\n\t\t}\r\n\t},\r\n\tshadowCameraFov: {\r\n\t\tset: function ( value ) {\r\n\t\t\tconsole.warn( 'THREE.Light: .shadowCameraFov is now .shadow.camera.fov.' );\r\n\t\t\tthis.shadow.camera.fov = value;\r\n\t\t}\r\n\t},\r\n\tshadowCameraLeft: {\r\n\t\tset: function ( value ) {\r\n\t\t\tconsole.warn( 'THREE.Light: .shadowCameraLeft is now .shadow.camera.left.' );\r\n\t\t\tthis.shadow.camera.left = value;\r\n\t\t}\r\n\t},\r\n\tshadowCameraRight: {\r\n\t\tset: function ( value ) {\r\n\t\t\tconsole.warn( 'THREE.Light: .shadowCameraRight is now .shadow.camera.right.' );\r\n\t\t\tthis.shadow.camera.right = value;\r\n\t\t}\r\n\t},\r\n\tshadowCameraTop: {\r\n\t\tset: function ( value ) {\r\n\t\t\tconsole.warn( 'THREE.Light: .shadowCameraTop is now .shadow.camera.top.' );\r\n\t\t\tthis.shadow.camera.top = value;\r\n\t\t}\r\n\t},\r\n\tshadowCameraBottom: {\r\n\t\tset: function ( value ) {\r\n\t\t\tconsole.warn( 'THREE.Light: .shadowCameraBottom is now .shadow.camera.bottom.' );\r\n\t\t\tthis.shadow.camera.bottom = value;\r\n\t\t}\r\n\t},\r\n\tshadowCameraNear: {\r\n\t\tset: function ( value ) {\r\n\t\t\tconsole.warn( 'THREE.Light: .shadowCameraNear is now .shadow.camera.near.' );\r\n\t\t\tthis.shadow.camera.near = value;\r\n\t\t}\r\n\t},\r\n\tshadowCameraFar: {\r\n\t\tset: function ( value ) {\r\n\t\t\tconsole.warn( 'THREE.Light: .shadowCameraFar is now .shadow.camera.far.' );\r\n\t\t\tthis.shadow.camera.far = value;\r\n\t\t}\r\n\t},\r\n\tshadowCameraVisible: {\r\n\t\tset: function ( value ) {\r\n\t\t\tconsole.warn( 'THREE.Light: .shadowCameraVisible has been removed. Use new THREE.CameraHelper( light.shadow.camera ) instead.' );\r\n\t\t}\r\n\t},\r\n\tshadowBias: {\r\n\t\tset: function ( value ) {\r\n\t\t\tconsole.warn( 'THREE.Light: .shadowBias is now .shadow.bias.' );\r\n\t\t\tthis.shadow.bias = value;\r\n\t\t}\r\n\t},\r\n\tshadowDarkness: {\r\n\t\tset: function ( value ) {\r\n\t\t\tconsole.warn( 'THREE.Light: .shadowDarkness has been removed.' );\r\n\t\t}\r\n\t},\r\n\tshadowMapWidth: {\r\n\t\tset: function ( value ) {\r\n\t\t\tconsole.warn( 'THREE.Light: .shadowMapWidth is now .shadow.mapSize.width.' );\r\n\t\t\tthis.shadow.mapSize.width = value;\r\n\t\t}\r\n\t},\r\n\tshadowMapHeight: {\r\n\t\tset: function ( value ) {\r\n\t\t\tconsole.warn( 'THREE.Light: .shadowMapHeight is now .shadow.mapSize.height.' );\r\n\t\t\tthis.shadow.mapSize.height = value;\r\n\t\t}\r\n\t}\r\n} );\r\n\r\n//\r\n\r\nObject.defineProperties( THREE.BufferAttribute.prototype, {\r\n\tlength: {\r\n\t\tget: function () {\r\n\t\t\tconsole.warn( 'THREE.BufferAttribute: .length has been deprecated. Please use .count.' );\r\n\t\t\treturn this.array.length;\r\n\t\t}\r\n\t}\r\n} );\r\n\r\nObject.defineProperties( THREE.BufferGeometry.prototype, {\r\n\tdrawcalls: {\r\n\t\tget: function () {\r\n\t\t\tconsole.error( 'THREE.BufferGeometry: .drawcalls has been renamed to .groups.' );\r\n\t\t\treturn this.groups;\r\n\t\t}\r\n\t},\r\n\toffsets: {\r\n\t\tget: function () {\r\n\t\t\tconsole.warn( 'THREE.BufferGeometry: .offsets has been renamed to .groups.' );\r\n\t\t\treturn this.groups;\r\n\t\t}\r\n\t},\r\n\taddIndex: {\r\n\t\tvalue: function ( index ) {\r\n\t\t\tconsole.warn( 'THREE.BufferGeometry: .addIndex() has been renamed to .setIndex().' );\r\n\t\t\tthis.setIndex( index );\r\n\t\t}\r\n\t},\r\n\taddDrawCall: {\r\n\t\tvalue: function ( start, count, indexOffset ) {\r\n\t\t\tif ( indexOffset !== undefined ) {\r\n\t\t\t\tconsole.warn( 'THREE.BufferGeometry: .addDrawCall() no longer supports indexOffset.' );\r\n\t\t\t}\r\n\t\t\tconsole.warn( 'THREE.BufferGeometry: .addDrawCall() is now .addGroup().' );\r\n\t\t\tthis.addGroup( start, count );\r\n\t\t}\r\n\t},\r\n\tclearDrawCalls: {\r\n\t\tvalue: function () {\r\n\t\t\tconsole.warn( 'THREE.BufferGeometry: .clearDrawCalls() is now .clearGroups().' );\r\n\t\t\tthis.clearGroups();\r\n\t\t}\r\n\t},\r\n\tcomputeTangents: {\r\n\t\tvalue: function () {\r\n\t\t\tconsole.warn( 'THREE.BufferGeometry: .computeTangents() has been removed.' );\r\n\t\t}\r\n\t},\r\n\tcomputeOffsets: {\r\n\t\tvalue: function () {\r\n\t\t\tconsole.warn( 'THREE.BufferGeometry: .computeOffsets() has been removed.' );\r\n\t\t}\r\n\t}\r\n} );\r\n\r\n//\r\n\r\nObject.defineProperties( THREE.Material.prototype, {\r\n\twrapAround: {\r\n\t\tget: function () {\r\n\t\t\tconsole.warn( 'THREE.' + this.type + ': .wrapAround has been removed.' );\r\n\t\t},\r\n\t\tset: function ( value ) {\r\n\t\t\tconsole.warn( 'THREE.' + this.type + ': .wrapAround has been removed.' );\r\n\t\t}\r\n\t},\r\n\twrapRGB: {\r\n\t\tget: function () {\r\n\t\t\tconsole.warn( 'THREE.' + this.type + ': .wrapRGB has been removed.' );\r\n\t\t\treturn new THREE.Color();\r\n\t\t}\r\n\t}\r\n} );\r\n\r\nObject.defineProperties( THREE, {\r\n\tPointCloudMaterial: {\r\n\t\tvalue: function ( parameters ) {\r\n\t\t\tconsole.warn( 'THREE.PointCloudMaterial has been renamed to THREE.PointsMaterial.' );\r\n\t\t\treturn new THREE.PointsMaterial( parameters );\r\n\t\t}\r\n\t},\r\n\tParticleBasicMaterial: {\r\n\t\tvalue: function ( parameters ) {\r\n\t\t\tconsole.warn( 'THREE.ParticleBasicMaterial has been renamed to THREE.PointsMaterial.' );\r\n\t\t\treturn new THREE.PointsMaterial( parameters );\r\n\t\t}\r\n\t},\r\n\tParticleSystemMaterial:{\r\n\t\tvalue: function ( parameters ) {\r\n\t\t\tconsole.warn( 'THREE.ParticleSystemMaterial has been renamed to THREE.PointsMaterial.' );\r\n\t\t\treturn new THREE.PointsMaterial( parameters );\r\n\t\t}\r\n\t}\r\n} );\r\n\r\nObject.defineProperties( THREE.MeshPhongMaterial.prototype, {\r\n\tmetal: {\r\n\t\tget: function () {\r\n\t\t\tconsole.warn( 'THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead.' );\r\n\t\t\treturn false;\r\n\t\t},\r\n\t\tset: function ( value ) {\r\n\t\t\tconsole.warn( 'THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead' );\r\n\t\t}\r\n\t}\r\n} );\r\n\r\nObject.defineProperties( THREE.ShaderMaterial.prototype, {\r\n\tderivatives: {\r\n\t\tget: function () {\r\n\t\t\tconsole.warn( 'THREE.ShaderMaterial: .derivatives has been moved to .extensions.derivatives.' );\r\n\t\t\treturn this.extensions.derivatives;\r\n\t\t},\r\n\t\tset: function ( value ) {\r\n\t\t\tconsole.warn( 'THREE. ShaderMaterial: .derivatives has been moved to .extensions.derivatives.' );\r\n\t\t\tthis.extensions.derivatives = value;\r\n\t\t}\r\n\t}\r\n} );\r\n\r\n//\r\n\r\nObject.defineProperties( THREE.WebGLRenderer.prototype, {\r\n\tsupportsFloatTextures: {\r\n\t\tvalue: function () {\r\n\t\t\tconsole.warn( 'THREE.WebGLRenderer: .supportsFloatTextures() is now .extensions.get( \\'OES_texture_float\\' ).' );\r\n\t\t\treturn this.extensions.get( 'OES_texture_float' );\r\n\t\t}\r\n\t},\r\n\tsupportsHalfFloatTextures: {\r\n\t\tvalue: function () {\r\n\t\t\tconsole.warn( 'THREE.WebGLRenderer: .supportsHalfFloatTextures() is now .extensions.get( \\'OES_texture_half_float\\' ).' );\r\n\t\t\treturn this.extensions.get( 'OES_texture_half_float' );\r\n\t\t}\r\n\t},\r\n\tsupportsStandardDerivatives: {\r\n\t\tvalue: function () {\r\n\t\t\tconsole.warn( 'THREE.WebGLRenderer: .supportsStandardDerivatives() is now .extensions.get( \\'OES_standard_derivatives\\' ).' );\r\n\t\t\treturn this.extensions.get( 'OES_standard_derivatives' );\r\n\t\t}\r\n\t},\r\n\tsupportsCompressedTextureS3TC: {\r\n\t\tvalue: function () {\r\n\t\t\tconsole.warn( 'THREE.WebGLRenderer: .supportsCompressedTextureS3TC() is now .extensions.get( \\'WEBGL_compressed_texture_s3tc\\' ).' );\r\n\t\t\treturn this.extensions.get( 'WEBGL_compressed_texture_s3tc' );\r\n\t\t}\r\n\t},\r\n\tsupportsCompressedTexturePVRTC: {\r\n\t\tvalue: function () {\r\n\t\t\tconsole.warn( 'THREE.WebGLRenderer: .supportsCompressedTexturePVRTC() is now .extensions.get( \\'WEBGL_compressed_texture_pvrtc\\' ).' );\r\n\t\t\treturn this.extensions.get( 'WEBGL_compressed_texture_pvrtc' );\r\n\t\t}\r\n\t},\r\n\tsupportsBlendMinMax: {\r\n\t\tvalue: function () {\r\n\t\t\tconsole.warn( 'THREE.WebGLRenderer: .supportsBlendMinMax() is now .extensions.get( \\'EXT_blend_minmax\\' ).' );\r\n\t\t\treturn this.extensions.get( 'EXT_blend_minmax' );\r\n\t\t}\r\n\t},\r\n\tsupportsVertexTextures: {\r\n\t\tvalue: function () {\r\n\t\t\treturn this.capabilities.vertexTextures;\r\n\t\t}\r\n\t},\r\n\tsupportsInstancedArrays: {\r\n\t\tvalue: function () {\r\n\t\t\tconsole.warn( 'THREE.WebGLRenderer: .supportsInstancedArrays() is now .extensions.get( \\'ANGLE_instanced_arrays\\' ).' );\r\n\t\t\treturn this.extensions.get( 'ANGLE_instanced_arrays' );\r\n\t\t}\r\n\t},\r\n\tenableScissorTest: {\r\n\t\tvalue: function ( boolean ) {\r\n\t\t\tconsole.warn( 'THREE.WebGLRenderer: .enableScissorTest() is now .setScissorTest().' );\r\n\t\t\tthis.setScissorTest( boolean );\r\n\t\t}\r\n\t},\r\n\tinitMaterial: {\r\n\t\tvalue: function () {\r\n\t\t\tconsole.warn( 'THREE.WebGLRenderer: .initMaterial() has been removed.' );\r\n\t\t}\r\n\t},\r\n\taddPrePlugin: {\r\n\t\tvalue: function () {\r\n\t\t\tconsole.warn( 'THREE.WebGLRenderer: .addPrePlugin() has been removed.' );\r\n\t\t}\r\n\t},\r\n\taddPostPlugin: {\r\n\t\tvalue: function () {\r\n\t\t\tconsole.warn( 'THREE.WebGLRenderer: .addPostPlugin() has been removed.' );\r\n\t\t}\r\n\t},\r\n\tupdateShadowMap: {\r\n\t\tvalue: function () {\r\n\t\t\tconsole.warn( 'THREE.WebGLRenderer: .updateShadowMap() has been removed.' );\r\n\t\t}\r\n\t},\r\n\tshadowMapEnabled: {\r\n\t\tget: function () {\r\n\t\t\treturn this.shadowMap.enabled;\r\n\t\t},\r\n\t\tset: function ( value ) {\r\n\t\t\tconsole.warn( 'THREE.WebGLRenderer: .shadowMapEnabled is now .shadowMap.enabled.' );\r\n\t\t\tthis.shadowMap.enabled = value;\r\n\t\t}\r\n\t},\r\n\tshadowMapType: {\r\n\t\tget: function () {\r\n\t\t\treturn this.shadowMap.type;\r\n\t\t},\r\n\t\tset: function ( value ) {\r\n\t\t\tconsole.warn( 'THREE.WebGLRenderer: .shadowMapType is now .shadowMap.type.' );\r\n\t\t\tthis.shadowMap.type = value;\r\n\t\t}\r\n\t},\r\n\tshadowMapCullFace: {\r\n\t\tget: function () {\r\n\t\t\treturn this.shadowMap.cullFace;\r\n\t\t},\r\n\t\tset: function ( value ) {\r\n\t\t\tconsole.warn( 'THREE.WebGLRenderer: .shadowMapCullFace is now .shadowMap.cullFace.' );\r\n\t\t\tthis.shadowMap.cullFace = value;\r\n\t\t}\r\n\t}\r\n} );\r\n\r\n//\r\n\r\nObject.defineProperties( THREE.WebGLRenderTarget.prototype, {\r\n\twrapS: {\r\n\t\tget: function () {\r\n\t\t\tconsole.warn( 'THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS.' );\r\n\t\t\treturn this.texture.wrapS;\r\n\t\t},\r\n\t\tset: function ( value ) {\r\n\t\t\tconsole.warn( 'THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS.' );\r\n\t\t\tthis.texture.wrapS = value;\r\n\t\t}\r\n\t},\r\n\twrapT: {\r\n\t\tget: function () {\r\n\t\t\tconsole.warn( 'THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT.' );\r\n\t\t\treturn this.texture.wrapT;\r\n\t\t},\r\n\t\tset: function ( value ) {\r\n\t\t\tconsole.warn( 'THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT.' );\r\n\t\t\tthis.texture.wrapT = value;\r\n\t\t}\r\n\t},\r\n\tmagFilter: {\r\n\t\tget: function () {\r\n\t\t\tconsole.warn( 'THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter.' );\r\n\t\t\treturn this.texture.magFilter;\r\n\t\t},\r\n\t\tset: function ( value ) {\r\n\t\t\tconsole.warn( 'THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter.' );\r\n\t\t\tthis.texture.magFilter = value;\r\n\t\t}\r\n\t},\r\n\tminFilter: {\r\n\t\tget: function () {\r\n\t\t\tconsole.warn( 'THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter.' );\r\n\t\t\treturn this.texture.minFilter;\r\n\t\t},\r\n\t\tset: function ( value ) {\r\n\t\t\tconsole.warn( 'THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter.' );\r\n\t\t\tthis.texture.minFilter = value;\r\n\t\t}\r\n\t},\r\n\tanisotropy: {\r\n\t\tget: function () {\r\n\t\t\tconsole.warn( 'THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy.' );\r\n\t\t\treturn this.texture.anisotropy;\r\n\t\t},\r\n\t\tset: function ( value ) {\r\n\t\t\tconsole.warn( 'THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy.' );\r\n\t\t\tthis.texture.anisotropy = value;\r\n\t\t}\r\n\t},\r\n\toffset: {\r\n\t\tget: function () {\r\n\t\t\tconsole.warn( 'THREE.WebGLRenderTarget: .offset is now .texture.offset.' );\r\n\t\t\treturn this.texture.offset;\r\n\t\t},\r\n\t\tset: function ( value ) {\r\n\t\t\tconsole.warn( 'THREE.WebGLRenderTarget: .offset is now .texture.offset.' );\r\n\t\t\tthis.texture.offset = value;\r\n\t\t}\r\n\t},\r\n\trepeat: {\r\n\t\tget: function () {\r\n\t\t\tconsole.warn( 'THREE.WebGLRenderTarget: .repeat is now .texture.repeat.' );\r\n\t\t\treturn this.texture.repeat;\r\n\t\t},\r\n\t\tset: function ( value ) {\r\n\t\t\tconsole.warn( 'THREE.WebGLRenderTarget: .repeat is now .texture.repeat.' );\r\n\t\t\tthis.texture.repeat = value;\r\n\t\t}\r\n\t},\r\n\tformat: {\r\n\t\tget: function () {\r\n\t\t\tconsole.warn( 'THREE.WebGLRenderTarget: .format is now .texture.format.' );\r\n\t\t\treturn this.texture.format;\r\n\t\t},\r\n\t\tset: function ( value ) {\r\n\t\t\tconsole.warn( 'THREE.WebGLRenderTarget: .format is now .texture.format.' );\r\n\t\t\tthis.texture.format = value;\r\n\t\t}\r\n\t},\r\n\ttype: {\r\n\t\tget: function () {\r\n\t\t\tconsole.warn( 'THREE.WebGLRenderTarget: .type is now .texture.type.' );\r\n\t\t\treturn this.texture.type;\r\n\t\t},\r\n\t\tset: function ( value ) {\r\n\t\t\tconsole.warn( 'THREE.WebGLRenderTarget: .type is now .texture.type.' );\r\n\t\t\tthis.texture.type = value;\r\n\t\t}\r\n\t},\r\n\tgenerateMipmaps: {\r\n\t\tget: function () {\r\n\t\t\tconsole.warn( 'THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps.' );\r\n\t\t\treturn this.texture.generateMipmaps;\r\n\t\t},\r\n\t\tset: function ( value ) {\r\n\t\t\tconsole.warn( 'THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps.' );\r\n\t\t\tthis.texture.generateMipmaps = value;\r\n\t\t}\r\n\t}\r\n} );\r\n\r\n//\r\n\r\nObject.defineProperties( THREE.Audio.prototype, {\r\n\tload: {\r\n\t\tvalue: function ( file ) {\r\n\r\n\t\t\tconsole.warn( 'THREE.Audio: .load has been deprecated. Please use THREE.AudioLoader.' );\r\n\r\n\t\t\tvar scope = this;\r\n\r\n\t\t\tvar audioLoader = new THREE.AudioLoader();\r\n\r\n\t\t\taudioLoader.load( file, function ( buffer ) {\r\n\r\n\t\t\t\tscope.setBuffer( buffer );\r\n\r\n\t\t\t} );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t}\r\n\t}\r\n} );\r\n\r\n//\r\n\r\nTHREE.GeometryUtils = {\r\n\r\n\tmerge: function ( geometry1, geometry2, materialIndexOffset ) {\r\n\r\n\t\tconsole.warn( 'THREE.GeometryUtils: .merge() has been moved to Geometry. Use geometry.merge( geometry2, matrix, materialIndexOffset ) instead.' );\r\n\r\n\t\tvar matrix;\r\n\r\n\t\tif ( geometry2 instanceof THREE.Mesh ) {\r\n\r\n\t\t\tgeometry2.matrixAutoUpdate && geometry2.updateMatrix();\r\n\r\n\t\t\tmatrix = geometry2.matrix;\r\n\t\t\tgeometry2 = geometry2.geometry;\r\n\r\n\t\t}\r\n\r\n\t\tgeometry1.merge( geometry2, matrix, materialIndexOffset );\r\n\r\n\t},\r\n\r\n\tcenter: function ( geometry ) {\r\n\r\n\t\tconsole.warn( 'THREE.GeometryUtils: .center() has been moved to Geometry. Use geometry.center() instead.' );\r\n\t\treturn geometry.center();\r\n\r\n\t}\r\n\r\n};\r\n\r\nTHREE.ImageUtils = {\r\n\r\n\tcrossOrigin: undefined,\r\n\r\n\tloadTexture: function ( url, mapping, onLoad, onError ) {\r\n\r\n\t\tconsole.warn( 'THREE.ImageUtils.loadTexture has been deprecated. Use THREE.TextureLoader() instead.' );\r\n\r\n\t\tvar loader = new THREE.TextureLoader();\r\n\t\tloader.setCrossOrigin( this.crossOrigin );\r\n\r\n\t\tvar texture = loader.load( url, onLoad, undefined, onError );\r\n\r\n\t\tif ( mapping ) texture.mapping = mapping;\r\n\r\n\t\treturn texture;\r\n\r\n\t},\r\n\r\n\tloadTextureCube: function ( urls, mapping, onLoad, onError ) {\r\n\r\n\t\tconsole.warn( 'THREE.ImageUtils.loadTextureCube has been deprecated. Use THREE.CubeTextureLoader() instead.' );\r\n\r\n\t\tvar loader = new THREE.CubeTextureLoader();\r\n\t\tloader.setCrossOrigin( this.crossOrigin );\r\n\r\n\t\tvar texture = loader.load( urls, onLoad, undefined, onError );\r\n\r\n\t\tif ( mapping ) texture.mapping = mapping;\r\n\r\n\t\treturn texture;\r\n\r\n\t},\r\n\r\n\tloadCompressedTexture: function () {\r\n\r\n\t\tconsole.error( 'THREE.ImageUtils.loadCompressedTexture has been removed. Use THREE.DDSLoader instead.' );\r\n\r\n\t},\r\n\r\n\tloadCompressedTextureCube: function () {\r\n\r\n\t\tconsole.error( 'THREE.ImageUtils.loadCompressedTextureCube has been removed. Use THREE.DDSLoader instead.' );\r\n\r\n\t}\r\n\r\n};\r\n\r\n//\r\n\r\nTHREE.Projector = function () {\r\n\r\n\tconsole.error( 'THREE.Projector has been moved to /examples/js/renderers/Projector.js.' );\r\n\r\n\tthis.projectVector = function ( vector, camera ) {\r\n\r\n\t\tconsole.warn( 'THREE.Projector: .projectVector() is now vector.project().' );\r\n\t\tvector.project( camera );\r\n\r\n\t};\r\n\r\n\tthis.unprojectVector = function ( vector, camera ) {\r\n\r\n\t\tconsole.warn( 'THREE.Projector: .unprojectVector() is now vector.unproject().' );\r\n\t\tvector.unproject( camera );\r\n\r\n\t};\r\n\r\n\tthis.pickingRay = function ( vector, camera ) {\r\n\r\n\t\tconsole.error( 'THREE.Projector: .pickingRay() is now raycaster.setFromCamera().' );\r\n\r\n\t};\r\n\r\n};\r\n\r\n//\r\n\r\nTHREE.CanvasRenderer = function () {\r\n\r\n\tconsole.error( 'THREE.CanvasRenderer has been moved to /examples/js/renderers/CanvasRenderer.js' );\r\n\r\n\tthis.domElement = document.createElement( 'canvas' );\r\n\tthis.clear = function () {};\r\n\tthis.render = function () {};\r\n\tthis.setClearColor = function () {};\r\n\tthis.setSize = function () {};\r\n\r\n};\r\n\r\n//\r\n\r\nTHREE.MeshFaceMaterial = THREE.MultiMaterial;\r\n\r\n//\r\n\r\nObject.defineProperties( THREE.LOD.prototype, {\r\n\tobjects: {\r\n\t\tget: function () {\r\n\r\n\t\t\tconsole.warn( 'THREE.LOD: .objects has been renamed to .levels.' );\r\n\t\t\treturn this.levels;\r\n\r\n\t\t}\r\n\t}\r\n} );\r\n\r\n// File:src/extras/CurveUtils.js\r\n\r\n/**\r\n * @author zz85 / http://www.lab4games.net/zz85/blog\r\n */\r\n\r\nTHREE.CurveUtils = {\r\n\r\n\ttangentQuadraticBezier: function ( t, p0, p1, p2 ) {\r\n\r\n\t\treturn 2 * ( 1 - t ) * ( p1 - p0 ) + 2 * t * ( p2 - p1 );\r\n\r\n\t},\r\n\r\n\t// Puay Bing, thanks for helping with this derivative!\r\n\r\n\ttangentCubicBezier: function ( t, p0, p1, p2, p3 ) {\r\n\r\n\t\treturn - 3 * p0 * ( 1 - t ) * ( 1 - t )  +\r\n\t\t\t3 * p1 * ( 1 - t ) * ( 1 - t ) - 6 * t * p1 * ( 1 - t ) +\r\n\t\t\t6 * t *  p2 * ( 1 - t ) - 3 * t * t * p2 +\r\n\t\t\t3 * t * t * p3;\r\n\r\n\t},\r\n\r\n\ttangentSpline: function ( t, p0, p1, p2, p3 ) {\r\n\r\n\t\t// To check if my formulas are correct\r\n\r\n\t\tvar h00 = 6 * t * t - 6 * t; \t// derived from 2t^3 − 3t^2 + 1\r\n\t\tvar h10 = 3 * t * t - 4 * t + 1; // t^3 − 2t^2 + t\r\n\t\tvar h01 = - 6 * t * t + 6 * t; \t// − 2t3 + 3t2\r\n\t\tvar h11 = 3 * t * t - 2 * t;\t// t3 − t2\r\n\r\n\t\treturn h00 + h10 + h01 + h11;\r\n\r\n\t},\r\n\r\n\t// Catmull-Rom\r\n\r\n\tinterpolate: function( p0, p1, p2, p3, t ) {\r\n\r\n\t\tvar v0 = ( p2 - p0 ) * 0.5;\r\n\t\tvar v1 = ( p3 - p1 ) * 0.5;\r\n\t\tvar t2 = t * t;\r\n\t\tvar t3 = t * t2;\r\n\t\treturn ( 2 * p1 - 2 * p2 + v0 + v1 ) * t3 + ( - 3 * p1 + 3 * p2 - 2 * v0 - v1 ) * t2 + v0 * t + p1;\r\n\r\n\t}\r\n\r\n};\r\n\r\n// File:src/extras/SceneUtils.js\r\n\r\n/**\r\n * @author alteredq / http://alteredqualia.com/\r\n */\r\n\r\nTHREE.SceneUtils = {\r\n\r\n\tcreateMultiMaterialObject: function ( geometry, materials ) {\r\n\r\n\t\tvar group = new THREE.Group();\r\n\r\n\t\tfor ( var i = 0, l = materials.length; i < l; i ++ ) {\r\n\r\n\t\t\tgroup.add( new THREE.Mesh( geometry, materials[ i ] ) );\r\n\r\n\t\t}\r\n\r\n\t\treturn group;\r\n\r\n\t},\r\n\r\n\tdetach: function ( child, parent, scene ) {\r\n\r\n\t\tchild.applyMatrix( parent.matrixWorld );\r\n\t\tparent.remove( child );\r\n\t\tscene.add( child );\r\n\r\n\t},\r\n\r\n\tattach: function ( child, scene, parent ) {\r\n\r\n\t\tvar matrixWorldInverse = new THREE.Matrix4();\r\n\t\tmatrixWorldInverse.getInverse( parent.matrixWorld );\r\n\t\tchild.applyMatrix( matrixWorldInverse );\r\n\r\n\t\tscene.remove( child );\r\n\t\tparent.add( child );\r\n\r\n\t}\r\n\r\n};\r\n\r\n// File:src/extras/ShapeUtils.js\r\n\r\n/**\r\n * @author zz85 / http://www.lab4games.net/zz85/blog\r\n */\r\n\r\nTHREE.ShapeUtils = {\r\n\r\n\t// calculate area of the contour polygon\r\n\r\n\tarea: function ( contour ) {\r\n\r\n\t\tvar n = contour.length;\r\n\t\tvar a = 0.0;\r\n\r\n\t\tfor ( var p = n - 1, q = 0; q < n; p = q ++ ) {\r\n\r\n\t\t\ta += contour[ p ].x * contour[ q ].y - contour[ q ].x * contour[ p ].y;\r\n\r\n\t\t}\r\n\r\n\t\treturn a * 0.5;\r\n\r\n\t},\r\n\r\n\ttriangulate: ( function () {\r\n\r\n\t\t/**\r\n\t\t * This code is a quick port of code written in C++ which was submitted to\r\n\t\t * flipcode.com by John W. Ratcliff  // July 22, 2000\r\n\t\t * See original code and more information here:\r\n\t\t * http://www.flipcode.com/archives/Efficient_Polygon_Triangulation.shtml\r\n\t\t *\r\n\t\t * ported to actionscript by Zevan Rosser\r\n\t\t * www.actionsnippet.com\r\n\t\t *\r\n\t\t * ported to javascript by Joshua Koo\r\n\t\t * http://www.lab4games.net/zz85/blog\r\n\t\t *\r\n\t\t */\r\n\r\n\t\tfunction snip( contour, u, v, w, n, verts ) {\r\n\r\n\t\t\tvar p;\r\n\t\t\tvar ax, ay, bx, by;\r\n\t\t\tvar cx, cy, px, py;\r\n\r\n\t\t\tax = contour[ verts[ u ] ].x;\r\n\t\t\tay = contour[ verts[ u ] ].y;\r\n\r\n\t\t\tbx = contour[ verts[ v ] ].x;\r\n\t\t\tby = contour[ verts[ v ] ].y;\r\n\r\n\t\t\tcx = contour[ verts[ w ] ].x;\r\n\t\t\tcy = contour[ verts[ w ] ].y;\r\n\r\n\t\t\tif ( Number.EPSILON > ( ( ( bx - ax ) * ( cy - ay ) ) - ( ( by - ay ) * ( cx - ax ) ) ) ) return false;\r\n\r\n\t\t\tvar aX, aY, bX, bY, cX, cY;\r\n\t\t\tvar apx, apy, bpx, bpy, cpx, cpy;\r\n\t\t\tvar cCROSSap, bCROSScp, aCROSSbp;\r\n\r\n\t\t\taX = cx - bx;  aY = cy - by;\r\n\t\t\tbX = ax - cx;  bY = ay - cy;\r\n\t\t\tcX = bx - ax;  cY = by - ay;\r\n\r\n\t\t\tfor ( p = 0; p < n; p ++ ) {\r\n\r\n\t\t\t\tpx = contour[ verts[ p ] ].x;\r\n\t\t\t\tpy = contour[ verts[ p ] ].y;\r\n\r\n\t\t\t\tif ( ( ( px === ax ) && ( py === ay ) ) ||\r\n\t\t\t\t\t ( ( px === bx ) && ( py === by ) ) ||\r\n\t\t\t\t\t ( ( px === cx ) && ( py === cy ) ) )\tcontinue;\r\n\r\n\t\t\t\tapx = px - ax;  apy = py - ay;\r\n\t\t\t\tbpx = px - bx;  bpy = py - by;\r\n\t\t\t\tcpx = px - cx;  cpy = py - cy;\r\n\r\n\t\t\t\t// see if p is inside triangle abc\r\n\r\n\t\t\t\taCROSSbp = aX * bpy - aY * bpx;\r\n\t\t\t\tcCROSSap = cX * apy - cY * apx;\r\n\t\t\t\tbCROSScp = bX * cpy - bY * cpx;\r\n\r\n\t\t\t\tif ( ( aCROSSbp >= - Number.EPSILON ) && ( bCROSScp >= - Number.EPSILON ) && ( cCROSSap >= - Number.EPSILON ) ) return false;\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn true;\r\n\r\n\t\t}\r\n\r\n\t\t// takes in an contour array and returns\r\n\r\n\t\treturn function ( contour, indices ) {\r\n\r\n\t\t\tvar n = contour.length;\r\n\r\n\t\t\tif ( n < 3 ) return null;\r\n\r\n\t\t\tvar result = [],\r\n\t\t\t\tverts = [],\r\n\t\t\t\tvertIndices = [];\r\n\r\n\t\t\t/* we want a counter-clockwise polygon in verts */\r\n\r\n\t\t\tvar u, v, w;\r\n\r\n\t\t\tif ( THREE.ShapeUtils.area( contour ) > 0.0 ) {\r\n\r\n\t\t\t\tfor ( v = 0; v < n; v ++ ) verts[ v ] = v;\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tfor ( v = 0; v < n; v ++ ) verts[ v ] = ( n - 1 ) - v;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar nv = n;\r\n\r\n\t\t\t/*  remove nv - 2 vertices, creating 1 triangle every time */\r\n\r\n\t\t\tvar count = 2 * nv;   /* error detection */\r\n\r\n\t\t\tfor ( v = nv - 1; nv > 2; ) {\r\n\r\n\t\t\t\t/* if we loop, it is probably a non-simple polygon */\r\n\r\n\t\t\t\tif ( ( count -- ) <= 0 ) {\r\n\r\n\t\t\t\t\t//** Triangulate: ERROR - probable bad polygon!\r\n\r\n\t\t\t\t\t//throw ( \"Warning, unable to triangulate polygon!\" );\r\n\t\t\t\t\t//return null;\r\n\t\t\t\t\t// Sometimes warning is fine, especially polygons are triangulated in reverse.\r\n\t\t\t\t\tconsole.warn( 'THREE.ShapeUtils: Unable to triangulate polygon! in triangulate()' );\r\n\r\n\t\t\t\t\tif ( indices ) return vertIndices;\r\n\t\t\t\t\treturn result;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\t/* three consecutive vertices in current polygon, <u,v,w> */\r\n\r\n\t\t\t\tu = v; \t \tif ( nv <= u ) u = 0;     /* previous */\r\n\t\t\t\tv = u + 1;  if ( nv <= v ) v = 0;     /* new v    */\r\n\t\t\t\tw = v + 1;  if ( nv <= w ) w = 0;     /* next     */\r\n\r\n\t\t\t\tif ( snip( contour, u, v, w, nv, verts ) ) {\r\n\r\n\t\t\t\t\tvar a, b, c, s, t;\r\n\r\n\t\t\t\t\t/* true names of the vertices */\r\n\r\n\t\t\t\t\ta = verts[ u ];\r\n\t\t\t\t\tb = verts[ v ];\r\n\t\t\t\t\tc = verts[ w ];\r\n\r\n\t\t\t\t\t/* output Triangle */\r\n\r\n\t\t\t\t\tresult.push( [ contour[ a ],\r\n\t\t\t\t\t\tcontour[ b ],\r\n\t\t\t\t\t\tcontour[ c ] ] );\r\n\r\n\r\n\t\t\t\t\tvertIndices.push( [ verts[ u ], verts[ v ], verts[ w ] ] );\r\n\r\n\t\t\t\t\t/* remove v from the remaining polygon */\r\n\r\n\t\t\t\t\tfor ( s = v, t = v + 1; t < nv; s ++, t ++ ) {\r\n\r\n\t\t\t\t\t\tverts[ s ] = verts[ t ];\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tnv --;\r\n\r\n\t\t\t\t\t/* reset error detection counter */\r\n\r\n\t\t\t\t\tcount = 2 * nv;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( indices ) return vertIndices;\r\n\t\t\treturn result;\r\n\r\n\t\t}\r\n\r\n\t} )(),\r\n\r\n\ttriangulateShape: function ( contour, holes ) {\r\n\r\n\t\tfunction point_in_segment_2D_colin( inSegPt1, inSegPt2, inOtherPt ) {\r\n\r\n\t\t\t// inOtherPt needs to be collinear to the inSegment\r\n\t\t\tif ( inSegPt1.x !== inSegPt2.x ) {\r\n\r\n\t\t\t\tif ( inSegPt1.x < inSegPt2.x ) {\r\n\r\n\t\t\t\t\treturn\t( ( inSegPt1.x <= inOtherPt.x ) && ( inOtherPt.x <= inSegPt2.x ) );\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\treturn\t( ( inSegPt2.x <= inOtherPt.x ) && ( inOtherPt.x <= inSegPt1.x ) );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tif ( inSegPt1.y < inSegPt2.y ) {\r\n\r\n\t\t\t\t\treturn\t( ( inSegPt1.y <= inOtherPt.y ) && ( inOtherPt.y <= inSegPt2.y ) );\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\treturn\t( ( inSegPt2.y <= inOtherPt.y ) && ( inOtherPt.y <= inSegPt1.y ) );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tfunction intersect_segments_2D( inSeg1Pt1, inSeg1Pt2, inSeg2Pt1, inSeg2Pt2, inExcludeAdjacentSegs ) {\r\n\r\n\t\t\tvar seg1dx = inSeg1Pt2.x - inSeg1Pt1.x,   seg1dy = inSeg1Pt2.y - inSeg1Pt1.y;\r\n\t\t\tvar seg2dx = inSeg2Pt2.x - inSeg2Pt1.x,   seg2dy = inSeg2Pt2.y - inSeg2Pt1.y;\r\n\r\n\t\t\tvar seg1seg2dx = inSeg1Pt1.x - inSeg2Pt1.x;\r\n\t\t\tvar seg1seg2dy = inSeg1Pt1.y - inSeg2Pt1.y;\r\n\r\n\t\t\tvar limit\t\t= seg1dy * seg2dx - seg1dx * seg2dy;\r\n\t\t\tvar perpSeg1\t= seg1dy * seg1seg2dx - seg1dx * seg1seg2dy;\r\n\r\n\t\t\tif ( Math.abs( limit ) > Number.EPSILON ) {\r\n\r\n\t\t\t\t// not parallel\r\n\r\n\t\t\t\tvar perpSeg2;\r\n\t\t\t\tif ( limit > 0 ) {\r\n\r\n\t\t\t\t\tif ( ( perpSeg1 < 0 ) || ( perpSeg1 > limit ) ) \t\treturn [];\r\n\t\t\t\t\tperpSeg2 = seg2dy * seg1seg2dx - seg2dx * seg1seg2dy;\r\n\t\t\t\t\tif ( ( perpSeg2 < 0 ) || ( perpSeg2 > limit ) ) \t\treturn [];\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tif ( ( perpSeg1 > 0 ) || ( perpSeg1 < limit ) ) \t\treturn [];\r\n\t\t\t\t\tperpSeg2 = seg2dy * seg1seg2dx - seg2dx * seg1seg2dy;\r\n\t\t\t\t\tif ( ( perpSeg2 > 0 ) || ( perpSeg2 < limit ) ) \t\treturn [];\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// i.e. to reduce rounding errors\r\n\t\t\t\t// intersection at endpoint of segment#1?\r\n\t\t\t\tif ( perpSeg2 === 0 ) {\r\n\r\n\t\t\t\t\tif ( ( inExcludeAdjacentSegs ) &&\r\n\t\t\t\t\t\t ( ( perpSeg1 === 0 ) || ( perpSeg1 === limit ) ) )\t\treturn [];\r\n\t\t\t\t\treturn [ inSeg1Pt1 ];\r\n\r\n\t\t\t\t}\r\n\t\t\t\tif ( perpSeg2 === limit ) {\r\n\r\n\t\t\t\t\tif ( ( inExcludeAdjacentSegs ) &&\r\n\t\t\t\t\t\t ( ( perpSeg1 === 0 ) || ( perpSeg1 === limit ) ) )\t\treturn [];\r\n\t\t\t\t\treturn [ inSeg1Pt2 ];\r\n\r\n\t\t\t\t}\r\n\t\t\t\t// intersection at endpoint of segment#2?\r\n\t\t\t\tif ( perpSeg1 === 0 )\t\treturn [ inSeg2Pt1 ];\r\n\t\t\t\tif ( perpSeg1 === limit )\treturn [ inSeg2Pt2 ];\r\n\r\n\t\t\t\t// return real intersection point\r\n\t\t\t\tvar factorSeg1 = perpSeg2 / limit;\r\n\t\t\t\treturn\t[ { x: inSeg1Pt1.x + factorSeg1 * seg1dx,\r\n\t\t\t\t\t\t\ty: inSeg1Pt1.y + factorSeg1 * seg1dy } ];\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\t// parallel or collinear\r\n\t\t\t\tif ( ( perpSeg1 !== 0 ) ||\r\n\t\t\t\t\t ( seg2dy * seg1seg2dx !== seg2dx * seg1seg2dy ) ) \t\t\treturn [];\r\n\r\n\t\t\t\t// they are collinear or degenerate\r\n\t\t\t\tvar seg1Pt = ( ( seg1dx === 0 ) && ( seg1dy === 0 ) );\t// segment1 is just a point?\r\n\t\t\t\tvar seg2Pt = ( ( seg2dx === 0 ) && ( seg2dy === 0 ) );\t// segment2 is just a point?\r\n\t\t\t\t// both segments are points\r\n\t\t\t\tif ( seg1Pt && seg2Pt ) {\r\n\r\n\t\t\t\t\tif ( ( inSeg1Pt1.x !== inSeg2Pt1.x ) ||\r\n\t\t\t\t\t\t ( inSeg1Pt1.y !== inSeg2Pt1.y ) )\t\treturn [];\t// they are distinct  points\r\n\t\t\t\t\treturn [ inSeg1Pt1 ];                 \t\t\t\t\t\t// they are the same point\r\n\r\n\t\t\t\t}\r\n\t\t\t\t// segment#1  is a single point\r\n\t\t\t\tif ( seg1Pt ) {\r\n\r\n\t\t\t\t\tif ( ! point_in_segment_2D_colin( inSeg2Pt1, inSeg2Pt2, inSeg1Pt1 ) )\t\treturn [];\t\t// but not in segment#2\r\n\t\t\t\t\treturn [ inSeg1Pt1 ];\r\n\r\n\t\t\t\t}\r\n\t\t\t\t// segment#2  is a single point\r\n\t\t\t\tif ( seg2Pt ) {\r\n\r\n\t\t\t\t\tif ( ! point_in_segment_2D_colin( inSeg1Pt1, inSeg1Pt2, inSeg2Pt1 ) )\t\treturn [];\t\t// but not in segment#1\r\n\t\t\t\t\treturn [ inSeg2Pt1 ];\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// they are collinear segments, which might overlap\r\n\t\t\t\tvar seg1min, seg1max, seg1minVal, seg1maxVal;\r\n\t\t\t\tvar seg2min, seg2max, seg2minVal, seg2maxVal;\r\n\t\t\t\tif ( seg1dx !== 0 ) {\r\n\r\n\t\t\t\t\t// the segments are NOT on a vertical line\r\n\t\t\t\t\tif ( inSeg1Pt1.x < inSeg1Pt2.x ) {\r\n\r\n\t\t\t\t\t\tseg1min = inSeg1Pt1; seg1minVal = inSeg1Pt1.x;\r\n\t\t\t\t\t\tseg1max = inSeg1Pt2; seg1maxVal = inSeg1Pt2.x;\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\tseg1min = inSeg1Pt2; seg1minVal = inSeg1Pt2.x;\r\n\t\t\t\t\t\tseg1max = inSeg1Pt1; seg1maxVal = inSeg1Pt1.x;\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif ( inSeg2Pt1.x < inSeg2Pt2.x ) {\r\n\r\n\t\t\t\t\t\tseg2min = inSeg2Pt1; seg2minVal = inSeg2Pt1.x;\r\n\t\t\t\t\t\tseg2max = inSeg2Pt2; seg2maxVal = inSeg2Pt2.x;\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\tseg2min = inSeg2Pt2; seg2minVal = inSeg2Pt2.x;\r\n\t\t\t\t\t\tseg2max = inSeg2Pt1; seg2maxVal = inSeg2Pt1.x;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\t// the segments are on a vertical line\r\n\t\t\t\t\tif ( inSeg1Pt1.y < inSeg1Pt2.y ) {\r\n\r\n\t\t\t\t\t\tseg1min = inSeg1Pt1; seg1minVal = inSeg1Pt1.y;\r\n\t\t\t\t\t\tseg1max = inSeg1Pt2; seg1maxVal = inSeg1Pt2.y;\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\tseg1min = inSeg1Pt2; seg1minVal = inSeg1Pt2.y;\r\n\t\t\t\t\t\tseg1max = inSeg1Pt1; seg1maxVal = inSeg1Pt1.y;\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif ( inSeg2Pt1.y < inSeg2Pt2.y ) {\r\n\r\n\t\t\t\t\t\tseg2min = inSeg2Pt1; seg2minVal = inSeg2Pt1.y;\r\n\t\t\t\t\t\tseg2max = inSeg2Pt2; seg2maxVal = inSeg2Pt2.y;\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\tseg2min = inSeg2Pt2; seg2minVal = inSeg2Pt2.y;\r\n\t\t\t\t\t\tseg2max = inSeg2Pt1; seg2maxVal = inSeg2Pt1.y;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\t\t\t\tif ( seg1minVal <= seg2minVal ) {\r\n\r\n\t\t\t\t\tif ( seg1maxVal <  seg2minVal )\treturn [];\r\n\t\t\t\t\tif ( seg1maxVal === seg2minVal )\t{\r\n\r\n\t\t\t\t\t\tif ( inExcludeAdjacentSegs )\t\treturn [];\r\n\t\t\t\t\t\treturn [ seg2min ];\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif ( seg1maxVal <= seg2maxVal )\treturn [ seg2min, seg1max ];\r\n\t\t\t\t\treturn\t[ seg2min, seg2max ];\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tif ( seg1minVal >  seg2maxVal )\treturn [];\r\n\t\t\t\t\tif ( seg1minVal === seg2maxVal )\t{\r\n\r\n\t\t\t\t\t\tif ( inExcludeAdjacentSegs )\t\treturn [];\r\n\t\t\t\t\t\treturn [ seg1min ];\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif ( seg1maxVal <= seg2maxVal )\treturn [ seg1min, seg1max ];\r\n\t\t\t\t\treturn\t[ seg1min, seg2max ];\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tfunction isPointInsideAngle( inVertex, inLegFromPt, inLegToPt, inOtherPt ) {\r\n\r\n\t\t\t// The order of legs is important\r\n\r\n\t\t\t// translation of all points, so that Vertex is at (0,0)\r\n\t\t\tvar legFromPtX\t= inLegFromPt.x - inVertex.x,  legFromPtY\t= inLegFromPt.y - inVertex.y;\r\n\t\t\tvar legToPtX\t= inLegToPt.x\t- inVertex.x,  legToPtY\t\t= inLegToPt.y\t- inVertex.y;\r\n\t\t\tvar otherPtX\t= inOtherPt.x\t- inVertex.x,  otherPtY\t\t= inOtherPt.y\t- inVertex.y;\r\n\r\n\t\t\t// main angle >0: < 180 deg.; 0: 180 deg.; <0: > 180 deg.\r\n\t\t\tvar from2toAngle\t= legFromPtX * legToPtY - legFromPtY * legToPtX;\r\n\t\t\tvar from2otherAngle\t= legFromPtX * otherPtY - legFromPtY * otherPtX;\r\n\r\n\t\t\tif ( Math.abs( from2toAngle ) > Number.EPSILON ) {\r\n\r\n\t\t\t\t// angle != 180 deg.\r\n\r\n\t\t\t\tvar other2toAngle\t\t= otherPtX * legToPtY - otherPtY * legToPtX;\r\n\t\t\t\t// console.log( \"from2to: \" + from2toAngle + \", from2other: \" + from2otherAngle + \", other2to: \" + other2toAngle );\r\n\r\n\t\t\t\tif ( from2toAngle > 0 ) {\r\n\r\n\t\t\t\t\t// main angle < 180 deg.\r\n\t\t\t\t\treturn\t( ( from2otherAngle >= 0 ) && ( other2toAngle >= 0 ) );\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\t// main angle > 180 deg.\r\n\t\t\t\t\treturn\t( ( from2otherAngle >= 0 ) || ( other2toAngle >= 0 ) );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\t// angle == 180 deg.\r\n\t\t\t\t// console.log( \"from2to: 180 deg., from2other: \" + from2otherAngle  );\r\n\t\t\t\treturn\t( from2otherAngle > 0 );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\r\n\t\tfunction removeHoles( contour, holes ) {\r\n\r\n\t\t\tvar shape = contour.concat(); // work on this shape\r\n\t\t\tvar hole;\r\n\r\n\t\t\tfunction isCutLineInsideAngles( inShapeIdx, inHoleIdx ) {\r\n\r\n\t\t\t\t// Check if hole point lies within angle around shape point\r\n\t\t\t\tvar lastShapeIdx = shape.length - 1;\r\n\r\n\t\t\t\tvar prevShapeIdx = inShapeIdx - 1;\r\n\t\t\t\tif ( prevShapeIdx < 0 )\t\t\tprevShapeIdx = lastShapeIdx;\r\n\r\n\t\t\t\tvar nextShapeIdx = inShapeIdx + 1;\r\n\t\t\t\tif ( nextShapeIdx > lastShapeIdx )\tnextShapeIdx = 0;\r\n\r\n\t\t\t\tvar insideAngle = isPointInsideAngle( shape[ inShapeIdx ], shape[ prevShapeIdx ], shape[ nextShapeIdx ], hole[ inHoleIdx ] );\r\n\t\t\t\tif ( ! insideAngle ) {\r\n\r\n\t\t\t\t\t// console.log( \"Vertex (Shape): \" + inShapeIdx + \", Point: \" + hole[inHoleIdx].x + \"/\" + hole[inHoleIdx].y );\r\n\t\t\t\t\treturn\tfalse;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// Check if shape point lies within angle around hole point\r\n\t\t\t\tvar lastHoleIdx = hole.length - 1;\r\n\r\n\t\t\t\tvar prevHoleIdx = inHoleIdx - 1;\r\n\t\t\t\tif ( prevHoleIdx < 0 )\t\t\tprevHoleIdx = lastHoleIdx;\r\n\r\n\t\t\t\tvar nextHoleIdx = inHoleIdx + 1;\r\n\t\t\t\tif ( nextHoleIdx > lastHoleIdx )\tnextHoleIdx = 0;\r\n\r\n\t\t\t\tinsideAngle = isPointInsideAngle( hole[ inHoleIdx ], hole[ prevHoleIdx ], hole[ nextHoleIdx ], shape[ inShapeIdx ] );\r\n\t\t\t\tif ( ! insideAngle ) {\r\n\r\n\t\t\t\t\t// console.log( \"Vertex (Hole): \" + inHoleIdx + \", Point: \" + shape[inShapeIdx].x + \"/\" + shape[inShapeIdx].y );\r\n\t\t\t\t\treturn\tfalse;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn\ttrue;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tfunction intersectsShapeEdge( inShapePt, inHolePt ) {\r\n\r\n\t\t\t\t// checks for intersections with shape edges\r\n\t\t\t\tvar sIdx, nextIdx, intersection;\r\n\t\t\t\tfor ( sIdx = 0; sIdx < shape.length; sIdx ++ ) {\r\n\r\n\t\t\t\t\tnextIdx = sIdx + 1; nextIdx %= shape.length;\r\n\t\t\t\t\tintersection = intersect_segments_2D( inShapePt, inHolePt, shape[ sIdx ], shape[ nextIdx ], true );\r\n\t\t\t\t\tif ( intersection.length > 0 )\t\treturn\ttrue;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn\tfalse;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar indepHoles = [];\r\n\r\n\t\t\tfunction intersectsHoleEdge( inShapePt, inHolePt ) {\r\n\r\n\t\t\t\t// checks for intersections with hole edges\r\n\t\t\t\tvar ihIdx, chkHole,\r\n\t\t\t\t\thIdx, nextIdx, intersection;\r\n\t\t\t\tfor ( ihIdx = 0; ihIdx < indepHoles.length; ihIdx ++ ) {\r\n\r\n\t\t\t\t\tchkHole = holes[ indepHoles[ ihIdx ]];\r\n\t\t\t\t\tfor ( hIdx = 0; hIdx < chkHole.length; hIdx ++ ) {\r\n\r\n\t\t\t\t\t\tnextIdx = hIdx + 1; nextIdx %= chkHole.length;\r\n\t\t\t\t\t\tintersection = intersect_segments_2D( inShapePt, inHolePt, chkHole[ hIdx ], chkHole[ nextIdx ], true );\r\n\t\t\t\t\t\tif ( intersection.length > 0 )\t\treturn\ttrue;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\t\t\t\treturn\tfalse;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar holeIndex, shapeIndex,\r\n\t\t\t\tshapePt, holePt,\r\n\t\t\t\tholeIdx, cutKey, failedCuts = [],\r\n\t\t\t\ttmpShape1, tmpShape2,\r\n\t\t\t\ttmpHole1, tmpHole2;\r\n\r\n\t\t\tfor ( var h = 0, hl = holes.length; h < hl; h ++ ) {\r\n\r\n\t\t\t\tindepHoles.push( h );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar minShapeIndex = 0;\r\n\t\t\tvar counter = indepHoles.length * 2;\r\n\t\t\twhile ( indepHoles.length > 0 ) {\r\n\r\n\t\t\t\tcounter --;\r\n\t\t\t\tif ( counter < 0 ) {\r\n\r\n\t\t\t\t\tconsole.log( \"Infinite Loop! Holes left:\" + indepHoles.length + \", Probably Hole outside Shape!\" );\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// search for shape-vertex and hole-vertex,\r\n\t\t\t\t// which can be connected without intersections\r\n\t\t\t\tfor ( shapeIndex = minShapeIndex; shapeIndex < shape.length; shapeIndex ++ ) {\r\n\r\n\t\t\t\t\tshapePt = shape[ shapeIndex ];\r\n\t\t\t\t\tholeIndex\t= - 1;\r\n\r\n\t\t\t\t\t// search for hole which can be reached without intersections\r\n\t\t\t\t\tfor ( var h = 0; h < indepHoles.length; h ++ ) {\r\n\r\n\t\t\t\t\t\tholeIdx = indepHoles[ h ];\r\n\r\n\t\t\t\t\t\t// prevent multiple checks\r\n\t\t\t\t\t\tcutKey = shapePt.x + \":\" + shapePt.y + \":\" + holeIdx;\r\n\t\t\t\t\t\tif ( failedCuts[ cutKey ] !== undefined )\t\t\tcontinue;\r\n\r\n\t\t\t\t\t\thole = holes[ holeIdx ];\r\n\t\t\t\t\t\tfor ( var h2 = 0; h2 < hole.length; h2 ++ ) {\r\n\r\n\t\t\t\t\t\t\tholePt = hole[ h2 ];\r\n\t\t\t\t\t\t\tif ( ! isCutLineInsideAngles( shapeIndex, h2 ) )\t\tcontinue;\r\n\t\t\t\t\t\t\tif ( intersectsShapeEdge( shapePt, holePt ) )\t\tcontinue;\r\n\t\t\t\t\t\t\tif ( intersectsHoleEdge( shapePt, holePt ) )\t\tcontinue;\r\n\r\n\t\t\t\t\t\t\tholeIndex = h2;\r\n\t\t\t\t\t\t\tindepHoles.splice( h, 1 );\r\n\r\n\t\t\t\t\t\t\ttmpShape1 = shape.slice( 0, shapeIndex + 1 );\r\n\t\t\t\t\t\t\ttmpShape2 = shape.slice( shapeIndex );\r\n\t\t\t\t\t\t\ttmpHole1 = hole.slice( holeIndex );\r\n\t\t\t\t\t\t\ttmpHole2 = hole.slice( 0, holeIndex + 1 );\r\n\r\n\t\t\t\t\t\t\tshape = tmpShape1.concat( tmpHole1 ).concat( tmpHole2 ).concat( tmpShape2 );\r\n\r\n\t\t\t\t\t\t\tminShapeIndex = shapeIndex;\r\n\r\n\t\t\t\t\t\t\t// Debug only, to show the selected cuts\r\n\t\t\t\t\t\t\t// glob_CutLines.push( [ shapePt, holePt ] );\r\n\r\n\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif ( holeIndex >= 0 )\tbreak;\t\t// hole-vertex found\r\n\r\n\t\t\t\t\t\tfailedCuts[ cutKey ] = true;\t\t\t// remember failure\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif ( holeIndex >= 0 )\tbreak;\t\t// hole-vertex found\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn shape; \t\t\t/* shape with no holes */\r\n\r\n\t\t}\r\n\r\n\r\n\t\tvar i, il, f, face,\r\n\t\t\tkey, index,\r\n\t\t\tallPointsMap = {};\r\n\r\n\t\t// To maintain reference to old shape, one must match coordinates, or offset the indices from original arrays. It's probably easier to do the first.\r\n\r\n\t\tvar allpoints = contour.concat();\r\n\r\n\t\tfor ( var h = 0, hl = holes.length; h < hl; h ++ ) {\r\n\r\n\t\t\tArray.prototype.push.apply( allpoints, holes[ h ] );\r\n\r\n\t\t}\r\n\r\n\t\t//console.log( \"allpoints\",allpoints, allpoints.length );\r\n\r\n\t\t// prepare all points map\r\n\r\n\t\tfor ( i = 0, il = allpoints.length; i < il; i ++ ) {\r\n\r\n\t\t\tkey = allpoints[ i ].x + \":\" + allpoints[ i ].y;\r\n\r\n\t\t\tif ( allPointsMap[ key ] !== undefined ) {\r\n\r\n\t\t\t\tconsole.warn( \"THREE.Shape: Duplicate point\", key );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tallPointsMap[ key ] = i;\r\n\r\n\t\t}\r\n\r\n\t\t// remove holes by cutting paths to holes and adding them to the shape\r\n\t\tvar shapeWithoutHoles = removeHoles( contour, holes );\r\n\r\n\t\tvar triangles = THREE.ShapeUtils.triangulate( shapeWithoutHoles, false ); // True returns indices for points of spooled shape\r\n\t\t//console.log( \"triangles\",triangles, triangles.length );\r\n\r\n\t\t// check all face vertices against all points map\r\n\r\n\t\tfor ( i = 0, il = triangles.length; i < il; i ++ ) {\r\n\r\n\t\t\tface = triangles[ i ];\r\n\r\n\t\t\tfor ( f = 0; f < 3; f ++ ) {\r\n\r\n\t\t\t\tkey = face[ f ].x + \":\" + face[ f ].y;\r\n\r\n\t\t\t\tindex = allPointsMap[ key ];\r\n\r\n\t\t\t\tif ( index !== undefined ) {\r\n\r\n\t\t\t\t\tface[ f ] = index;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\treturn triangles.concat();\r\n\r\n\t},\r\n\r\n\tisClockWise: function ( pts ) {\r\n\r\n\t\treturn THREE.ShapeUtils.area( pts ) < 0;\r\n\r\n\t},\r\n\r\n\t// Bezier Curves formulas obtained from\r\n\t// http://en.wikipedia.org/wiki/B%C3%A9zier_curve\r\n\r\n\t// Quad Bezier Functions\r\n\r\n\tb2: ( function () {\r\n\r\n\t\tfunction b2p0( t, p ) {\r\n\r\n\t\t\tvar k = 1 - t;\r\n\t\t\treturn k * k * p;\r\n\r\n\t\t}\r\n\r\n\t\tfunction b2p1( t, p ) {\r\n\r\n\t\t\treturn 2 * ( 1 - t ) * t * p;\r\n\r\n\t\t}\r\n\r\n\t\tfunction b2p2( t, p ) {\r\n\r\n\t\t\treturn t * t * p;\r\n\r\n\t\t}\r\n\r\n\t\treturn function ( t, p0, p1, p2 ) {\r\n\r\n\t\t\treturn b2p0( t, p0 ) + b2p1( t, p1 ) + b2p2( t, p2 );\r\n\r\n\t\t};\r\n\r\n\t} )(),\r\n\r\n\t// Cubic Bezier Functions\r\n\r\n\tb3: ( function () {\r\n\r\n\t\tfunction b3p0( t, p ) {\r\n\r\n\t\t\tvar k = 1 - t;\r\n\t\t\treturn k * k * k * p;\r\n\r\n\t\t}\r\n\r\n\t\tfunction b3p1( t, p ) {\r\n\r\n\t\t\tvar k = 1 - t;\r\n\t\t\treturn 3 * k * k * t * p;\r\n\r\n\t\t}\r\n\r\n\t\tfunction b3p2( t, p ) {\r\n\r\n\t\t\tvar k = 1 - t;\r\n\t\t\treturn 3 * k * t * t * p;\r\n\r\n\t\t}\r\n\r\n\t\tfunction b3p3( t, p ) {\r\n\r\n\t\t\treturn t * t * t * p;\r\n\r\n\t\t}\r\n\r\n\t\treturn function ( t, p0, p1, p2, p3 ) {\r\n\r\n\t\t\treturn b3p0( t, p0 ) + b3p1( t, p1 ) + b3p2( t, p2 ) + b3p3( t, p3 );\r\n\r\n\t\t};\r\n\r\n\t} )()\r\n\r\n};\r\n\r\n// File:src/extras/core/Curve.js\r\n\r\n/**\r\n * @author zz85 / http://www.lab4games.net/zz85/blog\r\n * Extensible curve object\r\n *\r\n * Some common of Curve methods\r\n * .getPoint(t), getTangent(t)\r\n * .getPointAt(u), getTagentAt(u)\r\n * .getPoints(), .getSpacedPoints()\r\n * .getLength()\r\n * .updateArcLengths()\r\n *\r\n * This following classes subclasses THREE.Curve:\r\n *\r\n * -- 2d classes --\r\n * THREE.LineCurve\r\n * THREE.QuadraticBezierCurve\r\n * THREE.CubicBezierCurve\r\n * THREE.SplineCurve\r\n * THREE.ArcCurve\r\n * THREE.EllipseCurve\r\n *\r\n * -- 3d classes --\r\n * THREE.LineCurve3\r\n * THREE.QuadraticBezierCurve3\r\n * THREE.CubicBezierCurve3\r\n * THREE.SplineCurve3\r\n *\r\n * A series of curves can be represented as a THREE.CurvePath\r\n *\r\n **/\r\n\r\n/**************************************************************\r\n *\tAbstract Curve base class\r\n **************************************************************/\r\n\r\nTHREE.Curve = function () {\r\n\r\n};\r\n\r\nTHREE.Curve.prototype = {\r\n\r\n\tconstructor: THREE.Curve,\r\n\r\n\t// Virtual base class method to overwrite and implement in subclasses\r\n\t//\t- t [0 .. 1]\r\n\r\n\tgetPoint: function ( t ) {\r\n\r\n\t\tconsole.warn( \"THREE.Curve: Warning, getPoint() not implemented!\" );\r\n\t\treturn null;\r\n\r\n\t},\r\n\r\n\t// Get point at relative position in curve according to arc length\r\n\t// - u [0 .. 1]\r\n\r\n\tgetPointAt: function ( u ) {\r\n\r\n\t\tvar t = this.getUtoTmapping( u );\r\n\t\treturn this.getPoint( t );\r\n\r\n\t},\r\n\r\n\t// Get sequence of points using getPoint( t )\r\n\r\n\tgetPoints: function ( divisions ) {\r\n\r\n\t\tif ( ! divisions ) divisions = 5;\r\n\r\n\t\tvar d, pts = [];\r\n\r\n\t\tfor ( d = 0; d <= divisions; d ++ ) {\r\n\r\n\t\t\tpts.push( this.getPoint( d / divisions ) );\r\n\r\n\t\t}\r\n\r\n\t\treturn pts;\r\n\r\n\t},\r\n\r\n\t// Get sequence of points using getPointAt( u )\r\n\r\n\tgetSpacedPoints: function ( divisions ) {\r\n\r\n\t\tif ( ! divisions ) divisions = 5;\r\n\r\n\t\tvar d, pts = [];\r\n\r\n\t\tfor ( d = 0; d <= divisions; d ++ ) {\r\n\r\n\t\t\tpts.push( this.getPointAt( d / divisions ) );\r\n\r\n\t\t}\r\n\r\n\t\treturn pts;\r\n\r\n\t},\r\n\r\n\t// Get total curve arc length\r\n\r\n\tgetLength: function () {\r\n\r\n\t\tvar lengths = this.getLengths();\r\n\t\treturn lengths[ lengths.length - 1 ];\r\n\r\n\t},\r\n\r\n\t// Get list of cumulative segment lengths\r\n\r\n\tgetLengths: function ( divisions ) {\r\n\r\n\t\tif ( ! divisions ) divisions = ( this.__arcLengthDivisions ) ? ( this.__arcLengthDivisions ) : 200;\r\n\r\n\t\tif ( this.cacheArcLengths\r\n\t\t\t&& ( this.cacheArcLengths.length === divisions + 1 )\r\n\t\t\t&& ! this.needsUpdate ) {\r\n\r\n\t\t\t//console.log( \"cached\", this.cacheArcLengths );\r\n\t\t\treturn this.cacheArcLengths;\r\n\r\n\t\t}\r\n\r\n\t\tthis.needsUpdate = false;\r\n\r\n\t\tvar cache = [];\r\n\t\tvar current, last = this.getPoint( 0 );\r\n\t\tvar p, sum = 0;\r\n\r\n\t\tcache.push( 0 );\r\n\r\n\t\tfor ( p = 1; p <= divisions; p ++ ) {\r\n\r\n\t\t\tcurrent = this.getPoint ( p / divisions );\r\n\t\t\tsum += current.distanceTo( last );\r\n\t\t\tcache.push( sum );\r\n\t\t\tlast = current;\r\n\r\n\t\t}\r\n\r\n\t\tthis.cacheArcLengths = cache;\r\n\r\n\t\treturn cache; // { sums: cache, sum:sum }; Sum is in the last element.\r\n\r\n\t},\r\n\r\n\tupdateArcLengths: function() {\r\n\r\n\t\tthis.needsUpdate = true;\r\n\t\tthis.getLengths();\r\n\r\n\t},\r\n\r\n\t// Given u ( 0 .. 1 ), get a t to find p. This gives you points which are equidistant\r\n\r\n\tgetUtoTmapping: function ( u, distance ) {\r\n\r\n\t\tvar arcLengths = this.getLengths();\r\n\r\n\t\tvar i = 0, il = arcLengths.length;\r\n\r\n\t\tvar targetArcLength; // The targeted u distance value to get\r\n\r\n\t\tif ( distance ) {\r\n\r\n\t\t\ttargetArcLength = distance;\r\n\r\n\t\t} else {\r\n\r\n\t\t\ttargetArcLength = u * arcLengths[ il - 1 ];\r\n\r\n\t\t}\r\n\r\n\t\t//var time = Date.now();\r\n\r\n\t\t// binary search for the index with largest value smaller than target u distance\r\n\r\n\t\tvar low = 0, high = il - 1, comparison;\r\n\r\n\t\twhile ( low <= high ) {\r\n\r\n\t\t\ti = Math.floor( low + ( high - low ) / 2 ); // less likely to overflow, though probably not issue here, JS doesn't really have integers, all numbers are floats\r\n\r\n\t\t\tcomparison = arcLengths[ i ] - targetArcLength;\r\n\r\n\t\t\tif ( comparison < 0 ) {\r\n\r\n\t\t\t\tlow = i + 1;\r\n\r\n\t\t\t} else if ( comparison > 0 ) {\r\n\r\n\t\t\t\thigh = i - 1;\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\thigh = i;\r\n\t\t\t\tbreak;\r\n\r\n\t\t\t\t// DONE\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\ti = high;\r\n\r\n\t\t//console.log('b' , i, low, high, Date.now()- time);\r\n\r\n\t\tif ( arcLengths[ i ] === targetArcLength ) {\r\n\r\n\t\t\tvar t = i / ( il - 1 );\r\n\t\t\treturn t;\r\n\r\n\t\t}\r\n\r\n\t\t// we could get finer grain at lengths, or use simple interpolation between two points\r\n\r\n\t\tvar lengthBefore = arcLengths[ i ];\r\n\t\tvar lengthAfter = arcLengths[ i + 1 ];\r\n\r\n\t\tvar segmentLength = lengthAfter - lengthBefore;\r\n\r\n\t\t// determine where we are between the 'before' and 'after' points\r\n\r\n\t\tvar segmentFraction = ( targetArcLength - lengthBefore ) / segmentLength;\r\n\r\n\t\t// add that fractional amount to t\r\n\r\n\t\tvar t = ( i + segmentFraction ) / ( il - 1 );\r\n\r\n\t\treturn t;\r\n\r\n\t},\r\n\r\n\t// Returns a unit vector tangent at t\r\n\t// In case any sub curve does not implement its tangent derivation,\r\n\t// 2 points a small delta apart will be used to find its gradient\r\n\t// which seems to give a reasonable approximation\r\n\r\n\tgetTangent: function( t ) {\r\n\r\n\t\tvar delta = 0.0001;\r\n\t\tvar t1 = t - delta;\r\n\t\tvar t2 = t + delta;\r\n\r\n\t\t// Capping in case of danger\r\n\r\n\t\tif ( t1 < 0 ) t1 = 0;\r\n\t\tif ( t2 > 1 ) t2 = 1;\r\n\r\n\t\tvar pt1 = this.getPoint( t1 );\r\n\t\tvar pt2 = this.getPoint( t2 );\r\n\r\n\t\tvar vec = pt2.clone().sub( pt1 );\r\n\t\treturn vec.normalize();\r\n\r\n\t},\r\n\r\n\tgetTangentAt: function ( u ) {\r\n\r\n\t\tvar t = this.getUtoTmapping( u );\r\n\t\treturn this.getTangent( t );\r\n\r\n\t}\r\n\r\n};\r\n\r\n// TODO: Transformation for Curves?\r\n\r\n/**************************************************************\r\n *\t3D Curves\r\n **************************************************************/\r\n\r\n// A Factory method for creating new curve subclasses\r\n\r\nTHREE.Curve.create = function ( constructor, getPointFunc ) {\r\n\r\n\tconstructor.prototype = Object.create( THREE.Curve.prototype );\r\n\tconstructor.prototype.constructor = constructor;\r\n\tconstructor.prototype.getPoint = getPointFunc;\r\n\r\n\treturn constructor;\r\n\r\n};\r\n\r\n// File:src/extras/core/CurvePath.js\r\n\r\n/**\r\n * @author zz85 / http://www.lab4games.net/zz85/blog\r\n *\r\n **/\r\n\r\n/**************************************************************\r\n *\tCurved Path - a curve path is simply a array of connected\r\n *  curves, but retains the api of a curve\r\n **************************************************************/\r\n\r\nTHREE.CurvePath = function () {\r\n\r\n\tthis.curves = [];\r\n\r\n\tthis.autoClose = false; // Automatically closes the path\r\n\r\n};\r\n\r\nTHREE.CurvePath.prototype = Object.create( THREE.Curve.prototype );\r\nTHREE.CurvePath.prototype.constructor = THREE.CurvePath;\r\n\r\nTHREE.CurvePath.prototype.add = function ( curve ) {\r\n\r\n\tthis.curves.push( curve );\r\n\r\n};\r\n\r\n/*\r\nTHREE.CurvePath.prototype.checkConnection = function() {\r\n\t// TODO\r\n\t// If the ending of curve is not connected to the starting\r\n\t// or the next curve, then, this is not a real path\r\n};\r\n*/\r\n\r\nTHREE.CurvePath.prototype.closePath = function() {\r\n\r\n\t// TODO Test\r\n\t// and verify for vector3 (needs to implement equals)\r\n\t// Add a line curve if start and end of lines are not connected\r\n\tvar startPoint = this.curves[ 0 ].getPoint( 0 );\r\n\tvar endPoint = this.curves[ this.curves.length - 1 ].getPoint( 1 );\r\n\r\n\tif ( ! startPoint.equals( endPoint ) ) {\r\n\r\n\t\tthis.curves.push( new THREE.LineCurve( endPoint, startPoint ) );\r\n\r\n\t}\r\n\r\n};\r\n\r\n// To get accurate point with reference to\r\n// entire path distance at time t,\r\n// following has to be done:\r\n\r\n// 1. Length of each sub path have to be known\r\n// 2. Locate and identify type of curve\r\n// 3. Get t for the curve\r\n// 4. Return curve.getPointAt(t')\r\n\r\nTHREE.CurvePath.prototype.getPoint = function( t ) {\r\n\r\n\tvar d = t * this.getLength();\r\n\tvar curveLengths = this.getCurveLengths();\r\n\tvar i = 0;\r\n\r\n\t// To think about boundaries points.\r\n\r\n\twhile ( i < curveLengths.length ) {\r\n\r\n\t\tif ( curveLengths[ i ] >= d ) {\r\n\r\n\t\t\tvar diff = curveLengths[ i ] - d;\r\n\t\t\tvar curve = this.curves[ i ];\r\n\r\n\t\t\tvar u = 1 - diff / curve.getLength();\r\n\r\n\t\t\treturn curve.getPointAt( u );\r\n\r\n\t\t}\r\n\r\n\t\ti ++;\r\n\r\n\t}\r\n\r\n\treturn null;\r\n\r\n\t// loop where sum != 0, sum > d , sum+1 <d\r\n\r\n};\r\n\r\n/*\r\nTHREE.CurvePath.prototype.getTangent = function( t ) {\r\n};\r\n*/\r\n\r\n// We cannot use the default THREE.Curve getPoint() with getLength() because in\r\n// THREE.Curve, getLength() depends on getPoint() but in THREE.CurvePath\r\n// getPoint() depends on getLength\r\n\r\nTHREE.CurvePath.prototype.getLength = function() {\r\n\r\n\tvar lens = this.getCurveLengths();\r\n\treturn lens[ lens.length - 1 ];\r\n\r\n};\r\n\r\n// Compute lengths and cache them\r\n// We cannot overwrite getLengths() because UtoT mapping uses it.\r\n\r\nTHREE.CurvePath.prototype.getCurveLengths = function() {\r\n\r\n\t// We use cache values if curves and cache array are same length\r\n\r\n\tif ( this.cacheLengths && this.cacheLengths.length === this.curves.length ) {\r\n\r\n\t\treturn this.cacheLengths;\r\n\r\n\t}\r\n\r\n\t// Get length of sub-curve\r\n\t// Push sums into cached array\r\n\r\n\tvar lengths = [], sums = 0;\r\n\r\n\tfor ( var i = 0, l = this.curves.length; i < l; i ++ ) {\r\n\r\n\t\tsums += this.curves[ i ].getLength();\r\n\t\tlengths.push( sums );\r\n\r\n\t}\r\n\r\n\tthis.cacheLengths = lengths;\r\n\r\n\treturn lengths;\r\n\r\n};\r\n\r\n\r\n\r\n/**************************************************************\r\n *\tCreate Geometries Helpers\r\n **************************************************************/\r\n\r\n/// Generate geometry from path points (for Line or Points objects)\r\n\r\nTHREE.CurvePath.prototype.createPointsGeometry = function( divisions ) {\r\n\r\n\tvar pts = this.getPoints( divisions );\r\n\treturn this.createGeometry( pts );\r\n\r\n};\r\n\r\n// Generate geometry from equidistant sampling along the path\r\n\r\nTHREE.CurvePath.prototype.createSpacedPointsGeometry = function( divisions ) {\r\n\r\n\tvar pts = this.getSpacedPoints( divisions );\r\n\treturn this.createGeometry( pts );\r\n\r\n};\r\n\r\nTHREE.CurvePath.prototype.createGeometry = function( points ) {\r\n\r\n\tvar geometry = new THREE.Geometry();\r\n\r\n\tfor ( var i = 0, l = points.length; i < l; i ++ ) {\r\n\r\n\t\tvar point = points[ i ];\r\n\t\tgeometry.vertices.push( new THREE.Vector3( point.x, point.y, point.z || 0 ) );\r\n\r\n\t}\r\n\r\n\treturn geometry;\r\n\r\n};\r\n\r\n// File:src/extras/core/Font.js\r\n\r\n/**\r\n * @author zz85 / http://www.lab4games.net/zz85/blog\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.Font = function ( data ) {\r\n\r\n\tthis.data = data;\r\n\r\n};\r\n\r\nTHREE.Font.prototype = {\r\n\r\n\tconstructor: THREE.Font,\r\n\r\n\tgenerateShapes: function ( text, size, divisions ) {\r\n\r\n\t\tfunction createPaths( text ) {\r\n\r\n\t\t\tvar chars = String( text ).split( '' );\r\n\t\t\tvar scale = size / data.resolution;\r\n\t\t\tvar offset = 0;\r\n\r\n\t\t\tvar paths = [];\r\n\r\n\t\t\tfor ( var i = 0; i < chars.length; i ++ ) {\r\n\r\n\t\t\t\tvar ret = createPath( chars[ i ], scale, offset );\r\n\t\t\t\toffset += ret.offset;\r\n\r\n\t\t\t\tpaths.push( ret.path );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn paths;\r\n\r\n\t\t}\r\n\r\n\t\tfunction createPath( c, scale, offset ) {\r\n\r\n\t\t\tvar glyph = data.glyphs[ c ] || data.glyphs[ '?' ];\r\n\r\n\t\t\tif ( ! glyph ) return;\r\n\r\n\t\t\tvar path = new THREE.Path();\r\n\r\n\t\t\tvar pts = [], b2 = THREE.ShapeUtils.b2, b3 = THREE.ShapeUtils.b3;\r\n\t\t\tvar x, y, cpx, cpy, cpx0, cpy0, cpx1, cpy1, cpx2, cpy2, laste;\r\n\r\n\t\t\tif ( glyph.o ) {\r\n\r\n\t\t\t\tvar outline = glyph._cachedOutline || ( glyph._cachedOutline = glyph.o.split( ' ' ) );\r\n\r\n\t\t\t\tfor ( var i = 0, l = outline.length; i < l; ) {\r\n\r\n\t\t\t\t\tvar action = outline[ i ++ ];\r\n\r\n\t\t\t\t\tswitch ( action ) {\r\n\r\n\t\t\t\t\t\tcase 'm': // moveTo\r\n\r\n\t\t\t\t\t\t\tx = outline[ i ++ ] * scale + offset;\r\n\t\t\t\t\t\t\ty = outline[ i ++ ] * scale;\r\n\r\n\t\t\t\t\t\t\tpath.moveTo( x, y );\r\n\r\n\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\tcase 'l': // lineTo\r\n\r\n\t\t\t\t\t\t\tx = outline[ i ++ ] * scale + offset;\r\n\t\t\t\t\t\t\ty = outline[ i ++ ] * scale;\r\n\r\n\t\t\t\t\t\t\tpath.lineTo( x, y );\r\n\r\n\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\tcase 'q': // quadraticCurveTo\r\n\r\n\t\t\t\t\t\t\tcpx  = outline[ i ++ ] * scale + offset;\r\n\t\t\t\t\t\t\tcpy  = outline[ i ++ ] * scale;\r\n\t\t\t\t\t\t\tcpx1 = outline[ i ++ ] * scale + offset;\r\n\t\t\t\t\t\t\tcpy1 = outline[ i ++ ] * scale;\r\n\r\n\t\t\t\t\t\t\tpath.quadraticCurveTo( cpx1, cpy1, cpx, cpy );\r\n\r\n\t\t\t\t\t\t\tlaste = pts[ pts.length - 1 ];\r\n\r\n\t\t\t\t\t\t\tif ( laste ) {\r\n\r\n\t\t\t\t\t\t\t\tcpx0 = laste.x;\r\n\t\t\t\t\t\t\t\tcpy0 = laste.y;\r\n\r\n\t\t\t\t\t\t\t\tfor ( var i2 = 1; i2 <= divisions; i2 ++ ) {\r\n\r\n\t\t\t\t\t\t\t\t\tvar t = i2 / divisions;\r\n\t\t\t\t\t\t\t\t\tb2( t, cpx0, cpx1, cpx );\r\n\t\t\t\t\t\t\t\t\tb2( t, cpy0, cpy1, cpy );\r\n\r\n\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\tcase 'b': // bezierCurveTo\r\n\r\n\t\t\t\t\t\t\tcpx  = outline[ i ++ ] * scale + offset;\r\n\t\t\t\t\t\t\tcpy  = outline[ i ++ ] * scale;\r\n\t\t\t\t\t\t\tcpx1 = outline[ i ++ ] * scale + offset;\r\n\t\t\t\t\t\t\tcpy1 = outline[ i ++ ] * scale;\r\n\t\t\t\t\t\t\tcpx2 = outline[ i ++ ] * scale + offset;\r\n\t\t\t\t\t\t\tcpy2 = outline[ i ++ ] * scale;\r\n\r\n\t\t\t\t\t\t\tpath.bezierCurveTo( cpx1, cpy1, cpx2, cpy2, cpx, cpy );\r\n\r\n\t\t\t\t\t\t\tlaste = pts[ pts.length - 1 ];\r\n\r\n\t\t\t\t\t\t\tif ( laste ) {\r\n\r\n\t\t\t\t\t\t\t\tcpx0 = laste.x;\r\n\t\t\t\t\t\t\t\tcpy0 = laste.y;\r\n\r\n\t\t\t\t\t\t\t\tfor ( var i2 = 1; i2 <= divisions; i2 ++ ) {\r\n\r\n\t\t\t\t\t\t\t\t\tvar t = i2 / divisions;\r\n\t\t\t\t\t\t\t\t\tb3( t, cpx0, cpx1, cpx2, cpx );\r\n\t\t\t\t\t\t\t\t\tb3( t, cpy0, cpy1, cpy2, cpy );\r\n\r\n\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn { offset: glyph.ha * scale, path: path };\r\n\r\n\t\t}\r\n\r\n\t\t//\r\n\r\n\t\tif ( size === undefined ) size = 100;\r\n\t\tif ( divisions === undefined ) divisions = 4;\r\n\r\n\t\tvar data = this.data;\r\n\r\n\t\tvar paths = createPaths( text );\r\n\t\tvar shapes = [];\r\n\r\n\t\tfor ( var p = 0, pl = paths.length; p < pl; p ++ ) {\r\n\r\n\t\t\tArray.prototype.push.apply( shapes, paths[ p ].toShapes() );\r\n\r\n\t\t}\r\n\r\n\t\treturn shapes;\r\n\r\n\t}\r\n\r\n};\r\n\r\n// File:src/extras/core/Path.js\r\n\r\n/**\r\n * @author zz85 / http://www.lab4games.net/zz85/blog\r\n * Creates free form 2d path using series of points, lines or curves.\r\n *\r\n **/\r\n\r\nTHREE.Path = function ( points ) {\r\n\r\n\tTHREE.CurvePath.call( this );\r\n\r\n\tthis.actions = [];\r\n\r\n\tif ( points ) {\r\n\r\n\t\tthis.fromPoints( points );\r\n\r\n\t}\r\n\r\n};\r\n\r\nTHREE.Path.prototype = Object.create( THREE.CurvePath.prototype );\r\nTHREE.Path.prototype.constructor = THREE.Path;\r\n\r\n// TODO Clean up PATH API\r\n\r\n// Create path using straight lines to connect all points\r\n// - vectors: array of Vector2\r\n\r\nTHREE.Path.prototype.fromPoints = function ( vectors ) {\r\n\r\n\tthis.moveTo( vectors[ 0 ].x, vectors[ 0 ].y );\r\n\r\n\tfor ( var i = 1, l = vectors.length; i < l; i ++ ) {\r\n\r\n\t\tthis.lineTo( vectors[ i ].x, vectors[ i ].y );\r\n\r\n\t}\r\n\r\n};\r\n\r\n// startPath() endPath()?\r\n\r\nTHREE.Path.prototype.moveTo = function ( x, y ) {\r\n\r\n\tthis.actions.push( { action: 'moveTo', args: [ x, y ] } );\r\n\r\n};\r\n\r\nTHREE.Path.prototype.lineTo = function ( x, y ) {\r\n\r\n\tvar lastargs = this.actions[ this.actions.length - 1 ].args;\r\n\r\n\tvar x0 = lastargs[ lastargs.length - 2 ];\r\n\tvar y0 = lastargs[ lastargs.length - 1 ];\r\n\r\n\tvar curve = new THREE.LineCurve( new THREE.Vector2( x0, y0 ), new THREE.Vector2( x, y ) );\r\n\tthis.curves.push( curve );\r\n\r\n\tthis.actions.push( { action: 'lineTo', args: [ x, y ] } );\r\n\r\n};\r\n\r\nTHREE.Path.prototype.quadraticCurveTo = function( aCPx, aCPy, aX, aY ) {\r\n\r\n\tvar lastargs = this.actions[ this.actions.length - 1 ].args;\r\n\r\n\tvar x0 = lastargs[ lastargs.length - 2 ];\r\n\tvar y0 = lastargs[ lastargs.length - 1 ];\r\n\r\n\tvar curve = new THREE.QuadraticBezierCurve(\r\n\t\tnew THREE.Vector2( x0, y0 ),\r\n\t\tnew THREE.Vector2( aCPx, aCPy ),\r\n\t\tnew THREE.Vector2( aX, aY )\r\n\t);\r\n\r\n\tthis.curves.push( curve );\r\n\r\n\tthis.actions.push( { action: 'quadraticCurveTo', args: [ aCPx, aCPy, aX, aY ] } );\r\n\r\n};\r\n\r\nTHREE.Path.prototype.bezierCurveTo = function( aCP1x, aCP1y, aCP2x, aCP2y, aX, aY ) {\r\n\r\n\tvar lastargs = this.actions[ this.actions.length - 1 ].args;\r\n\r\n\tvar x0 = lastargs[ lastargs.length - 2 ];\r\n\tvar y0 = lastargs[ lastargs.length - 1 ];\r\n\r\n\tvar curve = new THREE.CubicBezierCurve(\r\n\t\tnew THREE.Vector2( x0, y0 ),\r\n\t\tnew THREE.Vector2( aCP1x, aCP1y ),\r\n\t\tnew THREE.Vector2( aCP2x, aCP2y ),\r\n\t\tnew THREE.Vector2( aX, aY )\r\n\t);\r\n\r\n\tthis.curves.push( curve );\r\n\r\n\tthis.actions.push( { action: 'bezierCurveTo', args: [ aCP1x, aCP1y, aCP2x, aCP2y, aX, aY ] } );\r\n\r\n};\r\n\r\nTHREE.Path.prototype.splineThru = function( pts /*Array of Vector*/ ) {\r\n\r\n\tvar args = Array.prototype.slice.call( arguments );\r\n\r\n\tvar lastargs = this.actions[ this.actions.length - 1 ].args;\r\n\r\n\tvar x0 = lastargs[ lastargs.length - 2 ];\r\n\tvar y0 = lastargs[ lastargs.length - 1 ];\r\n\r\n\tvar npts = [ new THREE.Vector2( x0, y0 ) ];\r\n\tArray.prototype.push.apply( npts, pts );\r\n\r\n\tvar curve = new THREE.SplineCurve( npts );\r\n\tthis.curves.push( curve );\r\n\r\n\tthis.actions.push( { action: 'splineThru', args: args } );\r\n\r\n};\r\n\r\n// FUTURE: Change the API or follow canvas API?\r\n\r\nTHREE.Path.prototype.arc = function ( aX, aY, aRadius, aStartAngle, aEndAngle, aClockwise ) {\r\n\r\n\tvar lastargs = this.actions[ this.actions.length - 1 ].args;\r\n\tvar x0 = lastargs[ lastargs.length - 2 ];\r\n\tvar y0 = lastargs[ lastargs.length - 1 ];\r\n\r\n\tthis.absarc( aX + x0, aY + y0, aRadius,\r\n\t\taStartAngle, aEndAngle, aClockwise );\r\n\r\n };\r\n\r\n THREE.Path.prototype.absarc = function ( aX, aY, aRadius, aStartAngle, aEndAngle, aClockwise ) {\r\n\r\n\tthis.absellipse( aX, aY, aRadius, aRadius, aStartAngle, aEndAngle, aClockwise );\r\n\r\n };\r\n\r\nTHREE.Path.prototype.ellipse = function ( aX, aY, xRadius, yRadius, aStartAngle, aEndAngle, aClockwise, aRotation ) {\r\n\r\n\tvar lastargs = this.actions[ this.actions.length - 1 ].args;\r\n\tvar x0 = lastargs[ lastargs.length - 2 ];\r\n\tvar y0 = lastargs[ lastargs.length - 1 ];\r\n\r\n\tthis.absellipse( aX + x0, aY + y0, xRadius, yRadius, aStartAngle, aEndAngle, aClockwise, aRotation );\r\n\r\n };\r\n\r\n\r\nTHREE.Path.prototype.absellipse = function ( aX, aY, xRadius, yRadius, aStartAngle, aEndAngle, aClockwise, aRotation ) {\r\n\r\n\tvar args = [\r\n\t\taX, aY,\r\n\t\txRadius, yRadius,\r\n\t\taStartAngle, aEndAngle,\r\n\t\taClockwise,\r\n\t\taRotation || 0 // aRotation is optional.\r\n\t];\r\n\r\n\tvar curve = new THREE.EllipseCurve( aX, aY, xRadius, yRadius, aStartAngle, aEndAngle, aClockwise, aRotation );\r\n\tthis.curves.push( curve );\r\n\r\n\tvar lastPoint = curve.getPoint( 1 );\r\n\targs.push( lastPoint.x );\r\n\targs.push( lastPoint.y );\r\n\r\n\tthis.actions.push( { action: 'ellipse', args: args } );\r\n\r\n };\r\n\r\nTHREE.Path.prototype.getSpacedPoints = function ( divisions ) {\r\n\r\n\tif ( ! divisions ) divisions = 40;\r\n\r\n\tvar points = [];\r\n\r\n\tfor ( var i = 0; i < divisions; i ++ ) {\r\n\r\n\t\tpoints.push( this.getPoint( i / divisions ) );\r\n\r\n\t\t//if ( !this.getPoint( i / divisions ) ) throw \"DIE\";\r\n\r\n\t}\r\n\r\n\tif ( this.autoClose ) {\r\n\r\n\t\tpoints.push( points[ 0 ] );\r\n\r\n\t}\r\n\r\n\treturn points;\r\n\r\n};\r\n\r\n/* Return an array of vectors based on contour of the path */\r\n\r\nTHREE.Path.prototype.getPoints = function( divisions ) {\r\n\r\n\tdivisions = divisions || 12;\r\n\r\n\tvar b2 = THREE.ShapeUtils.b2;\r\n\tvar b3 = THREE.ShapeUtils.b3;\r\n\r\n\tvar points = [];\r\n\r\n\tvar cpx, cpy, cpx2, cpy2, cpx1, cpy1, cpx0, cpy0,\r\n\t\tlaste, tx, ty;\r\n\r\n\tfor ( var i = 0, l = this.actions.length; i < l; i ++ ) {\r\n\r\n\t\tvar item = this.actions[ i ];\r\n\r\n\t\tvar action = item.action;\r\n\t\tvar args = item.args;\r\n\r\n\t\tswitch ( action ) {\r\n\r\n\t\tcase 'moveTo':\r\n\r\n\t\t\tpoints.push( new THREE.Vector2( args[ 0 ], args[ 1 ] ) );\r\n\r\n\t\t\tbreak;\r\n\r\n\t\tcase 'lineTo':\r\n\r\n\t\t\tpoints.push( new THREE.Vector2( args[ 0 ], args[ 1 ] ) );\r\n\r\n\t\t\tbreak;\r\n\r\n\t\tcase 'quadraticCurveTo':\r\n\r\n\t\t\tcpx  = args[ 2 ];\r\n\t\t\tcpy  = args[ 3 ];\r\n\r\n\t\t\tcpx1 = args[ 0 ];\r\n\t\t\tcpy1 = args[ 1 ];\r\n\r\n\t\t\tif ( points.length > 0 ) {\r\n\r\n\t\t\t\tlaste = points[ points.length - 1 ];\r\n\r\n\t\t\t\tcpx0 = laste.x;\r\n\t\t\t\tcpy0 = laste.y;\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tlaste = this.actions[ i - 1 ].args;\r\n\r\n\t\t\t\tcpx0 = laste[ laste.length - 2 ];\r\n\t\t\t\tcpy0 = laste[ laste.length - 1 ];\r\n\r\n\t\t\t}\r\n\r\n\t\t\tfor ( var j = 1; j <= divisions; j ++ ) {\r\n\r\n\t\t\t\tvar t = j / divisions;\r\n\r\n\t\t\t\ttx = b2( t, cpx0, cpx1, cpx );\r\n\t\t\t\tty = b2( t, cpy0, cpy1, cpy );\r\n\r\n\t\t\t\tpoints.push( new THREE.Vector2( tx, ty ) );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tbreak;\r\n\r\n\t\tcase 'bezierCurveTo':\r\n\r\n\t\t\tcpx  = args[ 4 ];\r\n\t\t\tcpy  = args[ 5 ];\r\n\r\n\t\t\tcpx1 = args[ 0 ];\r\n\t\t\tcpy1 = args[ 1 ];\r\n\r\n\t\t\tcpx2 = args[ 2 ];\r\n\t\t\tcpy2 = args[ 3 ];\r\n\r\n\t\t\tif ( points.length > 0 ) {\r\n\r\n\t\t\t\tlaste = points[ points.length - 1 ];\r\n\r\n\t\t\t\tcpx0 = laste.x;\r\n\t\t\t\tcpy0 = laste.y;\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tlaste = this.actions[ i - 1 ].args;\r\n\r\n\t\t\t\tcpx0 = laste[ laste.length - 2 ];\r\n\t\t\t\tcpy0 = laste[ laste.length - 1 ];\r\n\r\n\t\t\t}\r\n\r\n\r\n\t\t\tfor ( var j = 1; j <= divisions; j ++ ) {\r\n\r\n\t\t\t\tvar t = j / divisions;\r\n\r\n\t\t\t\ttx = b3( t, cpx0, cpx1, cpx2, cpx );\r\n\t\t\t\tty = b3( t, cpy0, cpy1, cpy2, cpy );\r\n\r\n\t\t\t\tpoints.push( new THREE.Vector2( tx, ty ) );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tbreak;\r\n\r\n\t\tcase 'splineThru':\r\n\r\n\t\t\tlaste = this.actions[ i - 1 ].args;\r\n\r\n\t\t\tvar last = new THREE.Vector2( laste[ laste.length - 2 ], laste[ laste.length - 1 ] );\r\n\t\t\tvar spts = [ last ];\r\n\r\n\t\t\tvar n = divisions * args[ 0 ].length;\r\n\r\n\t\t\tspts = spts.concat( args[ 0 ] );\r\n\r\n\t\t\tvar spline = new THREE.SplineCurve( spts );\r\n\r\n\t\t\tfor ( var j = 1; j <= n; j ++ ) {\r\n\r\n\t\t\t\tpoints.push( spline.getPointAt( j / n ) );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tbreak;\r\n\r\n\t\tcase 'arc':\r\n\r\n\t\t\tvar aX = args[ 0 ], aY = args[ 1 ],\r\n\t\t\t\taRadius = args[ 2 ],\r\n\t\t\t\taStartAngle = args[ 3 ], aEndAngle = args[ 4 ],\r\n\t\t\t\taClockwise = !! args[ 5 ];\r\n\r\n\t\t\tvar deltaAngle = aEndAngle - aStartAngle;\r\n\t\t\tvar angle;\r\n\t\t\tvar tdivisions = divisions * 2;\r\n\r\n\t\t\tfor ( var j = 1; j <= tdivisions; j ++ ) {\r\n\r\n\t\t\t\tvar t = j / tdivisions;\r\n\r\n\t\t\t\tif ( ! aClockwise ) {\r\n\r\n\t\t\t\t\tt = 1 - t;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tangle = aStartAngle + t * deltaAngle;\r\n\r\n\t\t\t\ttx = aX + aRadius * Math.cos( angle );\r\n\t\t\t\tty = aY + aRadius * Math.sin( angle );\r\n\r\n\t\t\t\t//console.log('t', t, 'angle', angle, 'tx', tx, 'ty', ty);\r\n\r\n\t\t\t\tpoints.push( new THREE.Vector2( tx, ty ) );\r\n\r\n\t\t\t}\r\n\r\n\t\t\t//console.log(points);\r\n\r\n\t\t\tbreak;\r\n\r\n\t\tcase 'ellipse':\r\n\r\n\t\t\tvar aX = args[ 0 ], aY = args[ 1 ],\r\n\t\t\t\txRadius = args[ 2 ],\r\n\t\t\t\tyRadius = args[ 3 ],\r\n\t\t\t\taStartAngle = args[ 4 ], aEndAngle = args[ 5 ],\r\n\t\t\t\taClockwise = !! args[ 6 ],\r\n\t\t\t\taRotation = args[ 7 ];\r\n\r\n\r\n\t\t\tvar deltaAngle = aEndAngle - aStartAngle;\r\n\t\t\tvar angle;\r\n\t\t\tvar tdivisions = divisions * 2;\r\n\r\n\t\t\tvar cos, sin;\r\n\t\t\tif ( aRotation !== 0 ) {\r\n\r\n\t\t\t\tcos = Math.cos( aRotation );\r\n\t\t\t\tsin = Math.sin( aRotation );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tfor ( var j = 1; j <= tdivisions; j ++ ) {\r\n\r\n\t\t\t\tvar t = j / tdivisions;\r\n\r\n\t\t\t\tif ( ! aClockwise ) {\r\n\r\n\t\t\t\t\tt = 1 - t;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tangle = aStartAngle + t * deltaAngle;\r\n\r\n\t\t\t\ttx = aX + xRadius * Math.cos( angle );\r\n\t\t\t\tty = aY + yRadius * Math.sin( angle );\r\n\r\n\t\t\t\tif ( aRotation !== 0 ) {\r\n\r\n\t\t\t\t\tvar x = tx, y = ty;\r\n\r\n\t\t\t\t\t// Rotate the point about the center of the ellipse.\r\n\t\t\t\t\ttx = ( x - aX ) * cos - ( y - aY ) * sin + aX;\r\n\t\t\t\t\tty = ( x - aX ) * sin + ( y - aY ) * cos + aY;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\t//console.log('t', t, 'angle', angle, 'tx', tx, 'ty', ty);\r\n\r\n\t\t\t\tpoints.push( new THREE.Vector2( tx, ty ) );\r\n\r\n\t\t\t}\r\n\r\n\t\t\t//console.log(points);\r\n\r\n\t\t\tbreak;\r\n\r\n\t\t} // end switch\r\n\r\n\t}\r\n\r\n\r\n\r\n\t// Normalize to remove the closing point by default.\r\n\tvar lastPoint = points[ points.length - 1 ];\r\n\tif ( Math.abs( lastPoint.x - points[ 0 ].x ) < Number.EPSILON &&\r\n\t\t\t Math.abs( lastPoint.y - points[ 0 ].y ) < Number.EPSILON )\r\n\t\tpoints.splice( points.length - 1, 1 );\r\n\r\n\tif ( this.autoClose ) {\r\n\r\n\t\tpoints.push( points[ 0 ] );\r\n\r\n\t}\r\n\r\n\treturn points;\r\n\r\n};\r\n\r\n//\r\n// Breaks path into shapes\r\n//\r\n//\tAssumptions (if parameter isCCW==true the opposite holds):\r\n//\t- solid shapes are defined clockwise (CW)\r\n//\t- holes are defined counterclockwise (CCW)\r\n//\r\n//\tIf parameter noHoles==true:\r\n//  - all subPaths are regarded as solid shapes\r\n//  - definition order CW/CCW has no relevance\r\n//\r\n\r\nTHREE.Path.prototype.toShapes = function( isCCW, noHoles ) {\r\n\r\n\tfunction extractSubpaths( inActions ) {\r\n\r\n\t\tvar subPaths = [], lastPath = new THREE.Path();\r\n\r\n\t\tfor ( var i = 0, l = inActions.length; i < l; i ++ ) {\r\n\r\n\t\t\tvar item = inActions[ i ];\r\n\r\n\t\t\tvar args = item.args;\r\n\t\t\tvar action = item.action;\r\n\r\n\t\t\tif ( action === 'moveTo' ) {\r\n\r\n\t\t\t\tif ( lastPath.actions.length !== 0 ) {\r\n\r\n\t\t\t\t\tsubPaths.push( lastPath );\r\n\t\t\t\t\tlastPath = new THREE.Path();\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tlastPath[ action ].apply( lastPath, args );\r\n\r\n\t\t}\r\n\r\n\t\tif ( lastPath.actions.length !== 0 ) {\r\n\r\n\t\t\tsubPaths.push( lastPath );\r\n\r\n\t\t}\r\n\r\n\t\t// console.log(subPaths);\r\n\r\n\t\treturn\tsubPaths;\r\n\r\n\t}\r\n\r\n\tfunction toShapesNoHoles( inSubpaths ) {\r\n\r\n\t\tvar shapes = [];\r\n\r\n\t\tfor ( var i = 0, l = inSubpaths.length; i < l; i ++ ) {\r\n\r\n\t\t\tvar tmpPath = inSubpaths[ i ];\r\n\r\n\t\t\tvar tmpShape = new THREE.Shape();\r\n\t\t\ttmpShape.actions = tmpPath.actions;\r\n\t\t\ttmpShape.curves = tmpPath.curves;\r\n\r\n\t\t\tshapes.push( tmpShape );\r\n\r\n\t\t}\r\n\r\n\t\t//console.log(\"shape\", shapes);\r\n\r\n\t\treturn shapes;\r\n\r\n\t}\r\n\r\n\tfunction isPointInsidePolygon( inPt, inPolygon ) {\r\n\r\n\t\tvar polyLen = inPolygon.length;\r\n\r\n\t\t// inPt on polygon contour => immediate success    or\r\n\t\t// toggling of inside/outside at every single! intersection point of an edge\r\n\t\t//  with the horizontal line through inPt, left of inPt\r\n\t\t//  not counting lowerY endpoints of edges and whole edges on that line\r\n\t\tvar inside = false;\r\n\t\tfor ( var p = polyLen - 1, q = 0; q < polyLen; p = q ++ ) {\r\n\r\n\t\t\tvar edgeLowPt  = inPolygon[ p ];\r\n\t\t\tvar edgeHighPt = inPolygon[ q ];\r\n\r\n\t\t\tvar edgeDx = edgeHighPt.x - edgeLowPt.x;\r\n\t\t\tvar edgeDy = edgeHighPt.y - edgeLowPt.y;\r\n\r\n\t\t\tif ( Math.abs( edgeDy ) > Number.EPSILON ) {\r\n\r\n\t\t\t\t// not parallel\r\n\t\t\t\tif ( edgeDy < 0 ) {\r\n\r\n\t\t\t\t\tedgeLowPt  = inPolygon[ q ]; edgeDx = - edgeDx;\r\n\t\t\t\t\tedgeHighPt = inPolygon[ p ]; edgeDy = - edgeDy;\r\n\r\n\t\t\t\t}\r\n\t\t\t\tif ( ( inPt.y < edgeLowPt.y ) || ( inPt.y > edgeHighPt.y ) ) \t\tcontinue;\r\n\r\n\t\t\t\tif ( inPt.y === edgeLowPt.y ) {\r\n\r\n\t\t\t\t\tif ( inPt.x === edgeLowPt.x )\t\treturn\ttrue;\t\t// inPt is on contour ?\r\n\t\t\t\t\t// continue;\t\t\t\t// no intersection or edgeLowPt => doesn't count !!!\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tvar perpEdge = edgeDy * ( inPt.x - edgeLowPt.x ) - edgeDx * ( inPt.y - edgeLowPt.y );\r\n\t\t\t\t\tif ( perpEdge === 0 )\t\t\t\treturn\ttrue;\t\t// inPt is on contour ?\r\n\t\t\t\t\tif ( perpEdge < 0 ) \t\t\t\tcontinue;\r\n\t\t\t\t\tinside = ! inside;\t\t// true intersection left of inPt\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\t// parallel or collinear\r\n\t\t\t\tif ( inPt.y !== edgeLowPt.y ) \t\tcontinue;\t\t\t// parallel\r\n\t\t\t\t// edge lies on the same horizontal line as inPt\r\n\t\t\t\tif ( ( ( edgeHighPt.x <= inPt.x ) && ( inPt.x <= edgeLowPt.x ) ) ||\r\n\t\t\t\t\t ( ( edgeLowPt.x <= inPt.x ) && ( inPt.x <= edgeHighPt.x ) ) )\t\treturn\ttrue;\t// inPt: Point on contour !\r\n\t\t\t\t// continue;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\treturn\tinside;\r\n\r\n\t}\r\n\r\n\tvar isClockWise = THREE.ShapeUtils.isClockWise;\r\n\r\n\tvar subPaths = extractSubpaths( this.actions );\r\n\tif ( subPaths.length === 0 ) return [];\r\n\r\n\tif ( noHoles === true )\treturn\ttoShapesNoHoles( subPaths );\r\n\r\n\r\n\tvar solid, tmpPath, tmpShape, shapes = [];\r\n\r\n\tif ( subPaths.length === 1 ) {\r\n\r\n\t\ttmpPath = subPaths[ 0 ];\r\n\t\ttmpShape = new THREE.Shape();\r\n\t\ttmpShape.actions = tmpPath.actions;\r\n\t\ttmpShape.curves = tmpPath.curves;\r\n\t\tshapes.push( tmpShape );\r\n\t\treturn shapes;\r\n\r\n\t}\r\n\r\n\tvar holesFirst = ! isClockWise( subPaths[ 0 ].getPoints() );\r\n\tholesFirst = isCCW ? ! holesFirst : holesFirst;\r\n\r\n\t// console.log(\"Holes first\", holesFirst);\r\n\r\n\tvar betterShapeHoles = [];\r\n\tvar newShapes = [];\r\n\tvar newShapeHoles = [];\r\n\tvar mainIdx = 0;\r\n\tvar tmpPoints;\r\n\r\n\tnewShapes[ mainIdx ] = undefined;\r\n\tnewShapeHoles[ mainIdx ] = [];\r\n\r\n\tfor ( var i = 0, l = subPaths.length; i < l; i ++ ) {\r\n\r\n\t\ttmpPath = subPaths[ i ];\r\n\t\ttmpPoints = tmpPath.getPoints();\r\n\t\tsolid = isClockWise( tmpPoints );\r\n\t\tsolid = isCCW ? ! solid : solid;\r\n\r\n\t\tif ( solid ) {\r\n\r\n\t\t\tif ( ( ! holesFirst ) && ( newShapes[ mainIdx ] ) )\tmainIdx ++;\r\n\r\n\t\t\tnewShapes[ mainIdx ] = { s: new THREE.Shape(), p: tmpPoints };\r\n\t\t\tnewShapes[ mainIdx ].s.actions = tmpPath.actions;\r\n\t\t\tnewShapes[ mainIdx ].s.curves = tmpPath.curves;\r\n\r\n\t\t\tif ( holesFirst )\tmainIdx ++;\r\n\t\t\tnewShapeHoles[ mainIdx ] = [];\r\n\r\n\t\t\t//console.log('cw', i);\r\n\r\n\t\t} else {\r\n\r\n\t\t\tnewShapeHoles[ mainIdx ].push( { h: tmpPath, p: tmpPoints[ 0 ] } );\r\n\r\n\t\t\t//console.log('ccw', i);\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t// only Holes? -> probably all Shapes with wrong orientation\r\n\tif ( ! newShapes[ 0 ] )\treturn\ttoShapesNoHoles( subPaths );\r\n\r\n\r\n\tif ( newShapes.length > 1 ) {\r\n\r\n\t\tvar ambiguous = false;\r\n\t\tvar toChange = [];\r\n\r\n\t\tfor ( var sIdx = 0, sLen = newShapes.length; sIdx < sLen; sIdx ++ ) {\r\n\r\n\t\t\tbetterShapeHoles[ sIdx ] = [];\r\n\r\n\t\t}\r\n\r\n\t\tfor ( var sIdx = 0, sLen = newShapes.length; sIdx < sLen; sIdx ++ ) {\r\n\r\n\t\t\tvar sho = newShapeHoles[ sIdx ];\r\n\r\n\t\t\tfor ( var hIdx = 0; hIdx < sho.length; hIdx ++ ) {\r\n\r\n\t\t\t\tvar ho = sho[ hIdx ];\r\n\t\t\t\tvar hole_unassigned = true;\r\n\r\n\t\t\t\tfor ( var s2Idx = 0; s2Idx < newShapes.length; s2Idx ++ ) {\r\n\r\n\t\t\t\t\tif ( isPointInsidePolygon( ho.p, newShapes[ s2Idx ].p ) ) {\r\n\r\n\t\t\t\t\t\tif ( sIdx !== s2Idx )\ttoChange.push( { froms: sIdx, tos: s2Idx, hole: hIdx } );\r\n\t\t\t\t\t\tif ( hole_unassigned ) {\r\n\r\n\t\t\t\t\t\t\thole_unassigned = false;\r\n\t\t\t\t\t\t\tbetterShapeHoles[ s2Idx ].push( ho );\r\n\r\n\t\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\t\tambiguous = true;\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\t\t\t\tif ( hole_unassigned ) {\r\n\r\n\t\t\t\t\tbetterShapeHoles[ sIdx ].push( ho );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\t\t// console.log(\"ambiguous: \", ambiguous);\r\n\t\tif ( toChange.length > 0 ) {\r\n\r\n\t\t\t// console.log(\"to change: \", toChange);\r\n\t\t\tif ( ! ambiguous )\tnewShapeHoles = betterShapeHoles;\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tvar tmpHoles;\r\n\r\n\tfor ( var i = 0, il = newShapes.length; i < il; i ++ ) {\r\n\r\n\t\ttmpShape = newShapes[ i ].s;\r\n\t\tshapes.push( tmpShape );\r\n\t\ttmpHoles = newShapeHoles[ i ];\r\n\r\n\t\tfor ( var j = 0, jl = tmpHoles.length; j < jl; j ++ ) {\r\n\r\n\t\t\ttmpShape.holes.push( tmpHoles[ j ].h );\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t//console.log(\"shape\", shapes);\r\n\r\n\treturn shapes;\r\n\r\n};\r\n\r\n// File:src/extras/core/Shape.js\r\n\r\n/**\r\n * @author zz85 / http://www.lab4games.net/zz85/blog\r\n * Defines a 2d shape plane using paths.\r\n **/\r\n\r\n// STEP 1 Create a path.\r\n// STEP 2 Turn path into shape.\r\n// STEP 3 ExtrudeGeometry takes in Shape/Shapes\r\n// STEP 3a - Extract points from each shape, turn to vertices\r\n// STEP 3b - Triangulate each shape, add faces.\r\n\r\nTHREE.Shape = function () {\r\n\r\n\tTHREE.Path.apply( this, arguments );\r\n\r\n\tthis.holes = [];\r\n\r\n};\r\n\r\nTHREE.Shape.prototype = Object.create( THREE.Path.prototype );\r\nTHREE.Shape.prototype.constructor = THREE.Shape;\r\n\r\n// Convenience method to return ExtrudeGeometry\r\n\r\nTHREE.Shape.prototype.extrude = function ( options ) {\r\n\r\n\treturn new THREE.ExtrudeGeometry( this, options );\r\n\r\n};\r\n\r\n// Convenience method to return ShapeGeometry\r\n\r\nTHREE.Shape.prototype.makeGeometry = function ( options ) {\r\n\r\n\treturn new THREE.ShapeGeometry( this, options );\r\n\r\n};\r\n\r\n// Get points of holes\r\n\r\nTHREE.Shape.prototype.getPointsHoles = function ( divisions ) {\r\n\r\n\tvar holesPts = [];\r\n\r\n\tfor ( var i = 0, l = this.holes.length; i < l; i ++ ) {\r\n\r\n\t\tholesPts[ i ] = this.holes[ i ].getPoints( divisions );\r\n\r\n\t}\r\n\r\n\treturn holesPts;\r\n\r\n};\r\n\r\n\r\n// Get points of shape and holes (keypoints based on segments parameter)\r\n\r\nTHREE.Shape.prototype.extractAllPoints = function ( divisions ) {\r\n\r\n\treturn {\r\n\r\n\t\tshape: this.getPoints( divisions ),\r\n\t\tholes: this.getPointsHoles( divisions )\r\n\r\n\t};\r\n\r\n};\r\n\r\nTHREE.Shape.prototype.extractPoints = function ( divisions ) {\r\n\r\n\treturn this.extractAllPoints( divisions );\r\n\r\n};\r\n\r\n// File:src/extras/curves/LineCurve.js\r\n\r\n/**************************************************************\r\n *\tLine\r\n **************************************************************/\r\n\r\nTHREE.LineCurve = function ( v1, v2 ) {\r\n\r\n\tthis.v1 = v1;\r\n\tthis.v2 = v2;\r\n\r\n};\r\n\r\nTHREE.LineCurve.prototype = Object.create( THREE.Curve.prototype );\r\nTHREE.LineCurve.prototype.constructor = THREE.LineCurve;\r\n\r\nTHREE.LineCurve.prototype.getPoint = function ( t ) {\r\n\r\n\tvar point = this.v2.clone().sub( this.v1 );\r\n\tpoint.multiplyScalar( t ).add( this.v1 );\r\n\r\n\treturn point;\r\n\r\n};\r\n\r\n// Line curve is linear, so we can overwrite default getPointAt\r\n\r\nTHREE.LineCurve.prototype.getPointAt = function ( u ) {\r\n\r\n\treturn this.getPoint( u );\r\n\r\n};\r\n\r\nTHREE.LineCurve.prototype.getTangent = function( t ) {\r\n\r\n\tvar tangent = this.v2.clone().sub( this.v1 );\r\n\r\n\treturn tangent.normalize();\r\n\r\n};\r\n\r\n// File:src/extras/curves/QuadraticBezierCurve.js\r\n\r\n/**************************************************************\r\n *\tQuadratic Bezier curve\r\n **************************************************************/\r\n\r\n\r\nTHREE.QuadraticBezierCurve = function ( v0, v1, v2 ) {\r\n\r\n\tthis.v0 = v0;\r\n\tthis.v1 = v1;\r\n\tthis.v2 = v2;\r\n\r\n};\r\n\r\nTHREE.QuadraticBezierCurve.prototype = Object.create( THREE.Curve.prototype );\r\nTHREE.QuadraticBezierCurve.prototype.constructor = THREE.QuadraticBezierCurve;\r\n\r\n\r\nTHREE.QuadraticBezierCurve.prototype.getPoint = function ( t ) {\r\n\r\n\tvar b2 = THREE.ShapeUtils.b2;\r\n\r\n\treturn new THREE.Vector2(\r\n\t\tb2( t, this.v0.x, this.v1.x, this.v2.x ),\r\n\t\tb2( t, this.v0.y, this.v1.y, this.v2.y )\r\n\t);\r\n\r\n};\r\n\r\n\r\nTHREE.QuadraticBezierCurve.prototype.getTangent = function( t ) {\r\n\r\n\tvar tangentQuadraticBezier = THREE.CurveUtils.tangentQuadraticBezier;\r\n\r\n\treturn new THREE.Vector2(\r\n\t\ttangentQuadraticBezier( t, this.v0.x, this.v1.x, this.v2.x ),\r\n\t\ttangentQuadraticBezier( t, this.v0.y, this.v1.y, this.v2.y )\r\n\t).normalize();\r\n\r\n};\r\n\r\n// File:src/extras/curves/CubicBezierCurve.js\r\n\r\n/**************************************************************\r\n *\tCubic Bezier curve\r\n **************************************************************/\r\n\r\nTHREE.CubicBezierCurve = function ( v0, v1, v2, v3 ) {\r\n\r\n\tthis.v0 = v0;\r\n\tthis.v1 = v1;\r\n\tthis.v2 = v2;\r\n\tthis.v3 = v3;\r\n\r\n};\r\n\r\nTHREE.CubicBezierCurve.prototype = Object.create( THREE.Curve.prototype );\r\nTHREE.CubicBezierCurve.prototype.constructor = THREE.CubicBezierCurve;\r\n\r\nTHREE.CubicBezierCurve.prototype.getPoint = function ( t ) {\r\n\r\n\tvar b3 = THREE.ShapeUtils.b3;\r\n\r\n\treturn new THREE.Vector2( \r\n\t\tb3( t, this.v0.x, this.v1.x, this.v2.x, this.v3.x ),\r\n\t\tb3( t, this.v0.y, this.v1.y, this.v2.y, this.v3.y )\r\n\t);\r\n\r\n};\r\n\r\nTHREE.CubicBezierCurve.prototype.getTangent = function( t ) {\r\n\r\n\tvar tangentCubicBezier = THREE.CurveUtils.tangentCubicBezier;\r\n\r\n\treturn new THREE.Vector2( \r\n\t\ttangentCubicBezier( t, this.v0.x, this.v1.x, this.v2.x, this.v3.x ),\r\n\t\ttangentCubicBezier( t, this.v0.y, this.v1.y, this.v2.y, this.v3.y )\r\n\t).normalize();\r\n\r\n};\r\n\r\n// File:src/extras/curves/SplineCurve.js\r\n\r\n/**************************************************************\r\n *\tSpline curve\r\n **************************************************************/\r\n\r\nTHREE.SplineCurve = function ( points /* array of Vector2 */ ) {\r\n\r\n\tthis.points = ( points == undefined ) ? [] : points;\r\n\r\n};\r\n\r\nTHREE.SplineCurve.prototype = Object.create( THREE.Curve.prototype );\r\nTHREE.SplineCurve.prototype.constructor = THREE.SplineCurve;\r\n\r\nTHREE.SplineCurve.prototype.getPoint = function ( t ) {\r\n\r\n\tvar points = this.points;\r\n\tvar point = ( points.length - 1 ) * t;\r\n\r\n\tvar intPoint = Math.floor( point );\r\n\tvar weight = point - intPoint;\r\n\r\n\tvar point0 = points[ intPoint === 0 ? intPoint : intPoint - 1 ];\r\n\tvar point1 = points[ intPoint ];\r\n\tvar point2 = points[ intPoint > points.length - 2 ? points.length - 1 : intPoint + 1 ];\r\n\tvar point3 = points[ intPoint > points.length - 3 ? points.length - 1 : intPoint + 2 ];\r\n\r\n\tvar interpolate = THREE.CurveUtils.interpolate;\r\n\r\n\treturn new THREE.Vector2(\r\n\t\tinterpolate( point0.x, point1.x, point2.x, point3.x, weight ),\r\n\t\tinterpolate( point0.y, point1.y, point2.y, point3.y, weight )\r\n\t);\r\n\r\n};\r\n\r\n// File:src/extras/curves/EllipseCurve.js\r\n\r\n/**************************************************************\r\n *\tEllipse curve\r\n **************************************************************/\r\n\r\nTHREE.EllipseCurve = function ( aX, aY, xRadius, yRadius, aStartAngle, aEndAngle, aClockwise, aRotation ) {\r\n\r\n\tthis.aX = aX;\r\n\tthis.aY = aY;\r\n\r\n\tthis.xRadius = xRadius;\r\n\tthis.yRadius = yRadius;\r\n\r\n\tthis.aStartAngle = aStartAngle;\r\n\tthis.aEndAngle = aEndAngle;\r\n\r\n\tthis.aClockwise = aClockwise;\r\n\t\r\n\tthis.aRotation = aRotation || 0;\r\n\r\n};\r\n\r\nTHREE.EllipseCurve.prototype = Object.create( THREE.Curve.prototype );\r\nTHREE.EllipseCurve.prototype.constructor = THREE.EllipseCurve;\r\n\r\nTHREE.EllipseCurve.prototype.getPoint = function ( t ) {\r\n\r\n\tvar deltaAngle = this.aEndAngle - this.aStartAngle;\r\n\r\n\tif ( deltaAngle < 0 ) deltaAngle += Math.PI * 2;\r\n\tif ( deltaAngle > Math.PI * 2 ) deltaAngle -= Math.PI * 2;\r\n\r\n\tvar angle;\r\n\r\n\tif ( this.aClockwise === true ) {\r\n\r\n\t\tangle = this.aEndAngle + ( 1 - t ) * ( Math.PI * 2 - deltaAngle );\r\n\r\n\t} else {\r\n\r\n\t\tangle = this.aStartAngle + t * deltaAngle;\r\n\r\n\t}\r\n\t\r\n\tvar x = this.aX + this.xRadius * Math.cos( angle );\r\n\tvar y = this.aY + this.yRadius * Math.sin( angle );\r\n\r\n\tif ( this.aRotation !== 0 ) {\r\n\r\n\t\tvar cos = Math.cos( this.aRotation );\r\n\t\tvar sin = Math.sin( this.aRotation );\r\n\r\n\t\tvar tx = x, ty = y;\r\n\r\n\t\t// Rotate the point about the center of the ellipse.\r\n\t\tx = ( tx - this.aX ) * cos - ( ty - this.aY ) * sin + this.aX;\r\n\t\ty = ( tx - this.aX ) * sin + ( ty - this.aY ) * cos + this.aY;\r\n\r\n\t}\r\n\r\n\treturn new THREE.Vector2( x, y );\r\n\r\n};\r\n\r\n// File:src/extras/curves/ArcCurve.js\r\n\r\n/**************************************************************\r\n *\tArc curve\r\n **************************************************************/\r\n\r\nTHREE.ArcCurve = function ( aX, aY, aRadius, aStartAngle, aEndAngle, aClockwise ) {\r\n\r\n\tTHREE.EllipseCurve.call( this, aX, aY, aRadius, aRadius, aStartAngle, aEndAngle, aClockwise );\r\n\r\n};\r\n\r\nTHREE.ArcCurve.prototype = Object.create( THREE.EllipseCurve.prototype );\r\nTHREE.ArcCurve.prototype.constructor = THREE.ArcCurve;\r\n\r\n// File:src/extras/curves/LineCurve3.js\r\n\r\n/**************************************************************\r\n *\tLine3D\r\n **************************************************************/\r\n\r\nTHREE.LineCurve3 = THREE.Curve.create(\r\n\r\n\tfunction ( v1, v2 ) {\r\n\r\n\t\tthis.v1 = v1;\r\n\t\tthis.v2 = v2;\r\n\r\n\t},\r\n\r\n\tfunction ( t ) {\r\n\r\n\t\tvar vector = new THREE.Vector3();\r\n\r\n\t\tvector.subVectors( this.v2, this.v1 ); // diff\r\n\t\tvector.multiplyScalar( t );\r\n\t\tvector.add( this.v1 );\r\n\r\n\t\treturn vector;\r\n\r\n\t}\r\n\r\n);\r\n\r\n// File:src/extras/curves/QuadraticBezierCurve3.js\r\n\r\n/**************************************************************\r\n *\tQuadratic Bezier 3D curve\r\n **************************************************************/\r\n\r\nTHREE.QuadraticBezierCurve3 = THREE.Curve.create(\r\n\r\n\tfunction ( v0, v1, v2 ) {\r\n\r\n\t\tthis.v0 = v0;\r\n\t\tthis.v1 = v1;\r\n\t\tthis.v2 = v2;\r\n\r\n\t},\r\n\r\n\tfunction ( t ) {\r\n\r\n\t\tvar b2 = THREE.ShapeUtils.b2;\t\t\r\n\r\n\t\treturn new THREE.Vector3(\r\n\t\t\tb2( t, this.v0.x, this.v1.x, this.v2.x ),\r\n\t\t\tb2( t, this.v0.y, this.v1.y, this.v2.y ),\r\n\t\t\tb2( t, this.v0.z, this.v1.z, this.v2.z )\r\n\t\t);\r\n\r\n\t}\r\n\r\n);\r\n\r\n// File:src/extras/curves/CubicBezierCurve3.js\r\n\r\n/**************************************************************\r\n *\tCubic Bezier 3D curve\r\n **************************************************************/\r\n\r\nTHREE.CubicBezierCurve3 = THREE.Curve.create(\r\n\r\n\tfunction ( v0, v1, v2, v3 ) {\r\n\r\n\t\tthis.v0 = v0;\r\n\t\tthis.v1 = v1;\r\n\t\tthis.v2 = v2;\r\n\t\tthis.v3 = v3;\r\n\r\n\t},\r\n\r\n\tfunction ( t ) {\r\n\r\n\t\tvar b3 = THREE.ShapeUtils.b3;\r\n\r\n\t\treturn new THREE.Vector3(\r\n\t\t\tb3( t, this.v0.x, this.v1.x, this.v2.x, this.v3.x ),\r\n\t\t\tb3( t, this.v0.y, this.v1.y, this.v2.y, this.v3.y ),\r\n\t\t\tb3( t, this.v0.z, this.v1.z, this.v2.z, this.v3.z )\r\n\t\t);\r\n\r\n\t}\r\n\r\n);\r\n\r\n// File:src/extras/curves/SplineCurve3.js\r\n\r\n/**************************************************************\r\n *\tSpline 3D curve\r\n **************************************************************/\r\n\r\n\r\nTHREE.SplineCurve3 = THREE.Curve.create(\r\n\r\n\tfunction ( points /* array of Vector3 */ ) {\r\n\r\n\t\tconsole.warn( 'THREE.SplineCurve3 will be deprecated. Please use THREE.CatmullRomCurve3' );\r\n\t\tthis.points = ( points == undefined ) ? [] : points;\r\n\r\n\t},\r\n\r\n\tfunction ( t ) {\r\n\r\n\t\tvar points = this.points;\r\n\t\tvar point = ( points.length - 1 ) * t;\r\n\r\n\t\tvar intPoint = Math.floor( point );\r\n\t\tvar weight = point - intPoint;\r\n\r\n\t\tvar point0 = points[ intPoint == 0 ? intPoint : intPoint - 1 ];\r\n\t\tvar point1 = points[ intPoint ];\r\n\t\tvar point2 = points[ intPoint > points.length - 2 ? points.length - 1 : intPoint + 1 ];\r\n\t\tvar point3 = points[ intPoint > points.length - 3 ? points.length - 1 : intPoint + 2 ];\r\n\r\n\t\tvar interpolate = THREE.CurveUtils.interpolate;\r\n\r\n\t\treturn new THREE.Vector3(\r\n\t\t\tinterpolate( point0.x, point1.x, point2.x, point3.x, weight ),\r\n\t\t\tinterpolate( point0.y, point1.y, point2.y, point3.y, weight ),\r\n\t\t\tinterpolate( point0.z, point1.z, point2.z, point3.z, weight )\r\n\t\t);\r\n\r\n\t}\r\n\r\n);\r\n\r\n// File:src/extras/curves/CatmullRomCurve3.js\r\n\r\n/**\r\n * @author zz85 https://github.com/zz85\r\n *\r\n * Centripetal CatmullRom Curve - which is useful for avoiding\r\n * cusps and self-intersections in non-uniform catmull rom curves.\r\n * http://www.cemyuksel.com/research/catmullrom_param/catmullrom.pdf\r\n *\r\n * curve.type accepts centripetal(default), chordal and catmullrom\r\n * curve.tension is used for catmullrom which defaults to 0.5\r\n */\r\n\r\nTHREE.CatmullRomCurve3 = ( function() {\r\n\r\n\tvar\r\n\t\ttmp = new THREE.Vector3(),\r\n\t\tpx = new CubicPoly(),\r\n\t\tpy = new CubicPoly(),\r\n\t\tpz = new CubicPoly();\r\n\r\n\t/*\r\n\tBased on an optimized c++ solution in\r\n\t - http://stackoverflow.com/questions/9489736/catmull-rom-curve-with-no-cusps-and-no-self-intersections/\r\n\t - http://ideone.com/NoEbVM\r\n\r\n\tThis CubicPoly class could be used for reusing some variables and calculations,\r\n\tbut for three.js curve use, it could be possible inlined and flatten into a single function call\r\n\twhich can be placed in CurveUtils.\r\n\t*/\r\n\r\n\tfunction CubicPoly() {\r\n\r\n\t}\r\n\r\n\t/*\r\n\t * Compute coefficients for a cubic polynomial\r\n\t *   p(s) = c0 + c1*s + c2*s^2 + c3*s^3\r\n\t * such that\r\n\t *   p(0) = x0, p(1) = x1\r\n\t *  and\r\n\t *   p'(0) = t0, p'(1) = t1.\r\n\t */\r\n\tCubicPoly.prototype.init = function( x0, x1, t0, t1 ) {\r\n\r\n\t\tthis.c0 = x0;\r\n\t\tthis.c1 = t0;\r\n\t\tthis.c2 = - 3 * x0 + 3 * x1 - 2 * t0 - t1;\r\n\t\tthis.c3 = 2 * x0 - 2 * x1 + t0 + t1;\r\n\r\n\t};\r\n\r\n\tCubicPoly.prototype.initNonuniformCatmullRom = function( x0, x1, x2, x3, dt0, dt1, dt2 ) {\r\n\r\n\t\t// compute tangents when parameterized in [t1,t2]\r\n\t\tvar t1 = ( x1 - x0 ) / dt0 - ( x2 - x0 ) / ( dt0 + dt1 ) + ( x2 - x1 ) / dt1;\r\n\t\tvar t2 = ( x2 - x1 ) / dt1 - ( x3 - x1 ) / ( dt1 + dt2 ) + ( x3 - x2 ) / dt2;\r\n\r\n\t\t// rescale tangents for parametrization in [0,1]\r\n\t\tt1 *= dt1;\r\n\t\tt2 *= dt1;\r\n\r\n\t\t// initCubicPoly\r\n\t\tthis.init( x1, x2, t1, t2 );\r\n\r\n\t};\r\n\r\n\t// standard Catmull-Rom spline: interpolate between x1 and x2 with previous/following points x1/x4\r\n\tCubicPoly.prototype.initCatmullRom = function( x0, x1, x2, x3, tension ) {\r\n\r\n\t\tthis.init( x1, x2, tension * ( x2 - x0 ), tension * ( x3 - x1 ) );\r\n\r\n\t};\r\n\r\n\tCubicPoly.prototype.calc = function( t ) {\r\n\r\n\t\tvar t2 = t * t;\r\n\t\tvar t3 = t2 * t;\r\n\t\treturn this.c0 + this.c1 * t + this.c2 * t2 + this.c3 * t3;\r\n\r\n\t};\r\n\r\n\t// Subclass Three.js curve\r\n\treturn THREE.Curve.create(\r\n\r\n\t\tfunction ( p /* array of Vector3 */ ) {\r\n\r\n\t\t\tthis.points = p || [];\r\n\t\t\tthis.closed = false;\r\n\r\n\t\t},\r\n\r\n\t\tfunction ( t ) {\r\n\r\n\t\t\tvar points = this.points,\r\n\t\t\t\tpoint, intPoint, weight, l;\r\n\r\n\t\t\tl = points.length;\r\n\r\n\t\t\tif ( l < 2 ) console.log( 'duh, you need at least 2 points' );\r\n\r\n\t\t\tpoint = ( l - ( this.closed ? 0 : 1 ) ) * t;\r\n\t\t\tintPoint = Math.floor( point );\r\n\t\t\tweight = point - intPoint;\r\n\r\n\t\t\tif ( this.closed ) {\r\n\r\n\t\t\t\tintPoint += intPoint > 0 ? 0 : ( Math.floor( Math.abs( intPoint ) / points.length ) + 1 ) * points.length;\r\n\r\n\t\t\t} else if ( weight === 0 && intPoint === l - 1 ) {\r\n\r\n\t\t\t\tintPoint = l - 2;\r\n\t\t\t\tweight = 1;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar p0, p1, p2, p3; // 4 points\r\n\r\n\t\t\tif ( this.closed || intPoint > 0 ) {\r\n\r\n\t\t\t\tp0 = points[ ( intPoint - 1 ) % l ];\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\t// extrapolate first point\r\n\t\t\t\ttmp.subVectors( points[ 0 ], points[ 1 ] ).add( points[ 0 ] );\r\n\t\t\t\tp0 = tmp;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tp1 = points[ intPoint % l ];\r\n\t\t\tp2 = points[ ( intPoint + 1 ) % l ];\r\n\r\n\t\t\tif ( this.closed || intPoint + 2 < l ) {\r\n\r\n\t\t\t\tp3 = points[ ( intPoint + 2 ) % l ];\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\t// extrapolate last point\r\n\t\t\t\ttmp.subVectors( points[ l - 1 ], points[ l - 2 ] ).add( points[ l - 1 ] );\r\n\t\t\t\tp3 = tmp;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( this.type === undefined || this.type === 'centripetal' || this.type === 'chordal' ) {\r\n\r\n\t\t\t\t// init Centripetal / Chordal Catmull-Rom\r\n\t\t\t\tvar pow = this.type === 'chordal' ? 0.5 : 0.25;\r\n\t\t\t\tvar dt0 = Math.pow( p0.distanceToSquared( p1 ), pow );\r\n\t\t\t\tvar dt1 = Math.pow( p1.distanceToSquared( p2 ), pow );\r\n\t\t\t\tvar dt2 = Math.pow( p2.distanceToSquared( p3 ), pow );\r\n\r\n\t\t\t\t// safety check for repeated points\r\n\t\t\t\tif ( dt1 < 1e-4 ) dt1 = 1.0;\r\n\t\t\t\tif ( dt0 < 1e-4 ) dt0 = dt1;\r\n\t\t\t\tif ( dt2 < 1e-4 ) dt2 = dt1;\r\n\r\n\t\t\t\tpx.initNonuniformCatmullRom( p0.x, p1.x, p2.x, p3.x, dt0, dt1, dt2 );\r\n\t\t\t\tpy.initNonuniformCatmullRom( p0.y, p1.y, p2.y, p3.y, dt0, dt1, dt2 );\r\n\t\t\t\tpz.initNonuniformCatmullRom( p0.z, p1.z, p2.z, p3.z, dt0, dt1, dt2 );\r\n\r\n\t\t\t} else if ( this.type === 'catmullrom' ) {\r\n\r\n\t\t\t\tvar tension = this.tension !== undefined ? this.tension : 0.5;\r\n\t\t\t\tpx.initCatmullRom( p0.x, p1.x, p2.x, p3.x, tension );\r\n\t\t\t\tpy.initCatmullRom( p0.y, p1.y, p2.y, p3.y, tension );\r\n\t\t\t\tpz.initCatmullRom( p0.z, p1.z, p2.z, p3.z, tension );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar v = new THREE.Vector3(\r\n\t\t\t\tpx.calc( weight ),\r\n\t\t\t\tpy.calc( weight ),\r\n\t\t\t\tpz.calc( weight )\r\n\t\t\t);\r\n\r\n\t\t\treturn v;\r\n\r\n\t\t}\r\n\r\n\t);\r\n\r\n} )();\r\n\r\n// File:src/extras/curves/ClosedSplineCurve3.js\r\n\r\n/**************************************************************\r\n *\tClosed Spline 3D curve\r\n **************************************************************/\r\n\r\n\r\nTHREE.ClosedSplineCurve3 = function ( points ) {\r\n\r\n\tconsole.warn( 'THREE.ClosedSplineCurve3 has been deprecated. Please use THREE.CatmullRomCurve3.' );\r\n\r\n\tTHREE.CatmullRomCurve3.call( this, points );\r\n\tthis.type = 'catmullrom';\r\n\tthis.closed = true;\r\n\r\n};\r\n\r\nTHREE.ClosedSplineCurve3.prototype = Object.create( THREE.CatmullRomCurve3.prototype );\r\n\r\n// File:src/extras/geometries/BoxGeometry.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n * based on http://papervision3d.googlecode.com/svn/trunk/as3/trunk/src/org/papervision3d/objects/primitives/Cube.as\r\n */\r\n\r\nTHREE.BoxGeometry = function ( width, height, depth, widthSegments, heightSegments, depthSegments ) {\r\n\r\n\tTHREE.Geometry.call( this );\r\n\r\n\tthis.type = 'BoxGeometry';\r\n\r\n\tthis.parameters = {\r\n\t\twidth: width,\r\n\t\theight: height,\r\n\t\tdepth: depth,\r\n\t\twidthSegments: widthSegments,\r\n\t\theightSegments: heightSegments,\r\n\t\tdepthSegments: depthSegments\r\n\t};\r\n\r\n\tthis.fromBufferGeometry( new THREE.BoxBufferGeometry( width, height, depth, widthSegments, heightSegments, depthSegments ) );\r\n\tthis.mergeVertices();\r\n\r\n};\r\n\r\nTHREE.BoxGeometry.prototype = Object.create( THREE.Geometry.prototype );\r\nTHREE.BoxGeometry.prototype.constructor = THREE.BoxGeometry;\r\n\r\nTHREE.CubeGeometry = THREE.BoxGeometry;\r\n\r\n// File:src/extras/geometries/BoxBufferGeometry.js\r\n\r\n/**\r\n * @author Mugen87 / https://github.com/Mugen87\r\n */\r\n\r\nTHREE.BoxBufferGeometry = function ( width, height, depth, widthSegments, heightSegments, depthSegments ) {\r\n\r\n\tTHREE.BufferGeometry.call( this );\r\n\r\n\tthis.type = 'BoxBufferGeometry';\r\n\r\n\tthis.parameters = {\r\n\t\twidth: width,\r\n\t\theight: height,\r\n\t\tdepth: depth,\r\n\t\twidthSegments: widthSegments,\r\n\t\theightSegments: heightSegments,\r\n\t\tdepthSegments: depthSegments\r\n\t};\r\n\r\n\tvar scope = this;\r\n\r\n\t// segments\r\n\twidthSegments = Math.floor( widthSegments ) || 1;\r\n\theightSegments = Math.floor( heightSegments ) || 1;\r\n\tdepthSegments = Math.floor( depthSegments ) || 1;\r\n\r\n\t// these are used to calculate buffer length\r\n\tvar vertexCount = calculateVertexCount( widthSegments, heightSegments, depthSegments );\r\n\tvar indexCount = ( vertexCount / 4 ) * 6;\r\n\r\n\t// buffers\r\n\tvar indices = new ( indexCount > 65535 ? Uint32Array : Uint16Array )( indexCount );\r\n\tvar vertices = new Float32Array( vertexCount * 3 );\r\n\tvar normals = new Float32Array( vertexCount * 3 );\r\n\tvar uvs = new Float32Array( vertexCount * 2 );\r\n\r\n\t// offset variables\r\n\tvar vertexBufferOffset = 0;\r\n\tvar uvBufferOffset = 0;\r\n\tvar indexBufferOffset = 0;\r\n\tvar numberOfVertices = 0;\r\n\r\n\t// group variables\r\n\tvar groupStart = 0;\r\n\r\n\t// build each side of the box geometry\r\n\tbuildPlane( 'z', 'y', 'x', - 1, - 1, depth, height,   width,  depthSegments, heightSegments, 0 ); // px\r\n\tbuildPlane( 'z', 'y', 'x',   1, - 1, depth, height, - width,  depthSegments, heightSegments, 1 ); // nx\r\n\tbuildPlane( 'x', 'z', 'y',   1,   1, width, depth,    height, widthSegments, depthSegments,  2 ); // py\r\n\tbuildPlane( 'x', 'z', 'y',   1, - 1, width, depth,  - height, widthSegments, depthSegments,  3 ); // ny\r\n\tbuildPlane( 'x', 'y', 'z',   1, - 1, width, height,   depth,  widthSegments, heightSegments, 4 ); // pz\r\n\tbuildPlane( 'x', 'y', 'z', - 1, - 1, width, height, - depth,  widthSegments, heightSegments, 5 ); // nz\r\n\r\n\t// build geometry\r\n\tthis.setIndex( new THREE.BufferAttribute( indices, 1 ) );\r\n\tthis.addAttribute( 'position', new THREE.BufferAttribute( vertices, 3 ) );\r\n\tthis.addAttribute( 'normal', new THREE.BufferAttribute( normals, 3 ) );\r\n\tthis.addAttribute( 'uv', new THREE.BufferAttribute( uvs, 2 ) );\r\n\r\n\t// helper functions\r\n\r\n\tfunction calculateVertexCount ( w, h, d ) {\r\n\r\n\t\tvar segments = 0;\r\n\r\n\t\t// calculate the amount of segments for each side\r\n\t\tsegments += w * h * 2; // xy\r\n\t\tsegments += w * d * 2; // xz\r\n\t\tsegments += d * h * 2; // zy\r\n\r\n\t\treturn segments * 4; // four vertices per segments\r\n\r\n\t}\r\n\r\n\tfunction buildPlane ( u, v, w, udir, vdir, width, height, depth, gridX, gridY, materialIndex ) {\r\n\r\n\t\tvar segmentWidth\t= width / gridX;\r\n\t\tvar segmentHeight = height / gridY;\r\n\r\n\t\tvar widthHalf = width / 2;\r\n\t\tvar heightHalf = height / 2;\r\n\t\tvar depthHalf = depth / 2;\r\n\r\n\t\tvar gridX1 = gridX + 1;\r\n\t\tvar gridY1 = gridY + 1;\r\n\r\n\t\tvar vertexCounter = 0;\r\n\t\tvar groupCount = 0;\r\n\r\n\t\tvar vector = new THREE.Vector3();\r\n\r\n\t\t// generate vertices, normals and uvs\r\n\r\n\t\tfor ( var iy = 0; iy < gridY1; iy ++ ) {\r\n\r\n\t\t\tvar y = iy * segmentHeight - heightHalf;\r\n\r\n\t\t\tfor ( var ix = 0; ix < gridX1; ix ++ ) {\r\n\r\n\t\t\t\tvar x = ix * segmentWidth - widthHalf;\r\n\r\n\t\t\t\t// set values to correct vector component\r\n\t\t\t\tvector[ u ] = x * udir;\r\n\t\t\t\tvector[ v ] = y * vdir;\r\n\t\t\t\tvector[ w ] = depthHalf;\r\n\r\n\t\t\t\t// now apply vector to vertex buffer\r\n\t\t\t\tvertices[ vertexBufferOffset ] = vector.x;\r\n\t\t\t\tvertices[ vertexBufferOffset + 1 ] = vector.y;\r\n\t\t\t\tvertices[ vertexBufferOffset + 2 ] = vector.z;\r\n\r\n\t\t\t\t// set values to correct vector component\r\n\t\t\t\tvector[ u ] = 0;\r\n\t\t\t\tvector[ v ] = 0;\r\n\t\t\t\tvector[ w ] = depth > 0 ? 1 : - 1;\r\n\r\n\t\t\t\t// now apply vector to normal buffer\r\n\t\t\t\tnormals[ vertexBufferOffset ] = vector.x;\r\n\t\t\t\tnormals[ vertexBufferOffset + 1 ] = vector.y;\r\n\t\t\t\tnormals[ vertexBufferOffset + 2 ] = vector.z;\r\n\r\n\t\t\t\t// uvs\r\n\t\t\t\tuvs[ uvBufferOffset ] = ix / gridX;\r\n\t\t\t\tuvs[ uvBufferOffset + 1 ] = 1 - ( iy / gridY );\r\n\r\n\t\t\t\t// update offsets and counters\r\n\t\t\t\tvertexBufferOffset += 3;\r\n\t\t\t\tuvBufferOffset += 2;\r\n\t\t\t\tvertexCounter += 1;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\t// 1. you need three indices to draw a single face\r\n\t\t// 2. a single segment consists of two faces\r\n\t\t// 3. so we need to generate six (2*3) indices per segment\r\n\r\n\t\tfor ( iy = 0; iy < gridY; iy ++ ) {\r\n\r\n\t\t\tfor ( ix = 0; ix < gridX; ix ++ ) {\r\n\r\n\t\t\t\t// indices\r\n\t\t\t\tvar a = numberOfVertices + ix + gridX1 * iy;\r\n\t\t\t\tvar b = numberOfVertices + ix + gridX1 * ( iy + 1 );\r\n\t\t\t\tvar c = numberOfVertices + ( ix + 1 ) + gridX1 * ( iy + 1 );\r\n\t\t\t\tvar d = numberOfVertices + ( ix + 1 ) + gridX1 * iy;\r\n\r\n\t\t\t\t// face one\r\n\t\t\t\tindices[ indexBufferOffset ] = a;\r\n\t\t\t\tindices[ indexBufferOffset + 1 ] = b;\r\n\t\t\t\tindices[ indexBufferOffset + 2 ] = d;\r\n\r\n\t\t\t\t// face two\r\n\t\t\t\tindices[ indexBufferOffset + 3 ] = b;\r\n\t\t\t\tindices[ indexBufferOffset + 4 ] = c;\r\n\t\t\t\tindices[ indexBufferOffset + 5 ] = d;\r\n\r\n\t\t\t\t// update offsets and counters\r\n\t\t\t\tindexBufferOffset += 6;\r\n\t\t\t\tgroupCount += 6;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\t// add a group to the geometry. this will ensure multi material support\r\n\t\tscope.addGroup( groupStart, groupCount, materialIndex );\r\n\r\n\t\t// calculate new start value for groups\r\n\t\tgroupStart += groupCount;\r\n\r\n\t\t// update total number of vertices\r\n\t\tnumberOfVertices += vertexCounter;\r\n\r\n\t}\r\n\r\n};\r\n\r\nTHREE.BoxBufferGeometry.prototype = Object.create( THREE.BufferGeometry.prototype );\r\nTHREE.BoxBufferGeometry.prototype.constructor = THREE.BoxBufferGeometry;\r\n\r\n// File:src/extras/geometries/CircleGeometry.js\r\n\r\n/**\r\n * @author hughes\r\n */\r\n\r\nTHREE.CircleGeometry = function ( radius, segments, thetaStart, thetaLength ) {\r\n\r\n\tTHREE.Geometry.call( this );\r\n\r\n\tthis.type = 'CircleGeometry';\r\n\r\n\tthis.parameters = {\r\n\t\tradius: radius,\r\n\t\tsegments: segments,\r\n\t\tthetaStart: thetaStart,\r\n\t\tthetaLength: thetaLength\r\n\t};\r\n\r\n\tthis.fromBufferGeometry( new THREE.CircleBufferGeometry( radius, segments, thetaStart, thetaLength ) );\r\n\r\n};\r\n\r\nTHREE.CircleGeometry.prototype = Object.create( THREE.Geometry.prototype );\r\nTHREE.CircleGeometry.prototype.constructor = THREE.CircleGeometry;\r\n\r\n// File:src/extras/geometries/CircleBufferGeometry.js\r\n\r\n/**\r\n * @author benaadams / https://twitter.com/ben_a_adams\r\n */\r\n\r\nTHREE.CircleBufferGeometry = function ( radius, segments, thetaStart, thetaLength ) {\r\n\r\n\tTHREE.BufferGeometry.call( this );\r\n\r\n\tthis.type = 'CircleBufferGeometry';\r\n\r\n\tthis.parameters = {\r\n\t\tradius: radius,\r\n\t\tsegments: segments,\r\n\t\tthetaStart: thetaStart,\r\n\t\tthetaLength: thetaLength\r\n\t};\r\n\r\n\tradius = radius || 50;\r\n\tsegments = segments !== undefined ? Math.max( 3, segments ) : 8;\r\n\r\n\tthetaStart = thetaStart !== undefined ? thetaStart : 0;\r\n\tthetaLength = thetaLength !== undefined ? thetaLength : Math.PI * 2;\r\n\r\n\tvar vertices = segments + 2;\r\n\r\n\tvar positions = new Float32Array( vertices * 3 );\r\n\tvar normals = new Float32Array( vertices * 3 );\r\n\tvar uvs = new Float32Array( vertices * 2 );\r\n\r\n\t// center data is already zero, but need to set a few extras\r\n\tnormals[ 2 ] = 1.0;\r\n\tuvs[ 0 ] = 0.5;\r\n\tuvs[ 1 ] = 0.5;\r\n\r\n\tfor ( var s = 0, i = 3, ii = 2 ; s <= segments; s ++, i += 3, ii += 2 ) {\r\n\r\n\t\tvar segment = thetaStart + s / segments * thetaLength;\r\n\r\n\t\tpositions[ i ] = radius * Math.cos( segment );\r\n\t\tpositions[ i + 1 ] = radius * Math.sin( segment );\r\n\r\n\t\tnormals[ i + 2 ] = 1; // normal z\r\n\r\n\t\tuvs[ ii ] = ( positions[ i ] / radius + 1 ) / 2;\r\n\t\tuvs[ ii + 1 ] = ( positions[ i + 1 ] / radius + 1 ) / 2;\r\n\r\n\t}\r\n\r\n\tvar indices = [];\r\n\r\n\tfor ( var i = 1; i <= segments; i ++ ) {\r\n\r\n\t\tindices.push( i, i + 1, 0 );\r\n\r\n\t}\r\n\r\n\tthis.setIndex( new THREE.BufferAttribute( new Uint16Array( indices ), 1 ) );\r\n\tthis.addAttribute( 'position', new THREE.BufferAttribute( positions, 3 ) );\r\n\tthis.addAttribute( 'normal', new THREE.BufferAttribute( normals, 3 ) );\r\n\tthis.addAttribute( 'uv', new THREE.BufferAttribute( uvs, 2 ) );\r\n\r\n\tthis.boundingSphere = new THREE.Sphere( new THREE.Vector3(), radius );\r\n\r\n};\r\n\r\nTHREE.CircleBufferGeometry.prototype = Object.create( THREE.BufferGeometry.prototype );\r\nTHREE.CircleBufferGeometry.prototype.constructor = THREE.CircleBufferGeometry;\r\n\r\n// File:src/extras/geometries/CylinderBufferGeometry.js\r\n\r\n/**\r\n * @author Mugen87 / https://github.com/Mugen87\r\n */\r\n\r\nTHREE.CylinderBufferGeometry = function( radiusTop, radiusBottom, height, radialSegments, heightSegments, openEnded, thetaStart, thetaLength ) {\r\n\r\n\tTHREE.BufferGeometry.call( this );\r\n\r\n\tthis.type = 'CylinderBufferGeometry';\r\n\r\n\tthis.parameters = {\r\n\t\tradiusTop: radiusTop,\r\n\t\tradiusBottom: radiusBottom,\r\n\t\theight: height,\r\n\t\tradialSegments: radialSegments,\r\n\t\theightSegments: heightSegments,\r\n\t\topenEnded: openEnded,\r\n\t\tthetaStart: thetaStart,\r\n\t\tthetaLength: thetaLength\r\n\t};\r\n\r\n\tvar scope = this;\r\n\r\n\tradiusTop = radiusTop !== undefined ? radiusTop : 20;\r\n\tradiusBottom = radiusBottom !== undefined ? radiusBottom : 20;\r\n\theight = height !== undefined ? height : 100;\r\n\r\n\tradialSegments = Math.floor( radialSegments ) || 8;\r\n\theightSegments = Math.floor( heightSegments ) || 1;\r\n\r\n\topenEnded = openEnded !== undefined ? openEnded : false;\r\n\tthetaStart = thetaStart !== undefined ? thetaStart : 0;\r\n\tthetaLength = thetaLength !== undefined ? thetaLength : 2 * Math.PI;\r\n\r\n\t// used to calculate buffer length\r\n\r\n\tvar vertexCount = calculateVertexCount();\r\n\tvar indexCount = calculateIndexCount();\r\n\r\n\t// buffers\r\n\r\n\tvar indices = new THREE.BufferAttribute( new ( indexCount > 65535 ? Uint32Array : Uint16Array )( indexCount ), 1 );\r\n\tvar vertices = new THREE.BufferAttribute( new Float32Array( vertexCount * 3 ), 3 );\r\n\tvar normals = new THREE.BufferAttribute( new Float32Array( vertexCount * 3 ), 3 );\r\n\tvar uvs = new THREE.BufferAttribute( new Float32Array( vertexCount * 2 ), 2 );\r\n\r\n\t// helper variables\r\n\r\n\tvar index = 0, indexOffset = 0, indexArray = [], halfHeight = height / 2;\r\n\r\n\t// group variables\r\n\tvar groupStart = 0;\r\n\r\n\t// generate geometry\r\n\r\n\tgenerateTorso();\r\n\r\n\tif ( openEnded === false ) {\r\n\r\n\t\tif ( radiusTop > 0 ) generateCap( true );\r\n\t\tif ( radiusBottom > 0 ) generateCap( false );\r\n\r\n\t}\r\n\r\n\t// build geometry\r\n\r\n\tthis.setIndex( indices );\r\n\tthis.addAttribute( 'position', vertices );\r\n\tthis.addAttribute( 'normal', normals );\r\n\tthis.addAttribute( 'uv', uvs );\r\n\r\n\t// helper functions\r\n\r\n\tfunction calculateVertexCount() {\r\n\r\n\t\tvar count = ( radialSegments + 1 ) * ( heightSegments + 1 );\r\n\r\n\t\tif ( openEnded === false ) {\r\n\r\n\t\t\tcount += ( ( radialSegments + 1 ) * 2 ) + ( radialSegments * 2 );\r\n\r\n\t\t}\r\n\r\n\t\treturn count;\r\n\r\n\t}\r\n\r\n\tfunction calculateIndexCount() {\r\n\r\n\t\tvar count = radialSegments * heightSegments * 2 * 3;\r\n\r\n\t\tif ( openEnded === false ) {\r\n\r\n\t\t\tcount += radialSegments * 2 * 3;\r\n\r\n\t\t}\r\n\r\n\t\treturn count;\r\n\r\n\t}\r\n\r\n\tfunction generateTorso() {\r\n\r\n\t\tvar x, y;\r\n\t\tvar normal = new THREE.Vector3();\r\n\t\tvar vertex = new THREE.Vector3();\r\n\r\n\t\tvar groupCount = 0;\r\n\r\n\t\t// this will be used to calculate the normal\r\n\t\tvar tanTheta = ( radiusBottom - radiusTop ) / height;\r\n\r\n\t\t// generate vertices, normals and uvs\r\n\r\n\t\tfor ( y = 0; y <= heightSegments; y ++ ) {\r\n\r\n\t\t\tvar indexRow = [];\r\n\r\n\t\t\tvar v = y / heightSegments;\r\n\r\n\t\t\t// calculate the radius of the current row\r\n\t\t\tvar radius = v * ( radiusBottom - radiusTop ) + radiusTop;\r\n\r\n\t\t\tfor ( x = 0; x <= radialSegments; x ++ ) {\r\n\r\n\t\t\t\tvar u = x / radialSegments;\r\n\r\n\t\t\t\t// vertex\r\n\t\t\t\tvertex.x = radius * Math.sin( u * thetaLength + thetaStart );\r\n\t\t\t\tvertex.y = - v * height + halfHeight;\r\n\t\t\t\tvertex.z = radius * Math.cos( u * thetaLength + thetaStart );\r\n\t\t\t\tvertices.setXYZ( index, vertex.x, vertex.y, vertex.z );\r\n\r\n\t\t\t\t// normal\r\n\t\t\t\tnormal.copy( vertex );\r\n\r\n\t\t\t\t// handle special case if radiusTop/radiusBottom is zero\r\n\t\t\t\tif ( ( radiusTop === 0 && y === 0 ) || ( radiusBottom === 0 && y === heightSegments ) ) {\r\n\r\n\t\t\t\t\tnormal.x = Math.sin( u * thetaLength + thetaStart );\r\n\t\t\t\t\tnormal.z = Math.cos( u * thetaLength + thetaStart );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tnormal.setY( Math.sqrt( normal.x * normal.x + normal.z * normal.z ) * tanTheta ).normalize();\r\n\t\t\t\tnormals.setXYZ( index, normal.x, normal.y, normal.z );\r\n\r\n\t\t\t\t// uv\r\n\t\t\t\tuvs.setXY( index, u, 1 - v );\r\n\r\n\t\t\t\t// save index of vertex in respective row\r\n\t\t\t\tindexRow.push( index );\r\n\r\n\t\t\t\t// increase index\r\n\t\t\t\tindex ++;\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// now save vertices of the row in our index array\r\n\t\t\tindexArray.push( indexRow );\r\n\r\n\t\t}\r\n\r\n\t\t// generate indices\r\n\r\n\t\tfor ( x = 0; x < radialSegments; x ++ ) {\r\n\r\n\t\t\tfor ( y = 0; y < heightSegments; y ++ ) {\r\n\r\n\t\t\t\t// we use the index array to access the correct indices\r\n\t\t\t\tvar i1 = indexArray[ y ][ x ];\r\n\t\t\t\tvar i2 = indexArray[ y + 1 ][ x ];\r\n\t\t\t\tvar i3 = indexArray[ y + 1 ][ x + 1 ];\r\n\t\t\t\tvar i4 = indexArray[ y ][ x + 1 ];\r\n\r\n\t\t\t\t// face one\r\n\t\t\t\tindices.setX( indexOffset, i1 ); indexOffset ++;\r\n\t\t\t\tindices.setX( indexOffset, i2 ); indexOffset ++;\r\n\t\t\t\tindices.setX( indexOffset, i4 ); indexOffset ++;\r\n\r\n\t\t\t\t// face two\r\n\t\t\t\tindices.setX( indexOffset, i2 ); indexOffset ++;\r\n\t\t\t\tindices.setX( indexOffset, i3 ); indexOffset ++;\r\n\t\t\t\tindices.setX( indexOffset, i4 ); indexOffset ++;\r\n\r\n\t\t\t\t// update counters\r\n\t\t\t\tgroupCount += 6;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\t// add a group to the geometry. this will ensure multi material support\r\n\t\tscope.addGroup( groupStart, groupCount, 0 );\r\n\r\n\t\t// calculate new start value for groups\r\n\t\tgroupStart += groupCount;\r\n\r\n\t}\r\n\r\n\tfunction generateCap( top ) {\r\n\r\n\t\tvar x, centerIndexStart, centerIndexEnd;\r\n\t\tvar uv = new THREE.Vector2();\r\n\t\tvar vertex = new THREE.Vector3();\r\n\r\n\t\tvar groupCount = 0;\r\n\r\n\t\tvar radius = ( top === true ) ? radiusTop : radiusBottom;\r\n\t\tvar sign = ( top === true ) ? 1 : - 1;\r\n\r\n\t\t// save the index of the first center vertex\r\n\t\tcenterIndexStart = index;\r\n\r\n\t\t// first we generate the center vertex data of the cap.\r\n\t\t// because the geometry needs one set of uvs per face,\r\n\t\t// we must generate a center vertex per face/segment\r\n\r\n\t\tfor ( x = 1; x <= radialSegments; x ++ ) {\r\n\r\n\t\t\t// vertex\r\n\t\t\tvertices.setXYZ( index, 0, halfHeight * sign, 0 );\r\n\r\n\t\t\t// normal\r\n\t\t\tnormals.setXYZ( index, 0, sign, 0 );\r\n\r\n\t\t\t// uv\r\n\t\t\tif ( top === true ) {\r\n\r\n\t\t\t\tuv.x = x / radialSegments;\r\n\t\t\t\tuv.y = 0;\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tuv.x = ( x - 1 ) / radialSegments;\r\n\t\t\t\tuv.y = 1;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tuvs.setXY( index, uv.x, uv.y );\r\n\r\n\t\t\t// increase index\r\n\t\t\tindex ++;\r\n\r\n\t\t}\r\n\r\n\t\t// save the index of the last center vertex\r\n\t\tcenterIndexEnd = index;\r\n\r\n\t\t// now we generate the surrounding vertices, normals and uvs\r\n\r\n\t\tfor ( x = 0; x <= radialSegments; x ++ ) {\r\n\r\n\t\t\tvar u = x / radialSegments;\r\n\r\n\t\t\t// vertex\r\n\t\t\tvertex.x = radius * Math.sin( u * thetaLength + thetaStart );\r\n\t\t\tvertex.y = halfHeight * sign;\r\n\t\t\tvertex.z = radius * Math.cos( u * thetaLength + thetaStart );\r\n\t\t\tvertices.setXYZ( index, vertex.x, vertex.y, vertex.z );\r\n\r\n\t\t\t// normal\r\n\t\t\tnormals.setXYZ( index, 0, sign, 0 );\r\n\r\n\t\t\t// uv\r\n\t\t\tuvs.setXY( index, u, ( top === true ) ? 1 : 0 );\r\n\r\n\t\t\t// increase index\r\n\t\t\tindex ++;\r\n\r\n\t\t}\r\n\r\n\t\t// generate indices\r\n\r\n\t\tfor ( x = 0; x < radialSegments; x ++ ) {\r\n\r\n\t\t\tvar c = centerIndexStart + x;\r\n\t\t\tvar i = centerIndexEnd + x;\r\n\r\n\t\t\tif ( top === true ) {\r\n\r\n\t\t\t\t// face top\r\n\t\t\t\tindices.setX( indexOffset, i ); indexOffset ++;\r\n\t\t\t\tindices.setX( indexOffset, i + 1 ); indexOffset ++;\r\n\t\t\t\tindices.setX( indexOffset, c ); indexOffset ++;\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\t// face bottom\r\n\t\t\t\tindices.setX( indexOffset, i + 1 ); indexOffset ++;\r\n\t\t\t\tindices.setX( indexOffset, i ); indexOffset ++;\r\n\t\t\t\tindices.setX( indexOffset, c ); indexOffset ++;\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// update counters\r\n\t\t\tgroupCount += 3;\r\n\r\n\t\t}\r\n\r\n\t\t// add a group to the geometry. this will ensure multi material support\r\n\t\tscope.addGroup( groupStart, groupCount, top === true ? 1 : 2 );\r\n\r\n\t\t// calculate new start value for groups\r\n\t\tgroupStart += groupCount;\r\n\r\n\t}\r\n\r\n};\r\n\r\nTHREE.CylinderBufferGeometry.prototype = Object.create( THREE.BufferGeometry.prototype );\r\nTHREE.CylinderBufferGeometry.prototype.constructor = THREE.CylinderBufferGeometry;\r\n\r\n// File:src/extras/geometries/CylinderGeometry.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.CylinderGeometry = function ( radiusTop, radiusBottom, height, radialSegments, heightSegments, openEnded, thetaStart, thetaLength ) {\r\n\r\n\tTHREE.Geometry.call( this );\r\n\r\n\tthis.type = 'CylinderGeometry';\r\n\r\n\tthis.parameters = {\r\n\t\tradiusTop: radiusTop,\r\n\t\tradiusBottom: radiusBottom,\r\n\t\theight: height,\r\n\t\tradialSegments: radialSegments,\r\n\t\theightSegments: heightSegments,\r\n\t\topenEnded: openEnded,\r\n\t\tthetaStart: thetaStart,\r\n\t\tthetaLength: thetaLength\r\n\t};\r\n\r\n\tthis.fromBufferGeometry( new THREE.CylinderBufferGeometry( radiusTop, radiusBottom, height, radialSegments, heightSegments, openEnded, thetaStart, thetaLength ) );\r\n\tthis.mergeVertices();\r\n\r\n};\r\n\r\nTHREE.CylinderGeometry.prototype = Object.create( THREE.Geometry.prototype );\r\nTHREE.CylinderGeometry.prototype.constructor = THREE.CylinderGeometry;\r\n\r\n// File:src/extras/geometries/EdgesGeometry.js\r\n\r\n/**\r\n * @author WestLangley / http://github.com/WestLangley\r\n */\r\n\r\nTHREE.EdgesGeometry = function ( geometry, thresholdAngle ) {\r\n\r\n\tTHREE.BufferGeometry.call( this );\r\n\r\n\tthresholdAngle = ( thresholdAngle !== undefined ) ? thresholdAngle : 1;\r\n\r\n\tvar thresholdDot = Math.cos( THREE.Math.DEG2RAD * thresholdAngle );\r\n\r\n\tvar edge = [ 0, 0 ], hash = {};\r\n\r\n\tfunction sortFunction( a, b ) {\r\n\r\n\t\treturn a - b;\r\n\r\n\t}\r\n\r\n\tvar keys = [ 'a', 'b', 'c' ];\r\n\r\n\tvar geometry2;\r\n\r\n\tif ( geometry instanceof THREE.BufferGeometry ) {\r\n\r\n\t\tgeometry2 = new THREE.Geometry();\r\n\t\tgeometry2.fromBufferGeometry( geometry );\r\n\r\n\t} else {\r\n\r\n\t\tgeometry2 = geometry.clone();\r\n\r\n\t}\r\n\r\n\tgeometry2.mergeVertices();\r\n\tgeometry2.computeFaceNormals();\r\n\r\n\tvar vertices = geometry2.vertices;\r\n\tvar faces = geometry2.faces;\r\n\r\n\tfor ( var i = 0, l = faces.length; i < l; i ++ ) {\r\n\r\n\t\tvar face = faces[ i ];\r\n\r\n\t\tfor ( var j = 0; j < 3; j ++ ) {\r\n\r\n\t\t\tedge[ 0 ] = face[ keys[ j ] ];\r\n\t\t\tedge[ 1 ] = face[ keys[ ( j + 1 ) % 3 ] ];\r\n\t\t\tedge.sort( sortFunction );\r\n\r\n\t\t\tvar key = edge.toString();\r\n\r\n\t\t\tif ( hash[ key ] === undefined ) {\r\n\r\n\t\t\t\thash[ key ] = { vert1: edge[ 0 ], vert2: edge[ 1 ], face1: i, face2: undefined };\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\thash[ key ].face2 = i;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tvar coords = [];\r\n\r\n\tfor ( var key in hash ) {\r\n\r\n\t\tvar h = hash[ key ];\r\n\r\n\t\tif ( h.face2 === undefined || faces[ h.face1 ].normal.dot( faces[ h.face2 ].normal ) <= thresholdDot ) {\r\n\r\n\t\t\tvar vertex = vertices[ h.vert1 ];\r\n\t\t\tcoords.push( vertex.x );\r\n\t\t\tcoords.push( vertex.y );\r\n\t\t\tcoords.push( vertex.z );\r\n\r\n\t\t\tvertex = vertices[ h.vert2 ];\r\n\t\t\tcoords.push( vertex.x );\r\n\t\t\tcoords.push( vertex.y );\r\n\t\t\tcoords.push( vertex.z );\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tthis.addAttribute( 'position', new THREE.BufferAttribute( new Float32Array( coords ), 3 ) );\r\n\r\n};\r\n\r\nTHREE.EdgesGeometry.prototype = Object.create( THREE.BufferGeometry.prototype );\r\nTHREE.EdgesGeometry.prototype.constructor = THREE.EdgesGeometry;\r\n\r\n// File:src/extras/geometries/ExtrudeGeometry.js\r\n\r\n/**\r\n * @author zz85 / http://www.lab4games.net/zz85/blog\r\n *\r\n * Creates extruded geometry from a path shape.\r\n *\r\n * parameters = {\r\n *\r\n *  curveSegments: <int>, // number of points on the curves\r\n *  steps: <int>, // number of points for z-side extrusions / used for subdividing segments of extrude spline too\r\n *  amount: <int>, // Depth to extrude the shape\r\n *\r\n *  bevelEnabled: <bool>, // turn on bevel\r\n *  bevelThickness: <float>, // how deep into the original shape bevel goes\r\n *  bevelSize: <float>, // how far from shape outline is bevel\r\n *  bevelSegments: <int>, // number of bevel layers\r\n *\r\n *  extrudePath: <THREE.CurvePath> // 3d spline path to extrude shape along. (creates Frames if .frames aren't defined)\r\n *  frames: <THREE.TubeGeometry.FrenetFrames> // containing arrays of tangents, normals, binormals\r\n *\r\n *  uvGenerator: <Object> // object that provides UV generator functions\r\n *\r\n * }\r\n **/\r\n\r\nTHREE.ExtrudeGeometry = function ( shapes, options ) {\r\n\r\n\tif ( typeof( shapes ) === \"undefined\" ) {\r\n\r\n\t\tshapes = [];\r\n\t\treturn;\r\n\r\n\t}\r\n\r\n\tTHREE.Geometry.call( this );\r\n\r\n\tthis.type = 'ExtrudeGeometry';\r\n\r\n\tshapes = Array.isArray( shapes ) ? shapes : [ shapes ];\r\n\r\n\tthis.addShapeList( shapes, options );\r\n\r\n\tthis.computeFaceNormals();\r\n\r\n\t// can't really use automatic vertex normals\r\n\t// as then front and back sides get smoothed too\r\n\t// should do separate smoothing just for sides\r\n\r\n\t//this.computeVertexNormals();\r\n\r\n\t//console.log( \"took\", ( Date.now() - startTime ) );\r\n\r\n};\r\n\r\nTHREE.ExtrudeGeometry.prototype = Object.create( THREE.Geometry.prototype );\r\nTHREE.ExtrudeGeometry.prototype.constructor = THREE.ExtrudeGeometry;\r\n\r\nTHREE.ExtrudeGeometry.prototype.addShapeList = function ( shapes, options ) {\r\n\r\n\tvar sl = shapes.length;\r\n\r\n\tfor ( var s = 0; s < sl; s ++ ) {\r\n\r\n\t\tvar shape = shapes[ s ];\r\n\t\tthis.addShape( shape, options );\r\n\r\n\t}\r\n\r\n};\r\n\r\nTHREE.ExtrudeGeometry.prototype.addShape = function ( shape, options ) {\r\n\r\n\tvar amount = options.amount !== undefined ? options.amount : 100;\r\n\r\n\tvar bevelThickness = options.bevelThickness !== undefined ? options.bevelThickness : 6; // 10\r\n\tvar bevelSize = options.bevelSize !== undefined ? options.bevelSize : bevelThickness - 2; // 8\r\n\tvar bevelSegments = options.bevelSegments !== undefined ? options.bevelSegments : 3;\r\n\r\n\tvar bevelEnabled = options.bevelEnabled !== undefined ? options.bevelEnabled : true; // false\r\n\r\n\tvar curveSegments = options.curveSegments !== undefined ? options.curveSegments : 12;\r\n\r\n\tvar steps = options.steps !== undefined ? options.steps : 1;\r\n\r\n\tvar extrudePath = options.extrudePath;\r\n\tvar extrudePts, extrudeByPath = false;\r\n\r\n\t// Use default WorldUVGenerator if no UV generators are specified.\r\n\tvar uvgen = options.UVGenerator !== undefined ? options.UVGenerator : THREE.ExtrudeGeometry.WorldUVGenerator;\r\n\r\n\tvar splineTube, binormal, normal, position2;\r\n\tif ( extrudePath ) {\r\n\r\n\t\textrudePts = extrudePath.getSpacedPoints( steps );\r\n\r\n\t\textrudeByPath = true;\r\n\t\tbevelEnabled = false; // bevels not supported for path extrusion\r\n\r\n\t\t// SETUP TNB variables\r\n\r\n\t\t// Reuse TNB from TubeGeomtry for now.\r\n\t\t// TODO1 - have a .isClosed in spline?\r\n\r\n\t\tsplineTube = options.frames !== undefined ? options.frames : new THREE.TubeGeometry.FrenetFrames( extrudePath, steps, false );\r\n\r\n\t\t// console.log(splineTube, 'splineTube', splineTube.normals.length, 'steps', steps, 'extrudePts', extrudePts.length);\r\n\r\n\t\tbinormal = new THREE.Vector3();\r\n\t\tnormal = new THREE.Vector3();\r\n\t\tposition2 = new THREE.Vector3();\r\n\r\n\t}\r\n\r\n\t// Safeguards if bevels are not enabled\r\n\r\n\tif ( ! bevelEnabled ) {\r\n\r\n\t\tbevelSegments = 0;\r\n\t\tbevelThickness = 0;\r\n\t\tbevelSize = 0;\r\n\r\n\t}\r\n\r\n\t// Variables initialization\r\n\r\n\tvar ahole, h, hl; // looping of holes\r\n\tvar scope = this;\r\n\r\n\tvar shapesOffset = this.vertices.length;\r\n\r\n\tvar shapePoints = shape.extractPoints( curveSegments );\r\n\r\n\tvar vertices = shapePoints.shape;\r\n\tvar holes = shapePoints.holes;\r\n\r\n\tvar reverse = ! THREE.ShapeUtils.isClockWise( vertices );\r\n\r\n\tif ( reverse ) {\r\n\r\n\t\tvertices = vertices.reverse();\r\n\r\n\t\t// Maybe we should also check if holes are in the opposite direction, just to be safe ...\r\n\r\n\t\tfor ( h = 0, hl = holes.length; h < hl; h ++ ) {\r\n\r\n\t\t\tahole = holes[ h ];\r\n\r\n\t\t\tif ( THREE.ShapeUtils.isClockWise( ahole ) ) {\r\n\r\n\t\t\t\tholes[ h ] = ahole.reverse();\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\treverse = false; // If vertices are in order now, we shouldn't need to worry about them again (hopefully)!\r\n\r\n\t}\r\n\r\n\r\n\tvar faces = THREE.ShapeUtils.triangulateShape( vertices, holes );\r\n\r\n\t/* Vertices */\r\n\r\n\tvar contour = vertices; // vertices has all points but contour has only points of circumference\r\n\r\n\tfor ( h = 0, hl = holes.length; h < hl; h ++ ) {\r\n\r\n\t\tahole = holes[ h ];\r\n\r\n\t\tvertices = vertices.concat( ahole );\r\n\r\n\t}\r\n\r\n\r\n\tfunction scalePt2 ( pt, vec, size ) {\r\n\r\n\t\tif ( ! vec ) console.error( \"THREE.ExtrudeGeometry: vec does not exist\" );\r\n\r\n\t\treturn vec.clone().multiplyScalar( size ).add( pt );\r\n\r\n\t}\r\n\r\n\tvar b, bs, t, z,\r\n\t\tvert, vlen = vertices.length,\r\n\t\tface, flen = faces.length;\r\n\r\n\r\n\t// Find directions for point movement\r\n\r\n\r\n\tfunction getBevelVec( inPt, inPrev, inNext ) {\r\n\r\n\t\t// computes for inPt the corresponding point inPt' on a new contour\r\n\t\t//   shifted by 1 unit (length of normalized vector) to the left\r\n\t\t// if we walk along contour clockwise, this new contour is outside the old one\r\n\t\t//\r\n\t\t// inPt' is the intersection of the two lines parallel to the two\r\n\t\t//  adjacent edges of inPt at a distance of 1 unit on the left side.\r\n\r\n\t\tvar v_trans_x, v_trans_y, shrink_by = 1;\t\t// resulting translation vector for inPt\r\n\r\n\t\t// good reading for geometry algorithms (here: line-line intersection)\r\n\t\t// http://geomalgorithms.com/a05-_intersect-1.html\r\n\r\n\t\tvar v_prev_x = inPt.x - inPrev.x, v_prev_y = inPt.y - inPrev.y;\r\n\t\tvar v_next_x = inNext.x - inPt.x, v_next_y = inNext.y - inPt.y;\r\n\r\n\t\tvar v_prev_lensq = ( v_prev_x * v_prev_x + v_prev_y * v_prev_y );\r\n\r\n\t\t// check for collinear edges\r\n\t\tvar collinear0 = ( v_prev_x * v_next_y - v_prev_y * v_next_x );\r\n\r\n\t\tif ( Math.abs( collinear0 ) > Number.EPSILON ) {\r\n\r\n\t\t\t// not collinear\r\n\r\n\t\t\t// length of vectors for normalizing\r\n\r\n\t\t\tvar v_prev_len = Math.sqrt( v_prev_lensq );\r\n\t\t\tvar v_next_len = Math.sqrt( v_next_x * v_next_x + v_next_y * v_next_y );\r\n\r\n\t\t\t// shift adjacent points by unit vectors to the left\r\n\r\n\t\t\tvar ptPrevShift_x = ( inPrev.x - v_prev_y / v_prev_len );\r\n\t\t\tvar ptPrevShift_y = ( inPrev.y + v_prev_x / v_prev_len );\r\n\r\n\t\t\tvar ptNextShift_x = ( inNext.x - v_next_y / v_next_len );\r\n\t\t\tvar ptNextShift_y = ( inNext.y + v_next_x / v_next_len );\r\n\r\n\t\t\t// scaling factor for v_prev to intersection point\r\n\r\n\t\t\tvar sf = (  ( ptNextShift_x - ptPrevShift_x ) * v_next_y -\r\n\t\t\t\t\t\t( ptNextShift_y - ptPrevShift_y ) * v_next_x    ) /\r\n\t\t\t\t\t  ( v_prev_x * v_next_y - v_prev_y * v_next_x );\r\n\r\n\t\t\t// vector from inPt to intersection point\r\n\r\n\t\t\tv_trans_x = ( ptPrevShift_x + v_prev_x * sf - inPt.x );\r\n\t\t\tv_trans_y = ( ptPrevShift_y + v_prev_y * sf - inPt.y );\r\n\r\n\t\t\t// Don't normalize!, otherwise sharp corners become ugly\r\n\t\t\t//  but prevent crazy spikes\r\n\t\t\tvar v_trans_lensq = ( v_trans_x * v_trans_x + v_trans_y * v_trans_y );\r\n\t\t\tif ( v_trans_lensq <= 2 ) {\r\n\r\n\t\t\t\treturn\tnew THREE.Vector2( v_trans_x, v_trans_y );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tshrink_by = Math.sqrt( v_trans_lensq / 2 );\r\n\r\n\t\t\t}\r\n\r\n\t\t} else {\r\n\r\n\t\t\t// handle special case of collinear edges\r\n\r\n\t\t\tvar direction_eq = false;\t\t// assumes: opposite\r\n\t\t\tif ( v_prev_x > Number.EPSILON ) {\r\n\r\n\t\t\t\tif ( v_next_x > Number.EPSILON ) {\r\n\r\n\t\t\t\t\tdirection_eq = true;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tif ( v_prev_x < - Number.EPSILON ) {\r\n\r\n\t\t\t\t\tif ( v_next_x < - Number.EPSILON ) {\r\n\r\n\t\t\t\t\t\tdirection_eq = true;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tif ( Math.sign( v_prev_y ) === Math.sign( v_next_y ) ) {\r\n\r\n\t\t\t\t\t\tdirection_eq = true;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( direction_eq ) {\r\n\r\n\t\t\t\t// console.log(\"Warning: lines are a straight sequence\");\r\n\t\t\t\tv_trans_x = - v_prev_y;\r\n\t\t\t\tv_trans_y =  v_prev_x;\r\n\t\t\t\tshrink_by = Math.sqrt( v_prev_lensq );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\t// console.log(\"Warning: lines are a straight spike\");\r\n\t\t\t\tv_trans_x = v_prev_x;\r\n\t\t\t\tv_trans_y = v_prev_y;\r\n\t\t\t\tshrink_by = Math.sqrt( v_prev_lensq / 2 );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\treturn\tnew THREE.Vector2( v_trans_x / shrink_by, v_trans_y / shrink_by );\r\n\r\n\t}\r\n\r\n\r\n\tvar contourMovements = [];\r\n\r\n\tfor ( var i = 0, il = contour.length, j = il - 1, k = i + 1; i < il; i ++, j ++, k ++ ) {\r\n\r\n\t\tif ( j === il ) j = 0;\r\n\t\tif ( k === il ) k = 0;\r\n\r\n\t\t//  (j)---(i)---(k)\r\n\t\t// console.log('i,j,k', i, j , k)\r\n\r\n\t\tcontourMovements[ i ] = getBevelVec( contour[ i ], contour[ j ], contour[ k ] );\r\n\r\n\t}\r\n\r\n\tvar holesMovements = [], oneHoleMovements, verticesMovements = contourMovements.concat();\r\n\r\n\tfor ( h = 0, hl = holes.length; h < hl; h ++ ) {\r\n\r\n\t\tahole = holes[ h ];\r\n\r\n\t\toneHoleMovements = [];\r\n\r\n\t\tfor ( i = 0, il = ahole.length, j = il - 1, k = i + 1; i < il; i ++, j ++, k ++ ) {\r\n\r\n\t\t\tif ( j === il ) j = 0;\r\n\t\t\tif ( k === il ) k = 0;\r\n\r\n\t\t\t//  (j)---(i)---(k)\r\n\t\t\toneHoleMovements[ i ] = getBevelVec( ahole[ i ], ahole[ j ], ahole[ k ] );\r\n\r\n\t\t}\r\n\r\n\t\tholesMovements.push( oneHoleMovements );\r\n\t\tverticesMovements = verticesMovements.concat( oneHoleMovements );\r\n\r\n\t}\r\n\r\n\r\n\t// Loop bevelSegments, 1 for the front, 1 for the back\r\n\r\n\tfor ( b = 0; b < bevelSegments; b ++ ) {\r\n\r\n\t\t//for ( b = bevelSegments; b > 0; b -- ) {\r\n\r\n\t\tt = b / bevelSegments;\r\n\t\tz = bevelThickness * ( 1 - t );\r\n\r\n\t\t//z = bevelThickness * t;\r\n\t\tbs = bevelSize * ( Math.sin ( t * Math.PI / 2 ) ); // curved\r\n\t\t//bs = bevelSize * t; // linear\r\n\r\n\t\t// contract shape\r\n\r\n\t\tfor ( i = 0, il = contour.length; i < il; i ++ ) {\r\n\r\n\t\t\tvert = scalePt2( contour[ i ], contourMovements[ i ], bs );\r\n\r\n\t\t\tv( vert.x, vert.y,  - z );\r\n\r\n\t\t}\r\n\r\n\t\t// expand holes\r\n\r\n\t\tfor ( h = 0, hl = holes.length; h < hl; h ++ ) {\r\n\r\n\t\t\tahole = holes[ h ];\r\n\t\t\toneHoleMovements = holesMovements[ h ];\r\n\r\n\t\t\tfor ( i = 0, il = ahole.length; i < il; i ++ ) {\r\n\r\n\t\t\t\tvert = scalePt2( ahole[ i ], oneHoleMovements[ i ], bs );\r\n\r\n\t\t\t\tv( vert.x, vert.y,  - z );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tbs = bevelSize;\r\n\r\n\t// Back facing vertices\r\n\r\n\tfor ( i = 0; i < vlen; i ++ ) {\r\n\r\n\t\tvert = bevelEnabled ? scalePt2( vertices[ i ], verticesMovements[ i ], bs ) : vertices[ i ];\r\n\r\n\t\tif ( ! extrudeByPath ) {\r\n\r\n\t\t\tv( vert.x, vert.y, 0 );\r\n\r\n\t\t} else {\r\n\r\n\t\t\t// v( vert.x, vert.y + extrudePts[ 0 ].y, extrudePts[ 0 ].x );\r\n\r\n\t\t\tnormal.copy( splineTube.normals[ 0 ] ).multiplyScalar( vert.x );\r\n\t\t\tbinormal.copy( splineTube.binormals[ 0 ] ).multiplyScalar( vert.y );\r\n\r\n\t\t\tposition2.copy( extrudePts[ 0 ] ).add( normal ).add( binormal );\r\n\r\n\t\t\tv( position2.x, position2.y, position2.z );\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t// Add stepped vertices...\r\n\t// Including front facing vertices\r\n\r\n\tvar s;\r\n\r\n\tfor ( s = 1; s <= steps; s ++ ) {\r\n\r\n\t\tfor ( i = 0; i < vlen; i ++ ) {\r\n\r\n\t\t\tvert = bevelEnabled ? scalePt2( vertices[ i ], verticesMovements[ i ], bs ) : vertices[ i ];\r\n\r\n\t\t\tif ( ! extrudeByPath ) {\r\n\r\n\t\t\t\tv( vert.x, vert.y, amount / steps * s );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\t// v( vert.x, vert.y + extrudePts[ s - 1 ].y, extrudePts[ s - 1 ].x );\r\n\r\n\t\t\t\tnormal.copy( splineTube.normals[ s ] ).multiplyScalar( vert.x );\r\n\t\t\t\tbinormal.copy( splineTube.binormals[ s ] ).multiplyScalar( vert.y );\r\n\r\n\t\t\t\tposition2.copy( extrudePts[ s ] ).add( normal ).add( binormal );\r\n\r\n\t\t\t\tv( position2.x, position2.y, position2.z );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\r\n\t// Add bevel segments planes\r\n\r\n\t//for ( b = 1; b <= bevelSegments; b ++ ) {\r\n\tfor ( b = bevelSegments - 1; b >= 0; b -- ) {\r\n\r\n\t\tt = b / bevelSegments;\r\n\t\tz = bevelThickness * ( 1 - t );\r\n\t\t//bs = bevelSize * ( 1-Math.sin ( ( 1 - t ) * Math.PI/2 ) );\r\n\t\tbs = bevelSize * Math.sin ( t * Math.PI / 2 );\r\n\r\n\t\t// contract shape\r\n\r\n\t\tfor ( i = 0, il = contour.length; i < il; i ++ ) {\r\n\r\n\t\t\tvert = scalePt2( contour[ i ], contourMovements[ i ], bs );\r\n\t\t\tv( vert.x, vert.y,  amount + z );\r\n\r\n\t\t}\r\n\r\n\t\t// expand holes\r\n\r\n\t\tfor ( h = 0, hl = holes.length; h < hl; h ++ ) {\r\n\r\n\t\t\tahole = holes[ h ];\r\n\t\t\toneHoleMovements = holesMovements[ h ];\r\n\r\n\t\t\tfor ( i = 0, il = ahole.length; i < il; i ++ ) {\r\n\r\n\t\t\t\tvert = scalePt2( ahole[ i ], oneHoleMovements[ i ], bs );\r\n\r\n\t\t\t\tif ( ! extrudeByPath ) {\r\n\r\n\t\t\t\t\tv( vert.x, vert.y,  amount + z );\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tv( vert.x, vert.y + extrudePts[ steps - 1 ].y, extrudePts[ steps - 1 ].x + z );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t/* Faces */\r\n\r\n\t// Top and bottom faces\r\n\r\n\tbuildLidFaces();\r\n\r\n\t// Sides faces\r\n\r\n\tbuildSideFaces();\r\n\r\n\r\n\t/////  Internal functions\r\n\r\n\tfunction buildLidFaces() {\r\n\r\n\t\tif ( bevelEnabled ) {\r\n\r\n\t\t\tvar layer = 0; // steps + 1\r\n\t\t\tvar offset = vlen * layer;\r\n\r\n\t\t\t// Bottom faces\r\n\r\n\t\t\tfor ( i = 0; i < flen; i ++ ) {\r\n\r\n\t\t\t\tface = faces[ i ];\r\n\t\t\t\tf3( face[ 2 ] + offset, face[ 1 ] + offset, face[ 0 ] + offset );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tlayer = steps + bevelSegments * 2;\r\n\t\t\toffset = vlen * layer;\r\n\r\n\t\t\t// Top faces\r\n\r\n\t\t\tfor ( i = 0; i < flen; i ++ ) {\r\n\r\n\t\t\t\tface = faces[ i ];\r\n\t\t\t\tf3( face[ 0 ] + offset, face[ 1 ] + offset, face[ 2 ] + offset );\r\n\r\n\t\t\t}\r\n\r\n\t\t} else {\r\n\r\n\t\t\t// Bottom faces\r\n\r\n\t\t\tfor ( i = 0; i < flen; i ++ ) {\r\n\r\n\t\t\t\tface = faces[ i ];\r\n\t\t\t\tf3( face[ 2 ], face[ 1 ], face[ 0 ] );\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// Top faces\r\n\r\n\t\t\tfor ( i = 0; i < flen; i ++ ) {\r\n\r\n\t\t\t\tface = faces[ i ];\r\n\t\t\t\tf3( face[ 0 ] + vlen * steps, face[ 1 ] + vlen * steps, face[ 2 ] + vlen * steps );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t// Create faces for the z-sides of the shape\r\n\r\n\tfunction buildSideFaces() {\r\n\r\n\t\tvar layeroffset = 0;\r\n\t\tsidewalls( contour, layeroffset );\r\n\t\tlayeroffset += contour.length;\r\n\r\n\t\tfor ( h = 0, hl = holes.length; h < hl; h ++ ) {\r\n\r\n\t\t\tahole = holes[ h ];\r\n\t\t\tsidewalls( ahole, layeroffset );\r\n\r\n\t\t\t//, true\r\n\t\t\tlayeroffset += ahole.length;\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tfunction sidewalls( contour, layeroffset ) {\r\n\r\n\t\tvar j, k;\r\n\t\ti = contour.length;\r\n\r\n\t\twhile ( -- i >= 0 ) {\r\n\r\n\t\t\tj = i;\r\n\t\t\tk = i - 1;\r\n\t\t\tif ( k < 0 ) k = contour.length - 1;\r\n\r\n\t\t\t//console.log('b', i,j, i-1, k,vertices.length);\r\n\r\n\t\t\tvar s = 0, sl = steps  + bevelSegments * 2;\r\n\r\n\t\t\tfor ( s = 0; s < sl; s ++ ) {\r\n\r\n\t\t\t\tvar slen1 = vlen * s;\r\n\t\t\t\tvar slen2 = vlen * ( s + 1 );\r\n\r\n\t\t\t\tvar a = layeroffset + j + slen1,\r\n\t\t\t\t\tb = layeroffset + k + slen1,\r\n\t\t\t\t\tc = layeroffset + k + slen2,\r\n\t\t\t\t\td = layeroffset + j + slen2;\r\n\r\n\t\t\t\tf4( a, b, c, d, contour, s, sl, j, k );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\r\n\tfunction v( x, y, z ) {\r\n\r\n\t\tscope.vertices.push( new THREE.Vector3( x, y, z ) );\r\n\r\n\t}\r\n\r\n\tfunction f3( a, b, c ) {\r\n\r\n\t\ta += shapesOffset;\r\n\t\tb += shapesOffset;\r\n\t\tc += shapesOffset;\r\n\r\n\t\tscope.faces.push( new THREE.Face3( a, b, c, null, null, 0 ) );\r\n\r\n\t\tvar uvs = uvgen.generateTopUV( scope, a, b, c );\r\n\r\n\t\tscope.faceVertexUvs[ 0 ].push( uvs );\r\n\r\n\t}\r\n\r\n\tfunction f4( a, b, c, d, wallContour, stepIndex, stepsLength, contourIndex1, contourIndex2 ) {\r\n\r\n\t\ta += shapesOffset;\r\n\t\tb += shapesOffset;\r\n\t\tc += shapesOffset;\r\n\t\td += shapesOffset;\r\n\r\n\t\tscope.faces.push( new THREE.Face3( a, b, d, null, null, 1 ) );\r\n\t\tscope.faces.push( new THREE.Face3( b, c, d, null, null, 1 ) );\r\n\r\n\t\tvar uvs = uvgen.generateSideWallUV( scope, a, b, c, d );\r\n\r\n\t\tscope.faceVertexUvs[ 0 ].push( [ uvs[ 0 ], uvs[ 1 ], uvs[ 3 ] ] );\r\n\t\tscope.faceVertexUvs[ 0 ].push( [ uvs[ 1 ], uvs[ 2 ], uvs[ 3 ] ] );\r\n\r\n\t}\r\n\r\n};\r\n\r\nTHREE.ExtrudeGeometry.WorldUVGenerator = {\r\n\r\n\tgenerateTopUV: function ( geometry, indexA, indexB, indexC ) {\r\n\r\n\t\tvar vertices = geometry.vertices;\r\n\r\n\t\tvar a = vertices[ indexA ];\r\n\t\tvar b = vertices[ indexB ];\r\n\t\tvar c = vertices[ indexC ];\r\n\r\n\t\treturn [\r\n\t\t\tnew THREE.Vector2( a.x, a.y ),\r\n\t\t\tnew THREE.Vector2( b.x, b.y ),\r\n\t\t\tnew THREE.Vector2( c.x, c.y )\r\n\t\t];\r\n\r\n\t},\r\n\r\n\tgenerateSideWallUV: function ( geometry, indexA, indexB, indexC, indexD ) {\r\n\r\n\t\tvar vertices = geometry.vertices;\r\n\r\n\t\tvar a = vertices[ indexA ];\r\n\t\tvar b = vertices[ indexB ];\r\n\t\tvar c = vertices[ indexC ];\r\n\t\tvar d = vertices[ indexD ];\r\n\r\n\t\tif ( Math.abs( a.y - b.y ) < 0.01 ) {\r\n\r\n\t\t\treturn [\r\n\t\t\t\tnew THREE.Vector2( a.x, 1 - a.z ),\r\n\t\t\t\tnew THREE.Vector2( b.x, 1 - b.z ),\r\n\t\t\t\tnew THREE.Vector2( c.x, 1 - c.z ),\r\n\t\t\t\tnew THREE.Vector2( d.x, 1 - d.z )\r\n\t\t\t];\r\n\r\n\t\t} else {\r\n\r\n\t\t\treturn [\r\n\t\t\t\tnew THREE.Vector2( a.y, 1 - a.z ),\r\n\t\t\t\tnew THREE.Vector2( b.y, 1 - b.z ),\r\n\t\t\t\tnew THREE.Vector2( c.y, 1 - c.z ),\r\n\t\t\t\tnew THREE.Vector2( d.y, 1 - d.z )\r\n\t\t\t];\r\n\r\n\t\t}\r\n\r\n\t}\r\n};\r\n\r\n// File:src/extras/geometries/ShapeGeometry.js\r\n\r\n/**\r\n * @author jonobr1 / http://jonobr1.com\r\n *\r\n * Creates a one-sided polygonal geometry from a path shape. Similar to\r\n * ExtrudeGeometry.\r\n *\r\n * parameters = {\r\n *\r\n *\tcurveSegments: <int>, // number of points on the curves. NOT USED AT THE MOMENT.\r\n *\r\n *\tmaterial: <int> // material index for front and back faces\r\n *\tuvGenerator: <Object> // object that provides UV generator functions\r\n *\r\n * }\r\n **/\r\n\r\nTHREE.ShapeGeometry = function ( shapes, options ) {\r\n\r\n\tTHREE.Geometry.call( this );\r\n\r\n\tthis.type = 'ShapeGeometry';\r\n\r\n\tif ( Array.isArray( shapes ) === false ) shapes = [ shapes ];\r\n\r\n\tthis.addShapeList( shapes, options );\r\n\r\n\tthis.computeFaceNormals();\r\n\r\n};\r\n\r\nTHREE.ShapeGeometry.prototype = Object.create( THREE.Geometry.prototype );\r\nTHREE.ShapeGeometry.prototype.constructor = THREE.ShapeGeometry;\r\n\r\n/**\r\n * Add an array of shapes to THREE.ShapeGeometry.\r\n */\r\nTHREE.ShapeGeometry.prototype.addShapeList = function ( shapes, options ) {\r\n\r\n\tfor ( var i = 0, l = shapes.length; i < l; i ++ ) {\r\n\r\n\t\tthis.addShape( shapes[ i ], options );\r\n\r\n\t}\r\n\r\n\treturn this;\r\n\r\n};\r\n\r\n/**\r\n * Adds a shape to THREE.ShapeGeometry, based on THREE.ExtrudeGeometry.\r\n */\r\nTHREE.ShapeGeometry.prototype.addShape = function ( shape, options ) {\r\n\r\n\tif ( options === undefined ) options = {};\r\n\tvar curveSegments = options.curveSegments !== undefined ? options.curveSegments : 12;\r\n\r\n\tvar material = options.material;\r\n\tvar uvgen = options.UVGenerator === undefined ? THREE.ExtrudeGeometry.WorldUVGenerator : options.UVGenerator;\r\n\r\n\t//\r\n\r\n\tvar i, l, hole;\r\n\r\n\tvar shapesOffset = this.vertices.length;\r\n\tvar shapePoints = shape.extractPoints( curveSegments );\r\n\r\n\tvar vertices = shapePoints.shape;\r\n\tvar holes = shapePoints.holes;\r\n\r\n\tvar reverse = ! THREE.ShapeUtils.isClockWise( vertices );\r\n\r\n\tif ( reverse ) {\r\n\r\n\t\tvertices = vertices.reverse();\r\n\r\n\t\t// Maybe we should also check if holes are in the opposite direction, just to be safe...\r\n\r\n\t\tfor ( i = 0, l = holes.length; i < l; i ++ ) {\r\n\r\n\t\t\thole = holes[ i ];\r\n\r\n\t\t\tif ( THREE.ShapeUtils.isClockWise( hole ) ) {\r\n\r\n\t\t\t\tholes[ i ] = hole.reverse();\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\treverse = false;\r\n\r\n\t}\r\n\r\n\tvar faces = THREE.ShapeUtils.triangulateShape( vertices, holes );\r\n\r\n\t// Vertices\r\n\r\n\tfor ( i = 0, l = holes.length; i < l; i ++ ) {\r\n\r\n\t\thole = holes[ i ];\r\n\t\tvertices = vertices.concat( hole );\r\n\r\n\t}\r\n\r\n\t//\r\n\r\n\tvar vert, vlen = vertices.length;\r\n\tvar face, flen = faces.length;\r\n\r\n\tfor ( i = 0; i < vlen; i ++ ) {\r\n\r\n\t\tvert = vertices[ i ];\r\n\r\n\t\tthis.vertices.push( new THREE.Vector3( vert.x, vert.y, 0 ) );\r\n\r\n\t}\r\n\r\n\tfor ( i = 0; i < flen; i ++ ) {\r\n\r\n\t\tface = faces[ i ];\r\n\r\n\t\tvar a = face[ 0 ] + shapesOffset;\r\n\t\tvar b = face[ 1 ] + shapesOffset;\r\n\t\tvar c = face[ 2 ] + shapesOffset;\r\n\r\n\t\tthis.faces.push( new THREE.Face3( a, b, c, null, null, material ) );\r\n\t\tthis.faceVertexUvs[ 0 ].push( uvgen.generateTopUV( this, a, b, c ) );\r\n\r\n\t}\r\n\r\n};\r\n\r\n// File:src/extras/geometries/LatheBufferGeometry.js\r\n\r\n/**\r\n * @author Mugen87 / https://github.com/Mugen87\r\n */\r\n\r\n // points - to create a closed torus, one must use a set of points\r\n //    like so: [ a, b, c, d, a ], see first is the same as last.\r\n // segments - the number of circumference segments to create\r\n // phiStart - the starting radian\r\n // phiLength - the radian (0 to 2PI) range of the lathed section\r\n //    2PI is a closed lathe, less than 2PI is a portion.\r\n\r\nTHREE.LatheBufferGeometry = function ( points, segments, phiStart, phiLength ) {\r\n\r\n\tTHREE.BufferGeometry.call( this );\r\n\r\n\tthis.type = 'LatheBufferGeometry';\r\n\r\n\tthis.parameters = {\r\n\t\tpoints: points,\r\n\t\tsegments: segments,\r\n\t\tphiStart: phiStart,\r\n\t\tphiLength: phiLength\r\n\t};\r\n\r\n\tsegments = Math.floor( segments ) || 12;\r\n\tphiStart = phiStart || 0;\r\n\tphiLength = phiLength || Math.PI * 2;\r\n\r\n\t// clamp phiLength so it's in range of [ 0, 2PI ]\r\n\tphiLength = THREE.Math.clamp( phiLength, 0, Math.PI * 2 );\r\n\r\n\t// these are used to calculate buffer length\r\n\tvar vertexCount = ( segments + 1 ) * points.length;\r\n\tvar indexCount = segments * points.length * 2 * 3;\r\n\r\n\t// buffers\r\n\tvar indices = new THREE.BufferAttribute( new ( indexCount > 65535 ? Uint32Array : Uint16Array )( indexCount ) , 1 );\r\n\tvar vertices = new THREE.BufferAttribute( new Float32Array( vertexCount * 3 ), 3 );\r\n\tvar uvs = new THREE.BufferAttribute( new Float32Array( vertexCount * 2 ), 2 );\r\n\r\n\t// helper variables\r\n\tvar index = 0, indexOffset = 0, base;\r\n\tvar inversePointLength = 1.0 / ( points.length - 1 );\r\n\tvar inverseSegments = 1.0 / segments;\r\n\tvar vertex = new THREE.Vector3();\r\n\tvar uv = new THREE.Vector2();\r\n\tvar i, j;\r\n\r\n\t// generate vertices and uvs\r\n\r\n\tfor ( i = 0; i <= segments; i ++ ) {\r\n\r\n\t\tvar phi = phiStart + i * inverseSegments * phiLength;\r\n\r\n\t\tvar sin = Math.sin( phi );\r\n\t\tvar cos = Math.cos( phi );\r\n\r\n\t\tfor ( j = 0; j <= ( points.length - 1 ); j ++ ) {\r\n\r\n\t\t\t// vertex\r\n\t\t\tvertex.x = points[ j ].x * sin;\r\n\t\t\tvertex.y = points[ j ].y;\r\n\t\t\tvertex.z = points[ j ].x * cos;\r\n\t\t\tvertices.setXYZ( index, vertex.x, vertex.y, vertex.z );\r\n\r\n\t\t\t// uv\r\n\t\t\tuv.x = i / segments;\r\n\t\t\tuv.y = j / ( points.length - 1 );\r\n\t\t\tuvs.setXY( index, uv.x, uv.y );\r\n\r\n\t\t\t// increase index\r\n\t\t\tindex ++;\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t// generate indices\r\n\r\n\tfor ( i = 0; i < segments; i ++ ) {\r\n\r\n\t\tfor ( j = 0; j < ( points.length - 1 ); j ++ ) {\r\n\r\n\t\t\tbase = j + i * points.length;\r\n\r\n\t\t\t// indices\r\n\t\t\tvar a = base;\r\n\t\t\tvar b = base + points.length;\r\n\t\t\tvar c = base + points.length + 1;\r\n\t\t\tvar d = base + 1;\r\n\r\n\t\t\t// face one\r\n\t\t\tindices.setX( indexOffset, a ); indexOffset++;\r\n\t\t\tindices.setX( indexOffset, b ); indexOffset++;\r\n\t\t\tindices.setX( indexOffset, d ); indexOffset++;\r\n\r\n\t\t\t// face two\r\n\t\t\tindices.setX( indexOffset, b ); indexOffset++;\r\n\t\t\tindices.setX( indexOffset, c ); indexOffset++;\r\n\t\t\tindices.setX( indexOffset, d ); indexOffset++;\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t// build geometry\r\n\r\n\tthis.setIndex( indices );\r\n\tthis.addAttribute( 'position', vertices );\r\n\tthis.addAttribute( 'uv', uvs );\r\n\r\n\t// generate normals\r\n\r\n\tthis.computeVertexNormals();\r\n\r\n\t// if the geometry is closed, we need to average the normals along the seam.\r\n\t// because the corresponding vertices are identical (but still have different UVs).\r\n\r\n\tif( phiLength === Math.PI * 2 ) {\r\n\r\n\t\tvar normals = this.attributes.normal.array;\r\n\t\tvar n1 = new THREE.Vector3();\r\n\t\tvar n2 = new THREE.Vector3();\r\n\t\tvar n = new THREE.Vector3();\r\n\r\n\t\t// this is the buffer offset for the last line of vertices\r\n\t\tbase = segments * points.length * 3;\r\n\r\n\t\tfor( i = 0, j = 0; i < points.length; i ++, j += 3 ) {\r\n\r\n\t\t\t// select the normal of the vertex in the first line\r\n\t\t\tn1.x = normals[ j + 0 ];\r\n\t\t\tn1.y = normals[ j + 1 ];\r\n\t\t\tn1.z = normals[ j + 2 ];\r\n\r\n\t\t\t// select the normal of the vertex in the last line\r\n\t\t\tn2.x = normals[ base + j + 0 ];\r\n\t\t\tn2.y = normals[ base + j + 1 ];\r\n\t\t\tn2.z = normals[ base + j + 2 ];\r\n\r\n\t\t\t// average normals\r\n\t\t\tn.addVectors( n1, n2 ).normalize();\r\n\r\n\t\t\t// assign the new values to both normals\r\n\t\t\tnormals[ j + 0 ] = normals[ base + j + 0 ] = n.x;\r\n\t\t\tnormals[ j + 1 ] = normals[ base + j + 1 ] = n.y;\r\n\t\t\tnormals[ j + 2 ] = normals[ base + j + 2 ] = n.z;\r\n\r\n\t\t} // next row\r\n\r\n\t}\r\n\r\n};\r\n\r\nTHREE.LatheBufferGeometry.prototype = Object.create( THREE.BufferGeometry.prototype );\r\nTHREE.LatheBufferGeometry.prototype.constructor = THREE.LatheBufferGeometry;\r\n\r\n// File:src/extras/geometries/LatheGeometry.js\r\n\r\n/**\r\n * @author astrodud / http://astrodud.isgreat.org/\r\n * @author zz85 / https://github.com/zz85\r\n * @author bhouston / http://clara.io\r\n */\r\n\r\n// points - to create a closed torus, one must use a set of points\r\n//    like so: [ a, b, c, d, a ], see first is the same as last.\r\n// segments - the number of circumference segments to create\r\n// phiStart - the starting radian\r\n// phiLength - the radian (0 to 2PI) range of the lathed section\r\n//    2PI is a closed lathe, less than 2PI is a portion.\r\n\r\nTHREE.LatheGeometry = function ( points, segments, phiStart, phiLength ) {\r\n\r\n\tTHREE.Geometry.call( this );\r\n\r\n\tthis.type = 'LatheGeometry';\r\n\r\n\tthis.parameters = {\r\n\t\tpoints: points,\r\n\t\tsegments: segments,\r\n\t\tphiStart: phiStart,\r\n\t\tphiLength: phiLength\r\n\t};\r\n\r\n\tthis.fromBufferGeometry( new THREE.LatheBufferGeometry( points, segments, phiStart, phiLength ) );\r\n\tthis.mergeVertices();\r\n\r\n};\r\n\r\nTHREE.LatheGeometry.prototype = Object.create( THREE.Geometry.prototype );\r\nTHREE.LatheGeometry.prototype.constructor = THREE.LatheGeometry;\r\n\r\n// File:src/extras/geometries/PlaneGeometry.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n * based on http://papervision3d.googlecode.com/svn/trunk/as3/trunk/src/org/papervision3d/objects/primitives/Plane.as\r\n */\r\n\r\nTHREE.PlaneGeometry = function ( width, height, widthSegments, heightSegments ) {\r\n\r\n\tTHREE.Geometry.call( this );\r\n\r\n\tthis.type = 'PlaneGeometry';\r\n\r\n\tthis.parameters = {\r\n\t\twidth: width,\r\n\t\theight: height,\r\n\t\twidthSegments: widthSegments,\r\n\t\theightSegments: heightSegments\r\n\t};\r\n\r\n\tthis.fromBufferGeometry( new THREE.PlaneBufferGeometry( width, height, widthSegments, heightSegments ) );\r\n\r\n};\r\n\r\nTHREE.PlaneGeometry.prototype = Object.create( THREE.Geometry.prototype );\r\nTHREE.PlaneGeometry.prototype.constructor = THREE.PlaneGeometry;\r\n\r\n// File:src/extras/geometries/PlaneBufferGeometry.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n * based on http://papervision3d.googlecode.com/svn/trunk/as3/trunk/src/org/papervision3d/objects/primitives/Plane.as\r\n */\r\n\r\nTHREE.PlaneBufferGeometry = function ( width, height, widthSegments, heightSegments ) {\r\n\r\n\tTHREE.BufferGeometry.call( this );\r\n\r\n\tthis.type = 'PlaneBufferGeometry';\r\n\r\n\tthis.parameters = {\r\n\t\twidth: width,\r\n\t\theight: height,\r\n\t\twidthSegments: widthSegments,\r\n\t\theightSegments: heightSegments\r\n\t};\r\n\r\n\tvar width_half = width / 2;\r\n\tvar height_half = height / 2;\r\n\r\n\tvar gridX = Math.floor( widthSegments ) || 1;\r\n\tvar gridY = Math.floor( heightSegments ) || 1;\r\n\r\n\tvar gridX1 = gridX + 1;\r\n\tvar gridY1 = gridY + 1;\r\n\r\n\tvar segment_width = width / gridX;\r\n\tvar segment_height = height / gridY;\r\n\r\n\tvar vertices = new Float32Array( gridX1 * gridY1 * 3 );\r\n\tvar normals = new Float32Array( gridX1 * gridY1 * 3 );\r\n\tvar uvs = new Float32Array( gridX1 * gridY1 * 2 );\r\n\r\n\tvar offset = 0;\r\n\tvar offset2 = 0;\r\n\r\n\tfor ( var iy = 0; iy < gridY1; iy ++ ) {\r\n\r\n\t\tvar y = iy * segment_height - height_half;\r\n\r\n\t\tfor ( var ix = 0; ix < gridX1; ix ++ ) {\r\n\r\n\t\t\tvar x = ix * segment_width - width_half;\r\n\r\n\t\t\tvertices[ offset ] = x;\r\n\t\t\tvertices[ offset + 1 ] = - y;\r\n\r\n\t\t\tnormals[ offset + 2 ] = 1;\r\n\r\n\t\t\tuvs[ offset2 ] = ix / gridX;\r\n\t\t\tuvs[ offset2 + 1 ] = 1 - ( iy / gridY );\r\n\r\n\t\t\toffset += 3;\r\n\t\t\toffset2 += 2;\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\toffset = 0;\r\n\r\n\tvar indices = new ( ( vertices.length / 3 ) > 65535 ? Uint32Array : Uint16Array )( gridX * gridY * 6 );\r\n\r\n\tfor ( var iy = 0; iy < gridY; iy ++ ) {\r\n\r\n\t\tfor ( var ix = 0; ix < gridX; ix ++ ) {\r\n\r\n\t\t\tvar a = ix + gridX1 * iy;\r\n\t\t\tvar b = ix + gridX1 * ( iy + 1 );\r\n\t\t\tvar c = ( ix + 1 ) + gridX1 * ( iy + 1 );\r\n\t\t\tvar d = ( ix + 1 ) + gridX1 * iy;\r\n\r\n\t\t\tindices[ offset ] = a;\r\n\t\t\tindices[ offset + 1 ] = b;\r\n\t\t\tindices[ offset + 2 ] = d;\r\n\r\n\t\t\tindices[ offset + 3 ] = b;\r\n\t\t\tindices[ offset + 4 ] = c;\r\n\t\t\tindices[ offset + 5 ] = d;\r\n\r\n\t\t\toffset += 6;\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tthis.setIndex( new THREE.BufferAttribute( indices, 1 ) );\r\n\tthis.addAttribute( 'position', new THREE.BufferAttribute( vertices, 3 ) );\r\n\tthis.addAttribute( 'normal', new THREE.BufferAttribute( normals, 3 ) );\r\n\tthis.addAttribute( 'uv', new THREE.BufferAttribute( uvs, 2 ) );\r\n\r\n};\r\n\r\nTHREE.PlaneBufferGeometry.prototype = Object.create( THREE.BufferGeometry.prototype );\r\nTHREE.PlaneBufferGeometry.prototype.constructor = THREE.PlaneBufferGeometry;\r\n\r\n// File:src/extras/geometries/RingBufferGeometry.js\r\n\r\n/**\r\n * @author Mugen87 / https://github.com/Mugen87\r\n */\r\n\r\nTHREE.RingBufferGeometry = function ( innerRadius, outerRadius, thetaSegments, phiSegments, thetaStart, thetaLength ) {\r\n\r\n\tTHREE.BufferGeometry.call( this );\r\n\r\n\tthis.type = 'RingBufferGeometry';\r\n\r\n\tthis.parameters = {\r\n\t\tinnerRadius: innerRadius,\r\n\t\touterRadius: outerRadius,\r\n\t\tthetaSegments: thetaSegments,\r\n\t\tphiSegments: phiSegments,\r\n\t\tthetaStart: thetaStart,\r\n\t\tthetaLength: thetaLength\r\n\t};\r\n\r\n\tinnerRadius = innerRadius || 20;\r\n\touterRadius = outerRadius || 50;\r\n\r\n\tthetaStart = thetaStart !== undefined ? thetaStart : 0;\r\n\tthetaLength = thetaLength !== undefined ? thetaLength : Math.PI * 2;\r\n\r\n\tthetaSegments = thetaSegments !== undefined ? Math.max( 3, thetaSegments ) : 8;\r\n\tphiSegments = phiSegments !== undefined ? Math.max( 1, phiSegments ) : 1;\r\n\r\n\t// these are used to calculate buffer length\r\n\tvar vertexCount = ( thetaSegments + 1 ) * ( phiSegments + 1 );\r\n\tvar indexCount = thetaSegments * phiSegments * 2 * 3;\r\n\r\n\t// buffers\r\n\tvar indices = new THREE.BufferAttribute( new ( indexCount > 65535 ? Uint32Array : Uint16Array )( indexCount ) , 1 );\r\n\tvar vertices = new THREE.BufferAttribute( new Float32Array( vertexCount * 3 ), 3 );\r\n\tvar normals = new THREE.BufferAttribute( new Float32Array( vertexCount * 3 ), 3 );\r\n\tvar uvs = new THREE.BufferAttribute( new Float32Array( vertexCount * 2 ), 2 );\r\n\r\n\t// some helper variables\r\n\tvar index = 0, indexOffset = 0, segment;\r\n\tvar radius = innerRadius;\r\n\tvar radiusStep = ( ( outerRadius - innerRadius ) / phiSegments );\r\n\tvar vertex = new THREE.Vector3();\r\n\tvar uv = new THREE.Vector2();\r\n\tvar j, i;\r\n\r\n\t// generate vertices, normals and uvs\r\n\r\n\t// values are generate from the inside of the ring to the outside\r\n\r\n\tfor ( j = 0; j <= phiSegments; j ++ ) {\r\n\r\n\t\tfor ( i = 0; i <= thetaSegments; i ++ ) {\r\n\r\n\t\t\tsegment = thetaStart + i / thetaSegments * thetaLength;\r\n\r\n\t\t\t// vertex\r\n\t\t\tvertex.x = radius * Math.cos( segment );\r\n\t\t\tvertex.y = radius * Math.sin( segment );\r\n\t\t\tvertices.setXYZ( index, vertex.x, vertex.y, vertex.z );\r\n\r\n\t\t\t// normal\r\n\t\t\tnormals.setXYZ( index, 0, 0, 1 );\r\n\r\n\t\t\t// uv\r\n\t\t\tuv.x = ( vertex.x / outerRadius + 1 ) / 2;\r\n\t\t\tuv.y = ( vertex.y / outerRadius + 1 ) / 2;\r\n\t\t\tuvs.setXY( index, uv.x, uv.y );\r\n\r\n\t\t\t// increase index\r\n\t\t\tindex++;\r\n\r\n\t\t}\r\n\r\n\t\t// increase the radius for next row of vertices\r\n\t\tradius += radiusStep;\r\n\r\n\t}\r\n\r\n\t// generate indices\r\n\r\n\tfor ( j = 0; j < phiSegments; j ++ ) {\r\n\r\n\t\tvar thetaSegmentLevel = j * ( thetaSegments + 1 );\r\n\r\n\t\tfor ( i = 0; i < thetaSegments; i ++ ) {\r\n\r\n\t\t\tsegment = i + thetaSegmentLevel;\r\n\r\n\t\t\t// indices\r\n\t\t\tvar a = segment;\r\n\t\t\tvar b = segment + thetaSegments + 1;\r\n\t\t\tvar c = segment + thetaSegments + 2;\r\n\t\t\tvar d = segment + 1;\r\n\r\n\t\t\t// face one\r\n\t\t\tindices.setX( indexOffset, a ); indexOffset++;\r\n\t\t\tindices.setX( indexOffset, b ); indexOffset++;\r\n\t\t\tindices.setX( indexOffset, c ); indexOffset++;\r\n\r\n\t\t\t// face two\r\n\t\t\tindices.setX( indexOffset, a ); indexOffset++;\r\n\t\t\tindices.setX( indexOffset, c ); indexOffset++;\r\n\t\t\tindices.setX( indexOffset, d ); indexOffset++;\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t// build geometry\r\n\r\n\tthis.setIndex( indices );\r\n\tthis.addAttribute( 'position', vertices );\r\n\tthis.addAttribute( 'normal', normals );\r\n\tthis.addAttribute( 'uv', uvs );\r\n\r\n};\r\n\r\nTHREE.RingBufferGeometry.prototype = Object.create( THREE.BufferGeometry.prototype );\r\nTHREE.RingBufferGeometry.prototype.constructor = THREE.RingBufferGeometry;\r\n\r\n// File:src/extras/geometries/RingGeometry.js\r\n\r\n/**\r\n * @author Kaleb Murphy\r\n */\r\n\r\nTHREE.RingGeometry = function ( innerRadius, outerRadius, thetaSegments, phiSegments, thetaStart, thetaLength ) {\r\n\r\n\tTHREE.Geometry.call( this );\r\n\r\n\tthis.type = 'RingGeometry';\r\n\r\n\tthis.parameters = {\r\n\t\tinnerRadius: innerRadius,\r\n\t\touterRadius: outerRadius,\r\n\t\tthetaSegments: thetaSegments,\r\n\t\tphiSegments: phiSegments,\r\n\t\tthetaStart: thetaStart,\r\n\t\tthetaLength: thetaLength\r\n\t};\r\n\r\n\tthis.fromBufferGeometry( new THREE.RingBufferGeometry( innerRadius, outerRadius, thetaSegments, phiSegments, thetaStart, thetaLength ) );\r\n\r\n};\r\n\r\nTHREE.RingGeometry.prototype = Object.create( THREE.Geometry.prototype );\r\nTHREE.RingGeometry.prototype.constructor = THREE.RingGeometry;\r\n\r\n// File:src/extras/geometries/SphereGeometry.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.SphereGeometry = function ( radius, widthSegments, heightSegments, phiStart, phiLength, thetaStart, thetaLength ) {\r\n\r\n\tTHREE.Geometry.call( this );\r\n\r\n\tthis.type = 'SphereGeometry';\r\n\r\n\tthis.parameters = {\r\n\t\tradius: radius,\r\n\t\twidthSegments: widthSegments,\r\n\t\theightSegments: heightSegments,\r\n\t\tphiStart: phiStart,\r\n\t\tphiLength: phiLength,\r\n\t\tthetaStart: thetaStart,\r\n\t\tthetaLength: thetaLength\r\n\t};\r\n\r\n\tthis.fromBufferGeometry( new THREE.SphereBufferGeometry( radius, widthSegments, heightSegments, phiStart, phiLength, thetaStart, thetaLength ) );\r\n\r\n};\r\n\r\nTHREE.SphereGeometry.prototype = Object.create( THREE.Geometry.prototype );\r\nTHREE.SphereGeometry.prototype.constructor = THREE.SphereGeometry;\r\n\r\n// File:src/extras/geometries/SphereBufferGeometry.js\r\n\r\n/**\r\n * @author benaadams / https://twitter.com/ben_a_adams\r\n * based on THREE.SphereGeometry\r\n */\r\n\r\nTHREE.SphereBufferGeometry = function ( radius, widthSegments, heightSegments, phiStart, phiLength, thetaStart, thetaLength ) {\r\n\r\n\tTHREE.BufferGeometry.call( this );\r\n\r\n\tthis.type = 'SphereBufferGeometry';\r\n\r\n\tthis.parameters = {\r\n\t\tradius: radius,\r\n\t\twidthSegments: widthSegments,\r\n\t\theightSegments: heightSegments,\r\n\t\tphiStart: phiStart,\r\n\t\tphiLength: phiLength,\r\n\t\tthetaStart: thetaStart,\r\n\t\tthetaLength: thetaLength\r\n\t};\r\n\r\n\tradius = radius || 50;\r\n\r\n\twidthSegments = Math.max( 3, Math.floor( widthSegments ) || 8 );\r\n\theightSegments = Math.max( 2, Math.floor( heightSegments ) || 6 );\r\n\r\n\tphiStart = phiStart !== undefined ? phiStart : 0;\r\n\tphiLength = phiLength !== undefined ? phiLength : Math.PI * 2;\r\n\r\n\tthetaStart = thetaStart !== undefined ? thetaStart : 0;\r\n\tthetaLength = thetaLength !== undefined ? thetaLength : Math.PI;\r\n\r\n\tvar thetaEnd = thetaStart + thetaLength;\r\n\r\n\tvar vertexCount = ( ( widthSegments + 1 ) * ( heightSegments + 1 ) );\r\n\r\n\tvar positions = new THREE.BufferAttribute( new Float32Array( vertexCount * 3 ), 3 );\r\n\tvar normals = new THREE.BufferAttribute( new Float32Array( vertexCount * 3 ), 3 );\r\n\tvar uvs = new THREE.BufferAttribute( new Float32Array( vertexCount * 2 ), 2 );\r\n\r\n\tvar index = 0, vertices = [], normal = new THREE.Vector3();\r\n\r\n\tfor ( var y = 0; y <= heightSegments; y ++ ) {\r\n\r\n\t\tvar verticesRow = [];\r\n\r\n\t\tvar v = y / heightSegments;\r\n\r\n\t\tfor ( var x = 0; x <= widthSegments; x ++ ) {\r\n\r\n\t\t\tvar u = x / widthSegments;\r\n\r\n\t\t\tvar px = - radius * Math.cos( phiStart + u * phiLength ) * Math.sin( thetaStart + v * thetaLength );\r\n\t\t\tvar py = radius * Math.cos( thetaStart + v * thetaLength );\r\n\t\t\tvar pz = radius * Math.sin( phiStart + u * phiLength ) * Math.sin( thetaStart + v * thetaLength );\r\n\r\n\t\t\tnormal.set( px, py, pz ).normalize();\r\n\r\n\t\t\tpositions.setXYZ( index, px, py, pz );\r\n\t\t\tnormals.setXYZ( index, normal.x, normal.y, normal.z );\r\n\t\t\tuvs.setXY( index, u, 1 - v );\r\n\r\n\t\t\tverticesRow.push( index );\r\n\r\n\t\t\tindex ++;\r\n\r\n\t\t}\r\n\r\n\t\tvertices.push( verticesRow );\r\n\r\n\t}\r\n\r\n\tvar indices = [];\r\n\r\n\tfor ( var y = 0; y < heightSegments; y ++ ) {\r\n\r\n\t\tfor ( var x = 0; x < widthSegments; x ++ ) {\r\n\r\n\t\t\tvar v1 = vertices[ y ][ x + 1 ];\r\n\t\t\tvar v2 = vertices[ y ][ x ];\r\n\t\t\tvar v3 = vertices[ y + 1 ][ x ];\r\n\t\t\tvar v4 = vertices[ y + 1 ][ x + 1 ];\r\n\r\n\t\t\tif ( y !== 0 || thetaStart > 0 ) indices.push( v1, v2, v4 );\r\n\t\t\tif ( y !== heightSegments - 1 || thetaEnd < Math.PI ) indices.push( v2, v3, v4 );\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tthis.setIndex( new ( positions.count > 65535 ? THREE.Uint32Attribute : THREE.Uint16Attribute )( indices, 1 ) );\r\n\tthis.addAttribute( 'position', positions );\r\n\tthis.addAttribute( 'normal', normals );\r\n\tthis.addAttribute( 'uv', uvs );\r\n\r\n\tthis.boundingSphere = new THREE.Sphere( new THREE.Vector3(), radius );\r\n\r\n};\r\n\r\nTHREE.SphereBufferGeometry.prototype = Object.create( THREE.BufferGeometry.prototype );\r\nTHREE.SphereBufferGeometry.prototype.constructor = THREE.SphereBufferGeometry;\r\n\r\n// File:src/extras/geometries/TextGeometry.js\r\n\r\n/**\r\n * @author zz85 / http://www.lab4games.net/zz85/blog\r\n * @author alteredq / http://alteredqualia.com/\r\n *\r\n * Text = 3D Text\r\n *\r\n * parameters = {\r\n *  font: <THREE.Font>, // font\r\n *\r\n *  size: <float>, // size of the text\r\n *  height: <float>, // thickness to extrude text\r\n *  curveSegments: <int>, // number of points on the curves\r\n *\r\n *  bevelEnabled: <bool>, // turn on bevel\r\n *  bevelThickness: <float>, // how deep into text bevel goes\r\n *  bevelSize: <float> // how far from text outline is bevel\r\n * }\r\n */\r\n\r\nTHREE.TextGeometry = function ( text, parameters ) {\r\n\r\n\tparameters = parameters || {};\r\n\r\n\tvar font = parameters.font;\r\n\r\n\tif ( font instanceof THREE.Font === false ) {\r\n\r\n\t\tconsole.error( 'THREE.TextGeometry: font parameter is not an instance of THREE.Font.' );\r\n\t\treturn new THREE.Geometry();\r\n\r\n\t}\r\n\r\n\tvar shapes = font.generateShapes( text, parameters.size, parameters.curveSegments );\r\n\r\n\t// translate parameters to ExtrudeGeometry API\r\n\r\n\tparameters.amount = parameters.height !== undefined ? parameters.height : 50;\r\n\r\n\t// defaults\r\n\r\n\tif ( parameters.bevelThickness === undefined ) parameters.bevelThickness = 10;\r\n\tif ( parameters.bevelSize === undefined ) parameters.bevelSize = 8;\r\n\tif ( parameters.bevelEnabled === undefined ) parameters.bevelEnabled = false;\r\n\r\n\tTHREE.ExtrudeGeometry.call( this, shapes, parameters );\r\n\r\n\tthis.type = 'TextGeometry';\r\n\r\n};\r\n\r\nTHREE.TextGeometry.prototype = Object.create( THREE.ExtrudeGeometry.prototype );\r\nTHREE.TextGeometry.prototype.constructor = THREE.TextGeometry;\r\n\r\n// File:src/extras/geometries/TorusBufferGeometry.js\r\n\r\n/**\r\n * @author Mugen87 / https://github.com/Mugen87\r\n */\r\n\r\nTHREE.TorusBufferGeometry = function ( radius, tube, radialSegments, tubularSegments, arc ) {\r\n\r\n\tTHREE.BufferGeometry.call( this );\r\n\r\n\tthis.type = 'TorusBufferGeometry';\r\n\r\n\tthis.parameters = {\r\n\t\tradius: radius,\r\n\t\ttube: tube,\r\n\t\tradialSegments: radialSegments,\r\n\t\ttubularSegments: tubularSegments,\r\n\t\tarc: arc\r\n\t};\r\n\r\n\tradius = radius || 100;\r\n\ttube = tube || 40;\r\n\tradialSegments = Math.floor( radialSegments ) || 8;\r\n\ttubularSegments = Math.floor( tubularSegments ) || 6;\r\n\tarc = arc || Math.PI * 2;\r\n\r\n\t// used to calculate buffer length\r\n\tvar vertexCount = ( ( radialSegments + 1 ) * ( tubularSegments + 1 ) );\r\n\tvar indexCount = radialSegments * tubularSegments * 2 * 3;\r\n\r\n\t// buffers\r\n\tvar indices = new ( indexCount > 65535 ? Uint32Array : Uint16Array )( indexCount );\r\n\tvar vertices = new Float32Array( vertexCount * 3 );\r\n\tvar normals = new Float32Array( vertexCount * 3 );\r\n\tvar uvs = new Float32Array( vertexCount * 2 );\r\n\r\n\t// offset variables\r\n\tvar vertexBufferOffset = 0;\r\n\tvar uvBufferOffset = 0;\r\n\tvar indexBufferOffset = 0;\r\n\r\n\t// helper variables\r\n\tvar center = new THREE.Vector3();\r\n\tvar vertex = new THREE.Vector3();\r\n\tvar normal = new THREE.Vector3();\r\n\r\n\tvar j, i;\r\n\r\n\t// generate vertices, normals and uvs\r\n\r\n\tfor ( j = 0; j <= radialSegments; j ++ ) {\r\n\r\n\t\tfor ( i = 0; i <= tubularSegments; i ++ ) {\r\n\r\n\t\t\tvar u = i / tubularSegments * arc;\r\n\t\t\tvar v = j / radialSegments * Math.PI * 2;\r\n\r\n\t\t\t// vertex\r\n\t\t\tvertex.x = ( radius + tube * Math.cos( v ) ) * Math.cos( u );\r\n\t\t\tvertex.y = ( radius + tube * Math.cos( v ) ) * Math.sin( u );\r\n\t\t\tvertex.z = tube * Math.sin( v );\r\n\r\n\t\t\tvertices[ vertexBufferOffset ] = vertex.x;\r\n\t\t\tvertices[ vertexBufferOffset + 1 ] = vertex.y;\r\n\t\t\tvertices[ vertexBufferOffset + 2 ] = vertex.z;\r\n\r\n\t\t\t// this vector is used to calculate the normal\r\n\t\t\tcenter.x = radius * Math.cos( u );\r\n\t\t\tcenter.y = radius * Math.sin( u );\r\n\r\n\t\t\t// normal\r\n\t\t\tnormal.subVectors( vertex, center ).normalize();\r\n\r\n\t\t\tnormals[ vertexBufferOffset ] = normal.x;\r\n\t\t\tnormals[ vertexBufferOffset + 1 ] = normal.y;\r\n\t\t\tnormals[ vertexBufferOffset + 2 ] = normal.z;\r\n\r\n\t\t\t// uv\r\n\t\t\tuvs[ uvBufferOffset ] = i / tubularSegments;\r\n\t\t\tuvs[ uvBufferOffset + 1 ] = j / radialSegments;\r\n\r\n\t\t\t// update offsets\r\n\t\t\tvertexBufferOffset += 3;\r\n\t\t\tuvBufferOffset += 2;\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t// generate indices\r\n\r\n\tfor ( j = 1; j <= radialSegments; j ++ ) {\r\n\r\n\t\tfor ( i = 1; i <= tubularSegments; i ++ ) {\r\n\r\n\t\t\t// indices\r\n\t\t\tvar a = ( tubularSegments + 1 ) * j + i - 1;\r\n\t\t\tvar b = ( tubularSegments + 1 ) * ( j - 1 ) + i - 1;\r\n\t\t\tvar c = ( tubularSegments + 1 ) * ( j - 1 ) + i;\r\n\t\t\tvar d = ( tubularSegments + 1 ) * j + i;\r\n\r\n\t\t\t// face one\r\n\t\t\tindices[ indexBufferOffset ] = a;\r\n\t\t\tindices[ indexBufferOffset + 1 ] = b;\r\n\t\t\tindices[ indexBufferOffset + 2 ] = d;\r\n\r\n\t\t\t// face two\r\n\t\t\tindices[ indexBufferOffset + 3 ] = b;\r\n\t\t\tindices[ indexBufferOffset + 4 ] = c;\r\n\t\t\tindices[ indexBufferOffset + 5 ] = d;\r\n\r\n\t\t\t// update offset\r\n\t\t\tindexBufferOffset += 6;\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t// build geometry\r\n\tthis.setIndex( new THREE.BufferAttribute( indices, 1 ) );\r\n\tthis.addAttribute( 'position', new THREE.BufferAttribute( vertices, 3 ) );\r\n\tthis.addAttribute( 'normal', new THREE.BufferAttribute( normals, 3 ) );\r\n\tthis.addAttribute( 'uv', new THREE.BufferAttribute( uvs, 2 ) );\r\n\r\n};\r\n\r\nTHREE.TorusBufferGeometry.prototype = Object.create( THREE.BufferGeometry.prototype );\r\nTHREE.TorusBufferGeometry.prototype.constructor = THREE.TorusBufferGeometry;\r\n\r\n// File:src/extras/geometries/TorusGeometry.js\r\n\r\n/**\r\n * @author oosmoxiecode\r\n * @author mrdoob / http://mrdoob.com/\r\n * based on http://code.google.com/p/away3d/source/browse/trunk/fp10/Away3DLite/src/away3dlite/primitives/Torus.as?r=2888\r\n */\r\n\r\nTHREE.TorusGeometry = function ( radius, tube, radialSegments, tubularSegments, arc ) {\r\n\r\n\tTHREE.Geometry.call( this );\r\n\r\n\tthis.type = 'TorusGeometry';\r\n\r\n\tthis.parameters = {\r\n\t\tradius: radius,\r\n\t\ttube: tube,\r\n\t\tradialSegments: radialSegments,\r\n\t\ttubularSegments: tubularSegments,\r\n\t\tarc: arc\r\n\t};\r\n\r\n\tthis.fromBufferGeometry( new THREE.TorusBufferGeometry( radius, tube, radialSegments, tubularSegments, arc ) );\r\n\r\n};\r\n\r\nTHREE.TorusGeometry.prototype = Object.create( THREE.Geometry.prototype );\r\nTHREE.TorusGeometry.prototype.constructor = THREE.TorusGeometry;\r\n\r\n// File:src/extras/geometries/TorusKnotBufferGeometry.js\r\n\r\n/**\r\n * @author Mugen87 / https://github.com/Mugen87\r\n *\r\n * see: http://www.blackpawn.com/texts/pqtorus/\r\n */\r\nTHREE.TorusKnotBufferGeometry = function ( radius, tube, tubularSegments, radialSegments, p, q ) {\r\n\r\n\tTHREE.BufferGeometry.call( this );\r\n\r\n\tthis.type = 'TorusKnotBufferGeometry';\r\n\r\n\tthis.parameters = {\r\n\t\tradius: radius,\r\n\t\ttube: tube,\r\n\t\ttubularSegments: tubularSegments,\r\n\t\tradialSegments: radialSegments,\r\n\t\tp: p,\r\n\t\tq: q\r\n\t};\r\n\r\n\tradius = radius || 100;\r\n\ttube = tube || 40;\r\n\ttubularSegments = Math.floor( tubularSegments ) || 64;\r\n\tradialSegments = Math.floor( radialSegments ) || 8;\r\n\tp = p || 2;\r\n\tq = q || 3;\r\n\r\n\t// used to calculate buffer length\r\n\tvar vertexCount = ( ( radialSegments + 1 ) * ( tubularSegments + 1 ) );\r\n\tvar indexCount = radialSegments * tubularSegments * 2 * 3;\r\n\r\n\t// buffers\r\n\tvar indices = new THREE.BufferAttribute( new ( indexCount > 65535 ? Uint32Array : Uint16Array )( indexCount ) , 1 );\r\n\tvar vertices = new THREE.BufferAttribute( new Float32Array( vertexCount * 3 ), 3 );\r\n\tvar normals = new THREE.BufferAttribute( new Float32Array( vertexCount * 3 ), 3 );\r\n\tvar uvs = new THREE.BufferAttribute( new Float32Array( vertexCount * 2 ), 2 );\r\n\r\n\t// helper variables\r\n\tvar i, j, index = 0, indexOffset = 0;\r\n\r\n\tvar vertex = new THREE.Vector3();\r\n\tvar normal = new THREE.Vector3();\r\n\tvar uv = new THREE.Vector2();\r\n\r\n\tvar P1 = new THREE.Vector3();\r\n\tvar P2 = new THREE.Vector3();\r\n\r\n\tvar B = new THREE.Vector3();\r\n\tvar T = new THREE.Vector3();\r\n\tvar N = new THREE.Vector3();\r\n\r\n\t// generate vertices, normals and uvs\r\n\r\n\tfor ( i = 0; i <= tubularSegments; ++ i ) {\r\n\r\n\t\t// the radian \"u\" is used to calculate the position on the torus curve of the current tubular segement\r\n\r\n\t\tvar u = i / tubularSegments * p * Math.PI * 2;\r\n\r\n\t\t// now we calculate two points. P1 is our current position on the curve, P2 is a little farther ahead.\r\n\t\t// these points are used to create a special \"coordinate space\", which is necessary to calculate the correct vertex positions\r\n\r\n\t\tcalculatePositionOnCurve( u, p, q, radius, P1 );\r\n\t\tcalculatePositionOnCurve( u + 0.01, p, q, radius, P2 );\r\n\r\n\t\t// calculate orthonormal basis\r\n\r\n\t\tT.subVectors( P2, P1 );\r\n\t\tN.addVectors( P2, P1 );\r\n\t\tB.crossVectors( T, N );\r\n\t\tN.crossVectors( B, T );\r\n\r\n\t\t// normalize B, N. T can be ignored, we don't use it\r\n\r\n\t\tB.normalize();\r\n\t\tN.normalize();\r\n\r\n\t\tfor ( j = 0; j <= radialSegments; ++ j ) {\r\n\r\n\t\t\t// now calculate the vertices. they are nothing more than an extrusion of the torus curve.\r\n\t\t\t// because we extrude a shape in the xy-plane, there is no need to calculate a z-value.\r\n\r\n\t\t\tvar v = j / radialSegments * Math.PI * 2;\r\n\t\t\tvar cx = - tube * Math.cos( v );\r\n\t\t\tvar cy = tube * Math.sin( v );\r\n\r\n\t\t\t// now calculate the final vertex position.\r\n\t\t\t// first we orient the extrusion with our basis vectos, then we add it to the current position on the curve\r\n\r\n\t\t\tvertex.x = P1.x + ( cx * N.x + cy * B.x );\r\n\t\t\tvertex.y = P1.y + ( cx * N.y + cy * B.y );\r\n\t\t\tvertex.z = P1.z + ( cx * N.z + cy * B.z );\r\n\r\n\t\t\t// vertex\r\n\t\t\tvertices.setXYZ( index, vertex.x, vertex.y, vertex.z );\r\n\r\n\t\t\t// normal (P1 is always the center/origin of the extrusion, thus we can use it to calculate the normal)\r\n\t\t\tnormal.subVectors( vertex, P1 ).normalize();\r\n\t\t\tnormals.setXYZ( index, normal.x, normal.y, normal.z );\r\n\r\n\t\t\t// uv\r\n\t\t\tuv.x = i / tubularSegments;\r\n\t\t\tuv.y = j / radialSegments;\r\n\t\t\tuvs.setXY( index, uv.x, uv.y );\r\n\r\n\t\t\t// increase index\r\n\t\t\tindex ++;\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t// generate indices\r\n\r\n\tfor ( j = 1; j <= tubularSegments; j ++ ) {\r\n\r\n\t\tfor ( i = 1; i <= radialSegments; i ++ ) {\r\n\r\n\t\t\t// indices\r\n\t\t\tvar a = ( radialSegments + 1 ) * ( j - 1 ) + ( i - 1 );\r\n\t\t\tvar b = ( radialSegments + 1 ) * j + ( i - 1 );\r\n\t\t\tvar c = ( radialSegments + 1 ) * j + i;\r\n\t\t\tvar d = ( radialSegments + 1 ) * ( j - 1 ) + i;\r\n\r\n\t\t\t// face one\r\n\t\t\tindices.setX( indexOffset, a ); indexOffset++;\r\n\t\t\tindices.setX( indexOffset, b ); indexOffset++;\r\n\t\t\tindices.setX( indexOffset, d ); indexOffset++;\r\n\r\n\t\t\t// face two\r\n\t\t\tindices.setX( indexOffset, b ); indexOffset++;\r\n\t\t\tindices.setX( indexOffset, c ); indexOffset++;\r\n\t\t\tindices.setX( indexOffset, d ); indexOffset++;\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t// build geometry\r\n\r\n\tthis.setIndex( indices );\r\n\tthis.addAttribute( 'position', vertices );\r\n\tthis.addAttribute( 'normal', normals );\r\n\tthis.addAttribute( 'uv', uvs );\r\n\r\n\t// this function calculates the current position on the torus curve\r\n\r\n\tfunction calculatePositionOnCurve( u, p, q, radius, position ) {\r\n\r\n\t\tvar cu = Math.cos( u );\r\n\t\tvar su = Math.sin( u );\r\n\t\tvar quOverP = q / p * u;\r\n\t\tvar cs = Math.cos( quOverP );\r\n\r\n\t\tposition.x = radius * ( 2 + cs ) * 0.5 * cu;\r\n\t\tposition.y = radius * ( 2 + cs ) * su * 0.5;\r\n\t\tposition.z = radius * Math.sin( quOverP ) * 0.5;\r\n\r\n\t}\r\n\r\n};\r\n\r\nTHREE.TorusKnotBufferGeometry.prototype = Object.create( THREE.BufferGeometry.prototype );\r\nTHREE.TorusKnotBufferGeometry.prototype.constructor = THREE.TorusKnotBufferGeometry;\r\n\r\n// File:src/extras/geometries/TorusKnotGeometry.js\r\n\r\n/**\r\n * @author oosmoxiecode\r\n */\r\n\r\nTHREE.TorusKnotGeometry = function ( radius, tube, tubularSegments, radialSegments, p, q, heightScale ) {\r\n\r\n\tTHREE.Geometry.call( this );\r\n\r\n\tthis.type = 'TorusKnotGeometry';\r\n\r\n\tthis.parameters = {\r\n\t\tradius: radius,\r\n\t\ttube: tube,\r\n\t\ttubularSegments: tubularSegments,\r\n\t\tradialSegments: radialSegments,\r\n\t\tp: p,\r\n\t\tq: q\r\n\t};\r\n\r\n\tif( heightScale !== undefined ) console.warn( 'THREE.TorusKnotGeometry: heightScale has been deprecated. Use .scale( x, y, z ) instead.' );\r\n\r\n\tthis.fromBufferGeometry( new THREE.TorusKnotBufferGeometry( radius, tube, tubularSegments, radialSegments, p, q ) );\r\n\tthis.mergeVertices();\r\n\r\n};\r\n\r\nTHREE.TorusKnotGeometry.prototype = Object.create( THREE.Geometry.prototype );\r\nTHREE.TorusKnotGeometry.prototype.constructor = THREE.TorusKnotGeometry;\r\n\r\n// File:src/extras/geometries/TubeGeometry.js\r\n\r\n/**\r\n * @author WestLangley / https://github.com/WestLangley\r\n * @author zz85 / https://github.com/zz85\r\n * @author miningold / https://github.com/miningold\r\n * @author jonobr1 / https://github.com/jonobr1\r\n *\r\n * Modified from the TorusKnotGeometry by @oosmoxiecode\r\n *\r\n * Creates a tube which extrudes along a 3d spline\r\n *\r\n * Uses parallel transport frames as described in\r\n * http://www.cs.indiana.edu/pub/techreports/TR425.pdf\r\n */\r\n\r\nTHREE.TubeGeometry = function ( path, segments, radius, radialSegments, closed, taper ) {\r\n\r\n\tTHREE.Geometry.call( this );\r\n\r\n\tthis.type = 'TubeGeometry';\r\n\r\n\tthis.parameters = {\r\n\t\tpath: path,\r\n\t\tsegments: segments,\r\n\t\tradius: radius,\r\n\t\tradialSegments: radialSegments,\r\n\t\tclosed: closed,\r\n\t\ttaper: taper\r\n\t};\r\n\r\n\tsegments = segments || 64;\r\n\tradius = radius || 1;\r\n\tradialSegments = radialSegments || 8;\r\n\tclosed = closed || false;\r\n\ttaper = taper || THREE.TubeGeometry.NoTaper;\r\n\r\n\tvar grid = [];\r\n\r\n\tvar scope = this,\r\n\r\n\t\ttangent,\r\n\t\tnormal,\r\n\t\tbinormal,\r\n\r\n\t\tnumpoints = segments + 1,\r\n\r\n\t\tu, v, r,\r\n\r\n\t\tcx, cy,\r\n\t\tpos, pos2 = new THREE.Vector3(),\r\n\t\ti, j,\r\n\t\tip, jp,\r\n\t\ta, b, c, d,\r\n\t\tuva, uvb, uvc, uvd;\r\n\r\n\tvar frames = new THREE.TubeGeometry.FrenetFrames( path, segments, closed ),\r\n\t\ttangents = frames.tangents,\r\n\t\tnormals = frames.normals,\r\n\t\tbinormals = frames.binormals;\r\n\r\n\t// proxy internals\r\n\tthis.tangents = tangents;\r\n\tthis.normals = normals;\r\n\tthis.binormals = binormals;\r\n\r\n\tfunction vert( x, y, z ) {\r\n\r\n\t\treturn scope.vertices.push( new THREE.Vector3( x, y, z ) ) - 1;\r\n\r\n\t}\r\n\r\n\t// construct the grid\r\n\r\n\tfor ( i = 0; i < numpoints; i ++ ) {\r\n\r\n\t\tgrid[ i ] = [];\r\n\r\n\t\tu = i / ( numpoints - 1 );\r\n\r\n\t\tpos = path.getPointAt( u );\r\n\r\n\t\ttangent = tangents[ i ];\r\n\t\tnormal = normals[ i ];\r\n\t\tbinormal = binormals[ i ];\r\n\r\n\t\tr = radius * taper( u );\r\n\r\n\t\tfor ( j = 0; j < radialSegments; j ++ ) {\r\n\r\n\t\t\tv = j / radialSegments * 2 * Math.PI;\r\n\r\n\t\t\tcx = - r * Math.cos( v ); // TODO: Hack: Negating it so it faces outside.\r\n\t\t\tcy = r * Math.sin( v );\r\n\r\n\t\t\tpos2.copy( pos );\r\n\t\t\tpos2.x += cx * normal.x + cy * binormal.x;\r\n\t\t\tpos2.y += cx * normal.y + cy * binormal.y;\r\n\t\t\tpos2.z += cx * normal.z + cy * binormal.z;\r\n\r\n\t\t\tgrid[ i ][ j ] = vert( pos2.x, pos2.y, pos2.z );\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\r\n\t// construct the mesh\r\n\r\n\tfor ( i = 0; i < segments; i ++ ) {\r\n\r\n\t\tfor ( j = 0; j < radialSegments; j ++ ) {\r\n\r\n\t\t\tip = ( closed ) ? ( i + 1 ) % segments : i + 1;\r\n\t\t\tjp = ( j + 1 ) % radialSegments;\r\n\r\n\t\t\ta = grid[ i ][ j ];\t\t// *** NOT NECESSARILY PLANAR ! ***\r\n\t\t\tb = grid[ ip ][ j ];\r\n\t\t\tc = grid[ ip ][ jp ];\r\n\t\t\td = grid[ i ][ jp ];\r\n\r\n\t\t\tuva = new THREE.Vector2( i / segments, j / radialSegments );\r\n\t\t\tuvb = new THREE.Vector2( ( i + 1 ) / segments, j / radialSegments );\r\n\t\t\tuvc = new THREE.Vector2( ( i + 1 ) / segments, ( j + 1 ) / radialSegments );\r\n\t\t\tuvd = new THREE.Vector2( i / segments, ( j + 1 ) / radialSegments );\r\n\r\n\t\t\tthis.faces.push( new THREE.Face3( a, b, d ) );\r\n\t\t\tthis.faceVertexUvs[ 0 ].push( [ uva, uvb, uvd ] );\r\n\r\n\t\t\tthis.faces.push( new THREE.Face3( b, c, d ) );\r\n\t\t\tthis.faceVertexUvs[ 0 ].push( [ uvb.clone(), uvc, uvd.clone() ] );\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tthis.computeFaceNormals();\r\n\tthis.computeVertexNormals();\r\n\r\n};\r\n\r\nTHREE.TubeGeometry.prototype = Object.create( THREE.Geometry.prototype );\r\nTHREE.TubeGeometry.prototype.constructor = THREE.TubeGeometry;\r\n\r\nTHREE.TubeGeometry.NoTaper = function ( u ) {\r\n\r\n\treturn 1;\r\n\r\n};\r\n\r\nTHREE.TubeGeometry.SinusoidalTaper = function ( u ) {\r\n\r\n\treturn Math.sin( Math.PI * u );\r\n\r\n};\r\n\r\n// For computing of Frenet frames, exposing the tangents, normals and binormals the spline\r\nTHREE.TubeGeometry.FrenetFrames = function ( path, segments, closed ) {\r\n\r\n\tvar\tnormal = new THREE.Vector3(),\r\n\r\n\t\ttangents = [],\r\n\t\tnormals = [],\r\n\t\tbinormals = [],\r\n\r\n\t\tvec = new THREE.Vector3(),\r\n\t\tmat = new THREE.Matrix4(),\r\n\r\n\t\tnumpoints = segments + 1,\r\n\t\ttheta,\r\n\t\tsmallest,\r\n\r\n\t\ttx, ty, tz,\r\n\t\ti, u;\r\n\r\n\r\n\t// expose internals\r\n\tthis.tangents = tangents;\r\n\tthis.normals = normals;\r\n\tthis.binormals = binormals;\r\n\r\n\t// compute the tangent vectors for each segment on the path\r\n\r\n\tfor ( i = 0; i < numpoints; i ++ ) {\r\n\r\n\t\tu = i / ( numpoints - 1 );\r\n\r\n\t\ttangents[ i ] = path.getTangentAt( u );\r\n\t\ttangents[ i ].normalize();\r\n\r\n\t}\r\n\r\n\tinitialNormal3();\r\n\r\n\t/*\r\n\tfunction initialNormal1(lastBinormal) {\r\n\t\t// fixed start binormal. Has dangers of 0 vectors\r\n\t\tnormals[ 0 ] = new THREE.Vector3();\r\n\t\tbinormals[ 0 ] = new THREE.Vector3();\r\n\t\tif (lastBinormal===undefined) lastBinormal = new THREE.Vector3( 0, 0, 1 );\r\n\t\tnormals[ 0 ].crossVectors( lastBinormal, tangents[ 0 ] ).normalize();\r\n\t\tbinormals[ 0 ].crossVectors( tangents[ 0 ], normals[ 0 ] ).normalize();\r\n\t}\r\n\r\n\tfunction initialNormal2() {\r\n\r\n\t\t// This uses the Frenet-Serret formula for deriving binormal\r\n\t\tvar t2 = path.getTangentAt( epsilon );\r\n\r\n\t\tnormals[ 0 ] = new THREE.Vector3().subVectors( t2, tangents[ 0 ] ).normalize();\r\n\t\tbinormals[ 0 ] = new THREE.Vector3().crossVectors( tangents[ 0 ], normals[ 0 ] );\r\n\r\n\t\tnormals[ 0 ].crossVectors( binormals[ 0 ], tangents[ 0 ] ).normalize(); // last binormal x tangent\r\n\t\tbinormals[ 0 ].crossVectors( tangents[ 0 ], normals[ 0 ] ).normalize();\r\n\r\n\t}\r\n\t*/\r\n\r\n\tfunction initialNormal3() {\r\n\r\n\t\t// select an initial normal vector perpendicular to the first tangent vector,\r\n\t\t// and in the direction of the smallest tangent xyz component\r\n\r\n\t\tnormals[ 0 ] = new THREE.Vector3();\r\n\t\tbinormals[ 0 ] = new THREE.Vector3();\r\n\t\tsmallest = Number.MAX_VALUE;\r\n\t\ttx = Math.abs( tangents[ 0 ].x );\r\n\t\tty = Math.abs( tangents[ 0 ].y );\r\n\t\ttz = Math.abs( tangents[ 0 ].z );\r\n\r\n\t\tif ( tx <= smallest ) {\r\n\r\n\t\t\tsmallest = tx;\r\n\t\t\tnormal.set( 1, 0, 0 );\r\n\r\n\t\t}\r\n\r\n\t\tif ( ty <= smallest ) {\r\n\r\n\t\t\tsmallest = ty;\r\n\t\t\tnormal.set( 0, 1, 0 );\r\n\r\n\t\t}\r\n\r\n\t\tif ( tz <= smallest ) {\r\n\r\n\t\t\tnormal.set( 0, 0, 1 );\r\n\r\n\t\t}\r\n\r\n\t\tvec.crossVectors( tangents[ 0 ], normal ).normalize();\r\n\r\n\t\tnormals[ 0 ].crossVectors( tangents[ 0 ], vec );\r\n\t\tbinormals[ 0 ].crossVectors( tangents[ 0 ], normals[ 0 ] );\r\n\r\n\t}\r\n\r\n\r\n\t// compute the slowly-varying normal and binormal vectors for each segment on the path\r\n\r\n\tfor ( i = 1; i < numpoints; i ++ ) {\r\n\r\n\t\tnormals[ i ] = normals[ i - 1 ].clone();\r\n\r\n\t\tbinormals[ i ] = binormals[ i - 1 ].clone();\r\n\r\n\t\tvec.crossVectors( tangents[ i - 1 ], tangents[ i ] );\r\n\r\n\t\tif ( vec.length() > Number.EPSILON ) {\r\n\r\n\t\t\tvec.normalize();\r\n\r\n\t\t\ttheta = Math.acos( THREE.Math.clamp( tangents[ i - 1 ].dot( tangents[ i ] ), - 1, 1 ) ); // clamp for floating pt errors\r\n\r\n\t\t\tnormals[ i ].applyMatrix4( mat.makeRotationAxis( vec, theta ) );\r\n\r\n\t\t}\r\n\r\n\t\tbinormals[ i ].crossVectors( tangents[ i ], normals[ i ] );\r\n\r\n\t}\r\n\r\n\r\n\t// if the curve is closed, postprocess the vectors so the first and last normal vectors are the same\r\n\r\n\tif ( closed ) {\r\n\r\n\t\ttheta = Math.acos( THREE.Math.clamp( normals[ 0 ].dot( normals[ numpoints - 1 ] ), - 1, 1 ) );\r\n\t\ttheta /= ( numpoints - 1 );\r\n\r\n\t\tif ( tangents[ 0 ].dot( vec.crossVectors( normals[ 0 ], normals[ numpoints - 1 ] ) ) > 0 ) {\r\n\r\n\t\t\ttheta = - theta;\r\n\r\n\t\t}\r\n\r\n\t\tfor ( i = 1; i < numpoints; i ++ ) {\r\n\r\n\t\t\t// twist a little...\r\n\t\t\tnormals[ i ].applyMatrix4( mat.makeRotationAxis( tangents[ i ], theta * i ) );\r\n\t\t\tbinormals[ i ].crossVectors( tangents[ i ], normals[ i ] );\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n};\r\n\r\n// File:src/extras/geometries/PolyhedronGeometry.js\r\n\r\n/**\r\n * @author clockworkgeek / https://github.com/clockworkgeek\r\n * @author timothypratley / https://github.com/timothypratley\r\n * @author WestLangley / http://github.com/WestLangley\r\n*/\r\n\r\nTHREE.PolyhedronGeometry = function ( vertices, indices, radius, detail ) {\r\n\r\n\tTHREE.Geometry.call( this );\r\n\r\n\tthis.type = 'PolyhedronGeometry';\r\n\r\n\tthis.parameters = {\r\n\t\tvertices: vertices,\r\n\t\tindices: indices,\r\n\t\tradius: radius,\r\n\t\tdetail: detail\r\n\t};\r\n\r\n\tradius = radius || 1;\r\n\tdetail = detail || 0;\r\n\r\n\tvar that = this;\r\n\r\n\tfor ( var i = 0, l = vertices.length; i < l; i += 3 ) {\r\n\r\n\t\tprepare( new THREE.Vector3( vertices[ i ], vertices[ i + 1 ], vertices[ i + 2 ] ) );\r\n\r\n\t}\r\n\r\n\tvar p = this.vertices;\r\n\r\n\tvar faces = [];\r\n\r\n\tfor ( var i = 0, j = 0, l = indices.length; i < l; i += 3, j ++ ) {\r\n\r\n\t\tvar v1 = p[ indices[ i ] ];\r\n\t\tvar v2 = p[ indices[ i + 1 ] ];\r\n\t\tvar v3 = p[ indices[ i + 2 ] ];\r\n\r\n\t\tfaces[ j ] = new THREE.Face3( v1.index, v2.index, v3.index, [ v1.clone(), v2.clone(), v3.clone() ], undefined, j );\r\n\r\n\t}\r\n\r\n\tvar centroid = new THREE.Vector3();\r\n\r\n\tfor ( var i = 0, l = faces.length; i < l; i ++ ) {\r\n\r\n\t\tsubdivide( faces[ i ], detail );\r\n\r\n\t}\r\n\r\n\r\n\t// Handle case when face straddles the seam\r\n\r\n\tfor ( var i = 0, l = this.faceVertexUvs[ 0 ].length; i < l; i ++ ) {\r\n\r\n\t\tvar uvs = this.faceVertexUvs[ 0 ][ i ];\r\n\r\n\t\tvar x0 = uvs[ 0 ].x;\r\n\t\tvar x1 = uvs[ 1 ].x;\r\n\t\tvar x2 = uvs[ 2 ].x;\r\n\r\n\t\tvar max = Math.max( x0, x1, x2 );\r\n\t\tvar min = Math.min( x0, x1, x2 );\r\n\r\n\t\tif ( max > 0.9 && min < 0.1 ) {\r\n\r\n\t\t\t// 0.9 is somewhat arbitrary\r\n\r\n\t\t\tif ( x0 < 0.2 ) uvs[ 0 ].x += 1;\r\n\t\t\tif ( x1 < 0.2 ) uvs[ 1 ].x += 1;\r\n\t\t\tif ( x2 < 0.2 ) uvs[ 2 ].x += 1;\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\r\n\t// Apply radius\r\n\r\n\tfor ( var i = 0, l = this.vertices.length; i < l; i ++ ) {\r\n\r\n\t\tthis.vertices[ i ].multiplyScalar( radius );\r\n\r\n\t}\r\n\r\n\r\n\t// Merge vertices\r\n\r\n\tthis.mergeVertices();\r\n\r\n\tthis.computeFaceNormals();\r\n\r\n\tthis.boundingSphere = new THREE.Sphere( new THREE.Vector3(), radius );\r\n\r\n\r\n\t// Project vector onto sphere's surface\r\n\r\n\tfunction prepare( vector ) {\r\n\r\n\t\tvar vertex = vector.normalize().clone();\r\n\t\tvertex.index = that.vertices.push( vertex ) - 1;\r\n\r\n\t\t// Texture coords are equivalent to map coords, calculate angle and convert to fraction of a circle.\r\n\r\n\t\tvar u = azimuth( vector ) / 2 / Math.PI + 0.5;\r\n\t\tvar v = inclination( vector ) / Math.PI + 0.5;\r\n\t\tvertex.uv = new THREE.Vector2( u, 1 - v );\r\n\r\n\t\treturn vertex;\r\n\r\n\t}\r\n\r\n\r\n\t// Approximate a curved face with recursively sub-divided triangles.\r\n\r\n\tfunction make( v1, v2, v3, materialIndex ) {\r\n\r\n\t\tvar face = new THREE.Face3( v1.index, v2.index, v3.index, [ v1.clone(), v2.clone(), v3.clone() ], undefined, materialIndex );\r\n\t\tthat.faces.push( face );\r\n\r\n\t\tcentroid.copy( v1 ).add( v2 ).add( v3 ).divideScalar( 3 );\r\n\r\n\t\tvar azi = azimuth( centroid );\r\n\r\n\t\tthat.faceVertexUvs[ 0 ].push( [\r\n\t\t\tcorrectUV( v1.uv, v1, azi ),\r\n\t\t\tcorrectUV( v2.uv, v2, azi ),\r\n\t\t\tcorrectUV( v3.uv, v3, azi )\r\n\t\t] );\r\n\r\n\t}\r\n\r\n\r\n\t// Analytically subdivide a face to the required detail level.\r\n\r\n\tfunction subdivide( face, detail ) {\r\n\r\n\t\tvar cols = Math.pow( 2, detail );\r\n\t\tvar a = prepare( that.vertices[ face.a ] );\r\n\t\tvar b = prepare( that.vertices[ face.b ] );\r\n\t\tvar c = prepare( that.vertices[ face.c ] );\r\n\t\tvar v = [];\r\n\r\n\t\tvar materialIndex = face.materialIndex;\r\n\r\n\t\t// Construct all of the vertices for this subdivision.\r\n\r\n\t\tfor ( var i = 0 ; i <= cols; i ++ ) {\r\n\r\n\t\t\tv[ i ] = [];\r\n\r\n\t\t\tvar aj = prepare( a.clone().lerp( c, i / cols ) );\r\n\t\t\tvar bj = prepare( b.clone().lerp( c, i / cols ) );\r\n\t\t\tvar rows = cols - i;\r\n\r\n\t\t\tfor ( var j = 0; j <= rows; j ++ ) {\r\n\r\n\t\t\t\tif ( j === 0 && i === cols ) {\r\n\r\n\t\t\t\t\tv[ i ][ j ] = aj;\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tv[ i ][ j ] = prepare( aj.clone().lerp( bj, j / rows ) );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\t// Construct all of the faces.\r\n\r\n\t\tfor ( var i = 0; i < cols ; i ++ ) {\r\n\r\n\t\t\tfor ( var j = 0; j < 2 * ( cols - i ) - 1; j ++ ) {\r\n\r\n\t\t\t\tvar k = Math.floor( j / 2 );\r\n\r\n\t\t\t\tif ( j % 2 === 0 ) {\r\n\r\n\t\t\t\t\tmake(\r\n\t\t\t\t\t\tv[ i ][ k + 1 ],\r\n\t\t\t\t\t\tv[ i + 1 ][ k ],\r\n\t\t\t\t\t\tv[ i ][ k ],\r\n\t\t\t\t\t\tmaterialIndex\r\n\t\t\t\t\t);\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tmake(\r\n\t\t\t\t\t\tv[ i ][ k + 1 ],\r\n\t\t\t\t\t\tv[ i + 1 ][ k + 1 ],\r\n\t\t\t\t\t\tv[ i + 1 ][ k ],\r\n\t\t\t\t\t\tmaterialIndex\r\n\t\t\t\t\t);\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\r\n\t// Angle around the Y axis, counter-clockwise when looking from above.\r\n\r\n\tfunction azimuth( vector ) {\r\n\r\n\t\treturn Math.atan2( vector.z, - vector.x );\r\n\r\n\t}\r\n\r\n\r\n\t// Angle above the XZ plane.\r\n\r\n\tfunction inclination( vector ) {\r\n\r\n\t\treturn Math.atan2( - vector.y, Math.sqrt( ( vector.x * vector.x ) + ( vector.z * vector.z ) ) );\r\n\r\n\t}\r\n\r\n\r\n\t// Texture fixing helper. Spheres have some odd behaviours.\r\n\r\n\tfunction correctUV( uv, vector, azimuth ) {\r\n\r\n\t\tif ( ( azimuth < 0 ) && ( uv.x === 1 ) ) uv = new THREE.Vector2( uv.x - 1, uv.y );\r\n\t\tif ( ( vector.x === 0 ) && ( vector.z === 0 ) ) uv = new THREE.Vector2( azimuth / 2 / Math.PI + 0.5, uv.y );\r\n\t\treturn uv.clone();\r\n\r\n\t}\r\n\r\n\r\n};\r\n\r\nTHREE.PolyhedronGeometry.prototype = Object.create( THREE.Geometry.prototype );\r\nTHREE.PolyhedronGeometry.prototype.constructor = THREE.PolyhedronGeometry;\r\n\r\n// File:src/extras/geometries/DodecahedronGeometry.js\r\n\r\n/**\r\n * @author Abe Pazos / https://hamoid.com\r\n */\r\n\r\nTHREE.DodecahedronGeometry = function ( radius, detail ) {\r\n\r\n\tvar t = ( 1 + Math.sqrt( 5 ) ) / 2;\r\n\tvar r = 1 / t;\r\n\r\n\tvar vertices = [\r\n\r\n\t\t// (±1, ±1, ±1)\r\n\t\t- 1, - 1, - 1,    - 1, - 1,  1,\r\n\t\t- 1,  1, - 1,    - 1,  1,  1,\r\n\t\t 1, - 1, - 1,     1, - 1,  1,\r\n\t\t 1,  1, - 1,     1,  1,  1,\r\n\r\n\t\t// (0, ±1/φ, ±φ)\r\n\t\t 0, - r, - t,     0, - r,  t,\r\n\t\t 0,  r, - t,     0,  r,  t,\r\n\r\n\t\t// (±1/φ, ±φ, 0)\r\n\t\t- r, - t,  0,    - r,  t,  0,\r\n\t\t r, - t,  0,     r,  t,  0,\r\n\r\n\t\t// (±φ, 0, ±1/φ)\r\n\t\t- t,  0, - r,     t,  0, - r,\r\n\t\t- t,  0,  r,     t,  0,  r\r\n\t];\r\n\r\n\tvar indices = [\r\n\t\t 3, 11,  7,      3,  7, 15,      3, 15, 13,\r\n\t\t 7, 19, 17,      7, 17,  6,      7,  6, 15,\r\n\t\t17,  4,  8,     17,  8, 10,     17, 10,  6,\r\n\t\t 8,  0, 16,      8, 16,  2,      8,  2, 10,\r\n\t\t 0, 12,  1,      0,  1, 18,      0, 18, 16,\r\n\t\t 6, 10,  2,      6,  2, 13,      6, 13, 15,\r\n\t\t 2, 16, 18,      2, 18,  3,      2,  3, 13,\r\n\t\t18,  1,  9,     18,  9, 11,     18, 11,  3,\r\n\t\t 4, 14, 12,      4, 12,  0,      4,  0,  8,\r\n\t\t11,  9,  5,     11,  5, 19,     11, 19,  7,\r\n\t\t19,  5, 14,     19, 14,  4,     19,  4, 17,\r\n\t\t 1, 12, 14,      1, 14,  5,      1,  5,  9\r\n\t];\r\n\r\n\tTHREE.PolyhedronGeometry.call( this, vertices, indices, radius, detail );\r\n\r\n\tthis.type = 'DodecahedronGeometry';\r\n\r\n\tthis.parameters = {\r\n\t\tradius: radius,\r\n\t\tdetail: detail\r\n\t};\r\n\r\n};\r\n\r\nTHREE.DodecahedronGeometry.prototype = Object.create( THREE.PolyhedronGeometry.prototype );\r\nTHREE.DodecahedronGeometry.prototype.constructor = THREE.DodecahedronGeometry;\r\n\r\n// File:src/extras/geometries/IcosahedronGeometry.js\r\n\r\n/**\r\n * @author timothypratley / https://github.com/timothypratley\r\n */\r\n\r\nTHREE.IcosahedronGeometry = function ( radius, detail ) {\r\n\r\n\tvar t = ( 1 + Math.sqrt( 5 ) ) / 2;\r\n\r\n\tvar vertices = [\r\n\t\t- 1,  t,  0,    1,  t,  0,   - 1, - t,  0,    1, - t,  0,\r\n\t\t 0, - 1,  t,    0,  1,  t,    0, - 1, - t,    0,  1, - t,\r\n\t\t t,  0, - 1,    t,  0,  1,   - t,  0, - 1,   - t,  0,  1\r\n\t];\r\n\r\n\tvar indices = [\r\n\t\t 0, 11,  5,    0,  5,  1,    0,  1,  7,    0,  7, 10,    0, 10, 11,\r\n\t\t 1,  5,  9,    5, 11,  4,   11, 10,  2,   10,  7,  6,    7,  1,  8,\r\n\t\t 3,  9,  4,    3,  4,  2,    3,  2,  6,    3,  6,  8,    3,  8,  9,\r\n\t\t 4,  9,  5,    2,  4, 11,    6,  2, 10,    8,  6,  7,    9,  8,  1\r\n\t];\r\n\r\n\tTHREE.PolyhedronGeometry.call( this, vertices, indices, radius, detail );\r\n\r\n\tthis.type = 'IcosahedronGeometry';\r\n\r\n\tthis.parameters = {\r\n\t\tradius: radius,\r\n\t\tdetail: detail\r\n\t};\r\n\r\n};\r\n\r\nTHREE.IcosahedronGeometry.prototype = Object.create( THREE.PolyhedronGeometry.prototype );\r\nTHREE.IcosahedronGeometry.prototype.constructor = THREE.IcosahedronGeometry;\r\n\r\n// File:src/extras/geometries/OctahedronGeometry.js\r\n\r\n/**\r\n * @author timothypratley / https://github.com/timothypratley\r\n */\r\n\r\nTHREE.OctahedronGeometry = function ( radius, detail ) {\r\n\r\n\tvar vertices = [\r\n\t\t1, 0, 0,   - 1, 0, 0,    0, 1, 0,    0, - 1, 0,    0, 0, 1,    0, 0, - 1\r\n\t];\r\n\r\n\tvar indices = [\r\n\t\t0, 2, 4,    0, 4, 3,    0, 3, 5,    0, 5, 2,    1, 2, 5,    1, 5, 3,    1, 3, 4,    1, 4, 2\r\n\t];\r\n\r\n\tTHREE.PolyhedronGeometry.call( this, vertices, indices, radius, detail );\r\n\r\n\tthis.type = 'OctahedronGeometry';\r\n\r\n\tthis.parameters = {\r\n\t\tradius: radius,\r\n\t\tdetail: detail\r\n\t};\r\n\r\n};\r\n\r\nTHREE.OctahedronGeometry.prototype = Object.create( THREE.PolyhedronGeometry.prototype );\r\nTHREE.OctahedronGeometry.prototype.constructor = THREE.OctahedronGeometry;\r\n\r\n// File:src/extras/geometries/TetrahedronGeometry.js\r\n\r\n/**\r\n * @author timothypratley / https://github.com/timothypratley\r\n */\r\n\r\nTHREE.TetrahedronGeometry = function ( radius, detail ) {\r\n\r\n\tvar vertices = [\r\n\t\t 1,  1,  1,   - 1, - 1,  1,   - 1,  1, - 1,    1, - 1, - 1\r\n\t];\r\n\r\n\tvar indices = [\r\n\t\t 2,  1,  0,    0,  3,  2,    1,  3,  0,    2,  3,  1\r\n\t];\r\n\r\n\tTHREE.PolyhedronGeometry.call( this, vertices, indices, radius, detail );\r\n\r\n\tthis.type = 'TetrahedronGeometry';\r\n\r\n\tthis.parameters = {\r\n\t\tradius: radius,\r\n\t\tdetail: detail\r\n\t};\r\n\r\n};\r\n\r\nTHREE.TetrahedronGeometry.prototype = Object.create( THREE.PolyhedronGeometry.prototype );\r\nTHREE.TetrahedronGeometry.prototype.constructor = THREE.TetrahedronGeometry;\r\n\r\n// File:src/extras/geometries/ParametricGeometry.js\r\n\r\n/**\r\n * @author zz85 / https://github.com/zz85\r\n * Parametric Surfaces Geometry\r\n * based on the brilliant article by @prideout http://prideout.net/blog/?p=44\r\n *\r\n * new THREE.ParametricGeometry( parametricFunction, uSegments, ySegements );\r\n *\r\n */\r\n\r\nTHREE.ParametricGeometry = function ( func, slices, stacks ) {\r\n\r\n\tTHREE.Geometry.call( this );\r\n\r\n\tthis.type = 'ParametricGeometry';\r\n\r\n\tthis.parameters = {\r\n\t\tfunc: func,\r\n\t\tslices: slices,\r\n\t\tstacks: stacks\r\n\t};\r\n\r\n\tvar verts = this.vertices;\r\n\tvar faces = this.faces;\r\n\tvar uvs = this.faceVertexUvs[ 0 ];\r\n\r\n\tvar i, j, p;\r\n\tvar u, v;\r\n\r\n\tvar sliceCount = slices + 1;\r\n\r\n\tfor ( i = 0; i <= stacks; i ++ ) {\r\n\r\n\t\tv = i / stacks;\r\n\r\n\t\tfor ( j = 0; j <= slices; j ++ ) {\r\n\r\n\t\t\tu = j / slices;\r\n\r\n\t\t\tp = func( u, v );\r\n\t\t\tverts.push( p );\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tvar a, b, c, d;\r\n\tvar uva, uvb, uvc, uvd;\r\n\r\n\tfor ( i = 0; i < stacks; i ++ ) {\r\n\r\n\t\tfor ( j = 0; j < slices; j ++ ) {\r\n\r\n\t\t\ta = i * sliceCount + j;\r\n\t\t\tb = i * sliceCount + j + 1;\r\n\t\t\tc = ( i + 1 ) * sliceCount + j + 1;\r\n\t\t\td = ( i + 1 ) * sliceCount + j;\r\n\r\n\t\t\tuva = new THREE.Vector2( j / slices, i / stacks );\r\n\t\t\tuvb = new THREE.Vector2( ( j + 1 ) / slices, i / stacks );\r\n\t\t\tuvc = new THREE.Vector2( ( j + 1 ) / slices, ( i + 1 ) / stacks );\r\n\t\t\tuvd = new THREE.Vector2( j / slices, ( i + 1 ) / stacks );\r\n\r\n\t\t\tfaces.push( new THREE.Face3( a, b, d ) );\r\n\t\t\tuvs.push( [ uva, uvb, uvd ] );\r\n\r\n\t\t\tfaces.push( new THREE.Face3( b, c, d ) );\r\n\t\t\tuvs.push( [ uvb.clone(), uvc, uvd.clone() ] );\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t// console.log(this);\r\n\r\n\t// magic bullet\r\n\t// var diff = this.mergeVertices();\r\n\t// console.log('removed ', diff, ' vertices by merging');\r\n\r\n\tthis.computeFaceNormals();\r\n\tthis.computeVertexNormals();\r\n\r\n};\r\n\r\nTHREE.ParametricGeometry.prototype = Object.create( THREE.Geometry.prototype );\r\nTHREE.ParametricGeometry.prototype.constructor = THREE.ParametricGeometry;\r\n\r\n// File:src/extras/geometries/WireframeGeometry.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.WireframeGeometry = function ( geometry ) {\r\n\r\n\tTHREE.BufferGeometry.call( this );\r\n\r\n\tvar edge = [ 0, 0 ], hash = {};\r\n\r\n\tfunction sortFunction( a, b ) {\r\n\r\n\t\treturn a - b;\r\n\r\n\t}\r\n\r\n\tvar keys = [ 'a', 'b', 'c' ];\r\n\r\n\tif ( geometry instanceof THREE.Geometry ) {\r\n\r\n\t\tvar vertices = geometry.vertices;\r\n\t\tvar faces = geometry.faces;\r\n\t\tvar numEdges = 0;\r\n\r\n\t\t// allocate maximal size\r\n\t\tvar edges = new Uint32Array( 6 * faces.length );\r\n\r\n\t\tfor ( var i = 0, l = faces.length; i < l; i ++ ) {\r\n\r\n\t\t\tvar face = faces[ i ];\r\n\r\n\t\t\tfor ( var j = 0; j < 3; j ++ ) {\r\n\r\n\t\t\t\tedge[ 0 ] = face[ keys[ j ] ];\r\n\t\t\t\tedge[ 1 ] = face[ keys[ ( j + 1 ) % 3 ] ];\r\n\t\t\t\tedge.sort( sortFunction );\r\n\r\n\t\t\t\tvar key = edge.toString();\r\n\r\n\t\t\t\tif ( hash[ key ] === undefined ) {\r\n\r\n\t\t\t\t\tedges[ 2 * numEdges ] = edge[ 0 ];\r\n\t\t\t\t\tedges[ 2 * numEdges + 1 ] = edge[ 1 ];\r\n\t\t\t\t\thash[ key ] = true;\r\n\t\t\t\t\tnumEdges ++;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tvar coords = new Float32Array( numEdges * 2 * 3 );\r\n\r\n\t\tfor ( var i = 0, l = numEdges; i < l; i ++ ) {\r\n\r\n\t\t\tfor ( var j = 0; j < 2; j ++ ) {\r\n\r\n\t\t\t\tvar vertex = vertices[ edges [ 2 * i + j ] ];\r\n\r\n\t\t\t\tvar index = 6 * i + 3 * j;\r\n\t\t\t\tcoords[ index + 0 ] = vertex.x;\r\n\t\t\t\tcoords[ index + 1 ] = vertex.y;\r\n\t\t\t\tcoords[ index + 2 ] = vertex.z;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tthis.addAttribute( 'position', new THREE.BufferAttribute( coords, 3 ) );\r\n\r\n\t} else if ( geometry instanceof THREE.BufferGeometry ) {\r\n\r\n\t\tif ( geometry.index !== null ) {\r\n\r\n\t\t\t// Indexed BufferGeometry\r\n\r\n\t\t\tvar indices = geometry.index.array;\r\n\t\t\tvar vertices = geometry.attributes.position;\r\n\t\t\tvar groups = geometry.groups;\r\n\t\t\tvar numEdges = 0;\r\n\r\n\t\t\tif ( groups.length === 0 ) {\r\n\r\n\t\t\t\tgeometry.addGroup( 0, indices.length );\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// allocate maximal size\r\n\t\t\tvar edges = new Uint32Array( 2 * indices.length );\r\n\r\n\t\t\tfor ( var o = 0, ol = groups.length; o < ol; ++ o ) {\r\n\r\n\t\t\t\tvar group = groups[ o ];\r\n\r\n\t\t\t\tvar start = group.start;\r\n\t\t\t\tvar count = group.count;\r\n\r\n\t\t\t\tfor ( var i = start, il = start + count; i < il; i += 3 ) {\r\n\r\n\t\t\t\t\tfor ( var j = 0; j < 3; j ++ ) {\r\n\r\n\t\t\t\t\t\tedge[ 0 ] = indices[ i + j ];\r\n\t\t\t\t\t\tedge[ 1 ] = indices[ i + ( j + 1 ) % 3 ];\r\n\t\t\t\t\t\tedge.sort( sortFunction );\r\n\r\n\t\t\t\t\t\tvar key = edge.toString();\r\n\r\n\t\t\t\t\t\tif ( hash[ key ] === undefined ) {\r\n\r\n\t\t\t\t\t\t\tedges[ 2 * numEdges ] = edge[ 0 ];\r\n\t\t\t\t\t\t\tedges[ 2 * numEdges + 1 ] = edge[ 1 ];\r\n\t\t\t\t\t\t\thash[ key ] = true;\r\n\t\t\t\t\t\t\tnumEdges ++;\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar coords = new Float32Array( numEdges * 2 * 3 );\r\n\r\n\t\t\tfor ( var i = 0, l = numEdges; i < l; i ++ ) {\r\n\r\n\t\t\t\tfor ( var j = 0; j < 2; j ++ ) {\r\n\r\n\t\t\t\t\tvar index = 6 * i + 3 * j;\r\n\t\t\t\t\tvar index2 = edges[ 2 * i + j ];\r\n\r\n\t\t\t\t\tcoords[ index + 0 ] = vertices.getX( index2 );\r\n\t\t\t\t\tcoords[ index + 1 ] = vertices.getY( index2 );\r\n\t\t\t\t\tcoords[ index + 2 ] = vertices.getZ( index2 );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tthis.addAttribute( 'position', new THREE.BufferAttribute( coords, 3 ) );\r\n\r\n\t\t} else {\r\n\r\n\t\t\t// non-indexed BufferGeometry\r\n\r\n\t\t\tvar vertices = geometry.attributes.position.array;\r\n\t\t\tvar numEdges = vertices.length / 3;\r\n\t\t\tvar numTris = numEdges / 3;\r\n\r\n\t\t\tvar coords = new Float32Array( numEdges * 2 * 3 );\r\n\r\n\t\t\tfor ( var i = 0, l = numTris; i < l; i ++ ) {\r\n\r\n\t\t\t\tfor ( var j = 0; j < 3; j ++ ) {\r\n\r\n\t\t\t\t\tvar index = 18 * i + 6 * j;\r\n\r\n\t\t\t\t\tvar index1 = 9 * i + 3 * j;\r\n\t\t\t\t\tcoords[ index + 0 ] = vertices[ index1 ];\r\n\t\t\t\t\tcoords[ index + 1 ] = vertices[ index1 + 1 ];\r\n\t\t\t\t\tcoords[ index + 2 ] = vertices[ index1 + 2 ];\r\n\r\n\t\t\t\t\tvar index2 = 9 * i + 3 * ( ( j + 1 ) % 3 );\r\n\t\t\t\t\tcoords[ index + 3 ] = vertices[ index2 ];\r\n\t\t\t\t\tcoords[ index + 4 ] = vertices[ index2 + 1 ];\r\n\t\t\t\t\tcoords[ index + 5 ] = vertices[ index2 + 2 ];\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tthis.addAttribute( 'position', new THREE.BufferAttribute( coords, 3 ) );\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n};\r\n\r\nTHREE.WireframeGeometry.prototype = Object.create( THREE.BufferGeometry.prototype );\r\nTHREE.WireframeGeometry.prototype.constructor = THREE.WireframeGeometry;\r\n\r\n// File:src/extras/helpers/AxisHelper.js\r\n\r\n/**\r\n * @author sroucheray / http://sroucheray.org/\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.AxisHelper = function ( size ) {\r\n\r\n\tsize = size || 1;\r\n\r\n\tvar vertices = new Float32Array( [\r\n\t\t0, 0, 0,  size, 0, 0,\r\n\t\t0, 0, 0,  0, size, 0,\r\n\t\t0, 0, 0,  0, 0, size\r\n\t] );\r\n\r\n\tvar colors = new Float32Array( [\r\n\t\t1, 0, 0,  1, 0.6, 0,\r\n\t\t0, 1, 0,  0.6, 1, 0,\r\n\t\t0, 0, 1,  0, 0.6, 1\r\n\t] );\r\n\r\n\tvar geometry = new THREE.BufferGeometry();\r\n\tgeometry.addAttribute( 'position', new THREE.BufferAttribute( vertices, 3 ) );\r\n\tgeometry.addAttribute( 'color', new THREE.BufferAttribute( colors, 3 ) );\r\n\r\n\tvar material = new THREE.LineBasicMaterial( { vertexColors: THREE.VertexColors } );\r\n\r\n\tTHREE.LineSegments.call( this, geometry, material );\r\n\r\n};\r\n\r\nTHREE.AxisHelper.prototype = Object.create( THREE.LineSegments.prototype );\r\nTHREE.AxisHelper.prototype.constructor = THREE.AxisHelper;\r\n\r\n// File:src/extras/helpers/ArrowHelper.js\r\n\r\n/**\r\n * @author WestLangley / http://github.com/WestLangley\r\n * @author zz85 / http://github.com/zz85\r\n * @author bhouston / http://clara.io\r\n *\r\n * Creates an arrow for visualizing directions\r\n *\r\n * Parameters:\r\n *  dir - Vector3\r\n *  origin - Vector3\r\n *  length - Number\r\n *  color - color in hex value\r\n *  headLength - Number\r\n *  headWidth - Number\r\n */\r\n\r\nTHREE.ArrowHelper = ( function () {\r\n\r\n\tvar lineGeometry = new THREE.Geometry();\r\n\tlineGeometry.vertices.push( new THREE.Vector3( 0, 0, 0 ), new THREE.Vector3( 0, 1, 0 ) );\r\n\r\n\tvar coneGeometry = new THREE.CylinderGeometry( 0, 0.5, 1, 5, 1 );\r\n\tconeGeometry.translate( 0, - 0.5, 0 );\r\n\r\n\treturn function ArrowHelper( dir, origin, length, color, headLength, headWidth ) {\r\n\r\n\t\t// dir is assumed to be normalized\r\n\r\n\t\tTHREE.Object3D.call( this );\r\n\r\n\t\tif ( color === undefined ) color = 0xffff00;\r\n\t\tif ( length === undefined ) length = 1;\r\n\t\tif ( headLength === undefined ) headLength = 0.2 * length;\r\n\t\tif ( headWidth === undefined ) headWidth = 0.2 * headLength;\r\n\r\n\t\tthis.position.copy( origin );\r\n\t\t\r\n\t\tthis.line = new THREE.Line( lineGeometry, new THREE.LineBasicMaterial( { color: color } ) );\r\n\t\tthis.line.matrixAutoUpdate = false;\r\n\t\tthis.add( this.line );\r\n\r\n\t\tthis.cone = new THREE.Mesh( coneGeometry, new THREE.MeshBasicMaterial( { color: color } ) );\r\n\t\tthis.cone.matrixAutoUpdate = false;\r\n\t\tthis.add( this.cone );\r\n\r\n\t\tthis.setDirection( dir );\r\n\t\tthis.setLength( length, headLength, headWidth );\r\n\r\n\t}\r\n\r\n}() );\r\n\r\nTHREE.ArrowHelper.prototype = Object.create( THREE.Object3D.prototype );\r\nTHREE.ArrowHelper.prototype.constructor = THREE.ArrowHelper;\r\n\r\nTHREE.ArrowHelper.prototype.setDirection = ( function () {\r\n\r\n\tvar axis = new THREE.Vector3();\r\n\tvar radians;\r\n\r\n\treturn function setDirection( dir ) {\r\n\r\n\t\t// dir is assumed to be normalized\r\n\r\n\t\tif ( dir.y > 0.99999 ) {\r\n\r\n\t\t\tthis.quaternion.set( 0, 0, 0, 1 );\r\n\r\n\t\t} else if ( dir.y < - 0.99999 ) {\r\n\r\n\t\t\tthis.quaternion.set( 1, 0, 0, 0 );\r\n\r\n\t\t} else {\r\n\r\n\t\t\taxis.set( dir.z, 0, - dir.x ).normalize();\r\n\r\n\t\t\tradians = Math.acos( dir.y );\r\n\r\n\t\t\tthis.quaternion.setFromAxisAngle( axis, radians );\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n}() );\r\n\r\nTHREE.ArrowHelper.prototype.setLength = function ( length, headLength, headWidth ) {\r\n\r\n\tif ( headLength === undefined ) headLength = 0.2 * length;\r\n\tif ( headWidth === undefined ) headWidth = 0.2 * headLength;\r\n\r\n\tthis.line.scale.set( 1, Math.max( 0, length - headLength ), 1 );\r\n\tthis.line.updateMatrix();\r\n\r\n\tthis.cone.scale.set( headWidth, headLength, headWidth );\r\n\tthis.cone.position.y = length;\r\n\tthis.cone.updateMatrix();\r\n\r\n};\r\n\r\nTHREE.ArrowHelper.prototype.setColor = function ( color ) {\r\n\r\n\tthis.line.material.color.set( color );\r\n\tthis.cone.material.color.set( color );\r\n\r\n};\r\n\r\n// File:src/extras/helpers/BoxHelper.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.BoxHelper = function ( object ) {\r\n\r\n\tvar indices = new Uint16Array( [ 0, 1, 1, 2, 2, 3, 3, 0, 4, 5, 5, 6, 6, 7, 7, 4, 0, 4, 1, 5, 2, 6, 3, 7 ] );\r\n\tvar positions = new Float32Array( 8 * 3 );\r\n\r\n\tvar geometry = new THREE.BufferGeometry();\r\n\tgeometry.setIndex( new THREE.BufferAttribute( indices, 1 ) );\r\n\tgeometry.addAttribute( 'position', new THREE.BufferAttribute( positions, 3 ) );\r\n\r\n\tTHREE.LineSegments.call( this, geometry, new THREE.LineBasicMaterial( { color: 0xffff00 } ) );\r\n\r\n\tif ( object !== undefined ) {\r\n\r\n\t\tthis.update( object );\r\n\r\n\t}\r\n\r\n};\r\n\r\nTHREE.BoxHelper.prototype = Object.create( THREE.LineSegments.prototype );\r\nTHREE.BoxHelper.prototype.constructor = THREE.BoxHelper;\r\n\r\nTHREE.BoxHelper.prototype.update = ( function () {\r\n\r\n\tvar box = new THREE.Box3();\r\n\r\n\treturn function ( object ) {\r\n\r\n\t\tif ( object instanceof THREE.Box3 ) {\r\n\r\n\t\t\tbox.copy( object );\r\n\r\n\t\t} else {\r\n\r\n\t\t\tbox.setFromObject( object );\r\n\r\n\t\t}\r\n\r\n\t\tif ( box.isEmpty() ) return;\r\n\r\n\t\tvar min = box.min;\r\n\t\tvar max = box.max;\r\n\r\n\t\t/*\r\n\t\t  5____4\r\n\t\t1/___0/|\r\n\t\t| 6__|_7\r\n\t\t2/___3/\r\n\r\n\t\t0: max.x, max.y, max.z\r\n\t\t1: min.x, max.y, max.z\r\n\t\t2: min.x, min.y, max.z\r\n\t\t3: max.x, min.y, max.z\r\n\t\t4: max.x, max.y, min.z\r\n\t\t5: min.x, max.y, min.z\r\n\t\t6: min.x, min.y, min.z\r\n\t\t7: max.x, min.y, min.z\r\n\t\t*/\r\n\r\n\t\tvar position = this.geometry.attributes.position;\r\n\t\tvar array = position.array;\r\n\r\n\t\tarray[  0 ] = max.x; array[  1 ] = max.y; array[  2 ] = max.z;\r\n\t\tarray[  3 ] = min.x; array[  4 ] = max.y; array[  5 ] = max.z;\r\n\t\tarray[  6 ] = min.x; array[  7 ] = min.y; array[  8 ] = max.z;\r\n\t\tarray[  9 ] = max.x; array[ 10 ] = min.y; array[ 11 ] = max.z;\r\n\t\tarray[ 12 ] = max.x; array[ 13 ] = max.y; array[ 14 ] = min.z;\r\n\t\tarray[ 15 ] = min.x; array[ 16 ] = max.y; array[ 17 ] = min.z;\r\n\t\tarray[ 18 ] = min.x; array[ 19 ] = min.y; array[ 20 ] = min.z;\r\n\t\tarray[ 21 ] = max.x; array[ 22 ] = min.y; array[ 23 ] = min.z;\r\n\r\n\t\tposition.needsUpdate = true;\r\n\r\n\t\tthis.geometry.computeBoundingSphere();\r\n\r\n\t};\r\n\r\n} )();\r\n\r\n// File:src/extras/helpers/BoundingBoxHelper.js\r\n\r\n/**\r\n * @author WestLangley / http://github.com/WestLangley\r\n */\r\n\r\n// a helper to show the world-axis-aligned bounding box for an object\r\n\r\nTHREE.BoundingBoxHelper = function ( object, hex ) {\r\n\r\n\tvar color = ( hex !== undefined ) ? hex : 0x888888;\r\n\r\n\tthis.object = object;\r\n\r\n\tthis.box = new THREE.Box3();\r\n\r\n\tTHREE.Mesh.call( this, new THREE.BoxGeometry( 1, 1, 1 ), new THREE.MeshBasicMaterial( { color: color, wireframe: true } ) );\r\n\r\n};\r\n\r\nTHREE.BoundingBoxHelper.prototype = Object.create( THREE.Mesh.prototype );\r\nTHREE.BoundingBoxHelper.prototype.constructor = THREE.BoundingBoxHelper;\r\n\r\nTHREE.BoundingBoxHelper.prototype.update = function () {\r\n\r\n\tthis.box.setFromObject( this.object );\r\n\r\n\tthis.box.size( this.scale );\r\n\r\n\tthis.box.center( this.position );\r\n\r\n};\r\n\r\n// File:src/extras/helpers/CameraHelper.js\r\n\r\n/**\r\n * @author alteredq / http://alteredqualia.com/\r\n *\r\n *\t- shows frustum, line of sight and up of the camera\r\n *\t- suitable for fast updates\r\n * \t- based on frustum visualization in lightgl.js shadowmap example\r\n *\t\thttp://evanw.github.com/lightgl.js/tests/shadowmap.html\r\n */\r\n\r\nTHREE.CameraHelper = function ( camera ) {\r\n\r\n\tvar geometry = new THREE.Geometry();\r\n\tvar material = new THREE.LineBasicMaterial( { color: 0xffffff, vertexColors: THREE.FaceColors } );\r\n\r\n\tvar pointMap = {};\r\n\r\n\t// colors\r\n\r\n\tvar hexFrustum = 0xffaa00;\r\n\tvar hexCone = 0xff0000;\r\n\tvar hexUp = 0x00aaff;\r\n\tvar hexTarget = 0xffffff;\r\n\tvar hexCross = 0x333333;\r\n\r\n\t// near\r\n\r\n\taddLine( \"n1\", \"n2\", hexFrustum );\r\n\taddLine( \"n2\", \"n4\", hexFrustum );\r\n\taddLine( \"n4\", \"n3\", hexFrustum );\r\n\taddLine( \"n3\", \"n1\", hexFrustum );\r\n\r\n\t// far\r\n\r\n\taddLine( \"f1\", \"f2\", hexFrustum );\r\n\taddLine( \"f2\", \"f4\", hexFrustum );\r\n\taddLine( \"f4\", \"f3\", hexFrustum );\r\n\taddLine( \"f3\", \"f1\", hexFrustum );\r\n\r\n\t// sides\r\n\r\n\taddLine( \"n1\", \"f1\", hexFrustum );\r\n\taddLine( \"n2\", \"f2\", hexFrustum );\r\n\taddLine( \"n3\", \"f3\", hexFrustum );\r\n\taddLine( \"n4\", \"f4\", hexFrustum );\r\n\r\n\t// cone\r\n\r\n\taddLine( \"p\", \"n1\", hexCone );\r\n\taddLine( \"p\", \"n2\", hexCone );\r\n\taddLine( \"p\", \"n3\", hexCone );\r\n\taddLine( \"p\", \"n4\", hexCone );\r\n\r\n\t// up\r\n\r\n\taddLine( \"u1\", \"u2\", hexUp );\r\n\taddLine( \"u2\", \"u3\", hexUp );\r\n\taddLine( \"u3\", \"u1\", hexUp );\r\n\r\n\t// target\r\n\r\n\taddLine( \"c\", \"t\", hexTarget );\r\n\taddLine( \"p\", \"c\", hexCross );\r\n\r\n\t// cross\r\n\r\n\taddLine( \"cn1\", \"cn2\", hexCross );\r\n\taddLine( \"cn3\", \"cn4\", hexCross );\r\n\r\n\taddLine( \"cf1\", \"cf2\", hexCross );\r\n\taddLine( \"cf3\", \"cf4\", hexCross );\r\n\r\n\tfunction addLine( a, b, hex ) {\r\n\r\n\t\taddPoint( a, hex );\r\n\t\taddPoint( b, hex );\r\n\r\n\t}\r\n\r\n\tfunction addPoint( id, hex ) {\r\n\r\n\t\tgeometry.vertices.push( new THREE.Vector3() );\r\n\t\tgeometry.colors.push( new THREE.Color( hex ) );\r\n\r\n\t\tif ( pointMap[ id ] === undefined ) {\r\n\r\n\t\t\tpointMap[ id ] = [];\r\n\r\n\t\t}\r\n\r\n\t\tpointMap[ id ].push( geometry.vertices.length - 1 );\r\n\r\n\t}\r\n\r\n\tTHREE.LineSegments.call( this, geometry, material );\r\n\r\n\tthis.camera = camera;\r\n\tthis.camera.updateProjectionMatrix();\r\n\r\n\tthis.matrix = camera.matrixWorld;\r\n\tthis.matrixAutoUpdate = false;\r\n\r\n\tthis.pointMap = pointMap;\r\n\r\n\tthis.update();\r\n\r\n};\r\n\r\nTHREE.CameraHelper.prototype = Object.create( THREE.LineSegments.prototype );\r\nTHREE.CameraHelper.prototype.constructor = THREE.CameraHelper;\r\n\r\nTHREE.CameraHelper.prototype.update = function () {\r\n\r\n\tvar geometry, pointMap;\r\n\r\n\tvar vector = new THREE.Vector3();\r\n\tvar camera = new THREE.Camera();\r\n\r\n\tfunction setPoint( point, x, y, z ) {\r\n\r\n\t\tvector.set( x, y, z ).unproject( camera );\r\n\r\n\t\tvar points = pointMap[ point ];\r\n\r\n\t\tif ( points !== undefined ) {\r\n\r\n\t\t\tfor ( var i = 0, il = points.length; i < il; i ++ ) {\r\n\r\n\t\t\t\tgeometry.vertices[ points[ i ] ].copy( vector );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\treturn function () {\r\n\r\n\t\tgeometry = this.geometry;\r\n\t\tpointMap = this.pointMap;\r\n\r\n\t\tvar w = 1, h = 1;\r\n\r\n\t\t// we need just camera projection matrix\r\n\t\t// world matrix must be identity\r\n\r\n\t\tcamera.projectionMatrix.copy( this.camera.projectionMatrix );\r\n\r\n\t\t// center / target\r\n\r\n\t\tsetPoint( \"c\", 0, 0, - 1 );\r\n\t\tsetPoint( \"t\", 0, 0,  1 );\r\n\r\n\t\t// near\r\n\r\n\t\tsetPoint( \"n1\", - w, - h, - 1 );\r\n\t\tsetPoint( \"n2\",   w, - h, - 1 );\r\n\t\tsetPoint( \"n3\", - w,   h, - 1 );\r\n\t\tsetPoint( \"n4\",   w,   h, - 1 );\r\n\r\n\t\t// far\r\n\r\n\t\tsetPoint( \"f1\", - w, - h, 1 );\r\n\t\tsetPoint( \"f2\",   w, - h, 1 );\r\n\t\tsetPoint( \"f3\", - w,   h, 1 );\r\n\t\tsetPoint( \"f4\",   w,   h, 1 );\r\n\r\n\t\t// up\r\n\r\n\t\tsetPoint( \"u1\",   w * 0.7, h * 1.1, - 1 );\r\n\t\tsetPoint( \"u2\", - w * 0.7, h * 1.1, - 1 );\r\n\t\tsetPoint( \"u3\",         0, h * 2,   - 1 );\r\n\r\n\t\t// cross\r\n\r\n\t\tsetPoint( \"cf1\", - w,   0, 1 );\r\n\t\tsetPoint( \"cf2\",   w,   0, 1 );\r\n\t\tsetPoint( \"cf3\",   0, - h, 1 );\r\n\t\tsetPoint( \"cf4\",   0,   h, 1 );\r\n\r\n\t\tsetPoint( \"cn1\", - w,   0, - 1 );\r\n\t\tsetPoint( \"cn2\",   w,   0, - 1 );\r\n\t\tsetPoint( \"cn3\",   0, - h, - 1 );\r\n\t\tsetPoint( \"cn4\",   0,   h, - 1 );\r\n\r\n\t\tgeometry.verticesNeedUpdate = true;\r\n\r\n\t};\r\n\r\n}();\r\n\r\n// File:src/extras/helpers/DirectionalLightHelper.js\r\n\r\n/**\r\n * @author alteredq / http://alteredqualia.com/\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author WestLangley / http://github.com/WestLangley\r\n */\r\n\r\nTHREE.DirectionalLightHelper = function ( light, size ) {\r\n\r\n\tTHREE.Object3D.call( this );\r\n\r\n\tthis.light = light;\r\n\tthis.light.updateMatrixWorld();\r\n\r\n\tthis.matrix = light.matrixWorld;\r\n\tthis.matrixAutoUpdate = false;\r\n\r\n\tsize = size || 1;\r\n\r\n\tvar geometry = new THREE.Geometry();\r\n\tgeometry.vertices.push(\r\n\t\tnew THREE.Vector3( - size,   size, 0 ),\r\n\t\tnew THREE.Vector3(   size,   size, 0 ),\r\n\t\tnew THREE.Vector3(   size, - size, 0 ),\r\n\t\tnew THREE.Vector3( - size, - size, 0 ),\r\n\t\tnew THREE.Vector3( - size,   size, 0 )\r\n\t);\r\n\r\n\tvar material = new THREE.LineBasicMaterial( { fog: false } );\r\n\tmaterial.color.copy( this.light.color ).multiplyScalar( this.light.intensity );\r\n\r\n\tthis.lightPlane = new THREE.Line( geometry, material );\r\n\tthis.add( this.lightPlane );\r\n\r\n\tgeometry = new THREE.Geometry();\r\n\tgeometry.vertices.push(\r\n\t\tnew THREE.Vector3(),\r\n\t\tnew THREE.Vector3()\r\n\t);\r\n\r\n\tmaterial = new THREE.LineBasicMaterial( { fog: false } );\r\n\tmaterial.color.copy( this.light.color ).multiplyScalar( this.light.intensity );\r\n\r\n\tthis.targetLine = new THREE.Line( geometry, material );\r\n\tthis.add( this.targetLine );\r\n\r\n\tthis.update();\r\n\r\n};\r\n\r\nTHREE.DirectionalLightHelper.prototype = Object.create( THREE.Object3D.prototype );\r\nTHREE.DirectionalLightHelper.prototype.constructor = THREE.DirectionalLightHelper;\r\n\r\nTHREE.DirectionalLightHelper.prototype.dispose = function () {\r\n\r\n\tthis.lightPlane.geometry.dispose();\r\n\tthis.lightPlane.material.dispose();\r\n\tthis.targetLine.geometry.dispose();\r\n\tthis.targetLine.material.dispose();\r\n\r\n};\r\n\r\nTHREE.DirectionalLightHelper.prototype.update = function () {\r\n\r\n\tvar v1 = new THREE.Vector3();\r\n\tvar v2 = new THREE.Vector3();\r\n\tvar v3 = new THREE.Vector3();\r\n\r\n\treturn function () {\r\n\r\n\t\tv1.setFromMatrixPosition( this.light.matrixWorld );\r\n\t\tv2.setFromMatrixPosition( this.light.target.matrixWorld );\r\n\t\tv3.subVectors( v2, v1 );\r\n\r\n\t\tthis.lightPlane.lookAt( v3 );\r\n\t\tthis.lightPlane.material.color.copy( this.light.color ).multiplyScalar( this.light.intensity );\r\n\r\n\t\tthis.targetLine.geometry.vertices[ 1 ].copy( v3 );\r\n\t\tthis.targetLine.geometry.verticesNeedUpdate = true;\r\n\t\tthis.targetLine.material.color.copy( this.lightPlane.material.color );\r\n\r\n\t};\r\n\r\n}();\r\n\r\n// File:src/extras/helpers/EdgesHelper.js\r\n\r\n/**\r\n * @author WestLangley / http://github.com/WestLangley\r\n * @param object THREE.Mesh whose geometry will be used\r\n * @param hex line color\r\n * @param thresholdAngle the minimum angle (in degrees),\r\n * between the face normals of adjacent faces,\r\n * that is required to render an edge. A value of 10 means\r\n * an edge is only rendered if the angle is at least 10 degrees.\r\n */\r\n\r\nTHREE.EdgesHelper = function ( object, hex, thresholdAngle ) {\r\n\r\n\tvar color = ( hex !== undefined ) ? hex : 0xffffff;\r\n\r\n\tTHREE.LineSegments.call( this, new THREE.EdgesGeometry( object.geometry, thresholdAngle ), new THREE.LineBasicMaterial( { color: color } ) );\r\n\r\n\tthis.matrix = object.matrixWorld;\r\n\tthis.matrixAutoUpdate = false;\r\n\r\n};\r\n\r\nTHREE.EdgesHelper.prototype = Object.create( THREE.LineSegments.prototype );\r\nTHREE.EdgesHelper.prototype.constructor = THREE.EdgesHelper;\r\n\r\n// File:src/extras/helpers/FaceNormalsHelper.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author WestLangley / http://github.com/WestLangley\r\n*/\r\n\r\nTHREE.FaceNormalsHelper = function ( object, size, hex, linewidth ) {\r\n\r\n\t// FaceNormalsHelper only supports THREE.Geometry\r\n\r\n\tthis.object = object;\r\n\r\n\tthis.size = ( size !== undefined ) ? size : 1;\r\n\r\n\tvar color = ( hex !== undefined ) ? hex : 0xffff00;\r\n\r\n\tvar width = ( linewidth !== undefined ) ? linewidth : 1;\r\n\r\n\t//\r\n\r\n\tvar nNormals = 0;\r\n\r\n\tvar objGeometry = this.object.geometry;\r\n\r\n\tif ( objGeometry instanceof THREE.Geometry ) {\r\n\r\n\t\tnNormals = objGeometry.faces.length;\r\n\r\n\t} else {\r\n\r\n\t\tconsole.warn( 'THREE.FaceNormalsHelper: only THREE.Geometry is supported. Use THREE.VertexNormalsHelper, instead.' );\r\n\r\n\t}\r\n\r\n\t//\r\n\r\n\tvar geometry = new THREE.BufferGeometry();\r\n\r\n\tvar positions = new THREE.Float32Attribute( nNormals * 2 * 3, 3 );\r\n\r\n\tgeometry.addAttribute( 'position', positions );\r\n\r\n\tTHREE.LineSegments.call( this, geometry, new THREE.LineBasicMaterial( { color: color, linewidth: width } ) );\r\n\r\n\t//\r\n\r\n\tthis.matrixAutoUpdate = false;\r\n\tthis.update();\r\n\r\n};\r\n\r\nTHREE.FaceNormalsHelper.prototype = Object.create( THREE.LineSegments.prototype );\r\nTHREE.FaceNormalsHelper.prototype.constructor = THREE.FaceNormalsHelper;\r\n\r\nTHREE.FaceNormalsHelper.prototype.update = ( function () {\r\n\r\n\tvar v1 = new THREE.Vector3();\r\n\tvar v2 = new THREE.Vector3();\r\n\tvar normalMatrix = new THREE.Matrix3();\r\n\r\n\treturn function update() {\r\n\r\n\t\tthis.object.updateMatrixWorld( true );\r\n\r\n\t\tnormalMatrix.getNormalMatrix( this.object.matrixWorld );\r\n\r\n\t\tvar matrixWorld = this.object.matrixWorld;\r\n\r\n\t\tvar position = this.geometry.attributes.position;\r\n\r\n\t\t//\r\n\r\n\t\tvar objGeometry = this.object.geometry;\r\n\r\n\t\tvar vertices = objGeometry.vertices;\r\n\r\n\t\tvar faces = objGeometry.faces;\r\n\r\n\t\tvar idx = 0;\r\n\r\n\t\tfor ( var i = 0, l = faces.length; i < l; i ++ ) {\r\n\r\n\t\t\tvar face = faces[ i ];\r\n\r\n\t\t\tvar normal = face.normal;\r\n\r\n\t\t\tv1.copy( vertices[ face.a ] )\r\n\t\t\t\t.add( vertices[ face.b ] )\r\n\t\t\t\t.add( vertices[ face.c ] )\r\n\t\t\t\t.divideScalar( 3 )\r\n\t\t\t\t.applyMatrix4( matrixWorld );\r\n\r\n\t\t\tv2.copy( normal ).applyMatrix3( normalMatrix ).normalize().multiplyScalar( this.size ).add( v1 );\r\n\r\n\t\t\tposition.setXYZ( idx, v1.x, v1.y, v1.z );\r\n\r\n\t\t\tidx = idx + 1;\r\n\r\n\t\t\tposition.setXYZ( idx, v2.x, v2.y, v2.z );\r\n\r\n\t\t\tidx = idx + 1;\r\n\r\n\t\t}\r\n\r\n\t\tposition.needsUpdate = true;\r\n\r\n\t\treturn this;\r\n\r\n\t}\r\n\r\n}() );\r\n\r\n// File:src/extras/helpers/GridHelper.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.GridHelper = function ( size, step ) {\r\n\r\n\tvar geometry = new THREE.Geometry();\r\n\tvar material = new THREE.LineBasicMaterial( { vertexColors: THREE.VertexColors } );\r\n\r\n\tthis.color1 = new THREE.Color( 0x444444 );\r\n\tthis.color2 = new THREE.Color( 0x888888 );\r\n\r\n\tfor ( var i = - size; i <= size; i += step ) {\r\n\r\n\t\tgeometry.vertices.push(\r\n\t\t\tnew THREE.Vector3( - size, 0, i ), new THREE.Vector3( size, 0, i ),\r\n\t\t\tnew THREE.Vector3( i, 0, - size ), new THREE.Vector3( i, 0, size )\r\n\t\t);\r\n\r\n\t\tvar color = i === 0 ? this.color1 : this.color2;\r\n\r\n\t\tgeometry.colors.push( color, color, color, color );\r\n\r\n\t}\r\n\r\n\tTHREE.LineSegments.call( this, geometry, material );\r\n\r\n};\r\n\r\nTHREE.GridHelper.prototype = Object.create( THREE.LineSegments.prototype );\r\nTHREE.GridHelper.prototype.constructor = THREE.GridHelper;\r\n\r\nTHREE.GridHelper.prototype.setColors = function( colorCenterLine, colorGrid ) {\r\n\r\n\tthis.color1.set( colorCenterLine );\r\n\tthis.color2.set( colorGrid );\r\n\r\n\tthis.geometry.colorsNeedUpdate = true;\r\n\r\n};\r\n\r\n// File:src/extras/helpers/HemisphereLightHelper.js\r\n\r\n/**\r\n * @author alteredq / http://alteredqualia.com/\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.HemisphereLightHelper = function ( light, sphereSize ) {\r\n\r\n\tTHREE.Object3D.call( this );\r\n\r\n\tthis.light = light;\r\n\tthis.light.updateMatrixWorld();\r\n\r\n\tthis.matrix = light.matrixWorld;\r\n\tthis.matrixAutoUpdate = false;\r\n\r\n\tthis.colors = [ new THREE.Color(), new THREE.Color() ];\r\n\r\n\tvar geometry = new THREE.SphereGeometry( sphereSize, 4, 2 );\r\n\tgeometry.rotateX( - Math.PI / 2 );\r\n\r\n\tfor ( var i = 0, il = 8; i < il; i ++ ) {\r\n\r\n\t\tgeometry.faces[ i ].color = this.colors[ i < 4 ? 0 : 1 ];\r\n\r\n\t}\r\n\r\n\tvar material = new THREE.MeshBasicMaterial( { vertexColors: THREE.FaceColors, wireframe: true } );\r\n\r\n\tthis.lightSphere = new THREE.Mesh( geometry, material );\r\n\tthis.add( this.lightSphere );\r\n\r\n\tthis.update();\r\n\r\n};\r\n\r\nTHREE.HemisphereLightHelper.prototype = Object.create( THREE.Object3D.prototype );\r\nTHREE.HemisphereLightHelper.prototype.constructor = THREE.HemisphereLightHelper;\r\n\r\nTHREE.HemisphereLightHelper.prototype.dispose = function () {\r\n\r\n\tthis.lightSphere.geometry.dispose();\r\n\tthis.lightSphere.material.dispose();\r\n\r\n};\r\n\r\nTHREE.HemisphereLightHelper.prototype.update = function () {\r\n\r\n\tvar vector = new THREE.Vector3();\r\n\r\n\treturn function () {\r\n\r\n\t\tthis.colors[ 0 ].copy( this.light.color ).multiplyScalar( this.light.intensity );\r\n\t\tthis.colors[ 1 ].copy( this.light.groundColor ).multiplyScalar( this.light.intensity );\r\n\r\n\t\tthis.lightSphere.lookAt( vector.setFromMatrixPosition( this.light.matrixWorld ).negate() );\r\n\t\tthis.lightSphere.geometry.colorsNeedUpdate = true;\r\n\r\n\t}\r\n\r\n}();\r\n\r\n// File:src/extras/helpers/PointLightHelper.js\r\n\r\n/**\r\n * @author alteredq / http://alteredqualia.com/\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.PointLightHelper = function ( light, sphereSize ) {\r\n\r\n\tthis.light = light;\r\n\tthis.light.updateMatrixWorld();\r\n\r\n\tvar geometry = new THREE.SphereGeometry( sphereSize, 4, 2 );\r\n\tvar material = new THREE.MeshBasicMaterial( { wireframe: true, fog: false } );\r\n\tmaterial.color.copy( this.light.color ).multiplyScalar( this.light.intensity );\r\n\r\n\tTHREE.Mesh.call( this, geometry, material );\r\n\r\n\tthis.matrix = this.light.matrixWorld;\r\n\tthis.matrixAutoUpdate = false;\r\n\r\n\t/*\r\n\tvar distanceGeometry = new THREE.IcosahedronGeometry( 1, 2 );\r\n\tvar distanceMaterial = new THREE.MeshBasicMaterial( { color: hexColor, fog: false, wireframe: true, opacity: 0.1, transparent: true } );\r\n\r\n\tthis.lightSphere = new THREE.Mesh( bulbGeometry, bulbMaterial );\r\n\tthis.lightDistance = new THREE.Mesh( distanceGeometry, distanceMaterial );\r\n\r\n\tvar d = light.distance;\r\n\r\n\tif ( d === 0.0 ) {\r\n\r\n\t\tthis.lightDistance.visible = false;\r\n\r\n\t} else {\r\n\r\n\t\tthis.lightDistance.scale.set( d, d, d );\r\n\r\n\t}\r\n\r\n\tthis.add( this.lightDistance );\r\n\t*/\r\n\r\n};\r\n\r\nTHREE.PointLightHelper.prototype = Object.create( THREE.Mesh.prototype );\r\nTHREE.PointLightHelper.prototype.constructor = THREE.PointLightHelper;\r\n\r\nTHREE.PointLightHelper.prototype.dispose = function () {\r\n\r\n\tthis.geometry.dispose();\r\n\tthis.material.dispose();\r\n\r\n};\r\n\r\nTHREE.PointLightHelper.prototype.update = function () {\r\n\r\n\tthis.material.color.copy( this.light.color ).multiplyScalar( this.light.intensity );\r\n\r\n\t/*\r\n\tvar d = this.light.distance;\r\n\r\n\tif ( d === 0.0 ) {\r\n\r\n\t\tthis.lightDistance.visible = false;\r\n\r\n\t} else {\r\n\r\n\t\tthis.lightDistance.visible = true;\r\n\t\tthis.lightDistance.scale.set( d, d, d );\r\n\r\n\t}\r\n\t*/\r\n\r\n};\r\n\r\n// File:src/extras/helpers/SkeletonHelper.js\r\n\r\n/**\r\n * @author Sean Griffin / http://twitter.com/sgrif\r\n * @author Michael Guerrero / http://realitymeltdown.com\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author ikerr / http://verold.com\r\n */\r\n\r\nTHREE.SkeletonHelper = function ( object ) {\r\n\r\n\tthis.bones = this.getBoneList( object );\r\n\r\n\tvar geometry = new THREE.Geometry();\r\n\r\n\tfor ( var i = 0; i < this.bones.length; i ++ ) {\r\n\r\n\t\tvar bone = this.bones[ i ];\r\n\r\n\t\tif ( bone.parent instanceof THREE.Bone ) {\r\n\r\n\t\t\tgeometry.vertices.push( new THREE.Vector3() );\r\n\t\t\tgeometry.vertices.push( new THREE.Vector3() );\r\n\t\t\tgeometry.colors.push( new THREE.Color( 0, 0, 1 ) );\r\n\t\t\tgeometry.colors.push( new THREE.Color( 0, 1, 0 ) );\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tgeometry.dynamic = true;\r\n\r\n\tvar material = new THREE.LineBasicMaterial( { vertexColors: THREE.VertexColors, depthTest: false, depthWrite: false, transparent: true } );\r\n\r\n\tTHREE.LineSegments.call( this, geometry, material );\r\n\r\n\tthis.root = object;\r\n\r\n\tthis.matrix = object.matrixWorld;\r\n\tthis.matrixAutoUpdate = false;\r\n\r\n\tthis.update();\r\n\r\n};\r\n\r\n\r\nTHREE.SkeletonHelper.prototype = Object.create( THREE.LineSegments.prototype );\r\nTHREE.SkeletonHelper.prototype.constructor = THREE.SkeletonHelper;\r\n\r\nTHREE.SkeletonHelper.prototype.getBoneList = function( object ) {\r\n\r\n\tvar boneList = [];\r\n\r\n\tif ( object instanceof THREE.Bone ) {\r\n\r\n\t\tboneList.push( object );\r\n\r\n\t}\r\n\r\n\tfor ( var i = 0; i < object.children.length; i ++ ) {\r\n\r\n\t\tboneList.push.apply( boneList, this.getBoneList( object.children[ i ] ) );\r\n\r\n\t}\r\n\r\n\treturn boneList;\r\n\r\n};\r\n\r\nTHREE.SkeletonHelper.prototype.update = function () {\r\n\r\n\tvar geometry = this.geometry;\r\n\r\n\tvar matrixWorldInv = new THREE.Matrix4().getInverse( this.root.matrixWorld );\r\n\r\n\tvar boneMatrix = new THREE.Matrix4();\r\n\r\n\tvar j = 0;\r\n\r\n\tfor ( var i = 0; i < this.bones.length; i ++ ) {\r\n\r\n\t\tvar bone = this.bones[ i ];\r\n\r\n\t\tif ( bone.parent instanceof THREE.Bone ) {\r\n\r\n\t\t\tboneMatrix.multiplyMatrices( matrixWorldInv, bone.matrixWorld );\r\n\t\t\tgeometry.vertices[ j ].setFromMatrixPosition( boneMatrix );\r\n\r\n\t\t\tboneMatrix.multiplyMatrices( matrixWorldInv, bone.parent.matrixWorld );\r\n\t\t\tgeometry.vertices[ j + 1 ].setFromMatrixPosition( boneMatrix );\r\n\r\n\t\t\tj += 2;\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tgeometry.verticesNeedUpdate = true;\r\n\r\n\tgeometry.computeBoundingSphere();\r\n\r\n};\r\n\r\n// File:src/extras/helpers/SpotLightHelper.js\r\n\r\n/**\r\n * @author alteredq / http://alteredqualia.com/\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author WestLangley / http://github.com/WestLangley\r\n*/\r\n\r\nTHREE.SpotLightHelper = function ( light ) {\r\n\r\n\tTHREE.Object3D.call( this );\r\n\r\n\tthis.light = light;\r\n\tthis.light.updateMatrixWorld();\r\n\r\n\tthis.matrix = light.matrixWorld;\r\n\tthis.matrixAutoUpdate = false;\r\n\r\n\tvar geometry = new THREE.BufferGeometry();\r\n\r\n\tvar positions = [\r\n\t\t0, 0, 0,   0,   0,   1,\r\n\t\t0, 0, 0,   1,   0,   1,\r\n\t\t0, 0, 0, - 1,   0,   1,\r\n\t\t0, 0, 0,   0,   1,   1,\r\n\t\t0, 0, 0,   0, - 1,   1\r\n\t];\r\n\r\n\tfor ( var i = 0, j = 1, l = 32; i < l; i ++, j ++ ) {\r\n\r\n\t\tvar p1 = ( i / l ) * Math.PI * 2;\r\n\t\tvar p2 = ( j / l ) * Math.PI * 2;\r\n\r\n\t\tpositions.push(\r\n\t\t\tMath.cos( p1 ), Math.sin( p1 ), 1,\r\n\t\t\tMath.cos( p2 ), Math.sin( p2 ), 1\r\n\t\t);\r\n\r\n\t}\r\n\r\n\tgeometry.addAttribute( 'position', new THREE.Float32Attribute( positions, 3 ) );\r\n\r\n\tvar material = new THREE.LineBasicMaterial( { fog: false } );\r\n\r\n\tthis.cone = new THREE.LineSegments( geometry, material );\r\n\tthis.add( this.cone );\r\n\r\n\tthis.update();\r\n\r\n};\r\n\r\nTHREE.SpotLightHelper.prototype = Object.create( THREE.Object3D.prototype );\r\nTHREE.SpotLightHelper.prototype.constructor = THREE.SpotLightHelper;\r\n\r\nTHREE.SpotLightHelper.prototype.dispose = function () {\r\n\r\n\tthis.cone.geometry.dispose();\r\n\tthis.cone.material.dispose();\r\n\r\n};\r\n\r\nTHREE.SpotLightHelper.prototype.update = function () {\r\n\r\n\tvar vector = new THREE.Vector3();\r\n\tvar vector2 = new THREE.Vector3();\r\n\r\n\treturn function () {\r\n\r\n\t\tvar coneLength = this.light.distance ? this.light.distance : 1000;\r\n\t\tvar coneWidth = coneLength * Math.tan( this.light.angle );\r\n\r\n\t\tthis.cone.scale.set( coneWidth, coneWidth, coneLength );\r\n\r\n\t\tvector.setFromMatrixPosition( this.light.matrixWorld );\r\n\t\tvector2.setFromMatrixPosition( this.light.target.matrixWorld );\r\n\r\n\t\tthis.cone.lookAt( vector2.sub( vector ) );\r\n\r\n\t\tthis.cone.material.color.copy( this.light.color ).multiplyScalar( this.light.intensity );\r\n\r\n\t};\r\n\r\n}();\r\n\r\n// File:src/extras/helpers/VertexNormalsHelper.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author WestLangley / http://github.com/WestLangley\r\n*/\r\n\r\nTHREE.VertexNormalsHelper = function ( object, size, hex, linewidth ) {\r\n\r\n\tthis.object = object;\r\n\r\n\tthis.size = ( size !== undefined ) ? size : 1;\r\n\r\n\tvar color = ( hex !== undefined ) ? hex : 0xff0000;\r\n\r\n\tvar width = ( linewidth !== undefined ) ? linewidth : 1;\r\n\r\n\t//\r\n\r\n\tvar nNormals = 0;\r\n\r\n\tvar objGeometry = this.object.geometry;\r\n\r\n\tif ( objGeometry instanceof THREE.Geometry ) {\r\n\r\n\t\tnNormals = objGeometry.faces.length * 3;\r\n\r\n\t} else if ( objGeometry instanceof THREE.BufferGeometry ) {\r\n\r\n\t\tnNormals = objGeometry.attributes.normal.count\r\n\r\n\t}\r\n\r\n\t//\r\n\r\n\tvar geometry = new THREE.BufferGeometry();\r\n\r\n\tvar positions = new THREE.Float32Attribute( nNormals * 2 * 3, 3 );\r\n\r\n\tgeometry.addAttribute( 'position', positions );\r\n\r\n\tTHREE.LineSegments.call( this, geometry, new THREE.LineBasicMaterial( { color: color, linewidth: width } ) );\r\n\r\n\t//\r\n\r\n\tthis.matrixAutoUpdate = false;\r\n\r\n\tthis.update();\r\n\r\n};\r\n\r\nTHREE.VertexNormalsHelper.prototype = Object.create( THREE.LineSegments.prototype );\r\nTHREE.VertexNormalsHelper.prototype.constructor = THREE.VertexNormalsHelper;\r\n\r\nTHREE.VertexNormalsHelper.prototype.update = ( function () {\r\n\r\n\tvar v1 = new THREE.Vector3();\r\n\tvar v2 = new THREE.Vector3();\r\n\tvar normalMatrix = new THREE.Matrix3();\r\n\r\n\treturn function update() {\r\n\r\n\t\tvar keys = [ 'a', 'b', 'c' ];\r\n\r\n\t\tthis.object.updateMatrixWorld( true );\r\n\r\n\t\tnormalMatrix.getNormalMatrix( this.object.matrixWorld );\r\n\r\n\t\tvar matrixWorld = this.object.matrixWorld;\r\n\r\n\t\tvar position = this.geometry.attributes.position;\r\n\r\n\t\t//\r\n\r\n\t\tvar objGeometry = this.object.geometry;\r\n\r\n\t\tif ( objGeometry instanceof THREE.Geometry ) {\r\n\r\n\t\t\tvar vertices = objGeometry.vertices;\r\n\r\n\t\t\tvar faces = objGeometry.faces;\r\n\r\n\t\t\tvar idx = 0;\r\n\r\n\t\t\tfor ( var i = 0, l = faces.length; i < l; i ++ ) {\r\n\r\n\t\t\t\tvar face = faces[ i ];\r\n\r\n\t\t\t\tfor ( var j = 0, jl = face.vertexNormals.length; j < jl; j ++ ) {\r\n\r\n\t\t\t\t\tvar vertex = vertices[ face[ keys[ j ] ] ];\r\n\r\n\t\t\t\t\tvar normal = face.vertexNormals[ j ];\r\n\r\n\t\t\t\t\tv1.copy( vertex ).applyMatrix4( matrixWorld );\r\n\r\n\t\t\t\t\tv2.copy( normal ).applyMatrix3( normalMatrix ).normalize().multiplyScalar( this.size ).add( v1 );\r\n\r\n\t\t\t\t\tposition.setXYZ( idx, v1.x, v1.y, v1.z );\r\n\r\n\t\t\t\t\tidx = idx + 1;\r\n\r\n\t\t\t\t\tposition.setXYZ( idx, v2.x, v2.y, v2.z );\r\n\r\n\t\t\t\t\tidx = idx + 1;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t} else if ( objGeometry instanceof THREE.BufferGeometry ) {\r\n\r\n\t\t\tvar objPos = objGeometry.attributes.position;\r\n\r\n\t\t\tvar objNorm = objGeometry.attributes.normal;\r\n\r\n\t\t\tvar idx = 0;\r\n\r\n\t\t\t// for simplicity, ignore index and drawcalls, and render every normal\r\n\r\n\t\t\tfor ( var j = 0, jl = objPos.count; j < jl; j ++ ) {\r\n\r\n\t\t\t\tv1.set( objPos.getX( j ), objPos.getY( j ), objPos.getZ( j ) ).applyMatrix4( matrixWorld );\r\n\r\n\t\t\t\tv2.set( objNorm.getX( j ), objNorm.getY( j ), objNorm.getZ( j ) );\r\n\r\n\t\t\t\tv2.applyMatrix3( normalMatrix ).normalize().multiplyScalar( this.size ).add( v1 );\r\n\r\n\t\t\t\tposition.setXYZ( idx, v1.x, v1.y, v1.z );\r\n\r\n\t\t\t\tidx = idx + 1;\r\n\r\n\t\t\t\tposition.setXYZ( idx, v2.x, v2.y, v2.z );\r\n\r\n\t\t\t\tidx = idx + 1;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tposition.needsUpdate = true;\r\n\r\n\t\treturn this;\r\n\r\n\t}\r\n\r\n}() );\r\n\r\n// File:src/extras/helpers/WireframeHelper.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.WireframeHelper = function ( object, hex ) {\r\n\r\n\tvar color = ( hex !== undefined ) ? hex : 0xffffff;\r\n\r\n\tTHREE.LineSegments.call( this, new THREE.WireframeGeometry( object.geometry ), new THREE.LineBasicMaterial( { color: color } ) );\r\n\r\n\tthis.matrix = object.matrixWorld;\r\n\tthis.matrixAutoUpdate = false;\r\n\r\n};\r\n\r\nTHREE.WireframeHelper.prototype = Object.create( THREE.LineSegments.prototype );\r\nTHREE.WireframeHelper.prototype.constructor = THREE.WireframeHelper;\r\n\r\n// File:src/extras/objects/ImmediateRenderObject.js\r\n\r\n/**\r\n * @author alteredq / http://alteredqualia.com/\r\n */\r\n\r\nTHREE.ImmediateRenderObject = function ( material ) {\r\n\r\n\tTHREE.Object3D.call( this );\r\n\r\n\tthis.material = material;\r\n\tthis.render = function ( renderCallback ) {};\r\n\r\n};\r\n\r\nTHREE.ImmediateRenderObject.prototype = Object.create( THREE.Object3D.prototype );\r\nTHREE.ImmediateRenderObject.prototype.constructor = THREE.ImmediateRenderObject;\r\n\r\n// File:src/extras/objects/MorphBlendMesh.js\r\n\r\n/**\r\n * @author alteredq / http://alteredqualia.com/\r\n */\r\n\r\nTHREE.MorphBlendMesh = function( geometry, material ) {\r\n\r\n\tTHREE.Mesh.call( this, geometry, material );\r\n\r\n\tthis.animationsMap = {};\r\n\tthis.animationsList = [];\r\n\r\n\t// prepare default animation\r\n\t// (all frames played together in 1 second)\r\n\r\n\tvar numFrames = this.geometry.morphTargets.length;\r\n\r\n\tvar name = \"__default\";\r\n\r\n\tvar startFrame = 0;\r\n\tvar endFrame = numFrames - 1;\r\n\r\n\tvar fps = numFrames / 1;\r\n\r\n\tthis.createAnimation( name, startFrame, endFrame, fps );\r\n\tthis.setAnimationWeight( name, 1 );\r\n\r\n};\r\n\r\nTHREE.MorphBlendMesh.prototype = Object.create( THREE.Mesh.prototype );\r\nTHREE.MorphBlendMesh.prototype.constructor = THREE.MorphBlendMesh;\r\n\r\nTHREE.MorphBlendMesh.prototype.createAnimation = function ( name, start, end, fps ) {\r\n\r\n\tvar animation = {\r\n\r\n\t\tstart: start,\r\n\t\tend: end,\r\n\r\n\t\tlength: end - start + 1,\r\n\r\n\t\tfps: fps,\r\n\t\tduration: ( end - start ) / fps,\r\n\r\n\t\tlastFrame: 0,\r\n\t\tcurrentFrame: 0,\r\n\r\n\t\tactive: false,\r\n\r\n\t\ttime: 0,\r\n\t\tdirection: 1,\r\n\t\tweight: 1,\r\n\r\n\t\tdirectionBackwards: false,\r\n\t\tmirroredLoop: false\r\n\r\n\t};\r\n\r\n\tthis.animationsMap[ name ] = animation;\r\n\tthis.animationsList.push( animation );\r\n\r\n};\r\n\r\nTHREE.MorphBlendMesh.prototype.autoCreateAnimations = function ( fps ) {\r\n\r\n\tvar pattern = /([a-z]+)_?(\\d+)/i;\r\n\r\n\tvar firstAnimation, frameRanges = {};\r\n\r\n\tvar geometry = this.geometry;\r\n\r\n\tfor ( var i = 0, il = geometry.morphTargets.length; i < il; i ++ ) {\r\n\r\n\t\tvar morph = geometry.morphTargets[ i ];\r\n\t\tvar chunks = morph.name.match( pattern );\r\n\r\n\t\tif ( chunks && chunks.length > 1 ) {\r\n\r\n\t\t\tvar name = chunks[ 1 ];\r\n\r\n\t\t\tif ( ! frameRanges[ name ] ) frameRanges[ name ] = { start: Infinity, end: - Infinity };\r\n\r\n\t\t\tvar range = frameRanges[ name ];\r\n\r\n\t\t\tif ( i < range.start ) range.start = i;\r\n\t\t\tif ( i > range.end ) range.end = i;\r\n\r\n\t\t\tif ( ! firstAnimation ) firstAnimation = name;\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tfor ( var name in frameRanges ) {\r\n\r\n\t\tvar range = frameRanges[ name ];\r\n\t\tthis.createAnimation( name, range.start, range.end, fps );\r\n\r\n\t}\r\n\r\n\tthis.firstAnimation = firstAnimation;\r\n\r\n};\r\n\r\nTHREE.MorphBlendMesh.prototype.setAnimationDirectionForward = function ( name ) {\r\n\r\n\tvar animation = this.animationsMap[ name ];\r\n\r\n\tif ( animation ) {\r\n\r\n\t\tanimation.direction = 1;\r\n\t\tanimation.directionBackwards = false;\r\n\r\n\t}\r\n\r\n};\r\n\r\nTHREE.MorphBlendMesh.prototype.setAnimationDirectionBackward = function ( name ) {\r\n\r\n\tvar animation = this.animationsMap[ name ];\r\n\r\n\tif ( animation ) {\r\n\r\n\t\tanimation.direction = - 1;\r\n\t\tanimation.directionBackwards = true;\r\n\r\n\t}\r\n\r\n};\r\n\r\nTHREE.MorphBlendMesh.prototype.setAnimationFPS = function ( name, fps ) {\r\n\r\n\tvar animation = this.animationsMap[ name ];\r\n\r\n\tif ( animation ) {\r\n\r\n\t\tanimation.fps = fps;\r\n\t\tanimation.duration = ( animation.end - animation.start ) / animation.fps;\r\n\r\n\t}\r\n\r\n};\r\n\r\nTHREE.MorphBlendMesh.prototype.setAnimationDuration = function ( name, duration ) {\r\n\r\n\tvar animation = this.animationsMap[ name ];\r\n\r\n\tif ( animation ) {\r\n\r\n\t\tanimation.duration = duration;\r\n\t\tanimation.fps = ( animation.end - animation.start ) / animation.duration;\r\n\r\n\t}\r\n\r\n};\r\n\r\nTHREE.MorphBlendMesh.prototype.setAnimationWeight = function ( name, weight ) {\r\n\r\n\tvar animation = this.animationsMap[ name ];\r\n\r\n\tif ( animation ) {\r\n\r\n\t\tanimation.weight = weight;\r\n\r\n\t}\r\n\r\n};\r\n\r\nTHREE.MorphBlendMesh.prototype.setAnimationTime = function ( name, time ) {\r\n\r\n\tvar animation = this.animationsMap[ name ];\r\n\r\n\tif ( animation ) {\r\n\r\n\t\tanimation.time = time;\r\n\r\n\t}\r\n\r\n};\r\n\r\nTHREE.MorphBlendMesh.prototype.getAnimationTime = function ( name ) {\r\n\r\n\tvar time = 0;\r\n\r\n\tvar animation = this.animationsMap[ name ];\r\n\r\n\tif ( animation ) {\r\n\r\n\t\ttime = animation.time;\r\n\r\n\t}\r\n\r\n\treturn time;\r\n\r\n};\r\n\r\nTHREE.MorphBlendMesh.prototype.getAnimationDuration = function ( name ) {\r\n\r\n\tvar duration = - 1;\r\n\r\n\tvar animation = this.animationsMap[ name ];\r\n\r\n\tif ( animation ) {\r\n\r\n\t\tduration = animation.duration;\r\n\r\n\t}\r\n\r\n\treturn duration;\r\n\r\n};\r\n\r\nTHREE.MorphBlendMesh.prototype.playAnimation = function ( name ) {\r\n\r\n\tvar animation = this.animationsMap[ name ];\r\n\r\n\tif ( animation ) {\r\n\r\n\t\tanimation.time = 0;\r\n\t\tanimation.active = true;\r\n\r\n\t} else {\r\n\r\n\t\tconsole.warn( \"THREE.MorphBlendMesh: animation[\" + name + \"] undefined in .playAnimation()\" );\r\n\r\n\t}\r\n\r\n};\r\n\r\nTHREE.MorphBlendMesh.prototype.stopAnimation = function ( name ) {\r\n\r\n\tvar animation = this.animationsMap[ name ];\r\n\r\n\tif ( animation ) {\r\n\r\n\t\tanimation.active = false;\r\n\r\n\t}\r\n\r\n};\r\n\r\nTHREE.MorphBlendMesh.prototype.update = function ( delta ) {\r\n\r\n\tfor ( var i = 0, il = this.animationsList.length; i < il; i ++ ) {\r\n\r\n\t\tvar animation = this.animationsList[ i ];\r\n\r\n\t\tif ( ! animation.active ) continue;\r\n\r\n\t\tvar frameTime = animation.duration / animation.length;\r\n\r\n\t\tanimation.time += animation.direction * delta;\r\n\r\n\t\tif ( animation.mirroredLoop ) {\r\n\r\n\t\t\tif ( animation.time > animation.duration || animation.time < 0 ) {\r\n\r\n\t\t\t\tanimation.direction *= - 1;\r\n\r\n\t\t\t\tif ( animation.time > animation.duration ) {\r\n\r\n\t\t\t\t\tanimation.time = animation.duration;\r\n\t\t\t\t\tanimation.directionBackwards = true;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( animation.time < 0 ) {\r\n\r\n\t\t\t\t\tanimation.time = 0;\r\n\t\t\t\t\tanimation.directionBackwards = false;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t} else {\r\n\r\n\t\t\tanimation.time = animation.time % animation.duration;\r\n\r\n\t\t\tif ( animation.time < 0 ) animation.time += animation.duration;\r\n\r\n\t\t}\r\n\r\n\t\tvar keyframe = animation.start + THREE.Math.clamp( Math.floor( animation.time / frameTime ), 0, animation.length - 1 );\r\n\t\tvar weight = animation.weight;\r\n\r\n\t\tif ( keyframe !== animation.currentFrame ) {\r\n\r\n\t\t\tthis.morphTargetInfluences[ animation.lastFrame ] = 0;\r\n\t\t\tthis.morphTargetInfluences[ animation.currentFrame ] = 1 * weight;\r\n\r\n\t\t\tthis.morphTargetInfluences[ keyframe ] = 0;\r\n\r\n\t\t\tanimation.lastFrame = animation.currentFrame;\r\n\t\t\tanimation.currentFrame = keyframe;\r\n\r\n\t\t}\r\n\r\n\t\tvar mix = ( animation.time % frameTime ) / frameTime;\r\n\r\n\t\tif ( animation.directionBackwards ) mix = 1 - mix;\r\n\r\n\t\tif ( animation.currentFrame !== animation.lastFrame ) {\r\n\r\n\t\t\tthis.morphTargetInfluences[ animation.currentFrame ] = mix * weight;\r\n\t\t\tthis.morphTargetInfluences[ animation.lastFrame ] = ( 1 - mix ) * weight;\r\n\r\n\t\t} else {\r\n\r\n\t\t\tthis.morphTargetInfluences[ animation.currentFrame ] = weight;\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n};\r\n\r\n\r\n// Export the THREE object for **Node.js**, with\r\n// backwards-compatibility for the old `require()` API. If we're in\r\n// the browser, add `_` as a global object via a string identifier,\r\n// for Closure Compiler \"advanced\" mode.\r\nif (typeof exports !== 'undefined') {\r\n  if (typeof module !== 'undefined' && module.exports) {\r\n    exports = module.exports = THREE;\r\n  }\r\n  exports.THREE = THREE;\r\n} else {\r\n  this['THREE'] = THREE;\r\n}\r\n","// shim for using process in browser\nvar process = module.exports = {};\n\n// cached from whatever global is present so that test runners that stub it\n// don't break things.  But we need to wrap it in a try catch in case it is\n// wrapped in strict mode code which doesn't define any globals.  It's inside a\n// function because try/catches deoptimize in certain engines.\n\nvar cachedSetTimeout;\nvar cachedClearTimeout;\n\n(function () {\n    try {\n        cachedSetTimeout = setTimeout;\n    } catch (e) {\n        cachedSetTimeout = function () {\n            throw new Error('setTimeout is not defined');\n        }\n    }\n    try {\n        cachedClearTimeout = clearTimeout;\n    } catch (e) {\n        cachedClearTimeout = function () {\n            throw new Error('clearTimeout is not defined');\n        }\n    }\n} ())\nfunction runTimeout(fun) {\n    if (cachedSetTimeout === setTimeout) {\n        //normal enviroments in sane situations\n        return setTimeout(fun, 0);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedSetTimeout(fun, 0);\n    } catch(e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't trust the global object when called normally\n            return cachedSetTimeout.call(null, fun, 0);\n        } catch(e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error\n            return cachedSetTimeout.call(this, fun, 0);\n        }\n    }\n\n\n}\nfunction runClearTimeout(marker) {\n    if (cachedClearTimeout === clearTimeout) {\n        //normal enviroments in sane situations\n        return clearTimeout(marker);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedClearTimeout(marker);\n    } catch (e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't  trust the global object when called normally\n            return cachedClearTimeout.call(null, marker);\n        } catch (e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error.\n            // Some versions of I.E. have different rules for clearTimeout vs setTimeout\n            return cachedClearTimeout.call(this, marker);\n        }\n    }\n\n\n\n}\nvar queue = [];\nvar draining = false;\nvar currentQueue;\nvar queueIndex = -1;\n\nfunction cleanUpNextTick() {\n    if (!draining || !currentQueue) {\n        return;\n    }\n    draining = false;\n    if (currentQueue.length) {\n        queue = currentQueue.concat(queue);\n    } else {\n        queueIndex = -1;\n    }\n    if (queue.length) {\n        drainQueue();\n    }\n}\n\nfunction drainQueue() {\n    if (draining) {\n        return;\n    }\n    var timeout = runTimeout(cleanUpNextTick);\n    draining = true;\n\n    var len = queue.length;\n    while(len) {\n        currentQueue = queue;\n        queue = [];\n        while (++queueIndex < len) {\n            if (currentQueue) {\n                currentQueue[queueIndex].run();\n            }\n        }\n        queueIndex = -1;\n        len = queue.length;\n    }\n    currentQueue = null;\n    draining = false;\n    runClearTimeout(timeout);\n}\n\nprocess.nextTick = function (fun) {\n    var args = new Array(arguments.length - 1);\n    if (arguments.length > 1) {\n        for (var i = 1; i < arguments.length; i++) {\n            args[i - 1] = arguments[i];\n        }\n    }\n    queue.push(new Item(fun, args));\n    if (queue.length === 1 && !draining) {\n        runTimeout(drainQueue);\n    }\n};\n\n// v8 likes predictible objects\nfunction Item(fun, array) {\n    this.fun = fun;\n    this.array = array;\n}\nItem.prototype.run = function () {\n    this.fun.apply(null, this.array);\n};\nprocess.title = 'browser';\nprocess.browser = true;\nprocess.env = {};\nprocess.argv = [];\nprocess.version = ''; // empty string to avoid regexp issues\nprocess.versions = {};\n\nfunction noop() {}\n\nprocess.on = noop;\nprocess.addListener = noop;\nprocess.once = noop;\nprocess.off = noop;\nprocess.removeListener = noop;\nprocess.removeAllListeners = noop;\nprocess.emit = noop;\n\nprocess.binding = function (name) {\n    throw new Error('process.binding is not supported');\n};\n\nprocess.cwd = function () { return '/' };\nprocess.chdir = function (dir) {\n    throw new Error('process.chdir is not supported');\n};\nprocess.umask = function() { return 0; };\n","var DEFAULT_CAMERA_HEIGHT = require('../../../constants/').DEFAULT_CAMERA_HEIGHT;\nvar registerPrimitive = require('../primitives').registerPrimitive;\n\nregisterPrimitive('a-camera', {\n  defaultComponents: {\n    camera: {\n      userHeight: DEFAULT_CAMERA_HEIGHT\n    },\n    'look-controls': {},\n    'wasd-controls': {}\n  },\n\n  mappings: {\n    active: 'camera.active',\n    far: 'camera.far',\n    fov: 'camera.fov',\n    'look-controls-enabled': 'look-controls.enabled',\n    near: 'camera.near',\n    'wasd-controls-enabled': 'wasd-controls.enabled',\n    'user-height': 'camera.userHeight',\n    zoom: 'camera.zoom'\n  },\n\n  deprecatedMappings: {\n    'cursor-color': 'a-camera[cursor-color] has been removed. Use a-cursor[color] instead.',\n    'cursor-maxdistance': 'a-camera[cursor-maxdistance] has been removed. Use a-cursor[max-distance] instead.',\n    'cursor-offset': 'a-camera[cursor-offset] has been removed. Use a-cursor[position] instead.',\n    'cursor-opacity': 'a-camera[cursor-offset] has been removed. Use a-cursor[opacity] instead.',\n    'cursor-scale': 'a-camera[cursor-scale] has been removed. Use a-cursor[scale] instead.',\n    'cursor-visible': 'a-camera[cursor-visible] has been removed. Use a-cursor[visible] instead.'\n  }\n});\n","var getMeshMixin = require('../getMeshMixin');\nvar registerPrimitive = require('../primitives').registerPrimitive;\nvar utils = require('../../../utils/');\n\nregisterPrimitive('a-collada-model', utils.extendDeep({}, getMeshMixin(), {\n  mappings: {\n    src: 'collada-model'\n  }\n}));\n","var getMeshMixin = require('../getMeshMixin');\nvar registerPrimitive = require('../primitives').registerPrimitive;\nvar utils = require('../../../utils/');\n\nregisterPrimitive('a-cursor', utils.extendDeep({}, getMeshMixin(), {\n  defaultComponents: {\n    cursor: {},\n    geometry: {\n      primitive: 'ring',\n      radiusOuter: 0.016,\n      radiusInner: 0.01,\n      segmentsTheta: 64\n    },\n    material: {\n      color: '#000',\n      shader: 'flat',\n      opacity: 0.8\n    },\n    position: {\n      x: 0,\n      y: 0,\n      z: -1\n    },\n    raycaster: {\n      far: 1000\n    }\n  },\n\n  mappings: {\n    far: 'raycaster.far',\n    fuse: 'cursor.fuse',\n    interval: 'raycaster.interval',\n    objects: 'raycaster.objects',\n    'fuse-timeout': 'cursor.fuseTimeout'\n  }\n}));\n","var getMeshMixin = require('../getMeshMixin');\nvar registerPrimitive = require('../primitives').registerPrimitive;\nvar utils = require('../../../utils/');\n\nregisterPrimitive('a-curvedimage', utils.extendDeep({}, getMeshMixin(), {\n  defaultComponents: {\n    geometry: {\n      height: 1,\n      primitive: 'cylinder',\n      radius: 2,\n      segmentsRadial: 48,\n      thetaLength: 270,\n      openEnded: true,\n      thetaStart: 0\n    },\n    material: {\n      color: '#FFF',\n      shader: 'flat',\n      side: 'double',\n      transparent: true,\n      repeat: '-1 1'\n    }\n  },\n\n  mappings: {\n    height: 'geometry.height',\n    'open-ended': 'geometry.openEnded',\n    radius: 'geometry.radius',\n    segments: 'geometry.segmentsRadial',\n    start: 'geometry.thetaStart',\n    'theta-length': 'geometry.thetaLength',\n    'theta-start': 'geometry.thetaStart',\n    'width': 'geometry.thetaLength'\n  }\n}));\n","var getMeshMixin = require('../getMeshMixin');\nvar registerPrimitive = require('../primitives').registerPrimitive;\nvar utils = require('../../../utils/');\n\nregisterPrimitive('a-image', utils.extendDeep({}, getMeshMixin(), {\n  defaultComponents: {\n    geometry: {\n      primitive: 'plane'\n    },\n    material: {\n      color: '#FFF',\n      shader: 'flat',\n      side: 'double',\n      transparent: true\n    }\n  },\n\n  mappings: {\n    height: 'geometry.height',\n    width: 'geometry.width'\n  }\n}));\n","var registerPrimitive = require('../primitives').registerPrimitive;\n\nregisterPrimitive('a-light', {\n  defaultComponents: {\n    light: {}\n  },\n\n  mappings: {\n    angle: 'light.angle',\n    color: 'light.color',\n    'ground-color': 'light.groundColor',\n    decay: 'light.decay',\n    distance: 'light.distance',\n    intensity: 'light.intensity',\n    penumbra: 'light.penumbra',\n    type: 'light.type',\n    target: 'light.target'\n  }\n});\n","var meshMixin = require('../getMeshMixin')();\nvar registerPrimitive = require('../primitives').registerPrimitive;\nvar utils = require('../../../utils/');\n\nregisterPrimitive('a-obj-model', utils.extendDeep({}, meshMixin, {\n  mappings: {\n    src: 'obj-model.obj',\n    mtl: 'obj-model.mtl'\n  },\n\n  transforms: {\n    mtl: meshMixin.transforms.src\n  }\n}));\n","var getMeshMixin = require('../getMeshMixin');\nvar registerPrimitive = require('../primitives').registerPrimitive;\nvar utils = require('../../../utils/');\n\nregisterPrimitive('a-sky', utils.extendDeep({}, getMeshMixin(), {\n  defaultComponents: {\n    geometry: {\n      primitive: 'sphere',\n      radius: 5000,\n      segmentsWidth: 64,\n      segmentsHeight: 20\n    },\n    material: {\n      color: '#FFF',\n      shader: 'flat'\n    },\n    scale: '-1 1 1'\n  },\n\n  mappings: {\n    radius: 'geometry.radius',\n    'segments-width': 'geometry.segmentsWidth',\n    'segments-height': 'geometry.segmentsHeight'\n  }\n}));\n","var registerPrimitive = require('../primitives').registerPrimitive;\n\nregisterPrimitive('a-sound', {\n  defaultComponents: {\n    sound: {}\n  },\n\n  mappings: {\n    src: 'sound.src',\n    on: 'sound.on',\n    autoplay: 'sound.autoplay',\n    loop: 'sound.loop',\n    volume: 'sound.volume'\n  }\n});\n","var getMeshMixin = require('../getMeshMixin');\nvar registerPrimitive = require('../primitives').registerPrimitive;\nvar utils = require('../../../utils/');\n\nregisterPrimitive('a-video', utils.extendDeep({}, getMeshMixin(), {\n  defaultComponents: {\n    geometry: {\n      primitive: 'plane'\n    },\n    material: {\n      color: '#FFF',\n      shader: 'flat',\n      side: 'double',\n      transparent: true\n    }\n  },\n\n  mappings: {\n    height: 'geometry.height',\n    width: 'geometry.width'\n  }\n}));\n","var getMeshMixin = require('../getMeshMixin');\nvar registerPrimitive = require('../primitives').registerPrimitive;\nvar utils = require('../../../utils/');\n\nregisterPrimitive('a-videosphere', utils.extendDeep({}, getMeshMixin(), {\n  defaultComponents: {\n    geometry: {\n      primitive: 'sphere',\n      radius: 5000,\n      segmentsWidth: 64,\n      segmentsHeight: 20\n    },\n    material: {\n      color: '#FFF',\n      shader: 'flat'\n    },\n    scale: '-1 1 1'\n  },\n\n  mappings: {\n    radius: 'geometry.radius',\n    'segments-height': 'geometry.segmentsHeight',\n    'segments-width': 'geometry.segmentsWidth'\n  }\n}));\n","/**\n * Automated mesh primitive registration.\n */\nvar getMeshMixin = require('../getMeshMixin');\nvar geometries = require('../../../core/geometry').geometries;\nvar geometryNames = require('../../../core/geometry').geometryNames;\nvar registerPrimitive = require('../primitives').registerPrimitive;\nvar utils = require('../../../utils/');\n\n// For testing.\nvar meshPrimitives = module.exports = {};\n\n// Generate primitive for each geometry type.\ngeometryNames.forEach(function registerMeshPrimitive (geometryName) {\n  var geometry = geometries[geometryName];\n  var geometryHyphened = unCamelCase(geometryName);\n\n  // Generate mappings.\n  var mappings = {};\n  Object.keys(geometry.schema).forEach(function createMapping (property) {\n    mappings[unCamelCase(property)] = 'geometry.' + property;\n  });\n\n  // Register.\n  var tagName = 'a-' + geometryHyphened;\n  var primitive = registerPrimitive(tagName, utils.extendDeep({}, getMeshMixin(), {\n    defaultComponents: {geometry: {primitive: geometryName}},\n    mappings: mappings\n  }));\n  meshPrimitives[tagName] = primitive;\n});\n\n/**\n * camelCase to hyphened-string.\n */\nfunction unCamelCase (str) {\n  return str.replace(/([a-z])([A-Z])/g, '$1-$2').toLowerCase();\n}\n","// performance.now() polyfill from https://gist.github.com/paulirish/5438650\n'use strict';\n\n( function () {\n\n    // prepare base perf object\n    if ( typeof window.performance === 'undefined' ) {\n        window.performance = {};\n    }\n\n    if ( !window.performance.now ) {\n\n        var nowOffset = Date.now();\n\n        if ( performance.timing && performance.timing.navigationStart ) {\n            nowOffset = performance.timing.navigationStart;\n        }\n\n        window.performance.now = function now () {\n            return Date.now() - nowOffset;\n        };\n\n    }\n\n    if( !window.performance.mark ) {\n        window.performance.mark = function(){}\n    }\n\n    if( !window.performance.measure ) {\n        window.performance.measure = function(){}\n    }\n\n} )();\n\nwindow.rStats = function rStats ( settings ) {\n\n    function iterateKeys ( array, callback ) {\n        var keys = Object.keys( array );\n        for ( var j = 0, l = keys.length; j < l; j++ ) {\n            callback( keys[ j ] );\n        }\n    }\n\n    function importCSS ( url ) {\n\n        var element = document.createElement( 'link' );\n        element.href = url;\n        element.rel = 'stylesheet';\n        element.type = 'text/css';\n        document.getElementsByTagName( 'head' )[ 0 ].appendChild( element );\n\n    }\n\n    var _settings = settings || {};\n    var _colours = _settings.colours || [ '#850700', '#c74900', '#fcb300', '#284280', '#4c7c0c' ];\n\n    var _cssFont = 'https://fonts.googleapis.com/css?family=Roboto+Condensed:400,700,300';\n    var _cssRStats = ( _settings.CSSPath ? _settings.CSSPath : '' ) + 'rStats.css';\n\n    var _css = _settings.css || [ _cssFont, _cssRStats ];\n    _css.forEach(function (uri) {\n        importCSS( uri );\n    });\n\n    if ( !_settings.values ) _settings.values = {};\n\n    var _base, _div, _elHeight = 10, _elWidth = 200;\n    var _perfCounters = {};\n\n\n    function Graph ( _dom, _id, _defArg ) {\n\n        var _def = _defArg || {};\n        var _canvas = document.createElement( 'canvas' ),\n            _ctx = _canvas.getContext( '2d' ),\n            _max = 0,\n            _current = 0;\n\n        var c = _def.color ? _def.color : '#666666';\n\n        var _dotCanvas = document.createElement( 'canvas' ),\n            _dotCtx = _dotCanvas.getContext( '2d' );\n        _dotCanvas.width = 1;\n        _dotCanvas.height = 2 * _elHeight;\n        _dotCtx.fillStyle = '#444444';\n        _dotCtx.fillRect( 0, 0, 1, 2 * _elHeight );\n        _dotCtx.fillStyle = c;\n        _dotCtx.fillRect( 0, _elHeight, 1, _elHeight );\n        _dotCtx.fillStyle = '#ffffff';\n        _dotCtx.globalAlpha = 0.5;\n        _dotCtx.fillRect( 0, _elHeight, 1, 1 );\n        _dotCtx.globalAlpha = 1;\n\n        var _alarmCanvas = document.createElement( 'canvas' ),\n            _alarmCtx = _alarmCanvas.getContext( '2d' );\n        _alarmCanvas.width = 1;\n        _alarmCanvas.height = 2 * _elHeight;\n        _alarmCtx.fillStyle = '#444444';\n        _alarmCtx.fillRect( 0, 0, 1, 2 * _elHeight );\n        _alarmCtx.fillStyle = '#b70000';\n        _alarmCtx.fillRect( 0, _elHeight, 1, _elHeight );\n        _alarmCtx.globalAlpha = 0.5;\n        _alarmCtx.fillStyle = '#ffffff';\n        _alarmCtx.fillRect( 0, _elHeight, 1, 1 );\n        _alarmCtx.globalAlpha = 1;\n\n        function _init () {\n\n            _canvas.width = _elWidth;\n            _canvas.height = _elHeight;\n            _canvas.style.width = _canvas.width + 'px';\n            _canvas.style.height = _canvas.height + 'px';\n            _canvas.className = 'rs-canvas';\n            _dom.appendChild( _canvas );\n\n            _ctx.fillStyle = '#444444';\n            _ctx.fillRect( 0, 0, _canvas.width, _canvas.height );\n\n        }\n\n        function _draw ( v, alarm ) {\n            _current += ( v - _current ) * 0.1;\n            _max *= 0.99;\n            if ( _current > _max ) _max = _current;\n            _ctx.drawImage( _canvas, 1, 0, _canvas.width - 1, _canvas.height, 0, 0, _canvas.width - 1, _canvas.height );\n            if ( alarm ) {\n                _ctx.drawImage( _alarmCanvas, _canvas.width - 1, _canvas.height - _current * _canvas.height / _max - _elHeight );\n            } else {\n                _ctx.drawImage( _dotCanvas, _canvas.width - 1, _canvas.height - _current * _canvas.height / _max - _elHeight );\n            }\n        }\n\n        _init();\n\n        return {\n            draw: _draw\n        };\n\n    }\n\n    function StackGraph ( _dom, _num ) {\n\n        var _canvas = document.createElement( 'canvas' ),\n            _ctx = _canvas.getContext( '2d' );\n\n        function _init () {\n\n            _canvas.width = _elWidth;\n            _canvas.height = _elHeight * _num;\n            _canvas.style.width = _canvas.width + 'px';\n            _canvas.style.height = _canvas.height + 'px';\n            _canvas.className = 'rs-canvas';\n            _dom.appendChild( _canvas );\n\n            _ctx.fillStyle = '#444444';\n            _ctx.fillRect( 0, 0, _canvas.width, _canvas.height );\n\n        }\n\n        function _draw ( v ) {\n            _ctx.drawImage( _canvas, 1, 0, _canvas.width - 1, _canvas.height, 0, 0, _canvas.width - 1, _canvas.height );\n            var th = 0;\n            iterateKeys( v, function ( j ) {\n                var h = v[ j ] * _canvas.height;\n                _ctx.fillStyle = _colours[ j ];\n                _ctx.fillRect( _canvas.width - 1, th, 1, h );\n                th += h;\n            } );\n        }\n\n        _init();\n\n        return {\n            draw: _draw\n        };\n\n    }\n\n    function PerfCounter ( id, group ) {\n\n        var _id = id,\n            _time,\n            _value = 0,\n            _total = 0,\n            _averageValue = 0,\n            _accumValue = 0,\n            _accumStart = performance.now(),\n            _accumSamples = 0,\n            _dom = document.createElement( 'div' ),\n            _spanId = document.createElement( 'span' ),\n            _spanValue = document.createElement( 'div' ),\n            _spanValueText = document.createTextNode( '' ),\n            _def = _settings ? _settings.values[ _id.toLowerCase() ] : null,\n            _graph = new Graph( _dom, _id, _def ),\n            _started = false;\n\n        _spanId.className = 'rs-counter-id';\n        _spanId.textContent = ( _def && _def.caption ) ? _def.caption : _id;\n\n        _spanValue.className = 'rs-counter-value';\n        _spanValue.appendChild( _spanValueText );\n\n        _dom.appendChild( _spanId );\n        _dom.appendChild( _spanValue );\n        if ( group ) group.div.appendChild( _dom );\n        else _div.appendChild( _dom );\n\n        _time = performance.now();\n\n        function _average ( v ) {\n            if ( _def && _def.average ) {\n                _accumValue += v;\n                _accumSamples++;\n                var t = performance.now();\n                if ( t - _accumStart >= ( _def.avgMs || 1000 ) ) {\n                    _averageValue = _accumValue / _accumSamples;\n                    _accumValue = 0;\n                    _accumStart = t;\n                    _accumSamples = 0;\n                }\n            }\n        }\n\n        function _start () {\n            _time = performance.now();\n            if( _settings.userTimingAPI ) performance.mark( _id + '-start' );\n            _started = true;\n        }\n\n        function _end () {\n            _value = performance.now() - _time;\n            if( _settings.userTimingAPI ) {\n                performance.mark( _id + '-end' );\n                if( _started ) {\n                    performance.measure( _id, _id + '-start', _id + '-end' );\n                }\n            }\n            _average( _value );\n        }\n\n        function _tick () {\n            _end();\n            _start();\n        }\n\n        function _draw () {\n            var v = ( _def && _def.average ) ? _averageValue : _value;\n            _spanValueText.nodeValue = Math.round( v * 100 ) / 100;\n            var a = ( _def && ( ( _def.below && _value < _def.below ) || ( _def.over && _value > _def.over ) ) );\n            _graph.draw( _value, a );\n            _dom.className = a ? 'rs-counter-base alarm' : 'rs-counter-base';\n\n        }\n\n        function _frame () {\n            var t = performance.now();\n            var e = t - _time;\n            _total++;\n            if ( e > 1000 ) {\n                if ( _def && _def.interpolate === false ) {\n                    _value = _total;\n                } else {\n                    _value = _total * 1000 / e;\n                }\n                _total = 0;\n                _time = t;\n                _average( _value );\n            }\n        }\n\n        function _set ( v ) {\n            _value = v;\n            _average( _value );\n        }\n\n        return {\n            set: _set,\n            start: _start,\n            tick: _tick,\n            end: _end,\n            frame: _frame,\n            value: function () {\n                return _value;\n            },\n            draw: _draw\n        };\n\n    }\n\n    function sample () {\n\n        var _value = 0;\n\n        function _set ( v ) {\n            _value = v;\n        }\n\n        return {\n            set: _set,\n            value: function () {\n                return _value;\n            }\n        };\n\n    }\n\n    function _perf ( idArg ) {\n\n        var id = idArg.toLowerCase();\n        if ( id === undefined ) id = 'default';\n        if ( _perfCounters[ id ] ) return _perfCounters[ id ];\n\n        var group = null;\n        if ( _settings && _settings.groups ) {\n            iterateKeys( _settings.groups, function ( j ) {\n                var g = _settings.groups[ parseInt( j, 10 ) ];\n                if ( !group && g.values.indexOf( id.toLowerCase() ) !== -1 ) {\n                    group = g;\n                }\n            } );\n        }\n\n        var p = new PerfCounter( id, group );\n        _perfCounters[ id ] = p;\n        return p;\n\n    }\n\n    function _init () {\n\n        if ( _settings.plugins ) {\n            if ( !_settings.values ) _settings.values = {};\n            if ( !_settings.groups ) _settings.groups = [];\n            if ( !_settings.fractions ) _settings.fractions = [];\n            for ( var j = 0; j < _settings.plugins.length; j++ ) {\n                _settings.plugins[ j ].attach( _perf );\n                iterateKeys( _settings.plugins[ j ].values, function ( k ) {\n                    _settings.values[ k ] = _settings.plugins[ j ].values[ k ];\n                } );\n                _settings.groups = _settings.groups.concat( _settings.plugins[ j ].groups );\n                _settings.fractions = _settings.fractions.concat( _settings.plugins[ j ].fractions );\n            }\n        } else {\n            _settings.plugins = {};\n        }\n\n        _base = document.createElement( 'div' );\n        _base.className = 'rs-base';\n        _div = document.createElement( 'div' );\n        _div.className = 'rs-container';\n        _div.style.height = 'auto';\n        _base.appendChild( _div );\n        document.body.appendChild( _base );\n\n        if ( !_settings ) return;\n\n        if ( _settings.groups ) {\n            iterateKeys( _settings.groups, function ( j ) {\n                var g = _settings.groups[ parseInt( j, 10 ) ];\n                var div = document.createElement( 'div' );\n                div.className = 'rs-group';\n                g.div = div;\n                var h1 = document.createElement( 'h1' );\n                h1.textContent = g.caption;\n                h1.addEventListener( 'click', function ( e ) {\n                    this.classList.toggle( 'hidden' );\n                    e.preventDefault();\n                }.bind( div ) );\n                _div.appendChild( h1 );\n                _div.appendChild( div );\n            } );\n        }\n\n        if ( _settings.fractions ) {\n            iterateKeys( _settings.fractions, function ( j ) {\n                var f = _settings.fractions[ parseInt( j, 10 ) ];\n                var div = document.createElement( 'div' );\n                div.className = 'rs-fraction';\n                var legend = document.createElement( 'div' );\n                legend.className = 'rs-legend';\n\n                var h = 0;\n                iterateKeys( _settings.fractions[ j ].steps, function ( k ) {\n                    var p = document.createElement( 'p' );\n                    p.textContent = _settings.fractions[ j ].steps[ k ];\n                    p.style.color = _colours[ h ];\n                    legend.appendChild( p );\n                    h++;\n                } );\n                div.appendChild( legend );\n                div.style.height = h * _elHeight + 'px';\n                f.div = div;\n                var graph = new StackGraph( div, h );\n                f.graph = graph;\n                _div.appendChild( div );\n            } );\n        }\n\n    }\n\n    function _update () {\n\n        iterateKeys( _settings.plugins, function ( j ) {\n            _settings.plugins[ j ].update();\n        } );\n\n        iterateKeys( _perfCounters, function ( j ) {\n            _perfCounters[ j ].draw();\n        } );\n\n        if ( _settings && _settings.fractions ) {\n            iterateKeys( _settings.fractions, function ( j ) {\n                var f = _settings.fractions[ parseInt( j, 10 ) ];\n                var v = [];\n                var base = _perfCounters[ f.base.toLowerCase() ];\n                if ( base ) {\n                    base = base.value();\n                    iterateKeys( _settings.fractions[ j ].steps, function ( k ) {\n                        var s = _settings.fractions[ j ].steps[ parseInt( k, 10 ) ].toLowerCase();\n                        var val = _perfCounters[ s ];\n                        if ( val ) {\n                            v.push( val.value() / base );\n                        }\n                    } );\n                }\n                f.graph.draw( v );\n            } );\n        }\n\n        /*if( _height != _div.clientHeight ) {\n            _height = _div.clientHeight;\n            _base.style.height = _height + 2 * _elHeight + 'px';\n        console.log( _base.clientHeight );\n        }*/\n\n    }\n\n    _init();\n\n    return function ( id ) {\n        if ( id ) return _perf( id );\n        return {\n            element: _base,\n            update: _update\n        };\n    };\n\n}\n\nif (typeof module === 'object') {\n  module.exports = window.rStats;\n}\n","window.glStats = function () {\n\n    var _rS = null;\n\n    var _totalDrawArraysCalls = 0,\n        _totalDrawElementsCalls = 0,\n        _totalUseProgramCalls = 0,\n        _totalFaces = 0,\n        _totalVertices = 0,\n        _totalPoints = 0,\n        _totalBindTexures = 0;\n\n    function _h ( f, c ) {\n        return function () {\n            c.apply( this, arguments );\n            f.apply( this, arguments );\n        };\n    }\n\n    WebGLRenderingContext.prototype.drawArrays = _h( WebGLRenderingContext.prototype.drawArrays, function () {\n        _totalDrawArraysCalls++;\n        if ( arguments[ 0 ] == this.POINTS ) _totalPoints += arguments[ 2 ];\n        else _totalVertices += arguments[ 2 ];\n    } );\n\n    WebGLRenderingContext.prototype.drawElements = _h( WebGLRenderingContext.prototype.drawElements, function () {\n        _totalDrawElementsCalls++;\n        _totalFaces += arguments[ 1 ] / 3;\n        _totalVertices += arguments[ 1 ];\n    } );\n\n    WebGLRenderingContext.prototype.useProgram = _h( WebGLRenderingContext.prototype.useProgram, function () {\n        _totalUseProgramCalls++;\n    } );\n\n    WebGLRenderingContext.prototype.bindTexture = _h( WebGLRenderingContext.prototype.bindTexture, function () {\n        _totalBindTexures++;\n    } );\n\n    var _values = {\n        allcalls: {\n            over: 3000,\n            caption: 'Calls (hook)'\n        },\n        drawelements: {\n            caption: 'drawElements (hook)'\n        },\n        drawarrays: {\n            caption: 'drawArrays (hook)'\n        }\n    };\n\n    var _groups = [ {\n        caption: 'WebGL',\n        values: [ 'allcalls', 'drawelements', 'drawarrays', 'useprogram', 'bindtexture', 'glfaces', 'glvertices', 'glpoints' ]\n    } ];\n\n    var _fractions = [ {\n        base: 'allcalls',\n        steps: [ 'drawelements', 'drawarrays' ]\n    } ];\n\n    function _update () {\n        _rS( 'allcalls' ).set( _totalDrawArraysCalls + _totalDrawElementsCalls );\n        _rS( 'drawElements' ).set( _totalDrawElementsCalls );\n        _rS( 'drawArrays' ).set( _totalDrawArraysCalls );\n        _rS( 'bindTexture' ).set( _totalBindTexures );\n        _rS( 'useProgram' ).set( _totalUseProgramCalls );\n        _rS( 'glfaces' ).set( _totalFaces );\n        _rS( 'glvertices' ).set( _totalVertices );\n        _rS( 'glpoints' ).set( _totalPoints );\n    }\n\n    function _start () {\n        _totalDrawArraysCalls = 0;\n        _totalDrawElementsCalls = 0;\n        _totalUseProgramCalls = 0;\n        _totalFaces = 0;\n        _totalVertices = 0;\n        _totalPoints = 0;\n        _totalBindTexures = 0;\n    }\n\n    function _end () {}\n\n    function _attach ( r ) {\n        _rS = r;\n    }\n\n    return {\n        update: _update,\n        start: _start,\n        end: _end,\n        attach: _attach,\n        values: _values,\n        groups: _groups,\n        fractions: _fractions\n    };\n\n};\n\nwindow.threeStats = function ( renderer ) {\n\n    var _rS = null;\n\n    var _values = {\n        'renderer.info.memory.geometries': {\n            caption: 'Geometries'\n        },\n        'renderer.info.memory.textures': {\n            caption: 'Textures'\n        },\n        'renderer.info.programs': {\n            caption: 'Programs'\n        },\n        'renderer.info.render.calls': {\n            caption: 'Calls'\n        },\n        'renderer.info.render.faces': {\n            caption: 'Faces',\n            over: 1000\n        },\n        'renderer.info.render.points': {\n            caption: 'Points'\n        },\n        'renderer.info.render.vertices': {\n            caption: 'Vertices'\n        }\n    };\n\n    var _groups = [ {\n        caption: 'Three.js - Memory',\n        values: [ 'renderer.info.memory.geometries', 'renderer.info.programs', 'renderer.info.memory.textures' ]\n    }, {\n        caption: 'Three.js - Render',\n        values: [ 'renderer.info.render.calls', 'renderer.info.render.faces', 'renderer.info.render.points', 'renderer.info.render.vertices' ]\n    } ];\n\n    var _fractions = [];\n\n    function _update () {\n\n        _rS( 'renderer.info.memory.geometries' ).set( renderer.info.memory.geometries );\n        _rS( 'renderer.info.programs' ).set( renderer.info.programs.length );\n        _rS( 'renderer.info.memory.textures' ).set( renderer.info.memory.textures );\n        _rS( 'renderer.info.render.calls' ).set( renderer.info.render.calls );\n        _rS( 'renderer.info.render.faces' ).set( renderer.info.render.faces );\n        _rS( 'renderer.info.render.points' ).set( renderer.info.render.points );\n        _rS( 'renderer.info.render.vertices' ).set( renderer.info.render.vertices );\n\n    }\n\n    function _start () {}\n\n    function _end () {}\n\n    function _attach ( r ) {\n        _rS = r;\n    }\n\n    return {\n        update: _update,\n        start: _start,\n        end: _end,\n        attach: _attach,\n        values: _values,\n        groups: _groups,\n        fractions: _fractions\n    };\n\n};\n\n/*\n *   From https://github.com/paulirish/memory-stats.js\n */\n\nwindow.BrowserStats = function () {\n\n    var _rS = null;\n\n    var _usedJSHeapSize = 0,\n        _totalJSHeapSize = 0;\n\n    if ( window.performance && !performance.memory ) {\n        performance.memory = {\n            usedJSHeapSize: 0,\n            totalJSHeapSize: 0\n        };\n    }\n\n    if ( performance.memory.totalJSHeapSize === 0 ) {\n        console.warn( 'totalJSHeapSize === 0... performance.memory is only available in Chrome .' );\n    }\n\n    var _values = {\n        memory: {\n            caption: 'Used Memory',\n            average: true,\n            avgMs: 1000,\n            over: 22\n        },\n        total: {\n            caption: 'Total Memory'\n        }\n    };\n\n    var _groups = [ {\n        caption: 'Browser',\n        values: [ 'memory', 'total' ]\n    } ];\n\n    var _fractions = [ {\n        base: 'total',\n        steps: [ 'memory' ]\n    } ];\n\n    var log1024 = Math.log( 1024 );\n\n    function _size ( v ) {\n\n        var precision = 100; //Math.pow(10, 2);\n        var i = Math.floor( Math.log( v ) / log1024 );\n        return Math.round( v * precision / Math.pow( 1024, i ) ) / precision; // + ' ' + sizes[i];\n\n    }\n\n    function _update () {\n        _usedJSHeapSize = _size( performance.memory.usedJSHeapSize );\n        _totalJSHeapSize = _size( performance.memory.totalJSHeapSize );\n\n        _rS( 'memory' ).set( _usedJSHeapSize );\n        _rS( 'total' ).set( _totalJSHeapSize );\n    }\n\n    function _start () {\n        _usedJSHeapSize = 0;\n    }\n\n    function _end () {}\n\n    function _attach ( r ) {\n        _rS = r;\n    }\n\n    return {\n        update: _update,\n        start: _start,\n        end: _end,\n        attach: _attach,\n        values: _values,\n        groups: _groups,\n        fractions: _fractions\n    };\n\n};\n\nif (typeof module === 'object') {\n  module.exports = {\n    glStats: window.glStats,\n    threeStats: window.threeStats,\n    BrowserStats: window.BrowserStats\n  };\n}\n","'use strict';\nmodule.exports = function (x) {\n\tvar type = typeof x;\n\treturn x !== null && (type === 'object' || type === 'function');\n};\n","module.exports = {\n  AFRAME_INJECTED: 'aframe-injected',\n  DEFAULT_CAMERA_HEIGHT: 1.6,\n  animation: require('./animation'),\n  keyboardevent: require('./keyboardevent')\n};\n","window.aframeStats = function (scene) {\n  var _rS = null;\n  var _scene = scene;\n  var _values = {\n    te: {\n      caption: 'Entities'\n    },\n    lt: {\n      caption: 'Load Time'\n    }\n  };\n  var _groups = [ {\n    caption: 'A-Frame',\n    values: [ 'te', 'lt' ]\n  } ];\n\n  function _update () {\n    _rS('te').set(getEntityCount());\n    if (window.performance.getEntriesByName) {\n      _rS('lt').set(window.performance.getEntriesByName('render-started')[0].startTime.toFixed(0));\n    }\n  }\n\n  function getEntityCount () {\n    var elements = _scene.querySelectorAll('*');\n    Array.prototype.slice.call(elements).filter(function (el) {\n      return el.isEntity;\n    });\n    return elements.length;\n  }\n\n  function _start () {}\n\n  function _end () {}\n\n  function _attach (r) {\n    _rS = r;\n  }\n\n  return {\n    update: _update,\n    start: _start,\n    end: _end,\n    attach: _attach,\n    values: _values,\n    groups: _groups,\n    fractions: []\n  };\n};\n\nif (typeof module === 'object') {\n  module.exports = {\n    aframeStats: window.aframeStats\n  };\n}\n","\n/**\n * This is the web browser implementation of `debug()`.\n *\n * Expose `debug()` as the module.\n */\n\nexports = module.exports = require('./debug');\nexports.log = log;\nexports.formatArgs = formatArgs;\nexports.save = save;\nexports.load = load;\nexports.useColors = useColors;\nexports.storage = 'undefined' != typeof chrome\n               && 'undefined' != typeof chrome.storage\n                  ? chrome.storage.local\n                  : localstorage();\n\n/**\n * Colors.\n */\n\nexports.colors = [\n  'lightseagreen',\n  'forestgreen',\n  'goldenrod',\n  'dodgerblue',\n  'darkorchid',\n  'crimson'\n];\n\n/**\n * Currently only WebKit-based Web Inspectors, Firefox >= v31,\n * and the Firebug extension (any Firefox version) are known\n * to support \"%c\" CSS customizations.\n *\n * TODO: add a `localStorage` variable to explicitly enable/disable colors\n */\n\nfunction useColors() {\n  // is webkit? http://stackoverflow.com/a/16459606/376773\n  return ('WebkitAppearance' in document.documentElement.style) ||\n    // is firebug? http://stackoverflow.com/a/398120/376773\n    (window.console && (console.firebug || (console.exception && console.table))) ||\n    // is firefox >= v31?\n    // https://developer.mozilla.org/en-US/docs/Tools/Web_Console#Styling_messages\n    (navigator.userAgent.toLowerCase().match(/firefox\\/(\\d+)/) && parseInt(RegExp.$1, 10) >= 31);\n}\n\n/**\n * Map %j to `JSON.stringify()`, since no Web Inspectors do that by default.\n */\n\nexports.formatters.j = function(v) {\n  return JSON.stringify(v);\n};\n\n\n/**\n * Colorize log arguments if enabled.\n *\n * @api public\n */\n\nfunction formatArgs() {\n  var args = arguments;\n  var useColors = this.useColors;\n\n  args[0] = (useColors ? '%c' : '')\n    + this.namespace\n    + (useColors ? ' %c' : ' ')\n    + args[0]\n    + (useColors ? '%c ' : ' ')\n    + '+' + exports.humanize(this.diff);\n\n  if (!useColors) return args;\n\n  var c = 'color: ' + this.color;\n  args = [args[0], c, 'color: inherit'].concat(Array.prototype.slice.call(args, 1));\n\n  // the final \"%c\" is somewhat tricky, because there could be other\n  // arguments passed either before or after the %c, so we need to\n  // figure out the correct index to insert the CSS into\n  var index = 0;\n  var lastC = 0;\n  args[0].replace(/%[a-z%]/g, function(match) {\n    if ('%%' === match) return;\n    index++;\n    if ('%c' === match) {\n      // we only are interested in the *last* %c\n      // (the user may have provided their own)\n      lastC = index;\n    }\n  });\n\n  args.splice(lastC, 0, c);\n  return args;\n}\n\n/**\n * Invokes `console.log()` when available.\n * No-op when `console.log` is not a \"function\".\n *\n * @api public\n */\n\nfunction log() {\n  // this hackery is required for IE8/9, where\n  // the `console.log` function doesn't have 'apply'\n  return 'object' === typeof console\n    && console.log\n    && Function.prototype.apply.call(console.log, console, arguments);\n}\n\n/**\n * Save `namespaces`.\n *\n * @param {String} namespaces\n * @api private\n */\n\nfunction save(namespaces) {\n  try {\n    if (null == namespaces) {\n      exports.storage.removeItem('debug');\n    } else {\n      exports.storage.debug = namespaces;\n    }\n  } catch(e) {}\n}\n\n/**\n * Load `namespaces`.\n *\n * @return {String} returns the previously persisted debug modes\n * @api private\n */\n\nfunction load() {\n  var r;\n  try {\n    r = exports.storage.debug;\n  } catch(e) {}\n  return r;\n}\n\n/**\n * Enable namespaces listed in `localStorage.debug` initially.\n */\n\nexports.enable(load());\n\n/**\n * Localstorage attempts to return the localstorage.\n *\n * This is necessary because safari throws\n * when a user disables cookies/localstorage\n * and you attempt to access it.\n *\n * @return {LocalStorage}\n * @api private\n */\n\nfunction localstorage(){\n  try {\n    return window.localStorage;\n  } catch (e) {}\n}\n","/**\r\n * @author Michael Guerrero / http://realitymeltdown.com\r\n */\r\n\r\nTHREE.BlendCharacter = function () {\r\n\r\n\tthis.weightSchedule = [];\r\n\tthis.warpSchedule = [];\r\n\r\n\tthis.load = function ( url, onLoad ) {\r\n\r\n\t\tvar scope = this;\r\n\r\n\t\tvar loader = new THREE.ObjectLoader();\r\n\t\tloader.load( url, function( loadedObject ) {\r\n\r\n\t\t\t// The exporter does not currently allow exporting a skinned mesh by itself\r\n\t\t\t// so we must fish it out of the hierarchy it is embedded in (scene)\r\n\t\t\tloadedObject.traverse( function( object ) {\r\n\r\n\t\t\t\tif ( object instanceof THREE.SkinnedMesh ) {\r\n\r\n\t\t\t\t\tscope.skinnedMesh = object;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t} );\r\n\r\n\t\t\tTHREE.SkinnedMesh.call( scope, scope.skinnedMesh.geometry, scope.skinnedMesh.material );\r\n\r\n\t\t\t// If we didn't successfully find the mesh, bail out\r\n\t\t\tif ( scope.skinnedMesh == undefined ) {\r\n\r\n\t\t\t\tconsole.log( 'unable to find skinned mesh in ' + url );\r\n\t\t\t\treturn;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tscope.material.skinning = true;\r\n\r\n\t\t\tscope.mixer = new THREE.AnimationMixer( scope );\r\n\t\t\tscope.mixer = scope.mixer;\r\n\r\n\t\t\t// Create the animations\r\n\t\t\tfor ( var i = 0; i < scope.geometry.animations.length; ++ i ) {\r\n\r\n\t\t\t\tscope.mixer.clipAction( scope.geometry.animations[ i ] );\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// Loading is complete, fire the callback\r\n\t\t\tif ( onLoad !== undefined ) onLoad();\r\n\r\n\t\t} );\r\n\r\n\t};\r\n\r\n\tthis.update = function( dt ) {\r\n\r\n\t\tthis.mixer.update( dt );\r\n\r\n\t};\r\n\r\n\tthis.play = function( animName, weight ) {\r\n\r\n\t\t//console.log(\"play('%s', %f)\", animName, weight);\r\n\t\treturn this.mixer.clipAction( animName ).\r\n\t\t\t\tsetEffectiveWeight( weight ).play();\r\n\t};\r\n\r\n\tthis.crossfade = function( fromAnimName, toAnimName, duration ) {\r\n\r\n\t\tthis.mixer.stopAllAction();\r\n\r\n\t\tvar fromAction = this.play( fromAnimName, 1 );\r\n\t\tvar toAction = this.play( toAnimName, 1 );\r\n\r\n\t\tfromAction.crossFadeTo( toAction, duration, false );\r\n\r\n\t};\r\n\r\n\tthis.warp = function( fromAnimName, toAnimName, duration ) {\r\n\r\n\t\tthis.mixer.stopAllAction();\r\n\r\n\t\tvar fromAction = this.play( fromAnimName, 1 );\r\n\t\tvar toAction = this.play( toAnimName, 1 );\r\n\r\n\t\tfromAction.crossFadeTo( toAction, duration, true );\r\n\r\n\t};\r\n\r\n\tthis.applyWeight = function( animName, weight ) {\r\n\r\n\t\tthis.mixer.clipAction( animName ).setEffectiveWeight( weight );\r\n\r\n\t};\r\n\r\n\tthis.getWeight = function( animName ) {\r\n\r\n\t\treturn this.mixer.clipAction( animName ).getEffectiveWeight();\r\n\r\n\t}\r\n\r\n\tthis.pauseAll = function() {\r\n\r\n\t\tthis.mixer.timeScale = 0;\r\n\r\n\t};\r\n\r\n\tthis.unPauseAll = function() {\r\n\r\n\t\tthis.mixer.timeScale = 1;\r\n\r\n\t};\r\n\r\n\r\n\tthis.stopAll = function() {\r\n\r\n\t\tthis.mixer.stopAllAction();\r\n\r\n\t};\r\n\r\n\tthis.showModel = function( boolean ) {\r\n\r\n\t\tthis.visible = boolean;\r\n\r\n\t}\r\n\r\n};\r\n\r\n\r\nTHREE.BlendCharacter.prototype = Object.create( THREE.SkinnedMesh.prototype );\r\nTHREE.BlendCharacter.prototype.constructor = THREE.BlendCharacter;\r\n\r\nTHREE.BlendCharacter.prototype.getForward = function() {\r\n\r\n\tvar forward = new THREE.Vector3();\r\n\r\n\treturn function() {\r\n\r\n\t\t// pull the character's forward basis vector out of the matrix\r\n\t\tforward.set(\r\n\t\t\t- this.matrix.elements[ 8 ],\r\n\t\t\t- this.matrix.elements[ 9 ],\r\n\t\t\t- this.matrix.elements[ 10 ]\r\n\t\t);\r\n\r\n\t\treturn forward;\r\n\r\n\t}\r\n\r\n};\r\n\r\n","/*\n\nstyle-attr\n====\n\nVery simple parsing and stringifying of style attributes.\n\n`parse`\n----\n\nConvert a style attribute string to an object.\n\n- input: string (eg. anything you might see in a style attribute)\n- return: object\n\n*/\nfunction parse (raw) {\n  var trim = function (s) { return s.trim(); };\n  var obj = {};\n\n  getKeyValueChunks(raw)\n    .map(trim)\n    .filter(Boolean)\n    .forEach(function (item) {\n      // split with `.indexOf` rather than `.split` because the value may also contain colons.\n      var pos = item.indexOf(':');\n      var key = item.substr(0, pos).trim();\n      var val = item.substr(pos + 1).trim();\n\n      obj[key] = val;\n    });\n\n  return obj;\n}\n\n/*\n\n`getKeyValueChunks`\n----\n\nSplit a string into chunks matching `<key>: <value>`\n\n- input: string\n- return: Array<string>\n\n*/\nfunction getKeyValueChunks (raw) {\n  var chunks = [];\n  var offset = 0;\n  var sep = ';';\n  var hasUnclosedUrl = /url\\([^\\)]+$/;\n  var chunk = '';\n  var nextSplit;\n  while (offset < raw.length) {\n    nextSplit = raw.indexOf(sep, offset);\n    if (nextSplit === -1) { nextSplit = raw.length; }\n\n    chunk += raw.substring(offset, nextSplit);\n\n    // data URIs can contain semicolons, so make sure we get the whole thing\n    if (hasUnclosedUrl.test(chunk)) {\n      chunk += ';';\n      offset = nextSplit + 1;\n      continue;\n    }\n\n    chunks.push(chunk);\n    chunk = '';\n    offset = nextSplit + 1;\n  }\n\n  return chunks;\n}\n\n/*\n\n`stringify`\n----\n\nConvert an object into an attribute string\n\n- input: object\n- return: string\n\n*/\nfunction stringify (obj) {\n  return Object.keys(obj)\n    .map(function (key) {\n      return key + ':' + obj[key];\n    })\n    .join(';');\n}\n\n/*\n\n`normalize`\n----\n\nNormalize an attribute string (eg. collapse duplicates)\n\n- input: string\n- return: string\n\n*/\nfunction normalize (str) {\n  return stringify(parse(str));\n}\n\nmodule.exports.parse = parse;\nmodule.exports.stringify = stringify;\nmodule.exports.normalize = normalize;\n","/*\n * Copyright 2015 Google Inc. All Rights Reserved.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nvar Util = require('./util.js');\n\n/**\n * Android and iOS compatible wakelock implementation.\n *\n * Refactored thanks to dkovalev@.\n */\nfunction AndroidWakeLock() {\n  var video = document.createElement('video');\n\n  video.addEventListener('ended', function() {\n    video.play();\n  });\n\n  this.request = function() {\n    if (video.paused) {\n      // Base64 version of videos_src/no-sleep-60s.webm.\n      video.src = Util.base64('video/webm', 'GkXfowEAAAAAAAAfQoaBAUL3gQFC8oEEQvOBCEKChHdlYm1Ch4ECQoWBAhhTgGcBAAAAAAAH4xFNm3RALE27i1OrhBVJqWZTrIHfTbuMU6uEFlSua1OsggEwTbuMU6uEHFO7a1OsggfG7AEAAAAAAACkAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAVSalmAQAAAAAAAEUq17GDD0JATYCNTGF2ZjU2LjQwLjEwMVdBjUxhdmY1Ni40MC4xMDFzpJAGSJTMbsLpDt/ySkipgX1fRImIQO1MAAAAAAAWVK5rAQAAAAAAADuuAQAAAAAAADLXgQFzxYEBnIEAIrWcg3VuZIaFVl9WUDmDgQEj44OEO5rKAOABAAAAAAAABrCBsLqBkB9DtnUBAAAAAAAAo+eBAKOmgQAAgKJJg0IAAV4BHsAHBIODCoAACmH2MAAAZxgz4dPSTFi5JACjloED6ACmAECSnABMQAADYAAAWi0quoCjloEH0ACmAECSnABNwAADYAAAWi0quoCjloELuACmAECSnABNgAADYAAAWi0quoCjloEPoACmAECSnABNYAADYAAAWi0quoCjloETiACmAECSnABNIAADYAAAWi0quoAfQ7Z1AQAAAAAAAJTnghdwo5aBAAAApgBAkpwATOAAA2AAAFotKrqAo5aBA+gApgBAkpwATMAAA2AAAFotKrqAo5aBB9AApgBAkpwATIAAA2AAAFotKrqAo5aBC7gApgBAkpwATEAAA2AAAFotKrqAo5aBD6AApgDAkpwAQ2AAA2AAAFotKrqAo5aBE4gApgBAkpwATCAAA2AAAFotKrqAH0O2dQEAAAAAAACU54Iu4KOWgQAAAKYAQJKcAEvAAANgAABaLSq6gKOWgQPoAKYAQJKcAEtgAANgAABaLSq6gKOWgQfQAKYAQJKcAEsAAANgAABaLSq6gKOWgQu4AKYAQJKcAEqAAANgAABaLSq6gKOWgQ+gAKYAQJKcAEogAANgAABaLSq6gKOWgROIAKYAQJKcAEnAAANgAABaLSq6gB9DtnUBAAAAAAAAlOeCRlCjloEAAACmAECSnABJgAADYAAAWi0quoCjloED6ACmAECSnABJIAADYAAAWi0quoCjloEH0ACmAMCSnABDYAADYAAAWi0quoCjloELuACmAECSnABI4AADYAAAWi0quoCjloEPoACmAECSnABIoAADYAAAWi0quoCjloETiACmAECSnABIYAADYAAAWi0quoAfQ7Z1AQAAAAAAAJTngl3Ao5aBAAAApgBAkpwASCAAA2AAAFotKrqAo5aBA+gApgBAkpwASAAAA2AAAFotKrqAo5aBB9AApgBAkpwAR8AAA2AAAFotKrqAo5aBC7gApgBAkpwAR4AAA2AAAFotKrqAo5aBD6AApgBAkpwAR2AAA2AAAFotKrqAo5aBE4gApgBAkpwARyAAA2AAAFotKrqAH0O2dQEAAAAAAACU54J1MKOWgQAAAKYAwJKcAENgAANgAABaLSq6gKOWgQPoAKYAQJKcAEbgAANgAABaLSq6gKOWgQfQAKYAQJKcAEagAANgAABaLSq6gKOWgQu4AKYAQJKcAEaAAANgAABaLSq6gKOWgQ+gAKYAQJKcAEZAAANgAABaLSq6gKOWgROIAKYAQJKcAEYAAANgAABaLSq6gB9DtnUBAAAAAAAAlOeCjKCjloEAAACmAECSnABF4AADYAAAWi0quoCjloED6ACmAECSnABFwAADYAAAWi0quoCjloEH0ACmAECSnABFoAADYAAAWi0quoCjloELuACmAECSnABFgAADYAAAWi0quoCjloEPoACmAMCSnABDYAADYAAAWi0quoCjloETiACmAECSnABFYAADYAAAWi0quoAfQ7Z1AQAAAAAAAJTngqQQo5aBAAAApgBAkpwARUAAA2AAAFotKrqAo5aBA+gApgBAkpwARSAAA2AAAFotKrqAo5aBB9AApgBAkpwARQAAA2AAAFotKrqAo5aBC7gApgBAkpwARQAAA2AAAFotKrqAo5aBD6AApgBAkpwAROAAA2AAAFotKrqAo5aBE4gApgBAkpwARMAAA2AAAFotKrqAH0O2dQEAAAAAAACU54K7gKOWgQAAAKYAQJKcAESgAANgAABaLSq6gKOWgQPoAKYAQJKcAESAAANgAABaLSq6gKOWgQfQAKYAwJKcAENgAANgAABaLSq6gKOWgQu4AKYAQJKcAERgAANgAABaLSq6gKOWgQ+gAKYAQJKcAERAAANgAABaLSq6gKOWgROIAKYAQJKcAEQgAANgAABaLSq6gB9DtnUBAAAAAAAAlOeC0vCjloEAAACmAECSnABEIAADYAAAWi0quoCjloED6ACmAECSnABEAAADYAAAWi0quoCjloEH0ACmAECSnABD4AADYAAAWi0quoCjloELuACmAECSnABDwAADYAAAWi0quoCjloEPoACmAECSnABDoAADYAAAWi0quoCjloETiACmAECSnABDgAADYAAAWi0quoAcU7trAQAAAAAAABG7j7OBALeK94EB8YIBd/CBAw==');\n      video.play();\n    }\n  };\n\n  this.release = function() {\n    video.pause();\n    video.src = '';\n  };\n}\n\nfunction iOSWakeLock() {\n  var timer = null;\n\n  this.request = function() {\n    if (!timer) {\n      timer = setInterval(function() {\n        window.location = window.location;\n        setTimeout(window.stop, 0);\n      }, 30000);\n    }\n  }\n\n  this.release = function() {\n    if (timer) {\n      clearInterval(timer);\n      timer = null;\n    }\n  }\n}\n\n\nfunction getWakeLock() {\n  var userAgent = navigator.userAgent || navigator.vendor || window.opera;\n  if (userAgent.match(/iPhone/i) || userAgent.match(/iPod/i)) {\n    return iOSWakeLock;\n  } else {\n    return AndroidWakeLock;\n  }\n}\n\nmodule.exports = getWakeLock();\n","/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.OBJLoader = function ( manager ) {\r\n\r\n\tthis.manager = ( manager !== undefined ) ? manager : THREE.DefaultLoadingManager;\r\n\r\n\tthis.materials = null;\r\n\r\n\tthis.regexp = {\r\n\t\t// v float float float\r\n\t\tvertex_pattern           : /^v\\s+([\\d|\\.|\\+|\\-|e|E]+)\\s+([\\d|\\.|\\+|\\-|e|E]+)\\s+([\\d|\\.|\\+|\\-|e|E]+)/,\r\n\t\t// vn float float float\r\n\t\tnormal_pattern           : /^vn\\s+([\\d|\\.|\\+|\\-|e|E]+)\\s+([\\d|\\.|\\+|\\-|e|E]+)\\s+([\\d|\\.|\\+|\\-|e|E]+)/,\r\n\t\t// vt float float\r\n\t\tuv_pattern               : /^vt\\s+([\\d|\\.|\\+|\\-|e|E]+)\\s+([\\d|\\.|\\+|\\-|e|E]+)/,\r\n\t\t// f vertex vertex vertex\r\n\t\tface_vertex              : /^f\\s+(-?\\d+)\\s+(-?\\d+)\\s+(-?\\d+)(?:\\s+(-?\\d+))?/,\r\n\t\t// f vertex/uv vertex/uv vertex/uv\r\n\t\tface_vertex_uv           : /^f\\s+(-?\\d+)\\/(-?\\d+)\\s+(-?\\d+)\\/(-?\\d+)\\s+(-?\\d+)\\/(-?\\d+)(?:\\s+(-?\\d+)\\/(-?\\d+))?/,\r\n\t\t// f vertex/uv/normal vertex/uv/normal vertex/uv/normal\r\n\t\tface_vertex_uv_normal    : /^f\\s+(-?\\d+)\\/(-?\\d+)\\/(-?\\d+)\\s+(-?\\d+)\\/(-?\\d+)\\/(-?\\d+)\\s+(-?\\d+)\\/(-?\\d+)\\/(-?\\d+)(?:\\s+(-?\\d+)\\/(-?\\d+)\\/(-?\\d+))?/,\r\n\t\t// f vertex//normal vertex//normal vertex//normal\r\n\t\tface_vertex_normal       : /^f\\s+(-?\\d+)\\/\\/(-?\\d+)\\s+(-?\\d+)\\/\\/(-?\\d+)\\s+(-?\\d+)\\/\\/(-?\\d+)(?:\\s+(-?\\d+)\\/\\/(-?\\d+))?/,\r\n\t\t// o object_name | g group_name\r\n\t\tobject_pattern           : /^[og]\\s*(.+)?/,\r\n\t\t// s boolean\r\n\t\tsmoothing_pattern        : /^s\\s+(\\d+|on|off)/,\r\n\t\t// mtllib file_reference\r\n\t\tmaterial_library_pattern : /^mtllib /,\r\n\t\t// usemtl material_name\r\n\t\tmaterial_use_pattern     : /^usemtl /\r\n\t};\r\n\r\n};\r\n\r\nTHREE.OBJLoader.prototype = {\r\n\r\n\tconstructor: THREE.OBJLoader,\r\n\r\n\tload: function ( url, onLoad, onProgress, onError ) {\r\n\r\n\t\tvar scope = this;\r\n\r\n\t\tvar loader = new THREE.XHRLoader( scope.manager );\r\n\t\tloader.setPath( this.path );\r\n\t\tloader.load( url, function ( text ) {\r\n\r\n\t\t\tonLoad( scope.parse( text ) );\r\n\r\n\t\t}, onProgress, onError );\r\n\r\n\t},\r\n\r\n\tsetPath: function ( value ) {\r\n\r\n\t\tthis.path = value;\r\n\r\n\t},\r\n\r\n\tsetMaterials: function ( materials ) {\r\n\r\n\t\tthis.materials = materials;\r\n\r\n\t},\r\n\r\n\t_createParserState : function () {\r\n\r\n\t\tvar state = {\r\n\t\t\tobjects  : [],\r\n\t\t\tobject   : {},\r\n\r\n\t\t\tvertices : [],\r\n\t\t\tnormals  : [],\r\n\t\t\tuvs      : [],\r\n\r\n\t\t\tmaterialLibraries : [],\r\n\r\n\t\t\tstartObject: function ( name, fromDeclaration ) {\r\n\r\n\t\t\t\t// If the current object (initial from reset) is not from a g/o declaration in the parsed\r\n\t\t\t\t// file. We need to use it for the first parsed g/o to keep things in sync.\r\n\t\t\t\tif ( this.object && this.object.fromDeclaration === false ) {\r\n\r\n\t\t\t\t\tthis.object.name = name;\r\n\t\t\t\t\tthis.object.fromDeclaration = ( fromDeclaration !== false );\r\n\t\t\t\t\treturn;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tthis.object = {\r\n\t\t\t\t\tname : name || '',\r\n\t\t\t\t\tgeometry : {\r\n\t\t\t\t\t\tvertices : [],\r\n\t\t\t\t\t\tnormals  : [],\r\n\t\t\t\t\t\tuvs      : []\r\n\t\t\t\t\t},\r\n\t\t\t\t\tmaterial : {\r\n\t\t\t\t\t\tname   : '',\r\n\t\t\t\t\t\tsmooth : true\r\n\t\t\t\t\t},\r\n\t\t\t\t\tfromDeclaration : ( fromDeclaration !== false )\r\n\t\t\t\t};\r\n\r\n\t\t\t\tthis.objects.push( this.object );\r\n\r\n\t\t\t},\r\n\r\n\t\t\tparseVertexIndex: function ( value, len ) {\r\n\r\n\t\t\t\tvar index = parseInt( value, 10 );\r\n\t\t\t\treturn ( index >= 0 ? index - 1 : index + len / 3 ) * 3;\r\n\r\n\t\t\t},\r\n\r\n\t\t\tparseNormalIndex: function ( value, len ) {\r\n\r\n\t\t\t\tvar index = parseInt( value, 10 );\r\n\t\t\t\treturn ( index >= 0 ? index - 1 : index + len / 3 ) * 3;\r\n\r\n\t\t\t},\r\n\r\n\t\t\tparseUVIndex: function ( value, len ) {\r\n\r\n\t\t\t\tvar index = parseInt( value, 10 );\r\n\t\t\t\treturn ( index >= 0 ? index - 1 : index + len / 2 ) * 2;\r\n\r\n\t\t\t},\r\n\r\n\t\t\taddVertex: function ( a, b, c ) {\r\n\r\n\t\t\t\tvar src = this.vertices;\r\n\t\t\t\tvar dst = this.object.geometry.vertices;\r\n\r\n\t\t\t\tdst.push( src[ a + 0 ] );\r\n\t\t\t\tdst.push( src[ a + 1 ] );\r\n\t\t\t\tdst.push( src[ a + 2 ] );\r\n\t\t\t\tdst.push( src[ b + 0 ] );\r\n\t\t\t\tdst.push( src[ b + 1 ] );\r\n\t\t\t\tdst.push( src[ b + 2 ] );\r\n\t\t\t\tdst.push( src[ c + 0 ] );\r\n\t\t\t\tdst.push( src[ c + 1 ] );\r\n\t\t\t\tdst.push( src[ c + 2 ] );\r\n\r\n\t\t\t},\r\n\r\n\t\t\taddVertexLine: function ( a ) {\r\n\r\n\t\t\t\tvar src = this.vertices;\r\n\t\t\t\tvar dst = this.object.geometry.vertices;\r\n\r\n\t\t\t\tdst.push( src[ a + 0 ] );\r\n\t\t\t\tdst.push( src[ a + 1 ] );\r\n\t\t\t\tdst.push( src[ a + 2 ] );\r\n\r\n\t\t\t},\r\n\r\n\t\t\taddNormal : function ( a, b, c ) {\r\n\r\n\t\t\t\tvar src = this.normals;\r\n\t\t\t\tvar dst = this.object.geometry.normals;\r\n\r\n\t\t\t\tdst.push( src[ a + 0 ] );\r\n\t\t\t\tdst.push( src[ a + 1 ] );\r\n\t\t\t\tdst.push( src[ a + 2 ] );\r\n\t\t\t\tdst.push( src[ b + 0 ] );\r\n\t\t\t\tdst.push( src[ b + 1 ] );\r\n\t\t\t\tdst.push( src[ b + 2 ] );\r\n\t\t\t\tdst.push( src[ c + 0 ] );\r\n\t\t\t\tdst.push( src[ c + 1 ] );\r\n\t\t\t\tdst.push( src[ c + 2 ] );\r\n\r\n\t\t\t},\r\n\r\n\t\t\taddUV: function ( a, b, c ) {\r\n\r\n\t\t\t\tvar src = this.uvs;\r\n\t\t\t\tvar dst = this.object.geometry.uvs;\r\n\r\n\t\t\t\tdst.push( src[ a + 0 ] );\r\n\t\t\t\tdst.push( src[ a + 1 ] );\r\n\t\t\t\tdst.push( src[ b + 0 ] );\r\n\t\t\t\tdst.push( src[ b + 1 ] );\r\n\t\t\t\tdst.push( src[ c + 0 ] );\r\n\t\t\t\tdst.push( src[ c + 1 ] );\r\n\r\n\t\t\t},\r\n\r\n\t\t\taddUVLine: function ( a ) {\r\n\r\n\t\t\t\tvar src = this.uvs;\r\n\t\t\t\tvar dst = this.object.geometry.uvs;\r\n\r\n\t\t\t\tdst.push( src[ a + 0 ] );\r\n\t\t\t\tdst.push( src[ a + 1 ] );\r\n\r\n\t\t\t},\r\n\r\n\t\t\taddFace: function ( a, b, c, d, ua, ub, uc, ud, na, nb, nc, nd ) {\r\n\r\n\t\t\t\tvar vLen = this.vertices.length;\r\n\r\n\t\t\t\tvar ia = this.parseVertexIndex( a, vLen );\r\n\t\t\t\tvar ib = this.parseVertexIndex( b, vLen );\r\n\t\t\t\tvar ic = this.parseVertexIndex( c, vLen );\r\n\t\t\t\tvar id;\r\n\r\n\t\t\t\tif ( d === undefined ) {\r\n\r\n\t\t\t\t\tthis.addVertex( ia, ib, ic );\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tid = this.parseVertexIndex( d, vLen );\r\n\r\n\t\t\t\t\tthis.addVertex( ia, ib, id );\r\n\t\t\t\t\tthis.addVertex( ib, ic, id );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( ua !== undefined ) {\r\n\r\n\t\t\t\t\tvar uvLen = this.uvs.length;\r\n\r\n\t\t\t\t\tia = this.parseUVIndex( ua, uvLen );\r\n\t\t\t\t\tib = this.parseUVIndex( ub, uvLen );\r\n\t\t\t\t\tic = this.parseUVIndex( uc, uvLen );\r\n\r\n\t\t\t\t\tif ( d === undefined ) {\r\n\r\n\t\t\t\t\t\tthis.addUV( ia, ib, ic );\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\tid = this.parseUVIndex( ud, uvLen );\r\n\r\n\t\t\t\t\t\tthis.addUV( ia, ib, id );\r\n\t\t\t\t\t\tthis.addUV( ib, ic, id );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( na !== undefined ) {\r\n\r\n\t\t\t\t\t// Normals are many times the same. If so, skip function call and parseInt.\r\n\t\t\t\t\tvar nLen = this.normals.length;\r\n\t\t\t\t\tia = this.parseNormalIndex( na, nLen );\r\n\r\n\t\t\t\t\tib = na === nb ? ia : this.parseNormalIndex( nb, nLen );\r\n\t\t\t\t\tic = na === nc ? ia : this.parseNormalIndex( nc, nLen );\r\n\r\n\t\t\t\t\tif ( d === undefined ) {\r\n\r\n\t\t\t\t\t\tthis.addNormal( ia, ib, ic );\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\tid = this.parseNormalIndex( nd, nLen );\r\n\r\n\t\t\t\t\t\tthis.addNormal( ia, ib, id );\r\n\t\t\t\t\t\tthis.addNormal( ib, ic, id );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t},\r\n\r\n\t\t\taddLineGeometry: function ( vertices, uvs ) {\r\n\r\n\t\t\t\tthis.object.geometry.type = 'Line';\r\n\r\n\t\t\t\tvar vLen = this.vertices.length;\r\n\t\t\t\tvar uvLen = this.uvs.length;\r\n\r\n\t\t\t\tfor ( var vi = 0, l = vertices.length; vi < l; vi ++ ) {\r\n\r\n\t\t\t\t\tthis.addVertexLine( this.parseVertexIndex( vertices[ vi ], vLen ) );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tfor ( var uvi = 0, l = uvs.length; uvi < l; uvi ++ ) {\r\n\r\n\t\t\t\t\tthis.addUVLine( this.parseUVIndex( uvs[ uvi ], uvLen ) );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t};\r\n\r\n\t\tstate.startObject( '', false );\r\n\r\n\t\treturn state;\r\n\r\n\t},\r\n\r\n\tparse: function ( text ) {\r\n\r\n\t\tconsole.time( 'OBJLoader' );\r\n\r\n\t\tvar state = this._createParserState();\r\n\r\n\t\tif ( text.indexOf( '\\r\\n' ) !== - 1 ) {\r\n\r\n\t\t\t// This is faster than String.split with regex that splits on both\r\n\t\t\ttext = text.replace( '\\r\\n', '\\n' );\r\n\r\n\t\t}\r\n\r\n\t\tvar lines = text.split( '\\n' );\r\n\t\tvar line = '', lineFirstChar = '', lineSecondChar = '';\r\n\t\tvar lineLength = 0;\r\n\t\tvar result = [];\r\n\r\n\t\t// Faster to just trim left side of the line. Use if available.\r\n\t\tvar trimLeft = ( typeof ''.trimLeft === 'function' );\r\n\r\n\t\tfor ( var i = 0, l = lines.length; i < l; i ++ ) {\r\n\r\n\t\t\tline = lines[ i ];\r\n\r\n\t\t\tline = trimLeft ? line.trimLeft() : line.trim();\r\n\r\n\t\t\tlineLength = line.length;\r\n\r\n\t\t\tif ( lineLength === 0 ) continue;\r\n\r\n\t\t\tlineFirstChar = line.charAt( 0 );\r\n\r\n\t\t\t// @todo invoke passed in handler if any\r\n\t\t\tif ( lineFirstChar === '#' ) continue;\r\n\r\n\t\t\tif ( lineFirstChar === 'v' ) {\r\n\r\n\t\t\t\tlineSecondChar = line.charAt( 1 );\r\n\r\n\t\t\t\tif ( lineSecondChar === ' ' && ( result = this.regexp.vertex_pattern.exec( line ) ) !== null ) {\r\n\r\n\t\t\t\t\t// 0                  1      2      3\r\n\t\t\t\t\t// [\"v 1.0 2.0 3.0\", \"1.0\", \"2.0\", \"3.0\"]\r\n\r\n\t\t\t\t\tstate.vertices.push(\r\n\t\t\t\t\t\tparseFloat( result[ 1 ] ),\r\n\t\t\t\t\t\tparseFloat( result[ 2 ] ),\r\n\t\t\t\t\t\tparseFloat( result[ 3 ] )\r\n\t\t\t\t\t);\r\n\r\n\t\t\t\t} else if ( lineSecondChar === 'n' && ( result = this.regexp.normal_pattern.exec( line ) ) !== null ) {\r\n\r\n\t\t\t\t\t// 0                   1      2      3\r\n\t\t\t\t\t// [\"vn 1.0 2.0 3.0\", \"1.0\", \"2.0\", \"3.0\"]\r\n\r\n\t\t\t\t\tstate.normals.push(\r\n\t\t\t\t\t\tparseFloat( result[ 1 ] ),\r\n\t\t\t\t\t\tparseFloat( result[ 2 ] ),\r\n\t\t\t\t\t\tparseFloat( result[ 3 ] )\r\n\t\t\t\t\t);\r\n\r\n\t\t\t\t} else if ( lineSecondChar === 't' && ( result = this.regexp.uv_pattern.exec( line ) ) !== null ) {\r\n\r\n\t\t\t\t\t// 0               1      2\r\n\t\t\t\t\t// [\"vt 0.1 0.2\", \"0.1\", \"0.2\"]\r\n\r\n\t\t\t\t\tstate.uvs.push(\r\n\t\t\t\t\t\tparseFloat( result[ 1 ] ),\r\n\t\t\t\t\t\tparseFloat( result[ 2 ] )\r\n\t\t\t\t\t);\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tthrow new Error( \"Unexpected vertex/normal/uv line: '\" + line  + \"'\" );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t} else if ( lineFirstChar === \"f\" ) {\r\n\r\n\t\t\t\tif ( ( result = this.regexp.face_vertex_uv_normal.exec( line ) ) !== null ) {\r\n\r\n\t\t\t\t\t// f vertex/uv/normal vertex/uv/normal vertex/uv/normal\r\n\t\t\t\t\t// 0                        1    2    3    4    5    6    7    8    9   10         11         12\r\n\t\t\t\t\t// [\"f 1/1/1 2/2/2 3/3/3\", \"1\", \"1\", \"1\", \"2\", \"2\", \"2\", \"3\", \"3\", \"3\", undefined, undefined, undefined]\r\n\r\n\t\t\t\t\tstate.addFace(\r\n\t\t\t\t\t\tresult[ 1 ], result[ 4 ], result[ 7 ], result[ 10 ],\r\n\t\t\t\t\t\tresult[ 2 ], result[ 5 ], result[ 8 ], result[ 11 ],\r\n\t\t\t\t\t\tresult[ 3 ], result[ 6 ], result[ 9 ], result[ 12 ]\r\n\t\t\t\t\t);\r\n\r\n\t\t\t\t} else if ( ( result = this.regexp.face_vertex_uv.exec( line ) ) !== null ) {\r\n\r\n\t\t\t\t\t// f vertex/uv vertex/uv vertex/uv\r\n\t\t\t\t\t// 0                  1    2    3    4    5    6   7          8\r\n\t\t\t\t\t// [\"f 1/1 2/2 3/3\", \"1\", \"1\", \"2\", \"2\", \"3\", \"3\", undefined, undefined]\r\n\r\n\t\t\t\t\tstate.addFace(\r\n\t\t\t\t\t\tresult[ 1 ], result[ 3 ], result[ 5 ], result[ 7 ],\r\n\t\t\t\t\t\tresult[ 2 ], result[ 4 ], result[ 6 ], result[ 8 ]\r\n\t\t\t\t\t);\r\n\r\n\t\t\t\t} else if ( ( result = this.regexp.face_vertex_normal.exec( line ) ) !== null ) {\r\n\r\n\t\t\t\t\t// f vertex//normal vertex//normal vertex//normal\r\n\t\t\t\t\t// 0                     1    2    3    4    5    6   7          8\r\n\t\t\t\t\t// [\"f 1//1 2//2 3//3\", \"1\", \"1\", \"2\", \"2\", \"3\", \"3\", undefined, undefined]\r\n\r\n\t\t\t\t\tstate.addFace(\r\n\t\t\t\t\t\tresult[ 1 ], result[ 3 ], result[ 5 ], result[ 7 ],\r\n\t\t\t\t\t\tundefined, undefined, undefined, undefined,\r\n\t\t\t\t\t\tresult[ 2 ], result[ 4 ], result[ 6 ], result[ 8 ]\r\n\t\t\t\t\t);\r\n\r\n\t\t\t\t} else if ( ( result = this.regexp.face_vertex.exec( line ) ) !== null ) {\r\n\r\n\t\t\t\t\t// f vertex vertex vertex\r\n\t\t\t\t\t// 0            1    2    3   4\r\n\t\t\t\t\t// [\"f 1 2 3\", \"1\", \"2\", \"3\", undefined]\r\n\r\n\t\t\t\t\tstate.addFace(\r\n\t\t\t\t\t\tresult[ 1 ], result[ 2 ], result[ 3 ], result[ 4 ]\r\n\t\t\t\t\t);\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tthrow new Error( \"Unexpected face line: '\" + line  + \"'\" );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t} else if ( lineFirstChar === \"l\" ) {\r\n\r\n\t\t\t\tvar lineParts = line.substring( 1 ).trim().split( \" \" );\r\n\t\t\t\tvar lineVertices = [], lineUVs = [];\r\n\r\n\t\t\t\tif ( line.indexOf( \"/\" ) === - 1 ) {\r\n\r\n\t\t\t\t\tlineVertices = lineParts;\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tfor ( var li = 0, llen = lineParts.length; li < llen; li ++ ) {\r\n\r\n\t\t\t\t\t\tvar parts = lineParts[ li ].split( \"/\" );\r\n\r\n\t\t\t\t\t\tif ( parts[ 0 ] !== \"\" ) lineVertices.push( parts[ 0 ] );\r\n\t\t\t\t\t\tif ( parts[ 1 ] !== \"\" ) lineUVs.push( parts[ 1 ] );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\t\t\t\tstate.addLineGeometry( lineVertices, lineUVs );\r\n\r\n\t\t\t} else if ( ( result = this.regexp.object_pattern.exec( line ) ) !== null ) {\r\n\r\n\t\t\t\t// o object_name\r\n\t\t\t\t// or\r\n\t\t\t\t// g group_name\r\n\r\n\t\t\t\tvar name = result[ 0 ].substr( 1 ).trim();\r\n\t\t\t\tstate.startObject( name );\r\n\r\n\t\t\t} else if ( this.regexp.material_use_pattern.test( line ) ) {\r\n\r\n\t\t\t\t// material\r\n\r\n\t\t\t\tstate.object.material.name = line.substring( 7 ).trim();\r\n\r\n\t\t\t} else if ( this.regexp.material_library_pattern.test( line ) ) {\r\n\r\n\t\t\t\t// mtl file\r\n\r\n\t\t\t\tstate.materialLibraries.push( line.substring( 7 ).trim() );\r\n\r\n\t\t\t} else if ( ( result = this.regexp.smoothing_pattern.exec( line ) ) !== null ) {\r\n\r\n\t\t\t\t// smooth shading\r\n\r\n\t\t\t\tvar value = result[ 1 ].trim().toLowerCase();\r\n\t\t\t\tstate.object.material.smooth = ( value === '1' || value === 'on' );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\t// Handle null terminated files without exception\r\n\t\t\t\tif ( line === '\\0' ) continue;\r\n\r\n\t\t\t\tthrow new Error( \"Unexpected line: '\" + line  + \"'\" );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tvar container = new THREE.Group();\r\n\t\tcontainer.materialLibraries = [].concat( state.materialLibraries );\r\n\r\n\t\tfor ( var i = 0, l = state.objects.length; i < l; i ++ ) {\r\n\r\n\t\t\tvar object = state.objects[ i ];\r\n\t\t\tvar geometry = object.geometry;\r\n\t\t\tvar isLine = ( geometry.type === 'Line' );\r\n\r\n\t\t\t// Skip o/g line declarations that did not follow with any faces\r\n\t\t\tif ( geometry.vertices.length === 0 ) continue;\r\n\r\n\t\t\tvar buffergeometry = new THREE.BufferGeometry();\r\n\r\n\t\t\tbuffergeometry.addAttribute( 'position', new THREE.BufferAttribute( new Float32Array( geometry.vertices ), 3 ) );\r\n\r\n\t\t\tif ( geometry.normals.length > 0 ) {\r\n\r\n\t\t\t\tbuffergeometry.addAttribute( 'normal', new THREE.BufferAttribute( new Float32Array( geometry.normals ), 3 ) );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tbuffergeometry.computeVertexNormals();\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( geometry.uvs.length > 0 ) {\r\n\r\n\t\t\t\tbuffergeometry.addAttribute( 'uv', new THREE.BufferAttribute( new Float32Array( geometry.uvs ), 2 ) );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar material;\r\n\r\n\t\t\tif ( this.materials !== null ) {\r\n\r\n\t\t\t\tmaterial = this.materials.create( object.material.name );\r\n\r\n\t\t\t\t// mtl etc. loaders probably can't create line materials correctly, copy properties to a line material.\r\n\t\t\t\tif ( isLine && material && ! ( material instanceof THREE.LineBasicMaterial ) ) {\r\n\r\n\t\t\t\t\tvar materialLine = new THREE.LineBasicMaterial();\r\n\t\t\t\t\tmaterialLine.copy( material );\r\n\t\t\t\t\tmaterial = materialLine;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( ! material ) {\r\n\r\n\t\t\t\tmaterial = ( ! isLine ? new THREE.MeshPhongMaterial() : new THREE.LineBasicMaterial() );\r\n\t\t\t\tmaterial.name = object.material.name;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tmaterial.shading = object.material.smooth ? THREE.SmoothShading : THREE.FlatShading;\r\n\r\n\t\t\tvar mesh = ( ! isLine ? new THREE.Mesh( buffergeometry, material ) : new THREE.Line( buffergeometry, material ) );\r\n\t\t\tmesh.name = object.name;\r\n\r\n\t\t\tcontainer.add( mesh );\r\n\r\n\t\t}\r\n\r\n\t\tconsole.timeEnd( 'OBJLoader' );\r\n\r\n\t\treturn container;\r\n\r\n\t}\r\n\r\n};\r\n","/**\r\n * Loads a Wavefront .mtl file specifying materials\r\n *\r\n * @author angelxuanchang\r\n */\r\n\r\nTHREE.MTLLoader = function( manager ) {\r\n\r\n\tthis.manager = ( manager !== undefined ) ? manager : THREE.DefaultLoadingManager;\r\n\r\n};\r\n\r\nTHREE.MTLLoader.prototype = {\r\n\r\n\tconstructor: THREE.MTLLoader,\r\n\r\n\tload: function ( url, onLoad, onProgress, onError ) {\r\n\r\n\t\tvar scope = this;\r\n\r\n\t\tvar loader = new THREE.XHRLoader( this.manager );\r\n\t\tloader.setPath( this.path );\r\n\t\tloader.load( url, function ( text ) {\r\n\r\n\t\t\tonLoad( scope.parse( text ) );\r\n\r\n\t\t}, onProgress, onError );\r\n\r\n\t},\r\n\r\n\tsetPath: function ( value ) {\r\n\r\n\t\tthis.path = value;\r\n\r\n\t},\r\n\r\n\tsetBaseUrl: function( value ) {\r\n\r\n\t\t// TODO: Merge with setPath()? Or rename to setTexturePath?\r\n\r\n\t\tthis.baseUrl = value;\r\n\r\n\t},\r\n\r\n\tsetCrossOrigin: function ( value ) {\r\n\r\n\t\tthis.crossOrigin = value;\r\n\r\n\t},\r\n\r\n\tsetMaterialOptions: function ( value ) {\r\n\r\n\t\tthis.materialOptions = value;\r\n\r\n\t},\r\n\r\n\t/**\r\n\t * Parses loaded MTL file\r\n\t * @param text - Content of MTL file\r\n\t * @return {THREE.MTLLoader.MaterialCreator}\r\n\t */\r\n\tparse: function ( text ) {\r\n\r\n\t\tvar lines = text.split( \"\\n\" );\r\n\t\tvar info = {};\r\n\t\tvar delimiter_pattern = /\\s+/;\r\n\t\tvar materialsInfo = {};\r\n\r\n\t\tfor ( var i = 0; i < lines.length; i ++ ) {\r\n\r\n\t\t\tvar line = lines[ i ];\r\n\t\t\tline = line.trim();\r\n\r\n\t\t\tif ( line.length === 0 || line.charAt( 0 ) === '#' ) {\r\n\r\n\t\t\t\t// Blank line or comment ignore\r\n\t\t\t\tcontinue;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar pos = line.indexOf( ' ' );\r\n\r\n\t\t\tvar key = ( pos >= 0 ) ? line.substring( 0, pos ) : line;\r\n\t\t\tkey = key.toLowerCase();\r\n\r\n\t\t\tvar value = ( pos >= 0 ) ? line.substring( pos + 1 ) : \"\";\r\n\t\t\tvalue = value.trim();\r\n\r\n\t\t\tif ( key === \"newmtl\" ) {\r\n\r\n\t\t\t\t// New material\r\n\r\n\t\t\t\tinfo = { name: value };\r\n\t\t\t\tmaterialsInfo[ value ] = info;\r\n\r\n\t\t\t} else if ( info ) {\r\n\r\n\t\t\t\tif ( key === \"ka\" || key === \"kd\" || key === \"ks\" ) {\r\n\r\n\t\t\t\t\tvar ss = value.split( delimiter_pattern, 3 );\r\n\t\t\t\t\tinfo[ key ] = [ parseFloat( ss[ 0 ] ), parseFloat( ss[ 1 ] ), parseFloat( ss[ 2 ] ) ];\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tinfo[ key ] = value;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tvar materialCreator = new THREE.MTLLoader.MaterialCreator( this.baseUrl, this.materialOptions );\r\n\t\tmaterialCreator.setCrossOrigin( this.crossOrigin );\r\n\t\tmaterialCreator.setManager( this.manager );\r\n\t\tmaterialCreator.setMaterials( materialsInfo );\r\n\t\treturn materialCreator;\r\n\r\n\t}\r\n\r\n};\r\n\r\n/**\r\n * Create a new THREE-MTLLoader.MaterialCreator\r\n * @param baseUrl - Url relative to which textures are loaded\r\n * @param options - Set of options on how to construct the materials\r\n *                  side: Which side to apply the material\r\n *                        THREE.FrontSide (default), THREE.BackSide, THREE.DoubleSide\r\n *                  wrap: What type of wrapping to apply for textures\r\n *                        THREE.RepeatWrapping (default), THREE.ClampToEdgeWrapping, THREE.MirroredRepeatWrapping\r\n *                  normalizeRGB: RGBs need to be normalized to 0-1 from 0-255\r\n *                                Default: false, assumed to be already normalized\r\n *                  ignoreZeroRGBs: Ignore values of RGBs (Ka,Kd,Ks) that are all 0's\r\n *                                  Default: false\r\n * @constructor\r\n */\r\n\r\nTHREE.MTLLoader.MaterialCreator = function( baseUrl, options ) {\r\n\r\n\tthis.baseUrl = baseUrl;\r\n\tthis.options = options;\r\n\tthis.materialsInfo = {};\r\n\tthis.materials = {};\r\n\tthis.materialsArray = [];\r\n\tthis.nameLookup = {};\r\n\r\n\tthis.side = ( this.options && this.options.side ) ? this.options.side : THREE.FrontSide;\r\n\tthis.wrap = ( this.options && this.options.wrap ) ? this.options.wrap : THREE.RepeatWrapping;\r\n\r\n};\r\n\r\nTHREE.MTLLoader.MaterialCreator.prototype = {\r\n\r\n\tconstructor: THREE.MTLLoader.MaterialCreator,\r\n\r\n\tsetCrossOrigin: function ( value ) {\r\n\r\n\t\tthis.crossOrigin = value;\r\n\r\n\t},\r\n\r\n\tsetManager: function ( value ) {\r\n\r\n\t\tthis.manager = value;\r\n\r\n\t},\r\n\r\n\tsetMaterials: function( materialsInfo ) {\r\n\r\n\t\tthis.materialsInfo = this.convert( materialsInfo );\r\n\t\tthis.materials = {};\r\n\t\tthis.materialsArray = [];\r\n\t\tthis.nameLookup = {};\r\n\r\n\t},\r\n\r\n\tconvert: function( materialsInfo ) {\r\n\r\n\t\tif ( ! this.options ) return materialsInfo;\r\n\r\n\t\tvar converted = {};\r\n\r\n\t\tfor ( var mn in materialsInfo ) {\r\n\r\n\t\t\t// Convert materials info into normalized form based on options\r\n\r\n\t\t\tvar mat = materialsInfo[ mn ];\r\n\r\n\t\t\tvar covmat = {};\r\n\r\n\t\t\tconverted[ mn ] = covmat;\r\n\r\n\t\t\tfor ( var prop in mat ) {\r\n\r\n\t\t\t\tvar save = true;\r\n\t\t\t\tvar value = mat[ prop ];\r\n\t\t\t\tvar lprop = prop.toLowerCase();\r\n\r\n\t\t\t\tswitch ( lprop ) {\r\n\r\n\t\t\t\t\tcase 'kd':\r\n\t\t\t\t\tcase 'ka':\r\n\t\t\t\t\tcase 'ks':\r\n\r\n\t\t\t\t\t\t// Diffuse color (color under white light) using RGB values\r\n\r\n\t\t\t\t\t\tif ( this.options && this.options.normalizeRGB ) {\r\n\r\n\t\t\t\t\t\t\tvalue = [ value[ 0 ] / 255, value[ 1 ] / 255, value[ 2 ] / 255 ];\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tif ( this.options && this.options.ignoreZeroRGBs ) {\r\n\r\n\t\t\t\t\t\t\tif ( value[ 0 ] === 0 && value[ 1 ] === 0 && value[ 1 ] === 0 ) {\r\n\r\n\t\t\t\t\t\t\t\t// ignore\r\n\r\n\t\t\t\t\t\t\t\tsave = false;\r\n\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tdefault:\r\n\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( save ) {\r\n\r\n\t\t\t\t\tcovmat[ lprop ] = value;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\treturn converted;\r\n\r\n\t},\r\n\r\n\tpreload: function () {\r\n\r\n\t\tfor ( var mn in this.materialsInfo ) {\r\n\r\n\t\t\tthis.create( mn );\r\n\r\n\t\t}\r\n\r\n\t},\r\n\r\n\tgetIndex: function( materialName ) {\r\n\r\n\t\treturn this.nameLookup[ materialName ];\r\n\r\n\t},\r\n\r\n\tgetAsArray: function() {\r\n\r\n\t\tvar index = 0;\r\n\r\n\t\tfor ( var mn in this.materialsInfo ) {\r\n\r\n\t\t\tthis.materialsArray[ index ] = this.create( mn );\r\n\t\t\tthis.nameLookup[ mn ] = index;\r\n\t\t\tindex ++;\r\n\r\n\t\t}\r\n\r\n\t\treturn this.materialsArray;\r\n\r\n\t},\r\n\r\n\tcreate: function ( materialName ) {\r\n\r\n\t\tif ( this.materials[ materialName ] === undefined ) {\r\n\r\n\t\t\tthis.createMaterial_( materialName );\r\n\r\n\t\t}\r\n\r\n\t\treturn this.materials[ materialName ];\r\n\r\n\t},\r\n\r\n\tcreateMaterial_: function ( materialName ) {\r\n\r\n\t\t// Create material\r\n\r\n\t\tvar mat = this.materialsInfo[ materialName ];\r\n\t\tvar params = {\r\n\r\n\t\t\tname: materialName,\r\n\t\t\tside: this.side\r\n\r\n\t\t};\r\n\r\n\t\tfor ( var prop in mat ) {\r\n\r\n\t\t\tvar value = mat[ prop ];\r\n\r\n\t\t\tif ( value === '' ) continue;\r\n\r\n\t\t\tswitch ( prop.toLowerCase() ) {\r\n\r\n\t\t\t\t// Ns is material specular exponent\r\n\r\n\t\t\t\tcase 'kd':\r\n\r\n\t\t\t\t\t// Diffuse color (color under white light) using RGB values\r\n\r\n\t\t\t\t\tparams[ 'color' ] = new THREE.Color().fromArray( value );\r\n\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'ks':\r\n\r\n\t\t\t\t\t// Specular color (color when light is reflected from shiny surface) using RGB values\r\n\t\t\t\t\tparams[ 'specular' ] = new THREE.Color().fromArray( value );\r\n\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'map_kd':\r\n\r\n\t\t\t\t\t// Diffuse texture map\r\n\r\n\t\t\t\t\tparams[ 'map' ] = this.loadTexture( this.baseUrl + value );\r\n\t\t\t\t\tparams[ 'map' ].wrapS = this.wrap;\r\n\t\t\t\t\tparams[ 'map' ].wrapT = this.wrap;\r\n\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'ns':\r\n\r\n\t\t\t\t\t// The specular exponent (defines the focus of the specular highlight)\r\n\t\t\t\t\t// A high exponent results in a tight, concentrated highlight. Ns values normally range from 0 to 1000.\r\n\r\n\t\t\t\t\tparams[ 'shininess' ] = parseFloat( value );\r\n\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'd':\r\n\r\n\t\t\t\t\tif ( value < 1 ) {\r\n\r\n\t\t\t\t\t\tparams[ 'opacity' ] = value;\r\n\t\t\t\t\t\tparams[ 'transparent' ] = true;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'Tr':\r\n\r\n\t\t\t\t\tif ( value > 0 ) {\r\n\r\n\t\t\t\t\t\tparams[ 'opacity' ] = 1 - value;\r\n\t\t\t\t\t\tparams[ 'transparent' ] = true;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'map_bump':\r\n\t\t\t\tcase 'bump':\r\n\r\n\t\t\t\t\t// Bump texture map\r\n\r\n\t\t\t\t\tif ( params[ 'bumpMap' ] ) break; // Avoid loading twice.\r\n\r\n\t\t\t\t\tparams[ 'bumpMap' ] = this.loadTexture( this.baseUrl + value );\r\n\t\t\t\t\tparams[ 'bumpMap' ].wrapS = this.wrap;\r\n\t\t\t\t\tparams[ 'bumpMap' ].wrapT = this.wrap;\r\n\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tdefault:\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tthis.materials[ materialName ] = new THREE.MeshPhongMaterial( params );\r\n\t\treturn this.materials[ materialName ];\r\n\r\n\t},\r\n\r\n\r\n\tloadTexture: function ( url, mapping, onLoad, onProgress, onError ) {\r\n\r\n\t\tvar texture;\r\n\t\tvar loader = THREE.Loader.Handlers.get( url );\r\n\t\tvar manager = ( this.manager !== undefined ) ? this.manager : THREE.DefaultLoadingManager;\r\n\r\n\t\tif ( loader === null ) {\r\n\r\n\t\t\tloader = new THREE.TextureLoader( manager );\r\n\r\n\t\t}\r\n\r\n\t\tif ( loader.setCrossOrigin ) loader.setCrossOrigin( this.crossOrigin );\r\n\t\ttexture = loader.load( url, onLoad, onProgress, onError );\r\n\r\n\t\tif ( mapping !== undefined ) texture.mapping = mapping;\r\n\r\n\t\treturn texture;\r\n\r\n\t}\r\n\r\n};\r\n\r\nTHREE.EventDispatcher.prototype.apply( THREE.MTLLoader.prototype );\r\n","\n/**\n * This is the common logic for both the Node.js and web browser\n * implementations of `debug()`.\n *\n * Expose `debug()` as the module.\n */\n\nexports = module.exports = debug;\nexports.coerce = coerce;\nexports.disable = disable;\nexports.enable = enable;\nexports.enabled = enabled;\nexports.humanize = require('ms');\n\n/**\n * The currently active debug mode names, and names to skip.\n */\n\nexports.names = [];\nexports.skips = [];\n\n/**\n * Map of special \"%n\" handling functions, for the debug \"format\" argument.\n *\n * Valid key names are a single, lowercased letter, i.e. \"n\".\n */\n\nexports.formatters = {};\n\n/**\n * Previously assigned color.\n */\n\nvar prevColor = 0;\n\n/**\n * Previous log timestamp.\n */\n\nvar prevTime;\n\n/**\n * Select a color.\n *\n * @return {Number}\n * @api private\n */\n\nfunction selectColor() {\n  return exports.colors[prevColor++ % exports.colors.length];\n}\n\n/**\n * Create a debugger with the given `namespace`.\n *\n * @param {String} namespace\n * @return {Function}\n * @api public\n */\n\nfunction debug(namespace) {\n\n  // define the `disabled` version\n  function disabled() {\n  }\n  disabled.enabled = false;\n\n  // define the `enabled` version\n  function enabled() {\n\n    var self = enabled;\n\n    // set `diff` timestamp\n    var curr = +new Date();\n    var ms = curr - (prevTime || curr);\n    self.diff = ms;\n    self.prev = prevTime;\n    self.curr = curr;\n    prevTime = curr;\n\n    // add the `color` if not set\n    if (null == self.useColors) self.useColors = exports.useColors();\n    if (null == self.color && self.useColors) self.color = selectColor();\n\n    var args = Array.prototype.slice.call(arguments);\n\n    args[0] = exports.coerce(args[0]);\n\n    if ('string' !== typeof args[0]) {\n      // anything else let's inspect with %o\n      args = ['%o'].concat(args);\n    }\n\n    // apply any `formatters` transformations\n    var index = 0;\n    args[0] = args[0].replace(/%([a-z%])/g, function(match, format) {\n      // if we encounter an escaped % then don't increase the array index\n      if (match === '%%') return match;\n      index++;\n      var formatter = exports.formatters[format];\n      if ('function' === typeof formatter) {\n        var val = args[index];\n        match = formatter.call(self, val);\n\n        // now we need to remove `args[index]` since it's inlined in the `format`\n        args.splice(index, 1);\n        index--;\n      }\n      return match;\n    });\n\n    if ('function' === typeof exports.formatArgs) {\n      args = exports.formatArgs.apply(self, args);\n    }\n    var logFn = enabled.log || exports.log || console.log.bind(console);\n    logFn.apply(self, args);\n  }\n  enabled.enabled = true;\n\n  var fn = exports.enabled(namespace) ? enabled : disabled;\n\n  fn.namespace = namespace;\n\n  return fn;\n}\n\n/**\n * Enables a debug mode by namespaces. This can include modes\n * separated by a colon and wildcards.\n *\n * @param {String} namespaces\n * @api public\n */\n\nfunction enable(namespaces) {\n  exports.save(namespaces);\n\n  var split = (namespaces || '').split(/[\\s,]+/);\n  var len = split.length;\n\n  for (var i = 0; i < len; i++) {\n    if (!split[i]) continue; // ignore empty strings\n    namespaces = split[i].replace(/\\*/g, '.*?');\n    if (namespaces[0] === '-') {\n      exports.skips.push(new RegExp('^' + namespaces.substr(1) + '$'));\n    } else {\n      exports.names.push(new RegExp('^' + namespaces + '$'));\n    }\n  }\n}\n\n/**\n * Disable debug output.\n *\n * @api public\n */\n\nfunction disable() {\n  exports.enable('');\n}\n\n/**\n * Returns true if the given mode name is enabled, false otherwise.\n *\n * @param {String} name\n * @return {Boolean}\n * @api public\n */\n\nfunction enabled(name) {\n  var i, len;\n  for (i = 0, len = exports.skips.length; i < len; i++) {\n    if (exports.skips[i].test(name)) {\n      return false;\n    }\n  }\n  for (i = 0, len = exports.names.length; i < len; i++) {\n    if (exports.names[i].test(name)) {\n      return true;\n    }\n  }\n  return false;\n}\n\n/**\n * Coerce `val`.\n *\n * @param {Mixed} val\n * @return {Mixed}\n * @api private\n */\n\nfunction coerce(val) {\n  if (val instanceof Error) return val.stack || val.message;\n  return val;\n}\n","/**\r\n* @author Tim Knip / http://www.floorplanner.com/ / tim at floorplanner.com\r\n* @author Tony Parisi / http://www.tonyparisi.com/\r\n*/\r\n\r\nTHREE.ColladaLoader = function () {\r\n\r\n\tvar COLLADA = null;\r\n\tvar scene = null;\r\n\tvar visualScene;\r\n\tvar kinematicsModel;\r\n\r\n\tvar readyCallbackFunc = null;\r\n\r\n\tvar sources = {};\r\n\tvar images = {};\r\n\tvar animations = {};\r\n\tvar controllers = {};\r\n\tvar geometries = {};\r\n\tvar materials = {};\r\n\tvar effects = {};\r\n\tvar cameras = {};\r\n\tvar lights = {};\r\n\r\n\tvar animData;\r\n\tvar kinematics;\r\n\tvar visualScenes;\r\n\tvar kinematicsModels;\r\n\tvar baseUrl;\r\n\tvar morphs;\r\n\tvar skins;\r\n\r\n\tvar flip_uv = true;\r\n\tvar preferredShading = THREE.SmoothShading;\r\n\r\n\tvar options = {\r\n\t\t// Force Geometry to always be centered at the local origin of the\r\n\t\t// containing Mesh.\r\n\t\tcenterGeometry: false,\r\n\r\n\t\t// Axis conversion is done for geometries, animations, and controllers.\r\n\t\t// If we ever pull cameras or lights out of the COLLADA file, they'll\r\n\t\t// need extra work.\r\n\t\tconvertUpAxis: false,\r\n\r\n\t\tsubdivideFaces: true,\r\n\r\n\t\tupAxis: 'Y',\r\n\r\n\t\t// For reflective or refractive materials we'll use this cubemap\r\n\t\tdefaultEnvMap: null\r\n\r\n\t};\r\n\r\n\tvar colladaUnit = 1.0;\r\n\tvar colladaUp = 'Y';\r\n\tvar upConversion = null;\r\n\r\n\tfunction load ( url, readyCallback, progressCallback, failCallback ) {\r\n\r\n\t\tvar length = 0;\r\n\r\n\t\tif ( document.implementation && document.implementation.createDocument ) {\r\n\r\n\t\t\tvar request = new XMLHttpRequest();\r\n\r\n\t\t\trequest.onreadystatechange = function() {\r\n\r\n\t\t\t\tif ( request.readyState === 4 ) {\r\n\r\n\t\t\t\t\tif ( request.status === 0 || request.status === 200 ) {\r\n\r\n\t\t\t\t\t\tif ( request.response ) {\r\n\r\n\t\t\t\t\t\t\treadyCallbackFunc = readyCallback;\r\n\t\t\t\t\t\t\tparse( request.response, undefined, url );\r\n\r\n\t\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\t\tif ( failCallback ) {\r\n\r\n\t\t\t\t\t\t\t\tfailCallback( { type: 'error', url: url } );\r\n\r\n\t\t\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\t\t\tconsole.error( \"ColladaLoader: Empty or non-existing file (\" + url + \")\" );\r\n\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}else{\r\n\r\n\t\t\t\t\t\tif( failCallback ){\r\n\r\n\t\t\t\t\t\t\tfailCallback( { type: 'error', url: url } );\r\n\r\n\t\t\t\t\t\t}else{\r\n\r\n\t\t\t\t\t\t\tconsole.error( 'ColladaLoader: Couldn\\'t load \"' + url + '\" (' + request.status + ')' );\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t} else if ( request.readyState === 3 ) {\r\n\r\n\t\t\t\t\tif ( progressCallback ) {\r\n\r\n\t\t\t\t\t\tif ( length === 0 ) {\r\n\r\n\t\t\t\t\t\t\tlength = request.getResponseHeader( \"Content-Length\" );\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tprogressCallback( { total: length, loaded: request.responseText.length } );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t};\r\n\r\n\t\t\trequest.open( \"GET\", url, true );\r\n\t\t\trequest.send( null );\r\n\r\n\t\t} else {\r\n\r\n\t\t\talert( \"Don't know how to parse XML!\" );\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tfunction parse( text, callBack, url ) {\r\n\r\n\t\tCOLLADA = new DOMParser().parseFromString( text, 'text/xml' );\r\n\t\tcallBack = callBack || readyCallbackFunc;\r\n\r\n\t\tif ( url !== undefined ) {\r\n\r\n\t\t\tvar parts = url.split( '/' );\r\n\t\t\tparts.pop();\r\n\t\t\tbaseUrl = ( parts.length < 1 ? '.' : parts.join( '/' ) ) + '/';\r\n\r\n\t\t}\r\n\r\n\t\tparseAsset();\r\n\t\tsetUpConversion();\r\n\t\timages = parseLib( \"library_images image\", _Image, \"image\" );\r\n\t\tmaterials = parseLib( \"library_materials material\", Material, \"material\" );\r\n\t\teffects = parseLib( \"library_effects effect\", Effect, \"effect\" );\r\n\t\tgeometries = parseLib( \"library_geometries geometry\", Geometry, \"geometry\" );\r\n\t\tcameras = parseLib( \"library_cameras camera\", Camera, \"camera\" );\r\n\t\tlights = parseLib( \"library_lights light\", Light, \"light\" );\r\n\t\tcontrollers = parseLib( \"library_controllers controller\", Controller, \"controller\" );\r\n\t\tanimations = parseLib( \"library_animations animation\", Animation, \"animation\" );\r\n\t\tvisualScenes = parseLib( \"library_visual_scenes visual_scene\", VisualScene, \"visual_scene\" );\r\n\t\tkinematicsModels = parseLib( \"library_kinematics_models kinematics_model\", KinematicsModel, \"kinematics_model\" );\r\n\r\n\t\tmorphs = [];\r\n\t\tskins = [];\r\n\r\n\t\tvisualScene = parseScene();\r\n\t\tscene = new THREE.Group();\r\n\r\n\t\tfor ( var i = 0; i < visualScene.nodes.length; i ++ ) {\r\n\r\n\t\t\tscene.add( createSceneGraph( visualScene.nodes[ i ] ) );\r\n\r\n\t\t}\r\n\r\n\t\t// unit conversion\r\n\t\tscene.scale.multiplyScalar( colladaUnit );\r\n\r\n\t\tcreateAnimations();\r\n\r\n\t\tkinematicsModel = parseKinematicsModel();\r\n\t\tcreateKinematics();\r\n\r\n\t\tvar result = {\r\n\r\n\t\t\tscene: scene,\r\n\t\t\tmorphs: morphs,\r\n\t\t\tskins: skins,\r\n\t\t\tanimations: animData,\r\n\t\t\tkinematics: kinematics,\r\n\t\t\tdae: {\r\n\t\t\t\timages: images,\r\n\t\t\t\tmaterials: materials,\r\n\t\t\t\tcameras: cameras,\r\n\t\t\t\tlights: lights,\r\n\t\t\t\teffects: effects,\r\n\t\t\t\tgeometries: geometries,\r\n\t\t\t\tcontrollers: controllers,\r\n\t\t\t\tanimations: animations,\r\n\t\t\t\tvisualScenes: visualScenes,\r\n\t\t\t\tvisualScene: visualScene,\r\n\t\t\t\tscene: visualScene,\r\n\t\t\t\tkinematicsModels: kinematicsModels,\r\n\t\t\t\tkinematicsModel: kinematicsModel\r\n\t\t\t}\r\n\r\n\t\t};\r\n\r\n\t\tif ( callBack ) {\r\n\r\n\t\t\tcallBack( result );\r\n\r\n\t\t}\r\n\r\n\t\treturn result;\r\n\r\n\t}\r\n\r\n\tfunction setPreferredShading ( shading ) {\r\n\r\n\t\tpreferredShading = shading;\r\n\r\n\t}\r\n\r\n\tfunction parseAsset () {\r\n\r\n\t\tvar elements = COLLADA.querySelectorAll('asset');\r\n\r\n\t\tvar element = elements[0];\r\n\r\n\t\tif ( element && element.childNodes ) {\r\n\r\n\t\t\tfor ( var i = 0; i < element.childNodes.length; i ++ ) {\r\n\r\n\t\t\t\tvar child = element.childNodes[ i ];\r\n\r\n\t\t\t\tswitch ( child.nodeName ) {\r\n\r\n\t\t\t\t\tcase 'unit':\r\n\r\n\t\t\t\t\t\tvar meter = child.getAttribute( 'meter' );\r\n\r\n\t\t\t\t\t\tif ( meter ) {\r\n\r\n\t\t\t\t\t\t\tcolladaUnit = parseFloat( meter );\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase 'up_axis':\r\n\r\n\t\t\t\t\t\tcolladaUp = child.textContent.charAt(0);\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tfunction parseLib ( q, classSpec, prefix ) {\r\n\r\n\t\tvar elements = COLLADA.querySelectorAll(q);\r\n\r\n\t\tvar lib = {};\r\n\r\n\t\tvar i = 0;\r\n\r\n\t\tvar elementsLength = elements.length;\r\n\r\n\t\tfor ( var j = 0; j < elementsLength; j ++ ) {\r\n\r\n\t\t\tvar element = elements[j];\r\n\t\t\tvar daeElement = ( new classSpec() ).parse( element );\r\n\r\n\t\t\tif ( !daeElement.id || daeElement.id.length === 0 ) daeElement.id = prefix + ( i ++ );\r\n\t\t\tlib[ daeElement.id ] = daeElement;\r\n\r\n\t\t}\r\n\r\n\t\treturn lib;\r\n\r\n\t}\r\n\r\n\tfunction parseScene() {\r\n\r\n\t\tvar sceneElement = COLLADA.querySelectorAll('scene instance_visual_scene')[0];\r\n\r\n\t\tif ( sceneElement ) {\r\n\r\n\t\t\tvar url = sceneElement.getAttribute( 'url' ).replace( /^#/, '' );\r\n\t\t\treturn visualScenes[ url.length > 0 ? url : 'visual_scene0' ];\r\n\r\n\t\t} else {\r\n\r\n\t\t\treturn null;\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tfunction parseKinematicsModel() {\r\n\r\n\t\tvar kinematicsModelElement = COLLADA.querySelectorAll('instance_kinematics_model')[0];\r\n\r\n\t\tif ( kinematicsModelElement ) {\r\n\r\n\t\t\tvar url = kinematicsModelElement.getAttribute( 'url' ).replace(/^#/, '');\r\n\t\t\treturn kinematicsModels[ url.length > 0 ? url : 'kinematics_model0' ];\r\n\r\n\t\t} else {\r\n\r\n\t\t\treturn null;\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tfunction createAnimations() {\r\n\r\n\t\tanimData = [];\r\n\r\n\t\t// fill in the keys\r\n\t\trecurseHierarchy( scene );\r\n\r\n\t}\r\n\r\n\tfunction recurseHierarchy( node ) {\r\n\r\n\t\tvar n = visualScene.getChildById( node.colladaId, true ),\r\n\t\t\tnewData = null;\r\n\r\n\t\tif ( n && n.keys ) {\r\n\r\n\t\t\tnewData = {\r\n\t\t\t\tfps: 60,\r\n\t\t\t\thierarchy: [ {\r\n\t\t\t\t\tnode: n,\r\n\t\t\t\t\tkeys: n.keys,\r\n\t\t\t\t\tsids: n.sids\r\n\t\t\t\t} ],\r\n\t\t\t\tnode: node,\r\n\t\t\t\tname: 'animation_' + node.name,\r\n\t\t\t\tlength: 0\r\n\t\t\t};\r\n\r\n\t\t\tanimData.push(newData);\r\n\r\n\t\t\tfor ( var i = 0, il = n.keys.length; i < il; i ++ ) {\r\n\r\n\t\t\t\tnewData.length = Math.max( newData.length, n.keys[i].time );\r\n\r\n\t\t\t}\r\n\r\n\t\t} else {\r\n\r\n\t\t\tnewData = {\r\n\t\t\t\thierarchy: [ {\r\n\t\t\t\t\tkeys: [],\r\n\t\t\t\t\tsids: []\r\n\t\t\t\t} ]\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tfor ( var i = 0, il = node.children.length; i < il; i ++ ) {\r\n\r\n\t\t\tvar d = recurseHierarchy( node.children[i] );\r\n\r\n\t\t\tfor ( var j = 0, jl = d.hierarchy.length; j < jl; j ++ ) {\r\n\r\n\t\t\t\tnewData.hierarchy.push( {\r\n\t\t\t\t\tkeys: [],\r\n\t\t\t\t\tsids: []\r\n\t\t\t\t} );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\treturn newData;\r\n\r\n\t}\r\n\r\n\tfunction calcAnimationBounds () {\r\n\r\n\t\tvar start = 1000000;\r\n\t\tvar end = -start;\r\n\t\tvar frames = 0;\r\n\t\tvar ID;\r\n\t\tfor ( var id in animations ) {\r\n\r\n\t\t\tvar animation = animations[ id ];\r\n\t\t\tID = ID || animation.id;\r\n\t\t\tfor ( var i = 0; i < animation.sampler.length; i ++ ) {\r\n\r\n\t\t\t\tvar sampler = animation.sampler[ i ];\r\n\r\n\t\t\t\tsampler.create();\r\n\r\n\t\t\t\tstart = Math.min( start, sampler.startTime );\r\n\t\t\t\tend = Math.max( end, sampler.endTime );\r\n\t\t\t\tframes = Math.max( frames, sampler.input.length );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\treturn { start:start, end:end, frames:frames,ID:ID };\r\n\r\n\t}\r\n\r\n\tfunction createMorph ( geometry, ctrl ) {\r\n\r\n\t\tvar morphCtrl = ctrl instanceof InstanceController ? controllers[ ctrl.url ] : ctrl;\r\n\r\n\t\tif ( !morphCtrl || !morphCtrl.morph ) {\r\n\r\n\t\t\tconsole.log(\"could not find morph controller!\");\r\n\t\t\treturn;\r\n\r\n\t\t}\r\n\r\n\t\tvar morph = morphCtrl.morph;\r\n\r\n\t\tfor ( var i = 0; i < morph.targets.length; i ++ ) {\r\n\r\n\t\t\tvar target_id = morph.targets[ i ];\r\n\t\t\tvar daeGeometry = geometries[ target_id ];\r\n\r\n\t\t\tif ( !daeGeometry.mesh ||\r\n\t\t\t\t !daeGeometry.mesh.primitives ||\r\n\t\t\t\t !daeGeometry.mesh.primitives.length ) {\r\n\t\t\t\t continue;\r\n\t\t\t}\r\n\r\n\t\t\tvar target = daeGeometry.mesh.primitives[ 0 ].geometry;\r\n\r\n\t\t\tif ( target.vertices.length === geometry.vertices.length ) {\r\n\r\n\t\t\t\tgeometry.morphTargets.push( { name: \"target_1\", vertices: target.vertices } );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tgeometry.morphTargets.push( { name: \"target_Z\", vertices: geometry.vertices } );\r\n\r\n\t}\r\n\r\n\tfunction createSkin ( geometry, ctrl, applyBindShape ) {\r\n\r\n\t\tvar skinCtrl = controllers[ ctrl.url ];\r\n\r\n\t\tif ( !skinCtrl || !skinCtrl.skin ) {\r\n\r\n\t\t\tconsole.log( \"could not find skin controller!\" );\r\n\t\t\treturn;\r\n\r\n\t\t}\r\n\r\n\t\tif ( !ctrl.skeleton || !ctrl.skeleton.length ) {\r\n\r\n\t\t\tconsole.log( \"could not find the skeleton for the skin!\" );\r\n\t\t\treturn;\r\n\r\n\t\t}\r\n\r\n\t\tvar skin = skinCtrl.skin;\r\n\t\tvar skeleton = visualScene.getChildById( ctrl.skeleton[ 0 ] );\r\n\t\tvar hierarchy = [];\r\n\r\n\t\tapplyBindShape = applyBindShape !== undefined ? applyBindShape : true;\r\n\r\n\t\tvar bones = [];\r\n\t\tgeometry.skinWeights = [];\r\n\t\tgeometry.skinIndices = [];\r\n\r\n\t\t//createBones( geometry.bones, skin, hierarchy, skeleton, null, -1 );\r\n\t\t//createWeights( skin, geometry.bones, geometry.skinIndices, geometry.skinWeights );\r\n\r\n\t\t/*\r\n\t\tgeometry.animation = {\r\n\t\t\tname: 'take_001',\r\n\t\t\tfps: 30,\r\n\t\t\tlength: 2,\r\n\t\t\tJIT: true,\r\n\t\t\thierarchy: hierarchy\r\n\t\t};\r\n\t\t*/\r\n\r\n\t\tif ( applyBindShape ) {\r\n\r\n\t\t\tfor ( var i = 0; i < geometry.vertices.length; i ++ ) {\r\n\r\n\t\t\t\tgeometry.vertices[ i ].applyMatrix4( skin.bindShapeMatrix );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tfunction setupSkeleton ( node, bones, frame, parent ) {\r\n\r\n\t\tnode.world = node.world || new THREE.Matrix4();\r\n\t\tnode.localworld = node.localworld || new THREE.Matrix4();\r\n\t\tnode.world.copy( node.matrix );\r\n\t\tnode.localworld.copy( node.matrix );\r\n\r\n\t\tif ( node.channels && node.channels.length ) {\r\n\r\n\t\t\tvar channel = node.channels[ 0 ];\r\n\t\t\tvar m = channel.sampler.output[ frame ];\r\n\r\n\t\t\tif ( m instanceof THREE.Matrix4 ) {\r\n\r\n\t\t\t\tnode.world.copy( m );\r\n\t\t\t\tnode.localworld.copy(m);\r\n\t\t\t\tif (frame === 0)\r\n\t\t\t\t\tnode.matrix.copy(m);\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tif ( parent ) {\r\n\r\n\t\t\tnode.world.multiplyMatrices( parent, node.world );\r\n\r\n\t\t}\r\n\r\n\t\tbones.push( node );\r\n\r\n\t\tfor ( var i = 0; i < node.nodes.length; i ++ ) {\r\n\r\n\t\t\tsetupSkeleton( node.nodes[ i ], bones, frame, node.world );\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tfunction setupSkinningMatrices ( bones, skin ) {\r\n\r\n\t\t// FIXME: this is dumb...\r\n\r\n\t\tfor ( var i = 0; i < bones.length; i ++ ) {\r\n\r\n\t\t\tvar bone = bones[ i ];\r\n\t\t\tvar found = -1;\r\n\r\n\t\t\tif ( bone.type != 'JOINT' ) continue;\r\n\r\n\t\t\tfor ( var j = 0; j < skin.joints.length; j ++ ) {\r\n\r\n\t\t\t\tif ( bone.sid === skin.joints[ j ] ) {\r\n\r\n\t\t\t\t\tfound = j;\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( found >= 0 ) {\r\n\r\n\t\t\t\tvar inv = skin.invBindMatrices[ found ];\r\n\r\n\t\t\t\tbone.invBindMatrix = inv;\r\n\t\t\t\tbone.skinningMatrix = new THREE.Matrix4();\r\n\t\t\t\tbone.skinningMatrix.multiplyMatrices(bone.world, inv); // (IBMi * JMi)\r\n\t\t\t\tbone.animatrix = new THREE.Matrix4();\r\n\r\n\t\t\t\tbone.animatrix.copy(bone.localworld);\r\n\t\t\t\tbone.weights = [];\r\n\r\n\t\t\t\tfor ( var j = 0; j < skin.weights.length; j ++ ) {\r\n\r\n\t\t\t\t\tfor (var k = 0; k < skin.weights[ j ].length; k ++ ) {\r\n\r\n\t\t\t\t\t\tvar w = skin.weights[ j ][ k ];\r\n\r\n\t\t\t\t\t\tif ( w.joint === found ) {\r\n\r\n\t\t\t\t\t\t\tbone.weights.push( w );\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tconsole.warn( \"ColladaLoader: Could not find joint '\" + bone.sid + \"'.\" );\r\n\r\n\t\t\t\tbone.skinningMatrix = new THREE.Matrix4();\r\n\t\t\t\tbone.weights = [];\r\n\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t//Walk the Collada tree and flatten the bones into a list, extract the position, quat and scale from the matrix\r\n\tfunction flattenSkeleton(skeleton) {\r\n\r\n\t\tvar list = [];\r\n\t\tvar walk = function(parentid, node, list) {\r\n\r\n\t\t\tvar bone = {};\r\n\t\t\tbone.name = node.sid;\r\n\t\t\tbone.parent = parentid;\r\n\t\t\tbone.matrix = node.matrix;\r\n\t\t\tvar data = [ new THREE.Vector3(),new THREE.Quaternion(),new THREE.Vector3() ];\r\n\t\t\tbone.matrix.decompose(data[0], data[1], data[2]);\r\n\r\n\t\t\tbone.pos = [ data[0].x,data[0].y,data[0].z ];\r\n\r\n\t\t\tbone.scl = [ data[2].x,data[2].y,data[2].z ];\r\n\t\t\tbone.rotq = [ data[1].x,data[1].y,data[1].z,data[1].w ];\r\n\t\t\tlist.push(bone);\r\n\r\n\t\t\tfor (var i in node.nodes) {\r\n\r\n\t\t\t\twalk(node.sid, node.nodes[i], list);\r\n\r\n\t\t\t}\r\n\r\n\t\t};\r\n\r\n\t\twalk(-1, skeleton, list);\r\n\t\treturn list;\r\n\r\n\t}\r\n\r\n\t//Move the vertices into the pose that is proper for the start of the animation\r\n\tfunction skinToBindPose(geometry,skeleton,skinController) {\r\n\r\n\t\tvar bones = [];\r\n\t\tsetupSkeleton( skeleton, bones, -1 );\r\n\t\tsetupSkinningMatrices( bones, skinController.skin );\r\n\t\tvar v = new THREE.Vector3();\r\n\t\tvar skinned = [];\r\n\r\n\t\tfor (var i = 0; i < geometry.vertices.length; i ++) {\r\n\r\n\t\t\tskinned.push(new THREE.Vector3());\r\n\r\n\t\t}\r\n\r\n\t\tfor ( i = 0; i < bones.length; i ++ ) {\r\n\r\n\t\t\tif ( bones[ i ].type != 'JOINT' ) continue;\r\n\r\n\t\t\tfor ( var j = 0; j < bones[ i ].weights.length; j ++ ) {\r\n\r\n\t\t\t\tvar w = bones[ i ].weights[ j ];\r\n\t\t\t\tvar vidx = w.index;\r\n\t\t\t\tvar weight = w.weight;\r\n\r\n\t\t\t\tvar o = geometry.vertices[vidx];\r\n\t\t\t\tvar s = skinned[vidx];\r\n\r\n\t\t\t\tv.x = o.x;\r\n\t\t\t\tv.y = o.y;\r\n\t\t\t\tv.z = o.z;\r\n\r\n\t\t\t\tv.applyMatrix4( bones[i].skinningMatrix );\r\n\r\n\t\t\t\ts.x += (v.x * weight);\r\n\t\t\t\ts.y += (v.y * weight);\r\n\t\t\t\ts.z += (v.z * weight);\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tfor (var i = 0; i < geometry.vertices.length; i ++) {\r\n\r\n\t\t\tgeometry.vertices[i] = skinned[i];\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tfunction applySkin ( geometry, instanceCtrl, frame ) {\r\n\r\n\t\tvar skinController = controllers[ instanceCtrl.url ];\r\n\r\n\t\tframe = frame !== undefined ? frame : 40;\r\n\r\n\t\tif ( !skinController || !skinController.skin ) {\r\n\r\n\t\t\tconsole.log( 'ColladaLoader: Could not find skin controller.' );\r\n\t\t\treturn;\r\n\r\n\t\t}\r\n\r\n\t\tif ( !instanceCtrl.skeleton || !instanceCtrl.skeleton.length ) {\r\n\r\n\t\t\tconsole.log( 'ColladaLoader: Could not find the skeleton for the skin. ' );\r\n\t\t\treturn;\r\n\r\n\t\t}\r\n\r\n\t\tvar animationBounds = calcAnimationBounds();\r\n\t\tvar skeleton = visualScene.getChildById( instanceCtrl.skeleton[0], true ) || visualScene.getChildBySid( instanceCtrl.skeleton[0], true );\r\n\r\n\t\t//flatten the skeleton into a list of bones\r\n\t\tvar bonelist = flattenSkeleton(skeleton);\r\n\t\tvar joints = skinController.skin.joints;\r\n\r\n\t\t//sort that list so that the order reflects the order in the joint list\r\n\t\tvar sortedbones = [];\r\n\t\tfor (var i = 0; i < joints.length; i ++) {\r\n\r\n\t\t\tfor (var j = 0; j < bonelist.length; j ++) {\r\n\r\n\t\t\t\tif (bonelist[j].name === joints[i]) {\r\n\r\n\t\t\t\t\tsortedbones[i] = bonelist[j];\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\t//hook up the parents by index instead of name\r\n\t\tfor (var i = 0; i < sortedbones.length; i ++) {\r\n\r\n\t\t\tfor (var j = 0; j < sortedbones.length; j ++) {\r\n\r\n\t\t\t\tif (sortedbones[i].parent === sortedbones[j].name) {\r\n\r\n\t\t\t\t\tsortedbones[i].parent = j;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\r\n\t\tvar i, j, w, vidx, weight;\r\n\t\tvar v = new THREE.Vector3(), o, s;\r\n\r\n\t\t// move vertices to bind shape\r\n\t\tfor ( i = 0; i < geometry.vertices.length; i ++ ) {\r\n\t\t\tgeometry.vertices[i].applyMatrix4( skinController.skin.bindShapeMatrix );\r\n\t\t}\r\n\r\n\t\tvar skinIndices = [];\r\n\t\tvar skinWeights = [];\r\n\t\tvar weights = skinController.skin.weights;\r\n\r\n\t\t// hook up the skin weights\r\n\t\t// TODO - this might be a good place to choose greatest 4 weights\r\n\t\tfor ( var i =0; i < weights.length; i ++ ) {\r\n\r\n\t\t\tvar indicies = new THREE.Vector4(weights[i][0] ? weights[i][0].joint : 0,weights[i][1] ? weights[i][1].joint : 0,weights[i][2] ? weights[i][2].joint : 0,weights[i][3] ? weights[i][3].joint : 0);\r\n\t\t\tvar weight = new THREE.Vector4(weights[i][0] ? weights[i][0].weight : 0,weights[i][1] ? weights[i][1].weight : 0,weights[i][2] ? weights[i][2].weight : 0,weights[i][3] ? weights[i][3].weight : 0);\r\n\r\n\t\t\tskinIndices.push(indicies);\r\n\t\t\tskinWeights.push(weight);\r\n\r\n\t\t}\r\n\r\n\t\tgeometry.skinIndices = skinIndices;\r\n\t\tgeometry.skinWeights = skinWeights;\r\n\t\tgeometry.bones = sortedbones;\r\n\t\t// process animation, or simply pose the rig if no animation\r\n\r\n\t\t//create an animation for the animated bones\r\n\t\t//NOTE: this has no effect when using morphtargets\r\n\t\tvar animationdata = { \"name\":animationBounds.ID,\"fps\":30,\"length\":animationBounds.frames / 30,\"hierarchy\":[] };\r\n\r\n\t\tfor (var j = 0; j < sortedbones.length; j ++) {\r\n\r\n\t\t\tanimationdata.hierarchy.push({ parent:sortedbones[j].parent, name:sortedbones[j].name, keys:[] });\r\n\r\n\t\t}\r\n\r\n\t\tconsole.log( 'ColladaLoader:', animationBounds.ID + ' has ' + sortedbones.length + ' bones.' );\r\n\r\n\r\n\r\n\t\tskinToBindPose(geometry, skeleton, skinController);\r\n\r\n\r\n\t\tfor ( frame = 0; frame < animationBounds.frames; frame ++ ) {\r\n\r\n\t\t\tvar bones = [];\r\n\t\t\tvar skinned = [];\r\n\t\t\t// process the frame and setup the rig with a fresh\r\n\t\t\t// transform, possibly from the bone's animation channel(s)\r\n\r\n\t\t\tsetupSkeleton( skeleton, bones, frame );\r\n\t\t\tsetupSkinningMatrices( bones, skinController.skin );\r\n\r\n\t\t\tfor (var i = 0; i < bones.length; i ++) {\r\n\r\n\t\t\t\tfor (var j = 0; j < animationdata.hierarchy.length; j ++) {\r\n\r\n\t\t\t\t\tif (animationdata.hierarchy[j].name === bones[i].sid) {\r\n\r\n\t\t\t\t\t\tvar key = {};\r\n\t\t\t\t\t\tkey.time = (frame / 30);\r\n\t\t\t\t\t\tkey.matrix = bones[i].animatrix;\r\n\r\n\t\t\t\t\t\tif (frame === 0)\r\n\t\t\t\t\t\t\tbones[i].matrix = key.matrix;\r\n\r\n\t\t\t\t\t\tvar data = [ new THREE.Vector3(),new THREE.Quaternion(),new THREE.Vector3() ];\r\n\t\t\t\t\t\tkey.matrix.decompose(data[0], data[1], data[2]);\r\n\r\n\t\t\t\t\t\tkey.pos = [ data[0].x,data[0].y,data[0].z ];\r\n\r\n\t\t\t\t\t\tkey.scl = [ data[2].x,data[2].y,data[2].z ];\r\n\t\t\t\t\t\tkey.rot = data[1];\r\n\r\n\t\t\t\t\t\tanimationdata.hierarchy[j].keys.push(key);\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tgeometry.animation = animationdata;\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tfunction createKinematics() {\r\n\r\n\t\tif ( kinematicsModel && kinematicsModel.joints.length === 0 ) {\r\n\t\t\tkinematics = undefined;\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tvar jointMap = {};\r\n\r\n\t\tvar _addToMap = function( jointIndex, parentVisualElement ) {\r\n\r\n\t\t\tvar parentVisualElementId = parentVisualElement.getAttribute( 'id' );\r\n\t\t\tvar colladaNode = visualScene.getChildById( parentVisualElementId, true );\r\n\t\t\tvar joint = kinematicsModel.joints[ jointIndex ];\r\n\r\n\t\t\tscene.traverse(function( node ) {\r\n\r\n\t\t\t\tif ( node.colladaId == parentVisualElementId ) {\r\n\r\n\t\t\t\t\tjointMap[ jointIndex ] = {\r\n\t\t\t\t\t\tnode: node,\r\n\t\t\t\t\t\ttransforms: colladaNode.transforms,\r\n\t\t\t\t\t\tjoint: joint,\r\n\t\t\t\t\t\tposition: joint.zeroPosition\r\n\t\t\t\t\t};\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t});\r\n\r\n\t\t};\r\n\r\n\t\tkinematics = {\r\n\r\n\t\t\tjoints: kinematicsModel && kinematicsModel.joints,\r\n\r\n\t\t\tgetJointValue: function( jointIndex ) {\r\n\r\n\t\t\t\tvar jointData = jointMap[ jointIndex ];\r\n\r\n\t\t\t\tif ( jointData ) {\r\n\r\n\t\t\t\t\treturn jointData.position;\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tconsole.log( 'getJointValue: joint ' + jointIndex + ' doesn\\'t exist' );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t},\r\n\r\n\t\t\tsetJointValue: function( jointIndex, value ) {\r\n\r\n\t\t\t\tvar jointData = jointMap[ jointIndex ];\r\n\r\n\t\t\t\tif ( jointData ) {\r\n\r\n\t\t\t\t\tvar joint = jointData.joint;\r\n\r\n\t\t\t\t\tif ( value > joint.limits.max || value < joint.limits.min ) {\r\n\r\n\t\t\t\t\t\tconsole.log( 'setJointValue: joint ' + jointIndex + ' value ' + value + ' outside of limits (min: ' + joint.limits.min + ', max: ' + joint.limits.max + ')' );\r\n\r\n\t\t\t\t\t} else if ( joint.static ) {\r\n\r\n\t\t\t\t\t\tconsole.log( 'setJointValue: joint ' + jointIndex + ' is static' );\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\tvar threejsNode = jointData.node;\r\n\t\t\t\t\t\tvar axis = joint.axis;\r\n\t\t\t\t\t\tvar transforms = jointData.transforms;\r\n\r\n\t\t\t\t\t\tvar matrix = new THREE.Matrix4();\r\n\r\n\t\t\t\t\t\tfor (i = 0; i < transforms.length; i ++ ) {\r\n\r\n\t\t\t\t\t\t\tvar transform = transforms[ i ];\r\n\r\n\t\t\t\t\t\t\t// kinda ghetto joint detection\r\n\t\t\t\t\t\t\tif ( transform.sid && transform.sid.indexOf( 'joint' + jointIndex ) !== -1 ) {\r\n\r\n\t\t\t\t\t\t\t\t// apply actual joint value here\r\n\t\t\t\t\t\t\t\tswitch ( joint.type ) {\r\n\r\n\t\t\t\t\t\t\t\t\tcase 'revolute':\r\n\r\n\t\t\t\t\t\t\t\t\t\tmatrix.multiply( m1.makeRotationAxis( axis, THREE.Math.degToRad(value) ) );\r\n\t\t\t\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\t\t\t\tcase 'prismatic':\r\n\r\n\t\t\t\t\t\t\t\t\t\tmatrix.multiply( m1.makeTranslation(axis.x * value, axis.y * value, axis.z * value ) );\r\n\t\t\t\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\t\t\t\tdefault:\r\n\r\n\t\t\t\t\t\t\t\t\t\tconsole.warn( 'setJointValue: unknown joint type: ' + joint.type );\r\n\t\t\t\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\t\t\tvar m1 = new THREE.Matrix4();\r\n\r\n\t\t\t\t\t\t\t\tswitch ( transform.type ) {\r\n\r\n\t\t\t\t\t\t\t\t\tcase 'matrix':\r\n\r\n\t\t\t\t\t\t\t\t\t\tmatrix.multiply( transform.obj );\r\n\r\n\t\t\t\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\t\t\t\tcase 'translate':\r\n\r\n\t\t\t\t\t\t\t\t\t\tmatrix.multiply( m1.makeTranslation( transform.obj.x, transform.obj.y, transform.obj.z ) );\r\n\r\n\t\t\t\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\t\t\t\tcase 'rotate':\r\n\r\n\t\t\t\t\t\t\t\t\t\tmatrix.multiply( m1.makeRotationAxis( transform.obj, transform.angle ) );\r\n\r\n\t\t\t\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t// apply the matrix to the threejs node\r\n\t\t\t\t\t\tvar elementsFloat32Arr = matrix.elements;\r\n\t\t\t\t\t\tvar elements = Array.prototype.slice.call( elementsFloat32Arr );\r\n\r\n\t\t\t\t\t\tvar elementsRowMajor = [\r\n\t\t\t\t\t\t\telements[ 0 ],\r\n\t\t\t\t\t\t\telements[ 4 ],\r\n\t\t\t\t\t\t\telements[ 8 ],\r\n\t\t\t\t\t\t\telements[ 12 ],\r\n\t\t\t\t\t\t\telements[ 1 ],\r\n\t\t\t\t\t\t\telements[ 5 ],\r\n\t\t\t\t\t\t\telements[ 9 ],\r\n\t\t\t\t\t\t\telements[ 13 ],\r\n\t\t\t\t\t\t\telements[ 2 ],\r\n\t\t\t\t\t\t\telements[ 6 ],\r\n\t\t\t\t\t\t\telements[ 10 ],\r\n\t\t\t\t\t\t\telements[ 14 ],\r\n\t\t\t\t\t\t\telements[ 3 ],\r\n\t\t\t\t\t\t\telements[ 7 ],\r\n\t\t\t\t\t\t\telements[ 11 ],\r\n\t\t\t\t\t\t\telements[ 15 ]\r\n\t\t\t\t\t\t];\r\n\r\n\t\t\t\t\t\tthreejsNode.matrix.set.apply( threejsNode.matrix, elementsRowMajor );\r\n\t\t\t\t\t\tthreejsNode.matrix.decompose( threejsNode.position, threejsNode.quaternion, threejsNode.scale );\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tconsole.log( 'setJointValue: joint ' + jointIndex + ' doesn\\'t exist' );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t};\r\n\r\n\t\tvar element = COLLADA.querySelector('scene instance_kinematics_scene');\r\n\r\n\t\tif ( element ) {\r\n\r\n\t\t\tfor ( var i = 0; i < element.childNodes.length; i ++ ) {\r\n\r\n\t\t\t\tvar child = element.childNodes[ i ];\r\n\r\n\t\t\t\tif ( child.nodeType != 1 ) continue;\r\n\r\n\t\t\t\tswitch ( child.nodeName ) {\r\n\r\n\t\t\t\t\tcase 'bind_joint_axis':\r\n\r\n\t\t\t\t\t\tvar visualTarget = child.getAttribute( 'target' ).split( '/' ).pop();\r\n\t\t\t\t\t\tvar axis = child.querySelector('axis param').textContent;\r\n\t\t\t\t\t\tvar jointIndex = parseInt( axis.split( 'joint' ).pop().split( '.' )[0] );\r\n\t\t\t\t\t\tvar visualTargetElement = COLLADA.querySelector( '[sid=\"' + visualTarget + '\"]' );\r\n\r\n\t\t\t\t\t\tif ( visualTargetElement ) {\r\n\t\t\t\t\t\t\tvar parentVisualElement = visualTargetElement.parentElement;\r\n\t\t\t\t\t\t\t_addToMap(jointIndex, parentVisualElement);\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tdefault:\r\n\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tfunction createSceneGraph ( node, parent ) {\r\n\r\n\t\tvar obj = new THREE.Object3D();\r\n\t\tvar skinned = false;\r\n\t\tvar skinController;\r\n\t\tvar morphController;\r\n\t\tvar i, j;\r\n\r\n\t\t// FIXME: controllers\r\n\r\n\t\tfor ( i = 0; i < node.controllers.length; i ++ ) {\r\n\r\n\t\t\tvar controller = controllers[ node.controllers[ i ].url ];\r\n\r\n\t\t\tswitch ( controller.type ) {\r\n\r\n\t\t\t\tcase 'skin':\r\n\r\n\t\t\t\t\tif ( geometries[ controller.skin.source ] ) {\r\n\r\n\t\t\t\t\t\tvar inst_geom = new InstanceGeometry();\r\n\r\n\t\t\t\t\t\tinst_geom.url = controller.skin.source;\r\n\t\t\t\t\t\tinst_geom.instance_material = node.controllers[ i ].instance_material;\r\n\r\n\t\t\t\t\t\tnode.geometries.push( inst_geom );\r\n\t\t\t\t\t\tskinned = true;\r\n\t\t\t\t\t\tskinController = node.controllers[ i ];\r\n\r\n\t\t\t\t\t} else if ( controllers[ controller.skin.source ] ) {\r\n\r\n\t\t\t\t\t\t// urgh: controller can be chained\r\n\t\t\t\t\t\t// handle the most basic case...\r\n\r\n\t\t\t\t\t\tvar second = controllers[ controller.skin.source ];\r\n\t\t\t\t\t\tmorphController = second;\r\n\t\t\t\t\t//\tskinController = node.controllers[i];\r\n\r\n\t\t\t\t\t\tif ( second.morph && geometries[ second.morph.source ] ) {\r\n\r\n\t\t\t\t\t\t\tvar inst_geom = new InstanceGeometry();\r\n\r\n\t\t\t\t\t\t\tinst_geom.url = second.morph.source;\r\n\t\t\t\t\t\t\tinst_geom.instance_material = node.controllers[ i ].instance_material;\r\n\r\n\t\t\t\t\t\t\tnode.geometries.push( inst_geom );\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'morph':\r\n\r\n\t\t\t\t\tif ( geometries[ controller.morph.source ] ) {\r\n\r\n\t\t\t\t\t\tvar inst_geom = new InstanceGeometry();\r\n\r\n\t\t\t\t\t\tinst_geom.url = controller.morph.source;\r\n\t\t\t\t\t\tinst_geom.instance_material = node.controllers[ i ].instance_material;\r\n\r\n\t\t\t\t\t\tnode.geometries.push( inst_geom );\r\n\t\t\t\t\t\tmorphController = node.controllers[ i ];\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tconsole.log( 'ColladaLoader: Morph-controller partially supported.' );\r\n\r\n\t\t\t\tdefault:\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\t// geometries\r\n\r\n\t\tvar double_sided_materials = {};\r\n\r\n\t\tfor ( i = 0; i < node.geometries.length; i ++ ) {\r\n\r\n\t\t\tvar instance_geometry = node.geometries[i];\r\n\t\t\tvar instance_materials = instance_geometry.instance_material;\r\n\t\t\tvar geometry = geometries[ instance_geometry.url ];\r\n\t\t\tvar used_materials = {};\r\n\t\t\tvar used_materials_array = [];\r\n\t\t\tvar num_materials = 0;\r\n\t\t\tvar first_material;\r\n\r\n\t\t\tif ( geometry ) {\r\n\r\n\t\t\t\tif ( !geometry.mesh || !geometry.mesh.primitives )\r\n\t\t\t\t\tcontinue;\r\n\r\n\t\t\t\tif ( obj.name.length === 0 ) {\r\n\r\n\t\t\t\t\tobj.name = geometry.id;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// collect used fx for this geometry-instance\r\n\r\n\t\t\t\tif ( instance_materials ) {\r\n\r\n\t\t\t\t\tfor ( j = 0; j < instance_materials.length; j ++ ) {\r\n\r\n\t\t\t\t\t\tvar instance_material = instance_materials[ j ];\r\n\t\t\t\t\t\tvar mat = materials[ instance_material.target ];\r\n\t\t\t\t\t\tvar effect_id = mat.instance_effect.url;\r\n\t\t\t\t\t\tvar shader = effects[ effect_id ].shader;\r\n\t\t\t\t\t\tvar material3js = shader.material;\r\n\r\n\t\t\t\t\t\tif ( geometry.doubleSided ) {\r\n\r\n\t\t\t\t\t\t\tif ( !( instance_material.symbol in double_sided_materials ) ) {\r\n\r\n\t\t\t\t\t\t\t\tvar _copied_material = material3js.clone();\r\n\t\t\t\t\t\t\t\t_copied_material.side = THREE.DoubleSide;\r\n\t\t\t\t\t\t\t\tdouble_sided_materials[ instance_material.symbol ] = _copied_material;\r\n\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\tmaterial3js = double_sided_materials[ instance_material.symbol ];\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tmaterial3js.opacity = !material3js.opacity ? 1 : material3js.opacity;\r\n\t\t\t\t\t\tused_materials[ instance_material.symbol ] = num_materials;\r\n\t\t\t\t\t\tused_materials_array.push( material3js );\r\n\t\t\t\t\t\tfirst_material = material3js;\r\n\t\t\t\t\t\tfirst_material.name = mat.name === null || mat.name === '' ? mat.id : mat.name;\r\n\t\t\t\t\t\tnum_materials ++;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tvar mesh;\r\n\t\t\t\tvar material = first_material || new THREE.MeshLambertMaterial( { color: 0xdddddd, side: geometry.doubleSided ? THREE.DoubleSide : THREE.FrontSide } );\r\n\t\t\t\tvar geom = geometry.mesh.geometry3js;\r\n\r\n\t\t\t\tif ( num_materials > 1 ) {\r\n\r\n\t\t\t\t\tmaterial = new THREE.MultiMaterial( used_materials_array );\r\n\t\t\t\t\t\r\n\t\t\t\t\tfor ( j = 0; j < geom.faces.length; j ++ ) {\r\n\r\n\t\t\t\t\t\tvar face = geom.faces[ j ];\r\n\t\t\t\t\t\tface.materialIndex = used_materials[ face.daeMaterial ]\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( skinController !== undefined ) {\r\n\r\n\r\n\t\t\t\t\tapplySkin( geom, skinController );\r\n\r\n\t\t\t\t\tif ( geom.morphTargets.length > 0 ) {\r\n\r\n\t\t\t\t\t\tmaterial.morphTargets = true;\r\n\t\t\t\t\t\tmaterial.skinning = false;\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\tmaterial.morphTargets = false;\r\n\t\t\t\t\t\tmaterial.skinning = true;\r\n\r\n\t\t\t\t\t}\r\n\r\n\r\n\t\t\t\t\tmesh = new THREE.SkinnedMesh( geom, material, false );\r\n\r\n\r\n\t\t\t\t\t//mesh.skeleton = skinController.skeleton;\r\n\t\t\t\t\t//mesh.skinController = controllers[ skinController.url ];\r\n\t\t\t\t\t//mesh.skinInstanceController = skinController;\r\n\t\t\t\t\tmesh.name = 'skin_' + skins.length;\r\n\r\n\r\n\r\n\t\t\t\t\t//mesh.animationHandle.setKey(0);\r\n\t\t\t\t\tskins.push( mesh );\r\n\r\n\t\t\t\t} else if ( morphController !== undefined ) {\r\n\r\n\t\t\t\t\tcreateMorph( geom, morphController );\r\n\r\n\t\t\t\t\tmaterial.morphTargets = true;\r\n\r\n\t\t\t\t\tmesh = new THREE.Mesh( geom, material );\r\n\t\t\t\t\tmesh.name = 'morph_' + morphs.length;\r\n\r\n\t\t\t\t\tmorphs.push( mesh );\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tif ( geom.isLineStrip === true ) {\r\n\r\n\t\t\t\t\t\tmesh = new THREE.Line( geom );\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\tmesh = new THREE.Mesh( geom, material );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tobj.add(mesh);\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tfor ( i = 0; i < node.cameras.length; i ++ ) {\r\n\r\n\t\t\tvar instance_camera = node.cameras[i];\r\n\t\t\tvar cparams = cameras[instance_camera.url];\r\n\r\n\t\t\tvar cam = new THREE.PerspectiveCamera(cparams.yfov, parseFloat(cparams.aspect_ratio),\r\n\t\t\t\t\tparseFloat(cparams.znear), parseFloat(cparams.zfar));\r\n\r\n\t\t\tobj.add(cam);\r\n\t\t}\r\n\r\n\t\tfor ( i = 0; i < node.lights.length; i ++ ) {\r\n\r\n\t\t\tvar light = null;\r\n\t\t\tvar instance_light = node.lights[i];\r\n\t\t\tvar lparams = lights[instance_light.url];\r\n\r\n\t\t\tif ( lparams && lparams.technique ) {\r\n\r\n\t\t\t\tvar color = lparams.color.getHex();\r\n\t\t\t\tvar intensity = lparams.intensity;\r\n\t\t\t\tvar distance = lparams.distance;\r\n\t\t\t\tvar angle = lparams.falloff_angle;\r\n\r\n\t\t\t\tswitch ( lparams.technique ) {\r\n\r\n\t\t\t\t\tcase 'directional':\r\n\r\n\t\t\t\t\t\tlight = new THREE.DirectionalLight( color, intensity, distance );\r\n\t\t\t\t\t\tlight.position.set(0, 0, 1);\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase 'point':\r\n\r\n\t\t\t\t\t\tlight = new THREE.PointLight( color, intensity, distance );\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase 'spot':\r\n\r\n\t\t\t\t\t\tlight = new THREE.SpotLight( color, intensity, distance, angle );\r\n\t\t\t\t\t\tlight.position.set(0, 0, 1);\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase 'ambient':\r\n\r\n\t\t\t\t\t\tlight = new THREE.AmbientLight( color );\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif (light) {\r\n\t\t\t\tobj.add(light);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tobj.name = node.name || node.id || \"\";\r\n\t\tobj.colladaId = node.id || \"\";\r\n\t\tobj.layer = node.layer || \"\";\r\n\t\tobj.matrix = node.matrix;\r\n\t\tobj.matrix.decompose( obj.position, obj.quaternion, obj.scale );\r\n\r\n\t\tif ( options.centerGeometry && obj.geometry ) {\r\n\r\n\t\t\tvar delta = obj.geometry.center();\r\n\t\t\tdelta.multiply( obj.scale );\r\n\t\t\tdelta.applyQuaternion( obj.quaternion );\r\n\r\n\t\t\tobj.position.sub( delta );\r\n\r\n\t\t}\r\n\r\n\t\tfor ( i = 0; i < node.nodes.length; i ++ ) {\r\n\r\n\t\t\tobj.add( createSceneGraph( node.nodes[i], node ) );\r\n\r\n\t\t}\r\n\r\n\t\treturn obj;\r\n\r\n\t}\r\n\r\n\tfunction getJointId( skin, id ) {\r\n\r\n\t\tfor ( var i = 0; i < skin.joints.length; i ++ ) {\r\n\r\n\t\t\tif ( skin.joints[ i ] === id ) {\r\n\r\n\t\t\t\treturn i;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tfunction getLibraryNode( id ) {\r\n\r\n\t\tvar nodes = COLLADA.querySelectorAll('library_nodes node');\r\n\r\n\t\tfor ( var i = 0; i < nodes.length; i++ ) {\r\n\r\n\t\t\tvar attObj = nodes[i].attributes.getNamedItem('id');\r\n\r\n\t\t\tif ( attObj && attObj.value === id ) {\r\n\r\n\t\t\t\treturn nodes[i];\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\treturn undefined;\r\n\r\n\t}\r\n\r\n\tfunction getChannelsForNode ( node ) {\r\n\r\n\t\tvar channels = [];\r\n\t\tvar startTime = 1000000;\r\n\t\tvar endTime = -1000000;\r\n\r\n\t\tfor ( var id in animations ) {\r\n\r\n\t\t\tvar animation = animations[id];\r\n\r\n\t\t\tfor ( var i = 0; i < animation.channel.length; i ++ ) {\r\n\r\n\t\t\t\tvar channel = animation.channel[i];\r\n\t\t\t\tvar sampler = animation.sampler[i];\r\n\t\t\t\tvar id = channel.target.split('/')[0];\r\n\r\n\t\t\t\tif ( id == node.id ) {\r\n\r\n\t\t\t\t\tsampler.create();\r\n\t\t\t\t\tchannel.sampler = sampler;\r\n\t\t\t\t\tstartTime = Math.min(startTime, sampler.startTime);\r\n\t\t\t\t\tendTime = Math.max(endTime, sampler.endTime);\r\n\t\t\t\t\tchannels.push(channel);\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tif ( channels.length ) {\r\n\r\n\t\t\tnode.startTime = startTime;\r\n\t\t\tnode.endTime = endTime;\r\n\r\n\t\t}\r\n\r\n\t\treturn channels;\r\n\r\n\t}\r\n\r\n\tfunction calcFrameDuration( node ) {\r\n\r\n\t\tvar minT = 10000000;\r\n\r\n\t\tfor ( var i = 0; i < node.channels.length; i ++ ) {\r\n\r\n\t\t\tvar sampler = node.channels[i].sampler;\r\n\r\n\t\t\tfor ( var j = 0; j < sampler.input.length - 1; j ++ ) {\r\n\r\n\t\t\t\tvar t0 = sampler.input[ j ];\r\n\t\t\t\tvar t1 = sampler.input[ j + 1 ];\r\n\t\t\t\tminT = Math.min( minT, t1 - t0 );\r\n\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn minT;\r\n\r\n\t}\r\n\r\n\tfunction calcMatrixAt( node, t ) {\r\n\r\n\t\tvar animated = {};\r\n\r\n\t\tvar i, j;\r\n\r\n\t\tfor ( i = 0; i < node.channels.length; i ++ ) {\r\n\r\n\t\t\tvar channel = node.channels[ i ];\r\n\t\t\tanimated[ channel.sid ] = channel;\r\n\r\n\t\t}\r\n\r\n\t\tvar matrix = new THREE.Matrix4();\r\n\r\n\t\tfor ( i = 0; i < node.transforms.length; i ++ ) {\r\n\r\n\t\t\tvar transform = node.transforms[ i ];\r\n\t\t\tvar channel = animated[ transform.sid ];\r\n\r\n\t\t\tif ( channel !== undefined ) {\r\n\r\n\t\t\t\tvar sampler = channel.sampler;\r\n\t\t\t\tvar value;\r\n\r\n\t\t\t\tfor ( j = 0; j < sampler.input.length - 1; j ++ ) {\r\n\r\n\t\t\t\t\tif ( sampler.input[ j + 1 ] > t ) {\r\n\r\n\t\t\t\t\t\tvalue = sampler.output[ j ];\r\n\t\t\t\t\t\t//console.log(value.flatten)\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( value !== undefined ) {\r\n\r\n\t\t\t\t\tif ( value instanceof THREE.Matrix4 ) {\r\n\r\n\t\t\t\t\t\tmatrix.multiplyMatrices( matrix, value );\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\t// FIXME: handle other types\r\n\r\n\t\t\t\t\t\tmatrix.multiplyMatrices( matrix, transform.matrix );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tmatrix.multiplyMatrices( matrix, transform.matrix );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tmatrix.multiplyMatrices( matrix, transform.matrix );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\treturn matrix;\r\n\r\n\t}\r\n\r\n\tfunction bakeAnimations ( node ) {\r\n\r\n\t\tif ( node.channels && node.channels.length ) {\r\n\r\n\t\t\tvar keys = [],\r\n\t\t\t\tsids = [];\r\n\r\n\t\t\tfor ( var i = 0, il = node.channels.length; i < il; i ++ ) {\r\n\r\n\t\t\t\tvar channel = node.channels[i],\r\n\t\t\t\t\tfullSid = channel.fullSid,\r\n\t\t\t\t\tsampler = channel.sampler,\r\n\t\t\t\t\tinput = sampler.input,\r\n\t\t\t\t\ttransform = node.getTransformBySid( channel.sid ),\r\n\t\t\t\t\tmember;\r\n\r\n\t\t\t\tif ( channel.arrIndices ) {\r\n\r\n\t\t\t\t\tmember = [];\r\n\r\n\t\t\t\t\tfor ( var j = 0, jl = channel.arrIndices.length; j < jl; j ++ ) {\r\n\r\n\t\t\t\t\t\tmember[ j ] = getConvertedIndex( channel.arrIndices[ j ] );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tmember = getConvertedMember( channel.member );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( transform ) {\r\n\r\n\t\t\t\t\tif ( sids.indexOf( fullSid ) === -1 ) {\r\n\r\n\t\t\t\t\t\tsids.push( fullSid );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tfor ( var j = 0, jl = input.length; j < jl; j ++ ) {\r\n\r\n\t\t\t\t\t\tvar time = input[j],\r\n\t\t\t\t\t\t\tdata = sampler.getData( transform.type, j, member ),\r\n\t\t\t\t\t\t\tkey = findKey( keys, time );\r\n\r\n\t\t\t\t\t\tif ( !key ) {\r\n\r\n\t\t\t\t\t\t\tkey = new Key( time );\r\n\t\t\t\t\t\t\tvar timeNdx = findTimeNdx( keys, time );\r\n\t\t\t\t\t\t\tkeys.splice( timeNdx === -1 ? keys.length : timeNdx, 0, key );\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tkey.addTarget( fullSid, transform, member, data );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tconsole.log( 'Could not find transform \"' + channel.sid + '\" in node ' + node.id );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// post process\r\n\t\t\tfor ( var i = 0; i < sids.length; i ++ ) {\r\n\r\n\t\t\t\tvar sid = sids[ i ];\r\n\r\n\t\t\t\tfor ( var j = 0; j < keys.length; j ++ ) {\r\n\r\n\t\t\t\t\tvar key = keys[ j ];\r\n\r\n\t\t\t\t\tif ( !key.hasTarget( sid ) ) {\r\n\r\n\t\t\t\t\t\tinterpolateKeys( keys, key, j, sid );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tnode.keys = keys;\r\n\t\t\tnode.sids = sids;\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tfunction findKey ( keys, time) {\r\n\r\n\t\tvar retVal = null;\r\n\r\n\t\tfor ( var i = 0, il = keys.length; i < il && retVal === null; i ++ ) {\r\n\r\n\t\t\tvar key = keys[i];\r\n\r\n\t\t\tif ( key.time === time ) {\r\n\r\n\t\t\t\tretVal = key;\r\n\r\n\t\t\t} else if ( key.time > time ) {\r\n\r\n\t\t\t\tbreak;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\treturn retVal;\r\n\r\n\t}\r\n\r\n\tfunction findTimeNdx ( keys, time) {\r\n\r\n\t\tvar ndx = -1;\r\n\r\n\t\tfor ( var i = 0, il = keys.length; i < il && ndx === -1; i ++ ) {\r\n\r\n\t\t\tvar key = keys[i];\r\n\r\n\t\t\tif ( key.time >= time ) {\r\n\r\n\t\t\t\tndx = i;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\treturn ndx;\r\n\r\n\t}\r\n\r\n\tfunction interpolateKeys ( keys, key, ndx, fullSid ) {\r\n\r\n\t\tvar prevKey = getPrevKeyWith( keys, fullSid, ndx ? ndx - 1 : 0 ),\r\n\t\t\tnextKey = getNextKeyWith( keys, fullSid, ndx + 1 );\r\n\r\n\t\tif ( prevKey && nextKey ) {\r\n\r\n\t\t\tvar scale = (key.time - prevKey.time) / (nextKey.time - prevKey.time),\r\n\t\t\t\tprevTarget = prevKey.getTarget( fullSid ),\r\n\t\t\t\tnextData = nextKey.getTarget( fullSid ).data,\r\n\t\t\t\tprevData = prevTarget.data,\r\n\t\t\t\tdata;\r\n\r\n\t\t\tif ( prevTarget.type === 'matrix' ) {\r\n\r\n\t\t\t\tdata = prevData;\r\n\r\n\t\t\t} else if ( prevData.length ) {\r\n\r\n\t\t\t\tdata = [];\r\n\r\n\t\t\t\tfor ( var i = 0; i < prevData.length; ++ i ) {\r\n\r\n\t\t\t\t\tdata[ i ] = prevData[ i ] + ( nextData[ i ] - prevData[ i ] ) * scale;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tdata = prevData + ( nextData - prevData ) * scale;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tkey.addTarget( fullSid, prevTarget.transform, prevTarget.member, data );\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t// Get next key with given sid\r\n\r\n\tfunction getNextKeyWith( keys, fullSid, ndx ) {\r\n\r\n\t\tfor ( ; ndx < keys.length; ndx ++ ) {\r\n\r\n\t\t\tvar key = keys[ ndx ];\r\n\r\n\t\t\tif ( key.hasTarget( fullSid ) ) {\r\n\r\n\t\t\t\treturn key;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\treturn null;\r\n\r\n\t}\r\n\r\n\t// Get previous key with given sid\r\n\r\n\tfunction getPrevKeyWith( keys, fullSid, ndx ) {\r\n\r\n\t\tndx = ndx >= 0 ? ndx : ndx + keys.length;\r\n\r\n\t\tfor ( ; ndx >= 0; ndx -- ) {\r\n\r\n\t\t\tvar key = keys[ ndx ];\r\n\r\n\t\t\tif ( key.hasTarget( fullSid ) ) {\r\n\r\n\t\t\t\treturn key;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\treturn null;\r\n\r\n\t}\r\n\r\n\tfunction _Image() {\r\n\r\n\t\tthis.id = \"\";\r\n\t\tthis.init_from = \"\";\r\n\r\n\t}\r\n\r\n\t_Image.prototype.parse = function(element) {\r\n\r\n\t\tthis.id = element.getAttribute('id');\r\n\r\n\t\tfor ( var i = 0; i < element.childNodes.length; i ++ ) {\r\n\r\n\t\t\tvar child = element.childNodes[ i ];\r\n\r\n\t\t\tif ( child.nodeName === 'init_from' ) {\r\n\r\n\t\t\t\tthis.init_from = child.textContent;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\r\n\t};\r\n\r\n\tfunction Controller() {\r\n\r\n\t\tthis.id = \"\";\r\n\t\tthis.name = \"\";\r\n\t\tthis.type = \"\";\r\n\t\tthis.skin = null;\r\n\t\tthis.morph = null;\r\n\r\n\t}\r\n\r\n\tController.prototype.parse = function( element ) {\r\n\r\n\t\tthis.id = element.getAttribute('id');\r\n\t\tthis.name = element.getAttribute('name');\r\n\t\tthis.type = \"none\";\r\n\r\n\t\tfor ( var i = 0; i < element.childNodes.length; i ++ ) {\r\n\r\n\t\t\tvar child = element.childNodes[ i ];\r\n\r\n\t\t\tswitch ( child.nodeName ) {\r\n\r\n\t\t\t\tcase 'skin':\r\n\r\n\t\t\t\t\tthis.skin = (new Skin()).parse(child);\r\n\t\t\t\t\tthis.type = child.nodeName;\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'morph':\r\n\r\n\t\t\t\t\tthis.morph = (new Morph()).parse(child);\r\n\t\t\t\t\tthis.type = child.nodeName;\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tdefault:\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\r\n\t};\r\n\r\n\tfunction Morph() {\r\n\r\n\t\tthis.method = null;\r\n\t\tthis.source = null;\r\n\t\tthis.targets = null;\r\n\t\tthis.weights = null;\r\n\r\n\t}\r\n\r\n\tMorph.prototype.parse = function( element ) {\r\n\r\n\t\tvar sources = {};\r\n\t\tvar inputs = [];\r\n\t\tvar i;\r\n\r\n\t\tthis.method = element.getAttribute( 'method' );\r\n\t\tthis.source = element.getAttribute( 'source' ).replace( /^#/, '' );\r\n\r\n\t\tfor ( i = 0; i < element.childNodes.length; i ++ ) {\r\n\r\n\t\t\tvar child = element.childNodes[ i ];\r\n\t\t\tif ( child.nodeType != 1 ) continue;\r\n\r\n\t\t\tswitch ( child.nodeName ) {\r\n\r\n\t\t\t\tcase 'source':\r\n\r\n\t\t\t\t\tvar source = ( new Source() ).parse( child );\r\n\t\t\t\t\tsources[ source.id ] = source;\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'targets':\r\n\r\n\t\t\t\t\tinputs = this.parseInputs( child );\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tdefault:\r\n\r\n\t\t\t\t\tconsole.log( child.nodeName );\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tfor ( i = 0; i < inputs.length; i ++ ) {\r\n\r\n\t\t\tvar input = inputs[ i ];\r\n\t\t\tvar source = sources[ input.source ];\r\n\r\n\t\t\tswitch ( input.semantic ) {\r\n\r\n\t\t\t\tcase 'MORPH_TARGET':\r\n\r\n\t\t\t\t\tthis.targets = source.read();\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'MORPH_WEIGHT':\r\n\r\n\t\t\t\t\tthis.weights = source.read();\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tdefault:\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\r\n\t};\r\n\r\n\tMorph.prototype.parseInputs = function(element) {\r\n\r\n\t\tvar inputs = [];\r\n\r\n\t\tfor ( var i = 0; i < element.childNodes.length; i ++ ) {\r\n\r\n\t\t\tvar child = element.childNodes[i];\r\n\t\t\tif ( child.nodeType != 1) continue;\r\n\r\n\t\t\tswitch ( child.nodeName ) {\r\n\r\n\t\t\t\tcase 'input':\r\n\r\n\t\t\t\t\tinputs.push( (new Input()).parse(child) );\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tdefault:\r\n\t\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn inputs;\r\n\r\n\t};\r\n\r\n\tfunction Skin() {\r\n\r\n\t\tthis.source = \"\";\r\n\t\tthis.bindShapeMatrix = null;\r\n\t\tthis.invBindMatrices = [];\r\n\t\tthis.joints = [];\r\n\t\tthis.weights = [];\r\n\r\n\t}\r\n\r\n\tSkin.prototype.parse = function( element ) {\r\n\r\n\t\tvar sources = {};\r\n\t\tvar joints, weights;\r\n\r\n\t\tthis.source = element.getAttribute( 'source' ).replace( /^#/, '' );\r\n\t\tthis.invBindMatrices = [];\r\n\t\tthis.joints = [];\r\n\t\tthis.weights = [];\r\n\r\n\t\tfor ( var i = 0; i < element.childNodes.length; i ++ ) {\r\n\r\n\t\t\tvar child = element.childNodes[i];\r\n\t\t\tif ( child.nodeType != 1 ) continue;\r\n\r\n\t\t\tswitch ( child.nodeName ) {\r\n\r\n\t\t\t\tcase 'bind_shape_matrix':\r\n\r\n\t\t\t\t\tvar f = _floats(child.textContent);\r\n\t\t\t\t\tthis.bindShapeMatrix = getConvertedMat4( f );\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'source':\r\n\r\n\t\t\t\t\tvar src = new Source().parse(child);\r\n\t\t\t\t\tsources[ src.id ] = src;\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'joints':\r\n\r\n\t\t\t\t\tjoints = child;\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'vertex_weights':\r\n\r\n\t\t\t\t\tweights = child;\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tdefault:\r\n\r\n\t\t\t\t\tconsole.log( child.nodeName );\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tthis.parseJoints( joints, sources );\r\n\t\tthis.parseWeights( weights, sources );\r\n\r\n\t\treturn this;\r\n\r\n\t};\r\n\r\n\tSkin.prototype.parseJoints = function ( element, sources ) {\r\n\r\n\t\tfor ( var i = 0; i < element.childNodes.length; i ++ ) {\r\n\r\n\t\t\tvar child = element.childNodes[ i ];\r\n\t\t\tif ( child.nodeType != 1 ) continue;\r\n\r\n\t\t\tswitch ( child.nodeName ) {\r\n\r\n\t\t\t\tcase 'input':\r\n\r\n\t\t\t\t\tvar input = ( new Input() ).parse( child );\r\n\t\t\t\t\tvar source = sources[ input.source ];\r\n\r\n\t\t\t\t\tif ( input.semantic === 'JOINT' ) {\r\n\r\n\t\t\t\t\t\tthis.joints = source.read();\r\n\r\n\t\t\t\t\t} else if ( input.semantic === 'INV_BIND_MATRIX' ) {\r\n\r\n\t\t\t\t\t\tthis.invBindMatrices = source.read();\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tdefault:\r\n\t\t\t\t\tbreak;\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n\tSkin.prototype.parseWeights = function ( element, sources ) {\r\n\r\n\t\tvar v, vcount, inputs = [];\r\n\r\n\t\tfor ( var i = 0; i < element.childNodes.length; i ++ ) {\r\n\r\n\t\t\tvar child = element.childNodes[ i ];\r\n\t\t\tif ( child.nodeType != 1 ) continue;\r\n\r\n\t\t\tswitch ( child.nodeName ) {\r\n\r\n\t\t\t\tcase 'input':\r\n\r\n\t\t\t\t\tinputs.push( ( new Input() ).parse( child ) );\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'v':\r\n\r\n\t\t\t\t\tv = _ints( child.textContent );\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'vcount':\r\n\r\n\t\t\t\t\tvcount = _ints( child.textContent );\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tdefault:\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tvar index = 0;\r\n\r\n\t\tfor ( var i = 0; i < vcount.length; i ++ ) {\r\n\r\n\t\t\tvar numBones = vcount[i];\r\n\t\t\tvar vertex_weights = [];\r\n\r\n\t\t\tfor ( var j = 0; j < numBones; j ++ ) {\r\n\r\n\t\t\t\tvar influence = {};\r\n\r\n\t\t\t\tfor ( var k = 0; k < inputs.length; k ++ ) {\r\n\r\n\t\t\t\t\tvar input = inputs[ k ];\r\n\t\t\t\t\tvar value = v[ index + input.offset ];\r\n\r\n\t\t\t\t\tswitch ( input.semantic ) {\r\n\r\n\t\t\t\t\t\tcase 'JOINT':\r\n\r\n\t\t\t\t\t\t\tinfluence.joint = value;//this.joints[value];\r\n\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\tcase 'WEIGHT':\r\n\r\n\t\t\t\t\t\t\tinfluence.weight = sources[ input.source ].data[ value ];\r\n\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\tdefault:\r\n\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tvertex_weights.push( influence );\r\n\t\t\t\tindex += inputs.length;\r\n\t\t\t}\r\n\r\n\t\t\tfor ( var j = 0; j < vertex_weights.length; j ++ ) {\r\n\r\n\t\t\t\tvertex_weights[ j ].index = i;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tthis.weights.push( vertex_weights );\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n\tfunction VisualScene () {\r\n\r\n\t\tthis.id = \"\";\r\n\t\tthis.name = \"\";\r\n\t\tthis.nodes = [];\r\n\t\tthis.scene = new THREE.Group();\r\n\r\n\t}\r\n\r\n\tVisualScene.prototype.getChildById = function( id, recursive ) {\r\n\r\n\t\tfor ( var i = 0; i < this.nodes.length; i ++ ) {\r\n\r\n\t\t\tvar node = this.nodes[ i ].getChildById( id, recursive );\r\n\r\n\t\t\tif ( node ) {\r\n\r\n\t\t\t\treturn node;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\treturn null;\r\n\r\n\t};\r\n\r\n\tVisualScene.prototype.getChildBySid = function( sid, recursive ) {\r\n\r\n\t\tfor ( var i = 0; i < this.nodes.length; i ++ ) {\r\n\r\n\t\t\tvar node = this.nodes[ i ].getChildBySid( sid, recursive );\r\n\r\n\t\t\tif ( node ) {\r\n\r\n\t\t\t\treturn node;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\treturn null;\r\n\r\n\t};\r\n\r\n\tVisualScene.prototype.parse = function( element ) {\r\n\r\n\t\tthis.id = element.getAttribute( 'id' );\r\n\t\tthis.name = element.getAttribute( 'name' );\r\n\t\tthis.nodes = [];\r\n\r\n\t\tfor ( var i = 0; i < element.childNodes.length; i ++ ) {\r\n\r\n\t\t\tvar child = element.childNodes[ i ];\r\n\t\t\tif ( child.nodeType != 1 ) continue;\r\n\r\n\t\t\tswitch ( child.nodeName ) {\r\n\r\n\t\t\t\tcase 'node':\r\n\r\n\t\t\t\t\tthis.nodes.push( ( new Node() ).parse( child ) );\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tdefault:\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\r\n\t};\r\n\r\n\tfunction Node() {\r\n\r\n\t\tthis.id = \"\";\r\n\t\tthis.name = \"\";\r\n\t\tthis.sid = \"\";\r\n\t\tthis.nodes = [];\r\n\t\tthis.controllers = [];\r\n\t\tthis.transforms = [];\r\n\t\tthis.geometries = [];\r\n\t\tthis.channels = [];\r\n\t\tthis.matrix = new THREE.Matrix4();\r\n\r\n\t}\r\n\r\n\tNode.prototype.getChannelForTransform = function( transformSid ) {\r\n\r\n\t\tfor ( var i = 0; i < this.channels.length; i ++ ) {\r\n\r\n\t\t\tvar channel = this.channels[i];\r\n\t\t\tvar parts = channel.target.split('/');\r\n\t\t\tvar id = parts.shift();\r\n\t\t\tvar sid = parts.shift();\r\n\t\t\tvar dotSyntax = (sid.indexOf(\".\") >= 0);\r\n\t\t\tvar arrSyntax = (sid.indexOf(\"(\") >= 0);\r\n\t\t\tvar arrIndices;\r\n\t\t\tvar member;\r\n\r\n\t\t\tif ( dotSyntax ) {\r\n\r\n\t\t\t\tparts = sid.split(\".\");\r\n\t\t\t\tsid = parts.shift();\r\n\t\t\t\tmember = parts.shift();\r\n\r\n\t\t\t} else if ( arrSyntax ) {\r\n\r\n\t\t\t\tarrIndices = sid.split(\"(\");\r\n\t\t\t\tsid = arrIndices.shift();\r\n\r\n\t\t\t\tfor ( var j = 0; j < arrIndices.length; j ++ ) {\r\n\r\n\t\t\t\t\tarrIndices[ j ] = parseInt( arrIndices[ j ].replace( /\\)/, '' ) );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( sid === transformSid ) {\r\n\r\n\t\t\t\tchannel.info = { sid: sid, dotSyntax: dotSyntax, arrSyntax: arrSyntax, arrIndices: arrIndices };\r\n\t\t\t\treturn channel;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\treturn null;\r\n\r\n\t};\r\n\r\n\tNode.prototype.getChildById = function ( id, recursive ) {\r\n\r\n\t\tif ( this.id === id ) {\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t}\r\n\r\n\t\tif ( recursive ) {\r\n\r\n\t\t\tfor ( var i = 0; i < this.nodes.length; i ++ ) {\r\n\r\n\t\t\t\tvar n = this.nodes[ i ].getChildById( id, recursive );\r\n\r\n\t\t\t\tif ( n ) {\r\n\r\n\t\t\t\t\treturn n;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\treturn null;\r\n\r\n\t};\r\n\r\n\tNode.prototype.getChildBySid = function ( sid, recursive ) {\r\n\r\n\t\tif ( this.sid === sid ) {\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t}\r\n\r\n\t\tif ( recursive ) {\r\n\r\n\t\t\tfor ( var i = 0; i < this.nodes.length; i ++ ) {\r\n\r\n\t\t\t\tvar n = this.nodes[ i ].getChildBySid( sid, recursive );\r\n\r\n\t\t\t\tif ( n ) {\r\n\r\n\t\t\t\t\treturn n;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn null;\r\n\r\n\t};\r\n\r\n\tNode.prototype.getTransformBySid = function ( sid ) {\r\n\r\n\t\tfor ( var i = 0; i < this.transforms.length; i ++ ) {\r\n\r\n\t\t\tif ( this.transforms[ i ].sid === sid ) return this.transforms[ i ];\r\n\r\n\t\t}\r\n\r\n\t\treturn null;\r\n\r\n\t};\r\n\r\n\tNode.prototype.parse = function( element ) {\r\n\r\n\t\tvar url;\r\n\r\n\t\tthis.id = element.getAttribute('id');\r\n\t\tthis.sid = element.getAttribute('sid');\r\n\t\tthis.name = element.getAttribute('name');\r\n\t\tthis.type = element.getAttribute('type');\r\n\t\tthis.layer = element.getAttribute('layer');\r\n\r\n\t\tthis.type = this.type === 'JOINT' ? this.type : 'NODE';\r\n\r\n\t\tthis.nodes = [];\r\n\t\tthis.transforms = [];\r\n\t\tthis.geometries = [];\r\n\t\tthis.cameras = [];\r\n\t\tthis.lights = [];\r\n\t\tthis.controllers = [];\r\n\t\tthis.matrix = new THREE.Matrix4();\r\n\r\n\t\tfor ( var i = 0; i < element.childNodes.length; i ++ ) {\r\n\r\n\t\t\tvar child = element.childNodes[ i ];\r\n\t\t\tif ( child.nodeType != 1 ) continue;\r\n\r\n\t\t\tswitch ( child.nodeName ) {\r\n\r\n\t\t\t\tcase 'node':\r\n\r\n\t\t\t\t\tthis.nodes.push( ( new Node() ).parse( child ) );\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'instance_camera':\r\n\r\n\t\t\t\t\tthis.cameras.push( ( new InstanceCamera() ).parse( child ) );\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'instance_controller':\r\n\r\n\t\t\t\t\tthis.controllers.push( ( new InstanceController() ).parse( child ) );\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'instance_geometry':\r\n\r\n\t\t\t\t\tthis.geometries.push( ( new InstanceGeometry() ).parse( child ) );\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'instance_light':\r\n\r\n\t\t\t\t\tthis.lights.push( ( new InstanceLight() ).parse( child ) );\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'instance_node':\r\n\r\n\t\t\t\t\turl = child.getAttribute( 'url' ).replace( /^#/, '' );\r\n\t\t\t\t\tvar iNode = getLibraryNode( url );\r\n\r\n\t\t\t\t\tif ( iNode ) {\r\n\r\n\t\t\t\t\t\tthis.nodes.push( ( new Node() ).parse( iNode )) ;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'rotate':\r\n\t\t\t\tcase 'translate':\r\n\t\t\t\tcase 'scale':\r\n\t\t\t\tcase 'matrix':\r\n\t\t\t\tcase 'lookat':\r\n\t\t\t\tcase 'skew':\r\n\r\n\t\t\t\t\tthis.transforms.push( ( new Transform() ).parse( child ) );\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'extra':\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tdefault:\r\n\r\n\t\t\t\t\tconsole.log( child.nodeName );\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tthis.channels = getChannelsForNode( this );\r\n\t\tbakeAnimations( this );\r\n\r\n\t\tthis.updateMatrix();\r\n\r\n\t\treturn this;\r\n\r\n\t};\r\n\r\n\tNode.prototype.updateMatrix = function () {\r\n\r\n\t\tthis.matrix.identity();\r\n\r\n\t\tfor ( var i = 0; i < this.transforms.length; i ++ ) {\r\n\r\n\t\t\tthis.transforms[ i ].apply( this.matrix );\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n\tfunction Transform () {\r\n\r\n\t\tthis.sid = \"\";\r\n\t\tthis.type = \"\";\r\n\t\tthis.data = [];\r\n\t\tthis.obj = null;\r\n\r\n\t}\r\n\r\n\tTransform.prototype.parse = function ( element ) {\r\n\r\n\t\tthis.sid = element.getAttribute( 'sid' );\r\n\t\tthis.type = element.nodeName;\r\n\t\tthis.data = _floats( element.textContent );\r\n\t\tthis.convert();\r\n\r\n\t\treturn this;\r\n\r\n\t};\r\n\r\n\tTransform.prototype.convert = function () {\r\n\r\n\t\tswitch ( this.type ) {\r\n\r\n\t\t\tcase 'matrix':\r\n\r\n\t\t\t\tthis.obj = getConvertedMat4( this.data );\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tcase 'rotate':\r\n\r\n\t\t\t\tthis.angle = THREE.Math.degToRad( this.data[3] );\r\n\r\n\t\t\tcase 'translate':\r\n\r\n\t\t\t\tfixCoords( this.data, -1 );\r\n\t\t\t\tthis.obj = new THREE.Vector3( this.data[ 0 ], this.data[ 1 ], this.data[ 2 ] );\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tcase 'scale':\r\n\r\n\t\t\t\tfixCoords( this.data, 1 );\r\n\t\t\t\tthis.obj = new THREE.Vector3( this.data[ 0 ], this.data[ 1 ], this.data[ 2 ] );\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tdefault:\r\n\t\t\t\tconsole.log( 'Can not convert Transform of type ' + this.type );\r\n\t\t\t\tbreak;\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n\tTransform.prototype.apply = function () {\r\n\r\n\t\tvar m1 = new THREE.Matrix4();\r\n\r\n\t\treturn function ( matrix ) {\r\n\r\n\t\t\tswitch ( this.type ) {\r\n\r\n\t\t\t\tcase 'matrix':\r\n\r\n\t\t\t\t\tmatrix.multiply( this.obj );\r\n\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'translate':\r\n\r\n\t\t\t\t\tmatrix.multiply( m1.makeTranslation( this.obj.x, this.obj.y, this.obj.z ) );\r\n\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'rotate':\r\n\r\n\t\t\t\t\tmatrix.multiply( m1.makeRotationAxis( this.obj, this.angle ) );\r\n\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'scale':\r\n\r\n\t\t\t\t\tmatrix.scale( this.obj );\r\n\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t}\r\n\r\n\t\t};\r\n\r\n\t}();\r\n\r\n\tTransform.prototype.update = function ( data, member ) {\r\n\r\n\t\tvar members = [ 'X', 'Y', 'Z', 'ANGLE' ];\r\n\r\n\t\tswitch ( this.type ) {\r\n\r\n\t\t\tcase 'matrix':\r\n\r\n\t\t\t\tif ( ! member ) {\r\n\r\n\t\t\t\t\tthis.obj.copy( data );\r\n\r\n\t\t\t\t} else if ( member.length === 1 ) {\r\n\r\n\t\t\t\t\tswitch ( member[ 0 ] ) {\r\n\r\n\t\t\t\t\t\tcase 0:\r\n\r\n\t\t\t\t\t\t\tthis.obj.n11 = data[ 0 ];\r\n\t\t\t\t\t\t\tthis.obj.n21 = data[ 1 ];\r\n\t\t\t\t\t\t\tthis.obj.n31 = data[ 2 ];\r\n\t\t\t\t\t\t\tthis.obj.n41 = data[ 3 ];\r\n\r\n\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\tcase 1:\r\n\r\n\t\t\t\t\t\t\tthis.obj.n12 = data[ 0 ];\r\n\t\t\t\t\t\t\tthis.obj.n22 = data[ 1 ];\r\n\t\t\t\t\t\t\tthis.obj.n32 = data[ 2 ];\r\n\t\t\t\t\t\t\tthis.obj.n42 = data[ 3 ];\r\n\r\n\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\tcase 2:\r\n\r\n\t\t\t\t\t\t\tthis.obj.n13 = data[ 0 ];\r\n\t\t\t\t\t\t\tthis.obj.n23 = data[ 1 ];\r\n\t\t\t\t\t\t\tthis.obj.n33 = data[ 2 ];\r\n\t\t\t\t\t\t\tthis.obj.n43 = data[ 3 ];\r\n\r\n\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\tcase 3:\r\n\r\n\t\t\t\t\t\t\tthis.obj.n14 = data[ 0 ];\r\n\t\t\t\t\t\t\tthis.obj.n24 = data[ 1 ];\r\n\t\t\t\t\t\t\tthis.obj.n34 = data[ 2 ];\r\n\t\t\t\t\t\t\tthis.obj.n44 = data[ 3 ];\r\n\r\n\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t} else if ( member.length === 2 ) {\r\n\r\n\t\t\t\t\tvar propName = 'n' + ( member[ 0 ] + 1 ) + ( member[ 1 ] + 1 );\r\n\t\t\t\t\tthis.obj[ propName ] = data;\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tconsole.log('Incorrect addressing of matrix in transform.');\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tcase 'translate':\r\n\t\t\tcase 'scale':\r\n\r\n\t\t\t\tif ( Object.prototype.toString.call( member ) === '[object Array]' ) {\r\n\r\n\t\t\t\t\tmember = members[ member[ 0 ] ];\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tswitch ( member ) {\r\n\r\n\t\t\t\t\tcase 'X':\r\n\r\n\t\t\t\t\t\tthis.obj.x = data;\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase 'Y':\r\n\r\n\t\t\t\t\t\tthis.obj.y = data;\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase 'Z':\r\n\r\n\t\t\t\t\t\tthis.obj.z = data;\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tdefault:\r\n\r\n\t\t\t\t\t\tthis.obj.x = data[ 0 ];\r\n\t\t\t\t\t\tthis.obj.y = data[ 1 ];\r\n\t\t\t\t\t\tthis.obj.z = data[ 2 ];\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tcase 'rotate':\r\n\r\n\t\t\t\tif ( Object.prototype.toString.call( member ) === '[object Array]' ) {\r\n\r\n\t\t\t\t\tmember = members[ member[ 0 ] ];\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tswitch ( member ) {\r\n\r\n\t\t\t\t\tcase 'X':\r\n\r\n\t\t\t\t\t\tthis.obj.x = data;\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase 'Y':\r\n\r\n\t\t\t\t\t\tthis.obj.y = data;\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase 'Z':\r\n\r\n\t\t\t\t\t\tthis.obj.z = data;\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase 'ANGLE':\r\n\r\n\t\t\t\t\t\tthis.angle = THREE.Math.degToRad( data );\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tdefault:\r\n\r\n\t\t\t\t\t\tthis.obj.x = data[ 0 ];\r\n\t\t\t\t\t\tthis.obj.y = data[ 1 ];\r\n\t\t\t\t\t\tthis.obj.z = data[ 2 ];\r\n\t\t\t\t\t\tthis.angle = THREE.Math.degToRad( data[ 3 ] );\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t}\r\n\t\t\t\tbreak;\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n\tfunction InstanceController() {\r\n\r\n\t\tthis.url = \"\";\r\n\t\tthis.skeleton = [];\r\n\t\tthis.instance_material = [];\r\n\r\n\t}\r\n\r\n\tInstanceController.prototype.parse = function ( element ) {\r\n\r\n\t\tthis.url = element.getAttribute('url').replace(/^#/, '');\r\n\t\tthis.skeleton = [];\r\n\t\tthis.instance_material = [];\r\n\r\n\t\tfor ( var i = 0; i < element.childNodes.length; i ++ ) {\r\n\r\n\t\t\tvar child = element.childNodes[ i ];\r\n\t\t\tif ( child.nodeType !== 1 ) continue;\r\n\r\n\t\t\tswitch ( child.nodeName ) {\r\n\r\n\t\t\t\tcase 'skeleton':\r\n\r\n\t\t\t\t\tthis.skeleton.push( child.textContent.replace(/^#/, '') );\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'bind_material':\r\n\r\n\t\t\t\t\tvar instances = child.querySelectorAll('instance_material');\r\n\r\n\t\t\t\t\tfor ( var j = 0; j < instances.length; j ++ ) {\r\n\r\n\t\t\t\t\t\tvar instance = instances[j];\r\n\t\t\t\t\t\tthis.instance_material.push( (new InstanceMaterial()).parse(instance) );\r\n\r\n\t\t\t\t\t}\r\n\r\n\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'extra':\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tdefault:\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\r\n\t};\r\n\r\n\tfunction InstanceMaterial () {\r\n\r\n\t\tthis.symbol = \"\";\r\n\t\tthis.target = \"\";\r\n\r\n\t}\r\n\r\n\tInstanceMaterial.prototype.parse = function ( element ) {\r\n\r\n\t\tthis.symbol = element.getAttribute('symbol');\r\n\t\tthis.target = element.getAttribute('target').replace(/^#/, '');\r\n\t\treturn this;\r\n\r\n\t};\r\n\r\n\tfunction InstanceGeometry() {\r\n\r\n\t\tthis.url = \"\";\r\n\t\tthis.instance_material = [];\r\n\r\n\t}\r\n\r\n\tInstanceGeometry.prototype.parse = function ( element ) {\r\n\r\n\t\tthis.url = element.getAttribute('url').replace(/^#/, '');\r\n\t\tthis.instance_material = [];\r\n\r\n\t\tfor ( var i = 0; i < element.childNodes.length; i ++ ) {\r\n\r\n\t\t\tvar child = element.childNodes[i];\r\n\t\t\tif ( child.nodeType != 1 ) continue;\r\n\r\n\t\t\tif ( child.nodeName === 'bind_material' ) {\r\n\r\n\t\t\t\tvar instances = child.querySelectorAll('instance_material');\r\n\r\n\t\t\t\tfor ( var j = 0; j < instances.length; j ++ ) {\r\n\r\n\t\t\t\t\tvar instance = instances[j];\r\n\t\t\t\t\tthis.instance_material.push( (new InstanceMaterial()).parse(instance) );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tbreak;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\r\n\t};\r\n\r\n\tfunction Geometry() {\r\n\r\n\t\tthis.id = \"\";\r\n\t\tthis.mesh = null;\r\n\r\n\t}\r\n\r\n\tGeometry.prototype.parse = function ( element ) {\r\n\r\n\t\tthis.id = element.getAttribute('id');\r\n\r\n\t\textractDoubleSided( this, element );\r\n\r\n\t\tfor ( var i = 0; i < element.childNodes.length; i ++ ) {\r\n\r\n\t\t\tvar child = element.childNodes[i];\r\n\r\n\t\t\tswitch ( child.nodeName ) {\r\n\r\n\t\t\t\tcase 'mesh':\r\n\r\n\t\t\t\t\tthis.mesh = (new Mesh(this)).parse(child);\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'extra':\r\n\r\n\t\t\t\t\t// console.log( child );\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tdefault:\r\n\t\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\r\n\t};\r\n\r\n\tfunction Mesh( geometry ) {\r\n\r\n\t\tthis.geometry = geometry.id;\r\n\t\tthis.primitives = [];\r\n\t\tthis.vertices = null;\r\n\t\tthis.geometry3js = null;\r\n\r\n\t}\r\n\r\n\tMesh.prototype.parse = function ( element ) {\r\n\r\n\t\tthis.primitives = [];\r\n\r\n\t\tfor ( var i = 0; i < element.childNodes.length; i ++ ) {\r\n\r\n\t\t\tvar child = element.childNodes[ i ];\r\n\r\n\t\t\tswitch ( child.nodeName ) {\r\n\r\n\t\t\t\tcase 'source':\r\n\r\n\t\t\t\t\t_source( child );\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'vertices':\r\n\r\n\t\t\t\t\tthis.vertices = ( new Vertices() ).parse( child );\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'linestrips':\r\n\r\n\t\t\t\t\tthis.primitives.push( ( new LineStrips().parse( child ) ) );\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'triangles':\r\n\r\n\t\t\t\t\tthis.primitives.push( ( new Triangles().parse( child ) ) );\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'polygons':\r\n\r\n\t\t\t\t\tthis.primitives.push( ( new Polygons().parse( child ) ) );\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'polylist':\r\n\r\n\t\t\t\t\tthis.primitives.push( ( new Polylist().parse( child ) ) );\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tdefault:\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tthis.geometry3js = new THREE.Geometry();\r\n\r\n\t\tif ( this.vertices === null ) {\r\n\r\n\t\t\t// TODO (mrdoob): Study case when this is null (carrier.dae)\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t}\r\n\r\n\t\tvar vertexData = sources[ this.vertices.input['POSITION'].source ].data;\r\n\r\n\t\tfor ( var i = 0; i < vertexData.length; i += 3 ) {\r\n\r\n\t\t\tthis.geometry3js.vertices.push( getConvertedVec3( vertexData, i ).clone() );\r\n\r\n\t\t}\r\n\r\n\t\tfor ( var i = 0; i < this.primitives.length; i ++ ) {\r\n\r\n\t\t\tvar primitive = this.primitives[ i ];\r\n\t\t\tprimitive.setVertices( this.vertices );\r\n\t\t\tthis.handlePrimitive( primitive, this.geometry3js );\r\n\r\n\t\t}\r\n\r\n\t\tif ( this.geometry3js.calcNormals ) {\r\n\r\n\t\t\tthis.geometry3js.computeVertexNormals();\r\n\t\t\tdelete this.geometry3js.calcNormals;\r\n\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\r\n\t};\r\n\r\n\tMesh.prototype.handlePrimitive = function ( primitive, geom ) {\r\n\r\n\t\tif ( primitive instanceof LineStrips ) {\r\n\r\n\t\t\t// TODO: Handle indices. Maybe easier with BufferGeometry?\r\n\r\n\t\t\tgeom.isLineStrip = true;\r\n\t\t\treturn;\r\n\r\n\t\t}\r\n\r\n\t\tvar j, k, pList = primitive.p, inputs = primitive.inputs;\r\n\t\tvar input, index, idx32;\r\n\t\tvar source, numParams;\r\n\t\tvar vcIndex = 0, vcount = 3, maxOffset = 0;\r\n\t\tvar texture_sets = [];\r\n\r\n\t\tfor ( j = 0; j < inputs.length; j ++ ) {\r\n\r\n\t\t\tinput = inputs[ j ];\r\n\r\n\t\t\tvar offset = input.offset + 1;\r\n\t\t\tmaxOffset = (maxOffset < offset) ? offset : maxOffset;\r\n\r\n\t\t\tswitch ( input.semantic ) {\r\n\r\n\t\t\t\tcase 'TEXCOORD':\r\n\t\t\t\t\ttexture_sets.push( input.set );\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tfor ( var pCount = 0; pCount < pList.length; ++ pCount ) {\r\n\r\n\t\t\tvar p = pList[ pCount ], i = 0;\r\n\r\n\t\t\twhile ( i < p.length ) {\r\n\r\n\t\t\t\tvar vs = [];\r\n\t\t\t\tvar ns = [];\r\n\t\t\t\tvar ts = null;\r\n\t\t\t\tvar cs = [];\r\n\r\n\t\t\t\tif ( primitive.vcount ) {\r\n\r\n\t\t\t\t\tvcount = primitive.vcount.length ? primitive.vcount[ vcIndex ++ ] : primitive.vcount;\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tvcount = p.length / maxOffset;\r\n\r\n\t\t\t\t}\r\n\r\n\r\n\t\t\t\tfor ( j = 0; j < vcount; j ++ ) {\r\n\r\n\t\t\t\t\tfor ( k = 0; k < inputs.length; k ++ ) {\r\n\r\n\t\t\t\t\t\tinput = inputs[ k ];\r\n\t\t\t\t\t\tsource = sources[ input.source ];\r\n\r\n\t\t\t\t\t\tindex = p[ i + ( j * maxOffset ) + input.offset ];\r\n\t\t\t\t\t\tnumParams = source.accessor.params.length;\r\n\t\t\t\t\t\tidx32 = index * numParams;\r\n\r\n\t\t\t\t\t\tswitch ( input.semantic ) {\r\n\r\n\t\t\t\t\t\t\tcase 'VERTEX':\r\n\r\n\t\t\t\t\t\t\t\tvs.push( index );\r\n\r\n\t\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\t\tcase 'NORMAL':\r\n\r\n\t\t\t\t\t\t\t\tns.push( getConvertedVec3( source.data, idx32 ) );\r\n\r\n\t\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\t\tcase 'TEXCOORD':\r\n\r\n\t\t\t\t\t\t\t\tts = ts || { };\r\n\t\t\t\t\t\t\t\tif ( ts[ input.set ] === undefined ) ts[ input.set ] = [];\r\n\t\t\t\t\t\t\t\t// invert the V\r\n\t\t\t\t\t\t\t\tts[ input.set ].push( new THREE.Vector2( source.data[ idx32 ], source.data[ idx32 + 1 ] ) );\r\n\r\n\t\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\t\tcase 'COLOR':\r\n\r\n\t\t\t\t\t\t\t\tcs.push( new THREE.Color().setRGB( source.data[ idx32 ], source.data[ idx32 + 1 ], source.data[ idx32 + 2 ] ) );\r\n\r\n\t\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\t\tdefault:\r\n\r\n\t\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( ns.length === 0 ) {\r\n\r\n\t\t\t\t\t// check the vertices inputs\r\n\t\t\t\t\tinput = this.vertices.input.NORMAL;\r\n\r\n\t\t\t\t\tif ( input ) {\r\n\r\n\t\t\t\t\t\tsource = sources[ input.source ];\r\n\t\t\t\t\t\tnumParams = source.accessor.params.length;\r\n\r\n\t\t\t\t\t\tfor ( var ndx = 0, len = vs.length; ndx < len; ndx ++ ) {\r\n\r\n\t\t\t\t\t\t\tns.push( getConvertedVec3( source.data, vs[ ndx ] * numParams ) );\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\tgeom.calcNormals = true;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( !ts ) {\r\n\r\n\t\t\t\t\tts = { };\r\n\t\t\t\t\t// check the vertices inputs\r\n\t\t\t\t\tinput = this.vertices.input.TEXCOORD;\r\n\r\n\t\t\t\t\tif ( input ) {\r\n\r\n\t\t\t\t\t\ttexture_sets.push( input.set );\r\n\t\t\t\t\t\tsource = sources[ input.source ];\r\n\t\t\t\t\t\tnumParams = source.accessor.params.length;\r\n\r\n\t\t\t\t\t\tfor ( var ndx = 0, len = vs.length; ndx < len; ndx ++ ) {\r\n\r\n\t\t\t\t\t\t\tidx32 = vs[ ndx ] * numParams;\r\n\t\t\t\t\t\t\tif ( ts[ input.set ] === undefined ) ts[ input.set ] = [ ];\r\n\t\t\t\t\t\t\t// invert the V\r\n\t\t\t\t\t\t\tts[ input.set ].push( new THREE.Vector2( source.data[ idx32 ], 1.0 - source.data[ idx32 + 1 ] ) );\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( cs.length === 0 ) {\r\n\r\n\t\t\t\t\t// check the vertices inputs\r\n\t\t\t\t\tinput = this.vertices.input.COLOR;\r\n\r\n\t\t\t\t\tif ( input ) {\r\n\r\n\t\t\t\t\t\tsource = sources[ input.source ];\r\n\t\t\t\t\t\tnumParams = source.accessor.params.length;\r\n\r\n\t\t\t\t\t\tfor ( var ndx = 0, len = vs.length; ndx < len; ndx ++ ) {\r\n\r\n\t\t\t\t\t\t\tidx32 = vs[ ndx ] * numParams;\r\n\t\t\t\t\t\t\tcs.push( new THREE.Color().setRGB( source.data[ idx32 ], source.data[ idx32 + 1 ], source.data[ idx32 + 2 ] ) );\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tvar face = null, faces = [], uv, uvArr;\r\n\r\n\t\t\t\tif ( vcount === 3 ) {\r\n\r\n\t\t\t\t\tfaces.push( new THREE.Face3( vs[0], vs[1], vs[2], ns, cs.length ? cs : new THREE.Color() ) );\r\n\r\n\t\t\t\t} else if ( vcount === 4 ) {\r\n\r\n\t\t\t\t\tfaces.push( new THREE.Face3( vs[0], vs[1], vs[3], ns.length ? [ ns[0].clone(), ns[1].clone(), ns[3].clone() ] : [], cs.length ? [ cs[0], cs[1], cs[3] ] : new THREE.Color() ) );\r\n\r\n\t\t\t\t\tfaces.push( new THREE.Face3( vs[1], vs[2], vs[3], ns.length ? [ ns[1].clone(), ns[2].clone(), ns[3].clone() ] : [], cs.length ? [ cs[1], cs[2], cs[3] ] : new THREE.Color() ) );\r\n\r\n\t\t\t\t} else if ( vcount > 4 && options.subdivideFaces ) {\r\n\r\n\t\t\t\t\tvar clr = cs.length ? cs : new THREE.Color(),\r\n\t\t\t\t\t\tvec1, vec2, vec3, v1, v2, norm;\r\n\r\n\t\t\t\t\t// subdivide into multiple Face3s\r\n\r\n\t\t\t\t\tfor ( k = 1; k < vcount - 1; ) {\r\n\r\n\t\t\t\t\t\tfaces.push( new THREE.Face3( vs[0], vs[k], vs[k + 1], ns.length ? [ ns[0].clone(), ns[k ++].clone(), ns[k].clone() ] : [], clr ) );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( faces.length ) {\r\n\r\n\t\t\t\t\tfor ( var ndx = 0, len = faces.length; ndx < len; ndx ++ ) {\r\n\r\n\t\t\t\t\t\tface = faces[ndx];\r\n\t\t\t\t\t\tface.daeMaterial = primitive.material;\r\n\t\t\t\t\t\tgeom.faces.push( face );\r\n\r\n\t\t\t\t\t\tfor ( k = 0; k < texture_sets.length; k ++ ) {\r\n\r\n\t\t\t\t\t\t\tuv = ts[ texture_sets[k] ];\r\n\r\n\t\t\t\t\t\t\tif ( vcount > 4 ) {\r\n\r\n\t\t\t\t\t\t\t\t// Grab the right UVs for the vertices in this face\r\n\t\t\t\t\t\t\t\tuvArr = [ uv[0], uv[ndx + 1], uv[ndx + 2] ];\r\n\r\n\t\t\t\t\t\t\t} else if ( vcount === 4 ) {\r\n\r\n\t\t\t\t\t\t\t\tif ( ndx === 0 ) {\r\n\r\n\t\t\t\t\t\t\t\t\tuvArr = [ uv[0], uv[1], uv[3] ];\r\n\r\n\t\t\t\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\t\t\t\tuvArr = [ uv[1].clone(), uv[2], uv[3].clone() ];\r\n\r\n\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\t\t\tuvArr = [ uv[0], uv[1], uv[2] ];\r\n\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\tif ( geom.faceVertexUvs[k] === undefined ) {\r\n\r\n\t\t\t\t\t\t\t\tgeom.faceVertexUvs[k] = [];\r\n\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\tgeom.faceVertexUvs[k].push( uvArr );\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tconsole.log( 'dropped face with vcount ' + vcount + ' for geometry with id: ' + geom.id );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\ti += maxOffset * vcount;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n\tfunction Polygons () {\r\n\r\n\t\tthis.material = \"\";\r\n\t\tthis.count = 0;\r\n\t\tthis.inputs = [];\r\n\t\tthis.vcount = null;\r\n\t\tthis.p = [];\r\n\t\tthis.geometry = new THREE.Geometry();\r\n\r\n\t}\r\n\r\n\tPolygons.prototype.setVertices = function ( vertices ) {\r\n\r\n\t\tfor ( var i = 0; i < this.inputs.length; i ++ ) {\r\n\r\n\t\t\tif ( this.inputs[ i ].source === vertices.id ) {\r\n\r\n\t\t\t\tthis.inputs[ i ].source = vertices.input[ 'POSITION' ].source;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n\tPolygons.prototype.parse = function ( element ) {\r\n\r\n\t\tthis.material = element.getAttribute( 'material' );\r\n\t\tthis.count = _attr_as_int( element, 'count', 0 );\r\n\r\n\t\tfor ( var i = 0; i < element.childNodes.length; i ++ ) {\r\n\r\n\t\t\tvar child = element.childNodes[ i ];\r\n\r\n\t\t\tswitch ( child.nodeName ) {\r\n\r\n\t\t\t\tcase 'input':\r\n\r\n\t\t\t\t\tthis.inputs.push( ( new Input() ).parse( element.childNodes[ i ] ) );\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'vcount':\r\n\r\n\t\t\t\t\tthis.vcount = _ints( child.textContent );\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'p':\r\n\r\n\t\t\t\t\tthis.p.push( _ints( child.textContent ) );\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'ph':\r\n\r\n\t\t\t\t\tconsole.warn( 'polygon holes not yet supported!' );\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tdefault:\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\r\n\t};\r\n\r\n\tfunction Polylist () {\r\n\r\n\t\tPolygons.call( this );\r\n\r\n\t\tthis.vcount = [];\r\n\r\n\t}\r\n\r\n\tPolylist.prototype = Object.create( Polygons.prototype );\r\n\tPolylist.prototype.constructor = Polylist;\r\n\r\n\tfunction LineStrips() {\r\n\r\n\t\tPolygons.call( this );\r\n\r\n\t\tthis.vcount = 1;\r\n\r\n\t}\r\n\r\n\tLineStrips.prototype = Object.create( Polygons.prototype );\r\n\tLineStrips.prototype.constructor = LineStrips;\r\n\r\n\tfunction Triangles () {\r\n\r\n\t\tPolygons.call( this );\r\n\r\n\t\tthis.vcount = 3;\r\n\r\n\t}\r\n\r\n\tTriangles.prototype = Object.create( Polygons.prototype );\r\n\tTriangles.prototype.constructor = Triangles;\r\n\r\n\tfunction Accessor() {\r\n\r\n\t\tthis.source = \"\";\r\n\t\tthis.count = 0;\r\n\t\tthis.stride = 0;\r\n\t\tthis.params = [];\r\n\r\n\t}\r\n\r\n\tAccessor.prototype.parse = function ( element ) {\r\n\r\n\t\tthis.params = [];\r\n\t\tthis.source = element.getAttribute( 'source' );\r\n\t\tthis.count = _attr_as_int( element, 'count', 0 );\r\n\t\tthis.stride = _attr_as_int( element, 'stride', 0 );\r\n\r\n\t\tfor ( var i = 0; i < element.childNodes.length; i ++ ) {\r\n\r\n\t\t\tvar child = element.childNodes[ i ];\r\n\r\n\t\t\tif ( child.nodeName === 'param' ) {\r\n\r\n\t\t\t\tvar param = {};\r\n\t\t\t\tparam[ 'name' ] = child.getAttribute( 'name' );\r\n\t\t\t\tparam[ 'type' ] = child.getAttribute( 'type' );\r\n\t\t\t\tthis.params.push( param );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\r\n\t};\r\n\r\n\tfunction Vertices() {\r\n\r\n\t\tthis.input = {};\r\n\r\n\t}\r\n\r\n\tVertices.prototype.parse = function ( element ) {\r\n\r\n\t\tthis.id = element.getAttribute('id');\r\n\r\n\t\tfor ( var i = 0; i < element.childNodes.length; i ++ ) {\r\n\r\n\t\t\tif ( element.childNodes[i].nodeName === 'input' ) {\r\n\r\n\t\t\t\tvar input = ( new Input() ).parse( element.childNodes[ i ] );\r\n\t\t\t\tthis.input[ input.semantic ] = input;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\r\n\t};\r\n\r\n\tfunction Input () {\r\n\r\n\t\tthis.semantic = \"\";\r\n\t\tthis.offset = 0;\r\n\t\tthis.source = \"\";\r\n\t\tthis.set = 0;\r\n\r\n\t}\r\n\r\n\tInput.prototype.parse = function ( element ) {\r\n\r\n\t\tthis.semantic = element.getAttribute('semantic');\r\n\t\tthis.source = element.getAttribute('source').replace(/^#/, '');\r\n\t\tthis.set = _attr_as_int(element, 'set', -1);\r\n\t\tthis.offset = _attr_as_int(element, 'offset', 0);\r\n\r\n\t\tif ( this.semantic === 'TEXCOORD' && this.set < 0 ) {\r\n\r\n\t\t\tthis.set = 0;\r\n\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\r\n\t};\r\n\r\n\tfunction Source ( id ) {\r\n\r\n\t\tthis.id = id;\r\n\t\tthis.type = null;\r\n\r\n\t}\r\n\r\n\tSource.prototype.parse = function ( element ) {\r\n\r\n\t\tthis.id = element.getAttribute( 'id' );\r\n\r\n\t\tfor ( var i = 0; i < element.childNodes.length; i ++ ) {\r\n\r\n\t\t\tvar child = element.childNodes[i];\r\n\r\n\t\t\tswitch ( child.nodeName ) {\r\n\r\n\t\t\t\tcase 'bool_array':\r\n\r\n\t\t\t\t\tthis.data = _bools( child.textContent );\r\n\t\t\t\t\tthis.type = child.nodeName;\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'float_array':\r\n\r\n\t\t\t\t\tthis.data = _floats( child.textContent );\r\n\t\t\t\t\tthis.type = child.nodeName;\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'int_array':\r\n\r\n\t\t\t\t\tthis.data = _ints( child.textContent );\r\n\t\t\t\t\tthis.type = child.nodeName;\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'IDREF_array':\r\n\t\t\t\tcase 'Name_array':\r\n\r\n\t\t\t\t\tthis.data = _strings( child.textContent );\r\n\t\t\t\t\tthis.type = child.nodeName;\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'technique_common':\r\n\r\n\t\t\t\t\tfor ( var j = 0; j < child.childNodes.length; j ++ ) {\r\n\r\n\t\t\t\t\t\tif ( child.childNodes[ j ].nodeName === 'accessor' ) {\r\n\r\n\t\t\t\t\t\t\tthis.accessor = ( new Accessor() ).parse( child.childNodes[ j ] );\r\n\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tdefault:\r\n\t\t\t\t\t// console.log(child.nodeName);\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\r\n\t};\r\n\r\n\tSource.prototype.read = function () {\r\n\r\n\t\tvar result = [];\r\n\r\n\t\t//for (var i = 0; i < this.accessor.params.length; i++) {\r\n\r\n\t\tvar param = this.accessor.params[ 0 ];\r\n\r\n\t\t\t//console.log(param.name + \" \" + param.type);\r\n\r\n\t\tswitch ( param.type ) {\r\n\r\n\t\t\tcase 'IDREF':\r\n\t\t\tcase 'Name': case 'name':\r\n\t\t\tcase 'float':\r\n\r\n\t\t\t\treturn this.data;\r\n\r\n\t\t\tcase 'float4x4':\r\n\r\n\t\t\t\tfor ( var j = 0; j < this.data.length; j += 16 ) {\r\n\r\n\t\t\t\t\tvar s = this.data.slice( j, j + 16 );\r\n\t\t\t\t\tvar m = getConvertedMat4( s );\r\n\t\t\t\t\tresult.push( m );\r\n\t\t\t\t}\r\n\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tdefault:\r\n\r\n\t\t\t\tconsole.log( 'ColladaLoader: Source: Read dont know how to read ' + param.type + '.' );\r\n\t\t\t\tbreak;\r\n\r\n\t\t}\r\n\r\n\t\t//}\r\n\r\n\t\treturn result;\r\n\r\n\t};\r\n\r\n\tfunction Material () {\r\n\r\n\t\tthis.id = \"\";\r\n\t\tthis.name = \"\";\r\n\t\tthis.instance_effect = null;\r\n\r\n\t}\r\n\r\n\tMaterial.prototype.parse = function ( element ) {\r\n\r\n\t\tthis.id = element.getAttribute( 'id' );\r\n\t\tthis.name = element.getAttribute( 'name' );\r\n\r\n\t\tfor ( var i = 0; i < element.childNodes.length; i ++ ) {\r\n\r\n\t\t\tif ( element.childNodes[ i ].nodeName === 'instance_effect' ) {\r\n\r\n\t\t\t\tthis.instance_effect = ( new InstanceEffect() ).parse( element.childNodes[ i ] );\r\n\t\t\t\tbreak;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\r\n\t};\r\n\r\n\tfunction ColorOrTexture () {\r\n\r\n\t\tthis.color = new THREE.Color();\r\n\t\tthis.color.setRGB( Math.random(), Math.random(), Math.random() );\r\n\t\tthis.color.a = 1.0;\r\n\r\n\t\tthis.texture = null;\r\n\t\tthis.texcoord = null;\r\n\t\tthis.texOpts = null;\r\n\r\n\t}\r\n\r\n\tColorOrTexture.prototype.isColor = function () {\r\n\r\n\t\treturn ( this.texture === null );\r\n\r\n\t};\r\n\r\n\tColorOrTexture.prototype.isTexture = function () {\r\n\r\n\t\treturn ( this.texture != null );\r\n\r\n\t};\r\n\r\n\tColorOrTexture.prototype.parse = function ( element ) {\r\n\r\n\t\tif (element.nodeName === 'transparent') {\r\n\r\n\t\t\tthis.opaque = element.getAttribute('opaque');\r\n\r\n\t\t}\r\n\r\n\t\tfor ( var i = 0; i < element.childNodes.length; i ++ ) {\r\n\r\n\t\t\tvar child = element.childNodes[ i ];\r\n\t\t\tif ( child.nodeType != 1 ) continue;\r\n\r\n\t\t\tswitch ( child.nodeName ) {\r\n\r\n\t\t\t\tcase 'color':\r\n\r\n\t\t\t\t\tvar rgba = _floats( child.textContent );\r\n\t\t\t\t\tthis.color = new THREE.Color();\r\n\t\t\t\t\tthis.color.setRGB( rgba[0], rgba[1], rgba[2] );\r\n\t\t\t\t\tthis.color.a = rgba[3];\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'texture':\r\n\r\n\t\t\t\t\tthis.texture = child.getAttribute('texture');\r\n\t\t\t\t\tthis.texcoord = child.getAttribute('texcoord');\r\n\t\t\t\t\t// Defaults from:\r\n\t\t\t\t\t// https://collada.org/mediawiki/index.php/Maya_texture_placement_MAYA_extension\r\n\t\t\t\t\tthis.texOpts = {\r\n\t\t\t\t\t\toffsetU: 0,\r\n\t\t\t\t\t\toffsetV: 0,\r\n\t\t\t\t\t\trepeatU: 1,\r\n\t\t\t\t\t\trepeatV: 1,\r\n\t\t\t\t\t\twrapU: 1,\r\n\t\t\t\t\t\twrapV: 1\r\n\t\t\t\t\t};\r\n\t\t\t\t\tthis.parseTexture( child );\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tdefault:\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\r\n\t};\r\n\r\n\tColorOrTexture.prototype.parseTexture = function ( element ) {\r\n\r\n\t\tif ( ! element.childNodes ) return this;\r\n\r\n\t\t// This should be supported by Maya, 3dsMax, and MotionBuilder\r\n\r\n\t\tif ( element.childNodes[1] && element.childNodes[1].nodeName === 'extra' ) {\r\n\r\n\t\t\telement = element.childNodes[1];\r\n\r\n\t\t\tif ( element.childNodes[1] && element.childNodes[1].nodeName === 'technique' ) {\r\n\r\n\t\t\t\telement = element.childNodes[1];\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tfor ( var i = 0; i < element.childNodes.length; i ++ ) {\r\n\r\n\t\t\tvar child = element.childNodes[ i ];\r\n\r\n\t\t\tswitch ( child.nodeName ) {\r\n\r\n\t\t\t\tcase 'offsetU':\r\n\t\t\t\tcase 'offsetV':\r\n\t\t\t\tcase 'repeatU':\r\n\t\t\t\tcase 'repeatV':\r\n\r\n\t\t\t\t\tthis.texOpts[ child.nodeName ] = parseFloat( child.textContent );\r\n\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'wrapU':\r\n\t\t\t\tcase 'wrapV':\r\n\r\n\t\t\t\t\t// some dae have a value of true which becomes NaN via parseInt\r\n\r\n\t\t\t\t\tif ( child.textContent.toUpperCase() === 'TRUE' ) {\r\n\r\n\t\t\t\t\t\tthis.texOpts[ child.nodeName ] = 1;\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\tthis.texOpts[ child.nodeName ] = parseInt( child.textContent );\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tdefault:\r\n\r\n\t\t\t\t\tthis.texOpts[ child.nodeName ] = child.textContent;\r\n\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\r\n\t};\r\n\r\n\tfunction Shader ( type, effect ) {\r\n\r\n\t\tthis.type = type;\r\n\t\tthis.effect = effect;\r\n\t\tthis.material = null;\r\n\r\n\t}\r\n\r\n\tShader.prototype.parse = function ( element ) {\r\n\r\n\t\tfor ( var i = 0; i < element.childNodes.length; i ++ ) {\r\n\r\n\t\t\tvar child = element.childNodes[ i ];\r\n\t\t\tif ( child.nodeType != 1 ) continue;\r\n\r\n\t\t\tswitch ( child.nodeName ) {\r\n\r\n\t\t\t\tcase 'emission':\r\n\t\t\t\tcase 'diffuse':\r\n\t\t\t\tcase 'specular':\r\n\t\t\t\tcase 'transparent':\r\n\r\n\t\t\t\t\tthis[ child.nodeName ] = ( new ColorOrTexture() ).parse( child );\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'bump':\r\n\r\n\t\t\t\t\t// If 'bumptype' is 'heightfield', create a 'bump' property\r\n\t\t\t\t\t// Else if 'bumptype' is 'normalmap', create a 'normal' property\r\n\t\t\t\t\t// (Default to 'bump')\r\n\t\t\t\t\tvar bumpType = child.getAttribute( 'bumptype' );\r\n\t\t\t\t\tif ( bumpType ) {\r\n\t\t\t\t\t\tif ( bumpType.toLowerCase() === \"heightfield\" ) {\r\n\t\t\t\t\t\t\tthis[ 'bump' ] = ( new ColorOrTexture() ).parse( child );\r\n\t\t\t\t\t\t} else if ( bumpType.toLowerCase() === \"normalmap\" ) {\r\n\t\t\t\t\t\t\tthis[ 'normal' ] = ( new ColorOrTexture() ).parse( child );\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tconsole.error( \"Shader.prototype.parse: Invalid value for attribute 'bumptype' (\" + bumpType + \") - valid bumptypes are 'HEIGHTFIELD' and 'NORMALMAP' - defaulting to 'HEIGHTFIELD'\" );\r\n\t\t\t\t\t\t\tthis[ 'bump' ] = ( new ColorOrTexture() ).parse( child );\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tconsole.warn( \"Shader.prototype.parse: Attribute 'bumptype' missing from bump node - defaulting to 'HEIGHTFIELD'\" );\r\n\t\t\t\t\t\tthis[ 'bump' ] = ( new ColorOrTexture() ).parse( child );\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'shininess':\r\n\t\t\t\tcase 'reflectivity':\r\n\t\t\t\tcase 'index_of_refraction':\r\n\t\t\t\tcase 'transparency':\r\n\r\n\t\t\t\t\tvar f = child.querySelectorAll('float');\r\n\r\n\t\t\t\t\tif ( f.length > 0 )\r\n\t\t\t\t\t\tthis[ child.nodeName ] = parseFloat( f[ 0 ].textContent );\r\n\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tdefault:\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tthis.create();\r\n\t\treturn this;\r\n\r\n\t};\r\n\r\n\tShader.prototype.create = function() {\r\n\r\n\t\tvar props = {};\r\n\r\n\t\tvar transparent = false;\r\n\r\n\t\tif (this['transparency'] !== undefined && this['transparent'] !== undefined) {\r\n\t\t\t// convert transparent color RBG to average value\r\n\t\t\tvar transparentColor = this['transparent'];\r\n\t\t\tvar transparencyLevel = (this.transparent.color.r + this.transparent.color.g + this.transparent.color.b) / 3 * this.transparency;\r\n\r\n\t\t\tif (transparencyLevel > 0) {\r\n\t\t\t\ttransparent = true;\r\n\t\t\t\tprops[ 'transparent' ] = true;\r\n\t\t\t\tprops[ 'opacity' ] = 1 - transparencyLevel;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tvar keys = {\r\n\t\t\t'diffuse':'map',\r\n\t\t\t'ambient':'lightMap',\r\n\t\t\t'specular':'specularMap',\r\n\t\t\t'emission':'emissionMap',\r\n\t\t\t'bump':'bumpMap',\r\n\t\t\t'normal':'normalMap'\r\n\t\t\t};\r\n\r\n\t\tfor ( var prop in this ) {\r\n\r\n\t\t\tswitch ( prop ) {\r\n\r\n\t\t\t\tcase 'ambient':\r\n\t\t\t\tcase 'emission':\r\n\t\t\t\tcase 'diffuse':\r\n\t\t\t\tcase 'specular':\r\n\t\t\t\tcase 'bump':\r\n\t\t\t\tcase 'normal':\r\n\r\n\t\t\t\t\tvar cot = this[ prop ];\r\n\r\n\t\t\t\t\tif ( cot instanceof ColorOrTexture ) {\r\n\r\n\t\t\t\t\t\tif ( cot.isTexture() ) {\r\n\r\n\t\t\t\t\t\t\tvar samplerId = cot.texture;\r\n\t\t\t\t\t\t\tvar surfaceId = this.effect.sampler[samplerId];\r\n\r\n\t\t\t\t\t\t\tif ( surfaceId !== undefined && surfaceId.source !== undefined ) {\r\n\r\n\t\t\t\t\t\t\t\tvar surface = this.effect.surface[surfaceId.source];\r\n\r\n\t\t\t\t\t\t\t\tif ( surface !== undefined ) {\r\n\r\n\t\t\t\t\t\t\t\t\tvar image = images[ surface.init_from ];\r\n\r\n\t\t\t\t\t\t\t\t\tif ( image ) {\r\n\r\n\t\t\t\t\t\t\t\t\t\tvar url = baseUrl + image.init_from;\r\n\r\n\t\t\t\t\t\t\t\t\t\tvar texture;\r\n\t\t\t\t\t\t\t\t\t\tvar loader = THREE.Loader.Handlers.get( url );\r\n\r\n\t\t\t\t\t\t\t\t\t\tif ( loader !== null ) {\r\n\r\n\t\t\t\t\t\t\t\t\t\t\ttexture = loader.load( url );\r\n\r\n\t\t\t\t\t\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\t\t\t\t\t\ttexture = new THREE.Texture();\r\n\r\n\t\t\t\t\t\t\t\t\t\t\tloadTextureImage( texture, url );\r\n\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t\t\ttexture.wrapS = cot.texOpts.wrapU ? THREE.RepeatWrapping : THREE.ClampToEdgeWrapping;\r\n\t\t\t\t\t\t\t\t\t\ttexture.wrapT = cot.texOpts.wrapV ? THREE.RepeatWrapping : THREE.ClampToEdgeWrapping;\r\n\t\t\t\t\t\t\t\t\t\ttexture.offset.x = cot.texOpts.offsetU;\r\n\t\t\t\t\t\t\t\t\t\ttexture.offset.y = cot.texOpts.offsetV;\r\n\t\t\t\t\t\t\t\t\t\ttexture.repeat.x = cot.texOpts.repeatU;\r\n\t\t\t\t\t\t\t\t\t\ttexture.repeat.y = cot.texOpts.repeatV;\r\n\t\t\t\t\t\t\t\t\t\tprops[keys[prop]] = texture;\r\n\r\n\t\t\t\t\t\t\t\t\t\t// Texture with baked lighting?\r\n\t\t\t\t\t\t\t\t\t\tif (prop === 'emission') props['emissive'] = 0xffffff;\r\n\r\n\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t} else if ( prop === 'diffuse' || !transparent ) {\r\n\r\n\t\t\t\t\t\t\tif ( prop === 'emission' ) {\r\n\r\n\t\t\t\t\t\t\t\tprops[ 'emissive' ] = cot.color.getHex();\r\n\r\n\t\t\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\t\t\tprops[ prop ] = cot.color.getHex();\r\n\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'shininess':\r\n\r\n\t\t\t\t\tprops[ prop ] = this[ prop ];\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'reflectivity':\r\n\r\n\t\t\t\t\tprops[ prop ] = this[ prop ];\r\n\t\t\t\t\tif ( props[ prop ] > 0.0 ) props['envMap'] = options.defaultEnvMap;\r\n\t\t\t\t\tprops['combine'] = THREE.MixOperation;\t//mix regular shading with reflective component\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'index_of_refraction':\r\n\r\n\t\t\t\t\tprops[ 'refractionRatio' ] = this[ prop ]; //TODO: \"index_of_refraction\" becomes \"refractionRatio\" in shader, but I'm not sure if the two are actually comparable\r\n\t\t\t\t\tif ( this[ prop ] !== 1.0 ) props['envMap'] = options.defaultEnvMap;\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'transparency':\r\n\t\t\t\t\t// gets figured out up top\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tdefault:\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tprops[ 'shading' ] = preferredShading;\r\n\t\tprops[ 'side' ] = this.effect.doubleSided ? THREE.DoubleSide : THREE.FrontSide;\r\n\r\n\t\tif ( props.diffuse !== undefined ) {\r\n\r\n\t\t\tprops.color = props.diffuse;\r\n\t\t\tdelete props.diffuse;\r\n\r\n\t\t}\r\n\r\n\t\tswitch ( this.type ) {\r\n\r\n\t\t\tcase 'constant':\r\n\r\n\t\t\t\tif (props.emissive != undefined) props.color = props.emissive;\r\n\t\t\t\tthis.material = new THREE.MeshBasicMaterial( props );\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tcase 'phong':\r\n\t\t\tcase 'blinn':\r\n\r\n\t\t\t\tthis.material = new THREE.MeshPhongMaterial( props );\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tcase 'lambert':\r\n\t\t\tdefault:\r\n\r\n\t\t\t\tthis.material = new THREE.MeshLambertMaterial( props );\r\n\t\t\t\tbreak;\r\n\r\n\t\t}\r\n\r\n\t\treturn this.material;\r\n\r\n\t};\r\n\r\n\tfunction Surface ( effect ) {\r\n\r\n\t\tthis.effect = effect;\r\n\t\tthis.init_from = null;\r\n\t\tthis.format = null;\r\n\r\n\t}\r\n\r\n\tSurface.prototype.parse = function ( element ) {\r\n\r\n\t\tfor ( var i = 0; i < element.childNodes.length; i ++ ) {\r\n\r\n\t\t\tvar child = element.childNodes[ i ];\r\n\t\t\tif ( child.nodeType != 1 ) continue;\r\n\r\n\t\t\tswitch ( child.nodeName ) {\r\n\r\n\t\t\t\tcase 'init_from':\r\n\r\n\t\t\t\t\tthis.init_from = child.textContent;\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'format':\r\n\r\n\t\t\t\t\tthis.format = child.textContent;\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tdefault:\r\n\r\n\t\t\t\t\tconsole.log( \"unhandled Surface prop: \" + child.nodeName );\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\r\n\t};\r\n\r\n\tfunction Sampler2D ( effect ) {\r\n\r\n\t\tthis.effect = effect;\r\n\t\tthis.source = null;\r\n\t\tthis.wrap_s = null;\r\n\t\tthis.wrap_t = null;\r\n\t\tthis.minfilter = null;\r\n\t\tthis.magfilter = null;\r\n\t\tthis.mipfilter = null;\r\n\r\n\t}\r\n\r\n\tSampler2D.prototype.parse = function ( element ) {\r\n\r\n\t\tfor ( var i = 0; i < element.childNodes.length; i ++ ) {\r\n\r\n\t\t\tvar child = element.childNodes[ i ];\r\n\t\t\tif ( child.nodeType != 1 ) continue;\r\n\r\n\t\t\tswitch ( child.nodeName ) {\r\n\r\n\t\t\t\tcase 'source':\r\n\r\n\t\t\t\t\tthis.source = child.textContent;\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'minfilter':\r\n\r\n\t\t\t\t\tthis.minfilter = child.textContent;\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'magfilter':\r\n\r\n\t\t\t\t\tthis.magfilter = child.textContent;\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'mipfilter':\r\n\r\n\t\t\t\t\tthis.mipfilter = child.textContent;\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'wrap_s':\r\n\r\n\t\t\t\t\tthis.wrap_s = child.textContent;\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'wrap_t':\r\n\r\n\t\t\t\t\tthis.wrap_t = child.textContent;\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tdefault:\r\n\r\n\t\t\t\t\tconsole.log( \"unhandled Sampler2D prop: \" + child.nodeName );\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\r\n\t};\r\n\r\n\tfunction Effect () {\r\n\r\n\t\tthis.id = \"\";\r\n\t\tthis.name = \"\";\r\n\t\tthis.shader = null;\r\n\t\tthis.surface = {};\r\n\t\tthis.sampler = {};\r\n\r\n\t}\r\n\r\n\tEffect.prototype.create = function () {\r\n\r\n\t\tif ( this.shader === null ) {\r\n\r\n\t\t\treturn null;\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n\tEffect.prototype.parse = function ( element ) {\r\n\r\n\t\tthis.id = element.getAttribute( 'id' );\r\n\t\tthis.name = element.getAttribute( 'name' );\r\n\r\n\t\textractDoubleSided( this, element );\r\n\r\n\t\tthis.shader = null;\r\n\r\n\t\tfor ( var i = 0; i < element.childNodes.length; i ++ ) {\r\n\r\n\t\t\tvar child = element.childNodes[ i ];\r\n\t\t\tif ( child.nodeType != 1 ) continue;\r\n\r\n\t\t\tswitch ( child.nodeName ) {\r\n\r\n\t\t\t\tcase 'profile_COMMON':\r\n\r\n\t\t\t\t\tthis.parseTechnique( this.parseProfileCOMMON( child ) );\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tdefault:\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\r\n\t};\r\n\r\n\tEffect.prototype.parseNewparam = function ( element ) {\r\n\r\n\t\tvar sid = element.getAttribute( 'sid' );\r\n\r\n\t\tfor ( var i = 0; i < element.childNodes.length; i ++ ) {\r\n\r\n\t\t\tvar child = element.childNodes[ i ];\r\n\t\t\tif ( child.nodeType != 1 ) continue;\r\n\r\n\t\t\tswitch ( child.nodeName ) {\r\n\r\n\t\t\t\tcase 'surface':\r\n\r\n\t\t\t\t\tthis.surface[sid] = ( new Surface( this ) ).parse( child );\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'sampler2D':\r\n\r\n\t\t\t\t\tthis.sampler[sid] = ( new Sampler2D( this ) ).parse( child );\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'extra':\r\n\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tdefault:\r\n\r\n\t\t\t\t\tconsole.log( child.nodeName );\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n\tEffect.prototype.parseProfileCOMMON = function ( element ) {\r\n\r\n\t\tvar technique;\r\n\r\n\t\tfor ( var i = 0; i < element.childNodes.length; i ++ ) {\r\n\r\n\t\t\tvar child = element.childNodes[ i ];\r\n\r\n\t\t\tif ( child.nodeType != 1 ) continue;\r\n\r\n\t\t\tswitch ( child.nodeName ) {\r\n\r\n\t\t\t\tcase 'profile_COMMON':\r\n\r\n\t\t\t\t\tthis.parseProfileCOMMON( child );\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'technique':\r\n\r\n\t\t\t\t\ttechnique = child;\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'newparam':\r\n\r\n\t\t\t\t\tthis.parseNewparam( child );\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'image':\r\n\r\n\t\t\t\t\tvar _image = ( new _Image() ).parse( child );\r\n\t\t\t\t\timages[ _image.id ] = _image;\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'extra':\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tdefault:\r\n\r\n\t\t\t\t\tconsole.log( child.nodeName );\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\treturn technique;\r\n\r\n\t};\r\n\r\n\tEffect.prototype.parseTechnique = function ( element ) {\r\n\r\n\t\tfor ( var i = 0; i < element.childNodes.length; i ++ ) {\r\n\r\n\t\t\tvar child = element.childNodes[i];\r\n\t\t\tif ( child.nodeType != 1 ) continue;\r\n\r\n\t\t\tswitch ( child.nodeName ) {\r\n\r\n\t\t\t\tcase 'constant':\r\n\t\t\t\tcase 'lambert':\r\n\t\t\t\tcase 'blinn':\r\n\t\t\t\tcase 'phong':\r\n\r\n\t\t\t\t\tthis.shader = ( new Shader( child.nodeName, this ) ).parse( child );\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'extra':\r\n\t\t\t\t\tthis.parseExtra(child);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tdefault:\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n\tEffect.prototype.parseExtra = function ( element ) {\r\n\r\n\t\tfor ( var i = 0; i < element.childNodes.length; i ++ ) {\r\n\r\n\t\t\tvar child = element.childNodes[i];\r\n\t\t\tif ( child.nodeType != 1 ) continue;\r\n\r\n\t\t\tswitch ( child.nodeName ) {\r\n\r\n\t\t\t\tcase 'technique':\r\n\t\t\t\t\tthis.parseExtraTechnique( child );\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tdefault:\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n\tEffect.prototype.parseExtraTechnique = function ( element ) {\r\n\r\n\t\tfor ( var i = 0; i < element.childNodes.length; i ++ ) {\r\n\r\n\t\t\tvar child = element.childNodes[i];\r\n\t\t\tif ( child.nodeType != 1 ) continue;\r\n\r\n\t\t\tswitch ( child.nodeName ) {\r\n\r\n\t\t\t\tcase 'bump':\r\n\t\t\t\t\tthis.shader.parse( element );\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tdefault:\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n\tfunction InstanceEffect () {\r\n\r\n\t\tthis.url = \"\";\r\n\r\n\t}\r\n\r\n\tInstanceEffect.prototype.parse = function ( element ) {\r\n\r\n\t\tthis.url = element.getAttribute( 'url' ).replace( /^#/, '' );\r\n\t\treturn this;\r\n\r\n\t};\r\n\r\n\tfunction Animation() {\r\n\r\n\t\tthis.id = \"\";\r\n\t\tthis.name = \"\";\r\n\t\tthis.source = {};\r\n\t\tthis.sampler = [];\r\n\t\tthis.channel = [];\r\n\r\n\t}\r\n\r\n\tAnimation.prototype.parse = function ( element ) {\r\n\r\n\t\tthis.id = element.getAttribute( 'id' );\r\n\t\tthis.name = element.getAttribute( 'name' );\r\n\t\tthis.source = {};\r\n\r\n\t\tfor ( var i = 0; i < element.childNodes.length; i ++ ) {\r\n\r\n\t\t\tvar child = element.childNodes[ i ];\r\n\r\n\t\t\tif ( child.nodeType != 1 ) continue;\r\n\r\n\t\t\tswitch ( child.nodeName ) {\r\n\r\n\t\t\t\tcase 'animation':\r\n\r\n\t\t\t\t\tvar anim = ( new Animation() ).parse( child );\r\n\r\n\t\t\t\t\tfor ( var src in anim.source ) {\r\n\r\n\t\t\t\t\t\tthis.source[ src ] = anim.source[ src ];\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tfor ( var j = 0; j < anim.channel.length; j ++ ) {\r\n\r\n\t\t\t\t\t\tthis.channel.push( anim.channel[ j ] );\r\n\t\t\t\t\t\tthis.sampler.push( anim.sampler[ j ] );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'source':\r\n\r\n\t\t\t\t\tvar src = ( new Source() ).parse( child );\r\n\t\t\t\t\tthis.source[ src.id ] = src;\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'sampler':\r\n\r\n\t\t\t\t\tthis.sampler.push( ( new Sampler( this ) ).parse( child ) );\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'channel':\r\n\r\n\t\t\t\t\tthis.channel.push( ( new Channel( this ) ).parse( child ) );\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tdefault:\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\r\n\t};\r\n\r\n\tfunction Channel( animation ) {\r\n\r\n\t\tthis.animation = animation;\r\n\t\tthis.source = \"\";\r\n\t\tthis.target = \"\";\r\n\t\tthis.fullSid = null;\r\n\t\tthis.sid = null;\r\n\t\tthis.dotSyntax = null;\r\n\t\tthis.arrSyntax = null;\r\n\t\tthis.arrIndices = null;\r\n\t\tthis.member = null;\r\n\r\n\t}\r\n\r\n\tChannel.prototype.parse = function ( element ) {\r\n\r\n\t\tthis.source = element.getAttribute( 'source' ).replace( /^#/, '' );\r\n\t\tthis.target = element.getAttribute( 'target' );\r\n\r\n\t\tvar parts = this.target.split( '/' );\r\n\r\n\t\tvar id = parts.shift();\r\n\t\tvar sid = parts.shift();\r\n\r\n\t\tvar dotSyntax = ( sid.indexOf(\".\") >= 0 );\r\n\t\tvar arrSyntax = ( sid.indexOf(\"(\") >= 0 );\r\n\r\n\t\tif ( dotSyntax ) {\r\n\r\n\t\t\tparts = sid.split(\".\");\r\n\t\t\tthis.sid = parts.shift();\r\n\t\t\tthis.member = parts.shift();\r\n\r\n\t\t} else if ( arrSyntax ) {\r\n\r\n\t\t\tvar arrIndices = sid.split(\"(\");\r\n\t\t\tthis.sid = arrIndices.shift();\r\n\r\n\t\t\tfor (var j = 0; j < arrIndices.length; j ++ ) {\r\n\r\n\t\t\t\tarrIndices[j] = parseInt( arrIndices[j].replace(/\\)/, '') );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tthis.arrIndices = arrIndices;\r\n\r\n\t\t} else {\r\n\r\n\t\t\tthis.sid = sid;\r\n\r\n\t\t}\r\n\r\n\t\tthis.fullSid = sid;\r\n\t\tthis.dotSyntax = dotSyntax;\r\n\t\tthis.arrSyntax = arrSyntax;\r\n\r\n\t\treturn this;\r\n\r\n\t};\r\n\r\n\tfunction Sampler ( animation ) {\r\n\r\n\t\tthis.id = \"\";\r\n\t\tthis.animation = animation;\r\n\t\tthis.inputs = [];\r\n\t\tthis.input = null;\r\n\t\tthis.output = null;\r\n\t\tthis.strideOut = null;\r\n\t\tthis.interpolation = null;\r\n\t\tthis.startTime = null;\r\n\t\tthis.endTime = null;\r\n\t\tthis.duration = 0;\r\n\r\n\t}\r\n\r\n\tSampler.prototype.parse = function ( element ) {\r\n\r\n\t\tthis.id = element.getAttribute( 'id' );\r\n\t\tthis.inputs = [];\r\n\r\n\t\tfor ( var i = 0; i < element.childNodes.length; i ++ ) {\r\n\r\n\t\t\tvar child = element.childNodes[ i ];\r\n\t\t\tif ( child.nodeType != 1 ) continue;\r\n\r\n\t\t\tswitch ( child.nodeName ) {\r\n\r\n\t\t\t\tcase 'input':\r\n\r\n\t\t\t\t\tthis.inputs.push( (new Input()).parse( child ) );\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tdefault:\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\r\n\t};\r\n\r\n\tSampler.prototype.create = function () {\r\n\r\n\t\tfor ( var i = 0; i < this.inputs.length; i ++ ) {\r\n\r\n\t\t\tvar input = this.inputs[ i ];\r\n\t\t\tvar source = this.animation.source[ input.source ];\r\n\r\n\t\t\tswitch ( input.semantic ) {\r\n\r\n\t\t\t\tcase 'INPUT':\r\n\r\n\t\t\t\t\tthis.input = source.read();\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'OUTPUT':\r\n\r\n\t\t\t\t\tthis.output = source.read();\r\n\t\t\t\t\tthis.strideOut = source.accessor.stride;\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'INTERPOLATION':\r\n\r\n\t\t\t\t\tthis.interpolation = source.read();\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'IN_TANGENT':\r\n\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'OUT_TANGENT':\r\n\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tdefault:\r\n\r\n\t\t\t\t\tconsole.log(input.semantic);\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tthis.startTime = 0;\r\n\t\tthis.endTime = 0;\r\n\t\tthis.duration = 0;\r\n\r\n\t\tif ( this.input.length ) {\r\n\r\n\t\t\tthis.startTime = 100000000;\r\n\t\t\tthis.endTime = -100000000;\r\n\r\n\t\t\tfor ( var i = 0; i < this.input.length; i ++ ) {\r\n\r\n\t\t\t\tthis.startTime = Math.min( this.startTime, this.input[ i ] );\r\n\t\t\t\tthis.endTime = Math.max( this.endTime, this.input[ i ] );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tthis.duration = this.endTime - this.startTime;\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n\tSampler.prototype.getData = function ( type, ndx, member ) {\r\n\r\n\t\tvar data;\r\n\r\n\t\tif ( type === 'matrix' && this.strideOut === 16 ) {\r\n\r\n\t\t\tdata = this.output[ ndx ];\r\n\r\n\t\t} else if ( this.strideOut > 1 ) {\r\n\r\n\t\t\tdata = [];\r\n\t\t\tndx *= this.strideOut;\r\n\r\n\t\t\tfor ( var i = 0; i < this.strideOut; ++ i ) {\r\n\r\n\t\t\t\tdata[ i ] = this.output[ ndx + i ];\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( this.strideOut === 3 ) {\r\n\r\n\t\t\t\tswitch ( type ) {\r\n\r\n\t\t\t\t\tcase 'rotate':\r\n\t\t\t\t\tcase 'translate':\r\n\r\n\t\t\t\t\t\tfixCoords( data, -1 );\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase 'scale':\r\n\r\n\t\t\t\t\t\tfixCoords( data, 1 );\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t} else if ( this.strideOut === 4 && type === 'matrix' ) {\r\n\r\n\t\t\t\tfixCoords( data, -1 );\r\n\r\n\t\t\t}\r\n\r\n\t\t} else {\r\n\r\n\t\t\tdata = this.output[ ndx ];\r\n\r\n\t\t\tif ( member && type === 'translate' ) {\r\n\t\t\t\tdata = getConvertedTranslation( member, data );\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\treturn data;\r\n\r\n\t};\r\n\r\n\tfunction Key ( time ) {\r\n\r\n\t\tthis.targets = [];\r\n\t\tthis.time = time;\r\n\r\n\t}\r\n\r\n\tKey.prototype.addTarget = function ( fullSid, transform, member, data ) {\r\n\r\n\t\tthis.targets.push( {\r\n\t\t\tsid: fullSid,\r\n\t\t\tmember: member,\r\n\t\t\ttransform: transform,\r\n\t\t\tdata: data\r\n\t\t} );\r\n\r\n\t};\r\n\r\n\tKey.prototype.apply = function ( opt_sid ) {\r\n\r\n\t\tfor ( var i = 0; i < this.targets.length; ++ i ) {\r\n\r\n\t\t\tvar target = this.targets[ i ];\r\n\r\n\t\t\tif ( !opt_sid || target.sid === opt_sid ) {\r\n\r\n\t\t\t\ttarget.transform.update( target.data, target.member );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n\tKey.prototype.getTarget = function ( fullSid ) {\r\n\r\n\t\tfor ( var i = 0; i < this.targets.length; ++ i ) {\r\n\r\n\t\t\tif ( this.targets[ i ].sid === fullSid ) {\r\n\r\n\t\t\t\treturn this.targets[ i ];\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\treturn null;\r\n\r\n\t};\r\n\r\n\tKey.prototype.hasTarget = function ( fullSid ) {\r\n\r\n\t\tfor ( var i = 0; i < this.targets.length; ++ i ) {\r\n\r\n\t\t\tif ( this.targets[ i ].sid === fullSid ) {\r\n\r\n\t\t\t\treturn true;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\treturn false;\r\n\r\n\t};\r\n\r\n\t// TODO: Currently only doing linear interpolation. Should support full COLLADA spec.\r\n\tKey.prototype.interpolate = function ( nextKey, time ) {\r\n\r\n\t\tfor ( var i = 0, l = this.targets.length; i < l; i ++ ) {\r\n\r\n\t\t\tvar target = this.targets[ i ],\r\n\t\t\t\tnextTarget = nextKey.getTarget( target.sid ),\r\n\t\t\t\tdata;\r\n\r\n\t\t\tif ( target.transform.type !== 'matrix' && nextTarget ) {\r\n\r\n\t\t\t\tvar scale = ( time - this.time ) / ( nextKey.time - this.time ),\r\n\t\t\t\t\tnextData = nextTarget.data,\r\n\t\t\t\t\tprevData = target.data;\r\n\r\n\t\t\t\tif ( scale < 0 ) scale = 0;\r\n\t\t\t\tif ( scale > 1 ) scale = 1;\r\n\r\n\t\t\t\tif ( prevData.length ) {\r\n\r\n\t\t\t\t\tdata = [];\r\n\r\n\t\t\t\t\tfor ( var j = 0; j < prevData.length; ++ j ) {\r\n\r\n\t\t\t\t\t\tdata[ j ] = prevData[ j ] + ( nextData[ j ] - prevData[ j ] ) * scale;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tdata = prevData + ( nextData - prevData ) * scale;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tdata = target.data;\r\n\r\n\t\t\t}\r\n\r\n\t\t\ttarget.transform.update( data, target.member );\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n\t// Camera\r\n\tfunction Camera() {\r\n\r\n\t\tthis.id = \"\";\r\n\t\tthis.name = \"\";\r\n\t\tthis.technique = \"\";\r\n\r\n\t}\r\n\r\n\tCamera.prototype.parse = function ( element ) {\r\n\r\n\t\tthis.id = element.getAttribute( 'id' );\r\n\t\tthis.name = element.getAttribute( 'name' );\r\n\r\n\t\tfor ( var i = 0; i < element.childNodes.length; i ++ ) {\r\n\r\n\t\t\tvar child = element.childNodes[ i ];\r\n\t\t\tif ( child.nodeType != 1 ) continue;\r\n\r\n\t\t\tswitch ( child.nodeName ) {\r\n\r\n\t\t\t\tcase 'optics':\r\n\r\n\t\t\t\t\tthis.parseOptics( child );\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tdefault:\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\r\n\t};\r\n\r\n\tCamera.prototype.parseOptics = function ( element ) {\r\n\r\n\t\tfor ( var i = 0; i < element.childNodes.length; i ++ ) {\r\n\r\n\t\t\tif ( element.childNodes[ i ].nodeName === 'technique_common' ) {\r\n\r\n\t\t\t\tvar technique = element.childNodes[ i ];\r\n\r\n\t\t\t\tfor ( var j = 0; j < technique.childNodes.length; j ++ ) {\r\n\r\n\t\t\t\t\tthis.technique = technique.childNodes[ j ].nodeName;\r\n\r\n\t\t\t\t\tif ( this.technique === 'perspective' ) {\r\n\r\n\t\t\t\t\t\tvar perspective = technique.childNodes[ j ];\r\n\r\n\t\t\t\t\t\tfor ( var k = 0; k < perspective.childNodes.length; k ++ ) {\r\n\r\n\t\t\t\t\t\t\tvar param = perspective.childNodes[ k ];\r\n\r\n\t\t\t\t\t\t\tswitch ( param.nodeName ) {\r\n\r\n\t\t\t\t\t\t\t\tcase 'yfov':\r\n\t\t\t\t\t\t\t\t\tthis.yfov = param.textContent;\r\n\t\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t\tcase 'xfov':\r\n\t\t\t\t\t\t\t\t\tthis.xfov = param.textContent;\r\n\t\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t\tcase 'znear':\r\n\t\t\t\t\t\t\t\t\tthis.znear = param.textContent;\r\n\t\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t\tcase 'zfar':\r\n\t\t\t\t\t\t\t\t\tthis.zfar = param.textContent;\r\n\t\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t\tcase 'aspect_ratio':\r\n\t\t\t\t\t\t\t\t\tthis.aspect_ratio = param.textContent;\r\n\t\t\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t} else if ( this.technique === 'orthographic' ) {\r\n\r\n\t\t\t\t\t\tvar orthographic = technique.childNodes[ j ];\r\n\r\n\t\t\t\t\t\tfor ( var k = 0; k < orthographic.childNodes.length; k ++ ) {\r\n\r\n\t\t\t\t\t\t\tvar param = orthographic.childNodes[ k ];\r\n\r\n\t\t\t\t\t\t\tswitch ( param.nodeName ) {\r\n\r\n\t\t\t\t\t\t\t\tcase 'xmag':\r\n\t\t\t\t\t\t\t\t\tthis.xmag = param.textContent;\r\n\t\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t\tcase 'ymag':\r\n\t\t\t\t\t\t\t\t\tthis.ymag = param.textContent;\r\n\t\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t\tcase 'znear':\r\n\t\t\t\t\t\t\t\t\tthis.znear = param.textContent;\r\n\t\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t\tcase 'zfar':\r\n\t\t\t\t\t\t\t\t\tthis.zfar = param.textContent;\r\n\t\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t\tcase 'aspect_ratio':\r\n\t\t\t\t\t\t\t\t\tthis.aspect_ratio = param.textContent;\r\n\t\t\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\r\n\t};\r\n\r\n\tfunction InstanceCamera() {\r\n\r\n\t\tthis.url = \"\";\r\n\r\n\t}\r\n\r\n\tInstanceCamera.prototype.parse = function ( element ) {\r\n\r\n\t\tthis.url = element.getAttribute('url').replace(/^#/, '');\r\n\r\n\t\treturn this;\r\n\r\n\t};\r\n\r\n\t// Light\r\n\r\n\tfunction Light() {\r\n\r\n\t\tthis.id = \"\";\r\n\t\tthis.name = \"\";\r\n\t\tthis.technique = \"\";\r\n\r\n\t}\r\n\r\n\tLight.prototype.parse = function ( element ) {\r\n\r\n\t\tthis.id = element.getAttribute( 'id' );\r\n\t\tthis.name = element.getAttribute( 'name' );\r\n\r\n\t\tfor ( var i = 0; i < element.childNodes.length; i ++ ) {\r\n\r\n\t\t\tvar child = element.childNodes[ i ];\r\n\t\t\tif ( child.nodeType != 1 ) continue;\r\n\r\n\t\t\tswitch ( child.nodeName ) {\r\n\r\n\t\t\t\tcase 'technique_common':\r\n\r\n\t\t\t\t\tthis.parseCommon( child );\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'technique':\r\n\r\n\t\t\t\t\tthis.parseTechnique( child );\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tdefault:\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\r\n\t};\r\n\r\n\tLight.prototype.parseCommon = function ( element ) {\r\n\r\n\t\tfor ( var i = 0; i < element.childNodes.length; i ++ ) {\r\n\r\n\t\t\tswitch ( element.childNodes[ i ].nodeName ) {\r\n\r\n\t\t\t\tcase 'directional':\r\n\t\t\t\tcase 'point':\r\n\t\t\t\tcase 'spot':\r\n\t\t\t\tcase 'ambient':\r\n\r\n\t\t\t\t\tthis.technique = element.childNodes[ i ].nodeName;\r\n\r\n\t\t\t\t\tvar light = element.childNodes[ i ];\r\n\r\n\t\t\t\t\tfor ( var j = 0; j < light.childNodes.length; j ++ ) {\r\n\r\n\t\t\t\t\t\tvar child = light.childNodes[j];\r\n\r\n\t\t\t\t\t\tswitch ( child.nodeName ) {\r\n\r\n\t\t\t\t\t\t\tcase 'color':\r\n\r\n\t\t\t\t\t\t\t\tvar rgba = _floats( child.textContent );\r\n\t\t\t\t\t\t\t\tthis.color = new THREE.Color(0);\r\n\t\t\t\t\t\t\t\tthis.color.setRGB( rgba[0], rgba[1], rgba[2] );\r\n\t\t\t\t\t\t\t\tthis.color.a = rgba[3];\r\n\t\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\t\tcase 'falloff_angle':\r\n\r\n\t\t\t\t\t\t\t\tthis.falloff_angle = parseFloat( child.textContent );\r\n\t\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\t\tcase 'quadratic_attenuation':\r\n\t\t\t\t\t\t\t\tvar f = parseFloat( child.textContent );\r\n\t\t\t\t\t\t\t\tthis.distance = f ? Math.sqrt( 1 / f ) : 0;\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\r\n\t};\r\n\r\n\tLight.prototype.parseTechnique = function ( element ) {\r\n\r\n\t\tthis.profile = element.getAttribute( 'profile' );\r\n\r\n\t\tfor ( var i = 0; i < element.childNodes.length; i ++ ) {\r\n\r\n\t\t\tvar child = element.childNodes[ i ];\r\n\r\n\t\t\tswitch ( child.nodeName ) {\r\n\r\n\t\t\t\tcase 'intensity':\r\n\r\n\t\t\t\t\tthis.intensity = parseFloat(child.textContent);\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\r\n\t};\r\n\r\n\tfunction InstanceLight() {\r\n\r\n\t\tthis.url = \"\";\r\n\r\n\t}\r\n\r\n\tInstanceLight.prototype.parse = function ( element ) {\r\n\r\n\t\tthis.url = element.getAttribute('url').replace(/^#/, '');\r\n\r\n\t\treturn this;\r\n\r\n\t};\r\n\r\n\tfunction KinematicsModel( ) {\r\n\r\n\t\tthis.id = '';\r\n\t\tthis.name = '';\r\n\t\tthis.joints = [];\r\n\t\tthis.links = [];\r\n\r\n\t}\r\n\r\n\tKinematicsModel.prototype.parse = function( element ) {\r\n\r\n\t\tthis.id = element.getAttribute('id');\r\n\t\tthis.name = element.getAttribute('name');\r\n\t\tthis.joints = [];\r\n\t\tthis.links = [];\r\n\r\n\t\tfor (var i = 0; i < element.childNodes.length; i ++ ) {\r\n\r\n\t\t\tvar child = element.childNodes[ i ];\r\n\t\t\tif ( child.nodeType != 1 ) continue;\r\n\r\n\t\t\tswitch ( child.nodeName ) {\r\n\r\n\t\t\t\tcase 'technique_common':\r\n\r\n\t\t\t\t\tthis.parseCommon(child);\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tdefault:\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\r\n\t};\r\n\r\n\tKinematicsModel.prototype.parseCommon = function( element ) {\r\n\r\n\t\tfor (var i = 0; i < element.childNodes.length; i ++ ) {\r\n\r\n\t\t\tvar child = element.childNodes[ i ];\r\n\t\t\tif ( child.nodeType != 1 ) continue;\r\n\r\n\t\t\tswitch ( element.childNodes[ i ].nodeName ) {\r\n\r\n\t\t\t\tcase 'joint':\r\n\t\t\t\t\tthis.joints.push( (new Joint()).parse(child) );\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'link':\r\n\t\t\t\t\tthis.links.push( (new Link()).parse(child) );\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tdefault:\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\r\n\t};\r\n\r\n\tfunction Joint( ) {\r\n\r\n\t\tthis.sid = '';\r\n\t\tthis.name = '';\r\n\t\tthis.axis = new THREE.Vector3();\r\n\t\tthis.limits = {\r\n\t\t\tmin: 0,\r\n\t\t\tmax: 0\r\n\t\t};\r\n\t\tthis.type = '';\r\n\t\tthis.static = false;\r\n\t\tthis.zeroPosition = 0.0;\r\n\t\tthis.middlePosition = 0.0;\r\n\r\n\t}\r\n\r\n\tJoint.prototype.parse = function( element ) {\r\n\r\n\t\tthis.sid = element.getAttribute('sid');\r\n\t\tthis.name = element.getAttribute('name');\r\n\t\tthis.axis = new THREE.Vector3();\r\n\t\tthis.limits = {\r\n\t\t\tmin: 0,\r\n\t\t\tmax: 0\r\n\t\t};\r\n\t\tthis.type = '';\r\n\t\tthis.static = false;\r\n\t\tthis.zeroPosition = 0.0;\r\n\t\tthis.middlePosition = 0.0;\r\n\r\n\t\tvar axisElement = element.querySelector('axis');\r\n\t\tvar _axis = _floats(axisElement.textContent);\r\n\t\tthis.axis = getConvertedVec3(_axis, 0);\r\n\r\n\t\tvar min = element.querySelector('limits min') ? parseFloat(element.querySelector('limits min').textContent) : -360;\r\n\t\tvar max = element.querySelector('limits max') ? parseFloat(element.querySelector('limits max').textContent) : 360;\r\n\r\n\t\tthis.limits = {\r\n\t\t\tmin: min,\r\n\t\t\tmax: max\r\n\t\t};\r\n\r\n\t\tvar jointTypes = [ 'prismatic', 'revolute' ];\r\n\t\tfor (var i = 0; i < jointTypes.length; i ++ ) {\r\n\r\n\t\t\tvar type = jointTypes[ i ];\r\n\r\n\t\t\tvar jointElement = element.querySelector(type);\r\n\r\n\t\t\tif ( jointElement ) {\r\n\r\n\t\t\t\tthis.type = type;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\t// if the min is equal to or somehow greater than the max, consider the joint static\r\n\t\tif ( this.limits.min >= this.limits.max ) {\r\n\r\n\t\t\tthis.static = true;\r\n\r\n\t\t}\r\n\r\n\t\tthis.middlePosition = (this.limits.min + this.limits.max) / 2.0;\r\n\t\treturn this;\r\n\r\n\t};\r\n\r\n\tfunction Link( ) {\r\n\r\n\t\tthis.sid = '';\r\n\t\tthis.name = '';\r\n\t\tthis.transforms = [];\r\n\t\tthis.attachments = [];\r\n\r\n\t}\r\n\r\n\tLink.prototype.parse = function( element ) {\r\n\r\n\t\tthis.sid = element.getAttribute('sid');\r\n\t\tthis.name = element.getAttribute('name');\r\n\t\tthis.transforms = [];\r\n\t\tthis.attachments = [];\r\n\r\n\t\tfor (var i = 0; i < element.childNodes.length; i ++ ) {\r\n\r\n\t\t\tvar child = element.childNodes[ i ];\r\n\t\t\tif ( child.nodeType != 1 ) continue;\r\n\r\n\t\t\tswitch ( child.nodeName ) {\r\n\r\n\t\t\t\tcase 'attachment_full':\r\n\t\t\t\t\tthis.attachments.push( (new Attachment()).parse(child) );\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'rotate':\r\n\t\t\t\tcase 'translate':\r\n\t\t\t\tcase 'matrix':\r\n\r\n\t\t\t\t\tthis.transforms.push( (new Transform()).parse(child) );\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tdefault:\r\n\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\r\n\t};\r\n\r\n\tfunction Attachment( ) {\r\n\r\n\t\tthis.joint = '';\r\n\t\tthis.transforms = [];\r\n\t\tthis.links = [];\r\n\r\n\t}\r\n\r\n\tAttachment.prototype.parse = function( element ) {\r\n\r\n\t\tthis.joint = element.getAttribute('joint').split('/').pop();\r\n\t\tthis.links = [];\r\n\r\n\t\tfor (var i = 0; i < element.childNodes.length; i ++ ) {\r\n\r\n\t\t\tvar child = element.childNodes[ i ];\r\n\t\t\tif ( child.nodeType != 1 ) continue;\r\n\r\n\t\t\tswitch ( child.nodeName ) {\r\n\r\n\t\t\t\tcase 'link':\r\n\t\t\t\t\tthis.links.push( (new Link()).parse(child) );\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'rotate':\r\n\t\t\t\tcase 'translate':\r\n\t\t\t\tcase 'matrix':\r\n\r\n\t\t\t\t\tthis.transforms.push( (new Transform()).parse(child) );\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tdefault:\r\n\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\r\n\t};\r\n\r\n\tfunction _source( element ) {\r\n\r\n\t\tvar id = element.getAttribute( 'id' );\r\n\r\n\t\tif ( sources[ id ] != undefined ) {\r\n\r\n\t\t\treturn sources[ id ];\r\n\r\n\t\t}\r\n\r\n\t\tsources[ id ] = ( new Source(id )).parse( element );\r\n\t\treturn sources[ id ];\r\n\r\n\t}\r\n\r\n\tfunction _nsResolver( nsPrefix ) {\r\n\r\n\t\tif ( nsPrefix === \"dae\" ) {\r\n\r\n\t\t\treturn \"http://www.collada.org/2005/11/COLLADASchema\";\r\n\r\n\t\t}\r\n\r\n\t\treturn null;\r\n\r\n\t}\r\n\r\n\tfunction _bools( str ) {\r\n\r\n\t\tvar raw = _strings( str );\r\n\t\tvar data = [];\r\n\r\n\t\tfor ( var i = 0, l = raw.length; i < l; i ++ ) {\r\n\r\n\t\t\tdata.push( (raw[i] === 'true' || raw[i] === '1') ? true : false );\r\n\r\n\t\t}\r\n\r\n\t\treturn data;\r\n\r\n\t}\r\n\r\n\tfunction _floats( str ) {\r\n\r\n\t\tvar raw = _strings(str);\r\n\t\tvar data = [];\r\n\r\n\t\tfor ( var i = 0, l = raw.length; i < l; i ++ ) {\r\n\r\n\t\t\tdata.push( parseFloat( raw[ i ] ) );\r\n\r\n\t\t}\r\n\r\n\t\treturn data;\r\n\r\n\t}\r\n\r\n\tfunction _ints( str ) {\r\n\r\n\t\tvar raw = _strings( str );\r\n\t\tvar data = [];\r\n\r\n\t\tfor ( var i = 0, l = raw.length; i < l; i ++ ) {\r\n\r\n\t\t\tdata.push( parseInt( raw[ i ], 10 ) );\r\n\r\n\t\t}\r\n\r\n\t\treturn data;\r\n\r\n\t}\r\n\r\n\tfunction _strings( str ) {\r\n\r\n\t\treturn ( str.length > 0 ) ? _trimString( str ).split( /\\s+/ ) : [];\r\n\r\n\t}\r\n\r\n\tfunction _trimString( str ) {\r\n\r\n\t\treturn str.replace( /^\\s+/, \"\" ).replace( /\\s+$/, \"\" );\r\n\r\n\t}\r\n\r\n\tfunction _attr_as_float( element, name, defaultValue ) {\r\n\r\n\t\tif ( element.hasAttribute( name ) ) {\r\n\r\n\t\t\treturn parseFloat( element.getAttribute( name ) );\r\n\r\n\t\t} else {\r\n\r\n\t\t\treturn defaultValue;\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tfunction _attr_as_int( element, name, defaultValue ) {\r\n\r\n\t\tif ( element.hasAttribute( name ) ) {\r\n\r\n\t\t\treturn parseInt( element.getAttribute( name ), 10) ;\r\n\r\n\t\t} else {\r\n\r\n\t\t\treturn defaultValue;\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tfunction _attr_as_string( element, name, defaultValue ) {\r\n\r\n\t\tif ( element.hasAttribute( name ) ) {\r\n\r\n\t\t\treturn element.getAttribute( name );\r\n\r\n\t\t} else {\r\n\r\n\t\t\treturn defaultValue;\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tfunction _format_float( f, num ) {\r\n\r\n\t\tif ( f === undefined ) {\r\n\r\n\t\t\tvar s = '0.';\r\n\r\n\t\t\twhile ( s.length < num + 2 ) {\r\n\r\n\t\t\t\ts += '0';\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn s;\r\n\r\n\t\t}\r\n\r\n\t\tnum = num || 2;\r\n\r\n\t\tvar parts = f.toString().split( '.' );\r\n\t\tparts[ 1 ] = parts.length > 1 ? parts[ 1 ].substr( 0, num ) : \"0\";\r\n\r\n\t\twhile ( parts[ 1 ].length < num ) {\r\n\r\n\t\t\tparts[ 1 ] += '0';\r\n\r\n\t\t}\r\n\r\n\t\treturn parts.join( '.' );\r\n\r\n\t}\r\n\r\n\tfunction loadTextureImage ( texture, url ) {\r\n\r\n\t\tvar loader = new THREE.ImageLoader();\r\n\r\n\t\tloader.load( url, function ( image ) {\r\n\r\n\t\t\ttexture.image = image;\r\n\t\t\ttexture.needsUpdate = true;\r\n\r\n\t\t} );\r\n\r\n\t}\r\n\r\n\tfunction extractDoubleSided( obj, element ) {\r\n\r\n\t\tobj.doubleSided = false;\r\n\r\n\t\tvar node = element.querySelectorAll('extra double_sided')[0];\r\n\r\n\t\tif ( node ) {\r\n\r\n\t\t\tif ( node && parseInt( node.textContent, 10 ) === 1 ) {\r\n\r\n\t\t\t\tobj.doubleSided = true;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t// Up axis conversion\r\n\r\n\tfunction setUpConversion() {\r\n\r\n\t\tif ( options.convertUpAxis !== true || colladaUp === options.upAxis ) {\r\n\r\n\t\t\tupConversion = null;\r\n\r\n\t\t} else {\r\n\r\n\t\t\tswitch ( colladaUp ) {\r\n\r\n\t\t\t\tcase 'X':\r\n\r\n\t\t\t\t\tupConversion = options.upAxis === 'Y' ? 'XtoY' : 'XtoZ';\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'Y':\r\n\r\n\t\t\t\t\tupConversion = options.upAxis === 'X' ? 'YtoX' : 'YtoZ';\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'Z':\r\n\r\n\t\t\t\t\tupConversion = options.upAxis === 'X' ? 'ZtoX' : 'ZtoY';\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tfunction fixCoords( data, sign ) {\r\n\r\n\t\tif ( options.convertUpAxis !== true || colladaUp === options.upAxis ) {\r\n\r\n\t\t\treturn;\r\n\r\n\t\t}\r\n\r\n\t\tswitch ( upConversion ) {\r\n\r\n\t\t\tcase 'XtoY':\r\n\r\n\t\t\t\tvar tmp = data[ 0 ];\r\n\t\t\t\tdata[ 0 ] = sign * data[ 1 ];\r\n\t\t\t\tdata[ 1 ] = tmp;\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tcase 'XtoZ':\r\n\r\n\t\t\t\tvar tmp = data[ 2 ];\r\n\t\t\t\tdata[ 2 ] = data[ 1 ];\r\n\t\t\t\tdata[ 1 ] = data[ 0 ];\r\n\t\t\t\tdata[ 0 ] = tmp;\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tcase 'YtoX':\r\n\r\n\t\t\t\tvar tmp = data[ 0 ];\r\n\t\t\t\tdata[ 0 ] = data[ 1 ];\r\n\t\t\t\tdata[ 1 ] = sign * tmp;\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tcase 'YtoZ':\r\n\r\n\t\t\t\tvar tmp = data[ 1 ];\r\n\t\t\t\tdata[ 1 ] = sign * data[ 2 ];\r\n\t\t\t\tdata[ 2 ] = tmp;\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tcase 'ZtoX':\r\n\r\n\t\t\t\tvar tmp = data[ 0 ];\r\n\t\t\t\tdata[ 0 ] = data[ 1 ];\r\n\t\t\t\tdata[ 1 ] = data[ 2 ];\r\n\t\t\t\tdata[ 2 ] = tmp;\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tcase 'ZtoY':\r\n\r\n\t\t\t\tvar tmp = data[ 1 ];\r\n\t\t\t\tdata[ 1 ] = data[ 2 ];\r\n\t\t\t\tdata[ 2 ] = sign * tmp;\r\n\t\t\t\tbreak;\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tfunction getConvertedTranslation( axis, data ) {\r\n\r\n\t\tif ( options.convertUpAxis !== true || colladaUp === options.upAxis ) {\r\n\r\n\t\t\treturn data;\r\n\r\n\t\t}\r\n\r\n\t\tswitch ( axis ) {\r\n\t\t\tcase 'X':\r\n\t\t\t\tdata = upConversion === 'XtoY' ? data * -1 : data;\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'Y':\r\n\t\t\t\tdata = upConversion === 'YtoZ' || upConversion === 'YtoX' ? data * -1 : data;\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'Z':\r\n\t\t\t\tdata = upConversion === 'ZtoY' ? data * -1 : data ;\r\n\t\t\t\tbreak;\r\n\t\t\tdefault:\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\r\n\t\treturn data;\r\n\t}\r\n\r\n\tfunction getConvertedVec3( data, offset ) {\r\n\r\n\t\tvar arr = [ data[ offset ], data[ offset + 1 ], data[ offset + 2 ] ];\r\n\t\tfixCoords( arr, -1 );\r\n\t\treturn new THREE.Vector3( arr[ 0 ], arr[ 1 ], arr[ 2 ] );\r\n\r\n\t}\r\n\r\n\tfunction getConvertedMat4( data ) {\r\n\r\n\t\tif ( options.convertUpAxis ) {\r\n\r\n\t\t\t// First fix rotation and scale\r\n\r\n\t\t\t// Columns first\r\n\t\t\tvar arr = [ data[ 0 ], data[ 4 ], data[ 8 ] ];\r\n\t\t\tfixCoords( arr, -1 );\r\n\t\t\tdata[ 0 ] = arr[ 0 ];\r\n\t\t\tdata[ 4 ] = arr[ 1 ];\r\n\t\t\tdata[ 8 ] = arr[ 2 ];\r\n\t\t\tarr = [ data[ 1 ], data[ 5 ], data[ 9 ] ];\r\n\t\t\tfixCoords( arr, -1 );\r\n\t\t\tdata[ 1 ] = arr[ 0 ];\r\n\t\t\tdata[ 5 ] = arr[ 1 ];\r\n\t\t\tdata[ 9 ] = arr[ 2 ];\r\n\t\t\tarr = [ data[ 2 ], data[ 6 ], data[ 10 ] ];\r\n\t\t\tfixCoords( arr, -1 );\r\n\t\t\tdata[ 2 ] = arr[ 0 ];\r\n\t\t\tdata[ 6 ] = arr[ 1 ];\r\n\t\t\tdata[ 10 ] = arr[ 2 ];\r\n\t\t\t// Rows second\r\n\t\t\tarr = [ data[ 0 ], data[ 1 ], data[ 2 ] ];\r\n\t\t\tfixCoords( arr, -1 );\r\n\t\t\tdata[ 0 ] = arr[ 0 ];\r\n\t\t\tdata[ 1 ] = arr[ 1 ];\r\n\t\t\tdata[ 2 ] = arr[ 2 ];\r\n\t\t\tarr = [ data[ 4 ], data[ 5 ], data[ 6 ] ];\r\n\t\t\tfixCoords( arr, -1 );\r\n\t\t\tdata[ 4 ] = arr[ 0 ];\r\n\t\t\tdata[ 5 ] = arr[ 1 ];\r\n\t\t\tdata[ 6 ] = arr[ 2 ];\r\n\t\t\tarr = [ data[ 8 ], data[ 9 ], data[ 10 ] ];\r\n\t\t\tfixCoords( arr, -1 );\r\n\t\t\tdata[ 8 ] = arr[ 0 ];\r\n\t\t\tdata[ 9 ] = arr[ 1 ];\r\n\t\t\tdata[ 10 ] = arr[ 2 ];\r\n\r\n\t\t\t// Now fix translation\r\n\t\t\tarr = [ data[ 3 ], data[ 7 ], data[ 11 ] ];\r\n\t\t\tfixCoords( arr, -1 );\r\n\t\t\tdata[ 3 ] = arr[ 0 ];\r\n\t\t\tdata[ 7 ] = arr[ 1 ];\r\n\t\t\tdata[ 11 ] = arr[ 2 ];\r\n\r\n\t\t}\r\n\r\n\t\treturn new THREE.Matrix4().set(\r\n\t\t\tdata[0], data[1], data[2], data[3],\r\n\t\t\tdata[4], data[5], data[6], data[7],\r\n\t\t\tdata[8], data[9], data[10], data[11],\r\n\t\t\tdata[12], data[13], data[14], data[15]\r\n\t\t\t);\r\n\r\n\t}\r\n\r\n\tfunction getConvertedIndex( index ) {\r\n\r\n\t\tif ( index > -1 && index < 3 ) {\r\n\r\n\t\t\tvar members = [ 'X', 'Y', 'Z' ],\r\n\t\t\t\tindices = { X: 0, Y: 1, Z: 2 };\r\n\r\n\t\t\tindex = getConvertedMember( members[ index ] );\r\n\t\t\tindex = indices[ index ];\r\n\r\n\t\t}\r\n\r\n\t\treturn index;\r\n\r\n\t}\r\n\r\n\tfunction getConvertedMember( member ) {\r\n\r\n\t\tif ( options.convertUpAxis ) {\r\n\r\n\t\t\tswitch ( member ) {\r\n\r\n\t\t\t\tcase 'X':\r\n\r\n\t\t\t\t\tswitch ( upConversion ) {\r\n\r\n\t\t\t\t\t\tcase 'XtoY':\r\n\t\t\t\t\t\tcase 'XtoZ':\r\n\t\t\t\t\t\tcase 'YtoX':\r\n\r\n\t\t\t\t\t\t\tmember = 'Y';\r\n\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\tcase 'ZtoX':\r\n\r\n\t\t\t\t\t\t\tmember = 'Z';\r\n\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'Y':\r\n\r\n\t\t\t\t\tswitch ( upConversion ) {\r\n\r\n\t\t\t\t\t\tcase 'XtoY':\r\n\t\t\t\t\t\tcase 'YtoX':\r\n\t\t\t\t\t\tcase 'ZtoX':\r\n\r\n\t\t\t\t\t\t\tmember = 'X';\r\n\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\tcase 'XtoZ':\r\n\t\t\t\t\t\tcase 'YtoZ':\r\n\t\t\t\t\t\tcase 'ZtoY':\r\n\r\n\t\t\t\t\t\t\tmember = 'Z';\r\n\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'Z':\r\n\r\n\t\t\t\t\tswitch ( upConversion ) {\r\n\r\n\t\t\t\t\t\tcase 'XtoZ':\r\n\r\n\t\t\t\t\t\t\tmember = 'X';\r\n\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\tcase 'YtoZ':\r\n\t\t\t\t\t\tcase 'ZtoX':\r\n\t\t\t\t\t\tcase 'ZtoY':\r\n\r\n\t\t\t\t\t\t\tmember = 'Y';\r\n\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\treturn member;\r\n\r\n\t}\r\n\r\n\treturn {\r\n\r\n\t\tload: load,\r\n\t\tparse: parse,\r\n\t\tsetPreferredShading: setPreferredShading,\r\n\t\tapplySkin: applySkin,\r\n\t\tgeometries : geometries,\r\n\t\toptions: options\r\n\r\n\t};\r\n\r\n};\r\n","module.exports = {\n  // Tiny KeyboardEvent.code polyfill.\n  KEYCODE_TO_CODE: {\n    '38': 'ArrowUp',\n    '37': 'ArrowLeft',\n    '40': 'ArrowDown',\n    '39': 'ArrowRight',\n    '87': 'KeyW',\n    '65': 'KeyA',\n    '83': 'KeyS',\n    '68': 'KeyD'\n  }\n};\n","/*\n * Copyright 2015 Google Inc. All Rights Reserved.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nvar Util = {};\n\nUtil.base64 = function(mimeType, base64) {\n  return 'data:' + mimeType + ';base64,' + base64;\n};\n\nUtil.isMobile = function() {\n  var check = false;\n  (function(a){if(/(android|bb\\d+|meego).+mobile|avantgo|bada\\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(a)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\\-(n|u)|c55\\/|capi|ccwa|cdm\\-|cell|chtm|cldc|cmd\\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\\-s|devi|dica|dmob|do(c|p)o|ds(12|\\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\\-|_)|g1 u|g560|gene|gf\\-5|g\\-mo|go(\\.w|od)|gr(ad|un)|haie|hcit|hd\\-(m|p|t)|hei\\-|hi(pt|ta)|hp( i|ip)|hs\\-c|ht(c(\\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\\-(20|go|ma)|i230|iac( |\\-|\\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\\/)|klon|kpt |kwc\\-|kyo(c|k)|le(no|xi)|lg( g|\\/(k|l|u)|50|54|\\-[a-w])|libw|lynx|m1\\-w|m3ga|m50\\/|ma(te|ui|xo)|mc(01|21|ca)|m\\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\\-2|po(ck|rt|se)|prox|psio|pt\\-g|qa\\-a|qc(07|12|21|32|60|\\-[2-7]|i\\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\\-|oo|p\\-)|sdk\\/|se(c(\\-|0|1)|47|mc|nd|ri)|sgh\\-|shar|sie(\\-|m)|sk\\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\\-|v\\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\\-|tdg\\-|tel(i|m)|tim\\-|t\\-mo|to(pl|sh)|ts(70|m\\-|m3|m5)|tx\\-9|up(\\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\\-|your|zeto|zte\\-/i.test(a.substr(0,4)))check = true})(navigator.userAgent||navigator.vendor||window.opera);\n  return check;\n};\n\nUtil.isIOS = function() {\n  return /(iPad|iPhone|iPod)/g.test(navigator.userAgent);\n};\n\nUtil.isIFrame = function() {\n  try {\n    return window.self !== window.top;\n  } catch (e) {\n    return true;\n  }\n};\n\nUtil.appendQueryParameter = function(url, key, value) {\n  // Determine delimiter based on if the URL already GET parameters in it.\n  var delimiter = (url.indexOf('?') < 0 ? '?' : '&');\n  url += delimiter + key + '=' + value;\n  return url;\n};\n\n// From http://goo.gl/4WX3tg\nUtil.getQueryParameter = function(name) {\n  name = name.replace(/[\\[]/, \"\\\\[\").replace(/[\\]]/, \"\\\\]\");\n  var regex = new RegExp(\"[\\\\?&]\" + name + \"=([^&#]*)\"),\n      results = regex.exec(location.search);\n  return results === null ? \"\" : decodeURIComponent(results[1].replace(/\\+/g, \" \"));\n};\n\nUtil.isLandscapeMode = function() {\n  return (window.orientation == 90 || window.orientation == -90);\n};\n\n\nmodule.exports = Util;\n","/**\n * Helpers.\n */\n\nvar s = 1000;\nvar m = s * 60;\nvar h = m * 60;\nvar d = h * 24;\nvar y = d * 365.25;\n\n/**\n * Parse or format the given `val`.\n *\n * Options:\n *\n *  - `long` verbose formatting [false]\n *\n * @param {String|Number} val\n * @param {Object} options\n * @return {String|Number}\n * @api public\n */\n\nmodule.exports = function(val, options){\n  options = options || {};\n  if ('string' == typeof val) return parse(val);\n  return options.long\n    ? long(val)\n    : short(val);\n};\n\n/**\n * Parse the given `str` and return milliseconds.\n *\n * @param {String} str\n * @return {Number}\n * @api private\n */\n\nfunction parse(str) {\n  str = '' + str;\n  if (str.length > 10000) return;\n  var match = /^((?:\\d+)?\\.?\\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(str);\n  if (!match) return;\n  var n = parseFloat(match[1]);\n  var type = (match[2] || 'ms').toLowerCase();\n  switch (type) {\n    case 'years':\n    case 'year':\n    case 'yrs':\n    case 'yr':\n    case 'y':\n      return n * y;\n    case 'days':\n    case 'day':\n    case 'd':\n      return n * d;\n    case 'hours':\n    case 'hour':\n    case 'hrs':\n    case 'hr':\n    case 'h':\n      return n * h;\n    case 'minutes':\n    case 'minute':\n    case 'mins':\n    case 'min':\n    case 'm':\n      return n * m;\n    case 'seconds':\n    case 'second':\n    case 'secs':\n    case 'sec':\n    case 's':\n      return n * s;\n    case 'milliseconds':\n    case 'millisecond':\n    case 'msecs':\n    case 'msec':\n    case 'ms':\n      return n;\n  }\n}\n\n/**\n * Short format for `ms`.\n *\n * @param {Number} ms\n * @return {String}\n * @api private\n */\n\nfunction short(ms) {\n  if (ms >= d) return Math.round(ms / d) + 'd';\n  if (ms >= h) return Math.round(ms / h) + 'h';\n  if (ms >= m) return Math.round(ms / m) + 'm';\n  if (ms >= s) return Math.round(ms / s) + 's';\n  return ms + 'ms';\n}\n\n/**\n * Long format for `ms`.\n *\n * @param {Number} ms\n * @return {String}\n * @api private\n */\n\nfunction long(ms) {\n  return plural(ms, d, 'day')\n    || plural(ms, h, 'hour')\n    || plural(ms, m, 'minute')\n    || plural(ms, s, 'second')\n    || ms + ' ms';\n}\n\n/**\n * Pluralization helper.\n */\n\nfunction plural(ms, n, name) {\n  if (ms < n) return;\n  if (ms < n * 1.5) return Math.floor(ms / n) + ' ' + name;\n  return Math.ceil(ms / n) + ' ' + name + 's';\n}\n"]}